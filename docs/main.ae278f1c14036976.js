(self.webpackChunkmsagl=self.webpackChunkmsagl||[]).push([[179],{6965:(L,D,p)=>{"use strict";var E={};p.r(E),p.d(E,{forceCenter:()=>lz,forceCollide:()=>p1,forceLink:()=>v1,forceManyBody:()=>A1,forceRadial:()=>Mz,forceSimulation:()=>S1,forceX:()=>Fz,forceY:()=>Bz});var S={};p.r(S),p.d(S,{dispatch:()=>ZT});var O={};function w(r){return"function"==typeof r}function R(r){const t=r(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}p.r(O),p.d(O,{interval:()=>Gz,now:()=>yg,timeout:()=>tO,timer:()=>dA,timerFlush:()=>OM});const f=R(r=>function(t){r(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function y(r,e){if(r){const t=r.indexOf(e);0<=t&&r.splice(t,1)}}class m{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(w(n))try{n()}catch(s){e=s instanceof f?s.errors:[s]}const{_teardowns:i}=this;if(i){this._teardowns=null;for(const s of i)try{C(s)}catch(o){e=null!=e?e:[],o instanceof f?e=[...e,...o.errors]:e.push(o)}}if(e)throw new f(e)}}add(e){var t;if(e&&e!==this)if(this.closed)C(e);else{if(e instanceof m){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(t=this._teardowns)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&y(t,e)}remove(e){const{_teardowns:t}=this;t&&y(t,e),e instanceof m&&e._removeParent(this)}}m.EMPTY=(()=>{const r=new m;return r.closed=!0,r})();const T=m.EMPTY;function g(r){return r instanceof m||r&&"closed"in r&&w(r.remove)&&w(r.add)&&w(r.unsubscribe)}function C(r){w(r)?r():r.unsubscribe()}const v={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},P={setTimeout(...r){const{delegate:e}=P;return((null==e?void 0:e.setTimeout)||setTimeout)(...r)},clearTimeout(r){const{delegate:e}=P;return((null==e?void 0:e.clearTimeout)||clearTimeout)(r)},delegate:void 0};function _(r){P.setTimeout(()=>{const{onUnhandledError:e}=v;if(!e)throw r;e(r)})}function x(){}const B=V("C",void 0,void 0);function V(r,e,t){return{kind:r,value:e,error:t}}let ne=null;function se(r){if(v.useDeprecatedSynchronousErrorHandling){const e=!ne;if(e&&(ne={errorThrown:!1,error:null}),r(),e){const{errorThrown:t,error:n}=ne;if(ne=null,t)throw n}}else r()}class ce extends m{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,g(e)&&e.add(this)):this.destination=$}static create(e,t,n){return new me(e,t,n)}next(e){this.isStopped?j(function K(r){return V("N",r,void 0)}(e),this):this._next(e)}error(e){this.isStopped?j(function H(r){return V("E",void 0,r)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?j(B,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class me extends ce{constructor(e,t,n){let i;if(super(),w(e))i=e;else if(e){let s;({next:i,error:t,complete:n}=e),this&&v.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe()):s=e,i=null==i?void 0:i.bind(s),t=null==t?void 0:t.bind(s),n=null==n?void 0:n.bind(s)}this.destination={next:i?Q(i):x,error:Q(null!=t?t:te),complete:n?Q(n):x}}}function Q(r,e){return(...t)=>{try{r(...t)}catch(n){v.useDeprecatedSynchronousErrorHandling?function ge(r){v.useDeprecatedSynchronousErrorHandling&&ne&&(ne.errorThrown=!0,ne.error=r)}(n):_(n)}}}function te(r){throw r}function j(r,e){const{onStoppedNotification:t}=v;t&&P.setTimeout(()=>t(r,e))}const $={closed:!0,next:x,error:te,complete:x},J="function"==typeof Symbol&&Symbol.observable||"@@observable";function ae(r){return r}let ee=(()=>{class r{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new r;return n.source=this,n.operator=t,n}subscribe(t,n,i){const s=function Ne(r){return r&&r instanceof ce||function De(r){return r&&w(r.next)&&w(r.error)&&w(r.complete)}(r)&&g(r)}(t)?t:new me(t,n,i);return se(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=Ae(n))((i,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),null==o||o.unsubscribe()}},s,i)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[J](){return this}pipe(...t){return function re(r){return 0===r.length?ae:1===r.length?r[0]:function(t){return r.reduce((n,i)=>i(n),t)}}(t)(this)}toPromise(t){return new(t=Ae(t))((n,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>n(s))})}}return r.create=e=>new r(e),r})();function Ae(r){var e;return null!==(e=null!=r?r:v.Promise)&&void 0!==e?e:Promise}const Le=R(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ke=(()=>{class r extends ee{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new je(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new Le}next(t){se(()=>{if(this._throwIfClosed(),!this.isStopped){const n=this.observers.slice();for(const i of n)i.next(t)}})}error(t){se(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){se(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:i,observers:s}=this;return n||i?T:(s.push(t),new m(()=>y(s,t)))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:i,isStopped:s}=this;n?t.error(i):s&&t.complete()}asObservable(){const t=new ee;return t.source=this,t}}return r.create=(e,t)=>new je(e,t),r})();class je extends ke{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:T}}function ft(r){return w(null==r?void 0:r.lift)}function Se(r){return e=>{if(ft(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}class Ie extends ce{constructor(e,t,n,i,s){super(e),this.onFinalize=s,this._next=t?function(o){try{t(o)}catch(a){e.error(a)}}:super._next,this._error=i?function(o){try{i(o)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(o){e.error(o)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function _e(r,e){return Se((t,n)=>{let i=0;t.subscribe(new Ie(n,s=>{n.next(r.call(e,s,i++))}))})}function Yn(r){return this instanceof Yn?(this.v=r,this):new Yn(r)}function vs(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=t.apply(r,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(N){n[N]&&(i[N]=function(F){return new Promise(function(G,W){s.push([N,F,G,W])>1||a(N,F)})})}function a(N,F){try{!function l(N){N.value instanceof Yn?Promise.resolve(N.value.v).then(c,d):b(s[0][2],N)}(n[N](F))}catch(G){b(s[0][3],G)}}function c(N){a("next",N)}function d(N){a("throw",N)}function b(N,F){N(F),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ta(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=r[Symbol.asyncIterator];return e?e.call(r):(r=function js(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(o){return new Promise(function(a,l){!function i(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=r[s](o)).done,o.value)})}}}const Xr=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function vi(r){return w(null==r?void 0:r.then)}function _l(r){return w(r[J])}function Cc(r){return Symbol.asyncIterator&&w(null==r?void 0:r[Symbol.asyncIterator])}function Vu(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Hu=function vd(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Rc(r){return w(null==r?void 0:r[Hu])}function Ro(r){return vs(this,arguments,function*(){const t=r.getReader();try{for(;;){const{value:n,done:i}=yield Yn(t.read());if(i)return yield Yn(void 0);yield yield Yn(n)}}finally{t.releaseLock()}})}function na(r){return w(null==r?void 0:r.getReader)}function Si(r){if(r instanceof ee)return r;if(null!=r){if(_l(r))return function Mg(r){return new ee(e=>{const t=r[J]();if(w(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if(Xr(r))return function Sd(r){return new ee(e=>{for(let t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}(r);if(vi(r))return function Yu(r){return new ee(e=>{r.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,_)})}(r);if(Cc(r))return Uu(r);if(Rc(r))return function Tc(r){return new ee(e=>{for(const t of r)if(e.next(t),e.closed)return;e.complete()})}(r);if(na(r))return function Ad(r){return Uu(Ro(r))}(r)}throw Vu(r)}function Uu(r){return new ee(e=>{(function Oc(r,e){var t,n,i,s;return function Hn(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(d){try{c(n.next(d))}catch(b){o(b)}}function l(d){try{c(n.throw(d))}catch(b){o(b)}}function c(d){d.done?s(d.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=ta(r);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){i={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(r,e).catch(t=>e.error(t))})}function As(r,e,t,n=0,i=!1){const s=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!i)return s}function Bn(r,e,t=1/0){return w(e)?Bn((n,i)=>_e((s,o)=>e(n,s,i,o))(Si(r(n,i))),t):("number"==typeof e&&(t=e),Se((n,i)=>function Ua(r,e,t,n,i,s,o,a){const l=[];let c=0,d=0,b=!1;const N=()=>{b&&!l.length&&!c&&e.complete()},F=W=>c<n?G(W):l.push(W),G=W=>{s&&e.next(W),c++;let ie=!1;Si(t(W,d++)).subscribe(new Ie(e,he=>{null==i||i(he),s?F(he):e.next(he)},()=>{ie=!0},void 0,()=>{if(ie)try{for(c--;l.length&&c<n;){const he=l.shift();o?As(e,o,()=>G(he)):G(he)}N()}catch(he){e.error(he)}}))};return r.subscribe(new Ie(e,F,()=>{b=!0,N()})),()=>{null==a||a()}}(n,i,r,t)))}function Wa(r=1/0){return Bn(ae,r)}const $s=new ee(r=>r.complete());function ra(r){return r&&w(r.schedule)}function Wu(r){return r[r.length-1]}function bd(r){return w(Wu(r))?r.pop():void 0}function ja(r){return ra(Wu(r))?r.pop():void 0}function Cd(r,e=0){return Se((t,n)=>{t.subscribe(new Ie(n,i=>As(n,r,()=>n.next(i),e),()=>As(n,r,()=>n.complete(),e),i=>As(n,r,()=>n.error(i),e)))})}function Rd(r,e=0){return Se((t,n)=>{n.add(r.schedule(()=>t.subscribe(n),e))})}function Td(r,e){if(!r)throw new Error("Iterable cannot be null");return new ee(t=>{As(t,e,()=>{const n=r[Symbol.asyncIterator]();As(t,e,()=>{n.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function gr(r,e){return e?function Od(r,e){if(null!=r){if(_l(r))return function kg(r,e){return Si(r).pipe(Rd(e),Cd(e))}(r,e);if(Xr(r))return function Vg(r,e){return new ee(t=>{let n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}(r,e);if(vi(r))return function Gg(r,e){return Si(r).pipe(Rd(e),Cd(e))}(r,e);if(Cc(r))return Td(r,e);if(Rc(r))return function Ic(r,e){return new ee(t=>{let n;return As(t,e,()=>{n=r[Hu](),As(t,e,()=>{let i,s;try{({value:i,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>w(null==n?void 0:n.return)&&n.return()})}(r,e);if(na(r))return function Pc(r,e){return Td(Ro(r),e)}(r,e)}throw Vu(r)}(r,e):Si(r)}function Id(...r){const e=ja(r),t=function Bg(r,e){return"number"==typeof Wu(r)?r.pop():e}(r,1/0),n=r;return n.length?1===n.length?Si(n[0]):Wa(t)(gr(n,e)):$s}function Ai(r){return r<=0?()=>$s:Se((e,t)=>{let n=0;e.subscribe(new Ie(t,i=>{++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function ju(r={}){const{connector:e=(()=>new ke),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:i=!0}=r;return s=>{let o=null,a=null,l=null,c=0,d=!1,b=!1;const N=()=>{null==a||a.unsubscribe(),a=null},F=()=>{N(),o=l=null,d=b=!1},G=()=>{const W=o;F(),null==W||W.unsubscribe()};return Se((W,ie)=>{c++,!b&&!d&&N();const he=l=null!=l?l:e();ie.add(()=>{c--,0===c&&!b&&!d&&(a=Dl(G,i))}),he.subscribe(ie),o||(o=new me({next:de=>he.next(de),error:de=>{b=!0,N(),a=Dl(F,t,de),he.error(de)},complete:()=>{d=!0,N(),a=Dl(F,n),he.complete()}}),gr(W).subscribe(o))})(s)}}function Dl(r,e,...t){return!0===e?(r(),null):!1===e?null:e(...t).pipe(Ai(1)).subscribe(()=>r())}function An(r){for(let e in r)if(r[e]===An)return e;throw Error("Could not find renamed property on target object.")}function Nc(r,e){for(const t in e)e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&(r[t]=e[t])}function pn(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(pn).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const e=r.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function To(r,e){return null==r||""===r?null===e?"":e:null==e||""===e?r:r+" "+e}const _c=An({__forward_ref__:An});function ia(r){return r.__forward_ref__=ia,r.toString=function(){return pn(this())},r}function z(r){return Gt(r)?r():r}function Gt(r){return"function"==typeof r&&r.hasOwnProperty(_c)&&r.__forward_ref__===ia}class ot extends Error{constructor(e,t){super(function Ks(r,e){return`NG0${Math.abs(r)}${e?": "+e:""}`}(e,t)),this.code=e}}function bt(r){return"string"==typeof r?r:null==r?"":String(r)}function ze(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():bt(r)}function zu(r,e){const t=e?` in ${e}`:"";throw new ot(-201,`No provider for ${ze(r)} found${t}`)}function Ci(r,e){null==r&&function Rn(r,e,t,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,r,null,"!=")}function gt(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Un(r){return{providers:r.providers||[],imports:r.imports||[]}}function Mc(r){return xd(r,mn)||xd(r,Ld)}function xd(r,e){return r.hasOwnProperty(e)?r[e]:null}function Pn(r){return r&&(r.hasOwnProperty(Fc)||r.hasOwnProperty($g))?r[Fc]:null}const mn=An({\u0275prov:An}),Fc=An({\u0275inj:An}),Ld=An({ngInjectableDef:An}),$g=An({ngInjectorDef:An});var It=(()=>((It=It||{})[It.Default=0]="Default",It[It.Host=1]="Host",It[It.Self=2]="Self",It[It.SkipSelf=4]="SkipSelf",It[It.Optional=8]="Optional",It))();let Ju;function Js(r){const e=Ju;return Ju=r,e}function Ze(r,e,t){const n=Mc(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&It.Optional?null:void 0!==e?e:void zu(pn(r),"Injector")}function bs(r){return{toString:r}.toString()}var Y=(()=>((Y=Y||{})[Y.OnPush=0]="OnPush",Y[Y.Default=1]="Default",Y))(),oe=(()=>{return(r=oe||(oe={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",oe;var r})();const Pe="undefined"!=typeof globalThis&&globalThis,Ce="undefined"!=typeof window&&window,it="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,dt=Pe||"undefined"!=typeof global&&global||Ce||it,kr={},Dt=[],Ri=An({\u0275cmp:An}),Bc=An({\u0275dir:An}),Zr=An({\u0275pipe:An}),Ti=An({\u0275mod:An}),qs=An({\u0275fac:An}),Nn=An({__NG_ELEMENT_ID__:An});let za=0;function Zn(r){return bs(()=>{const t={},n={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===Y.OnPush,directiveDefs:null,pipeDefs:null,selectors:r.selectors||Dt,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||oe.Emulated,id:"c",styles:r.styles||Dt,_:null,setInput:null,schemas:r.schemas||null,tView:null},i=r.directives,s=r.features,o=r.pipes;return n.id+=za++,n.inputs=qu(r.inputs,t),n.outputs=qu(r.outputs),s&&s.forEach(a=>a(n)),n.directiveDefs=i?()=>("function"==typeof i?i():i).map(Md):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map(SE):null,n})}function Md(r){return Gr(r)||function oa(r){return r[Bc]||null}(r)}function SE(r){return function aa(r){return r[Zr]||null}(r)}const AE={};function pr(r){return bs(()=>{const e={type:r.type,bootstrap:r.bootstrap||Dt,declarations:r.declarations||Dt,imports:r.imports||Dt,exports:r.exports||Dt,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null};return null!=r.id&&(AE[r.id]=r.type),e})}function qu(r,e){if(null==r)return kr;const t={};for(const n in r)if(r.hasOwnProperty(n)){let i=r[n],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=n,e&&(e[i]=s)}return t}const Mn=Zn;function Gr(r){return r[Ri]||null}function Bi(r,e){const t=r[Ti]||null;if(!t&&!0===e)throw new Error(`Type ${pn(r)} does not have '\u0275mod' property.`);return t}function No(r){return Array.isArray(r)&&"object"==typeof r[1]}function Qs(r){return Array.isArray(r)&&!0===r[1]}function qg(r){return 0!=(8&r.flags)}function Fd(r){return 2==(2&r.flags)}function Gl(r){return 1==(1&r.flags)}function we(r){return null!==r.template}function Ge(r){return 0!=(512&r[2])}function Vi(r,e){return r.hasOwnProperty(qs)?r[qs]:null}class Bd{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function ca(){return th}function th(r){return r.type.prototype.ngOnChanges&&(r.setInput=OE),TE}function TE(){const r=np(this),e=null==r?void 0:r.current;if(e){const t=r.previous;if(t===kr)r.previous=e;else for(let n in e)t[n]=e[n];r.current=null,this.ngOnChanges(e)}}function OE(r,e,t,n){const i=np(r)||function rh(r,e){return r[nh]=e}(r,{previous:kr,current:null}),s=i.current||(i.current={}),o=i.previous,a=this.declaredInputs[t],l=o[a];s[a]=new Bd(l&&l.currentValue,e,o===kr),r[n]=e}ca.ngInherit=!0;const nh="__ngSimpleChanges__";function np(r){return r[nh]||null}let sp;function jt(r){return!!r.listen}const Hr={createRenderer:(r,e)=>function op(){return void 0!==sp?sp:"undefined"!=typeof document?document:void 0}()};function mr(r){for(;Array.isArray(r);)r=r[0];return r}function Uc(r,e){return mr(e[r])}function ti(r,e){return mr(e[r.index])}function $a(r,e){return r.data[e]}function Yr(r,e){const t=e[r];return No(t)?t:t[0]}function ih(r){return 4==(4&r[2])}function Ka(r){return 128==(128&r[2])}function Ja(r,e){return null==e?null:r[e]}function NE(r){r[18]=0}function lp(r,e){r[5]+=e;let t=r,n=r[3];for(;null!==n&&(1===e&&1===t[5]||-1===e&&0===t[5]);)n[5]+=e,t=n,n=n[3]}const Nt={lFrame:BE(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Vl(){return Nt.bindingsEnabled}function Be(){return Nt.lFrame.lView}function ln(){return Nt.lFrame.tView}function Ts(r){return Nt.lFrame.contextLView=r,r[8]}function Sr(){let r=qa();for(;null!==r&&64===r.type;)r=r.parent;return r}function qa(){return Nt.lFrame.currentTNode}function Do(r,e){const t=Nt.lFrame;t.currentTNode=r,t.isParent=e}function up(){return Nt.lFrame.isParent}function hp(){Nt.lFrame.isParent=!1}function Hd(){return Nt.isInCheckNoChangesMode}function Yd(r){Nt.isInCheckNoChangesMode=r}function Hi(){return Nt.lFrame.bindingIndex++}function sb(r,e){const t=Nt.lFrame;t.bindingIndex=t.bindingRootIndex=r,ga(e)}function ga(r){Nt.lFrame.currentDirectiveIndex=r}function dp(r){const e=Nt.lFrame.currentDirectiveIndex;return-1===e?null:r[e]}function LE(){return Nt.lFrame.currentQueryIndex}function ss(r){Nt.lFrame.currentQueryIndex=r}function ab(r){const e=r[1];return 2===e.type?e.declTNode:1===e.type?r[6]:null}function ME(r,e,t){if(t&It.SkipSelf){let i=e,s=r;for(;!(i=i.parent,null!==i||t&It.Host||(i=ab(s),null===i||(s=s[15],10&i.type))););if(null===i)return!1;e=i,r=s}const n=Nt.lFrame=FE();return n.currentTNode=e,n.lView=r,!0}function Ud(r){const e=FE(),t=r[1];Nt.lFrame=e,e.currentTNode=t.firstChild,e.lView=r,e.tView=t,e.contextLView=r,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function FE(){const r=Nt.lFrame,e=null===r?null:r.child;return null===e?BE(r):e}function BE(r){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=e),e}function fp(){const r=Nt.lFrame;return Nt.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const gp=fp;function Wd(){const r=fp();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function Ar(){return Nt.lFrame.selectedIndex}function Zs(r){Nt.lFrame.selectedIndex=r}function er(){const r=Nt.lFrame;return $a(r.tView,r.selectedIndex)}function tr(){Nt.lFrame.currentNamespace="svg"}function jd(r,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=r.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(r.contentHooks||(r.contentHooks=[])).push(-t,o),a&&((r.contentHooks||(r.contentHooks=[])).push(t,a),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(t,a)),l&&(r.viewHooks||(r.viewHooks=[])).push(-t,l),c&&((r.viewHooks||(r.viewHooks=[])).push(t,c),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(t,c)),null!=d&&(r.destroyHooks||(r.destroyHooks=[])).push(t,d)}}function ah(r,e,t){ma(r,e,3,t)}function lh(r,e,t,n){(3&r[2])===t&&ma(r,e,t,n)}function Yl(r,e){let t=r[2];(3&t)===e&&(t&=2047,t+=1,r[2]=t)}function ma(r,e,t,n){const s=null!=n?n:-1,o=e.length-1;let a=0;for(let l=void 0!==n?65535&r[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=n&&a>=n)break}else e[l]<0&&(r[18]+=65536),(a<s||-1==s)&&(kE(r,t,e,l),r[18]=(4294901760&r[18])+l+2),l++}function kE(r,e,t,n){const i=t[n]<0,s=t[n+1],a=r[i?-t[n]:t[n]];if(i){if(r[2]>>11<r[18]>>16&&(3&r[2])===e){r[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Xa{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function Lo(r,e,t){const n=jt(r);let i=0;for(;i<t.length;){const s=t[i];if("number"==typeof s){if(0!==s)break;i++;const o=t[i++],a=t[i++],l=t[i++];n?r.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++i];Ur(o)?n&&r.setProperty(e,o,a):n?r.setAttribute(e,o,a):e.setAttribute(o,a),i++}}return i}function Ep(r){return 3===r||4===r||6===r}function Ur(r){return 64===r.charCodeAt(0)}function Wc(r,e){if(null!==e&&0!==e.length)if(null===r||0===r.length)r=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t=i:0===t||YE(r,t,i,null,-1===t||2===t?e[++n]:null)}}return r}function YE(r,e,t,n,i){let s=0,o=r.length;if(-1===e)o=-1;else for(;s<r.length;){const a=r[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<r.length;){const a=r[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==i&&(r[s+1]=i));if(n===r[s+1])return void(r[s+2]=i)}s++,null!==n&&s++,null!==i&&s++}-1!==o&&(r.splice(o,0,e),s=o+1),r.splice(s++,0,t),null!==n&&r.splice(s++,0,n),null!==i&&r.splice(s++,0,i)}function UE(r){return-1!==r}function jc(r){return 32767&r}function zc(r,e){let t=function wp(r){return r>>16}(r),n=e;for(;t>0;)n=n[15],t--;return n}let Ul=!0;function uh(r){const e=Ul;return Ul=r,e}let hb=0;function Wl(r,e){const t=vp(r,e);if(-1!==t)return t;const n=e[1];n.firstCreatePass&&(r.injectorIndex=e.length,zd(n.data,r),zd(e,null),zd(n.blueprint,null));const i=$d(r,e),s=r.injectorIndex;if(UE(i)){const o=jc(i),a=zc(i,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=i,s}function zd(r,e){r.push(0,0,0,0,0,0,0,0,e)}function vp(r,e){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===e[r.injectorIndex+8]?-1:r.injectorIndex}function $d(r,e){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let t=0,n=null,i=e;for(;null!==i;){const s=i[1],o=s.type;if(n=2===o?s.declTNode:1===o?i[6]:null,null===n)return-1;if(t++,i=i[15],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return-1}function Kd(r,e,t){!function db(r,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Nn)&&(n=t[Nn]),null==n&&(n=t[Nn]=hb++);const i=255&n;e.data[r+(i>>5)]|=1<<i}(r,e,t)}function Jd(r,e,t){if(t&It.Optional)return r;zu(e,"NodeInjector")}function zE(r,e,t,n){if(t&It.Optional&&void 0===n&&(n=null),0==(t&(It.Self|It.Host))){const i=r[9],s=Js(void 0);try{return i?i.get(e,n,t&It.Optional):Ze(e,n,t&It.Optional)}finally{Js(s)}}return Jd(n,e,t)}function qd(r,e,t,n=It.Default,i){if(null!==r){const s=function JE(r){if("string"==typeof r)return r.charCodeAt(0)||0;const e=r.hasOwnProperty(Nn)?r[Nn]:void 0;return"number"==typeof e?e>=0?255&e:$E:e}(t);if("function"==typeof s){if(!ME(e,r,n))return n&It.Host?Jd(i,t,n):zE(e,t,n,i);try{const o=s(n);if(null!=o||n&It.Optional)return o;zu(t)}finally{gp()}}else if("number"==typeof s){let o=null,a=vp(r,e),l=-1,c=n&It.Host?e[16][6]:null;for((-1===a||n&It.SkipSelf)&&(l=-1===a?$d(r,e):e[a+8],-1!==l&&qE(n,!1)?(o=e[1],a=jc(l),e=zc(l,e)):a=-1);-1!==a;){const d=e[1];if(Ap(s,a,d.data)){const b=KE(a,e,t,o,n,c);if(b!==Sp)return b}l=e[a+8],-1!==l&&qE(n,e[1].data[a+8]===c)&&Ap(s,a,e)?(o=d,a=jc(l),e=zc(l,e)):a=-1}}}return zE(e,t,n,i)}const Sp={};function $E(){return new zl(Sr(),Be())}function KE(r,e,t,n,i,s){const o=e[1],a=o.data[r+8],d=jl(a,o,t,null==n?Fd(a)&&Ul:n!=o&&0!=(3&a.type),i&It.Host&&s===a);return null!==d?hh(e,o,d,a):Sp}function jl(r,e,t,n,i){const s=r.providerIndexes,o=e.data,a=1048575&s,l=r.directiveStart,d=s>>20,N=i?a+d:r.directiveEnd;for(let F=n?a:a+d;F<N;F++){const G=o[F];if(F<l&&t===G||F>=l&&G.type===t)return F}if(i){const F=o[l];if(F&&we(F)&&F.type===t)return l}return null}function hh(r,e,t,n){let i=r[t];const s=e.data;if(function ub(r){return r instanceof Xa}(i)){const o=i;o.resolving&&function xl(r,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new ot(-200,`Circular dependency in DI detected for ${r}${t}`)}(ze(s[t]));const a=uh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Js(o.injectImpl):null;ME(r,n,It.Default);try{i=r[t]=o.factory(void 0,s,r,n),e.firstCreatePass&&t>=n.directiveStart&&function Os(r,e,t){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(n){const o=th(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(r,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(r,o)}i&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-r,i),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(r,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(r,s))}(t,s[t],e)}finally{null!==l&&Js(l),uh(a),o.resolving=!1,gp()}}return i}function Ap(r,e,t){return!!(t[e+(r>>5)]&1<<r)}function qE(r,e){return!(r&It.Self||r&It.Host&&e)}class zl{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return qd(this._tNode,this._lView,e,n,t)}}function bp(r){return bs(()=>{const e=r.prototype.constructor,t=e[qs]||dh(e),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const s=i[qs]||dh(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function dh(r){return Gt(r)?()=>{const e=dh(z(r));return e&&e()}:Vi(r)}function $l(r){return function jE(r,e){if("class"===e)return r.classes;if("style"===e)return r.styles;const t=r.attrs;if(t){const n=t.length;let i=0;for(;i<n;){const s=t[i];if(Ep(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<n&&"string"==typeof t[i];)i++;else{if(s===e)return t[i+1];i+=2}}}return null}(Sr(),r)}const Kc="__parameters__";function Jc(r,e,t){return bs(()=>{const n=function Cp(r){return function(...t){if(r){const n=r(...t);for(const i in n)this[i]=n[i]}}}(e);function i(...s){if(this instanceof i)return n.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(l,c,d){const b=l.hasOwnProperty(Kc)?l[Kc]:Object.defineProperty(l,Kc,{value:[]})[Kc];for(;b.length<=d;)b.push(null);return(b[d]=b[d]||[]).push(o),l}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}class pt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=gt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const fb=new pt("AnalyzeForEntryComponents");function os(r,e){void 0===e&&(e=r);for(let t=0;t<r.length;t++){let n=r[t];Array.isArray(n)?(e===r&&(e=r.slice(0,t)),os(n,e)):e!==r&&e.push(n)}return e}function Is(r,e){r.forEach(t=>Array.isArray(t)?Is(t,e):e(t))}function Zd(r,e,t){e>=r.length?r.push(t):r.splice(e,0,t)}function to(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function fh(r,e){const t=[];for(let n=0;n<r;n++)t.push(e);return t}function as(r,e,t){let n=Jl(r,e);return n>=0?r[1|n]=t:(n=~n,function ew(r,e,t,n){let i=r.length;if(i==e)r.push(t,n);else if(1===i)r.push(n,r[0]),r[0]=t;else{for(i--,r.push(r[i-1],r[i]);i>e;)r[i]=r[i-2],i--;r[e]=t,r[e+1]=n}}(r,n,e,t)),n}function ef(r,e){const t=Jl(r,e);if(t>=0)return r[1|t]}function Jl(r,e){return function Op(r,e,t){let n=0,i=r.length>>t;for(;i!==n;){const s=n+(i-n>>1),o=r[s<<t];if(e===o)return s<<t;o>e?i=s:n=s+1}return~(i<<t)}(r,e,1)}const mh={},tf="__NG_DI_FLAG__",Ea="ngTempTokenPath",vb=/\n/gm,Ip="__source",nf=An({provide:String,useValue:An});let qc;function Eh(r){const e=qc;return qc=r,e}function Pp(r,e=It.Default){if(void 0===qc)throw new ot(203,"");return null===qc?Ze(r,void 0,e):qc.get(r,e&It.Optional?null:void 0,e)}function $e(r,e=It.Default){return(function Kg(){return Ju}()||Pp)(z(r),e)}const wh=$e;function Qc(r){const e=[];for(let t=0;t<r.length;t++){const n=z(r[t]);if(Array.isArray(n)){if(0===n.length)throw new ot(900,"");let i,s=It.Default;for(let o=0;o<n.length;o++){const a=n[o],l=Np(a);"number"==typeof l?-1===l?i=a.token:s|=l:i=a}e.push($e(i,s))}else e.push($e(n))}return e}function Xc(r,e){return r[tf]=e,r.prototype[tf]=e,r}function Np(r){return r[tf]}const Ps=Xc(Jc("Inject",r=>({token:r})),-1),Ns=Xc(Jc("Optional"),8),Zc=Xc(Jc("SkipSelf"),4);let af;function Ql(r){var e;return(null===(e=function Bp(){if(void 0===af&&(af=null,dt.trustedTypes))try{af=dt.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch(r){}return af}())||void 0===e?void 0:e.createHTML(r))||r}class Xl{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Gp extends Xl{getTypeName(){return"HTML"}}class bb extends Xl{getTypeName(){return"Style"}}class Cb extends Xl{getTypeName(){return"Script"}}class vh extends Xl{getTypeName(){return"URL"}}class hw extends Xl{getTypeName(){return"ResourceURL"}}function Ui(r){return r instanceof Xl?r.changingThisBreaksApplicationSecurity:r}function ko(r,e){const t=dw(r);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}function dw(r){return r instanceof Xl&&r.getTypeName()||null}class pw{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Ql(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class Sh{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const n=this.inertDocument.createElement("body");t.appendChild(n)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Ql(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=Ql(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let i=t.length-1;0<i;i--){const o=t.item(i).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const mw=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,hf=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function eu(r){return(r=String(r)).match(mw)||r.match(hf)?r:"unsafe:"+r}function ii(r){const e={};for(const t of r.split(","))e[t]=!0;return e}function Ah(...r){const e={};for(const t of r)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const Hp=ii("area,br,col,hr,img,wbr"),yw=ii("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Ew=ii("rp,rt"),Yp=Ah(Hp,Ah(yw,ii("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Ah(Ew,ii("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Ah(Ew,yw)),Up=ii("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Wp=ii("srcset"),ww=Ah(Up,Wp,ii("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ii("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),vw=ii("script,style,template");class Sw{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!Yp.hasOwnProperty(t))return this.sanitizedSomething=!0,!vw.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let i=0;i<n.length;i++){const s=n.item(i),o=s.name,a=o.toLowerCase();if(!ww.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;Up[a]&&(l=eu(l)),Wp[a]&&(r=l,l=(r=String(r)).split(",").map(e=>eu(e.trim())).join(", ")),this.buf.push(" ",o,'="',bw(l),'"')}var r;return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();Yp.hasOwnProperty(t)&&!Hp.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(bw(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const Aw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Pb=/([^\#-~ |!])/g;function bw(r){return r.replace(/&/g,"&amp;").replace(Aw,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(Pb,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let df;function jp(r,e){let t=null;try{df=df||function uf(r){const e=new Sh(r);return function Vp(){try{return!!(new window.DOMParser).parseFromString(Ql(""),"text/html")}catch(r){return!1}}()?new pw(e):e}(r);let n=e?String(e):"";t=df.getInertBodyElement(n);let i=5,s=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=s,s=t.innerHTML,t=df.getInertBodyElement(n)}while(n!==s);return Ql((new Sw).sanitizeChildren(zp(t)||t))}finally{if(t){const n=zp(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function zp(r){return"content"in r&&function Nb(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var yn=(()=>((yn=yn||{})[yn.NONE=0]="NONE",yn[yn.HTML=1]="HTML",yn[yn.STYLE=2]="STYLE",yn[yn.SCRIPT=3]="SCRIPT",yn[yn.URL=4]="URL",yn[yn.RESOURCE_URL=5]="RESOURCE_URL",yn))();const Tw="__ngContext__";function si(r,e){r[Tw]=e}function Jp(r){const e=function Ch(r){return r[Tw]||null}(r);return e?Array.isArray(e)?e:e.lView:null}function Qp(r){return r.ngOriginalError}function Xp(r,...e){r.error(...e)}class va{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=function jb(r){return r&&r.ngErrorLogger||Xp}(e);n(this._console,"ERROR",e),t&&n(this._console,"ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Qp(e);for(;t&&Qp(t);)t=Qp(t);return t||null}}const ff=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(dt))();function tu(r){return r.ownerDocument}function Go(r){return r instanceof Function?r():r}var cs=(()=>((cs=cs||{})[cs.Important=1]="Important",cs[cs.DashCase=2]="DashCase",cs))();function em(r,e){return undefined(r,e)}function Rh(r){const e=r[3];return Qs(e)?e[3]:e}function gf(r){return Mw(r[13])}function nm(r){return Mw(r[4])}function Mw(r){for(;null!==r&&!Qs(r);)r=r[4];return r}function ru(r,e,t,n,i){if(null!=n){let s,o=!1;Qs(n)?s=n:No(n)&&(o=!0,n=n[0]);const a=mr(n);0===r&&null!==t?null==i?am(e,t,a):rl(e,t,a,i||null,!0):1===r&&null!==t?rl(e,t,a,i||null,!0):2===r?function Yw(r,e,t){const n=mf(r,e);n&&function uC(r,e,t,n){jt(r)?r.removeChild(e,t,n):e.removeChild(t)}(r,n,e,t)}(e,a,o):3===r&&e.destroyNode(a),null!=s&&function fC(r,e,t,n,i){const s=t[7];s!==mr(t)&&ru(e,r,n,s,i);for(let a=10;a<t.length;a++){const l=t[a];Nh(l[1],l,r,e,n,s)}}(e,r,s,t,i)}}function rm(r,e,t){if(jt(r))return r.createElement(e,t);{const n=null!==t?function ip(r){const e=r.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(t):null;return null===n?r.createElement(e):r.createElementNS(n,e)}}function Bw(r,e){const t=r[9],n=t.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,lp(i,-1)),t.splice(n,1)}function im(r,e){if(r.length<=10)return;const t=10+e,n=r[t];if(n){const i=n[17];null!==i&&i!==r&&Bw(i,n),e>0&&(r[t-1][4]=n[4]);const s=to(r,10+e);!function iC(r,e){Nh(r,e,e[11],2,null,null),e[0]=null,e[6]=null}(n[1],n);const o=s[19];null!==o&&o.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-129}return n}function Th(r,e){if(!(256&e[2])){const t=e[11];jt(t)&&t.destroyNode&&Nh(r,e,t,3,null,null),function aC(r){let e=r[13];if(!e)return sm(r[1],r);for(;e;){let t=null;if(No(e))t=e[13];else{const n=e[10];n&&(t=n)}if(!t){for(;e&&!e[4]&&e!==r;)No(e)&&sm(e[1],e),e=e[3];null===e&&(e=r),No(e)&&sm(e[1],e),t=e&&e[4]}e=t}}(e)}}function sm(r,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function Gw(r,e){let t;if(null!=r&&null!=(t=r.destroyHooks))for(let n=0;n<t.length;n+=2){const i=e[t[n]];if(!(i instanceof Xa)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(i)}finally{}}}}(r,e),function kw(r,e){const t=r.cleanup,n=e[7];let i=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):mr(e[o]),l=n[i=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?n[i=c]():n[i=-c].unsubscribe(),s+=2}else{const o=n[i=t[s+1]];t[s].call(o)}if(null!==n){for(let s=i+1;s<n.length;s++)n[s]();e[7]=null}}(r,e),1===e[1].type&&jt(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Qs(e[3])){t!==e[3]&&Bw(t,e);const n=e[19];null!==n&&n.detachView(r)}}}function pf(r,e,t){return function om(r,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[0];if(2&n.flags){const i=r.data[n.directiveStart].encapsulation;if(i===oe.None||i===oe.Emulated)return null}return ti(n,t)}(r,e.parent,t)}function rl(r,e,t,n,i){jt(r)?r.insertBefore(e,t,n,i):e.insertBefore(t,n,i)}function am(r,e,t){jt(r)?r.appendChild(e,t):e.appendChild(t)}function lm(r,e,t,n,i){null!==n?rl(r,e,t,n,i):am(r,e,t)}function mf(r,e){return jt(r)?r.parentNode(e):e.parentNode}function Oh(r,e,t){return Vw(r,e,t)}let Vw=function Ih(r,e,t){return 40&r.type?ti(r,t):null};function Ph(r,e,t,n){const i=pf(r,n,e),s=e[11],a=Oh(n.parent||e[6],n,e);if(null!=i)if(Array.isArray(t))for(let l=0;l<t.length;l++)lm(s,i,t[l],a,!1);else lm(s,i,t,a,!1)}function Ef(r,e){if(null!==e){const t=e.type;if(3&t)return ti(e,r);if(4&t)return um(-1,r[e.index]);if(8&t){const n=e.child;if(null!==n)return Ef(r,n);{const i=r[e.index];return Qs(i)?um(-1,i):mr(i)}}if(32&t)return em(e,r)()||mr(r[e.index]);{const n=Hw(r,e);return null!==n?Array.isArray(n)?n[0]:Ef(Rh(r[16]),n):Ef(r,e.next)}}return null}function Hw(r,e){return null!==e?r[16][6].projection[e.projection]:null}function um(r,e){const t=10+r+1;if(t<e.length){const n=e[t],i=n[1].firstChild;if(null!==i)return Ef(n,i)}return e[7]}function hm(r,e,t,n,i,s,o){for(;null!=t;){const a=n[t.index],l=t.type;if(o&&0===e&&(a&&si(mr(a),n),t.flags|=4),64!=(64&t.flags))if(8&l)hm(r,e,t.child,n,i,s,!1),ru(e,r,i,a,s);else if(32&l){const c=em(t,n);let d;for(;d=c();)ru(e,r,i,d,s);ru(e,r,i,a,s)}else 16&l?Uw(r,e,n,t,i,s):ru(e,r,i,a,s);t=o?t.projectionNext:t.next}}function Nh(r,e,t,n,i,s){hm(t,n,r.firstChild,e,i,s,!1)}function Uw(r,e,t,n,i,s){const o=t[16],l=o[6].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)ru(e,r,i,l[c],s);else hm(r,e,l,o[3],i,s,!0)}function Ww(r,e,t){jt(r)?r.setAttribute(e,"style",t):e.style.cssText=t}function dm(r,e,t){jt(r)?""===t?r.removeAttribute(e,"class"):r.setAttribute(e,"class",t):e.className=t}function Ds(r,e,t){let n=r.length;for(;;){const i=r.indexOf(e,t);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const s=e.length;if(i+s===n||r.charCodeAt(i+s)<=32)return i}t=i+1}}const jw="ng-template";function Zl(r,e,t){let n=0;for(;n<r.length;){let i=r[n++];if(t&&"class"===i){if(i=r[n],-1!==Ds(i.toLowerCase(),e,0))return!0}else if(1===i){for(;n<r.length&&"string"==typeof(i=r[n++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function Ft(r){return 4===r.type&&r.value!==jw}function pC(r,e,t){return e===(4!==r.type||t?r.value:jw)}function Wi(r,e,t){let n=4;const i=r.attrs||[],s=function EC(r){for(let e=0;e<r.length;e++)if(Ep(r[e]))return e;return r.length}(i);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!pC(r,l,t)||""===l&&1===e.length){if(En(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==r.attrs){if(!Zl(r.attrs,c,t)){if(En(n))return!1;o=!0}continue}const b=mC(8&n?"class":l,i,Ft(r),t);if(-1===b){if(En(n))return!1;o=!0;continue}if(""!==c){let N;N=b>s?"":i[b+1].toLowerCase();const F=8&n?N:null;if(F&&-1!==Ds(F,c,0)||2&n&&c!==N){if(En(n))return!1;o=!0}}}}else{if(!o&&!En(n)&&!En(l))return!1;if(o&&En(l))continue;o=!1,n=l|1&n}}return En(n)||o}function En(r){return 0==(1&r)}function mC(r,e,t,n){if(null===e)return-1;let i=0;if(n||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===r)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function wC(r,e){let t=r.indexOf(4);if(t>-1)for(t++;t<r.length;){const n=r[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,r)}function Sa(r,e,t=!1){for(let n=0;n<e.length;n++)if(Wi(r,e[n],t))return!0;return!1}function vC(r,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function zw(r,e){return r?":not("+e.trim()+")":e}function fm(r){let e=r[0],t=1,n=2,i="",s=!1;for(;t<r.length;){let o=r[t];if("string"==typeof o)if(2&n){const a=r[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+o:4&n&&(i+=" "+o);else""!==i&&!En(o)&&(e+=zw(s,i),i=""),n=o,s=s||!En(n);t++}return""!==i&&(e+=zw(s,i)),e}const xt={};function Qt(r){jn(ln(),Be(),Ar()+r,Hd())}function jn(r,e,t,n){if(!n)if(3==(3&e[2])){const s=r.preOrderCheckHooks;null!==s&&ah(e,s,t)}else{const s=r.preOrderHooks;null!==s&&lh(e,s,0,t)}Zs(t)}function _h(r,e){return r<<17|e<<2}function ro(r){return r>>17&32767}function gm(r){return 2|r}function ba(r){return(131068&r)>>2}function pm(r,e){return-131069&r|e<<2}function ec(r){return 1|r}function tv(r,e){const t=r.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const i=t[n],s=t[n+1];if(-1!==s){const o=r.data[s];ss(i),o.contentQueries(2,e[s],s)}}}function Lh(r,e,t,n,i,s,o,a,l,c){const d=e.blueprint.slice();return d[0]=i,d[2]=140|n,NE(d),d[3]=d[15]=r,d[8]=t,d[10]=o||r&&r[10],d[11]=a||r&&r[11],d[12]=l||r&&r[12]||null,d[9]=c||r&&r[9]||null,d[6]=s,d[16]=2==e.type?r[16]:d,d}function su(r,e,t,n,i){let s=r.data[e];if(null===s)s=function Sm(r,e,t,n,i){const s=qa(),o=up(),l=r.data[e]=function LC(r,e,t,n,i,s){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,i);return null===r.firstChild&&(r.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(r,e,t,n,i),function ib(){return Nt.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=n,s.attrs=i;const o=function oh(){const r=Nt.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Do(s,!0),s}function nc(r,e,t,n){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(n),r.blueprint.push(n),r.data.push(null);return i}function Mh(r,e,t){Ud(e);try{const n=r.viewQuery;null!==n&&Mm(1,n,t);const i=r.template;null!==i&&Am(r,e,i,1,t),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&tv(r,e),r.staticViewQueries&&Mm(2,r.viewQuery,t);const s=r.components;null!==s&&function nv(r,e){for(let t=0;t<e.length;t++)QC(r,e[t])}(e,s)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{e[2]&=-5,Wd()}}function ou(r,e,t,n){const i=e[2];if(256==(256&i))return;Ud(e);const s=Hd();try{NE(e),function DE(r){return Nt.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==t&&Am(r,e,t,2,n);const o=3==(3&i);if(!s)if(o){const c=r.preOrderCheckHooks;null!==c&&ah(e,c,null)}else{const c=r.preOrderHooks;null!==c&&lh(e,c,0,null),Yl(e,0)}if(function JC(r){for(let e=gf(r);null!==e;e=nm(e)){if(!e[2])continue;const t=e[9];for(let n=0;n<t.length;n++){const i=t[n],s=i[3];0==(1024&i[2])&&lp(s,1),i[2]|=1024}}}(e),function KC(r){for(let e=gf(r);null!==e;e=nm(e))for(let t=10;t<e.length;t++){const n=e[t],i=n[1];Ka(n)&&ou(i,n,i.template,n[8])}}(e),null!==r.contentQueries&&tv(r,e),!s)if(o){const c=r.contentCheckHooks;null!==c&&ah(e,c)}else{const c=r.contentHooks;null!==c&&lh(e,c,1),Yl(e,1)}!function _C(r,e){const t=r.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const i=t[n];if(i<0)Zs(~i);else{const s=i,o=t[++n],a=t[++n];sb(o,s),a(2,e[s])}}}finally{Zs(-1)}}(r,e);const a=r.components;null!==a&&function DC(r,e){for(let t=0;t<e.length;t++)qC(r,e[t])}(e,a);const l=r.viewQuery;if(null!==l&&Mm(2,l,n),!s)if(o){const c=r.viewCheckHooks;null!==c&&ah(e,c)}else{const c=r.viewHooks;null!==c&&lh(e,c,2),Yl(e,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,lp(e[3],-1))}finally{Wd()}}function xC(r,e,t,n){const i=e[10],s=!Hd(),o=ih(e);try{s&&!o&&i.begin&&i.begin(),o&&Mh(r,e,n),ou(r,e,t,n)}finally{s&&!o&&i.end&&i.end()}}function Am(r,e,t,n,i){const s=Ar(),o=2&n;try{Zs(-1),o&&e.length>20&&jn(r,e,20,Hd()),t(n,i)}finally{Zs(s)}}function bm(r,e,t){if(qg(e)){const i=e.directiveEnd;for(let s=e.directiveStart;s<i;s++){const o=r.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function Cm(r,e,t){!Vl()||(function VC(r,e,t,n){const i=t.directiveStart,s=t.directiveEnd;r.firstCreatePass||Wl(t,e),si(n,e);const o=t.initialInputs;for(let a=i;a<s;a++){const l=r.data[a],c=we(l);c&&jC(e,t,l);const d=hh(e,r,a,t);si(d,e),null!==o&&zC(0,a-i,d,l,0,o),c&&(Yr(t.index,e)[8]=d)}}(r,e,t,ti(t,e)),128==(128&t.flags)&&function HC(r,e,t){const n=t.directiveStart,i=t.directiveEnd,o=t.index,a=function ob(){return Nt.lFrame.currentDirectiveIndex}();try{Zs(o);for(let l=n;l<i;l++){const c=r.data[l],d=e[l];ga(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&uv(c,d)}}finally{Zs(-1),ga(a)}}(r,e,t))}function Rm(r,e,t=ti){const n=e.localNames;if(null!==n){let i=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,r):r[o];r[i++]=a}}}function rv(r){const e=r.tView;return null===e||e.incompleteFirstPass?r.tView=vf(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):e}function vf(r,e,t,n,i,s,o,a,l,c){const d=20+n,b=d+i,N=function au(r,e){const t=[];for(let n=0;n<e;n++)t.push(n<r?null:xt);return t}(d,b),F="function"==typeof c?c():c;return N[1]={type:r,blueprint:N,template:t,queries:null,viewQuery:a,declTNode:e,data:N.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:b,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:F,incompleteFirstPass:!1}}function ov(r,e,t,n){const i=mv(e);null===t?i.push(n):(i.push(t),r.firstCreatePass&&yv(r).push(n,i.length-1))}function Tm(r,e,t){for(let n in r)if(r.hasOwnProperty(n)){const i=r[n];(t=null===t?{}:t).hasOwnProperty(n)?t[n].push(e,i):t[n]=[e,i]}return t}function us(r,e,t,n,i,s,o,a){const l=ti(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[n])?(wv(r,t,d,n,i),Fd(e)&&function FC(r,e){const t=Yr(e,r);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(n=function MC(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=o?o(i,e.value||"",n):i,jt(s)?s.setProperty(l,n,i):Ur(n)||(l.setProperty?l.setProperty(n,i):l[n]=i))}function Om(r,e,t,n){let i=!1;if(Vl()){const s=function YC(r,e,t){const n=r.directiveRegistry;let i=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];Sa(t,o.selectors,!1)&&(i||(i=[]),Kd(Wl(t,e),r,o.type),we(o)?(hv(r,t),i.unshift(o)):i.push(o))}return i}(r,e,t),o=null===n?null:{"":-1};if(null!==s){i=!0,dv(t,r.data.length,s.length);for(let d=0;d<s.length;d++){const b=s[d];b.providersResolver&&b.providersResolver(b)}let a=!1,l=!1,c=nc(r,e,s.length,null);for(let d=0;d<s.length;d++){const b=s[d];t.mergedAttrs=Wc(t.mergedAttrs,b.hostAttrs),fv(r,t,e,c,b),WC(c,b,o),null!==b.contentQueries&&(t.flags|=8),(null!==b.hostBindings||null!==b.hostAttrs||0!==b.hostVars)&&(t.flags|=128);const N=b.type.prototype;!a&&(N.ngOnChanges||N.ngOnInit||N.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(t.index),a=!0),!l&&(N.ngOnChanges||N.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function av(r,e){const n=e.directiveEnd,i=r.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<n;c++){const d=i[c],b=d.inputs,N=null===s||Ft(e)?null:Pm(b,s);o.push(N),a=Tm(b,c,a),l=Tm(d.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(r,t)}o&&function UC(r,e,t){if(e){const n=r.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new ot(-301,!1);n.push(e[i],s)}}}(t,n,o)}return t.mergedAttrs=Wc(t.mergedAttrs,t.attrs),i}function cv(r,e,t,n,i,s){const o=s.hostBindings;if(o){let a=r.hostBindingOpCodes;null===a&&(a=r.hostBindingOpCodes=[]);const l=~e.index;(function GC(r){let e=r.length;for(;e>0;){const t=r[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(n,i,o)}}function uv(r,e){null!==r.hostBindings&&r.hostBindings(1,e)}function hv(r,e){e.flags|=2,(r.components||(r.components=[])).push(e.index)}function WC(r,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=r;we(e)&&(t[""]=r)}}function dv(r,e,t){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+t,r.providerIndexes=e}function fv(r,e,t,n,i){r.data[n]=i;const s=i.factory||(i.factory=Vi(i.type)),o=new Xa(s,we(i),null);r.blueprint[n]=o,t[n]=o,cv(r,e,0,n,nc(r,t,i.hostVars,xt),i)}function jC(r,e,t){const n=ti(e,r),i=rv(t),s=r[10],o=Sf(r,Lh(r,i,null,t.onPush?64:16,n,e,s,s.createRenderer(n,t),null,null));r[e.index]=o}function Vo(r,e,t,n,i,s){const o=ti(r,e);!function Im(r,e,t,n,i,s,o){if(null==s)jt(r)?r.removeAttribute(e,i,t):e.removeAttribute(i);else{const a=null==o?bt(s):o(s,n||"",i);jt(r)?r.setAttribute(e,i,a,t):t?e.setAttributeNS(t,i,a):e.setAttribute(i,a)}}(e[11],o,s,r.value,t,n,i)}function zC(r,e,t,n,i,s){const o=s[e];if(null!==o){const a=n.setInput;for(let l=0;l<o.length;){const c=o[l++],d=o[l++],b=o[l++];null!==a?n.setInput(t,b,c,d):t[d]=b}}}function Pm(r,e){let t=null,n=0;for(;n<e.length;){const i=e[n];if(0!==i)if(5!==i){if("number"==typeof i)break;r.hasOwnProperty(i)&&(null===t&&(t=[]),t.push(i,r[i],e[n+1])),n+=2}else n+=2;else n+=4}return t}function Nm(r,e,t,n){return new Array(r,!0,!1,e,null,0,n,t,null,null)}function qC(r,e){const t=Yr(e,r);if(Ka(t)){const n=t[1];80&t[2]?ou(n,t,n.template,t[8]):t[5]>0&&Fh(t)}}function Fh(r){for(let n=gf(r);null!==n;n=nm(n))for(let i=10;i<n.length;i++){const s=n[i];if(1024&s[2]){const o=s[1];ou(o,s,o.template,s[8])}else s[5]>0&&Fh(s)}const t=r[1].components;if(null!==t)for(let n=0;n<t.length;n++){const i=Yr(t[n],r);Ka(i)&&i[5]>0&&Fh(i)}}function QC(r,e){const t=Yr(e,r),n=t[1];(function XC(r,e){for(let t=e.length;t<r.blueprint.length;t++)e.push(r.blueprint[t])})(n,t),Mh(n,t,t[8])}function Sf(r,e){return r[13]?r[14][4]=e:r[13]=e,r[14]=e,e}function li(r){for(;r;){r[2]|=64;const e=Rh(r);if(Ge(r)&&!e)return r;r=e}return null}function xm(r,e,t){const n=e[10];n.begin&&n.begin();try{ou(r,e,r.template,t)}catch(i){throw Fm(e,i),i}finally{n.end&&n.end()}}function gv(r){!function Dm(r){for(let e=0;e<r.components.length;e++){const t=r.components[e],n=Jp(t),i=n[1];xC(i,n,i.template,t)}}(r[8])}function Mm(r,e,t){ss(0),e(r,t)}const eR=(()=>Promise.resolve(null))();function mv(r){return r[7]||(r[7]=[])}function yv(r){return r.cleanup||(r.cleanup=[])}function Ev(r,e,t){return(null===r||we(r))&&(t=function PE(r){for(;Array.isArray(r);){if("object"==typeof r[1])return r;r=r[0]}return null}(t[e.index])),t[11]}function Fm(r,e){const t=r[9],n=t?t.get(va,null):null;n&&n.handleError(e)}function wv(r,e,t,n,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=r.data[o];null!==c.setInput?c.setInput(l,i,n,a):l[a]=i}}function Ra(r,e,t){const n=Uc(e,r);!function Fw(r,e,t){jt(r)?r.setValue(e,t):e.textContent=t}(r[11],n,t)}function Af(r,e,t){let n=t?r.styles:null,i=t?r.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=To(i,a):2==s&&(n=To(n,a+": "+e[++o]+";"))}t?r.styles=n:r.stylesWithoutHost=n,t?r.classes=i:r.classesWithoutHost=i}const Gm=new pt("INJECTOR",-1);class vv{get(e,t=mh){if(t===mh){const n=new Error(`NullInjectorError: No provider for ${pn(e)}!`);throw n.name="NullInjectorError",n}return t}}const Vm=new pt("Set Injector scope."),Bh={},tR={};let Hm;function Sv(){return void 0===Hm&&(Hm=new vv),Hm}function Av(r,e=null,t=null,n){const i=bv(r,e,t,n);return i._resolveInjectorDefTypes(),i}function bv(r,e=null,t=null,n){return new nR(r,t,e||Sv(),n)}class nR{constructor(e,t,n,i=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Is(t,a=>this.processProvider(a,e,t)),Is([e],a=>this.processInjectorType(a,[],s)),this.records.set(Gm,lu(void 0,this));const o=this.records.get(Vm);this.scope=null!=o?o.value:null,this.source=i||("object"==typeof e?null:pn(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=mh,n=It.Default){this.assertNotDestroyed();const i=Eh(this),s=Js(void 0);try{if(!(n&It.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function I(r){return"function"==typeof r||"object"==typeof r&&r instanceof pt}(e)&&Mc(e);a=l&&this.injectableDefInScope(l)?lu(Ym(e),Bh):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&It.Self?Sv():this.parent).get(e,t=n&It.Optional&&t===mh?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Ea]=o[Ea]||[]).unshift(pn(e)),i)throw o;return function Sb(r,e,t,n){const i=r[Ea];throw e[Ip]&&i.unshift(e[Ip]),r.message=function ow(r,e,t,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.substr(2):r;let i=pn(e);if(Array.isArray(e))i=e.map(pn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):pn(a)))}i=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${i}]: ${r.replace(vb,"\n  ")}`}("\n"+r.message,i,t,n),r.ngTokenPath=i,r[Ea]=null,r}(o,e,"R3InjectorError",this.source)}throw o}finally{Js(s),Eh(i)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((n,i)=>e.push(pn(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ot(205,!1)}processInjectorType(e,t,n){if(!(e=z(e)))return!1;let i=Pn(e);const s=null==i&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==n.indexOf(o);if(void 0!==s&&(i=Pn(s)),null==i)return!1;if(null!=i.imports&&!a){let d;n.push(o);try{Is(i.imports,b=>{this.processInjectorType(b,t,n)&&(void 0===d&&(d=[]),d.push(b))})}finally{}if(void 0!==d)for(let b=0;b<d.length;b++){const{ngModule:N,providers:F}=d[b];Is(F,G=>this.processProvider(G,N,F||Dt))}}this.injectorDefTypes.add(o);const l=Vi(o)||(()=>new o);this.records.set(o,lu(l,Bh));const c=i.providers;if(null!=c&&!a){const d=e;Is(c,b=>this.processProvider(b,d,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,n){let i=cu(e=z(e))?e:z(e&&e.provide);const s=function iR(r,e,t){return Rv(r)?lu(void 0,r.useValue):lu(Cv(r),Bh)}(e);if(cu(e)||!0!==e.multi)this.records.get(i);else{let o=this.records.get(i);o||(o=lu(void 0,Bh,!0),o.factory=()=>Qc(o.multi),this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,s)}hydrate(e,t){return t.value===Bh&&(t.value=tR,t.value=t.factory()),"object"==typeof t.value&&t.value&&function h(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=z(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function Ym(r){const e=Mc(r),t=null!==e?e.factory:Vi(r);if(null!==t)return t;if(r instanceof pt)throw new ot(204,!1);if(r instanceof Function)return function rR(r){const e=r.length;if(e>0)throw fh(e,"?"),new ot(204,!1);const t=function zg(r){const e=r&&(r[mn]||r[Ld]);if(e){const t=function Oo(r){if(r.hasOwnProperty("name"))return r.name;const e=(""+r).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(r);return null!==t?()=>t.factory(r):()=>new r}(r);throw new ot(204,!1)}function Cv(r,e,t){let n;if(cu(r)){const i=z(r);return Vi(i)||Ym(i)}if(Rv(r))n=()=>z(r.useValue);else if(function oR(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...Qc(r.deps||[]));else if(function sR(r){return!(!r||!r.useExisting)}(r))n=()=>$e(z(r.useExisting));else{const i=z(r&&(r.useClass||r.provide));if(!function u(r){return!!r.deps}(r))return Vi(i)||Ym(i);n=()=>new i(...Qc(r.deps))}return n}function lu(r,e,t=!1){return{factory:r,value:e,multi:t?[]:void 0}}function Rv(r){return null!==r&&"object"==typeof r&&nf in r}function cu(r){return"function"==typeof r}let M=(()=>{class r{static create(t,n){var i;if(Array.isArray(t))return Av({name:""},n,t,"");{const s=null!==(i=t.name)&&void 0!==i?i:"";return Av({name:s},t.parent,t.providers,s)}}}return r.THROW_IF_NOT_FOUND=mh,r.NULL=new vv,r.\u0275prov=gt({token:r,providedIn:"any",factory:()=>$e(Gm)}),r.__NG_ELEMENT_ID__=-1,r})();function mB(r,e){jd(Jp(r)[1],Sr())}function rc(r){let e=function QI(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),t=!0;const n=[r];for(;e;){let i;if(we(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ot(903,"");i=e.\u0275dir}if(i){if(t){n.push(i);const o=r;o.inputs=lR(r.inputs),o.declaredInputs=lR(r.declaredInputs),o.outputs=lR(r.outputs);const a=i.hostBindings;a&&vB(r,a);const l=i.viewQuery,c=i.contentQueries;if(l&&EB(r,l),c&&wB(r,c),Nc(r.inputs,i.inputs),Nc(r.declaredInputs,i.declaredInputs),Nc(r.outputs,i.outputs),we(i)&&i.data.animation){const d=r.data;d.animation=(d.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(r),a===rc&&(t=!1)}}e=Object.getPrototypeOf(e)}!function yB(r){let e=0,t=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=e+=i.hostVars,i.hostAttrs=Wc(i.hostAttrs,t=Wc(t,i.hostAttrs))}}(n)}function lR(r){return r===kr?{}:r===Dt?[]:r}function EB(r,e){const t=r.viewQuery;r.viewQuery=t?(n,i)=>{e(n,i),t(n,i)}:e}function wB(r,e){const t=r.contentQueries;r.contentQueries=t?(n,i,s)=>{e(n,i,s),t(n,i,s)}:e}function vB(r,e){const t=r.hostBindings;r.hostBindings=t?(n,i)=>{e(n,i),t(n,i)}:e}let Tv=null;function bf(){if(!Tv){const r=dt.Symbol;if(r&&r.iterator)Tv=r.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Tv=n)}}}return Tv}function Um(r){return!!function cR(r){return null!==r&&("function"==typeof r||"object"==typeof r)}(r)&&(Array.isArray(r)||!(r instanceof Map)&&bf()in r)}function ji(r,e,t){return!Object.is(r[e],t)&&(r[e]=t,!0)}function Xn(r,e,t,n){const i=Be();return ji(i,Hi(),e)&&(ln(),Vo(er(),i,r,e,t,n)),Xn}function xn(r,e,t,n,i,s,o,a){const l=Be(),c=ln(),d=r+20,b=c.firstCreatePass?function OB(r,e,t,n,i,s,o,a,l){const c=e.consts,d=su(e,r,4,o||null,Ja(c,a));Om(e,t,d,Ja(c,l)),jd(e,d);const b=d.tViews=vf(2,d,n,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,d),b.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,n,i,s,o):c.data[d];Do(b,!1);const N=l[11].createComment("");Ph(c,l,N,b),si(N,l),Sf(l,l[d]=Nm(N,l,N,b)),Gl(b)&&Cm(c,l,b),null!=o&&Rm(l,b,a)}function Iv(r){return function _o(r,e){return r[e]}(function ha(){return Nt.lFrame.contextLView}(),20+r)}function Ue(r,e=It.Default){const t=Be();return null===t?$e(r,e):qd(Sr(),t,z(r),e)}function gR(){throw new Error("invalid")}function Wt(r,e,t){const n=Be();return ji(n,Hi(),e)&&us(ln(),er(),n,r,e,n[11],t,!1),Wt}function pR(r,e,t,n,i){const o=i?"class":"style";wv(r,t,e.inputs[o],o,n)}function Lt(r,e,t,n){const i=Be(),s=ln(),o=20+r,a=i[11],l=i[o]=rm(a,e,function Hl(){return Nt.lFrame.currentNamespace}()),c=s.firstCreatePass?function KB(r,e,t,n,i,s,o){const a=e.consts,c=su(e,r,2,i,Ja(a,s));return Om(e,t,c,Ja(a,o)),null!==c.attrs&&Af(c,c.attrs,!1),null!==c.mergedAttrs&&Af(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,i,0,e,t,n):s.data[o];Do(c,!0);const d=c.mergedAttrs;null!==d&&Lo(a,l,d);const b=c.classes;null!==b&&dm(a,l,b);const N=c.styles;return null!==N&&Ww(a,l,N),64!=(64&c.flags)&&Ph(s,i,l,c),0===function sh(){return Nt.lFrame.elementDepthCount}()&&si(l,i),function _E(){Nt.lFrame.elementDepthCount++}(),Gl(c)&&(Cm(s,i,c),bm(s,c,i)),null!==n&&Rm(i,c),Lt}function $t(){let r=Sr();up()?hp():(r=r.parent,Do(r,!1));const e=r;!function q(){Nt.lFrame.elementDepthCount--}();const t=ln();return t.firstCreatePass&&(jd(t,r),qg(r)&&t.queries.elementEnd(r)),null!=e.classesWithoutHost&&function VE(r){return 0!=(16&r.flags)}(e)&&pR(t,e,Be(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function xo(r){return 0!=(32&r.flags)}(e)&&pR(t,e,Be(),e.stylesWithoutHost,!1),$t}function Ii(r,e,t,n){return Lt(r,e,t,n),$t(),Ii}function mR(r,e,t){const n=Be(),i=ln(),s=r+20,o=i.firstCreatePass?function JB(r,e,t,n,i){const s=e.consts,o=Ja(s,n),a=su(e,r,8,"ng-container",o);return null!==o&&Af(a,o,!0),Om(e,t,a,Ja(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,n,e,t):i.data[s];Do(o,!0);const a=n[s]=n[11].createComment("");return Ph(i,n,a,o),si(a,n),Gl(o)&&(Cm(i,n,o),bm(i,o,n)),null!=t&&Rm(n,o),mR}function yR(){let r=Sr();const e=ln();return up()?hp():(r=r.parent,Do(r,!1)),e.firstCreatePass&&(jd(e,r),qg(r)&&e.queries.elementEnd(r)),yR}function uu(r,e,t){return mR(r,e,t),yR(),uu}function hu(){return Be()}function Nv(r){return!!r&&"function"==typeof r.then}const EP=function yP(r){return!!r&&"function"==typeof r.subscribe};function zi(r,e,t,n){const i=Be(),s=ln(),o=Sr();return wP(s,i,i[11],o,r,e,!!t,n),zi}function ER(r,e){const t=Sr(),n=Be(),i=ln();return wP(i,n,Ev(dp(i.data),t,n),t,r,e,!1),ER}function wP(r,e,t,n,i,s,o,a){const l=Gl(n),d=r.firstCreatePass&&yv(r),b=e[8],N=mv(e);let F=!0;if(3&n.type||a){const ie=ti(n,e),he=a?a(ie):ie,de=N.length,Te=a?Ke=>a(mr(Ke[n.index])):n.index;if(jt(t)){let Ke=null;if(!a&&l&&(Ke=function qB(r,e,t,n){const i=r.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===n){const a=e[7],l=i[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(r,e,i,n.index)),null!==Ke)(Ke.__ngLastListenerFn__||Ke).__ngNextListenerFn__=s,Ke.__ngLastListenerFn__=s,F=!1;else{s=wR(n,e,b,s,!1);const Xe=t.listen(he,i,s);N.push(s,Xe),d&&d.push(i,Te,de,de+1)}}else s=wR(n,e,b,s,!0),he.addEventListener(i,s,o),N.push(s),d&&d.push(i,Te,de,o)}else s=wR(n,e,b,s,!1);const G=n.outputs;let W;if(F&&null!==G&&(W=G[i])){const ie=W.length;if(ie)for(let he=0;he<ie;he+=2){const Et=e[W[he]][W[he+1]].subscribe(s),wt=N.length;N.push(s,Et),d&&d.push(i,n.index,wt,-(wt+1))}}}function vP(r,e,t,n){try{return!1!==t(n)}catch(i){return Fm(r,i),!1}}function wR(r,e,t,n,i){return function s(o){if(o===Function)return n;const a=2&r.flags?Yr(r.index,e):e;0==(32&e[2])&&li(a);let l=vP(e,0,n,o),c=s.__ngNextListenerFn__;for(;c;)l=vP(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return i&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function tn(r=1){return function lb(r){return(Nt.lFrame.contextLView=function pp(r,e){for(;r>0;)e=e[15],r--;return e}(r,Nt.lFrame.contextLView))[8]}(r)}function QB(r,e){let t=null;const n=function yC(r){const e=r.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(r);for(let i=0;i<e.length;i++){const s=e[i];if("*"!==s){if(null===n?Sa(r,s,!0):vC(n,s))return i}else t=i}return t}function Ta(r){const e=Be()[16][6];if(!e.projection){const n=e.projection=fh(r?r.length:1,null),i=n.slice();let s=e.child;for(;null!==s;){const o=r?QB(s,r):0;null!==o&&(i[o]?i[o].projectionNext=s:n[o]=s,i[o]=s),s=s.next}}}function $i(r,e=0,t){const n=Be(),i=ln(),s=su(i,20+r,16,null,t||null);null===s.projection&&(s.projection=e),hp(),64!=(64&s.flags)&&function dC(r,e,t){Uw(e[11],0,e,t,pf(r,t,e),Oh(t.parent||e[6],t,e))}(i,n,s)}function NP(r,e,t,n,i){const s=r[t+1],o=null===e;let a=n?ro(s):ba(s),l=!1;for(;0!==a&&(!1===l||o);){const d=r[a+1];ek(r[a],e)&&(l=!0,r[a+1]=n?ec(d):gm(d)),a=n?ro(d):ba(d)}l&&(r[t+1]=n?gm(s):ec(s))}function ek(r,e){return null===r||null==e||(Array.isArray(r)?r[1]:r)===e||!(!Array.isArray(r)||"string"!=typeof e)&&Jl(r,e)>=0}function du(r,e,t){return Oa(r,e,t,!1),du}function ci(r,e){return Oa(r,e,null,!0),ci}function Oa(r,e,t,n){const i=Be(),s=ln(),o=function fa(r){const e=Nt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,t}(2);s.firstUpdatePass&&function kP(r,e,t,n){const i=r.data;if(null===i[t+1]){const s=i[Ar()],o=function BP(r,e){return e>=r.expandoStartIndex}(r,t);(function YP(r,e){return 0!=(r.flags&(e?16:32))})(s,n)&&null===e&&!o&&(e=!1),e=function ck(r,e,t,n){const i=dp(r);let s=n?e.residualClasses:e.residualStyles;if(null===i)0===(n?e.classBindings:e.styleBindings)&&(t=jm(t=SR(null,r,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||r[o]!==i)if(t=SR(i,r,e,t,n),null===s){let l=function uk(r,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==ba(n))return r[ro(n)]}(r,e,n);void 0!==l&&Array.isArray(l)&&(l=SR(null,r,e,l[1],n),l=jm(l,e.attrs,n),function hk(r,e,t,n){r[ro(t?e.classBindings:e.styleBindings)]=n}(r,e,n,l))}else s=function dk(r,e,t){let n;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)n=jm(n,r[s].hostAttrs,t);return jm(n,e.attrs,t)}(r,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,n),function XB(r,e,t,n,i,s){let o=s?e.classBindings:e.styleBindings,a=ro(o),l=ba(o);r[n]=t;let d,c=!1;if(Array.isArray(t)){const b=t;d=b[1],(null===d||Jl(b,d)>0)&&(c=!0)}else d=t;if(i)if(0!==l){const N=ro(r[a+1]);r[n+1]=_h(N,a),0!==N&&(r[N+1]=pm(r[N+1],n)),r[a+1]=function AC(r,e){return 131071&r|e<<17}(r[a+1],n)}else r[n+1]=_h(a,0),0!==a&&(r[a+1]=pm(r[a+1],n)),a=n;else r[n+1]=_h(l,0),0===a?a=n:r[l+1]=pm(r[l+1],n),l=n;c&&(r[n+1]=gm(r[n+1])),NP(r,d,n,!0),NP(r,d,n,!1),function ZB(r,e,t,n,i){const s=i?r.residualClasses:r.residualStyles;null!=s&&"string"==typeof e&&Jl(s,e)>=0&&(t[n+1]=ec(t[n+1]))}(e,d,r,n,s),o=_h(a,l),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,n)}}(s,r,o,n),e!==xt&&ji(i,o,e)&&function VP(r,e,t,n,i,s,o,a){if(!(3&e.type))return;const l=r.data,c=l[a+1];_v(function mm(r){return 1==(1&r)}(c)?HP(l,e,t,i,ba(c),o):void 0)||(_v(s)||function $w(r){return 2==(2&r)}(c)&&(s=HP(l,null,t,i,a,o)),function gC(r,e,t,n,i){const s=jt(r);if(e)i?s?r.addClass(t,n):t.classList.add(n):s?r.removeClass(t,n):t.classList.remove(n);else{let o=-1===n.indexOf("-")?void 0:cs.DashCase;if(null==i)s?r.removeStyle(t,n,o):t.style.removeProperty(n);else{const a="string"==typeof i&&i.endsWith("!important");a&&(i=i.slice(0,-10),o|=cs.Important),s?r.setStyle(t,n,i,o):t.style.setProperty(n,i,a?"important":"")}}}(n,o,Uc(Ar(),t),i,s))}(s,s.data[Ar()],i,i[11],r,i[o+1]=function pk(r,e){return null==r||("string"==typeof e?r+=e:"object"==typeof r&&(r=pn(Ui(r)))),r}(e,t),n,o)}function SR(r,e,t,n,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=jm(n,s.hostAttrs,i),s!==r);)a++;return null!==r&&(t.directiveStylingLast=a),n}function jm(r,e,t){const n=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),as(r,o,!!t||e[++s]))}return void 0===r?null:r}function HP(r,e,t,n,i,s){const o=null===e;let a;for(;i>0;){const l=r[i],c=Array.isArray(l),d=c?l[1]:l,b=null===d;let N=t[i+1];N===xt&&(N=b?Dt:void 0);let F=b?ef(N,n):d===n?N:void 0;if(c&&!_v(F)&&(F=ef(l,n)),_v(F)&&(a=F,o))return a;const G=r[i+1];i=o?ro(G):ba(G)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=ef(l,n))}return a}function _v(r){return void 0!==r}function Bs(r,e=""){const t=Be(),n=ln(),i=r+20,s=n.firstCreatePass?su(n,i,1,e,null):n.data[i],o=t[i]=function iu(r,e){return jt(r)?r.createText(e):r.createTextNode(e)}(t[11],e);Ph(n,t,o,s),Do(s,!1)}function Dv(r,e,t){const n=Be(),i=function Rf(r,e,t,n){return ji(r,Hi(),t)?e+bt(t)+n:xt}(n,r,e,t);return i!==xt&&Ra(n,Ar(),i),Dv}function AR(r,e,t){const n=Be();if(ji(n,Hi(),e)){const s=ln(),o=er();us(s,o,n,r,e,Ev(dp(s.data),o,n),t,!0)}return AR}const xv="en-US";let uN=xv;function RR(r,e,t,n,i){if(r=z(r),Array.isArray(r))for(let s=0;s<r.length;s++)RR(r[s],e,t,n,i);else{const s=ln(),o=Be();let a=cu(r)?r:z(r.provide),l=Cv(r);const c=Sr(),d=1048575&c.providerIndexes,b=c.directiveStart,N=c.providerIndexes>>20;if(cu(r)||!r.multi){const F=new Xa(l,i,Ue),G=OR(a,e,i?d:d+N,b);-1===G?(Kd(Wl(c,o),s,a),TR(s,r,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),t.push(F),o.push(F)):(t[G]=F,o[G]=F)}else{const F=OR(a,e,d+N,b),G=OR(a,e,d,d+N),W=F>=0&&t[F],ie=G>=0&&t[G];if(i&&!ie||!i&&!W){Kd(Wl(c,o),s,a);const he=function M2(r,e,t,n,i){const s=new Xa(r,t,Ue);return s.multi=[],s.index=e,s.componentProviders=0,LN(s,i,n&&!t),s}(i?L2:x2,t.length,i,n,l);!i&&ie&&(t[G].providerFactory=he),TR(s,r,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),t.push(he),o.push(he)}else TR(s,r,F>-1?F:G,LN(t[i?G:F],l,!i&&n));!i&&n&&ie&&t[G].componentProviders++}}}function TR(r,e,t,n){const i=cu(e),s=function aR(r){return!!r.useClass}(e);if(i||s){const l=(s?z(e.useClass):e).prototype.ngOnDestroy;if(l){const c=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){const d=c.indexOf(t);-1===d?c.push(t,[n,l]):c[d+1].push(n,l)}else c.push(t,l)}}}function LN(r,e,t){return t&&r.componentProviders++,r.multi.push(e)-1}function OR(r,e,t,n){for(let i=t;i<n;i++)if(e[i]===r)return i;return-1}function x2(r,e,t,n){return IR(this.multi,[])}function L2(r,e,t,n){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=hh(t,t[1],this.providerFactory.index,n);s=a.slice(0,o),IR(i,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],IR(i,s);return s}function IR(r,e){for(let t=0;t<r.length;t++)e.push((0,r[t])());return e}function PR(r,e=[]){return t=>{t.providersResolver=(n,i)=>function D2(r,e,t){const n=ln();if(n.firstCreatePass){const i=we(r);RR(t,n.data,n.blueprint,i,!0),RR(e,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,e)}}class MN{}class k2{resolveComponentFactory(e){throw function B2(r){const e=Error(`No component factory found for ${pn(r)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=r,e}(e)}}let qm=(()=>{class r{}return r.NULL=new k2,r})();function G2(){return Bf(Sr(),Be())}function Bf(r,e){return new Dr(ti(r,e))}let Dr=(()=>{class r{constructor(t){this.nativeElement=t}}return r.__NG_ELEMENT_ID__=G2,r})();function V2(r){return r instanceof Dr?r.nativeElement:r}class Qm{}let kv=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function Y2(){const r=Be(),t=Yr(Sr().index,r);return function H2(r){return r[11]}(No(t)?t:r)}(),r})(),U2=(()=>{class r{}return r.\u0275prov=gt({token:r,providedIn:"root",factory:()=>null}),r})();class Vh{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const W2=new Vh("13.3.3"),NR={};function Gv(r,e,t,n,i=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(mr(s)),Qs(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Gv(l[1],l,c,n)}const o=t.type;if(8&o)Gv(r,e,t.child,n);else if(32&o){const a=em(t,e);let l;for(;l=a();)n.push(l)}else if(16&o){const a=Hw(e,t);if(Array.isArray(a))n.push(...a);else{const l=Rh(e[16]);Gv(l[1],l,a,n,!0)}}t=i?t.projectionNext:t.next}return n}class Xm{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Gv(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Qs(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(im(e,n),to(t,n))}this._attachedToViewContainer=!1}Th(this._lView[1],this._lView)}onDestroy(e){ov(this._lView[1],this._lView,null,e)}markForCheck(){li(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){xm(this._lView[1],this._lView,this.context)}checkNoChanges(){!function ZC(r,e,t){Yd(!0);try{xm(r,e,t)}finally{Yd(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new ot(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function oC(r,e){Nh(r,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ot(902,"");this._appRef=e}}class j2 extends Xm{constructor(e){super(e),this._view=e}detectChanges(){gv(this._view)}checkNoChanges(){!function Lm(r){Yd(!0);try{gv(r)}finally{Yd(!1)}}(this._view)}get context(){return null}}class BN extends qm{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Gr(e);return new _R(t,this.ngModule)}}function kN(r){const e=[];for(let t in r)r.hasOwnProperty(t)&&e.push({propName:r[t],templateName:t});return e}class _R extends MN{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function SC(r){return r.map(fm).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return kN(this.componentDef.inputs)}get outputs(){return kN(this.componentDef.outputs)}create(e,t,n,i){const s=(i=i||this.ngModule)?function $2(r,e){return{get:(t,n,i)=>{const s=r.get(t,NR,i);return s!==NR||n===NR?s:e.get(t,n,i)}}}(e,i.injector):e,o=s.get(Qm,Hr),a=s.get(U2,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",d=n?function sv(r,e,t){if(jt(r))return r.selectRootElement(e,t===oe.ShadowDom);let n="string"==typeof e?r.querySelector(e):e;return n.textContent="",n}(l,n,this.componentDef.encapsulation):rm(o.createRenderer(null,this.componentDef),c,function z2(r){const e=r.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(c)),b=this.componentDef.onPush?576:528,N=function qI(r,e){return{components:[],scheduler:r||ff,clean:eR,playerHandler:e||null,flags:0}}(),F=vf(0,null,null,1,0,null,null,null,null,null),G=Lh(null,F,N,b,null,null,o,l,a,s);let W,ie;Ud(G);try{const he=function KI(r,e,t,n,i,s){const o=t[1];t[20]=r;const l=su(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(Af(l,c,!0),null!==r&&(Lo(i,r,c),null!==l.classes&&dm(i,r,l.classes),null!==l.styles&&Ww(i,r,l.styles)));const d=n.createRenderer(r,e),b=Lh(t,rv(e),null,e.onPush?64:16,t[20],l,n,d,s||null,null);return o.firstCreatePass&&(Kd(Wl(l,t),o,e.type),hv(o,l),dv(l,t.length,1)),Sf(t,b),t[20]=b}(d,this.componentDef,G,o,l);if(d)if(n)Lo(l,d,["ng-version",W2.full]);else{const{attrs:de,classes:Te}=function Aa(r){const e=[],t=[];let n=1,i=2;for(;n<r.length;){let s=r[n];if("string"==typeof s)2===i?""!==s&&e.push(s,r[++n]):8===i&&t.push(s);else{if(!En(i))break;i=s}n++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);de&&Lo(l,d,de),Te&&Te.length>0&&dm(l,d,Te.join(" "))}if(ie=$a(F,20),void 0!==t){const de=ie.projection=[];for(let Te=0;Te<this.ngContentSelectors.length;Te++){const Ke=t[Te];de.push(null!=Ke?Array.from(Ke):null)}}W=function JI(r,e,t,n,i){const s=t[1],o=function kC(r,e,t){const n=Sr();r.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),fv(r,n,e,nc(r,e,1,null),t));const i=hh(e,r,n.directiveStart,n);si(i,e);const s=ti(n,e);return s&&si(s,e),i}(s,t,e);if(n.components.push(o),r[8]=o,i&&i.forEach(l=>l(o,e)),e.contentQueries){const l=Sr();e.contentQueries(1,o,l.directiveStart)}const a=Sr();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Zs(a.index),cv(t[1],a,0,a.directiveStart,a.directiveEnd,e),uv(e,o)),o}(he,this.componentDef,G,N,[mB]),Mh(F,G,null)}finally{Wd()}return new J2(this.componentType,W,Bf(ie,G),G,ie)}}class J2 extends class F2{}{constructor(e,t,n,i,s){super(),this.location=n,this._rootLView=i,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new j2(i),this.componentType=e}get injector(){return new zl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class ic{}class GN{}const kf=new Map;class YN extends ic{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new BN(this);const n=Bi(e);this._bootstrapComponents=Go(n.bootstrap),this._r3Injector=bv(e,t,[{provide:ic,useValue:this},{provide:qm,useValue:this.componentFactoryResolver}],pn(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=M.THROW_IF_NOT_FOUND,n=It.Default){return e===M||e===ic||e===Gm?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class DR extends GN{constructor(e){super(),this.moduleType=e,null!==Bi(e)&&function Q2(r){const e=new Set;!function t(n){const i=Bi(n,!0),s=i.id;null!==s&&(function VN(r,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${r} - ${pn(e)} vs ${pn(e.name)}`)}(s,kf.get(s),n),kf.set(s,n));const o=Go(i.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(r)}(e)}create(e){return new YN(this.moduleType,e)}}function Gf(r,e,t,n){return function UN(r,e,t,n,i,s){const o=e+t;return ji(r,o,i)?function ll(r,e,t){return r[e]=t}(r,o+1,s?n.call(s,i):n(i)):function Zm(r,e){const t=r[e];return t===xt?void 0:t}(r,o+1)}(Be(),function Oi(){const r=Nt.lFrame;let e=r.bindingRootIndex;return-1===e&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}(),r,e,t,n)}function xR(r){return e=>{setTimeout(r,void 0,e)}}const Gn=class gG extends ke{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){var i,s,o;let a=e,l=t||(()=>null),c=n;if(e&&"object"==typeof e){const b=e;a=null===(i=b.next)||void 0===i?void 0:i.bind(b),l=null===(s=b.error)||void 0===s?void 0:s.bind(b),c=null===(o=b.complete)||void 0===o?void 0:o.bind(b)}this.__isAsync&&(l=xR(l),a&&(a=xR(a)),c&&(c=xR(c)));const d=super.subscribe({next:a,error:l,complete:c});return e instanceof m&&e.add(d),d}};function pG(){return this._results[bf()]()}class Vv{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=bf(),n=Vv.prototype;n[t]||(n[t]=pG)}get changes(){return this._changes||(this._changes=new Gn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const i=os(e);(this._changesDetected=!function Tp(r,e,t){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],s=e[n];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}(n._results,i,t))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let sc=(()=>{class r{}return r.__NG_ELEMENT_ID__=EG,r})();const mG=sc,yG=class extends mG{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e){const t=this._declarationTContainer.tViews,n=Lh(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(n[19]=s.createEmbeddedView(t)),Mh(t,n,e),new Xm(n)}};function EG(){return Hv(Sr(),Be())}function Hv(r,e){return 4&r.type?new yG(e,r,Bf(r,e)):null}let Pa=(()=>{class r{}return r.__NG_ELEMENT_ID__=wG,r})();function wG(){return qN(Sr(),Be())}const vG=Pa,KN=class extends vG{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Bf(this._hostTNode,this._hostLView)}get injector(){return new zl(this._hostTNode,this._hostLView)}get parentInjector(){const e=$d(this._hostTNode,this._hostLView);if(UE(e)){const t=zc(e,this._hostLView),n=jc(e);return new zl(t[1].data[n+8],t)}return new zl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=JN(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){const i=e.createEmbeddedView(t||{});return this.insert(i,n),i}createComponent(e,t,n,i,s){const o=e&&!function tl(r){return"function"==typeof r}(e);let a;if(o)a=t;else{const b=t||{};a=b.index,n=b.injector,i=b.projectableNodes,s=b.ngModuleRef}const l=o?e:new _R(Gr(e)),c=n||this.parentInjector;if(!s&&null==l.ngModule){const N=(o?c:this.parentInjector).get(ic,null);N&&(s=N)}const d=l.create(c,i,void 0,s);return this.insert(d.hostView,a),d}insert(e,t){const n=e._lView,i=n[1];if(function rb(r){return Qs(r[3])}(n)){const d=this.indexOf(e);if(-1!==d)this.detach(d);else{const b=n[3],N=new KN(b,b[6],b[3]);N.detach(N.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function lC(r,e,t,n){const i=10+n,s=t.length;n>0&&(t[i-1][4]=e),n<s-10?(e[4]=t[i],Zd(t,10+n,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function cC(r,e){const t=r[9];e[16]!==e[3][3][16]&&(r[2]=!0),null===t?r[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(r),e[2]|=128}(i,n,o,s);const a=um(s,o),l=n[11],c=mf(l,o[7]);return null!==c&&function sC(r,e,t,n,i,s){n[0]=i,n[6]=e,Nh(r,n,t,1,i,s)}(i,o[6],l,n,c,a),e.attachToViewContainerRef(),Zd(LR(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=JN(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=im(this._lContainer,t);n&&(to(LR(this._lContainer),t),Th(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=im(this._lContainer,t);return n&&null!=to(LR(this._lContainer),t)?new Xm(n):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function JN(r){return r[8]}function LR(r){return r[8]||(r[8]=[])}function qN(r,e){let t;const n=e[r.index];if(Qs(n))t=n;else{let i;if(8&r.type)i=mr(n);else{const s=e[11];i=s.createComment("");const o=ti(r,e);rl(s,mf(s,o),i,function hC(r,e){return jt(r)?r.nextSibling(e):e.nextSibling}(s,o),!1)}e[r.index]=t=Nm(n,e,i,r),Sf(e,t)}return new KN(t,r,e)}class MR{constructor(e){this.queryList=e,this.matches=null}clone(){return new MR(this.queryList)}setDirty(){this.queryList.setDirty()}}class FR{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new FR(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==t_(e,t).matches&&this.queries[t].setDirty()}}class QN{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class BR{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,i);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new BR(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class kR{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new kR(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const s=n[i];this.matchTNodeWithReadOption(e,t,bG(t,s)),this.matchTNodeWithReadOption(e,t,jl(t,e,s,!1,!1))}else n===sc?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,jl(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Dr||i===Pa||i===sc&&4&t.type)this.addMatch(t.index,-2);else{const s=jl(t,e,i,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function bG(r,e){const t=r.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function RG(r,e,t,n){return-1===t?function CG(r,e){return 11&r.type?Bf(r,e):4&r.type?Hv(r,e):null}(e,r):-2===t?function TG(r,e,t){return t===Dr?Bf(e,r):t===sc?Hv(e,r):t===Pa?qN(e,r):void 0}(r,e,n):hh(r,r[1],t,e)}function XN(r,e,t,n){const i=e[19].queries[n];if(null===i.matches){const s=r.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:RG(e,s[c],o[l+1],t.metadata.read))}i.matches=a}return i.matches}function GR(r,e,t,n){const i=r.queries.getByIndex(t),s=i.matches;if(null!==s){const o=XN(r,e,i,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)n.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let b=10;b<d.length;b++){const N=d[b];N[17]===N[3]&&GR(N[1],N,c,n)}if(null!==d[9]){const b=d[9];for(let N=0;N<b.length;N++){const F=b[N];GR(F[1],F,c,n)}}}}}return n}function ui(r){const e=Be(),t=ln(),n=LE();ss(n+1);const i=t_(t,n);if(r.dirty&&ih(e)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const s=i.crossesNgTemplate?GR(t,e,n,[]):XN(t,e,i,n);r.reset(s,V2),r.notifyOnChanges()}return!0}return!1}function Vf(r,e,t){const n=ln();n.firstCreatePass&&(e_(n,new QN(r,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),ZN(n,Be(),e)}function io(r,e,t,n){const i=ln();if(i.firstCreatePass){const s=Sr();e_(i,new QN(e,t,n),s.index),function IG(r,e){const t=r.contentQueries||(r.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(r.queries.length-1,e)}(i,r),2==(2&t)&&(i.staticContentQueries=!0)}ZN(i,Be(),t)}function hi(){return function OG(r,e){return r[19].queries[e].queryList}(Be(),LE())}function ZN(r,e,t){const n=new Vv(4==(4&t));ov(r,e,n,n.destroy),null===e[19]&&(e[19]=new FR),e[19].queries.push(new MR(n))}function e_(r,e,t){null===r.queries&&(r.queries=new BR),r.queries.track(new kR(e,t))}function t_(r,e){return r.queries.getByIndex(e)}function VR(r,e){return Hv(r,e)}function Wv(...r){}const zR=new pt("Application Initializer");let $R=(()=>{class r{constructor(t){this.appInits=t,this.resolve=Wv,this.reject=Wv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const s=this.appInits[i]();if(Nv(s))t.push(s);else if(EP(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{n()}).catch(i=>{this.reject(i)}),0===t.length&&n(),this.initialized=!0}}return r.\u0275fac=function(t){return new(t||r)($e(zR,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const ny=new pt("AppId",{providedIn:"root",factory:function E_(){return`${KR()}${KR()}${KR()}`}});function KR(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const w_=new pt("Platform Initializer"),JR=new pt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),v_=new pt("appBootstrapListener");let jG=(()=>{class r{log(t){console.log(t)}warn(t){console.warn(t)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();const oc=new pt("LocaleId",{providedIn:"root",factory:()=>wh(oc,It.Optional|It.SkipSelf)||function zG(){return"undefined"!=typeof $localize&&$localize.locale||xv}()});class KG{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let S_=(()=>{class r{compileModuleSync(t){return new DR(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),s=Go(Bi(t).declarations).reduce((o,a)=>{const l=Gr(a);return l&&o.push(new _R(l)),o},[]);return new KG(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const qG=(()=>Promise.resolve(0))();function qR(r){"undefined"==typeof Zone?qG.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class vn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Gn(!1),this.onMicrotaskEmpty=new Gn(!1),this.onStable=new Gn(!1),this.onError=new Gn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&t,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function QG(){let r=dt.requestAnimationFrame,e=dt.cancelAnimationFrame;if("undefined"!=typeof Zone&&r&&e){const t=r[Zone.__symbol__("OriginalDelegate")];t&&(r=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function eV(r){const e=()=>{!function ZG(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(dt,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,XR(r),r.isCheckStableRunning=!0,QR(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),XR(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,i,s,o,a)=>{try{return A_(r),t.invokeTask(i,s,o,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||r.shouldCoalesceRunChangeDetection)&&e(),b_(r)}},onInvoke:(t,n,i,s,o,a,l)=>{try{return A_(r),t.invoke(i,s,o,a,l)}finally{r.shouldCoalesceRunChangeDetection&&e(),b_(r)}},onHasTask:(t,n,i,s)=>{t.hasTask(i,s),n===i&&("microTask"==s.change?(r._hasPendingMicrotasks=s.microTask,XR(r),QR(r)):"macroTask"==s.change&&(r.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,i,s)=>(t.handleError(i,s),r.runOutsideAngular(()=>r.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(vn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,XG,Wv,Wv);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const XG={};function QR(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function XR(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function A_(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function b_(r){r._nesting--,QR(r)}class tV{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Gn,this.onMicrotaskEmpty=new Gn,this.onStable=new Gn,this.onError=new Gn}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}let ZR=(()=>{class r{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vn.assertNotInAngularZone(),qR(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())qR(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,i){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,n,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,n,i){return[]}}return r.\u0275fac=function(t){return new(t||r)($e(vn))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),nV=(()=>{class r{constructor(){this._applications=new Map,e0.addToWindow(this)}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return e0.findTestabilityInTree(this,t,n)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();class rV{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}let Na,e0=new rV;const C_=new pt("AllowMultipleToken");class R_{constructor(e,t){this.name=e,this.token=t}}function T_(r,e,t=[]){const n=`Platform: ${e}`,i=new pt(n);return(s=[])=>{let o=O_();if(!o||o.injector.get(C_,!1))if(r)r(t.concat(s).concat({provide:i,useValue:!0}));else{const a=t.concat(s).concat({provide:i,useValue:!0},{provide:Vm,useValue:"platform"});!function aV(r){if(Na&&!Na.destroyed&&!Na.injector.get(C_,!1))throw new ot(400,"");Na=r.get(cV);const e=r.get(w_,null);e&&e.forEach(t=>t())}(M.create({providers:a,name:n}))}return function lV(r){const e=O_();if(!e)throw new ot(401,"");return e}()}}function O_(){return Na&&!Na.destroyed?Na:null}let cV=(()=>{class r{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const a=function uV(r,e){let t;return t="noop"===r?new tV:("zone.js"===r?void 0:r)||new vn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(n?n.ngZone:void 0,{ngZoneEventCoalescing:n&&n.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:n&&n.ngZoneRunCoalescing||!1}),l=[{provide:vn,useValue:a}];return a.run(()=>{const c=M.create({providers:l,parent:this.injector,name:t.moduleType.name}),d=t.create(c),b=d.injector.get(va,null);if(!b)throw new ot(402,"");return a.runOutsideAngular(()=>{const N=a.onError.subscribe({next:F=>{b.handleError(F)}});d.onDestroy(()=>{n0(this._modules,d),N.unsubscribe()})}),function hV(r,e,t){try{const n=t();return Nv(n)?n.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>r.handleError(n)),n}}(b,a,()=>{const N=d.injector.get($R);return N.runInitializers(),N.donePromise.then(()=>(function Vk(r){Ci(r,"Expected localeId to be defined"),"string"==typeof r&&(uN=r.toLowerCase().replace(/_/g,"-"))}(d.injector.get(oc,xv)||xv),this._moduleDoBootstrap(d),d))})})}bootstrapModule(t,n=[]){const i=I_({},n);return function sV(r,e,t){const n=new DR(t);return Promise.resolve(n)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(t){const n=t.injector.get(t0);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>n.bootstrap(i));else{if(!t.instance.ngDoBootstrap)throw new ot(403,"");t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ot(404,"");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(t){return new(t||r)($e(M))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();function I_(r,e){return Array.isArray(e)?e.reduce(I_,r):Object.assign(Object.assign({},r),e)}let t0=(()=>{class r{constructor(t,n,i,s){this._zone=t,this._injector=n,this._exceptionHandler=i,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new ee(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),a=new ee(l=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{vn.assertNotInAngularZone(),qR(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const d=this._zone.onUnstable.subscribe(()=>{vn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{c.unsubscribe(),d.unsubscribe()}});this.isStable=Id(o,a.pipe(ju()))}bootstrap(t,n){if(!this._initStatus.done)throw new ot(405,"");let i;i=t instanceof MN?t:this._injector.get(qm).resolveComponentFactory(t),this.componentTypes.push(i.componentType);const s=function oV(r){return r.isBoundToModule}(i)?void 0:this._injector.get(ic),a=i.create(M.NULL,[],n||i.selector,s),l=a.location.nativeElement,c=a.injector.get(ZR,null),d=c&&a.injector.get(nV);return c&&d&&d.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),n0(this.components,a),d&&d.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new ot(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;n0(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(v_,[]).concat(this._bootstrapListeners).forEach(i=>i(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return r.\u0275fac=function(t){return new(t||r)($e(vn),$e(M),$e(va),$e($R))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function n0(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}let N_=!0,__=!1,Hh=(()=>{class r{}return r.__NG_ELEMENT_ID__=pV,r})();function pV(r){return function mV(r,e,t){if(Fd(r)&&!t){const n=Yr(r.index,e);return new Xm(n,n)}return 47&r.type?new Xm(e[16],e):null}(Sr(),Be(),16==(16&r))}class M_{constructor(){}supports(e){return Um(e)}create(e){return new AV(e)}}const SV=(r,e)=>e;class AV{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||SV}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<B_(n,i,s)?t:n,a=B_(o,i,s),l=o.currentIndex;if(o===n)i--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)i++;else{s||(s=[]);const c=a-i,d=l-i;if(c!=d){for(let N=0;N<c;N++){const F=N<s.length?s[N]:s[N]=0,G=F+N;d<=G&&G<c&&(s[N]=F+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Um(e))throw new ot(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else i=0,function TB(r,e){if(Array.isArray(r))for(let t=0;t<r.length;t++)e(r[t]);else{const t=r[bf()]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,i),n=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new bV(t,n),s,i),e}_verifyReinsertion(e,t,n,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new F_),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new F_),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class bV{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class CV{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class F_{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new CV,this.map.set(t,n)),n.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function B_(r,e,t){const n=r.previousIndex;if(null===n)return n;let i=0;return t&&n<t.length&&(i=t[n]),n+e+i}function G_(){return new $v([new M_])}let $v=(()=>{class r{constructor(t){this.factories=t}static create(t,n){if(null!=n){const i=n.factories.slice();t=t.concat(i)}return new r(t)}static extend(t){return{provide:r,useFactory:n=>r.create(t,n||G_()),deps:[[r,new Zc,new Ns]]}}find(t){const n=this.factories.find(i=>i.supports(t));if(null!=n)return n;throw new ot(901,"")}}return r.\u0275prov=gt({token:r,providedIn:"root",factory:G_}),r})();const PV=T_(null,"core",[]);let NV=(()=>{class r{constructor(t){}}return r.\u0275fac=function(t){return new(t||r)($e(t0))},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({}),r})(),Kv=null;function fu(){return Kv}const Ln=new pt("DocumentToken");let Uh=(()=>{class r{historyGo(t){throw new Error("Not implemented")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:function(){return function LV(){return $e(H_)}()},providedIn:"platform"}),r})();const MV=new pt("Location Initialized");let H_=(()=>{class r extends Uh{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fu().getBaseHref(this._doc)}onPopState(t){const n=fu().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=fu().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,n,i){Y_()?this._history.pushState(t,n,i):this.location.hash=i}replaceState(t,n,i){Y_()?this._history.replaceState(t,n,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return r.\u0275fac=function(t){return new(t||r)($e(Ln))},r.\u0275prov=gt({token:r,factory:function(){return function FV(){return new H_($e(Ln))}()},providedIn:"platform"}),r})();function Y_(){return!!window.history.pushState}function l0(r,e){if(0==r.length)return e;if(0==e.length)return r;let t=0;return r.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?r+e.substring(1):1==t?r+e:r+"/"+e}function U_(r){const e=r.match(/#|\?|$/),t=e&&e.index||r.length;return r.slice(0,t-("/"===r[t-1]?1:0))+r.slice(t)}function ac(r){return r&&"?"!==r[0]?"?"+r:r}let Yf=(()=>{class r{historyGo(t){throw new Error("Not implemented")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:function(){return function BV(r){const e=$e(Ln).location;return new W_($e(Uh),e&&e.origin||"")}()},providedIn:"root"}),r})();const c0=new pt("appBaseHref");let W_=(()=>{class r extends Yf{constructor(t,n){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==n&&(n=this._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=n}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return l0(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+ac(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${n}${i}`:n}pushState(t,n,i,s){const o=this.prepareExternalUrl(i+ac(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,i,s){const o=this.prepareExternalUrl(i+ac(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var n,i;null===(i=(n=this._platformLocation).historyGo)||void 0===i||i.call(n,t)}}return r.\u0275fac=function(t){return new(t||r)($e(Uh),$e(c0,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),kV=(()=>{class r extends Yf{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=l0(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,i,s){let o=this.prepareExternalUrl(i+ac(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,i,s){let o=this.prepareExternalUrl(i+ac(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var n,i;null===(i=(n=this._platformLocation).historyGo)||void 0===i||i.call(n,t)}}return r.\u0275fac=function(t){return new(t||r)($e(Uh),$e(c0,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),u0=(()=>{class r{constructor(t,n){this._subject=new Gn,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=U_(j_(i)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+ac(n))}normalize(t){return r.stripTrailingSlash(function VV(r,e){return r&&e.startsWith(r)?e.substring(r.length):e}(this._baseHref,j_(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,n="",i=null){this._platformStrategy.pushState(i,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ac(n)),i)}replaceState(t,n="",i=null){this._platformStrategy.replaceState(i,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ac(n)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var n,i;null===(i=(n=this._platformStrategy).historyGo)||void 0===i||i.call(n,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}))}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(i=>i(t,n))}subscribe(t,n,i){return this._subject.subscribe({next:t,error:n,complete:i})}}return r.normalizeQueryParams=ac,r.joinWithSlash=l0,r.stripTrailingSlash=U_,r.\u0275fac=function(t){return new(t||r)($e(Yf),$e(Uh))},r.\u0275prov=gt({token:r,factory:function(){return function GV(){return new u0($e(Yf),$e(Uh))}()},providedIn:"root"}),r})();function j_(r){return r.replace(/\/index.html$/,"")}class TH{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let eD=(()=>{class r{constructor(t,n,i){this._viewContainer=t,this._template=n,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((i,s,o)=>{if(null==i.previousIndex)n.createEmbeddedView(this._template,new TH(i.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)n.remove(null===s?void 0:s);else if(null!==s){const a=n.get(s);n.move(a,o),tD(a,i)}});for(let i=0,s=n.length;i<s;i++){const a=n.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{tD(n.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,n){return!0}}return r.\u0275fac=function(t){return new(t||r)(Ue(Pa),Ue(sc),Ue($v))},r.\u0275dir=Mn({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),r})();function tD(r,e){r.context.$implicit=e.item}let Wh=(()=>{class r{constructor(t,n){this._viewContainer=t,this._context=new OH,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){nD("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){nD("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return r.\u0275fac=function(t){return new(t||r)(Ue(Pa),Ue(sc))},r.\u0275dir=Mn({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),r})();class OH{constructor(){this.$implicit=null,this.ngIf=null}}function nD(r,e){if(e&&!e.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${pn(e)}'.`)}let iD=(()=>{class r{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(t.ngTemplateOutlet){const n=this._viewContainerRef;this._viewRef&&n.remove(n.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?n.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return r.\u0275fac=function(t){return new(t||r)(Ue(Pa))},r.\u0275dir=Mn({type:r,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[ca]}),r})(),iS=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({}),r})();const oD="browser";let r3=(()=>{class r{}return r.\u0275prov=gt({token:r,providedIn:"root",factory:()=>new s3($e(Ln),window)}),r})();class s3{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function o3(r,e){const t=r.getElementById(e)||r.getElementsByName(e)[0];if(t)return t;if("function"==typeof r.createTreeWalker&&r.body&&(r.body.createShadowRoot||r.body.attachShadow)){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],i-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=aD(this.window.history)||aD(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function aD(r){return Object.getOwnPropertyDescriptor(r,"scrollRestoration")}class C0 extends class l3 extends class xV{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function DV(r){Kv||(Kv=r)}(new C0)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function c3(){return oy=oy||document.querySelector("base"),oy?oy.getAttribute("href"):null}();return null==t?null:function u3(r){sS=sS||document.createElement("a"),sS.setAttribute("href",r);const e=sS.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){oy=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function bH(r,e){e=encodeURIComponent(e);for(const t of r.split(";")){const n=t.indexOf("="),[i,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let sS,oy=null;const lD=new pt("TRANSITION_ID"),f3=[{provide:zR,useFactory:function h3(r,e,t){return()=>{t.get($R).donePromise.then(()=>{const n=fu(),i=e.querySelectorAll(`style[ng-transition="${r}"]`);for(let s=0;s<i.length;s++)n.remove(i[s])})}},deps:[lD,Ln,M],multi:!0}];class R0{static init(){!function iV(r){e0=r}(new R0)}addToWindow(e){dt.getAngularTestability=(n,i=!0)=>{const s=e.findTestabilityInTree(n,i);if(null==s)throw new Error("Could not find testability for element.");return s},dt.getAllAngularTestabilities=()=>e.getAllTestabilities(),dt.getAllAngularRootElements=()=>e.getAllRootElements(),dt.frameworkStabilizers||(dt.frameworkStabilizers=[]),dt.frameworkStabilizers.push(n=>{const i=dt.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(l){o=o||l,s--,0==s&&n(o)};i.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const i=e.getTestability(t);return null!=i?i:n?fu().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let g3=(()=>{class r{build(){return new XMLHttpRequest}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const oS=new pt("EventManagerPlugins");let aS=(()=>{class r{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,i){return this._findPluginFor(n).addEventListener(t,n,i)}addGlobalEventListener(t,n,i){return this._findPluginFor(n).addGlobalEventListener(t,n,i)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const i=this._plugins;for(let s=0;s<i.length;s++){const o=i[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return r.\u0275fac=function(t){return new(t||r)($e(oS),$e(vn))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();class cD{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const i=fu().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,n)}}let uD=(()=>{class r{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),n.add(i))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),ay=(()=>{class r extends uD{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,i){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,i.push(n.appendChild(o))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(hD),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,i)=>{this._addStylesToHost(t,i,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(hD))}}return r.\u0275fac=function(t){return new(t||r)($e(Ln))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();function hD(r){fu().remove(r)}const T0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},O0=/%COMP%/g;function lS(r,e,t){for(let n=0;n<e.length;n++){let i=e[n];Array.isArray(i)?lS(r,i,t):(i=i.replace(O0,r),t.push(i))}return t}function gD(r){return e=>{if("__ngUnwrap__"===e)return r;!1===r(e)&&(e.preventDefault(),e.returnValue=!1)}}let cS=(()=>{class r{constructor(t,n,i){this.eventManager=t,this.sharedStylesHost=n,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new I0(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case oe.Emulated:{let i=this.rendererByCompId.get(n.id);return i||(i=new v3(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,i)),i.applyToHost(t),i}case 1:case oe.ShadowDom:return new S3(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const i=lS(n.id,n.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return r.\u0275fac=function(t){return new(t||r)($e(aS),$e(ay),$e(ny))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();class I0{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(T0[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const s=T0[i];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=T0[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(cs.DashCase|cs.Important)?e.style.setProperty(t,n,i&cs.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&cs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,gD(n)):this.eventManager.addEventListener(e,t,gD(n))}}class v3 extends I0{constructor(e,t,n,i){super(e),this.component=n;const s=lS(i+"-"+n.id,n.styles,[]);t.addStyles(s),this.contentAttr=function y3(r){return"_ngcontent-%COMP%".replace(O0,r)}(i+"-"+n.id),this.hostAttr=function E3(r){return"_nghost-%COMP%".replace(O0,r)}(i+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class S3 extends I0{constructor(e,t,n,i){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=lS(i.id,i.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let A3=(()=>{class r extends cD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,i){return t.addEventListener(n,i,!1),()=>this.removeEventListener(t,n,i)}removeEventListener(t,n,i){return t.removeEventListener(n,i)}}return r.\u0275fac=function(t){return new(t||r)($e(Ln))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const mD=["alt","control","meta","shift"],C3={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yD={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},R3={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let T3=(()=>{class r extends cD{constructor(t){super(t)}supports(t){return null!=r.parseEventName(t)}addEventListener(t,n,i){const s=r.parseEventName(n),o=r.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fu().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;const s=r._normalizeKey(n.pop());let o="";if(mD.forEach(l=>{const c=n.indexOf(l);c>-1&&(n.splice(c,1),o+=l+".")}),o+=s,0!=n.length||0===s.length)return null;const a={};return a.domEventName=i,a.fullKey=o,a}static getEventFullKey(t){let n="",i=function O3(r){let e=r.key;if(null==e){if(e=r.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===r.location&&yD.hasOwnProperty(e)&&(e=yD[e]))}return C3[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),mD.forEach(s=>{s!=i&&R3[s](t)&&(n+=s+".")}),n+=i,n}static eventCallback(t,n,i){return s=>{r.getEventFullKey(s)===t&&i.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return r.\u0275fac=function(t){return new(t||r)($e(Ln))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const _3=T_(PV,"browser",[{provide:JR,useValue:oD},{provide:w_,useValue:function I3(){C0.makeCurrent(),R0.init()},multi:!0},{provide:Ln,useFactory:function N3(){return function IE(r){sp=r}(document),document},deps:[]}]),D3=[{provide:Vm,useValue:"root"},{provide:va,useFactory:function P3(){return new va},deps:[]},{provide:oS,useClass:A3,multi:!0,deps:[Ln,vn,JR]},{provide:oS,useClass:T3,multi:!0,deps:[Ln]},{provide:cS,useClass:cS,deps:[aS,ay,ny]},{provide:Qm,useExisting:cS},{provide:uD,useExisting:ay},{provide:ay,useClass:ay,deps:[Ln]},{provide:ZR,useClass:ZR,deps:[vn]},{provide:aS,useClass:aS,deps:[oS,vn]},{provide:class a3{},useClass:g3,deps:[]}];let ED=(()=>{class r{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:r,providers:[{provide:ny,useValue:t.appId},{provide:lD,useExisting:ny},f3]}}}return r.\u0275fac=function(t){return new(t||r)($e(r,12))},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({providers:D3,imports:[iS,NV]}),r})();"undefined"!=typeof window&&window;let N0=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:function(t){let n=null;return n=t?new(t||r):$e(SD),n},providedIn:"root"}),r})(),SD=(()=>{class r extends N0{constructor(t){super(),this._doc=t}sanitize(t,n){if(null==n)return null;switch(t){case yn.NONE:return n;case yn.HTML:return ko(n,"HTML")?Ui(n):jp(this._doc,String(n)).toString();case yn.STYLE:return ko(n,"Style")?Ui(n):n;case yn.SCRIPT:if(ko(n,"Script"))return Ui(n);throw new Error("unsafe value used in a script context");case yn.URL:return dw(n),ko(n,"URL")?Ui(n):eu(String(n));case yn.RESOURCE_URL:if(ko(n,"ResourceURL"))return Ui(n);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function Rb(r){return new Gp(r)}(t)}bypassSecurityTrustStyle(t){return function Tb(r){return new bb(r)}(t)}bypassSecurityTrustScript(t){return function fw(r){return new Cb(r)}(t)}bypassSecurityTrustUrl(t){return function gw(r){return new vh(r)}(t)}bypassSecurityTrustResourceUrl(t){return function Ob(r){return new hw(r)}(t)}}return r.\u0275fac=function(t){return new(t||r)($e(Ln))},r.\u0275prov=gt({token:r,factory:function(t){let n=null;return n=t?new t:function Y3(r){return new SD(r.get(Ln))}($e(M)),n},providedIn:"root"}),r})();function Tt(...r){return gr(r,ja(r))}class Wo extends ke{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const{isArray:U3}=Array,{getPrototypeOf:W3,prototype:j3,keys:z3}=Object;function AD(r){if(1===r.length){const e=r[0];if(U3(e))return{args:e,keys:null};if(function $3(r){return r&&"object"==typeof r&&W3(r)===j3}(e)){const t=z3(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:r,keys:null}}const{isArray:K3}=Array;function _0(r){return _e(e=>function J3(r,e){return K3(e)?r(...e):r(e)}(r,e))}function bD(r,e){return r.reduce((t,n,i)=>(t[n]=e[i],t),{})}function CD(...r){const e=ja(r),t=bd(r),{args:n,keys:i}=AD(r);if(0===n.length)return gr([],e);const s=new ee(function q3(r,e,t=ae){return n=>{RD(e,()=>{const{length:i}=r,s=new Array(i);let o=i,a=i;for(let l=0;l<i;l++)RD(e,()=>{const c=gr(r[l],e);let d=!1;c.subscribe(new Ie(n,b=>{s[l]=b,d||(d=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,i?o=>bD(i,o):ae));return t?s.pipe(_0(t)):s}function RD(r,e,t){r?As(t,r,e):e()}function ly(r,e){const t=w(r)?r:()=>r,n=i=>i.error(t());return new ee(e?i=>e.schedule(n,0,i):n)}const uS=R(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function cy(...r){return function Q3(){return Wa(1)}()(gr(r,ja(r)))}function TD(r){return new ee(e=>{Si(r()).subscribe(e)})}function OD(){return Se((r,e)=>{let t=null;r._refCount++;const n=new Ie(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(t=null);const i=r._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(n),n.closed||(t=r.connect())})}class X3 extends ee{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,ft(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new m;const t=this.getSubject();e.add(this.source.subscribe(new Ie(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=m.EMPTY)}return e}refCount(){return OD()(this)}}function jh(r,e){return Se((t,n)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&n.complete();t.subscribe(new Ie(n,l=>{null==i||i.unsubscribe();let c=0;const d=s++;Si(r(l,d)).subscribe(i=new Ie(n,b=>n.next(e?e(l,b,d,c++):b),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function hS(...r){const e=ja(r);return Se((t,n)=>{(e?cy(r,t,e):cy(r,t)).subscribe(n)})}function Z3(r,e,t,n,i){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(new Ie(o,d=>{const b=c++;l=a?r(l,d,b):(a=!0,d),n&&o.next(l)},i&&(()=>{a&&o.next(l),o.complete()})))}}function ID(r,e){return Se(Z3(r,e,arguments.length>=2,!0))}function Ki(r,e){return Se((t,n)=>{let i=0;t.subscribe(new Ie(n,s=>r.call(e,s,i++)&&n.next(s)))})}function cc(r){return Se((e,t)=>{let s,n=null,i=!1;n=e.subscribe(new Ie(t,void 0,void 0,o=>{s=Si(r(o,cc(r)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,s.subscribe(t))})}function Uf(r,e){return w(e)?Bn(r,e,1):Bn(r,1)}function D0(r){return r<=0?()=>$s:Se((e,t)=>{let n=[];e.subscribe(new Ie(t,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)t.next(i);t.complete()},void 0,()=>{n=null}))})}function PD(r=eY){return Se((e,t)=>{let n=!1;e.subscribe(new Ie(t,i=>{n=!0,t.next(i)},()=>n?t.complete():t.error(r())))})}function eY(){return new uS}function ND(r){return Se((e,t)=>{let n=!1;e.subscribe(new Ie(t,i=>{n=!0,t.next(i)},()=>{n||t.next(r),t.complete()}))})}function zh(r,e){const t=arguments.length>=2;return n=>n.pipe(r?Ki((i,s)=>r(i,s,n)):ae,Ai(1),t?ND(e):PD(()=>new uS))}function Ji(r,e,t){const n=w(r)||e||t?{next:r,error:e,complete:t}:r;return n?Se((i,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;i.subscribe(new Ie(s,l=>{var c;null===(c=n.next)||void 0===c||c.call(n,l),s.next(l)},()=>{var l;a=!1,null===(l=n.complete)||void 0===l||l.call(n),s.complete()},l=>{var c;a=!1,null===(c=n.error)||void 0===c||c.call(n,l),s.error(l)},()=>{var l,c;a&&(null===(l=n.unsubscribe)||void 0===l||l.call(n)),null===(c=n.finalize)||void 0===c||c.call(n)}))}):ae}function _D(r){return Se((e,t)=>{try{e.subscribe(t)}finally{t.add(r)}})}class uc{constructor(e,t){this.id=e,this.url=t}}class x0 extends uc{constructor(e,t,n="imperative",i=null){super(e,t),this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Wf extends uc{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class DD extends uc{constructor(e,t,n){super(e,t),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class nY extends uc{constructor(e,t,n){super(e,t),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class rY extends uc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class iY extends uc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sY extends uc{constructor(e,t,n,i,s){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class oY extends uc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class aY extends uc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xD{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class LD{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class lY{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cY{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class uY{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hY{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class MD{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const sn="primary";class dY{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function jf(r){return new dY(r)}const FD="ngNavigationCancelingError";function L0(r){const e=Error("NavigationCancelingError: "+r);return e[FD]=!0,e}function gY(r,e,t){const n=t.path.split("/");if(n.length>r.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<r.length))return null;const i={};for(let s=0;s<n.length;s++){const o=n[s],a=r[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function hl(r,e){const t=r?Object.keys(r):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!BD(r[i],e[i]))return!1;return!0}function BD(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;const t=[...r].sort(),n=[...e].sort();return t.every((i,s)=>n[s]===i)}return r===e}function kD(r){return Array.prototype.concat.apply([],r)}function GD(r){return r.length>0?r[r.length-1]:null}function Pi(r,e){for(const t in r)r.hasOwnProperty(t)&&e(r[t],t)}function dl(r){return EP(r)?r:Nv(r)?gr(Promise.resolve(r)):Tt(r)}const yY={exact:function YD(r,e,t){if(!Kh(r.segments,e.segments)||!dS(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!r.children[n]||!YD(r.children[n],e.children[n],t))return!1;return!0},subset:UD},VD={exact:function EY(r,e){return hl(r,e)},subset:function wY(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>BD(r[t],e[t]))},ignored:()=>!0};function HD(r,e,t){return yY[t.paths](r.root,e.root,t.matrixParams)&&VD[t.queryParams](r.queryParams,e.queryParams)&&!("exact"===t.fragment&&r.fragment!==e.fragment)}function UD(r,e,t){return WD(r,e,e.segments,t)}function WD(r,e,t,n){if(r.segments.length>t.length){const i=r.segments.slice(0,t.length);return!(!Kh(i,t)||e.hasChildren()||!dS(i,t,n))}if(r.segments.length===t.length){if(!Kh(r.segments,t)||!dS(r.segments,t,n))return!1;for(const i in e.children)if(!r.children[i]||!UD(r.children[i],e.children[i],n))return!1;return!0}{const i=t.slice(0,r.segments.length),s=t.slice(r.segments.length);return!!(Kh(r.segments,i)&&dS(r.segments,i,n)&&r.children[sn])&&WD(r.children[sn],e,s,n)}}function dS(r,e,t){return e.every((n,i)=>VD[t](r[i].parameters,n.parameters))}class $h{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=jf(this.queryParams)),this._queryParamMap}toString(){return AY.serialize(this)}}class un{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Pi(t,(n,i)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return fS(this)}}class uy{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=jf(this.parameters)),this._parameterMap}toString(){return JD(this)}}function Kh(r,e){return r.length===e.length&&r.every((t,n)=>t.path===e[n].path)}class jD{}class zD{parse(e){const t=new _Y(e);return new $h(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${hy(e.root,!0)}`,n=function RY(r){const e=Object.keys(r).map(t=>{const n=r[t];return Array.isArray(n)?n.map(i=>`${gS(t)}=${gS(i)}`).join("&"):`${gS(t)}=${gS(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function bY(r){return encodeURI(r)}(e.fragment)}`:""}`}}const AY=new zD;function fS(r){return r.segments.map(e=>JD(e)).join("/")}function hy(r,e){if(!r.hasChildren())return fS(r);if(e){const t=r.children[sn]?hy(r.children[sn],!1):"",n=[];return Pi(r.children,(i,s)=>{s!==sn&&n.push(`${s}:${hy(i,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function SY(r,e){let t=[];return Pi(r.children,(n,i)=>{i===sn&&(t=t.concat(e(n,i)))}),Pi(r.children,(n,i)=>{i!==sn&&(t=t.concat(e(n,i)))}),t}(r,(n,i)=>i===sn?[hy(r.children[sn],!1)]:[`${i}:${hy(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[sn]?`${fS(r)}/${t[0]}`:`${fS(r)}/(${t.join("//")})`}}function $D(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function gS(r){return $D(r).replace(/%3B/gi,";")}function M0(r){return $D(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function pS(r){return decodeURIComponent(r)}function KD(r){return pS(r.replace(/\+/g,"%20"))}function JD(r){return`${M0(r.path)}${function CY(r){return Object.keys(r).map(e=>`;${M0(e)}=${M0(r[e])}`).join("")}(r.parameters)}`}const TY=/^[^\/()?;=#]+/;function mS(r){const e=r.match(TY);return e?e[0]:""}const OY=/^[^=?&#]+/,PY=/^[^&#]+/;class _Y{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new un([],{}):new un([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[sn]=new un(e,t)),n}parseSegment(){const e=mS(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new uy(pS(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=mS(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const i=mS(this.remaining);i&&(n=i,this.capture(n))}e[pS(t)]=pS(n)}parseQueryParam(e){const t=function IY(r){const e=r.match(OY);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function NY(r){const e=r.match(PY);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const i=KD(t),s=KD(n);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=mS(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let s;n.indexOf(":")>-1?(s=n.substr(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=sn);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[sn]:new un([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class qD{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=F0(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=F0(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=B0(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return B0(e,this._root).map(t=>t.value)}}function F0(r,e){if(r===e.value)return e;for(const t of e.children){const n=F0(r,t);if(n)return n}return null}function B0(r,e){if(r===e.value)return[e];for(const t of e.children){const n=B0(r,t);if(n.length)return n.unshift(e),n}return[]}class hc{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function zf(r){const e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}class QD extends qD{constructor(e,t){super(e),this.snapshot=t,k0(this,e)}toString(){return this.snapshot.toString()}}function XD(r,e){const t=function DY(r,e){const o=new yS([],{},{},"",{},sn,e,null,r.root,-1,{});return new ex("",new hc(o,[]))}(r,e),n=new Wo([new uy("",{})]),i=new Wo({}),s=new Wo({}),o=new Wo({}),a=new Wo(""),l=new $f(n,i,o,a,s,sn,e,t.root);return l.snapshot=t.root,new QD(new hc(l,[]),t)}class $f{constructor(e,t,n,i,s,o,a,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(_e(e=>jf(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(_e(e=>jf(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ZD(r,e="emptyOnly"){const t=r.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const i=t[n],s=t[n-1];if(i.routeConfig&&""===i.routeConfig.path)n--;else{if(s.component)break;n--}}return function xY(r){return r.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(n))}class yS{constructor(e,t,n,i,s,o,a,l,c,d,b){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=d,this._resolve=b}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=jf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=jf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ex extends qD{constructor(e,t){super(t),this.url=e,k0(this,t)}toString(){return tx(this._root)}}function k0(r,e){e.value._routerState=r,e.children.forEach(t=>k0(r,t))}function tx(r){const e=r.children.length>0?` { ${r.children.map(tx).join(", ")} } `:"";return`${r.value}${e}`}function G0(r){if(r.snapshot){const e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,hl(e.queryParams,t.queryParams)||r.queryParams.next(t.queryParams),e.fragment!==t.fragment&&r.fragment.next(t.fragment),hl(e.params,t.params)||r.params.next(t.params),function pY(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!hl(r[t],e[t]))return!1;return!0}(e.url,t.url)||r.url.next(t.url),hl(e.data,t.data)||r.data.next(t.data)}else r.snapshot=r._futureSnapshot,r.data.next(r._futureSnapshot.data)}function V0(r,e){const t=hl(r.params,e.params)&&function vY(r,e){return Kh(r,e)&&r.every((t,n)=>hl(t.parameters,e[n].parameters))}(r.url,e.url);return t&&!(!r.parent!=!e.parent)&&(!r.parent||V0(r.parent,e.parent))}function dy(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const i=function MY(r,e,t){return e.children.map(n=>{for(const i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return dy(r,n,i);return dy(r,n)})}(r,e,t);return new hc(n,i)}{if(r.shouldAttach(e.value)){const s=r.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>dy(r,a)),o}}const n=function FY(r){return new $f(new Wo(r.url),new Wo(r.params),new Wo(r.queryParams),new Wo(r.fragment),new Wo(r.data),r.outlet,r.component,r)}(e.value),i=e.children.map(s=>dy(r,s));return new hc(n,i)}}function ES(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function fy(r){return"object"==typeof r&&null!=r&&r.outlets}function H0(r,e,t,n,i){let s={};if(n&&Pi(n,(a,l)=>{s[l]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),r===e)return new $h(t,s,i);const o=nx(r,e,t);return new $h(o,s,i)}function nx(r,e,t){const n={};return Pi(r.children,(i,s)=>{n[s]=i===e?t:nx(i,e,t)}),new un(r.segments,n)}class rx{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&ES(n[0]))throw new Error("Root segment cannot have matrix parameters");const i=n.find(fy);if(i&&i!==GD(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Y0{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function ix(r,e,t){if(r||(r=new un([],{})),0===r.segments.length&&r.hasChildren())return wS(r,e,t);const n=function YY(r,e,t){let n=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return s;const o=r.segments[i],a=t[n];if(fy(a))break;const l=`${a}`,c=n<t.length-1?t[n+1]:null;if(i>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!ox(l,c,o))return s;n+=2}else{if(!ox(l,{},o))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const s=new un(r.segments.slice(0,n.pathIndex),{});return s.children[sn]=new un(r.segments.slice(n.pathIndex),r.children),wS(s,0,i)}return n.match&&0===i.length?new un(r.segments,{}):n.match&&!r.hasChildren()?U0(r,e,t):n.match?wS(r,0,i):U0(r,e,t)}function wS(r,e,t){if(0===t.length)return new un(r.segments,{});{const n=function HY(r){return fy(r[0])?r[0].outlets:{[sn]:r}}(t),i={};return Pi(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(i[o]=ix(r.children[o],e,s))}),Pi(r.children,(s,o)=>{void 0===n[o]&&(i[o]=s)}),new un(r.segments,i)}}function U0(r,e,t){const n=r.segments.slice(0,e);let i=0;for(;i<t.length;){const s=t[i];if(fy(s)){const l=UY(s.outlets);return new un(n,l)}if(0===i&&ES(t[0])){n.push(new uy(r.segments[e].path,sx(t[0]))),i++;continue}const o=fy(s)?s.outlets[sn]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&ES(a)?(n.push(new uy(o,sx(a))),i+=2):(n.push(new uy(o,{})),i++)}return new un(n,{})}function UY(r){const e={};return Pi(r,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=U0(new un([],{}),0,t))}),e}function sx(r){const e={};return Pi(r,(t,n)=>e[n]=`${t}`),e}function ox(r,e,t){return r==t.path&&hl(e,t.parameters)}class jY{constructor(e,t,n,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),G0(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const i=zf(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],n),delete i[o]}),Pi(i,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(i===s)if(i.component){const o=n.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=zf(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=zf(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const i=zf(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new hY(s.value.snapshot))}),e.children.length&&this.forwardEvent(new cY(e.value.snapshot))}activateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(G0(i),i===s)if(i.component){const o=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(i.component){const o=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),G0(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=function zY(r){for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=i,o.resolver=l,o.outlet&&o.outlet.activateWith(i,l),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class W0{constructor(e,t){this.routes=e,this.module=t}}function pu(r){return"function"==typeof r}function Jh(r){return r instanceof $h}const gy=Symbol("INITIAL_VALUE");function py(){return jh(r=>CD(r.map(e=>e.pipe(Ai(1),hS(gy)))).pipe(ID((e,t)=>{let n=!1;return t.reduce((i,s,o)=>i!==gy?i:(s===gy&&(n=!0),n||!1!==s&&o!==t.length-1&&!Jh(s)?i:s),e)},gy),Ki(e=>e!==gy),_e(e=>Jh(e)?e:!0===e),Ai(1)))}class XY{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new my,this.attachRef=null}}class my{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new XY,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let j0=(()=>{class r{constructor(t,n,i,s,o){this.parentContexts=t,this.location=n,this.resolver=i,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new Gn,this.deactivateEvents=new Gn,this.attachEvents=new Gn,this.detachEvents=new Gn,this.name=s||sn,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const o=(n=n||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new ZY(t,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return r.\u0275fac=function(t){return new(t||r)(Ue(my),Ue(Pa),Ue(qm),$l("name"),Ue(Hh))},r.\u0275dir=Mn({type:r,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),r})();class ZY{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===$f?this.route:e===my?this.childContexts:this.parent.get(e,t)}}let ax=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=Zn({type:r,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,n){1&t&&Ii(0,"router-outlet")},directives:[j0],encapsulation:2}),r})();function lx(r,e=""){for(let t=0;t<r.length;t++){const n=r[t];eU(n,tU(e,n))}}function eU(r,e){r.children&&lx(r.children,e)}function tU(r,e){return e?r||e.path?r&&!e.path?`${r}/`:!r&&e.path?e.path:`${r}/${e.path}`:"":r}function z0(r){const e=r.children&&r.children.map(z0),t=e?Object.assign(Object.assign({},r),{children:e}):Object.assign({},r);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==sn&&(t.component=ax),t}function jo(r){return r.outlet||sn}function cx(r,e){const t=r.filter(n=>jo(n)===e);return t.push(...r.filter(n=>jo(n)!==e)),t}const ux={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function vS(r,e,t){var n;if(""===e.path)return"full"===e.pathMatch&&(r.hasChildren()||t.length>0)?Object.assign({},ux):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const s=(e.matcher||gY)(t,r,e);if(!s)return Object.assign({},ux);const o={};Pi(s.posParams,(l,c)=>{o[c]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:a,positionalParamSegments:null!==(n=s.posParams)&&void 0!==n?n:{}}}function SS(r,e,t,n,i="corrected"){if(t.length>0&&function iU(r,e,t){return t.some(n=>AS(r,e,n)&&jo(n)!==sn)}(r,t,n)){const o=new un(e,function rU(r,e,t,n){const i={};i[sn]=n,n._sourceSegment=r,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&jo(s)!==sn){const o=new un([],{});o._sourceSegment=r,o._segmentIndexShift=e.length,i[jo(s)]=o}return i}(r,e,n,new un(t,r.children)));return o._sourceSegment=r,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function sU(r,e,t){return t.some(n=>AS(r,e,n))}(r,t,n)){const o=new un(r.segments,function nU(r,e,t,n,i,s){const o={};for(const a of n)if(AS(r,t,a)&&!i[jo(a)]){const l=new un([],{});l._sourceSegment=r,l._segmentIndexShift="legacy"===s?r.segments.length:e.length,o[jo(a)]=l}return Object.assign(Object.assign({},i),o)}(r,e,t,n,r.children,i));return o._sourceSegment=r,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new un(r.segments,r.children);return s._sourceSegment=r,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function AS(r,e,t){return(!(r.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function hx(r,e,t,n){return!!(jo(r)===n||n!==sn&&AS(e,t,r))&&("**"===r.path||vS(e,r,t).matched)}function dx(r,e,t){return 0===e.length&&!r.children[t]}class bS{constructor(e){this.segmentGroup=e||null}}class fx{constructor(e){this.urlTree=e}}function yy(r){return ly(new bS(r))}function gx(r){return ly(new fx(r))}class cU{constructor(e,t,n,i,s){this.configLoader=t,this.urlSerializer=n,this.urlTree=i,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(ic)}apply(){const e=SS(this.urlTree.root,[],[],this.config).segmentGroup,t=new un(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,sn).pipe(_e(s=>this.createUrlTree($0(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(cc(s=>{if(s instanceof fx)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof bS?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,sn).pipe(_e(i=>this.createUrlTree($0(i),e.queryParams,e.fragment))).pipe(cc(i=>{throw i instanceof bS?this.noMatchError(i):i}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,n){const i=e.segments.length>0?new un([],{[sn]:e}):e;return new $h(i,t,n)}expandSegmentGroup(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(_e(s=>new un([],s))):this.expandSegment(e,n,t,n.segments,i,!0)}expandChildren(e,t,n){const i=[];for(const s of Object.keys(n.children))"primary"===s?i.unshift(s):i.push(s);return gr(i).pipe(Uf(s=>{const o=n.children[s],a=cx(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(_e(l=>({segment:l,outlet:s})))}),ID((s,o)=>(s[o.outlet]=o.segment,s),{}),function tY(r,e){const t=arguments.length>=2;return n=>n.pipe(r?Ki((i,s)=>r(i,s,n)):ae,D0(1),t?ND(e):PD(()=>new uS))}())}expandSegment(e,t,n,i,s,o){return gr(n).pipe(Uf(a=>this.expandSegmentAgainstRoute(e,t,n,a,i,s,o).pipe(cc(c=>{if(c instanceof bS)return Tt(null);throw c}))),zh(a=>!!a),cc((a,l)=>{if(a instanceof uS||"EmptyError"===a.name)return dx(t,i,s)?Tt(new un([],{})):yy(t);throw a}))}expandSegmentAgainstRoute(e,t,n,i,s,o,a){return hx(i,t,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o):yy(t):yy(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,i){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?gx(s):this.lineralizeSegments(n,s).pipe(Bn(o=>{const a=new un(o,{});return this.expandSegment(e,a,t,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:d}=vS(t,i,s);if(!a)return yy(t);const b=this.applyRedirectCommands(l,i.redirectTo,d);return i.redirectTo.startsWith("/")?gx(b):this.lineralizeSegments(i,b).pipe(Bn(N=>this.expandSegment(e,t,n,N.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,n,i,s){if("**"===n.path)return n.loadChildren?(n._loadedConfig?Tt(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(_e(b=>(n._loadedConfig=b,new un(i,{})))):Tt(new un(i,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=vS(t,n,i);return o?this.getChildConfig(e,n,i).pipe(Bn(d=>{const b=d.module,N=d.routes,{segmentGroup:F,slicedSegments:G}=SS(t,a,l,N),W=new un(F.segments,F.children);if(0===G.length&&W.hasChildren())return this.expandChildren(b,N,W).pipe(_e(Te=>new un(a,Te)));if(0===N.length&&0===G.length)return Tt(new un(a,{}));const ie=jo(n)===s;return this.expandSegment(b,W,N,G,ie?sn:s,!0).pipe(_e(de=>new un(a.concat(de.segments),de.children)))})):yy(t)}getChildConfig(e,t,n){return t.children?Tt(new W0(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Tt(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Bn(i=>i?this.configLoader.load(e.injector,t).pipe(_e(s=>(t._loadedConfig=s,s))):function aU(r){return ly(L0(`Cannot load children because the guard of the route "path: '${r.path}'" returned false`))}(t))):Tt(new W0([],e))}runCanLoadGuards(e,t,n){const i=t.canLoad;return i&&0!==i.length?Tt(i.map(o=>{const a=e.get(o);let l;if(function KY(r){return r&&pu(r.canLoad)}(a))l=a.canLoad(t,n);else{if(!pu(a))throw new Error("Invalid CanLoad guard");l=a(t,n)}return dl(l)})).pipe(py(),Ji(o=>{if(!Jh(o))return;const a=L0(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),_e(o=>!0===o)):Tt(!0)}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Tt(n);if(i.numberOfChildren>1||!i.children[sn])return ly(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));i=i.children[sn]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreatreUrlTree(e,t,n,i){const s=this.createSegmentGroup(e,t.root,n,i);return new $h(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Pi(e,(i,s)=>{if("string"==typeof i&&i.startsWith(":")){const a=i.substring(1);n[s]=t[a]}else n[s]=i}),n}createSegmentGroup(e,t,n,i){const s=this.createSegments(e,t.segments,n,i);let o={};return Pi(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,n,i)}),new un(s,o)}createSegments(e,t,n,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,t,n){const i=n[t.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return i}findOrReturn(e,t){let n=0;for(const i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}}function $0(r){const e={};for(const n of Object.keys(r.children)){const s=$0(r.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function uU(r){if(1===r.numberOfChildren&&r.children[sn]){const e=r.children[sn];return new un(r.segments.concat(e.segments),e.children)}return r}(new un(r.segments,e))}class px{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class CS{constructor(e,t){this.component=e,this.route=t}}function dU(r,e,t){const n=r._root;return Ey(n,e?e._root:null,t,[n.value])}function RS(r,e,t){const n=function gU(r){if(!r)return null;for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(n?n.module.injector:t).get(r)}function Ey(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=zf(e);return r.children.forEach(o=>{(function pU(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=r.value,o=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function mU(r,e,t){if("function"==typeof t)return t(r,e);switch(t){case"pathParamsChange":return!Kh(r.url,e.url);case"pathParamsOrQueryParamsChange":return!Kh(r.url,e.url)||!hl(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!V0(r,e)||!hl(r.queryParams,e.queryParams);default:return!V0(r,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new px(n)):(s.data=o.data,s._resolvedData=o._resolvedData),Ey(r,e,s.component?a?a.children:null:t,n,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new CS(a.outlet.component,o))}else o&&wy(e,a,i),i.canActivateChecks.push(new px(n)),Ey(r,null,s.component?a?a.children:null:t,n,i)})(o,s[o.value.outlet],t,n.concat([o.value]),i),delete s[o.value.outlet]}),Pi(s,(o,a)=>wy(o,t.getContext(a),i)),i}function wy(r,e,t){const n=zf(r),i=r.value;Pi(n,(s,o)=>{wy(s,i.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new CS(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class RU{}function mx(r){return new ee(e=>e.error(r))}class OU{constructor(e,t,n,i,s,o){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=i,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=SS(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,sn);if(null===t)return null;const n=new yS([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},sn,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new hc(n,t),s=new ex(this.url,i);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,n=ZD(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}processChildren(e,t){const n=[];for(const s of Object.keys(t.children)){const o=t.children[s],a=cx(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;n.push(...l)}const i=yx(n);return function IU(r){r.sort((e,t)=>e.value.outlet===sn?-1:t.value.outlet===sn?1:e.value.outlet.localeCompare(t.value.outlet))}(i),i}processSegment(e,t,n,i){for(const s of e){const o=this.processSegmentAgainstRoute(s,t,n,i);if(null!==o)return o}return dx(t,n,i)?[]:null}processSegmentAgainstRoute(e,t,n,i){if(e.redirectTo||!hx(e,t,n,i))return null;let s,o=[],a=[];if("**"===e.path){const F=n.length>0?GD(n).parameters:{};s=new yS(n,F,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,vx(e),jo(e),e.component,e,Ex(t),wx(t)+n.length,Sx(e))}else{const F=vS(t,e,n);if(!F.matched)return null;o=F.consumedSegments,a=F.remainingSegments,s=new yS(o,F.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,vx(e),jo(e),e.component,e,Ex(t),wx(t)+o.length,Sx(e))}const l=function PU(r){return r.children?r.children:r.loadChildren?r._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:d}=SS(t,o,a,l.filter(F=>void 0===F.redirectTo),this.relativeLinkResolution);if(0===d.length&&c.hasChildren()){const F=this.processChildren(l,c);return null===F?null:[new hc(s,F)]}if(0===l.length&&0===d.length)return[new hc(s,[])];const b=jo(e)===i,N=this.processSegment(l,c,d,b?sn:i);return null===N?null:[new hc(s,N)]}}function NU(r){const e=r.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function yx(r){const e=[],t=new Set;for(const n of r){if(!NU(n)){e.push(n);continue}const i=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...n.children),t.add(i)):e.push(n)}for(const n of t){const i=yx(n.children);e.push(new hc(n.value,i))}return e.filter(n=>!t.has(n))}function Ex(r){let e=r;for(;e._sourceSegment;)e=e._sourceSegment;return e}function wx(r){let e=r,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function vx(r){return r.data||{}}function Sx(r){return r.resolve||{}}function Ax(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function K0(r){return jh(e=>{const t=r(e);return t?gr(t).pipe(_e(()=>e)):Tt(e)})}class kU extends class BU{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const J0=new pt("ROUTES");class bx{constructor(e,t,n,i){this.injector=e,this.compiler=t,this.onLoadStartListener=n,this.onLoadEndListener=i}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const i=this.loadModuleFactory(t.loadChildren).pipe(_e(s=>{this.onLoadEndListener&&this.onLoadEndListener(t);const o=s.create(e);return new W0(kD(o.injector.get(J0,void 0,It.Self|It.Optional)).map(z0),o)}),cc(s=>{throw t._loader$=void 0,s}));return t._loader$=new X3(i,()=>new ke).pipe(OD()),t._loader$}loadModuleFactory(e){return dl(e()).pipe(Bn(t=>t instanceof GN?Tt(t):gr(this.compiler.compileModuleAsync(t))))}}class VU{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function HU(r){throw r}function YU(r,e,t){return e.parse("/")}function Cx(r,e){return Tt(null)}const UU={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},WU={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Gs=(()=>{class r{constructor(t,n,i,s,o,a,l){this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=i,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ke,this.errorHandler=HU,this.malformedUriErrorHandler=YU,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Cx,afterPreactivation:Cx},this.urlHandlingStrategy=new VU,this.routeReuseStrategy=new kU,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(ic),this.console=o.get(jG);const b=o.get(vn);this.isNgZoneEnabled=b instanceof vn&&vn.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function mY(){return new $h(new un([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new bx(o,a,N=>this.triggerEvent(new xD(N)),N=>this.triggerEvent(new LD(N))),this.routerState=XD(this.currentUrlTree,this.rootComponentType),this.transitions=new Wo({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const n=this.events;return t.pipe(Ki(i=>0!==i.id),_e(i=>Object.assign(Object.assign({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),jh(i=>{let s=!1,o=!1;return Tt(i).pipe(Ji(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),jh(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return Rx(a.source)&&(this.browserUrlTree=a.extractedUrl),Tt(a).pipe(jh(b=>{const N=this.transitions.getValue();return n.next(new x0(b.id,this.serializeUrl(b.extractedUrl),b.source,b.restoredState)),N!==this.transitions.getValue()?$s:Promise.resolve(b)}),function hU(r,e,t,n){return jh(i=>function lU(r,e,t,n,i){return new cU(r,e,t,n,i).apply()}(r,e,t,i.extractedUrl,n).pipe(_e(s=>Object.assign(Object.assign({},i),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Ji(b=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:b.urlAfterRedirects})}),function _U(r,e,t,n,i){return Bn(s=>function TU(r,e,t,n,i="emptyOnly",s="legacy"){try{const o=new OU(r,e,t,n,i,s).recognize();return null===o?mx(new RU):Tt(o)}catch(o){return mx(o)}}(r,e,s.urlAfterRedirects,t(s.urlAfterRedirects),n,i).pipe(_e(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,b=>this.serializeUrl(b),this.paramsInheritanceStrategy,this.relativeLinkResolution),Ji(b=>{if("eager"===this.urlUpdateStrategy){if(!b.extras.skipLocationChange){const F=this.urlHandlingStrategy.merge(b.urlAfterRedirects,b.rawUrl);this.setBrowserUrl(F,b)}this.browserUrlTree=b.urlAfterRedirects}const N=new rY(b.id,this.serializeUrl(b.extractedUrl),this.serializeUrl(b.urlAfterRedirects),b.targetSnapshot);n.next(N)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:N,extractedUrl:F,source:G,restoredState:W,extras:ie}=a,he=new x0(N,this.serializeUrl(F),G,W);n.next(he);const de=XD(F,this.rootComponentType).snapshot;return Tt(Object.assign(Object.assign({},a),{targetSnapshot:de,urlAfterRedirects:F,extras:Object.assign(Object.assign({},ie),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),$s}),K0(a=>{const{targetSnapshot:l,id:c,extractedUrl:d,rawUrl:b,extras:{skipLocationChange:N,replaceUrl:F}}=a;return this.hooks.beforePreactivation(l,{navigationId:c,appliedUrlTree:d,rawUrlTree:b,skipLocationChange:!!N,replaceUrl:!!F})}),Ji(a=>{const l=new iY(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),_e(a=>Object.assign(Object.assign({},a),{guards:dU(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function yU(r,e){return Bn(t=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Tt(Object.assign(Object.assign({},t),{guardsResult:!0})):function EU(r,e,t,n){return gr(r).pipe(Bn(i=>function CU(r,e,t,n,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Tt(s.map(a=>{const l=RS(a,e,i);let c;if(function QY(r){return r&&pu(r.canDeactivate)}(l))c=dl(l.canDeactivate(r,e,t,n));else{if(!pu(l))throw new Error("Invalid CanDeactivate guard");c=dl(l(r,e,t,n))}return c.pipe(zh())})).pipe(py()):Tt(!0)}(i.component,i.route,t,e,n)),zh(i=>!0!==i,!0))}(o,n,i,r).pipe(Bn(a=>a&&function $Y(r){return"boolean"==typeof r}(a)?function wU(r,e,t,n){return gr(e).pipe(Uf(i=>cy(function SU(r,e){return null!==r&&e&&e(new lY(r)),Tt(!0)}(i.route.parent,n),function vU(r,e){return null!==r&&e&&e(new uY(r)),Tt(!0)}(i.route,n),function bU(r,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function fU(r){const e=r.routeConfig?r.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:r,guards:e}:null}(o)).filter(o=>null!==o).map(o=>TD(()=>Tt(o.guards.map(l=>{const c=RS(l,o.node,t);let d;if(function qY(r){return r&&pu(r.canActivateChild)}(c))d=dl(c.canActivateChild(n,r));else{if(!pu(c))throw new Error("Invalid CanActivateChild guard");d=dl(c(n,r))}return d.pipe(zh())})).pipe(py())));return Tt(s).pipe(py())}(r,i.path,t),function AU(r,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Tt(!0);const i=n.map(s=>TD(()=>{const o=RS(s,e,t);let a;if(function JY(r){return r&&pu(r.canActivate)}(o))a=dl(o.canActivate(e,r));else{if(!pu(o))throw new Error("Invalid CanActivate guard");a=dl(o(e,r))}return a.pipe(zh())}));return Tt(i).pipe(py())}(r,i.route,t))),zh(i=>!0!==i,!0))}(n,s,r,e):Tt(a)),_e(a=>Object.assign(Object.assign({},t),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Ji(a=>{if(Jh(a.guardsResult)){const c=L0(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new sY(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),Ki(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),K0(a=>{if(a.guards.canActivateChecks.length)return Tt(a).pipe(Ji(l=>{const c=new oY(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),jh(l=>{let c=!1;return Tt(l).pipe(function DU(r,e){return Bn(t=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return Tt(t);let s=0;return gr(i).pipe(Uf(o=>function xU(r,e,t,n){return function LU(r,e,t,n){const i=Ax(r);if(0===i.length)return Tt({});const s={};return gr(i).pipe(Bn(o=>function MU(r,e,t,n){const i=RS(r,e,n);return dl(i.resolve?i.resolve(e,t):i(e,t))}(r[o],e,t,n).pipe(Ji(a=>{s[o]=a}))),D0(1),Bn(()=>Ax(s).length===i.length?Tt(s):$s))}(r._resolve,r,e,n).pipe(_e(s=>(r._resolvedData=s,r.data=Object.assign(Object.assign({},r.data),ZD(r,t).resolve),null)))}(o.route,n,r,e)),Ji(()=>s++),D0(1),Bn(o=>s===i.length?Tt(t):$s))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Ji({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),Ji(l=>{const c=new aY(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),K0(a=>{const{targetSnapshot:l,id:c,extractedUrl:d,rawUrl:b,extras:{skipLocationChange:N,replaceUrl:F}}=a;return this.hooks.afterPreactivation(l,{navigationId:c,appliedUrlTree:d,rawUrlTree:b,skipLocationChange:!!N,replaceUrl:!!F})}),_e(a=>{const l=function LY(r,e,t){const n=dy(r,e._root,t?t._root:void 0);return new QD(n,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),Ji(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((r,e,t)=>_e(n=>(new jY(e,n.targetRouterState,n.currentRouterState,t).activate(r),n)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Ji({next(){s=!0},complete(){s=!0}}),_D(()=>{var a;s||o||this.cancelNavigationTransition(i,`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===i.id&&(this.currentNavigation=null)}),cc(a=>{if(o=!0,function fY(r){return r&&r[FD]}(a)){const l=Jh(a.url);l||(this.navigated=!0,this.restoreHistory(i,!0));const c=new DD(i.id,this.serializeUrl(i.extractedUrl),a.message);n.next(c),l?setTimeout(()=>{const d=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),b={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Rx(i.source)};this.scheduleNavigation(d,"imperative",null,b,{resolve:i.resolve,reject:i.reject,promise:i.promise})},0):i.resolve(!1)}else{this.restoreHistory(i,!0);const l=new nY(i.id,this.serializeUrl(i.extractedUrl),a);n.next(l);try{i.resolve(this.errorHandler(a))}catch(c){i.reject(c)}}return $s}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{var i;const s={replaceUrl:!0},o=(null===(i=t.state)||void 0===i?void 0:i.navigationId)?t.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t.url);this.scheduleNavigation(a,n,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){lx(t),this.config=t.map(z0),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,c=i||this.routerState.root,d=l?this.currentUrlTree.fragment:o;let b=null;switch(a){case"merge":b=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":b=this.currentUrlTree.queryParams;break;default:b=s||null}return null!==b&&(b=this.removeEmptyProps(b)),function BY(r,e,t,n,i){if(0===t.length)return H0(e.root,e.root,e.root,n,i);const s=function kY(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new rx(!0,0,r);let e=0,t=!1;const n=r.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Pi(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new rx(t,e,n)}(t);if(s.toRoot())return H0(e.root,e.root,new un([],{}),n,i);const o=function GY(r,e,t){if(r.isAbsolute)return new Y0(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const s=t.snapshot._urlSegment;return new Y0(s,s===e.root,0)}const n=ES(r.commands[0])?0:1;return function VY(r,e,t){let n=r,i=e,s=t;for(;s>i;){if(s-=i,n=n.parent,!n)throw new Error("Invalid number of '../'");i=n.segments.length}return new Y0(n,!1,i-s)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+n,r.numberOfDoubleDots)}(s,e,r),a=o.processChildren?wS(o.segmentGroup,o.index,s.commands):ix(o.segmentGroup,o.index,s.commands);return H0(e.root,o.segmentGroup,a,n,i)}(c,this.currentUrlTree,t,b,null!=d?d:null)}navigateByUrl(t,n={skipLocationChange:!1}){const i=Jh(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,n)}navigate(t,n={skipLocationChange:!1}){return function jU(r){for(let e=0;e<r.length;e++){const t=r[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(i){n=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return n}isActive(t,n){let i;if(i=!0===n?Object.assign({},UU):!1===n?Object.assign({},WU):n,Jh(t))return HD(this.currentUrlTree,t,i);const s=this.parseUrl(t);return HD(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.keys(t).reduce((n,i)=>{const s=t[i];return null!=s&&(n[i]=s),n},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Wf(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,n,i,s,o){var a,l;if(this.disposed)return Promise.resolve(!1);let c,d,b;o?(c=o.resolve,d=o.reject,b=o.promise):b=new Promise((G,W)=>{c=G,d=W});const N=++this.navigationId;let F;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),F=i&&i.\u0275routerPageId?i.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):F=0,this.setTransition({id:N,targetPageId:F,source:n,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:c,reject:d,promise:b,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),b.catch(G=>Promise.reject(G))}setBrowserUrl(t,n){const i=this.urlSerializer.serialize(t),s=Object.assign(Object.assign({},n.extras.state),this.generateNgRouterState(n.id,n.targetPageId));this.location.isCurrentPathEqualTo(i)||n.extras.replaceUrl?this.location.replaceState(i,"",s):this.location.go(i,"",s)}restoreHistory(t,n=!1){var i,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,n){const i=new DD(t.id,this.serializeUrl(t.extractedUrl),n);this.triggerEvent(i),t.resolve(!1)}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return r.\u0275fac=function(t){gR()},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();function Rx(r){return"imperative"!==r}let TS=(()=>{class r{constructor(t,n,i,s,o){this.router=t,this.route=n,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.commands=null,this.onChanges=new ke,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){if(null!=this.tabIndexAttribute)return;const n=this.renderer,i=this.el.nativeElement;null!==t?n.setAttribute(i,"tabindex",t):n.removeAttribute(i,"tabindex")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const t={skipLocationChange:Kf(this.skipLocationChange),replaceUrl:Kf(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Kf(this.preserveFragment)})}}return r.\u0275fac=function(t){return new(t||r)(Ue(Gs),Ue($f),$l("tabindex"),Ue(kv),Ue(Dr))},r.\u0275dir=Mn({type:r,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,n){1&t&&zi("click",function(){return n.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[ca]}),r})();function Kf(r){return""===r||!!r}class Tx{}class Ox{preload(e,t){return Tt(null)}}let Ix=(()=>{class r{constructor(t,n,i,s){this.router=t,this.injector=i,this.preloadingStrategy=s,this.loader=new bx(i,n,l=>t.triggerEvent(new xD(l)),l=>t.triggerEvent(new LD(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(Ki(t=>t instanceof Wf),Uf(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(ic);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const i=[];for(const s of n)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;i.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?i.push(this.preloadConfig(t,s)):s.children&&i.push(this.processRoutes(t,s.children));return gr(i).pipe(Wa(),_e(s=>{}))}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>(n._loadedConfig?Tt(n._loadedConfig):this.loader.load(t.injector,n)).pipe(Bn(s=>(n._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return r.\u0275fac=function(t){return new(t||r)($e(Gs),$e(S_),$e(M),$e(Tx))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),Q0=(()=>{class r{constructor(t,n,i={}){this.router=t,this.viewportScroller=n,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof x0?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Wf&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof MD&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.router.triggerEvent(new MD(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return r.\u0275fac=function(t){gR()},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const qh=new pt("ROUTER_CONFIGURATION"),Px=new pt("ROUTER_FORROOT_GUARD"),JU=[u0,{provide:jD,useClass:zD},{provide:Gs,useFactory:function eW(r,e,t,n,i,s,o={},a,l){const c=new Gs(null,r,e,t,n,i,kD(s));return a&&(c.urlHandlingStrategy=a),l&&(c.routeReuseStrategy=l),function tW(r,e){r.errorHandler&&(e.errorHandler=r.errorHandler),r.malformedUriErrorHandler&&(e.malformedUriErrorHandler=r.malformedUriErrorHandler),r.onSameUrlNavigation&&(e.onSameUrlNavigation=r.onSameUrlNavigation),r.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=r.paramsInheritanceStrategy),r.relativeLinkResolution&&(e.relativeLinkResolution=r.relativeLinkResolution),r.urlUpdateStrategy&&(e.urlUpdateStrategy=r.urlUpdateStrategy),r.canceledNavigationResolution&&(e.canceledNavigationResolution=r.canceledNavigationResolution)}(o,c),o.enableTracing&&c.events.subscribe(d=>{var b,N;null===(b=console.group)||void 0===b||b.call(console,`Router Event: ${d.constructor.name}`),console.log(d.toString()),console.log(d),null===(N=console.groupEnd)||void 0===N||N.call(console)}),c},deps:[jD,my,u0,M,S_,J0,qh,[class GU{},new Ns],[class FU{},new Ns]]},my,{provide:$f,useFactory:function nW(r){return r.routerState.root},deps:[Gs]},Ix,Ox,class KU{preload(e,t){return t().pipe(cc(()=>Tt(null)))}},{provide:qh,useValue:{enableTracing:!1}}];function qU(){return new R_("Router",Gs)}let Nx=(()=>{class r{constructor(t,n){}static forRoot(t,n){return{ngModule:r,providers:[JU,_x(t),{provide:Px,useFactory:ZU,deps:[[Gs,new Ns,new Zc]]},{provide:qh,useValue:n||{}},{provide:Yf,useFactory:XU,deps:[Uh,[new Ps(c0),new Ns],qh]},{provide:Q0,useFactory:QU,deps:[Gs,r3,qh]},{provide:Tx,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:Ox},{provide:R_,multi:!0,useFactory:qU},[X0,{provide:zR,multi:!0,useFactory:rW,deps:[X0]},{provide:Dx,useFactory:iW,deps:[X0]},{provide:v_,multi:!0,useExisting:Dx}]]}}static forChild(t){return{ngModule:r,providers:[_x(t)]}}}return r.\u0275fac=function(t){return new(t||r)($e(Px,8),$e(Gs,8))},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({}),r})();function QU(r,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new Q0(r,e,t)}function XU(r,e,t={}){return t.useHash?new kV(r,e):new W_(r,e)}function ZU(r){return"guarded"}function _x(r){return[{provide:fb,multi:!0,useValue:r},{provide:J0,multi:!0,useValue:r}]}let X0=(()=>{class r{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new ke}appInitializer(){return this.injector.get(MV,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let n=null;const i=new Promise(a=>n=a),s=this.injector.get(Gs),o=this.injector.get(qh);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),n(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?Tt(null):(this.initNavigation=!0,n(!0),this.resultOfPreactivationDone),s.initialNavigation()):n(!0),i})}bootstrapListener(t){const n=this.injector.get(qh),i=this.injector.get(Ix),s=this.injector.get(Q0),o=this.injector.get(Gs),a=this.injector.get(t0);t===a.components[0]&&(("enabledNonBlocking"===n.initialNavigation||void 0===n.initialNavigation)&&o.initialNavigation(),i.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return r.\u0275fac=function(t){return new(t||r)($e(M))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();function rW(r){return r.appInitializer.bind(r)}function iW(r){return r.bootstrapListener.bind(r)}const Dx=new pt("Router Initializer");let oW=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=Zn({type:r,selectors:[["app-help"]],decls:2,vars:0,template:function(t,n){1&t&&(Lt(0,"span"),Bs(1,"Help page"),$t())},styles:[""]}),r})();function xx(r,e,t,n,i,s,o){try{var a=r[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(n,i)}var lW=p(3525),mu=p(5114);class Lx{constructor(){this.attrs=[],this._parent=null}clearAttr(){this.attrs=[]}setAttr(e,t){this.attrs[e]=t}getAttr(e){return this.attrs[e]}get parent(){return this._parent}set parent(e){this._parent=e}*getAncestors(){let e=this.parent;for(;null!=e;)yield e,e=e.parent}isDescendantOf(e){for(const t of this.getAncestors())if(t==e)return!0;return!1}}var yu=(()=>{return(r=yu||(yu={}))[r.None=0]="None",r[r.FromAncestor=1]="FromAncestor",r[r.ToAncestor=2]="ToAncestor",yu;var r})();class Mx extends Lx{constructor(e,t){super(),this.source=e,this.target=t,e!=t?(e.outEdges.add(this),t.inEdges.add(this)):e.selfEdges.add(this)}add(){this.source!=this.target?(this.source.outEdges.add(this),this.target.inEdges.add(this)):this.source.selfEdges.add(this)}remove(){this.source!=this.target?(this.source.outEdges.delete(this),this.target.inEdges.delete(this)):this.source.selfEdges.delete(this)}toString(){return"("+this.source.toString()+"->"+this.target.toString()+")"}isInterGraphEdge(){return this.source.parent!=this.target.parent}EdgeToAncestor(){return this.source instanceof so&&this.target.isDescendantOf(this.source)?yu.FromAncestor:this.target instanceof so&&this.source.isDescendantOf(this.target)?yu.ToAncestor:yu.None}}class OS{static assert(e,t=null){if(!e)throw null!=t?(console.log(t),new Error(t)):new Error("condition does not hold")}}class Fx extends Lx{constructor(e){super(),this.inEdges=new Set,this.outEdges=new Set,this.selfEdges=new Set,this.id=e}get id(){return this._id}set id(e){this._id=e}toString(){return this.id}*_edges(){for(const e of this.inEdges)yield e;for(const e of this.outEdges)yield e;for(const e of this.selfEdges)yield e}addInEdge(e){OS.assert(null!=e),OS.assert(e.target==this),this.inEdges.add(e)}addOutEdge(e){this.outEdges.add(e)}addSelfEdge(e){this.selfEdges.add(e)}get edges(){return this._edges()}get outDegree(){return this.outEdges.size}get inDegree(){return this.inEdges.size}get selfDegree(){return this.selfEdges.size}get degree(){return this.outDegree+this.inDegree+this.selfDegree}*getAncestors(){let e=this.parent;for(;null!=e;)yield e,e=e.parent}isUnderCollapsedGraph(){return null!=this.parent&&this.parent.isCollapsed}}class cW{constructor(){this.nodeMap=new Map}*nodes_(){for(const e of this.nodeMap.values())yield e}*graphs_(){for(const e of this.nodes_())e instanceof so&&(yield e)}find(e){return this.nodeMap.get(e)}get nodesShallow(){return this.nodes_()}*nodesDeep(){for(const e of this.nodes_())if(yield e,e instanceof so)for(const t of e.nodeCollection.nodesDeep())yield t}get graphs(){return this.graphs_()}*_edges(){for(const e of this.nodeMap.values()){for(const t of e.outEdges)yield t;for(const t of e.selfEdges)yield t}}interGraphEdges(){throw new Error("not implemented")}hasNode(e){if(this.nodeMap.has(e))return!0;for(const t of this.nodeMap)if(t[1]instanceof so&&t[1].nodeCollection.hasNode(e))return!0;return!1}getNode(e){let t=this.nodeMap.get(e);if(null!=t)return t;for(const n of this.nodeMap)if(n[1]instanceof so&&(t=n[1].nodeCollection.getNode(e),null!=t))return t}get nodeShallowCount(){return this.nodeMap.size}get nodeDeepCount(){let e=this.nodeMap.size;for(const t of this.nodeMap.values())t instanceof so&&(e+=t.nodeCollection.nodeDeepCount);return e}get edgeCount(){let e=0;for(const t of this.nodeMap.values())e+=t.outDegree+t.selfDegree;return e}get edges(){return this._edges()}addNode(e){null==this.getNode(e.id)&&this.nodeMap.set(e.id,e)}addEdge(e){this.addNode(e.source),this.addNode(e.target),e.source!=e.target?(e.source.outEdges.add(e),e.target.inEdges.add(e)):e.source.selfEdges.add(e)}removeNode(e){for(const t of e.outEdges)t.target.inEdges.delete(t);for(const t of e.inEdges)t.source.outEdges.delete(t);this.nodeMap.delete(e.id);for(const t of this.nodeMap.values())t instanceof so&&t.nodeCollection.nodeMap.delete(e.id)}nodeIsConsistent(e){for(const t of e.outEdges)if(t.source!=e||t.source==t.target||!this.nodeMap.has(t.target.id))return!1;for(const t of e.inEdges)return!(t.target!=e||t.source==t.target||!this.nodeMap.has(t.source.id));for(const t of e.selfEdges)if(t.target!=t.source||t.source==e)return!1;return!0}isConsistent(){for(const e of this.nodeMap)if(!this.nodeIsConsistent(e[1]))return!1;return!0}}class so extends Fx{constructor(e="__graph__"){super(e),this.isCollapsed=!1,this.nodeCollection=new cW}*graphs(){for(const e of this.nodeCollection.graphs)yield e}noEmptySubgraphs(){for(const e of this.subgraphs())if(0==e.shallowNodeCount)return!1;return!0}hasSubgraphs(){for(const e of this.shallowNodes)if(e instanceof so)return!0;return!1}*subgraphs(){for(const e of this.deepNodes)e instanceof so&&(yield e)}isEmpty(){return 0==this.shallowNodeCount}setEdge(e,t){const n=this.nodeCollection.find(e);if(null==n)return;const i=this.nodeCollection.find(t);if(null==i)return;const s=new Mx(n,i);return this.addEdge(s),s}get shallowNodes(){return this.nodeCollection.nodesShallow}get deepNodes(){return this.nodeCollection.nodesDeep()}findNode(e){return this.nodeCollection.find(e)}get edges(){return this.nodeCollection.edges}*deepEdges(){for(const e of this.deepNodes){for(const t of e.outEdges)yield t;for(const t of e.selfEdges)yield t}}isConsistent(){return this.nodeCollection.isConsistent()}nodeIsConsistent(e){return this.nodeCollection.nodeIsConsistent(e)}removeNode(e){this.nodeCollection.removeNode(e)}addNode(e){return e.parent=this,this.nodeCollection.addNode(e),e}addEdge(e){this.nodeCollection.addEdge(e)}get shallowNodeCount(){return this.nodeCollection.nodeShallowCount}get nodeCountDeep(){return this.nodeCollection.nodeDeepCount}get edgeCount(){return this.nodeCollection.edgeCount}liftNode(e){for(;null!=e&&e.parent!=this;)e=e.parent;return e}deepEdgesCount(){let e=0;for(const t of this.deepNodes)e+=t.outDegree+t.selfDegree;return e}}let vy=(()=>{class r{static solve(t,n,i,s,o,a){const l=t*o-s*n;if(!(Math.abs(l)<r.eps))return{x:(i*o-a*n)/l,y:(t*a-s*i)/l}}}return r.eps=1e-8,r})();class le{static RoundPoint(e){return new k(le.RoundDouble(e.x),le.RoundDouble(e.y))}static RoundDouble(e){return Math.round(e*le.mult)/le.mult}}function $n(r,e){const t=r-e;return t<0?-1:0==t?0:1}function IS(r,e){return $n(r.y,e.y)||$n(r.x,e.x)}function an(r,e){const t=r-e;return-le.distanceEpsilon<=t&&t<=le.distanceEpsilon}function Z0(r,e){return Jf(r,e)>0}function Jf(r,e){const t=r-e;return t<=-le.distanceEpsilon?-1:t>=le.distanceEpsilon?1:0}le.distanceEpsilonPrecision=6,le.mult=Math.pow(10,6),le.defaultLeafBoxesOffset=.5,le.lineSegmentThreshold=.05,le.intersectionEpsilon=1e-4,le.distanceEpsilon=Math.pow(10,-le.distanceEpsilonPrecision),le.squareOfDistanceEpsilon=Math.pow(10,2*-le.distanceEpsilonPrecision),le.tolerance=1e-8;var nt=(()=>{return(r=nt||(nt={}))[r.Clockwise=0]="Clockwise",r[r.Counterclockwise=1]="Counterclockwise",r[r.Collinear=2]="Collinear",nt;var r})();function Dn(r,e){return r.sub(e).length}class k{constructor(e,t){this.x_=e,this.y_=t}static ProjectionToLine(e,t,n){let i=t.sub(e);const s=i.length;if(s<le.distanceEpsilon)return e;i=i.div(s);const o=n.sub(e).dot(i);return e.add(i.mul(o))}static RayIntersectsRayInteriors(e,t,n,i){const s=k.lineLineIntersection(e,e.add(t),n,n.add(i));if(s&&s.sub(e).dot(t.div(t.l1))>le.distanceEpsilon&&s.sub(n).dot(i.div(i.l1))>le.distanceEpsilon)return s}static IntervalIntersectsRay(e,t,n,i){const s=k.lineLineIntersection(e,t,n,n.add(i));if(!s)return;const o=e.sub(s),a=s.sub(t);return!(o.dot(a)<=0)&&!(s.sub(n).dot(i)<0)&&o.dot(o)>le.squareOfDistanceEpsilon&&a.dot(a)>=le.squareOfDistanceEpsilon?s:void 0}static PointToTheLeftOfLineOrOnLine(e,t,n){return k.signedDoubledTriangleArea(e,t,n)>=0}static PointToTheLeftOfLine(e,t,n){return k.signedDoubledTriangleArea(e,t,n)>0}static PointIsInsideCone(e,t,n,i){return k.PointToTheRightOfLineOrOnLine(e,t,n)&&k.PointToTheLeftOfLineOrOnLine(e,t,i)}static PointToTheRightOfLineOrOnLine(e,t,n){return k.signedDoubledTriangleArea(t,n,e)<=0}static PointToTheRightOfLine(e,t,n){return k.signedDoubledTriangleArea(t,n,e)<0}static closeIntersections(e,t){return k.close(e,t,le.intersectionEpsilon)}get l1(){return Math.abs(this.x_)+Math.abs(this.y_)}dot(e){return this.x*e.x+this.y*e.y}get x(){return this.x_}get y(){return this.y_}compareTo(e){const t=$n(this.x,e.x);return 0!=t?t:$n(this.y,e.y)}toString(){return"("+this.x+","+this.y+")"}static close(e,t,n){return e.sub(t).length<=n}static closeSquare(e,t,n){const i=t.sub(e);return i.dot(i)<=n}static closeDistEps(e,t,n=le.distanceEpsilon){return e.sub(t).length<=n}normalize(){const e=this.length;return new k(this.x/e,this.y/e)}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}get lengthSquared(){return this.x*this.x+this.y*this.y}static middle(e,t){return e.add(t).div(2)}scale(e,t){return new k(this.x*e,this.y*t)}add(e){return new k(this.x+e.x,this.y+e.y)}sub(e){return new k(this.x-e.x,this.y-e.y)}mul(e){return new k(this.x*e,this.y*e)}div(e){return new k(this.x/e,this.y/e)}equal(e){return e.x==this.x&&e.y==this.y}neg(){return new k(-this.x,-this.y)}static lineLineIntersection(e,t,n,i){const s=t.sub(e),o=n.sub(i),a=n.sub(e),l=vy.solve(s.x,o.x,a.x,s.y,o.y,a.y);if(null!=l)return e.add(s.mul(l.x))}static segSegIntersection(e,t,n,i){const s=t.sub(e),o=n.sub(i),a=n.sub(e),l=le.tolerance,c=vy.solve(s.x,o.x,a.x,s.y,o.y,a.y);if(null!=c&&c.x>-l&&c.x<1+l&&c.y>-l&&c.y<1+l)return e.add(s.mul(c.x))}static parallelWithinEpsilon(e,t,n){const i=e.length,s=t.length;return i<n||s<n||(e=e.div(i),t=t.div(s),Math.abs(-e.x*t.y+e.y*t.x)<n)}static crossProduct(e,t){return e.x*t.y-e.y*t.x}static dot(e,t){return e.x*t.x+e.y*t.y}static add(e,t){return e.add(t)}rotate90Ccw(){return new k(-this.y,this.x)}rotate90Cw(){return new k(this.y,-this.x)}clone(){return new k(this.x,this.y)}rotate(e){const t=Math.cos(e),n=Math.sin(e);return new k(t*this.x-n*this.y,n*this.x+t*this.y)}static mkPoint(e,t,n,i){return t.mul(e).add(i.mul(n))}static convSum(e,t,n){return t.add(n.sub(t).mul(e))}static anglePCP(e,t,n){return k.angle(e.sub(t),n.sub(t))}static angle(e,t){const n=e.x,i=e.y,s=t.x,o=t.y,a=n*o-i*s,l=n*s+i*o;if(Math.abs(l)<le.tolerance)return Math.abs(a)<le.tolerance?0:a<-le.tolerance?3*Math.PI/2:Math.PI/2;if(Math.abs(a)<le.tolerance)return l<-le.tolerance?Math.PI:0;const c=Math.atan2(a,l);return a>=-le.tolerance?c:2*Math.PI+c}static signedDoubledTriangleArea(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}static getTriangleOrientation(e,t,n){const i=k.signedDoubledTriangleArea(e,t,n);return i>le.distanceEpsilon?nt.Counterclockwise:i<-le.distanceEpsilon?nt.Clockwise:nt.Collinear}static getTriangleOrientationWithIntersectionEpsilon(e,t,n){const i=k.signedDoubledTriangleArea(e,t,n);return i>le.intersectionEpsilon?nt.Counterclockwise:i<-le.intersectionEpsilon?nt.Clockwise:nt.Collinear}static ClosestPointAtLineSegment(e,t,n){const i=n.sub(t),s=e.sub(t),o=i.dot(s),a=i.dot(i);return o<=0+le.tolerance?t:a<=o+le.tolerance?n:t.add(i.mul(o/a))}static pointToTheLeftOfLineOrOnLine(e,t,n){return k.signedDoubledTriangleArea(e,t,n)>=0}static pointToTheLeftOfLine(e,t,n){return k.signedDoubledTriangleArea(e,t,n)>0}static pointToTheRightOfLineOrOnLine(e,t,n){return k.signedDoubledTriangleArea(t,n,e)<=0}static pointToTheRightOfLine(e,t,n){return k.signedDoubledTriangleArea(t,n,e)<0}static canProject(e,t,n){const i=n.sub(t);return!(e.sub(t).dot(i)<0||e.sub(n).dot(i)>0)}static distToLineSegment(e,t,n){const i=n.sub(t),s=e.sub(t);let o,a;if((o=i.dot(s))<=le.tolerance)return{par:0,dist:s.length};if((a=i.dot(i))<=o+le.tolerance)return{par:1,dist:e.sub(n).length};const l=o/a;return{par:l,dist:t.add(i.mul(l)).length}}}class oo{constructor(){this._next=null,this.prev=null}get point(){return this._point}set point(e){this._point=e}get next(){return this._next}set next(e){this._next=e}get nextOnPolyline(){return this.polyline.next(this)}get prevOnPolyline(){return this.polyline.prev(this)}getNext(){return this.next}setNext(e){this.next=e,null!=this.polyline&&this.polyline.setInitIsRequired()}getPrev(){return this.prev}setPrev(e){this.prev=e,null!=this.polyline&&this.polyline.setInitIsRequired()}static mkFromPoint(e){const t=new oo;return t.point=e,t}}var fl=(()=>{return(r=fl||(fl={}))[r.Corner=0]="Corner",r[r.VertexA=1]="VertexA",r[r.otherCorner=2]="otherCorner",r[r.VertexB=3]="VertexB",fl;var r})();class gn{contains(e){const t=e.sub(this.corner),n=le.distanceEpsilon,i=t.dot(this.bRot);if(i>this.abRot+n||i<-n)return!1;const s=t.dot(this.aRot);return s<=this.baRot+n&&s>=-n}get area(){return Math.abs(this.a.x*this.b.y-this.a.y*this.b.x)}vertex(e){switch(e){case fl.Corner:return this.corner;case fl.VertexA:return this.aPlusCorner;case fl.otherCorner:return this.otherCorner;case fl.VertexB:return this.bPlusCorner;default:return}}static parallelogramOfTwo(e,t){const n=new gn,i=e.corner,s={minx:i.x,maxx:i.x,miny:i.y,maxy:i.y};return gn.pumpMinMax(s,e.aPlusCorner),gn.pumpMinMax(s,e.otherCorner),gn.pumpMinMax(s,e.bPlusCorner),gn.pumpMinMax(s,t.corner),gn.pumpMinMax(s,t.aPlusCorner),gn.pumpMinMax(s,t.otherCorner),gn.pumpMinMax(s,t.bPlusCorner),n.corner=new k(s.minx,s.miny),n.a=new k(0,s.maxy-s.miny),n.b=new k(s.maxx-s.minx,0),n.aPlusCorner=n.a.add(n.corner),n.otherCorner=n.b.add(n.aPlusCorner),n.bPlusCorner=n.b.add(n.corner),n.aRot=new k(-n.a.y,n.a.x),n.aRot.length>.5&&(n.aRot=n.aRot.normalize()),n.bRot=new k(-n.b.y,n.b.x),n.bRot.length>.5&&(n.bRot=n.bRot.normalize()),n.abRot=n.a.dot(n.bRot),n.baRot=n.b.dot(n.aRot),n.abRot<0&&(n.abRot=-n.abRot,n.bRot=n.bRot.neg()),n.baRot<0&&(n.baRot=-n.baRot,n.aRot=n.aRot.neg()),n.isSeg=n.a.sub(n.b).length<le.distanceEpsilon,n}static pumpMinMax(e,t){t.x<e.minx?e.minx=t.x:t.x>e.maxx&&(e.maxx=t.x),t.y<e.miny?e.miny=t.y:t.y>e.maxy&&(e.maxy=t.y)}static intersect(e,t){return 0!=!(gn.separByA(e,t)||gn.separByA(t,e)||gn.separByB(e,t)||gn.separByB(t,e))&&(!(e.isSeg&&t.isSeg&&k.parallelWithinEpsilon(e.otherCorner.sub(e.corner),t.otherCorner.sub(t.corner),1e-5))||gn.ParallelSegsIntersect(t,e))}static ParallelSegsIntersect(e,t){const n=e.corner,s=t.corner,o=t.otherCorner,a=e.otherCorner.sub(n),c=a.dot(a);let d=s.sub(n).dot(a),b=o.sub(n).dot(a);if(d>b){const N=d;d=b,b=N}return!(b<0-le.distanceEpsilon||d>c+le.distanceEpsilon)}static separByB(e,t){const n=le.distanceEpsilon,i=t.vertex(0).sub(e.corner).dot(e.bRot),s=[fl.VertexA,fl.otherCorner,fl.VertexB];if(i>e.abRot+n){for(const o of s)if(t.vertex(o).sub(e.corner).dot(e.bRot)<=e.abRot+n)return!1;return!0}if(i<-n){for(const o of s)if(t.vertex(o).sub(e.corner).dot(e.bRot)>=-n)return!1;return!0}return!1}static separByA(e,t){const n=le.distanceEpsilon;let i=t.corner.sub(e.corner);const s=k.dot(i,e.aRot);return s>e.baRot+n?(i=t.aPlusCorner.sub(e.corner),!(k.dot(i,e.aRot)<=e.baRot+n||(i=t.bPlusCorner.sub(e.corner),k.dot(i,e.aRot)<=e.baRot+n)||(i=t.otherCorner.sub(e.corner),k.dot(i,e.aRot)<=e.baRot+n))):s<-n&&(i=t.aPlusCorner.sub(e.corner),!(k.dot(i,e.aRot)>=-n||(i=t.bPlusCorner.sub(e.corner),k.dot(i,e.aRot)>=-n)||(i=t.otherCorner.sub(e.corner),k.dot(i,e.aRot)>=-n)))}static parallelogramByCornerSideSide(e,t,n){const i=new gn;return i.corner=e,i.a=t,i.b=n,i.aRot=new k(-t.y,t.x),i.aRot.length>.5&&(i.aRot=i.aRot.normalize()),i.bRot=new k(-n.y,n.x),i.bRot.length>.5&&(i.bRot=i.bRot.normalize()),i.abRot=i.bRot.dot(t),i.baRot=n.dot(i.aRot),i.abRot<0&&(i.abRot=-i.abRot,i.bRot=i.bRot.neg()),i.baRot<0&&(i.baRot=-i.baRot,i.aRot=i.aRot.neg()),i.isSeg=t.sub(n).length<le.distanceEpsilon,i.aPlusCorner=t.add(e),i.otherCorner=n.add(i.aPlusCorner),i.bPlusCorner=n.add(e),i}static getParallelogramOfAGroup(e){let t=0,n=0,i=0,s=0,o=!0;for(const a of e){const l=dW(a);for(const c of l){const d=c.x,b=c.y;o?(o=!1,t=n=d,i=s=b):(d<t?t=d:d>n&&(n=d),b<i?i=b:b>s&&(s=b))}}return gn.parallelogramByCornerSideSide(new k(t,i),new k(0,s-i),new k(n-t,0))}}function*dW(r){yield r.corner,yield r.aPlusCorner,yield r.otherCorner,yield r.bPlusCorner}class Me{constructor(e,t,n,i){this.parStart=0,this.parEnd=1,this.start=new k(e,t),this.end=new k(n,i)}offsetCurve(e,t){return null}trim(e,t){if((e=Math.max(this.parStart,e))>(t=Math.min(this.parEnd,t)))throw"wrong params in trimming";const n=this.value(e),i=this.value(t);return k.close(n,i,le.distanceEpsilon)?null:Me.mkPP(n,i)}value(e){return this.start.add(this.end.sub(this.start).mul(e))}trimWithWrap(e,t){return null}pNodeOverICurve(){const e=this.end.sub(this.start).mul(.5);return{parallelogram:gn.parallelogramByCornerSideSide(this.start,e,e),seg:this,leafBoxesOffset:0,node:{low:0,high:1,chord:this}}}normal(){let e=this.start.sub(this.end);return e=e.div(e.length),new k(-e.y,e.x)}static mkPP(e,t){return new Me(e.x,e.y,t.x,t.y)}static mkLinePXY(e,t,n){return new Me(e.x,e.y,t,n)}derivative(e){return this.end.sub(this.start)}secondDerivative(e){return new k(0,0)}thirdDerivative(e){return new k(0,0)}reverse(){return Me.mkPP(this.end,this.start)}translate(e){this.start=this.start.add(e),this.end=this.end.add(e)}scaleFromOrigin(e,t){return Me.mkPP(this.start.scale(e,t),this.end.scale(e,t))}getParameterAtLength(e){const t=this.end.sub(this.start).length;if(t<le.tolerance)return 0;const n=e/t;return n>1?1:n<0?0:n}transform(e){return Me.mkPP(e.multiplyPoint(this.start),e.multiplyPoint(this.end))}closestParameterWithinBounds(e,t,n){let i=this.closestParameter(e);return i<t&&(i=t),i>n&&(i=n),i}lengthPartial(e,t){return this.value(t).sub(this.value(e)).length}get length(){return this.start.sub(this.end).length}get boundingBox(){return lt.mkPP(this.start,this.end)}clone(){return Me.mkPP(this.start.clone(),this.end.clone())}static closestParameterOnLineSegment(e,t,n){const i=n.sub(t),s=e.sub(t),o=i.dot(s);if(o<=0+le.tolerance)return 0;const a=i.dot(i);return a<=o+le.tolerance?1:o/a}closestParameter(e){return Me.closestParameterOnLineSegment(e,this.start,this.end)}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}static IntersectPPPP(e,t,n,i){const s=k.lineLineIntersection(e,t,n,i);if(null!=s&&Me.xIsBetweenPoints(e,t,s)&&Me.xIsBetweenPoints(n,i,s))return s}static xIsBetweenPoints(e,t,n){return e.sub(n).dot(t.sub(n))<=le.distanceEpsilon}curvature(e){return 0}curvatureDerivative(e){return 0}curvatureSecondDerivative(e){return 0}static minDistBetweenLineSegments(e,t,n,i){const s=t.sub(e),o=i.sub(n),a=e.sub(n),l=k.crossProduct(s,o),c=s.dot(s),d=s.dot(o),b=o.dot(o),N=s.dot(a),F=o.dot(a);let G,W;const ie=Math.abs(l);let he=ie,de=ie;ie<le.tolerance?(G=0,he=1,W=F,de=b):(G=k.crossProduct(o,a),W=k.crossProduct(s,a),l<0&&(G=-G,W=-W),G<0?(G=0,W=F,de=b):G>he&&(G=he=1,W=F+d,de=b)),W<0?(W=0,-N<0?G=0:-N>c?G=he:(G=-N,he=c)):W>de&&(W=de=1,-N+d<0?G=0:-N+d>c?G=he:(G=-N+d,he=c));const Te=Math.abs(G)<le.tolerance?0:G/he,Ke=Math.abs(W)<le.tolerance?0:W/de;return{parab:Te,parcd:Ke,dist:a.add(s.mul(Te).sub(o.mul(Ke))).length}}}class Cr{static distToSegm(e,t,n){const i=n.sub(t);if(i.length<le.intersectionEpsilon)return e.sub(t.add(n).div(2)).length;let s=new k(-i.y,i.x);return s=s.mul(1/s.length),Math.abs(e.sub(t).dot(s))}static createParallelogramOnSubSeg(e,t,n){let i=n.derivative(e);const s=n.derivative(t),o=new k(-s.y,s.x),a=n.value(e),l=n.value(t),d=l.sub(a).dot(o),b=i.dot(o),N=Math.abs(d)<le.distanceEpsilon;if(N||!(Math.abs(b)<le.distanceEpsilon))return i=i.mul(N?0:d/b),gn.parallelogramByCornerSideSide(a,i,l.sub(a).sub(i))}static createParallelogramNodeForCurveSeg(e,t,n,i){if(e==n.parStart&&t==n.parEnd&&k.close(n.start,n.end,le.distanceEpsilon))return Cr.createNodeWithSegmentSplit(e,t,n,i);const o=n.value(e),a=n.value(t),l=a.sub(o),c=n.value((e+t)/2);if(Cr.distToSegm(c,o,a)<=le.intersectionEpsilon&&l.dot(l)<le.lineSegmentThreshold*le.lineSegmentThreshold&&t-e<le.lineSegmentThreshold){const d=Me.mkPP(o,a),b=d.pNodeOverICurve();b.seg=n;const N=b.node;return N.low=e,N.high=t,N.chord=d,b}if(Cr.WithinEpsilon(n,e,t,i)){const d=Cr.createParallelogramOnSubSeg(e,t,n);if(null!=d)return function fW(r,e,t,n,i){return{parallelogram:t,seg:n,leafBoxesOffset:i,node:{low:r,high:e,chord:null}}}(e,t,d,n,i)}return Cr.createNodeWithSegmentSplit(e,t,n,i)}static WithinEpsilon(e,t,n,i){const o=(n-t)/3,a=e.value(t),l=e.value(n);return!(Cr.distToSegm(e.value(t+o),a,l)>i)&&Cr.distToSegm(e.value(t+2*o),a,l)<=i}static createParallelogramNodeForCurveSegDefaultOffset(e){return Cr.createParallelogramNodeForCurveSeg(e.parStart,e.parEnd,e,le.defaultLeafBoxesOffset)}static createNodeWithSegmentSplit(e,t,n,i){const s={parallelogram:null,seg:n,leafBoxesOffset:1,node:{children:[]}},o=s.node;return o.children.push(Cr.createParallelogramNodeForCurveSeg(e,.5*(e+t),n,i)),o.children.push(Cr.createParallelogramNodeForCurveSeg(.5*(e+t),t,n,i)),s.parallelogram=gn.parallelogramOfTwo(o.children[0].parallelogram,o.children[1].parallelogram),s}}class Eu{constructor(e,t,n,i,s){this.par0=e,this.par1=t,this.x=n,this.seg0=i,this.seg1=s}}class PS{static closestPoint(e,t,n,i,s){let b,l=n,c=0,d=0,N=!1;do{const F=e.value(l),G=e.derivative(l),W=e.secondDerivative(l),ie=G.dot(G)+F.sub(t).dot(W);if(Math.abs(ie)<le.tolerance)return l;b=F.sub(t).dot(G.div(ie)),l-=b,l>s+le.tolerance?(l=s,d++):l<i-le.tolerance&&(l=i,d++),c++}while(Math.abs(b)>le.tolerance&&!(N=c>=5||d>=5));return N&&e.value(n).sub(t).length<le.distanceEpsilon&&(l=n),l}}class Tn{constructor(e,t,n,i,s){this.parStart=e,this.parEnd=t,this.aAxis=n,this.bAxis=i,this.center=s,this.pNode=null,this.setBoundingBox()}offsetCurve(e,t){const n=t.sub(this.center),i=k.angle(this.aAxis,n);if(this.aAxis.mul(Math.cos(i)).add(this.bAxis.mul(Math.sin(i))).length<n.length){const o=this.aAxis.length,a=this.bAxis.length;return Tn.mkEllipsePPP(this.aAxis.normalize().mul(o+e),this.bAxis.normalize().mul(a+e),this.center)}{const o=this.aAxis.length,a=this.bAxis.length;return Tn.mkEllipsePPP(this.aAxis.normalize().mul(o-e),this.bAxis.normalize().mul(a-e),this.center)}}reverse(){return null}static mkEllipsePPP(e,t,n){return new Tn(0,2*Math.PI,e,t,n)}get start(){return this.value(this.parStart)}get end(){return this.value(this.parEnd)}trim(e,t){return new Tn(Math.max(e,this.parStart),Math.min(t,this.parEnd),this.aAxis,this.bAxis,this.center)}trimWithWrap(e,t){return null}get boundingBox(){return this.box}value(e){return this.center.add(k.mkPoint(Math.cos(e),this.aAxis,Math.sin(e),this.bAxis))}derivative(e){return k.mkPoint(-Math.sin(e),this.aAxis,Math.cos(e),this.bAxis)}secondDerivative(e){return k.mkPoint(-Math.cos(e),this.aAxis,-Math.sin(e),this.bAxis)}thirdDerivative(e){return k.mkPoint(Math.sin(e),this.aAxis,-Math.cos(e),this.bAxis)}pNodeOverICurve(){return null!=this.pNode?this.pNode:this.pNode=Cr.createParallelogramNodeForCurveSegDefaultOffset(this)}setBoundingBox(){if(an(this.parStart,0)&&an(this.parEnd,2*Math.PI))this.box=this.fullBox();else{let e;this.box=lt.mkPP(this.start,this.end);for(let t=Math.ceil(this.parStart/(Math.PI/2));(e=t*Math.PI/2)<this.parEnd;t++)e>this.parStart&&this.box.add(this.value(e))}}static mkEllipse(e,t,n,i,s,o){return new Tn(e,t,n,i,new k(s,o))}static mkFullEllipsePPP(e,t,n){return new Tn(0,2*Math.PI,e,t,n)}static mkFullEllipseNNP(e,t,n){return new Tn(0,2*Math.PI,new k(e,0),new k(0,t),n)}static mkCircle(e,t){return Tn.mkFullEllipseNNP(e,e,t)}translate(e){this.center=this.center.add(e),this.box.center=this.box.center.add(e),this.pNode=null}scaleFromOrigin(e,t){return new Tn(this.parStart,this.parEnd,this.aAxis.mul(e),this.bAxis.mul(t),this.center.scale(e,t))}getParameterAtLength(e){let n=this.parStart,i=this.parEnd;const s=e+.001,o=e-.001;for(;i-n>le.distanceEpsilon;){const a=.5*(i+n),l=this.lengthPartial(this.parStart,a);if(l>s)i=a;else{if(!(l<o))return a;n=a}}return(i+n)/2}transform(e){if(null!=e){const t=e.multiplyPoint(this.aAxis).sub(e.offset()),n=e.multiplyPoint(this.bAxis).sub(e.offset());return new Tn(this.parStart,this.parEnd,t,n,e.multiplyPoint(this.center))}return this}closestParameterWithinBounds(e,t,n){const s=(n-t)/9;let o=t,a=Number.MAX_VALUE;for(let c=0;c<=8;c++){const d=t+c*s,b=e.sub(this.value(d)),N=b.dot(b);N<a&&(a=N,o=d)}0==o&&n==2*Math.PI&&(t=-Math.PI);let l=PS.closestPoint(this,e,o,t,n);return l<0&&(l+=2*Math.PI),l}lengthPartial(e,t){return fe.lengthWithInterpolationAndThreshold(this.trim(e,t),le.lineSegmentThreshold/100)}get length(){return fe.lengthWithInterpolation(this)}clone(){return new Tn(this.parStart,this.parEnd,this.aAxis.clone(),this.bAxis.clone(),this.center.clone())}closestParameter(e){let t=0;const i=(this.parEnd-this.parStart)/9;let s=this.parStart,o=Number.MAX_VALUE;for(let c=0;c<=8;c++){const d=this.parStart+c*i,b=e.sub(this.value(d)),N=b.dot(b);N<o&&(o=N,s=d)}let a=!1;0==s&&this.parEnd==2*Math.PI&&(a=!0,t=this.parStart,this.parStart=-Math.PI);let l=PS.closestPoint(this,e,s,this.parStart,this.parEnd);return l<0&&(l+=2*Math.PI),a&&(this.parStart=t),l}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}curvature(e){throw"NotImplementedException()"}curvatureDerivative(e){throw"NotImplementedException();"}curvatureSecondDerivative(e){throw"NotImplementedException()"}orientedCounterclockwise(){return k.crossProduct(this.aAxis,this.bAxis)>0}fullBox(){const e=this.aAxis.add(this.bAxis);return lt.mkPP(this.center.add(e),this.center.sub(e))}isArc(){return Math.abs(this.aAxis.dot(this.bAxis))<le.tolerance&&Math.abs(this.aAxis.length-this.bAxis.length)<le.tolerance&&k.closeDistEps(this.aAxis.rotate90Ccw(),this.bAxis)}}class gW{constructor(e,t,n,i,s,o,a,l){this.curveA=e,this.curveB=t,this.aMin=n,this.bMin=s,this.aMax=i,this.bMax=o,this.aGuess=a,this.bGuess=l,this.si=a,this.ti=l}initValues(){this.a=this.curveA.value(this.si),this.b=this.curveB.value(this.ti),this.a_b=this.a.sub(this.b),this.ad=this.curveA.derivative(this.si),this.add=this.curveA.secondDerivative(this.si),this.bd=this.curveB.derivative(this.ti),this.bdd=this.curveB.secondDerivative(this.ti)}Fs(){return this.a_b.dot(this.ad)}Fss(){return this.a_b.dot(this.add)+this.ad.dot(this.ad)}Fst(){return-this.bd.dot(this.ad)}Ftt(){return-this.a_b.dot(this.bdd)+this.bd.dot(this.bd)}Ft(){return-this.a_b.dot(this.bd)}delta(e,t,n,i){return e*i-n*t}solve(){let o,e=0,n=0,s=!1;if(this.initValues(),this.curveA instanceof Me&&this.curveB instanceof Me){let a=this.curveB.derivative(0);a=a.div(a.length);const l=this.curveA.normal(),c=Math.abs(l.dot(a));if(Math.abs(c)<le.distanceEpsilon||this.delta(this.Fss(),this.Fst(),this.Fst(),this.Ftt())<le.tolerance)return this.success=!0,void this.parallelLineSegLineSegMinDist()}do{const a=this.delta(this.Fss(),this.Fst(),this.Fst(),this.Ftt());if(Math.abs(a)<le.tolerance){this.success=!1,s=!0;break}o={s:this.delta(-this.Fs(),this.Fst(),-this.Ft(),this.Ftt())/a,t:this.delta(this.Fss(),-this.Fs(),this.Fst(),-this.Ft())/a};const l=this.si+o.s,c=this.ti+o.t;let d;l>this.aMax+le.distanceEpsilon||l<this.aMin-le.distanceEpsilon||c>this.bMax+le.distanceEpsilon||c<this.bMin-le.distanceEpsilon?(e++,this.chopDsDt(o),this.si+=o.s,this.ti+=o.t,d=!0):(d=!1,this.si=l,this.ti=c,this.si>this.aMax?this.si=this.aMax:this.si<this.aMin&&(this.si=this.aMin),this.ti>this.bMax?this.ti=this.bMax:this.ti<this.bMin&&(this.ti=this.bMin)),this.initValues(),n++,s=e>=10||n>=100||0==o.s&&0==o.t&&d}while((Math.abs(o.s)>=le.tolerance||Math.abs(o.t)>=le.tolerance)&&!s);if(s){const a=this.curveA.value(this.aGuess).sub(this.curveB.value(this.bGuess));if(a.dot(a)<le.distanceEpsilon*le.distanceEpsilon)return this.aSolution=this.aGuess,this.bSolution=this.bGuess,this.aPoint=this.curveA.value(this.aGuess),this.bPoint=this.curveB.value(this.bGuess),void(this.success=!0)}this.aSolution=this.si,this.bSolution=this.ti,this.aPoint=this.a,this.bPoint=this.b,this.success=!s}chopDsDt(e){if(0!=e.s&&0!=e.t){let t=1;this.si+e.s>this.aMax?t=(this.aMax-this.si)/e.s:this.si+e.s<this.aMin&&(t=(this.aMin-this.si)/e.s);let n=1;this.ti+e.t>this.bMax?n=(this.bMax-this.ti)/e.t:this.ti+e.t<this.bMin&&(n=(this.bMin-this.ti)/e.t);const i=Math.min(t,n);e.s*=i,e.t*=i}else 0==e.s?this.ti+e.t>this.bMax?e.t=this.bMax-this.ti:this.ti+e.t<this.bMin&&(e.t=this.bMin-this.ti):this.si+e.s>this.aMax?e.s=this.aMax-this.si:this.si+e.s<this.aMin&&(e.s=this.aMin-this.si)}parallelLineSegLineSegMinDist(){const e=this.curveA,t=this.curveB,n=e.start,i=e.end,s=t.start,o=t.end;let a=i.sub(n);const l=a.length;let d,b,N,c=0;if(l>le.distanceEpsilon){a=a.div(l),d=a.dot(i.sub(n)),b=a.dot(s.sub(n)),N=a.dot(o.sub(n));let F=!1;if(b>N){F=!0;const G=b;b=N,N=G}if(N<c)this.aSolution=0,this.bSolution=F?0:1;else if(b>d)this.aSolution=1,this.bSolution=F?1:0;else{const G=Math.min(d,N);this.aSolution=G/(d-c),this.bSolution=(G-b)/(N-b),F&&(this.bSolution=1-this.bSolution)}}else{let F=o.sub(s);const G=F.length;if(G>le.distanceEpsilon)if(F=F.div(G),c=0,d=F.dot(o.sub(s)),b=F.dot(n.sub(s)),b<c)this.bSolution=0,this.aSolution=1;else if(b>d)this.bSolution=1,this.aSolution=0;else{const W=Math.min(d,b);this.bSolution=W/(d-c),this.aSolution=0}else this.aSolution=0,this.bSolution=0}this.aPoint=this.curveA.value(this.aSolution),this.bPoint=this.curveB.value(this.bSolution)}}class Er{constructor(e,t,n,i){this.b=new Array(4),this.parStart=0,this.parEnd=1,this.b[0]=e,this.b[1]=t,this.b[2]=n,this.b[3]=i,this.c=this.b[1].sub(this.b[0]).mul(3),this.e=this.b[2].sub(this.b[1]).mul(3).sub(this.c),this.l=this.b[3].sub(this.b[0]).sub(this.c).sub(this.e)}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}B(e){return this.b[e]}pNodeOverICurve(){return null!=this.pBoxNode?this.pBoxNode:this.pBoxNode=Cr.createParallelogramNodeForCurveSegDefaultOffset(this)}value(e){const t=e*e;return this.l.mul(t*e).add(this.e.mul(t).add(this.c.mul(e)).add(this.b[0]))}static adjustParamTo01(e){return e>1?1:e<0?0:e}trim(e,t){if((e=Er.adjustParamTo01(e))>(t=Er.adjustParamTo01(t)))return this.trim(t,e);if(e>1-le.tolerance)return new Er(this.b[3],this.b[3],this.b[3],this.b[3]);const n=new Array(3),i=new Array(2),s=this.casteljau(e,n,i),o=new Er(s,i[1],n[2],this.b[3]),a=o.casteljau((t-e)/(1-e),n,i);return new Er(o.b[0],n[0],i[0],a)}trimWithWrap(e,t){throw"NotImplementedException()"}casteljau(e,t,n){const i=1-e;for(let s=0;s<3;s++)t[s]=k.mkPoint(i,this.b[s],e,this.b[s+1]);for(let s=0;s<2;s++)n[s]=k.mkPoint(i,t[s],e,t[s+1]);return k.mkPoint(i,n[0],e,n[1])}derivative(e){return this.l.mul(3*e*e).add(this.e.mul(2*e)).add(this.c)}secondDerivative(e){return k.mkPoint(6*e,this.l,2,this.e)}thirdDerivative(e){return this.l.mul(6)}get start(){return this.b[0]}get end(){return this.b[3]}reverse(){return new Er(this.b[3],this.b[2],this.b[1],this.b[0])}translate(e){this.b[0]=this.b[0].add(e),this.b[1]=this.b[1].add(e),this.b[2]=this.b[2].add(e),this.b[3]=this.b[3].add(e),this.c=this.b[1].sub(this.b[0]).mul(3),this.e=this.b[2].sub(this.b[1]).mul(3).sub(this.c),this.l=this.b[3].sub(this.b[0]).sub(this.c).sub(this.e),this.pBoxNode=null}scaleFromOrigin(e,t){return new Er(this.b[0].scale(e,t),this.b[1].scale(e,t),this.b[2].scale(e,t),this.b[3].scale(e,t))}offsetCurve(e,t){return null}lengthPartial(e,t){return this.trim(e,t).length}get length(){return Er.lengthOnControlPolygon(this.b[0],this.b[1],this.b[2],this.b[3])}static lengthOnControlPolygon(e,t,n,i){const s=i.sub(e).length,o=t.sub(e).length+n.sub(t).length+i.sub(n).length;if(o-s>le.lineSegmentThreshold){const a=k.middle(e,t),l=k.middle(t,n),c=k.middle(n,i),d=k.middle(a,l),b=k.middle(c,l),N=k.middle(d,b);return Er.lengthOnControlPolygon(e,a,d,N)+Er.lengthOnControlPolygon(N,b,c,i)}return(o+s)/2}get boundingBox(){const e=lt.mkPP(this.b[0],this.b[1]);return e.add(this.b[2]),e.add(this.b[3]),e}transform(e){return new Er(e.multiplyPoint(this.b[0]),e.multiplyPoint(this.b[1]),e.multiplyPoint(this.b[2]),e.multiplyPoint(this.b[3]))}closestParameterWithinBounds(e,t,n){const i=(n-t)/8;let s=0,o=Number.MAX_VALUE;for(let a=0;a<9;a++){const l=e.sub(this.value(a*i+t)),c=l.dot(l);c<o&&(o=c,s=a*i+t)}return PS.closestPoint(this,e,s,t,n)}clone(){return new Er(this.b[0],this.b[1],this.b[2],this.b[3])}static mkBezier(e){return new Er(e[0],e[1],e[2],e[3])}curvature(e){const t=this.G(e);return this.F(e)/t}F(e){return this.Xp(e)*this.Ypp(e)-this.Yp(e)*this.Xpp(e)}G(e){const t=this.Xp(e),n=this.Yp(e),i=t*t+n*n;return Math.sqrt(i*i*i)}Xp(e){return 3*this.l.x*e*e+2*this.e.x*e+this.c.x}Ypp(e){return 6*this.l.y*e+2*this.e.y}Yp(e){return 3*this.l.y*e*e+2*this.e.y*e+this.c.y}Xpp(e){return 6*this.l.x*e+2*this.e.x}Xppp(e){return 6*this.l.x}Yppp(e){return 6*this.l.y}curvatureDerivative(e){const t=this.G(e);return(this.Fp(e)*t-this.Gp(e)*this.F(e))/(t*t)}Fp(e){return this.Xp(e)*this.Yppp(e)-this.Yp(e)*this.Xppp(e)}Fpp(e){return this.Xpp(e)*this.Yppp(e)-this.Ypp(e)*this.Xppp(e)}closestParameter(e){let n=0,i=Number.MAX_VALUE;for(let s=0;s<9;s++){const o=e.sub(this.value(.125*s)),a=o.dot(o);a<i&&(i=a,n=.125*s)}return PS.closestPoint(this,e,n,0,1)}curvatureSecondDerivative(e){const t=this.G(e);return(this.Qp(e)*t-2*this.Q(e)*this.Gp(e))/(t*t*t)}Q(e){return this.Fp(e)*this.G(e)-this.Gp(e)*this.F(e)}Qp(e){return this.Fpp(e)*this.G(e)-this.Gpp(e)*this.F(e)}Gpp(e){const t=this.Xp(e),n=this.Yp(e),i=this.Xpp(e),s=this.Ypp(e),o=this.Xppp(e),a=this.Yppp(e),l=Math.sqrt(t*t+n*n),c=t*i+n*s;return 3*(c*c/l+l*(i*i+t*o+s*s+n*a))}Gp(e){const t=this.Xp(e),n=this.Yp(e),i=this.Xpp(e),s=this.Ypp(e);return 3*Math.sqrt(t*t+n*n)*(t*i+n*s)}getParameterAtLength(e){let t=0,n=1;for(;n-t>le.tolerance;){const i=(n+t)/2,s=this.evaluateError(e,i);if(s>0)n=i;else{if(!(s<0))return i;t=i}}return(t+n)/2}evaluateError(e,t){const n=1-t,i=k.mkPoint(n,this.b[0],t,this.b[1]),s=k.mkPoint(n,this.b[1],t,this.b[2]),o=k.mkPoint(n,this.b[2],t,this.b[3]),a=k.mkPoint(n,i,t,s),l=k.mkPoint(n,s,t,o),c=k.mkPoint(n,a,t,l),d=Er.lengthOnControlPolygon(this.b[0],i,a,c);return d>e+le.distanceEpsilon?1:d<e-le.distanceEpsilon?-1:0}}var Ot=(()=>{return(r=Ot||(Ot={}))[r.Outside=0]="Outside",r[r.Boundary=1]="Boundary",r[r.Inside=2]="Inside",Ot;var r})();class fe{constructor(){this.segs=[],this.parEnd_=0}static CurvesIntersect(e,t){return e==t||null!=fe.intersectionOne(e,t,!1)}static lengthWithInterpolationAndThreshold(e,t){throw new Error("not implemented")}static lengthWithInterpolation(e){throw"not implemented"}get parStart(){return 0}get parEnd(){return this.parEnd_}lengthPartial(e,t){this.adjustStartEndEndParametersToDomain({start:e,end:t});const i=this.getSegIndexParam(e),s=this.getSegIndexParam(t);if(i.segIndex<s.segIndex){let o=this.segs[i.segIndex],a=o.lengthPartial(i.par,o.parEnd);for(let l=i.segIndex+1;l<s.segIndex;l++)a+=this.segs[l].length;return o=this.segs[s.segIndex],a+o.lengthPartial(o.parStart,s.par)}throw new Error("not implemented.")}reverse(){const e=new fe;for(let t=this.segs.length-1;t>=0;t--)e.addSegment(this.segs[t].reverse());return e}mkCurveWithSegs(e){this.segs=e;for(const t of e)this.parEnd_+=fe.paramSpan(t)}get start(){return this.segs[0].start}get end(){return this.segs[this.segs.length-1].end}scaleFromOrigin(e,t){const n=new fe;for(const i of this.segs)n.addSegment(i.scaleFromOrigin(e,t));return n}trim(e,t){const n={start:e,end:t};this.adjustStartEndEndParametersToDomain(n);const i=this.getSegIndexParam(n.start),s=this.getSegIndexParam(n.end);if(i.segIndex==s.segIndex)return this.segs[i.segIndex].trim(i.par,s.par);let o=new fe;i.par<this.segs[i.segIndex].parEnd&&(o=o.addSegment(this.segs[i.segIndex].trim(i.par,this.segs[i.segIndex].parEnd)));for(let a=i.segIndex+1;a<s.segIndex;a++)o=o.addSegment(this.segs[a]);return this.segs[s.segIndex].parStart<s.par&&(o=o.addSegment(this.segs[s.segIndex].trim(this.segs[s.segIndex].parStart,s.par))),o}translate(e){for(const t of this.segs)t.translate(e);this.pBNode=null}adjustStartEndEndParametersToDomain(e){if(e.start>e.end){const t=e.start;e.start=e.end,e.end=t}e.start<this.parStart&&(e.start=this.parStart),e.end>this.parEnd&&(e.end=this.parEnd)}trimWithWrap(e,t){if(e<t)return this.trim(e,t);const n=new fe;return n.addSegment(this.trim(e,this.parEnd)),n.addSegment(this.trim(this.parStart,t)),n}addSegs(e){for(const t of e)this.addSegment(t);return this}addSegment(e){if(null==e)return this;if(e instanceof fe)for(const t of e.segs)this.segs.push(t),this.parEnd_+=fe.paramSpan(t);else this.segs.push(e),this.parEnd_+=fe.paramSpan(e);return this}pNodeOverICurve(){if(null!=this.pBNode)return this.pBNode;const e=[],t=[];for(const n of this.segs){const i=n.pNodeOverICurve();e.push(i.parallelogram),t.push(i)}return this.pBNode={parallelogram:gn.getParallelogramOfAGroup(e),seg:this,leafBoxesOffset:le.defaultLeafBoxesOffset,node:{children:t}},this.pBNode}static intersectionOne(e,t,n){let i=fe.curveCurveXWithParallelogramNodesOne(e.pNodeOverICurve(),t.pNodeOverICurve());return n&&null!=i&&(i=fe.liftIntersectionToCurves(e,t,i)),i}static getAllIntersections(e,t,n){return e instanceof Me?fe.getAllIntersectionsOfLineAndICurve(e,t,n):fe.getAllIntersectionsInternal(e,t,n)}static getAllIntersectionsInternal(e,t,n){const i=[];if(fe.curveCurveXWithParallelogramNodes(e.pNodeOverICurve(),t.pNodeOverICurve(),i),n)for(let s=0;s<i.length;s++)i[s]=fe.liftIntersectionToCurves(e,t,i[s]);return i}static getAllIntersectionsOfLineAndICurve(e,t,n){return t instanceof At?fe.getAllIntersectionsOfLineAndPolyline(e,t):t instanceof fe?fe.getAllIntersectionsOfLineAndCurve(e,t,n):t instanceof Tn&&t.isArc()?fe.getAllIntersectionsOfLineAndArc(e,t):fe.getAllIntersectionsInternal(e,t,n)}static getAllIntersectionsOfLineAndCurve(e,t,n){const i=[],s=e.pNodeOverICurve(),o=t.pNodeOverICurve();if(0==gn.intersect(s.parallelogram,o.parallelogram))return i;let a=0;for(const l of t.segs){const c=fe.getAllIntersections(e,l,!1);if(n){for(const d of c)d.par1+=a-l.parStart,d.seg1=t;a+=l.parEnd-l.parStart}for(const d of c)fe.alreadyInside(i,d)||i.push(d)}return i}static closeIntersections(e,t){return k.close(e.x,t.x,le.intersectionEpsilon)}static closeIntersectionPoints(e,t){return k.close(e,t,le.intersectionEpsilon)}static alreadyInside(e,t){for(let n=0;n<e.length;n++)if(fe.closeIntersections(e[n],t))return!0;return!1}static getAllIntersectionsOfLineAndArc(e,t){let n=e.end.sub(e.start);const i=[],s=n.length;if(s<le.distanceEpsilon){const b=e.start.sub(t.center);if(an(b.length,t.aAxis.length)){let N=k.angle(t.aAxis,b);t.parStart-le.tolerance<=N&&(N=Math.max(N,t.parStart),N<=t.parEnd+le.tolerance&&(N=Math.min(t.parEnd,N),i.push(new Eu(0,N,e.start,e,t))))}return i}const o=n.rotate90Ccw().div(s),a=e.start.sub(t.center).dot(o),l=t.center.add(o.mul(a)),c=t.aAxis.length,d=Math.abs(a);if(c<d-le.distanceEpsilon)return i;if(n=o.rotate90Cw(),an(c,d))fe.tryToAddPointToLineCircleCrossing(e,t,i,l,s,n);else{const b=Math.sqrt(c*c-a*a),N=n.mul(b);fe.tryToAddPointToLineCircleCrossing(e,t,i,l.add(N),s,n),fe.tryToAddPointToLineCircleCrossing(e,t,i,l.sub(N),s,n)}return i}static tryToAddPointToLineCircleCrossing(e,t,n,i,s,o){let l=i.sub(e.start).dot(o);if(l<-le.distanceEpsilon||(l=Math.max(l,0),l>s+le.distanceEpsilon))return;l=Math.min(l,s),l/=s;let c=k.angle(t.aAxis,i.sub(t.center));t.parStart-le.tolerance<=c&&(c=Math.max(c,t.parStart),c<=t.parEnd+le.tolerance&&(c=Math.min(t.parEnd,c),n.push(new Eu(l,c,i,e,t))))}static getAllIntersectionsOfLineAndPolyline(e,t){const n=[];let i=0,s=t.startPoint;for(;null!=s&&null!=s.getNext();s=s.getNext()){const o=fe.crossTwoLineSegs(e.start,e.end,s.point,s.getNext().point,0,1,0,1);null!=o&&(fe.adjustSolution(e.start,e.end,s.point,s.getNext().point,o),fe.oldIntersection(n,o.x)||n.push(new Eu(o.aSol,i+o.bSol,o.x,e,t))),i++}if(t.closed){const o=fe.crossTwoLineSegs(e.start,e.end,s.point,t.start,0,1,0,1);null!=o&&(fe.adjustSolution(e.start,e.end,s.point,t.start,o),fe.oldIntersection(n,o.x)||n.push(new Eu(o.aSol,i+o.bSol,o.x,e,t)))}return n}static adjustSolution(e,t,n,i,s){fe.closeIntersectionPoints(s.x,e)?(s.x=e,s.aSol=0):fe.closeIntersectionPoints(s.x,t)&&(s.x=t,s.aSol=1),fe.closeIntersectionPoints(s.x,n)?(s.x=n,s.bSol=Math.floor(s.bSol)):fe.closeIntersectionPoints(s.x,i)&&(s.x=i,s.bSol=Math.ceil(s.bSol))}static curveCurveXWithParallelogramNodesOne(e,t){if(!gn.intersect(e.parallelogram,t.parallelogram))return null;const n=e.node,i=t.node,s=n.hasOwnProperty("children"),o=i.hasOwnProperty("children");if(s&&o)for(const a of n.children)for(const l of i.children){const c=fe.curveCurveXWithParallelogramNodesOne(a,l);if(null!=c)return c}else if(o)for(const a of i.children){const l=fe.curveCurveXWithParallelogramNodesOne(e,a);if(null!=l)return l}else{if(!s)return fe.crossOverIntervalsOne(e,t);for(const a of n.children){const l=fe.curveCurveXWithParallelogramNodesOne(a,t);if(null!=l)return l}}return null}static curveCurveXWithParallelogramNodes(e,t,n){if(!gn.intersect(e.parallelogram,t.parallelogram))return;const i=e.node.hasOwnProperty("children"),s=t.node.hasOwnProperty("children");if(i&&s)for(const o of e.node.children)for(const a of t.node.children)fe.curveCurveXWithParallelogramNodes(o,a,n);else if(s)for(const o of t.node.children)fe.curveCurveXWithParallelogramNodes(e,o,n);else if(i)for(const o of e.node.children)fe.curveCurveXWithParallelogramNodes(o,t,n);else n=fe.crossOverLeaves(e,t,n)}static crossOverIntervalsOne(e,t){const n=e.node,i=t.node,s=(n.high-n.low)/2,o=(i.high-i.low)/2;for(let a=1;a<2;a++){const l=a*s+n.low;for(let c=1;c<2;c++){const d=c*o+i.low;let b;if(null==n.chord&&null==i.chord?b=fe.crossWithinIntervalsWithGuess(e.seg,t.seg,n.low,n.high,i.low,i.high,l,d):null!=n.chord&&null==i.chord?b=fe.crossWithinIntervalsWithGuess(n.chord,t.seg,0,1,i.low,i.high,.5*a,d):null==n.chord?(b=fe.crossWithinIntervalsWithGuess(e.seg,i.chord,n.low,n.high,0,1,l,.5*c),null!=b&&(b.bSol=i.low+b.bSol*(i.high-i.low))):(b=fe.crossWithinIntervalsWithGuess(n.chord,i.chord,0,1,0,1,.5*a,.5*c),null!=b&&(b.aSol=n.low+b.aSol*(n.high-n.low),b.bSol=i.low+b.bSol*(i.high-i.low))),null!=b)return fe.createIntersectionOne(e,t,b.aSol,b.bSol,b.x)}}return fe.goDeeperOne(e,t)}static crossOverLeaves(e,t,n){const i=e.node,s=t.node;let o=!1;const a=(i.high-i.low)/2+i.low,l=(s.high-s.low)/2+s.low;let c;return null==i.chord&&null==s.chord?c=fe.crossWithinIntervalsWithGuess(e.seg,t.seg,i.low,i.high,s.low,s.high,a,l):null!=i.chord&&null==s.chord?(c=fe.crossWithinIntervalsWithGuess(i.chord,t.seg,0,1,s.low,s.high,.5,l),null!=c&&(c.aSol=i.low+c.aSol*(i.high-i.low))):null==i.chord?(c=fe.crossWithinIntervalsWithGuess(e.seg,s.chord,i.low,i.high,0,1,a,.5),null!=c&&(c.bSol=s.low+c.bSol*(s.high-s.low))):(c=fe.crossWithinIntervalsWithGuess(i.chord,s.chord,0,1,0,1,.5,.5),null!=c&&(c.bSol=s.low+c.bSol*(s.high-s.low),c.aSol=i.low+c.aSol*(i.high-i.low))),null!=c&&(fe.addIntersection(e,t,n,c),o=!0),o||fe.goDeeper(n,e,t),n}static addIntersection(e,t,n,i){const s=e.node;fe.closeIntersectionPoints(i.x,e.seg.value(s.low))?(i.x=e.seg.value(s.low),i.aSol=s.low):fe.closeIntersectionPoints(i.x,e.seg.value(s.high))&&(i.x=e.seg.value(s.high),i.aSol=s.high);const o=t.node;if(fe.closeIntersectionPoints(i.x,t.seg.value(o.low))?(i.x=t.seg.value(o.low),i.bSol=o.low):fe.closeIntersectionPoints(i.x,t.seg.value(o.high))&&(i.x=t.seg.value(o.high),i.bSol=o.high),!fe.oldIntersection(n,i.x)){const l=new Eu(i.aSol,i.bSol,i.x,e.seg,t.seg);n.push(l)}}static oldIntersection(e,t){for(const n of e)if(t.sub(n.x).length<100*le.distanceEpsilon)return!0;return!1}static createIntersectionOne(e,t,n,i,s){const o=e.node,a=t.node;return fe.closeIntersectionPoints(s,e.seg.value(o.low))?(s=e.seg.value(o.low),n=o.low):fe.closeIntersectionPoints(s,e.seg.value(o.high))&&(s=e.seg.value(o.high),n=o.high),fe.closeIntersectionPoints(s,t.seg.value(a.low))?(s=t.seg.value(a.low),i=a.low):fe.closeIntersectionPoints(s,t.seg.value(a.high))&&(s=t.seg.value(a.high),i=a.high),new Eu(n,i,s,e.seg,t.seg)}static liftIntersectionToCurves_(e,t,n,i,s,o,a){const l=this.liftParameterToCurve(e,n-o.parStart,o),c=this.liftParameterToCurve(t,i-a.parStart,a);return new Eu(l,c,s,e,t)}static DropIntersectionToSegs(e){let t,n,i,s;if(e.seg0 instanceof fe){const o=e.seg0.getSegParam(e.par0);t=o.seg,n=o.par}else n=e.par0,t=e.seg0;if(e.seg1 instanceof fe){const o=e.seg1.getSegParam(e.par1);s=o.par,i=o.seg}else s=e.par1,i=e.seg1;return new Eu(n,s,e.x,t,i)}static liftIntersectionToCurves(e,t,n){return fe.liftIntersectionToCurves_(e,t,n.par0,n.par1,n.x,n.seg0,n.seg1)}static liftParameterToCurve(e,t,n){if(e==n)return t;if(!e.hasOwnProperty("segs"))return;const i=e;let s=0;for(const o of i.segs){if(o==n)return t+s;s+=fe.paramSpan(o)}throw"bug in liftParameterToCurve"}static paramSpan(e){return e.parEnd-e.parStart}static goDeeperOne(e,t){const n=e.node,i=t.node;if(e.leafBoxesOffset>le.distanceEpsilon&&t.leafBoxesOffset>le.distanceEpsilon){const a=Cr.createParallelogramNodeForCurveSeg(n.low,n.high,e.seg,e.leafBoxesOffset/2),l=Cr.createParallelogramNodeForCurveSeg(i.low,i.high,t.seg,t.leafBoxesOffset/2);return fe.curveCurveXWithParallelogramNodesOne(a,l)}if(e.leafBoxesOffset>le.distanceEpsilon){const a=Cr.createParallelogramNodeForCurveSeg(n.low,n.high,e.seg,e.leafBoxesOffset/2);return fe.curveCurveXWithParallelogramNodesOne(a,t)}if(t.leafBoxesOffset>le.distanceEpsilon){const a=Cr.createParallelogramNodeForCurveSeg(i.low,i.high,t.seg,t.leafBoxesOffset/2);return fe.curveCurveXWithParallelogramNodesOne(e,a)}const s=e.seg.value(n.low),o=e.seg.value(n.high);if(!k.closeDistEps(s,o)){const a=t.seg.value(i.low),l=t.seg.value(i.high);if(!k.closeDistEps(a,l)){const c=e.seg instanceof Me?e.seg:Me.mkPP(s,o),d=t.seg instanceof Me?t.seg:Me.mkPP(a,l),b=fe.crossWithinIntervalsWithGuess(c,d,0,1,0,1,.5,.5);if(null!=b)return fe.adjustParameters(e,c,t,d,b),fe.createIntersectionOne(e,t,b.aSol,b.bSol,b.x)}}return null}static goDeeper(e,t,n){const i=t.node,s=n.node;if(t.leafBoxesOffset>le.distanceEpsilon&&n.leafBoxesOffset>le.distanceEpsilon){const o=Cr.createParallelogramNodeForCurveSeg(i.low,i.high,t.seg,t.leafBoxesOffset/2),a=Cr.createParallelogramNodeForCurveSeg(s.low,s.high,n.seg,n.leafBoxesOffset/2);fe.curveCurveXWithParallelogramNodes(o,a,e)}else if(t.leafBoxesOffset>le.distanceEpsilon){const o=Cr.createParallelogramNodeForCurveSeg(i.low,i.high,t.seg,t.leafBoxesOffset/2);fe.curveCurveXWithParallelogramNodes(o,n,e)}else if(n.leafBoxesOffset>le.distanceEpsilon){const o=Cr.createParallelogramNodeForCurveSeg(s.low,s.high,n.seg,n.leafBoxesOffset/2);fe.curveCurveXWithParallelogramNodes(t,o,e)}else{const o=t.seg.value(i.low),a=t.seg.value(i.high);if(!k.closeDistEps(o,a)){const l=n.seg.value(s.low),c=n.seg.value(s.high);if(!k.closeDistEps(l,c)){const d=t.seg instanceof Me?t.seg:Me.mkPP(o,a),b=n.seg instanceof Me?n.seg:Me.mkPP(l,c),N=fe.crossWithinIntervalsWithGuess(d,b,0,1,0,1,.5,.5);null!=N&&(fe.adjustParameters(t,d,n,b,N),fe.addIntersection(t,n,e,N))}}}}static adjustParameters(e,t,n,i,s){if(t==e.seg||e.seg instanceof At){const o=e.node;s.aSol=o.low+s.aSol*(o.high-o.low)}else s.aSol=e.seg.closestParameter(s.x);if(i==n.seg||n.seg instanceof At){const o=n.node;s.bSol=o.low+s.bSol*(o.high-o.low)}else s.bSol=n.seg.closestParameter(s.x)}getSegParam(e){let t=this.parStart;for(const i of this.segs){const s=t+i.parEnd-i.parStart;if(e>=t&&e<=s)return{par:e-t+i.parStart,seg:i};t=s}const n=this.segs[this.segs.length-1];return{seg:n,par:n.parEnd}}getSegIndexParam(e){let t=0;const n=this.segs.length;for(let s=0;s<n;s++){const o=this.segs[s],a=t+o.parEnd-o.parStart;if(e>=t&&e<=a)return{segIndex:s,par:e-t+o.parStart};t=a}return{segIndex:n-1,par:this.segs[n-1].parEnd}}value(e){return function pW(r){return r.seg.value(r.par)}(this.getSegParam(e))}derivative(e){return function mW(r){return r.seg.derivative(r.par)}(this.getSegParam(e))}secondDerivative(e){return function yW(r){return r.seg.secondDerivative(r.par)}(this.getSegParam(e))}thirdDerivative(e){return function EW(r){return r.seg.thirdDerivative(r.par)}(this.getSegParam(e))}static crossWithinIntervalsWithGuess(e,t,n,i,s,o,a,l){if(e instanceof Me&&t instanceof Me){const b=fe.crossTwoLineSegs(e.start,e.end,t.start,t.end,n,i,s,o);if(null!=b)return b}const c=fe.minDistWithinIntervals(e,t,n,i,s,o,a,l);if(null==c)return;const d=c.aX.sub(c.bX);return d.dot(d)>=le.distanceEpsilon?void 0:{aSol:c.aSol,bSol:c.bSol,x:k.middle(c.aX,c.bX)}}static crossTwoLineSegs(e,t,n,i,s,o,a,l){const c=t.sub(e),d=n.sub(i),b=n.sub(e),N=vy.solve(c.x,d.x,b.x,c.y,d.y,b.y);if(null==N)return;let F=N.x,G=N.y;const W=e.add(c.mul(F));return F<s-le.tolerance||(F=Math.max(F,s),F>o+le.tolerance||(F=Math.min(F,o),G<a-le.tolerance||(G=Math.max(G,a),G>l+le.tolerance)))?void 0:(G=Math.min(G,l),{aSol:F,bSol:G,x:W})}static PointRelativeToCurveLocation(e,t){if(!t.boundingBox.contains(e))return Ot.Outside;const n=2*t.boundingBox.diagonal,i=Math.PI/180;let s=0;for(let o=13;o<360;o+=13){const a=new k(Math.cos(o*i),Math.sin(o*i)),l=Me.mkPP(e,e.add(a.mul(n))),c=this.getAllIntersectionsOfLineAndICurve(l,t,!0);if(fe.AllIntersectionsAreGood(c,t)){for(const b of c)if(k.closeDistEps(b.x,e))return Ot.Boundary;if(c.length%2==1?s++:s--,s>=2)return Ot.Inside;if(s<=-2)return Ot.Outside}}return Ot.Boundary}static AllIntersectionsAreGood(e,t){let i=null;if(t.hasOwnProperty("segs")||t instanceof At&&(i=t.toCurve()),i)for(const s of e)if(!fe.RealCut(fe.DropIntersectionToSegs(s),i,!1))return!1;return!0}static RealCut(e,t,n){const s=e.seg1,a=e.par1,l=e.x,c=e.seg0.derivative(e.par0).normalize(),d=s.derivative(a).normalize().rotate(Math.PI/2);if(k.closeDistEps(l,s.end)){let N=null;for(let W=0;W<t.segs.length-1;W++)if(t.segs[W]==s){N=t.segs[W+1];break}if(null==N)return!1;const F=c.rotate(Math.PI/2);return!(F.dot(s.derivative(s.parEnd))*F.dot(N.derivative(N.parStart))<le.tolerance)}if(k.closeDistEps(l,s.start)){let N=null;for(let W=t.segs.length-1;W>0;W--)if(t.segs[W]==s){N=t.segs[W-1];break}if(null==N)return!1;const F=c.rotate(Math.PI/2);return!(F.dot(s.derivative(s.parStart))*F.dot(N.derivative(N.parEnd))<le.tolerance)}const b=c.dot(d);return n?b>le.distanceEpsilon:Math.abs(b)>le.distanceEpsilon}static realCutWithClosedCurve(e,t,n){const s=e.seg1,a=e.par1,l=e.x,c=e.seg0.derivative(e.par0).normalize(),d=s.derivative(a).normalize().rotate(Math.PI/2);if(k.closeDistEps(l,s.end)){let N=null;for(let W=0;W<t.segs.length;W++)if(t.segs[W]==s){N=t.segs[(W+1)%t.segs.length];break}if(null==N)throw new Error;const F=c.rotate(Math.PI/2);return!(F.dot(s.derivative(s.parEnd))*F.dot(N.derivative(N.parStart))<le.tolerance)}if(k.closeDistEps(l,s.start)){let N=null;for(let W=0;W<t.segs.length;W++)if(t.segs[W]==s){N=t.segs[W>0?W-1:t.segs.length-1];break}const F=c.rotate(Math.PI/2);return!(F.dot(s.derivative(s.parStart))*F.dot(N.derivative(N.parEnd))<le.tolerance)}const b=c.dot(d);return n?b>le.distanceEpsilon:Math.abs(b)>le.distanceEpsilon}static minDistWithinIntervals(e,t,n,i,s,o,a,l){const c=new gW(e,t,n,i,s,o,a,l);return c.solve(),c.success?{aSol:c.aSolution,bSol:c.bSolution,aX:c.aPoint,bX:c.bPoint}:void 0}offsetCurve(e,t){throw new Error("Method not implemented.")}get boundingBox(){if(0==this.segs.length)return lt.mkEmpty();const e=this.segs[0].boundingBox.clone();for(let t=1;t<this.segs.length;t++)e.addRecSelf(this.segs[t].boundingBox);return e}clone(){const e=new fe;for(const t of this.segs)e.addSegment(t.clone());return e}getParameterAtLength(e){let t=0;for(const n of this.segs){const i=n.length;if(i>=e)return t+n.getParameterAtLength(e);e-=i,t+=n.parEnd-n.parStart}return this.parEnd}get length(){let e=0;for(const t of this.segs)e+=t.length;return e}transform(e){const t=new fe;for(const n of this.segs)t.addSegment(n.transform(e));return t}closestParameterWithinBounds(e,t,n){let i=0,s=Number.MAX_VALUE,o=0;for(const a of this.segs){if(o>n)break;const l=fe.paramSpan(a);if(o+l>=t){const d=Math.max(a.parStart,a.parStart+(t-o)),b=Math.min(a.parEnd,a.parStart+(n-o)),N=a.closestParameterWithinBounds(e,d,b),F=e.sub(a.value(N)),G=F.dot(F);G<s&&(i=o+N-a.parStart,s=G)}o+=l}return i}closestParameter(e){let t=0,n=Number.MAX_VALUE,i=0;for(const s of this.segs){const o=s.closestParameter(e),a=e.sub(s.value(o)),l=a.dot(a);l<n&&(t=i+o-s.parStart,n=l),i+=fe.paramSpan(s)}return t}static addLineSegment(e,t,n){return e.addSegment(Me.mkPP(t,n))}static addLineSegmentCNNP(e,t,n,i){return fe.addLineSegment(e,new k(t,n),i)}static addLineSegmentCNNNN(e,t,n,i,s){fe.addLineSegment(e,new k(t,n),new k(i,s))}static continueWithLineSegmentNN(e,t,n){fe.addLineSegment(e,e.end,new k(t,n))}static continueWithLineSegmentP(e,t){fe.addLineSegment(e,e.end,t)}static closeCurve(e){return fe.continueWithLineSegmentP(e,e.start),e}leftDerivative(e){const t=this.tryToGetLeftSegment(e);return null!=t?t.derivative(t.parEnd):this.derivative(e)}rightDerivative(e){const t=this.tryToGetRightSegment(e);return null!=t?t.derivative(t.parStart):this.derivative(e)}tryToGetLeftSegment(e){if(Math.abs(e-this.parStart)<le.tolerance)return this.start.equal(this.end)?this.segs[this.segs.length-1]:null;for(const t of this.segs)if(e-=fe.paramSpan(t),Math.abs(e)<le.tolerance)return t;return null}tryToGetRightSegment(e){if(Math.abs(e-this.parEnd)<le.tolerance)return this.start==this.end?this.segs[0]:null;for(const t of this.segs){if(Math.abs(e)<le.tolerance)return t;e-=fe.paramSpan(t)}return null}static ClosestPoint(e,t){return e.value(e.closestParameter(t))}static CurveIsInsideOther(e,t){if(!t.boundingBox.containsRect(e.boundingBox))return!1;const n=fe.getAllIntersections(e,t,!0);if(0==n.length)return fe.NonIntersectingCurveIsInsideOther(e,t);if(1==n.length)return e.start.equal(n[0].x)?fe.PointRelativeToCurveLocation(e.value((e.parStart+e.parEnd)/2),t)==Ot.Inside:fe.PointRelativeToCurveLocation(e.start,t)==Ot.Inside;for(const i of fe.PointsBetweenIntersections(e,n))if(fe.PointRelativeToCurveLocation(i,t)==Ot.Outside)return!1;return!0}static*PointsBetweenIntersections(e,t){t.sort((a,l)=>a.par0<l.par0?-1:a.par0>l.par0?1:0);for(let a=0;a<t.length-1;a++)yield e.value((t[a].par0+t[a+1].par0)/2);const n=t[t.length-1].par0;let o=n+(e.parEnd-n+(t[0].par0-e.parStart))/2;o>e.parEnd&&(o=e.parStart+(o-e.parEnd)),yield e.value(o)}static NonIntersectingCurveIsInsideOther(e,t){for(let n=e.parStart;n<e.parEnd;n+=.5){const i=fe.PointRelativeToCurveLocation(e.value(n),t);if(Ot.Boundary!=i)return Ot.Inside==i}return Ot.Outside!=fe.PointRelativeToCurveLocation(e.end,t)}static ClosedCurveInteriorsIntersect(e,t){if(!t.boundingBox.intersects(e.boundingBox))return!1;const n=fe.getAllIntersections(e,t,!0);if(0==n.length)return fe.NonIntersectingCurveIsInsideOther(e,t)||fe.NonIntersectingCurveIsInsideOther(t,e);if(1==n.length)return e.start.equal(n[0].x)?fe.PointRelativeToCurveLocation(e.value((e.parStart+e.parEnd)/2),t)!=Ot.Inside&&t.start.equal(n[0].x)?fe.PointRelativeToCurveLocation(t.value((t.parStart+t.parEnd)/2),e)==Ot.Inside:fe.PointRelativeToCurveLocation(t.start,e)==Ot.Inside:fe.PointRelativeToCurveLocation(e.start,t)==Ot.Inside;for(const i of fe.PointsBetweenIntersections(e,n))if(fe.PointRelativeToCurveLocation(i,t)==Ot.Inside)return!0;return!0}curvature(e){const t=this.getSegParam(e);return t.seg.curvature(t.par)}curvatureDerivative(e){throw new Error("Not implemente")}curvatureSecondDerivative(e){throw new Error("Not implemented")}static createBezierSeg(e,t,n,i,s){const o=k.mkPoint(e,n.point,1-e,i.point),a=k.mkPoint(t,s.point,1-t,i.point),l=i.point.mul(2/3);return new Er(o,o.div(3).add(l),l.add(a.div(3)),a)}static createBezierSegN(e,t,n,i){const s=n.mul(i);return new Er(e,e.add(s),t.add(s),t)}static findCorner(e){const t=e.next;if(null==t.next)return;const n=t.next;return null!=n?{b:t,c:n}:void 0}static trimEdgeSplineWithNodeBoundaries(e,t,n,i){let s=n.parStart,o=n.parEnd;null!=e&&(s=fe.findNewStart(n,s,e,i)),null!=t&&(o=fe.findNewEnd(n,t,i,o));const a=Math.min(s,o),l=Math.max(s,o);return a<l?n.trim(a,l):n}static findNewEnd(e,t,n,i){const s=fe.getAllIntersections(e,t,!0);if(0==s.length)return e.parEnd;if(n){i=e.parEnd;for(const o of s)o.par0<i&&(i=o.par0)}else{i=e.parStart;for(const o of s)o.par0>i&&(i=o.par0)}return i}static findNewStart(e,t,n,i){const s=fe.getAllIntersections(e,n,!0);if(0!=s.length){if(i){t=e.parStart;for(const o of s)o.par0>t&&(t=o.par0)}else{t=e.parEnd;for(const o of s)o.par0<t&&(t=o.par0)}return t}t=e.parStart}static polylineAroundClosedCurve(e){if(e instanceof Tn)return fe.refineEllipse(e);if(e instanceof At)return e;if(e instanceof fe&&fe.allSegsAreLines(e)){const t=new At;for(const n of e.segs)t.addPoint(n.start);if(t.closed=!0,!t.isClockwise())return t.reverse()}return e.boundingBox.perimeter()}static allSegsAreLines(e){for(const t of e.segs)if(!(t instanceof Me))return!1;return!0}static refineEllipse(e){const t=e.boundingBox.perimeter(),n=Math.PI/4,i=e.boundingBox.width,s=e.boundingBox.height,o=Math.sqrt(i*i+s*s),a=[];for(let c=0;c<4;c++){const d=n+c*Math.PI/2,b=e.value(d),N=e.derivative(d).normalize().mul(o),F=Me.mkPP(b.sub(N),b.add(N));for(const G of fe.getAllIntersections(t,F,!0))a.push(G)}a.sort((c,d)=>c.par0<d.par0?-1:c.par0>d.par0?1:0);const l=new At;return a.forEach(c=>l.addPoint(c.x)),l.closed=!0,l}static polyFromBox(e){const t=new At;return t.addPoint(e.leftTop),t.addPoint(e.rightTop),t.addPoint(e.rightBottom),t.addPoint(e.leftBottom),t.closed=!0,t}}function eT(r,e,t,n,i,s){let o=[];if(function wW(r,e,t,n,i,s){if(i instanceof Me)return!0;for(const o of[1/3,.5,2/3])if(0==k.closeSquare(i.value(r*o+t*(1-o)),k.mkPoint(o,e,1-o,n),s))return!1;return!0}(r,e,t,n,i,s))o.push(e),o.push(n);else{const a=.5*(r+t),l=i.value(a);o=eT(r,e,a,l,i,s);const c=eT(a,l,t,n,i,s).slice(1);o=o.concat(c)}return o}class At{constructor(){this.initIsRequired=!0,this.isClosed_=!1}RemoveStartPoint(){const e=this.startPoint.next;e.prev=null,this.startPoint=e,this.setInitIsRequired()}RemoveEndPoint(){const e=this.endPoint.prev;e.next=null,this.endPoint=e,this.setInitIsRequired()}setInitIsRequired(){this.initIsRequired=!0}addPointXY(e,t){this.addPoint(new k(e,t))}isClockwise(){return k.getTriangleOrientation(this.startPoint.point,this.startPoint.next.point,this.startPoint.next.next.point)==nt.Clockwise}addPoint(e){const t=new oo;t.polyline=this,t.point=e.clone(),null!=this.endPoint?(this.endPoint.next=t,t.prev=this.endPoint,this.endPoint=t):this.startPoint=this.endPoint=t,this.setInitIsRequired()}PrependPoint(e){const t=oo.mkFromPoint(e);t.polyline=this,null!=this.startPoint?k.closeDistEps(e,this.startPoint.point)||(this.startPoint.prev=t,t.next=this.startPoint,this.startPoint=t):(this.endPoint=t,this.startPoint=t),this.setInitIsRequired()}*[Symbol.iterator](){for(let e=this.startPoint;null!=e;e=e.next)yield e.point}*polylinePoints(){for(let e=this.startPoint;null!=e;e=e.next)yield e}*skip(e){for(let t=this.startPoint;null!=t;t=t.next)e>0?e--:yield t}static parallelogramOfLineSeg(e,t){const n=t.sub(e).div(2);return gn.parallelogramByCornerSideSide(e,n,n)}static mkFromPoints(e){const t=new At;for(const n of e)t.addPoint(n);return t}static mkClosedFromPoints(e){const t=At.mkFromPoints(e);return t.closed=!0,t}calculatePbNode(){const e=[],t=[];let n=this.startPoint,i=0;for(;null!=n.next;){const s=At.parallelogramOfLineSeg(n.point,n.next.point);e.push(s),t.push({parallelogram:s,seg:this,leafBoxesOffset:0,node:{low:i,high:i+1,chord:Me.mkPP(n.point,n.next.point)}}),n=n.next,i++}if(this.isClosed_){const s=At.parallelogramOfLineSeg(this.endPoint.point,this.startPoint.point);e.push(s),t.push({parallelogram:s,seg:this,leafBoxesOffset:0,node:{low:i,high:i+1,chord:Me.mkPP(this.endPoint.point,this.startPoint.point)}})}this.pBNode={parallelogram:gn.getParallelogramOfAGroup(e),seg:this,leafBoxesOffset:0,node:{children:t}}}init(){this.bBox=lt.rectangleOnPoint(this.startPoint.point);for(const e of this.skip(1))this.bBox.add(e.point);this.updateCount(),this.calculatePbNode(),this.initIsRequired=!1}updateCount(){this.count_=0;for(let e=this.startPoint;null!=e;e=e.next)this.count_++}get count(){return this.initIsRequired&&this.init(),this.count_}get closed(){return this.isClosed_}set closed(e){this.isClosed_=e}value(e){this.initIsRequired&&this.init();const t=this.getAdjustedParamAndStartEndPoints(e);return k.convSum(t.t,t.a,t.b)}getAdjustedParamAndStartEndPoints(e){let t=this.startPoint;for(;null!=t.next;){if(e<=1)return{a:t.point,b:t.next.point,t:e};t=t.next,e-=1}if(this.closed&&e<=1)return{a:this.endPoint.point,b:this.startPoint.point,t:e};throw new Error("out of the parameter domain")}derivative(e){const t=this.getAdjustedParamAndStartEndPoints(e);return t.b.sub(t.a)}secondDerivative(e){return new k(0,0)}thirdDerivative(e){return new k(0,0)}pNodeOverICurve(){return this.initIsRequired&&this.init(),this.pBNode}get boundingBox(){return this.initIsRequired&&this.init(),this.bBox}get parStart(){return 0}get parEnd(){return this.initIsRequired&&this.init(),this.closed?this.count_:this.count_-1}static polylineFromCurve(e){const t=new At;t.addPoint(e.start);for(const n of e.segs)t.addPoint(n.end);return t.closed=e.start==e.end,t}trim(e,t){let n=this.toCurve();return n=n.trim(e,t),At.polylineFromCurve(n)}trimWithWrap(e,t){throw new Error("Method not implemented.")}translate(e){let t=this.startPoint;for(;t.point=t.point.add(e),t!=this.endPoint;)t=t.getNext();this.setInitIsRequired()}scaleFromOrigin(e,t){throw new Error("Method not implemented.")}get start(){return this.startPoint.point}get end(){return this.endPoint.point}reverse(){const e=new At;e.closed=this.closed;let t=this.endPoint;for(;e.addPoint(t.point),t!=this.startPoint;)t=t.getPrev();return e}offsetCurve(e,t){throw new Error("Method not implemented.")}lengthPartial(e,t){throw new Error("Method not implemented.")}get length(){throw new Error("Method not implemented.")}getParameterAtLength(e){throw new Error("Method not implemented.")}transform(e){const t=new At;for(const n of this.polylinePoints())t.addPoint(e.multiplyPoint(n.point));return t.closed=this.closed,t}closestParameterWithinBounds(e,t,n){throw new Error("Method not implemented.")}closestParameter(e){let t=0,n=Number.MAX_VALUE,i=0,s=this.startPoint;for(;null!=s.next;){const o=Me.mkPP(s.point,s.next.point),a=o.closestParameter(e),l=o.value(a).sub(e),c=l.dot(l);c<n&&(n=c,t=a+i),s=s.next,i++}if(this.closed){const o=Me.mkPP(this.endPoint.point,this.startPoint.point),a=o.closestParameter(e),l=o.value(a).sub(e);l.dot(l)<n&&(t=a+i)}return t}clone(){const e=new At;e.closed=this.closed;let t=this.startPoint;for(;e.addPoint(t.point),t!=this.endPoint;)t=t.getNext();return e}leftDerivative(e){throw new Error("Method not implemented.")}rightDerivative(e){throw new Error("Method not implemented.")}curvature(e){throw new Error("Method not implemented.")}curvatureDerivative(e){throw new Error("Method not implemented.")}curvatureSecondDerivative(e){throw new Error("Method not implemented.")}next(e){var t;return null!==(t=e.next)&&void 0!==t?t:this.closed?this.startPoint:null}prev(e){var t;return null!==(t=e.prev)&&void 0!==t?t:this.closed?this.endPoint:null}toCurve(){const e=new fe;fe.addLineSegment(e,this.startPoint.point,this.startPoint.next.point);let t=this.startPoint.next;for(;null!=(t=t.next);)fe.continueWithLineSegmentP(e,t.point);return this.closed&&fe.continueWithLineSegmentP(e,this.startPoint.point),e}}class Sy{constructor(e,t){this.width=e,this.height=t}pad(e){this.width+=2*e}}class lt{constructor(e){this.left_=e.left,this.right_=e.right,this.top_=e.top,this.bottom=e.bottom}static mkSizeCenter(e,t){const n=e.width/2,i=e.height/2;return new lt({left:t.x-n,right:t.x+n,bottom:t.y-i,top:t.y+i})}add_rect(e){return this.addRec(e)}contains_point(e){return this.contains(e)}contains_rect(e){return this.containsRect(e)}intersection_rect(e){return this.intersection(e)}intersects_rect(e){return this.intersects(e)}unite(e){return lt.rectangleOfTwo(this,e)}contains_point_radius(e,t){return this.containsWithPadding(e,t)}intersects(e){return this.intersectsOnX(e)&&this.intersectsOnY(e)}intersection(e){if(!this.intersects(e)){const o=lt.mkEmpty();return o.setToEmpty(),o}const t=Math.max(this.left,e.left),n=Math.min(this.right,e.right),i=Math.max(this.bottom,e.bottom),s=Math.min(this.top,e.top);return new lt({left:t,bottom:i,right:n,top:s})}get center(){return this.leftTop.add(this.rightBottom).mul(.5)}set center(e){const t=e.sub(this.center);this.leftTop=this.leftTop.add(t),this.rightBottom=this.rightBottom.add(t)}intersectsOnY(e){return!(e.bottom_>this.top_+le.distanceEpsilon||e.top_<this.bottom_-le.distanceEpsilon)}intersectsOnX(e){return!(e.left>this.right_+le.distanceEpsilon||e.right<this.left_-le.distanceEpsilon)}static mkEmpty(){return new lt({left:0,right:-1,bottom:0,top:-1})}get left(){return this.left_}set left(e){this.left_=e}get right(){return this.right_}set right(e){this.right_=e}get top(){return this.top_}set top(e){this.top_=e}get bottom(){return this.bottom_}set bottom(e){this.bottom_=e}get leftBottom(){return new k(this.left_,this.bottom_)}set leftBottom(e){this.left_=e.x,this.bottom=e.y}get rightTop(){return new k(this.right_,this.top_)}set rightTop(e){this.right_=e.x,this.top_=e.y}get leftTop(){return new k(this.left_,this.top_)}set leftTop(e){this.left_=e.x,this.top_=e.y}get rightBottom(){return new k(this.right_,this.bottom_)}set rightBottom(e){this.right_=e.x,this.bottom=e.y}static mkPP(e,t){const n=new lt({left:e.x,right:e.x,top:e.y,bottom:e.y});return n.add(t),n}static rectangleOnPoint(e){return new lt({left:e.x,right:e.x,top:e.y,bottom:e.y})}static rectangleFromLeftBottomAndSize(e,t,n){return new lt({left:e,right:e+n.x,top:t+n.y,bottom:t})}static getRectangleOnCoords(e,t,n,i){const s=new lt({left:e,bottom:t,right:e,top:t});return s.add(new k(n,i)),s}static mkOnPoints(e){const t=lt.mkEmpty();for(const n of e)t.add(n);return t}static rectangleOnRectangles(e){const t=lt.mkEmpty();for(const n of e)t.addRecSelf(n);return t}get width(){return this.right_-this.left_}set width(e){const t=e/2,n=(this.left_+this.right_)/2;this.left_=n-t,this.right_=n+t}isEmpty(){return this.width<0}setToEmpty(){this.left=0,this.right=-1}get height(){return this.top_-this.bottom_}set height(e){const t=e/2,n=(this.top_+this.bottom_)/2;this.top_=n+t,this.bottom=n-t}static rectangleOfTwo(e,t){const n=new lt({left:e.left_,right:e.right_,top:e.top_,bottom:e.bottom_});return n.addRecSelf(t),n}containsWithPadding(e,t){return this.left_-t-le.distanceEpsilon<=e.x&&e.x<=this.right_+t+le.distanceEpsilon&&this.bottom_-t-le.distanceEpsilon<=e.y&&e.y<=this.top_+t+le.distanceEpsilon}get area(){return(this.right_-this.left_)*(this.top_-this.bottom_)}add(e){this.isEmpty()?(this.left_=this.right_=e.x,this.top_=this.bottom=e.y):(this.left_>e.x&&(this.left_=e.x),this.top_<e.y&&(this.top_=e.y),this.right_<e.x&&(this.right_=e.x),this.bottom_>e.y&&(this.bottom=e.y))}addWithCheck(e){let t,n;return(t=e.x<this.left_)?this.left_=e.x:(t=this.right_<e.x)&&(this.right_=e.x),(n=e.y>this.top_)?this.top_=e.y:(n=this.bottom_>e.y)&&(this.bottom=e.y),t||n}addRecSelf(e){this.add(e.leftTop),this.add(e.rightBottom)}addRec(e){const t=this.clone();return t.add(e.leftTop),t.add(e.rightBottom),t}static translate(e,t){const n=e.clone();return n.center=e.center.add(t),n}contains(e){return this.containsWithPadding(e,0)}containsRect(e){return this.contains(e.leftTop)&&this.contains(e.rightBottom)}get diagonal(){return Math.sqrt(this.width*this.width+this.height*this.height)}padWidth(e){this.left-=e,this.right+=e}padHeight(e){this.top+=e,this.bottom-=e}pad(e){return e<-this.width/2&&(e=-this.width/2),e<-this.height/2&&(e=-this.height/2),this.padWidth(e),this.padHeight(e),this}padEverywhere(e){this.left-=e.left,this.right+=e.right,this.bottom-=e.bottom,this.top+=e.top}static intersect(e,t){return e.intersects(t)?lt.mkPP(new k(Math.max(e.left,t.left),Math.max(e.bottom,t.bottom)),new k(Math.min(e.right,t.right),Math.min(e.top,t.top))):lt.mkEmpty()}perimeter(){const e=new At;return e.addPoint(this.leftTop),e.addPoint(this.rightTop),e.addPoint(this.rightBottom),e.addPoint(this.leftBottom),e.closed=!0,e}scaleAroundCenter(e){this.width=this.width*e,this.height=this.height*e}clone(){return lt.mkPP(this.leftTop,this.rightBottom)}get size(){return new Sy(this.width,this.height)}set size(e){this.width=e.width,this.height=e.height}static creatRectangleWithSize(e,t){const n=e.width/2,o=e.height/2;return new lt({left:t.x-n,right:t.x+n,top:t.y+o,bottom:t.y-o})}addPointWithSize(e,t){const n=e.width/2,i=e.height/2;this.add(new k(t.x-n,t.y-i)),this.add(new k(t.x+n,t.y-i)),this.add(new k(t.x-n,t.y+i)),this.add(new k(t.x+n,t.y+i))}}class di{constructor(e){this.entity=e,this.bind()}bind(){this.entity&&this.entity.setAttr(0,this)}static getGeom(e){return e.getAttr(0)}}class fi{constructor(e,t,n,i,s,o){this.elements=[[e,t,n],[i,s,o]]}get Elements(){return this.elements}getElem(e,t){return this.elements[e][t]}setElem(e,t,n){this.elements[e][t]=n}static Divide(e,t){return e.multiply(t.inverse())}isIdentity(){return an(this.elements[0][0],1)&&an(this.elements[0][1],0)&&an(this.elements[0][2],0)&&an(this.elements[1][0],0)&&an(this.elements[1][1],1)&&an(this.elements[1][2],0)}offset(){return new k(this.getElem(0,2),this.getElem(1,2))}static getIdentity(){return new fi(1,0,0,0,1,0)}static rotation(e){const t=Math.cos(e),n=Math.sin(e);return new fi(t,-n,0,n,t,0)}static scaleAroundCenterTransformation(e,t,n){return new fi(e,0,(1-e)*n.x,0,t,(1-t)*n.y)}multiplyPoint(e){return new k(this.getElem(0,0)*e.x+this.getElem(0,1)*e.y+this.getElem(0,2),this.getElem(1,0)*e.x+this.getElem(1,1)*e.y+this.getElem(1,2))}multiply(e){return null!=e?new fi(this.getElem(0,0)*e.getElem(0,0)+this.getElem(0,1)*e.getElem(1,0),this.getElem(0,0)*e.getElem(0,1)+this.getElem(0,1)*e.getElem(1,1),this.getElem(0,0)*e.getElem(0,2)+this.getElem(0,1)*e.getElem(1,2)+this.getElem(0,2),this.getElem(1,0)*e.getElem(0,0)+this.getElem(1,1)*e.getElem(1,0),this.getElem(1,0)*e.getElem(0,1)+this.getElem(1,1)*e.getElem(1,1),this.getElem(1,0)*e.getElem(0,2)+this.getElem(1,1)*e.getElem(1,2)+this.getElem(1,2)):null}inverse(){const e=this.getElem(0,0)*this.getElem(1,1)-this.getElem(1,0)*this.getElem(0,1),t=this.getElem(1,1)/e,n=-this.getElem(0,1)/e,i=-this.getElem(1,0)/e,s=this.getElem(0,0)/e,o=-t*this.getElem(0,2)-n*this.getElem(1,2),a=-i*this.getElem(0,2)-s*this.getElem(1,2);return new fi(t,n,o,i,s,a)}}var ve=(()=>{return(r=ve||(ve={}))[r.None=0]="None",r[r.North=1]="North",r[r.East=2]="East",r[r.South=4]="South",r[r.West=8]="West",ve;var r})();class xe{static get DifferenceEpsilon(){return xe.differenceEpsilon}static EqualPP(e,t){return xe.Equal(e.x,t.x)&&xe.Equal(e.y,t.y)}static Equal(e,t){return 0==xe.Compare(e,t)}static Compare(e,t){let n=0;return e+xe.DifferenceEpsilon<t?n=-1:t+xe.DifferenceEpsilon<e&&(n=1),n}static ComparePP(e,t){let n=xe.Compare(e.x,t.x);return 0==n&&(n=xe.Compare(e.y,t.y)),n}static LessOrEqual(e,t){const n=xe.Compare(e,t);return n<0||0==n}static Less(e,t){return xe.Compare(e,t)<0}static GetDirections(e,t){return Je.DirectionFromPointToPoint(e,t)}static IsPureDirection(e,t){return Je.IsPureDirection(xe.GetDirections(e,t))}static IsPureDirectionD(e){return Je.IsPureDirection(e)}static IsPureLower(e,t){const n=xe.GetDirections(e,t);return ve.East==n||ve.North==n}static GetPureDirectionVV(e,t){return xe.GetDirections(e.point,t.point)}}xe.differenceEpsilon=le.distanceEpsilon/2;class Je{constructor(e){this.Dir=e}get Right(){return new Je(Je.RotateRight(this.Dir))}static RotateRight(e){switch(e){case ve.North:return ve.East;case ve.East:return ve.South;case ve.South:return ve.West;case ve.West:return ve.North;default:throw new Error}}static RotateLeft(e){switch(e){case ve.North:return ve.West;case ve.West:return ve.South;case ve.South:return ve.East;case ve.East:return ve.North;default:throw new Error}}static ToIndex(e){switch(e){case ve.North:return 0;case ve.East:return 1;case ve.South:return 2;case ve.West:return 3;default:throw new Error}}static VectorDirection(e){let t=ve.None;return e.x>xe.DifferenceEpsilon?t=ve.East:e.x<-xe.DifferenceEpsilon&&(t=ve.West),e.y>xe.DifferenceEpsilon?t|=ve.North:e.y<-xe.DifferenceEpsilon&&(t|=ve.South),t}static VectorDirectionPP(e,t){let n=ve.None;const i=t.x-e.x,s=t.y-e.y;return i>xe.DifferenceEpsilon?n=ve.East:-i>xe.DifferenceEpsilon&&(n=ve.West),s>xe.DifferenceEpsilon?n|=ve.North:-s>xe.DifferenceEpsilon&&(n|=ve.South),n}static DirectionFromPointToPoint(e,t){return Je.VectorDirectionPP(e,t)}static OppositeDir(e){switch(e){case ve.North:return ve.South;case ve.West:return ve.East;case ve.South:return ve.North;case ve.East:return ve.West;default:return ve.None}}static IsPureDirection(e){switch(e){case ve.North:case ve.East:case ve.South:case ve.West:return!0;default:return!1}}static IsPureDirectionPP(e,t){return Je.IsPureDirection(Je.DirectionFromPointToPoint(e,t))}static DirectionsAreParallel(e,t){return e==t||e==Je.OppositeDir(t)}ToPoint(){let e=0,t=0;return(this.Dir&ve.East)==ve.East&&e++,(this.Dir&ve.North)==ve.North&&t++,(this.Dir&ve.West)==ve.West&&e--,(this.Dir&ve.South)==ve.South&&t--,new k(e,t)}static toPoint(e){return new Je(e).ToPoint()}static negate(e){return new Je(Je.OppositeDir(e.Dir))}}let gs=(()=>{class r{static createHexagon(t,n,i){const s=n/2,o=t/2,a=i.x,l=i.y;return At.mkClosedFromPoints([new k(-1*o+a,-1*s+l),new k(o+a,-1*s+l),new k(o+(s+a),0+l),new k(o+a,s+l),new k(-1*o+a,s+l),new k(-1*(o-s)+a,0+l)])}static createOctagon(t,n,i){const s=t/2,o=n/2,a=new Array(8);a[0]=new k(s+r.octagonPad*s,o-o*r.octagonPad),a[3]=new k(-1*a[0].x,a[0].y),a[4]=new k(a[3].x,-1*a[3].y),a[7]=new k(a[0].x,-1*a[0].y),a[1]=new k(s-s*r.octagonPad,o+o*r.octagonPad),a[2]=new k(-1*a[1].x,a[1].y),a[6]=new k(a[1].x,-1*a[1].y),a[5]=new k(a[2].x,-1*a[2].y);for(let l=0;l<8;l++)a[l]=a[l].add(i);return At.mkClosedFromPoints(a)}static createInvertedHouse(t,n,i){const s=r.createHouse(t,n,i);return r.rotateCurveAroundCenterByDegree(s,i,180)}static createHouse(t,n,i){const s=t/2,o=n/2,a=i.x,l=i.y,c=new fe;return fe.addLineSegmentCNNNN(c,a-s,l-o,a+s,l-o),fe.continueWithLineSegmentNN(c,a+s,l+o),fe.continueWithLineSegmentNN(c,a,l+2*o),fe.continueWithLineSegmentNN(c,a-s,l+o),fe.closeCurve(c)}static CreateDiamond(t,n,i){const s=t,o=n,a=i.x,l=i.y,c=new fe,d=[new k(a,l-o),new k(a+s,l),new k(a,l+o),new k(a-s,l)];return c.addSegs([Me.mkPP(d[0],d[1]),Me.mkPP(d[1],d[2]),Me.mkPP(d[2],d[3]),Me.mkPP(d[3],d[0])]),c}static rotateCurveAroundCenterByDegree(t,n,i){return r.rotateCurveAroundCenterByRadian(t,n,i*Math.PI/180)}static rotateCurveAroundCenterByRadian(t,n,i){const s=Math.cos(i),o=Math.sin(i),a=new fi(1,0,n.x,0,1,n.y).multiply(new fi(s,-o,0,o,s,0)).multiply(new fi(1,0,-n.x,0,1,-n.y));return t.transform(a)}static mkCircle(t,n){return Tn.mkCircle(t,n)}static createRectangle(t,n,i){const s=t/2,o=n/2,a=i.x,l=i.y,c=new fe,d=[new k(a-s,l-o),new k(a+s,l-o),new k(a+s,l+o),new k(a-s,l+o)];return c.addSegs([Me.mkPP(d[0],d[1]),Me.mkPP(d[1],d[2]),Me.mkPP(d[2],d[3]),Me.mkPP(d[3],d[0])]),c}static isRoundedRect(t){if(!(t instanceof fe))return;const n=t.segs;if(8!=n.length&&4!=n.length)return;const i=8==n.length;let s,o;for(let a=0;a<4;a++){const l=i?2*a+1:a;if(0==a){if(!(n[l]instanceof Tn))return;const c=n[l];s=c.aAxis.length,o=c.bAxis.length}else{if(!(n[l]instanceof Tn))return;const c=n[l];if(s!=c.aAxis.length||o!=c.bAxis.length)return}}return{radX:s,radY:o}}static mkRectangleWithRoundedCorners(t,n,i,s,o=new k(0,0)){if(0==i||0==s)return r.createRectangle(t,n,o);const a=new fe,l=t/2;i>l/2&&(i=l/2);const c=n/2;s>c/2&&(s=c/2);const d=o.x,b=o.y,N=l-i,F=c-s,G=b+c,W=b-c,ie=d-l,he=d+l,de=new k(i,0),Te=new k(0,s);return N>0&&a.addSegment(Me.mkPP(new k(d-N,W),new k(d+N,W))),a.addSegment(Tn.mkEllipse(1.5*Math.PI,2*Math.PI,de,Te,d+N,b-F)),F>0&&a.addSegment(Me.mkPP(new k(he,b-F),new k(he,b+F))),a.addSegment(Tn.mkEllipse(0,.5*Math.PI,de,Te,d+N,b+F)),N>0&&a.addSegment(Me.mkPP(new k(d+N,G),new k(d-N,G))),a.addSegment(Tn.mkEllipse(.5*Math.PI,Math.PI,de,Te,d-N,b+F)),F>0&&a.addSegment(Me.mkPP(new k(ie,b+F),new k(ie,b-F))),a.addSegment(Tn.mkEllipse(Math.PI,1.5*Math.PI,de,Te,d-N,b-F)),a}}return r.octagonPad=1/4,r})(),tT=(()=>{class r extends di{constructor(){super(...arguments),this.padding=1}get node(){return this.entity}get boundaryCurve(){return this._boundaryCurve}set boundaryCurve(t){(null!=t&&t.boundingBox.height<r.minHeight||t.boundingBox.width<r.minWidth)&&(t=gs.mkCircle(r.minWidth,t.boundingBox.center)),this._boundaryCurve=t}get id(){return this.node.id}toString(){return this.id}static mkNode(t,n){const i=new r(n);return i.boundaryCurve=t,i}get center(){return this.boundaryCurve.boundingBox.center}set center(t){const n=t.sub(this.center);this.boundaryCurve.translate(n)}fitBoundaryCurveToTarget(t){if(null!=this.boundaryCurve){const n=gs.isRoundedRect(this.boundaryCurve);null==n?(this.boundaryCurve=this.boundaryCurve.scaleFromOrigin(t.width/this.boundaryCurve.boundingBox.width,t.height/this.boundaryCurve.boundingBox.height),this.boundaryCurve.translate(t.center.sub(this.boundaryCurve.boundingBox.center))):this.boundaryCurve=gs.mkRectangleWithRoundedCorners(t.width,t.height,n.radX,n.radY,t.center)}}*inEdges(){for(const t of this.node.inEdges)yield di.getGeom(t)}*outEdges(){for(const t of this.node.outEdges)yield di.getGeom(t)}*selfEdges(){for(const t of this.node.selfEdges)yield di.getGeom(t)}get boundingBox(){return this.boundaryCurve?this.boundaryCurve.boundingBox:null}set boundingBox(t){!this.boundaryCurve||(Math.abs(t.width-this.width)<1e-4&&Math.abs(t.height-this.height)<1e-4?this.center=t.center:this.fitBoundaryCurveToTarget(t))}get width(){return this.boundaryCurve.boundingBox.width}get height(){return this.boundaryCurve.boundingBox.height}transform(t,n=!0){null!=this.boundaryCurve&&(this.boundaryCurve=this.boundaryCurve.transform(t))}underCollapsedCluster(){return null!=this.node&&this.node.isUnderCollapsedGraph()}}return r.minHeight=2,r.minWidth=3,r})();class lr{constructor(){this.previouisBezierCoefficient=.5,this.nextBezierCoefficient=.5,this.previousTangentCoefficient=1/3,this.nextTangentCoefficient=1/3}static mkSiteP(e){const t=new lr;return t.point=e,t}static mkSiteSP(e,t){const n=new lr;return n.point=t,n.prev=e,e.next=n,n}static mkSiteSPS(e,t,n){const i=new lr;return i.prev=e,i.point=t,i.next=n,e.next=i,n.prev=i,i}get turn(){return null==this.next||null==this.prev?0:k.getTriangleOrientation(this.prev.point,this.point,this.next.point)}clone(){const e=new lr;return e.previouisBezierCoefficient=this.previouisBezierCoefficient,e.point=this.point,e}}class Jr{constructor(e){this.headSite=e}static mkFromPoints(e){let t=null,n=null;for(const i of e)if(null==n)n=lr.mkSiteP(i),t=new Jr(n);else{const s=lr.mkSiteP(i);s.prev=n,n.next=s,n=s}return t}clone(){let n,e=this.headSite,t=null,i=null;for(;null!=e;)n=e.clone(),n.prev=t,null!=t?t.next=n:i=n,e=e.next,t=n;return new Jr(i)}get lastSite(){let e=this.headSite;for(;null!=e.next;)e=e.next;return e}*getSegments(){let e=this.headSite,t=e.next;for(;null!=t;)yield Me.mkPP(e.point,t.point),e=t,t=t.next}*[Symbol.iterator](){let e=this.headSite;for(;null!=e;)yield e.point,e=e.next}createCurve(){const e=new fe;let t=this.headSite;for(;;){const i=fe.findCorner(t);if(null==i)break;const s=Jr.createBezierSegOnSite(i.b);0==e.segs.length?k.closeDistEps(t.point,s.start)||fe.addLineSegment(e,t.point,s.start):k.closeDistEps(e.end,s.start)||fe.continueWithLineSegmentP(e,s.start),e.addSegment(s),t=i.b}return 0==e.segs.length?k.closeDistEps(t.point,t.next.point)?e.segs.push(new Er(t.point,t.point.add(new k(5,5)),t.point.add(new k(-5,5)),(void 0).point)):fe.addLineSegment(e,t.point,t.next.point):k.closeDistEps(e.end,t.next.point)||fe.continueWithLineSegmentP(e,t.next.point),e}static createBezierSegOnSite(e){const t=e.previouisBezierCoefficient,n=e.nextBezierCoefficient,s=e.next,o=e.prev.point.mul(t).add(e.point.mul(1-t)),a=s.point.mul(n).add(e.point.mul(1-n)),l=o.mul(e.previousTangentCoefficient).add(e.point.mul(1-e.previousTangentCoefficient)),c=a.mul(e.nextTangentCoefficient).add(e.point.mul(1-e.nextTangentCoefficient));return Er.mkBezier([o,l,c,a])}}let wu=(()=>{class r{constructor(){this.length=r.defaultArrowheadLength,this.width=0}clone(){const t=new r;return t.length=this.length,t.width=this.width,t.tipPosition=this.tipPosition,t}static calculateArrowheads(t){if(null==t.sourceArrowhead&&null==t.targetArrowhead)return!0;const n=r.findTrimStartForArrowheadAtSource(t);if(null==n)return!1;const i=r.findTrimEndForArrowheadAtTarget(t);if(null==i||n>i-le.intersectionEpsilon||fe.closeIntersectionPoints(t.curve.value(n),t.curve.value(i)))return!1;const s=t.curve.trim(n,i);return null!=s&&(null!=t.sourceArrowhead&&(t.sourceArrowhead.tipPosition=t.curve.start),null!=t.targetArrowhead&&(t.targetArrowhead.tipPosition=t.curve.end),t.curve=s,!0)}static getIntersectionsWithArrowheadCircle(t,n,i){const s=Tn.mkFullEllipseNNP(n,n,i);return fe.getAllIntersections(s,t,!0)}static findTrimEndForArrowheadAtTarget(t){const n=le.distanceEpsilon*le.distanceEpsilon;let i=t.curve.parEnd;if(null==t.targetArrowhead||t.targetArrowhead.length<=le.distanceEpsilon)return i;const s=t.curve;let a,l,o=t.targetArrowhead.length,c=10;do{if(c--,0==c)return;l=r.getIntersectionsWithArrowheadCircle(s,o,s.end),i=0!=l.length?Math.max(...l.map(d=>d.par1)):s.parEnd,a=t.curve.value(i),o/=2}while(a.sub(s.start).lengthSquared<n||0==l.length);return i}static findTrimStartForArrowheadAtSource(t){if(null==t.sourceArrowhead||t.sourceArrowhead.length<=le.distanceEpsilon)return t.curve.parStart;const n=le.distanceEpsilon*le.distanceEpsilon;let s,i=t.sourceArrowhead.length;const o=t.curve;let a,c,l=10;for(;--l>0;){if(a=r.getIntersectionsWithArrowheadCircle(o,i,o.start),0==a.length)return o.parStart;if(c=Math.min(...a.map(d=>d.par1)),s=a.filter(d=>d.par1==c)[0].x,s.sub(o.end).lengthSquared>=n)return c;i/=2}}static trimSplineAndCalculateArrowheads(t,n,i){return r.trimSplineAndCalculateArrowheadsII(t,t.source.boundaryCurve,t.target.boundaryCurve,n,i)}static trimSplineAndCalculateArrowheadsII(t,n,i,s,o){if(t.curve=fe.trimEdgeSplineWithNodeBoundaries(n,i,s,o),null==t.curve)return!1;if((null==t.sourceArrowhead||t.sourceArrowhead.length<le.distanceEpsilon)&&(null==t.targetArrowhead||t.targetArrowhead.length<le.distanceEpsilon))return!0;let a=!1;const l=null!=t.sourceArrowhead?t.sourceArrowhead.length:0,c=null!=t.targetArrowhead?t.targetArrowhead.length:0,d=t.curve.end.sub(t.curve.start).length;null!=t.sourceArrowhead&&(t.sourceArrowhead.length=Math.min(d,l)),null!=t.targetArrowhead&&(t.targetArrowhead.length=Math.min(d,c));let b=10;for(;(null!=t.sourceArrowhead&&t.sourceArrowhead.length>le.intersectionEpsilon||null!=t.targetArrowhead&&t.targetArrowhead.length>le.intersectionEpsilon)&&!a&&(a=r.calculateArrowheads(t),a||(null!=t.sourceArrowhead&&(t.sourceArrowhead.length*=.5),null!=t.targetArrowhead&&(t.targetArrowhead.length*=.5)),b--,0!=b););return a||(null!=t.sourceArrowhead&&(t.sourceArrowhead.tipPosition=s.start),null!=t.targetArrowhead&&(t.targetArrowhead.tipPosition=s.end)),null!=t.sourceArrowhead&&(t.sourceArrowhead.length=l),null!=t.targetArrowhead&&(t.targetArrowhead.length=c),a}static createBigEnoughSpline(t){const n=t.source.center;let i=t.target.center;const s=i.sub(n);let a;s.length<.001?(a=new k(1,0),i=n.add(a.rotate(Math.PI/2))):a=s.rotate(Math.PI/2);let l=1;null!=t.sourceArrowhead&&(l+=t.sourceArrowhead.length),null!=t.targetArrowhead&&(l+=t.targetArrowhead.length),a=a.normalize().mul(1.5*l);for(let c=1;c<1e4;c*=2){const d=fe.createBezierSegN(n,i,a,c);if(r.trimSplineAndCalculateArrowheadsII(t,t.source.boundaryCurve,t.target.boundaryCurve,d,!1))return}r.createEdgeCurveWithNoTrimming(t,n,i)}static createEdgeCurveWithNoTrimming(t,n,i){const s=i.sub(n).normalize();let o=n,a=i;const l=t.targetArrowhead;null!=l&&(l.tipPosition=i,a=i.sub(s.mul(l.length)));const c=t.sourceArrowhead;null!=c&&(c.tipPosition=n,o=n.add(s.mul(c.length))),t.curve=Me.mkPP(o,a)}}return r.defaultArrowheadLength=5,r})();class vu extends di{constructor(e){super(e),this.targetArrowhead=new wu,this.lineWidth=1}get sourcePort(){return this._sourcePort}set sourcePort(e){this._sourcePort=e}get targetPort(){return this._targetPort}set targetPort(e){this._targetPort=e}Translate(e){if(0!=e.x||0!=e.y){if(null!=this.curve&&this.curve.translate(e),null!=this.smoothedPolyline)for(let t=this.smoothedPolyline.headSite,n=this.smoothedPolyline.headSite;null!=t;t=t.next,n=n.next)t.point=n.point.add(e);null!=this.sourceArrowhead&&(this.sourceArrowhead.tipPosition=this.sourceArrowhead.tipPosition.add(e)),null!=this.targetArrowhead&&(this.targetArrowhead.tipPosition=this.targetArrowhead.tipPosition.add(e))}}GetMaxArrowheadLength(){let e=0;return null!=this.sourceArrowhead&&(e=this.sourceArrowhead.length),null!=this.targetArrowhead&&this.targetArrowhead.length>e?this.targetArrowhead.length:e}transform(e){if(null!=this.curve){if(this.curve=this.curve.transform(e),null!=this.underlyingPolyline)for(let t=this.underlyingPolyline.headSite,n=this.underlyingPolyline.headSite;null!=t;t=t.next,n=n.next)t.point=e.multiplyPoint(t.point);null!=this.sourceArrowhead&&(this.sourceArrowhead.tipPosition=e.multiplyPoint(this.sourceArrowhead.tipPosition)),null!=this.targetArrowhead&&(this.targetArrowhead.tipPosition=e.multiplyPoint(this.targetArrowhead.tipPosition)),null!=this.label&&(this.label.center=e.multiplyPoint(this.label.center))}}get labelBBox(){return this.label.boundingBox}get edge(){return this.entity}get source(){return di.getGeom(this.edge.source)}get boundingBox(){const e=lt.mkEmpty();if(null!=this.underlyingPolyline)for(const n of this.underlyingPolyline)e.add(n);null!=this.curve&&e.addRecSelf(this.curve.boundingBox),null!=this.sourceArrowhead&&e.add(this.sourceArrowhead.tipPosition),null!=this.targetArrowhead&&e.add(this.targetArrowhead.tipPosition),this.edge.label&&e.addRecSelf(this.label.boundingBox);const t=this.lineWidth;return e.left-=t,e.top+=t,e.right+=t,e.bottom-=t,e}isInterGraphEdge(){return this.edge.isInterGraphEdge()}get target(){return di.getGeom(this.edge.target)}toString(){return this.source.toString()+"->"+this.target}static RouteSelfEdge(e,t,n){const i=e.boundingBox.width,s=e.boundingBox.height,o=e.boundingBox.center,a=new k(o.x-i/4,o.y),l=new k(o.x-i/4,o.y-s/2-t),c=new k(o.x+i/4,o.y-s/2-t),d=new k(o.x+i/4,o.y);return n.smoothedPolyline=Jr.mkFromPoints([a,l,c,d]),n.smoothedPolyline.createCurve()}underCollapsedCluster(){return this.source.underCollapsedCluster()||this.target.underCollapsedCluster()}EdgeToAncestor(){return this.edge.EdgeToAncestor()}}class Rr{constructor(e){this.cancelToken=e}ProgressStep(){}}class Ay{}Ay.GoldenRatio=(1+Math.sqrt(5))/2,Ay.GoldenRatioRemainder=2-Ay.GoldenRatio;let SW=(()=>{class r extends Rr{constructor(t,n){super(null),this.desiredAspectRatio=1.2,this.bestPacking=null,this.cachedCosts=new Map,this.rectangles=t,this.desiredAspectRatio=n}get PackedWidth(){return null!=this.bestPacking?this.bestPacking.PackedWidth:0}get PackedHeight(){return null!=this.bestPacking?this.bestPacking.PackedHeight:0}Pack(t,n,i){const s=r.GetGoldenSectionStep(t,n),o=Math.max(i/10,(n-t)/r.MaxSteps);n+=o,this.bestPackingCost=Number.MAX_VALUE,1==this.rectangles.length?this.PackLimit(t):2==this.rectangles.length?(this.PackLimit(t),this.PackLimit(n)):this.rectangles.length>2&&r.GoldenSectionSearch(l=>this.PackLimit(l),t,s,n,o);const a=this.bestPacking.getRects();for(let l=0;l<this.rectangles.length;l++)this.rectangles[l]=a[l]}PackLimit(t){let n=this.cachedCosts.get(t);if(null==n){const i=this.createPacking(this.rectangles,t);i.run(),this.cachedCosts.set(t,n=Math.abs(i.PackedAspectRatio-this.desiredAspectRatio)),n<this.bestPackingCost&&(this.bestPackingCost=n,this.bestPacking=i)}return n}static GoldenSectionSearch(t,n,i,s,o){if(Math.abs(n-s)<o)return t(n)<t(s)?n:s;const a=r.GetGoldenSectionStep(i,s),l=t(i),c=t(a),d=()=>r.GoldenSectionSearch(t,a,i,n,o),b=()=>r.GoldenSectionSearch(t,i,a,s,o);if(c<l)return b();if(c>l)return d();const N=b(),F=d();return t(F)<t(N)?F:N}static GetGoldenSectionStep(t,n){return t<n?t+Ay.GoldenRatioRemainder*(n-t):t-Ay.GoldenRatioRemainder*(t-n)}}return r.MaxSteps=1e3,r})();var cr=p(5341);class AW extends Rr{get PackedWidth(){return this.packedWidth}set PackedWidth(e){this.packedWidth=e}get PackedHeight(){return this.packedHeight}set PackedHeight(e){this.packedHeight=e}get PackedAspectRatio(){return this.PackedWidth/this.PackedHeight}getRects(){const e=[];for(const[t,n]of this.rectsToCenters)t.center=n,e.push(t);return e}}class NS extends AW{constructor(e,t,n=!1){super(null),this.rectsToCenters=new Map,this.rectanglesByDescendingHeight=n?e:NS.SortRectangles(e),this.wrapWidth=t}static SortRectangles(e){return e.sort((t,n)=>n.height-t.height),e}run(){this.Pack()}Pack(){this.PackedWidth=0,this.PackedHeight=0;const e=new cr.K;let t=!1,n=0,i=0,s=0;const o=this.rectanglesByDescendingHeight;for(let a=0;t||a<o.length;){const l=o[a],c=e.length>0?e.top:null;if(null==c||c.right+l.width<=this.wrapWidth&&n+l.height<=c.top){const b=new k(c?c.right:0,n).add(new k(l.width/2,l.height/2));l.center=b,this.rectsToCenters.set(l,b),i=Math.max(i,l.right),s=Math.max(s,l.top),e.push(l),t=!1}else n=c.top,e.pop(),t=!0;t||a++}this.PackedWidth=i,this.PackedHeight=s}}class Bx extends SW{constructor(e,t){super(NS.SortRectangles(e),t),this.createPacking=(n,i)=>new NS(n,i,!0)}run(){let e=Number.MAX_VALUE,t=0,n=0;for(const i of this.rectangles){const s=i.width;n+=s,e=Math.min(e,s),t=Math.max(t,s)}this.Pack(t,n,e)}}var Kn=(()=>{return(r=Kn||(Kn={}))[r.Continue=0]="Continue",r[r.Stop=1]="Stop",Kn;var r})();function Tr(r){if(0==r.length)return null;if(1==r.length)return r[0];const e={b0:r[0].irect,seed0:1},t=function CW(r,e){let n,t=kx(e.b0,r[e.seed0].irect);for(let i=2;i<r.length;i++){const s=kx(e.b0,r[i].irect);s>t&&(e.seed0=i,t=s)}for(let i=0;i<r.length;i++)if(i!=e.seed0){n=i;break}t=r[e.seed0].irect.add_rect(r[n].irect).area;for(let i=0;i<r.length;i++){if(i==e.seed0)continue;const s=r[e.seed0].irect.add_rect(r[i].irect).area;s>t&&(n=i,t=s)}return n}(r,e),n=[],i=[];n.push(r[e.seed0]),i.push(r[t]);const s={box0:r[e.seed0].irect,box1:r[t].irect};!function bW(r,e,t,n,i,s){for(let a=0;a<r.length;a++){if(a==e||a==t)continue;const l=s.box0.add_rect(r[a].irect),c=l.area-s.box0.area,d=s.box1.add_rect(r[a].irect),b=d.area-s.box1.area;2*n.length<i.length?(n.push(r[a]),s.box0=l):2*i.length<n.length?(i.push(r[a]),s.box1=d):c<b?(n.push(r[a]),s.box0=l):b<c?(i.push(r[a]),s.box1=d):s.box0.area<s.box1.area?(n.push(r[a]),s.box0=l):(i.push(r[a]),s.box1=d)}}(r,e.seed0,t,n,i,s);const o=Gx(r.length);return o.irect=s.box0.add_rect(s.box1),o.Left=Tr(n),o.Right=Tr(i),o}function kx(r,e){return r.add_rect(e).area}function nT(r,e){return null==r||null==e?null:Tr(Array.from(r).map(n=>gi(n,e(n))))}function Gx(r){const e=new iT;return e.Count=r,e}function gi(r,e){const t=new iT;return t.UserData=r,t.irect=e,t.Count=1,t}function rT(r,e,t){return r.irect.intersects_rect(t)?e(r.UserData)==Kn.Continue?null!=r.Left?rT(r.Left,e,t)==Kn.Continue&&rT(r.Right,e,t)==Kn.Continue?Kn.Continue:Kn.Stop:Kn.Continue:Kn.Stop:Kn.Continue}class iT{toString(){return this.IsLeaf?this.Count.toString()+" "+this.UserData:this.Count.toString()}get IsLeaf(){return null==this.left}get Left(){return this.left}set Left(e){null!=this.left&&this.left.Parent==this&&(this.left.Parent=null),this.left=e,null!=this.left&&(this.left.Parent=this)}get Right(){return this.right}set Right(e){null!=this.right&&this.right.Parent==this&&(this.right.Parent=null),this.right=e,null!=this.right&&(this.right.Parent=this)}get IsLeftChild(){return this==this.Parent.Left}FirstHitNodePF(e,t){var n;return this.irect.contains_point(e)?this.IsLeaf?null!=t?t(e,this.UserData)==Kn.Stop?this:null:this:null!==(n=this.Left.FirstHitNodePF(e,t))&&void 0!==n?n:this.Right.FirstHitNodePF(e,t):null}FirstIntersectedNode(e){var t;return e.intersects_rect(this.irect)?this.IsLeaf?this:null!==(t=this.Left.FirstIntersectedNode(e))&&void 0!==t?t:this.Right.FirstIntersectedNode(e):null}FirstHitNodeWithPredicate(e,t){var n;return this.irect.contains_point(e)?this.IsLeaf?t(e,this.UserData)==Kn.Stop?this:null:null!==(n=this.Left.FirstHitNodeWithPredicate(e,t))&&void 0!==n?n:this.Right.FirstHitNodeWithPredicate(e,t):null}FirstHitNode(e){var t;return this.irect.contains_point(e)?this.IsLeaf?this:null!==(t=this.Left.FirstHitNode(e))&&void 0!==t?t:this.Right.FirstHitNode(e):null}*AllHitItems(e,t){const n=new cr.K;for(n.push(this);n.size>0;){const i=n.pop();i.irect.intersects_rect(e)&&(i.IsLeaf?(null==t||t(i.UserData))&&(yield i.UserData):(n.push(i.left),n.push(i.right)))}}*AllHitItems_(e){const t=new cr.K;for(t.push(this);t.size>0;){const n=t.pop();n.irect.contains_point(e)&&(n.IsLeaf?yield n.UserData:(t.push(n.left),t.push(n.right)))}}VisitTree(e,t){rT(this,e,t)}Clone(){const e=Gx(this.Count);return e.UserData=this.UserData,e.irect=this.irect,null!=this.Left&&(e.Left=this.Left.Clone()),null!=this.Right&&(e.Right=this.Right.Clone()),e}*GetNodeItemsIntersectingRectangle(e){for(const t of this.GetLeafRectangleNodesIntersectingRectangle(e))yield t.UserData}*GetLeafRectangleNodesIntersectingRectangle(e){const t=new cr.K;for(t.push(this);t.size>0;){const n=t.pop();n.irect.intersects_rect(e)&&(n.IsLeaf?yield n:(t.push(n.left),t.push(n.right)))}}*GetAllLeaves(){for(const e of this.GetAllLeafNodes())yield e.UserData}*GetAllLeafNodes(){for(const e of this.EnumRectangleNodes(!0))yield e}*EnumRectangleNodes(e){const t=new cr.K;for(t.push(this);t.size>0;){const n=t.pop();(n.IsLeaf||!e)&&(yield n),n.IsLeaf||(t.push(n.left),t.push(n.right))}}TraverseHierarchy(e,t){t(e),null!=e.Left&&this.TraverseHierarchy(e.Left,t),null!=e.Right&&this.TraverseHierarchy(e.Right,t)}}function sT(r){return new _S(Tr(r.map(([e,t])=>gi(t,e))))}function Vx(r){for(let e=r.Parent;null!=e;e=e.Parent)e.Count--,e.irect=e.Left.irect.add_rect(e.Right.irect)}function Hx(r){return 2*r.Left.Count>=r.Right.Count&&2*r.Right.Count>=r.Left.Count}function oT(r,e,t,n){return!r.irect.intersects_rect(e)||(r.IsLeaf?!n(r.UserData)||0!=--t.bound:oT(r.Left,e,t,n)&&oT(r.Right,e,t,n))}class _S{constructor(e){this._rootNode=e}Clear(){this.RootNode=null}NumberOfIntersectedIsLessThanBound(e,t,n){return oT(this._rootNode,e,{bound:t},n)}get RootNode(){return this._rootNode}set RootNode(e){this._rootNode=e}*GetAllLeaves(){if(null!=this._rootNode&&this.Count>0)for(const e of this._rootNode.GetAllLeaves())yield e}get Count(){return null==this._rootNode?0:this._rootNode.Count}Add(e,t){this.AddNode(gi(t,e))}AddNode(e){null==this._rootNode?this._rootNode=e:this.Count<=2?this._rootNode=Tr(Array.from(this._rootNode.GetAllLeafNodes()).concat([e])):this.AddNodeToTreeRecursive(e,this._rootNode)}Rebuild(){this._rootNode=Tr(Array.from(this._rootNode.GetAllLeafNodes()))}AddNodeToTreeRecursive(e,t){if(t.IsLeaf)t.Left=gi(t.UserData,t.irect),t.Right=e,t.Count=2;else{let n,i;if(t.Count++,2*t.Left.Count<t.Right.Count)this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=t.Left.irect.add_rect(e.irect);else if(2*t.Right.Count<t.Left.Count)this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=t.Right.irect.add_rect(e.irect);else{n=t.Left.irect.add_rect(e.irect);const s=n.area-t.Left.irect.area;i=t.Right.irect.add_rect(e.irect);const o=i.area-t.Right.irect.area;s<o?(this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=n):s>o?(this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=i):n.area<i.area?(this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=n):(this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=i)}}t.irect=t.Left.irect.add_rect(t.Right.irect)}GetAllIntersecting(e){return null==this._rootNode||0==this.Count?[]:Array.from(this._rootNode.GetNodeItemsIntersectingRectangle(e))}OneIntersecting(e){if(null==this._rootNode||0==this.Count)return;const t=this._rootNode.FirstIntersectedNode(e);return null!=t?{intersectedLeaf:t.UserData}:void 0}GetAllLeavesIntersectingRectangle(e){return null==this._rootNode||0==this.Count?[]:this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e)}IsIntersecting(e){if(null==this._rootNode||0==this.Count)return!1;for(const t of this._rootNode.GetNodeItemsIntersectingRectangle(e))return!0;return!1}Contains(e,t){if(null==this._rootNode)return!1;for(const n of this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e))if(n.UserData==t)return!0;return!1}Remove(e,t){if(null==this._rootNode)return;let n;for(const i of this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e))i.UserData==t&&(n=i);return null!=n?(1==this.RootNode.Count?this.RootNode=null:this.RemoveLeaf(n),n.UserData):void 0}RemoveLeaf(e){const t=function OW(r){for(let e=r.Parent;null!=e;e=e.Parent)if(!Hx(e))return e;return null}(e);if(null!=t)(function TW(r,e){const t=new Array;for(const i of r.GetAllLeafNodes())i!=e&&t.push(i);const n=Tr(t);r.Count=n.Count,r.Left=n.Left,r.Right=n.Right,r.irect=n.Left.irect.add_rect(n.Right.irect)})(t,e),Vx(t);else{const n=e.Parent;null==n?this._rootNode=new iT:(function RW(r,e){r.UserData=e.UserData,r.Left=e.Left,r.Right=e.Right,r.Count--,r.irect=e.irect}(n,e.IsLeftChild?n.Right:n.Left),Vx(n))}}UnbalancedNode(e){for(let t=e.Parent;null!=t;t=t.Parent)if(!Hx(t))return t;return null}}function Yx(r,e){const t=new Array;for(const s of e)t.push({g:s,lb:s.boundingBox.leftBottom.clone()});const n=e.map(s=>s.boundingBox),i=new Bx(n,1.5);i.run();for(const{g:s,lb:o}of t){const a=s.boundingBox.leftBottom.sub(o);s.translate(a)}r.boundingBox=new lt({left:0,bottom:0,right:i.PackedWidth,top:i.PackedHeight}),r.addLabelToGraphBB(r.boundingBox)}class xa extends tT{constructor(e){super(e),this.MinimalWidth=0,this.MinimalHeight=0,this.Margins=10}static getGeom(e){return e.getAttr(0)}*intersectedObjects(e,t=!0){null==this._rtree&&(this._rtree=this.buildRTree());const n=this._rtree.GetAllIntersecting(e),i=e.perimeter();for(const s of n)if(s instanceof tT&&(yield s),!t&&s instanceof vu){const o=s.curve;(null!=fe.intersectionOne(o,i,!1)||fe.PointRelativeToCurveLocation(o.start,i)==Ot.Inside)&&(yield s)}}buildRTree(){return sT(Array.from(this.deepNodes()).concat(Array.from(this.deepEdges())).map(t=>[t.boundingBox,t]))}isEmpty(){return this.graph.isEmpty()}setSettingsRecursively(e){this.layoutSettings=e;for(const t of this.deepNodes())t.layoutSettings=e}get layoutSettings(){return this._layoutSettings}set layoutSettings(e){this._layoutSettings=e}translate(e){if(0==e.x&&0==e.y)return;const t=new fi(1,0,e.x,0,1,e.y);this.transform(t)}get labelSize(){return this._labelSize}set labelSize(e){this._labelSize=e}get boundingBox(){return this._boundingBox}set boundingBox(e){this._boundingBox=e}transform(e,t=!0){if(!e.isIdentity()){null!=this.boundaryCurve&&(this.boundaryCurve=this.boundaryCurve.transform(e));for(const n of this.shallowNodes())n.transform(e,t);for(const n of this.edges())n.transform(e);t&&this.updateBoundingBox()}}*deepNodes(){for(const e of this.graph.deepNodes)yield di.getGeom(e)}setEdge(e,t){const n=this.graph.setEdge(e,t);return new vu(n)}pumpTheBoxToTheGraphWithMargins(e){const t={b:lt.mkEmpty()};return this.pumpTheBoxToTheGraph(t),t.b.pad(Math.max(this.Margins,e)),this.MinimalWidth>0&&(t.b.width=Math.max(t.b.width,this.MinimalWidth)),this.MinimalHeight>0&&(t.b.height=Math.max(t.b.height,this.MinimalHeight)),this._boundingBox=t.b,t.b}get center(){return this.boundingBox?this.boundingBox.center:new k(0,0)}set center(e){const t=e.sub(this.center),n=new fi(1,0,t.x,0,1,t.y);this.transform(n)}pumpTheBoxToTheGraph(e){for(const t of this.edges())if(!t.underCollapsedCluster()){if(null!=t.curve){const n=t.curve.boundingBox;n.pad(t.lineWidth),e.b.addRecSelf(n)}null!=t.label&&e.b.addRecSelf(t.label.boundingBox)}for(const t of this.shallowNodes())t.underCollapsedCluster()||!t.boundingBox||e.b.addRecSelf(t.boundingBox)}get left(){return this.boundingBox.left}get right(){return this.boundingBox.right}get top(){return this.boundingBox.top}get bottom(){return this.boundingBox.bottom}CheckClusterConsistency(){throw new Error("Method not implemented.")}get edgeCount(){return this.graph.edgeCount}*shallowNodes(){for(const e of this.graph.shallowNodes)yield di.getGeom(e)}*edges(){for(const e of this.graph.edges)yield di.getGeom(e)}*deepEdges(){for(const e of this.graph.deepEdges())yield di.getGeom(e)}static mk(e,t=new Sy(0,0)){const n=new xa(new so(e));return n.labelSize=t,n}*subgraphs(){for(const e of this.graph.subgraphs())yield di.getGeom(e)}static mkWithGraphAndLabel(e,t){const n=new xa(e);return n.labelSize=t,n}get height(){return this.boundingBox.height}get width(){return this.boundingBox.width}get shallowNodeCount(){return this.graph.shallowNodeCount}get graph(){return this.entity}liftNode(e){const t=this.graph.liftNode(e.node);return t?di.getGeom(t):null}findNode(e){const t=this.graph.findNode(e);return t?di.getGeom(t):null}addNode(e){return this.graph.addNode(e.node),e}updateBoundingBox(){if(this.graph.isEmpty())return;const e=lt.mkEmpty();let t=0;for(const n of this.graph.edges){const i=di.getGeom(n);null!=i.curve&&(e.addRecSelf(i.boundingBox),t=Math.max(t,i.lineWidth))}for(const n of this.shallowNodes())n.boundingBox&&(e.addRecSelf(n.boundingBox),t=Math.max(t,n.padding));this.addLabelToGraphBB(e),e.pad(Math.max(t,this.Margins)),this.boundingBox=e}addLabelToGraphBB(e){this.labelSize&&(e.top+=this.labelSize.height+2,e.width<this.labelSize.width&&(e.width=this.labelSize.width))}FlipYAndMoveLeftTopToOrigin(){const e=new fi(1,0,-this.left,0,-1,this.top);this.transform(e,!1);for(const n of this.deepNodes())if(n instanceof xa&&!n.graph.isEmpty()){const s=n.boundingBox;n.boundingBox=lt.mkSizeCenter(new Sy(s.width,s.height),e.multiplyPoint(s.center))}const t=this.boundingBox;this.boundingBox=lt.mkSizeCenter(new Sy(t.width,t.height),e.multiplyPoint(t.center))}}function DS(r){const e=new ps;return e.SetEdges(r,ps.vertexCount(r)),e}function Ux(r){const e=new ps;return e.SetEdges(r,ps.vertexCount(r)),e}function dc(r,e){const t=new ps;return t.SetEdges(r,e),t}class ps{constructor(){this.nodeCount=0}*incidentEdges(e){for(const t of this.outEdges[e])yield t;for(const t of this.inEdges[e])yield t}static deleteFromArray(e,t){const n=e.indexOf(t,0);n>-1&&e.splice(n,1)}removeEdge(e){ps.deleteFromArray(this.edges,e),e.source!=e.target?(ps.deleteFromArray(this.outEdges[e.source],e),ps.deleteFromArray(this.inEdges[e.target],e)):ps.deleteFromArray(this.selfEdges[e.source],e)}static vertexCount(e){let t=0;for(const n of e)n.source>=t&&(t=n.source),n.target>=t&&(t=n.target);return++t}SetEdges(e,t){this.edges=e,this.nodeCount=t;const n=new Array(this.nodeCount).fill(0),i=new Array(this.nodeCount).fill(0),s=new Array(this.nodeCount).fill(0);this.outEdges=new Array(this.nodeCount),this.inEdges=new Array(this.nodeCount),this.selfEdges=new Array(this.nodeCount);for(const o of this.edges)o.source!=o.target?(n[o.source]++,i[o.target]++):s[o.source]++;for(let o=0;o<this.nodeCount;o++)this.outEdges[o]=new Array(n[o]),n[o]=0,this.inEdges[o]=new Array(i[o]),i[o]=0,this.selfEdges[o]=new Array(s[o]),s[o]=0;for(const o of this.edges){const a=o.source,l=o.target;a!=l?(this.outEdges[a][n[a]++]=o,this.inEdges[l][i[l]++]=o):this.selfEdges[a][s[a]++]=o}}inEdgesCount(e){return this.inEdges[e].length}outEdgesCount(e){return this.outEdges[e].length}selfEdgesCount(e){return this.selfEdges[e].length}addEdge(e){this.edges.push(e),e.source!=e.target?(this.outEdges[e.source].push(e),this.inEdges[e.target].push(e)):this.selfEdges[e.source].push(e)}*nodesOfConnectedGraph(){if(0==this.edges.length)return;const e=new Set,t=new mu.c;let n=this.edges[0].source;for(ps.enqueue(e,t,n),yield n;t.length>0;){n=t.dequeue();for(const i of this.outEdges[n]){const s=i.target;e.has(s)||(ps.enqueue(e,t,s),yield s)}for(const i of this.inEdges[n]){const s=i.source;e.has(s)||(ps.enqueue(e,t,s),yield s)}}}*pred(e){for(const t of this.inEdges[e])yield t.source}*succ(e){for(const t of this.outEdges[e])yield t.target}static enqueue(e,t,n){t.enqueue(n),e.add(n)}}class fn{constructor(e,t){this.x=e,this.y=t}get source(){return this.x}get target(){return this.y}isDiagonal(){return this.x==this.y}}class qf{constructor(e){this.arrayOfMaps=new Array(e);for(let t=0;t<e;t++)this.arrayOfMaps[t]=new Map}set(e,t,n){this.arrayOfMaps[e].set(t,n)}setPair(e,t){this.set(e.x,e.y,t)}delete(e,t){e<0||e>=this.arrayOfMaps.length||this.arrayOfMaps[e].delete(t)}has(e,t){return!(e<0||e>=this.arrayOfMaps.length)&&this.arrayOfMaps[e].has(t)}get(e,t){return e<0||e>=this.arrayOfMaps.length?null:this.arrayOfMaps[e].get(t)}getI(e){return this.get(e.x,e.y)}*keys(){for(let e=0;e<this.arrayOfMaps.length;e++){const t=this.arrayOfMaps[e];for(const n of t)yield new fn(e,n[0])}}*keyValues(){for(let e=0;e<this.arrayOfMaps.length;e++){const t=this.arrayOfMaps[e];for(const n of t)yield[new fn(e,n[0]),n[1]]}}*values(){for(let e=0;e<this.arrayOfMaps.length;e++){const t=this.arrayOfMaps[e];for(const n of t)yield n[1]}}}var gl=(()=>{return(r=gl||(gl={}))[r.NotVisited=0]="NotVisited",r[r.InStack=1]="InStack",r[r.Visited=2]="Visited",gl;var r})();class IW{constructor(e,t){this.v=e,this.i=t}}class Su{static getFeedbackSetWithConstraints(e,t){throw new Error("Method not implemented.")}static push(e,t,n,i){t[n]=gl.InStack,e.push(new IW(n,i))}static getFeedbackSet(e){const t=new qf(e.nodeCount);if(null==e||0==e.nodeCount)return[];const n=new Array(e.nodeCount).fill(gl.NotVisited);for(let i=0;i<e.nodeCount;i++){if(n[i]==gl.Visited)continue;const s=new cr.K;let o=0;for(Su.push(s,n,i,o);s.size>0;){const a=s.pop();i=a.v,n[i]=gl.Visited,o=a.i;let l=e.outEdges[i];for(;o<l.length;o++){const c=l[o];if(c.source==c.target)continue;const d=n[c.target];d==gl.InStack?t.set(c.source,c.target,c):d==gl.NotVisited&&(Su.push(s,n,i,o+1),i=c.target,n[c.target]=gl.Visited,l=e.outEdges[i],o=-1)}}}return Array.from(t.values())}}var pi=p(9737);class Au{constructor(e,t,n,i=1){this.Source=e,this.Target=t,this.CrossingWeight=n,this.Weight=i}toString(){return pi.String.Format("{0}->{1}",this.Source,this.Target)}}class Qf{static FindClosestPoints(e,t){const n=fe.minDistWithinIntervals(e,t,e.parStart,e.parEnd,t.parStart,t.parEnd,(e.parStart+e.parEnd)/2,(t.parStart+t.parEnd)/2);if(n)return{curveClosestPoint:n.aX,labelSideClosest:n.bX}}static GetSegmentInFrontOfLabel(e,t){if(e instanceof fe)for(const n of e.segs)if((n.start.y-t)*(n.end.y-t)<=0)return n;return null}static ShiftLabel(e,t,n){const i=e.lineWidth/2,s=t.sub(n),o=s.length;o>i&&(e.label.center=e.label.center.add(s.div(o*(o-i))))}static updateLabel(e,t){let n=null;t.labelIsToTheRightOfTheSpline?(e.label.center=new k(t.x+t.rightAnchor/2,t.y),n=Me.mkPP(e.labelBBox.leftTop,e.labelBBox.leftBottom)):t.labelIsToTheLeftOfTheSpline&&(e.label.center=new k(t.x-t.leftAnchor/2,t.y),n=Me.mkPP(e.labelBBox.rightTop,e.labelBBox.rightBottom));const i=Qf.GetSegmentInFrontOfLabel(e.curve,e.label.center.y);if(null!=i&&0==fe.getAllIntersections(e.curve,fe.polyFromBox(e.labelBBox),!1).length){const s=Qf.FindClosestPoints(i,n);if(s)Qf.ShiftLabel(e,s.curveClosestPoint,s.labelSideClosest);else{let o,a;const l=i.closestParameter(n.start),c=i.closestParameter(n.end);i.value(l).sub(n.start).length<i.value(c).sub(n.end).length?(o=i.value(l),a=n.start):(o=i.value(c),a=n.end),Qf.ShiftLabel(e,o,a)}}}}class La{constructor(e,t,n,i=1,s=1){this.reversed=!1,this.source=e,this.target=t,this.edge=n,this.weight=i,this.separation=s}get CrossingWeight(){return 1}get hasLabel(){return null!=this.edge.label}get labelWidth(){return this.edge.label.width}get labelHeight(){return this.edge.label.height}reverse(){const e=this.source;this.source=this.target,this.target=e,this.reversed=!this.reversed}toString(){return"edge("+this.source+"->"+this.target+")"}get curve(){return this.edge.curve}set curve(e){this.edge.curve=e}get underlyingPolyline(){return this.edge.underlyingPolyline}set underlyingPolyline(e){this.edge.underlyingPolyline=e}get LayerSpan(){return null!=this.LayerEdges?this.LayerEdges.length:0}isSelfEdge(){return this.source==this.target}reversedClone(){const e=new La(this.target,this.source,this.edge);if(null!=this.LayerEdges){const t=this.LayerEdges.length;e.LayerEdges=new Array(t);for(let n=0;n<t;n++){const i=this.LayerEdges[t-1-n];e.LayerEdges[n]=new Au(i.Target,i.Source,i.CrossingWeight)}e.LayerEdges[0].Source=this.target,e.LayerEdges[this.LayerEdges.length-1].Target=this.source}return e}get count(){return this.LayerEdges.length}getNode(e){if(e>=0){if(e<this.LayerEdges.length)return this.LayerEdges[e].Source;if(e==this.LayerEdges.length)return this.LayerEdges[e-1].Target}throw new Error("wrong index "+e)}updateEdgeLabelPosition(e){null!=this.edge.label&&Qf.updateLabel(this.edge,e[this.LayerEdges[this.LayerEdges.length/2].Source])}[Symbol.iterator](){return this.nodes()}*nodes(){yield this.LayerEdges[0].Source;for(const e of this.LayerEdges)yield e.Target}}class Ma{constructor(){this.arrayOfSets=new Array}has(e){return this.hasxy(e.x,e.y)}remove(e){if(!(e.x<0||e.x>=this.arrayOfSets.length))return this.arrayOfSets[e.x].delete(e.y)}hasxy(e,t){if(e<0||e>=this.arrayOfSets.length)return!1;const n=this.arrayOfSets[e];return null!=n&&n.has(t)}static mk(e){const t=new Ma;for(const n of e)t.add(n);return t}*values(){for(let e=0;e<this.arrayOfSets.length;e++){const t=this.arrayOfSets[e];if(t)for(const n of t.values())yield new fn(e,n)}}add(e){let t=this.arrayOfSets[e.x];null==t&&(this.arrayOfSets[e.x]=t=new Set),t.add(e.y)}addNN(e,t){let n=this.arrayOfSets[e];null==n&&(this.arrayOfSets[e]=n=new Set),n.add(t)}clear(){for(const e of this.arrayOfSets)e&&e.clear()}}function*by(r){const e=new Array(r.nodeCount).fill(!1),t=new mu.c;for(let n=0;n<r.nodeCount;n++)if(!e[n]){const i=new Array;for(Wx(n,t,e);t.length>0;){const s=t.dequeue();i.push(s);for(const o of PW(r,s))Wx(o,t,e)}yield i}}function*PW(r,e){for(const t of r.outEdges[e])yield t.target;for(const t of r.inEdges[e])yield t.source}function Wx(r,e,t){0==t[r]&&(e.enqueue(r),t[r]=!0)}class NW{constructor(){this.maxLayerOfGeomGraph=new Set,this.minLayerOfGeomGraph=new Set,this.sameLayerConstraints=new Array,this.upDownConstraints=new Array,this.gluedUpDownIntConstraints=new Ma,this.sameLayerDictionaryOfRepresentatives=new Map,this.representativeToItsLayer=new Map,this.maxLayerInt=new Array,this.minLayerInt=new Array,this.sameLayerInts=new Array,this.upDownInts=new Array}getFeedbackSetExternal(e,t){throw new Error("Method not implemented.")}pinNodeToMaxLayer(e){this.maxLayerOfGeomGraph.add(e)}pinNodeToMinLayer(e){this.minLayerOfGeomGraph.add(e)}get isEmpty(){return 0==this.maxLayerOfGeomGraph.size&&0==this.minLayerOfGeomGraph.size&&0==this.sameLayerConstraints.length&&0==this.upDownConstraints.length}clear(){this.maxLayerOfGeomGraph.clear(),this.minLayerOfGeomGraph.clear(),this.sameLayerConstraints=[],this.upDownConstraints=[]}getFeedbackSetImp(e,t){return this.nodeIdToIndex=t,this.intGraph=e,this.maxRepresentative=-1,this.minRepresentative=-1,this.createIntegerConstraints(),this.glueTogetherSameConstraintsMaxAndMin(),this.addMaxMinConstraintsToGluedConstraints(),this.removeCyclesFromGluedConstraints(),this.getFeedbackSet()}removeCyclesFromGluedConstraints(){const e=dc(Array.from(this.gluedUpDownIntConstraints.values()),this.intGraph.nodeCount),t=Su.getFeedbackSetWithConstraints(e,null);for(const n of t)this.gluedUpDownIntConstraints.remove(n)}addMaxMinConstraintsToGluedConstraints(){if(-1!=this.maxRepresentative)for(let e=0;e<this.intGraph.nodeCount;e++){const t=this.nodeToRepr(e);t!=this.maxRepresentative&&this.gluedUpDownIntConstraints.add(new fn(this.maxRepresentative,t))}if(-1!=this.minRepresentative)for(let e=0;e<this.intGraph.nodeCount;e++){const t=this.nodeToRepr(e);t!=this.minRepresentative&&this.gluedUpDownIntConstraints.add(new fn(t,this.minRepresentative))}}glueTogetherSameConstraintsMaxAndMin(){this.createDictionaryOfSameLayerRepresentatives(),this.upDownInts.map(this.gluedIntPairNN),this.gluedUpDownIntConstraints=new Ma}gluedIntPairNN(e){return new fn(this.nodeToRepr(e[0]),this.nodeToRepr(e[1]))}gluedIntPairI(e){return new fn(this.nodeToRepr(e.source),this.nodeToRepr(e.target))}gluedIntPair(e){return new fn(this.nodeToRepr(e.source),this.nodeToRepr(e.target))}gluedIntEdge(e){const t=this.nodeToRepr(e.source),n=this.nodeToRepr(e.target),i=new La(t,n,e.edge);return i.separation=e.separation,i.weight=0,i}nodeToRepr(e){return this.sameLayerDictionaryOfRepresentatives.get(e)||e}createDictionaryOfSameLayerRepresentatives(){const e=this.createGraphOfSameLayers();for(const t of by(e))this.glueSameLayerNodesOfALayer(t)}createGraphOfSameLayers(){return dc(this.createEdgesOfSameLayers(),this.intGraph.nodeCount)}createEdgesOfSameLayers(){const e=new Array;return-1!=this.maxRepresentative&&this.maxLayerInt.filter(t=>t!=this.maxRepresentative).map(t=>new fn(this.maxRepresentative,t)).forEach(t=>e.push(t)),-1!=this.minRepresentative&&this.minLayerInt.filter(t=>t!=this.minRepresentative).map(t=>new fn(this.minRepresentative,t)).forEach(t=>e.push(t)),this.sameLayerInts.forEach(t=>e.push(new fn(t[0],t[1]))),e}glueSameLayerNodesOfALayer(e){if(e.length>1){let t=-1;if(this.componentsIsMaxLayer(e))for(const n of e)this.sameLayerDictionaryOfRepresentatives.set(n,t=this.maxRepresentative);else if(this.componentIsMinLayer(e))for(const n of e)this.sameLayerDictionaryOfRepresentatives.set(n,t=this.minRepresentative);else for(const n of e)-1==t&&(t=n),this.sameLayerDictionaryOfRepresentatives.set(n,t);this.representativeToItsLayer.set(t,e)}}componentIsMinLayer(e){return e.findIndex(t=>this.minRepresentative==t)>=0}componentsIsMaxLayer(e){return e.findIndex(t=>this.maxRepresentative==t)>=0}createIntegerConstraints(){this.createMaxIntConstraints(),this.createMinIntConstraints(),this.createUpDownConstraints(),this.createSameLayerConstraints()}createSameLayerConstraints(){this.sameLayerInts=this.createIntConstraintsFromStringCouples(this.sameLayerConstraints)}createUpDownConstraints(){this.upDownInts=this.createIntConstraintsFromStringCouples(this.upDownConstraints)}createIntConstraintsFromStringCouples(e){return e.map(t=>[this.nodeIndex(t[0]),this.nodeIndex(t[1])]).filter(t=>-1!=t[0]&&-1!=t[1])}createMinIntConstraints(){this.minLayerInt=this.createIntConstraintsFromExtremeLayer(this.minLayerOfGeomGraph),this.minLayerInt.length>0&&(this.minRepresentative=this.minLayerInt[0])}createMaxIntConstraints(){this.maxLayerInt=this.createIntConstraintsFromExtremeLayer(this.maxLayerOfGeomGraph),this.maxLayerInt.length>0&&(this.maxRepresentative=this.maxLayerInt[0])}createIntConstraintsFromExtremeLayer(e){return Array.from(e).map(t=>this.nodeIndex(t)).filter(t=>-1!=t)}nodeIndex(e){return this.nodeIdToIndex.get(e.node.id)||-1}getFeedbackSet(){return this.gluedIntGraph=this.createGluedGraph(),Array.from(this.unglueIntPairs(Su.getFeedbackSetWithConstraints(this.gluedIntGraph,this.gluedUpDownIntConstraints)))}*unglueIntPairs(e){for(const t of e)for(const n of this.unglueEdge(t))yield n}*unglueEdge(e){for(const t of this.unglueNode(e.source))for(const n of this.intGraph.outEdges[t])this.nodeToRepr(n.target)==e.target&&(yield n)}createGluedGraph(){const e=new Ma;return this.intGraph.edges.forEach(t=>e.add(this.gluedIntPairI(t))),dc(Array.from(e.values()),this.intGraph.nodeCount)}unglueNode(e){return this.representativeToItsLayer.get(e)||[e]}getGluedNodeCounts(){const e=new Array(this.nodeIdToIndex.size).fill(0);for(let t=0;t<e.length;t++)e[this.nodeToRepr(t)]++;return e}}class DW{constructor(){this.leftRightConstraints=new Array,this.leftRightNeighbors=new Array,this.nodeToBlockRoot=new Map,this.upDownVerticalConstraints=new Array,this.BlockRootToBlock=new Map}get IsEmpty(){return 0==this.leftRightNeighbors.length&&0==this.upDownVerticalConstraints.length&&0==this.leftRightConstraints.length}AddSameLayerNeighbors(e){for(let t=0;t<e.length-1;t++)this.AddSameLayerNeighborsPair(e[t],e[t+1])}AddSameLayerNeighborsPair(e,t){this.leftRightNeighbors.push([e,t])}NodeToBlockRootSoft(e){return this.nodeToBlockRoot.get(e)||e}CreateMappingOfNeibBlocks(){const e=this.BasicGraphFromLeftRightIntNeibs();for(let t=0;t<e.nodeCount;t++)if(0==e.inEdges[t].length&&!this.nodeToBlockRoot.has(t)){const n=new Array;let i=t;for(let s=e.outEdges[i];s.length>0;s=e.outEdges[i])i=s[0].y,n.push(i),this.nodeToBlockRoot.set(i,t);n.length>0&&this.BlockRootToBlock.set(t,n)}}BasicGraphFromLeftRightIntNeibs(){return DS(Array.from(this.LeftRightIntNeibs.values()).map(e=>new fn(e.x,e.y)))}NodeIndex(e){return this.nodeIdToIndex.get(e.id)||-1}PrepareForOrdering(e,t){this.nodeIdToIndex=e,this.MapNodesToToIntegers(t),this.CreateMappingOfNeibBlocks(),this.LiftLeftRightRelationsToNeibBlocks()}LiftLeftRightRelationsToNeibBlocks(){this.LeftRighInts=Ma.mk(this.leftRightConstraints.map(t=>function _W(r,e){return[r,e]}(this.NodeIndex(t[0]),this.NodeIndex(t[1]))).filter(t=>-1!=t[0]&&-1!=t[1]).map(t=>new fn(this.NodeToBlockRootSoft(t[0]),this.NodeToBlockRootSoft(t[1]))).filter(t=>t.x!=t.x));const e=Su.getFeedbackSet(DS(Array.from(this.LeftRighInts.values())));for(const t of e)this.LeftRighInts.remove(new fn(t.source,t.target))}MapNodesToToIntegers(e){this.LeftRightIntNeibs=Ma.mk(Array.from(this.leftRightNeighbors.values()).map(t=>[this.NodeIndex(t[0]),this.NodeIndex(t[1])]).filter(t=>-1!=t[0]&&-1!=t[1]).map(t=>new fn(t[0],t[1]))),this.VerticalInts=Ma.mk(this.upDownVerticalConstraints.map(t=>[this.NodeIndex(t[0]),this.NodeIndex(t[1])]).filter(t=>-1!=t[0]&&-1!=t[1]&&e[t[0]]>e[t[1]]).map(t=>new fn(t[0],t[1])))}}var ao=(()=>{return(r=ao||(ao={}))[r.TB=0]="TB",r[r.LR=1]="LR",r[r.BT=2]="BT",r[r.RL=3]="RL",r[r.None=4]="None",ao;var r})();let jx=(()=>{class r{constructor(){this.capacityOverflowCoefficient=r.DefaultCapacityOverflowCoefficientMultiplier,this.RotateBundles=!1,this.MaxHubRadius=50,this.MinHubRadius=.1,this.CreateUnderlyingPolyline=!1,this.pathLengthImportance=r.DefaultPathLengthImportance,this.inkImportance=r.DefaultInkImportance,this.edgeSeparation=r.DefaultEdgeSeparation,this.angleThreshold=Math.PI/180*45,this.hubRepulsionImportance=100,this.bundleRepulsionImportance=100,this.minimalRatioOfGoodCdtEdges=.9,this.highestQuality=!0,this.KeepOriginalSpline=!1,this.KeepOverlaps=!1,this.StopAfterShortestPaths=!1}get CapacityOverflowCoefficient(){return this.capacityOverflowCoefficient}set CapacityOverflowCoefficient(t){this.capacityOverflowCoefficient=t}get PathLengthImportance(){return this.pathLengthImportance}set PathLengthImportance(t){this.pathLengthImportance=t}get InkImportance(){return this.inkImportance}set InkImportance(t){this.inkImportance=t}get EdgeSeparation(){return this.edgeSeparation}set EdgeSeparation(t){this.edgeSeparation=t}get UseCubicBezierSegmentsInsideOfHubs(){return this.useCubicBezierSegmentsInsideOfHubs}set UseCubicBezierSegmentsInsideOfHubs(t){this.useCubicBezierSegmentsInsideOfHubs=t}get AngleThreshold(){return this.angleThreshold}set AngleThreshold(t){this.angleThreshold=t}get HubRepulsionImportance(){return this.hubRepulsionImportance}set HubRepulsionImportance(t){this.hubRepulsionImportance=t}get BundleRepulsionImportance(){return this.bundleRepulsionImportance}set BundleRepulsionImportance(t){this.bundleRepulsionImportance=t}get MinimalRatioOfGoodCdtEdges(){return this.minimalRatioOfGoodCdtEdges}set MinimalRatioOfGoodCdtEdges(t){this.minimalRatioOfGoodCdtEdges=t}get HighestQuality(){return this.highestQuality}set HighestQuality(t){this.highestQuality=t}}return r.DefaultCapacityOverflowCoefficientMultiplier=1e3,r.DefaultPathLengthImportance=500,r.DefaultInkImportance=.01,r.DefaultEdgeSeparation=.5,r})();var Mr=(()=>{return(r=Mr||(Mr={}))[r.Spline=0]="Spline",r[r.SplineBundling=1]="SplineBundling",r[r.StraightLine=2]="StraightLine",r[r.SugiyamaSplines=3]="SugiyamaSplines",r[r.Rectilinear=4]="Rectilinear",r[r.RectilinearToCenter=5]="RectilinearToCenter",r[r.None=6]="None",Mr;var r})();class zx{constructor(){this.coneAngle=Math.PI/180*30,this.padding=3,this.polylinePadding=1.5,this.routingToParentConeAngle=Math.PI/6,this.simpleSelfLoopsForParentEdgesThreshold=200,this.incrementalRoutingThreshold=5e6,this.routeMultiEdgesAsBundles=!0,this.KeepOriginalSpline=!1,this.EdgeRoutingMode=Mr.Spline}get EdgeRoutingMode(){return this.edgeRoutingMode}set EdgeRoutingMode(e){e==Mr.SplineBundling&&null==this.BundlingSettings&&null==this.BundlingSettings&&(this.BundlingSettings=new jx),this.edgeRoutingMode=e}get ConeAngle(){return this.coneAngle}set ConeAngle(e){this.coneAngle=e}get Padding(){return this.padding}set Padding(e){this.padding=e}get PolylinePadding(){return this.polylinePadding}set PolylinePadding(e){this.polylinePadding=e}get RoutingToParentConeAngle(){return this.routingToParentConeAngle}set RoutingToParentConeAngle(e){this.routingToParentConeAngle=e}get SimpleSelfLoopsForParentEdgesThreshold(){return this.simpleSelfLoopsForParentEdgesThreshold}set SimpleSelfLoopsForParentEdgesThreshold(e){this.simpleSelfLoopsForParentEdgesThreshold=e}get IncrementalRoutingThreshold(){return this.incrementalRoutingThreshold}set IncrementalRoutingThreshold(e){this.incrementalRoutingThreshold=e}get RouteMultiEdgesAsBundles(){return this.routeMultiEdgesAsBundles}set RouteMultiEdgesAsBundles(e){this.routeMultiEdgesAsBundles=e}}var Xf=(()=>{return(r=Xf||(Xf={}))[r.None=0]="None",r[r.Top=1]="Top",r[r.Bottom=2]="Bottom",Xf;var r})();class $x{constructor(){this.edgeRoutingSettings=new zx,this.minimalWidth=0,this.minimalHeight=0,this.nodeSeparation=10,this.packingAspectRatio=1.5}get MinimalWidth(){return this.minimalWidth}set MinimalWidth(e){this.minimalWidth=Math.max(e,0)}get MinimalHeight(){return this.minimalHeight}set MinimalHeight(e){this.minimalHeight=Math.max(e,0)}get NodeSeparation(){return this.nodeSeparation}set NodeSeparation(e){this.nodeSeparation=e}get PackingAspectRatio(){return this.packingAspectRatio}set PackingAspectRatio(e){this.packingAspectRatio=e}}class xS extends $x{constructor(){super(),this.margins={left:0,top:0,bottom:0,right:0},this.sameRanks=new Array,this.verticalConstraints=new NW,this.horizontalConstraints=new DW,this.NoGainAdjacentSwapStepsBound=5,this.RepetitionCoefficientForOrdering=1,this.AspectRatio=0,this.MaxNumberOfPassesInOrdering=24,this.BrandesThreshold=600,this.LabelCornersPreserveCoefficient=.1,this.MinNodeHeight=9,this.MinNodeWidth=13.5,this.SnapToGridByY=Xf.None,this.yLayerSep=30,this.transform=fi.getIdentity(),this.GridSizeByY=0,this.GridSizeByX=0,this.edgeRoutingSettings.EdgeRoutingMode=Mr.SugiyamaSplines}get LayerSeparation(){return this.yLayerSep}set LayerSeparation(e){this.yLayerSep=Math.max(30,e)}ActualLayerSeparation(e){return e?this.LayerSeparation/2:this.LayerSeparation}transformIsRotation(e){const t=fi.rotation(e);for(let n=0;n<2;n++)for(let i=0;i<3;i++)if(!an(t.elements[n][i],this.transform.elements[n][i]))return!1;return!0}get layerDirection(){return this.transformIsRotation(0)?ao.TB:this.transformIsRotation(Math.PI/2)?ao.LR:this.transformIsRotation(-Math.PI/2)?ao.RL:this.transformIsRotation(Math.PI)?ao.BT:ao.None}set layerDirection(e){switch(e){case ao.TB:this.transform=fi.getIdentity();break;case ao.LR:this.transform=fi.rotation(Math.PI/2);break;case ao.RL:this.transform=fi.rotation(-Math.PI/2);break;case ao.BT:this.transform=fi.rotation(Math.PI);break;default:throw new Error("unexpected layout direction")}}}class zo{constructor(){this.isEmpty=!0}AddValue(e){this.isEmpty?(this.max=e,this.min=e,this.isEmpty=!1):e<this.min?this.min=e:e>this.max&&(this.max=e)}get length(){return this.max-this.min}static sign(e){return e>le.distanceEpsilon?1:e<-le.distanceEpsilon?-1:0}}class Cy extends ps{constructor(e,t){super(),this.SetEdges(e,t)}}class xW{constructor(e){this.MultipleMiddles=new Set,this.Multiedges=new qf(e)}*RegularMultiedges(){for(const[e,t]of this.Multiedges.keyValues())e.x!=e.y&&(yield t)}*AllIntEdges(){for(const e of this.Multiedges.values())for(const t of e)yield t}addFeedbackSet(e){for(const t of e){const n=new fn(t.source,t.target),i=new fn(t.target,t.source),s=this.Multiedges.get(n.x,n.y);for(const o of s)o.reverse();if(this.Multiedges.has(i.x,i.y)){const o=this.Multiedges.get(i.x,i.y);for(const a of s)o.push(a)}else this.Multiedges.set(i.x,i.y,s);this.Multiedges.delete(n.x,n.y)}}registerOriginalEdgeInMultiedges(e){let t=this.Multiedges.get(e.source,e.target);null==t&&this.Multiedges.set(e.source,e.target,t=[]),t.push(e)}*SkeletonEdges(){for(const[e,t]of this.Multiedges.keyValues())e.x!=e.y&&(yield t[0])}GetMultiedge(e,t){return this.GetMultiedgeI(new fn(e,t))}GetMultiedgeI(e){return this.Multiedges.has(e.x,e.y)?this.Multiedges.get(e.x,e.y):new Array}}function aT(r,e){for(let t=0;t<r.length;t++)e[t]=r[t]}class fc{constructor(e){this.initialize(e)}initialize(e){this.y=e,this.verticesToX=null,this.layers=null}DropEmptyLayers(){const e=new Array(this.Layers.length);let t=0;for(let o=0;o<this.Layers.length;o++)e[o]=t,0==this.Layers[o].length&&t++;if(0==t)return this;const n=new Array(this.y.length);for(let o=0;o<n.length;o++)n[o]=this.y[o]-e[this.y[o]];const i=new Array(this.layers.length-t);for(let o=0;o<this.layers.length;o++)this.layers[o].length>0&&(i[o-e[o]]=Array.from(this.layers[o]));const s=new fc(n);return s.layers=i,s}updateLayers(e){null==this.layers&&this.InitLayers();for(let t=0;t<this.layers.length;t++)aT(e[t],this.layers[t]);this.UpdateXFromLayers()}UpdateXFromLayers(){null==this.layers&&this.InitLayers(),null==this.verticesToX&&(this.verticesToX=new Array(this.y.length));for(const e of this.layers){let t=0;for(const n of e)this.verticesToX[n]=t++}}get x(){return null!=this.verticesToX||(this.verticesToX=new Array(this.y.length),this.UpdateXFromLayers()),this.verticesToX}ReversedClone(){const e=new Array(this.y.length),t=this.Layers.length-1;for(let n=0;n<this.y.length;n++)e[n]=t-this.y[n];return new fc(e)}get Layers(){return null!=this.layers||this.InitLayers(),this.layers}set Layers(e){this.layers=e}InitLayers(){let e=0;for(const n of this.y)n+1>e&&(e=n+1);const t=new Array(e).fill(0);for(const n of this.y)t[n]++;this.layers=new Array(e);for(let n=0;n<e;n++)this.layers[n]=new Array(t[n]),t[n]=0;for(let n=0;n<this.y.length;n++){const i=this.y[n];this.layers[i][t[i]++]=n}}}class lT extends Rr{constructor(e,t,n,i){super(i),this.jumpers=new Set,this.possibleJumperFeasibleIntervals=new Map,this.nodeCount=n,this.dag=e,this.layering=t,this.Init()}static Balance(e,t,n,i){new lT(e,t,n,i).run()}run(){for(;this.jumpers.size>0;)this.Jump(this.ChooseJumper())}Init(){this.CalculateLayerCounts(),this.InitJumpers()}Jump(e){this.jumpers.delete(e);const t=this.possibleJumperFeasibleIntervals.get(e),n=this.CalcJumpInfo(t.x,t.y,e);if(null==n)return;this.layering[e]=n.layerToJumpTo;const i=this.nodeCount[e];this.vertsCounts[n.jumperLayer]-=i,this.vertsCounts[n.layerToJumpTo]+=i,this.UpdateRegionsForPossibleJumpersAndInsertJumpers(n.jumperLayer,e)}IsJumper(e){return this.possibleJumperFeasibleIntervals.has(e)}UpdateRegionsForPossibleJumpersAndInsertJumpers(e,t){const n=new Set;for(const s of this.dag.pred(t))this.IsJumper(s)&&(this.CalculateRegionAndInsertJumper(s),n.add(s));for(const s of this.dag.succ(t))this.IsJumper(s)&&(this.CalculateRegionAndInsertJumper(s),n.add(s));const i=new Array;for(const s of this.possibleJumperFeasibleIntervals)n.has(s[0])||s[1].x>e&&s[1].y<e&&i.push(s[0]);for(const s of i)this.CalculateRegionAndInsertJumper(s)}InitJumpers(){const e=new Array(this.dag.nodeCount).fill(0);for(const t of this.dag.edges)e[t.source]-=t.weight,e[t.target]+=t.weight;this.possibleJumperFeasibleIntervals=new Map;for(let t=0;t<this.dag.nodeCount;t++)0==e[t]&&this.CalculateRegionAndInsertJumper(t)}CalculateRegionAndInsertJumper(e){const t=new fn(this.Up(e),this.Down(e));this.possibleJumperFeasibleIntervals.set(e,t),this.InsertJumper(t.x,t.y,e)}InsertJumper(e,t,n){null!=this.CalcJumpInfo(e,t,n)&&this.jumpers.add(n)}CalcJumpInfo(e,t,n){const i=this.layering[n];let s=-1,o=this.vertsCounts[i]-2*this.nodeCount[n];for(let a=e-1;a>i;a--)this.vertsCounts[a]<o&&(o=this.vertsCounts[a],s=a);for(let a=i-1;a>t;a--)this.vertsCounts[a]<o&&(o=this.vertsCounts[a],s=a);if(-1!=s)return{jumperLayer:i,layerToJumpTo:s}}Up(e){let t=Number.MAX_SAFE_INTEGER;for(const n of this.dag.inEdges[e]){const i=this.layering[n.source]-n.separation+1;i<t&&(t=i)}return t==Number.MAX_SAFE_INTEGER&&(t=this.layering[e]+1),t}Down(e){let t=Number.NEGATIVE_INFINITY;for(const n of this.dag.outEdges[e]){const i=this.layering[n.target]+n.separation-1;i>t&&(t=i)}return t==Number.NEGATIVE_INFINITY&&(t=this.layering[e]-1),t}CalculateLayerCounts(){this.vertsCounts=new Array(Math.max(...this.layering)+1).fill(0);for(const e of this.layering)this.vertsCounts[e]+=this.nodeCount[e]}ChooseJumper(){for(const e of this.jumpers)return e;throw new Error("there are no jumpers to choose")}}class Qh{constructor(e){this.Initialize(e)}Initialize(e){this.BaseGraph=e,this.totalNumberOfNodes=e.nodeCount;for(const t of this.BaseGraph.edges)if(null!=t.LayerEdges)for(const n of t.LayerEdges){const i=Math.max(n.Source,n.Target)+1;i>this.totalNumberOfNodes&&(this.totalNumberOfNodes=i)}this.firstVirtualNode=Number.POSITIVE_INFINITY;for(const t of this.BaseGraph.edges)if(null!=t.LayerEdges)for(let n=1;n<t.LayerEdges.length;n++)this.firstVirtualNode=Math.min(this.firstVirtualNode,t.LayerEdges[n].Source);this.firstVirtualNode==Number.POSITIVE_INFINITY&&(this.firstVirtualNode=this.BaseGraph.nodeCount,this.totalNumberOfNodes=this.BaseGraph.nodeCount),this.virtualNodesToInEdges=new Array(this.totalNumberOfNodes-this.firstVirtualNode),this.virtualNodesToOutEdges=new Array(this.totalNumberOfNodes-this.firstVirtualNode);for(const t of this.BaseGraph.edges)if(t.LayerSpan>0)for(const n of t.LayerEdges)n.Target!=t.target&&(this.virtualNodesToInEdges[n.Target-this.firstVirtualNode]=n),n.Source!=t.source&&(this.virtualNodesToOutEdges[n.Source-this.firstVirtualNode]=n)}*edges_(){for(const e of this.BaseGraph.edges)if(e.LayerSpan>0)for(const t of e.LayerEdges)yield t}get Edges(){return this.edges_()}*InEdges(e){if(e<this.BaseGraph.nodeCount)for(const t of this.BaseGraph.inEdges[e])t.source!=t.target&&null!=t.LayerEdges&&(yield Qh.LastEdge(t));else e>=this.firstVirtualNode&&(yield this.InEdgeOfVirtualNode(e))}static LastEdge(e){return e.LayerEdges[e.LayerEdges.length-1]}InEdgeOfVirtualNode(e){return this.virtualNodesToInEdges[e-this.firstVirtualNode]}*OutEdges(e){if(e<this.BaseGraph.nodeCount)for(const t of this.BaseGraph.outEdges[e])t.source!=t.target&&null!=t.LayerEdges&&(yield Qh.FirstEdge(t));else e>=this.firstVirtualNode&&(yield this.OutEdgeOfVirtualNode(e))}OutDegreeIsMoreThanOne(e){return e<this.BaseGraph.nodeCount&&this.BaseGraph.outEdges[e].length>1}InDegreeIsMoreThanOne(e){return e<this.BaseGraph.nodeCount&&this.BaseGraph.inEdges[e].length>1}OutEdgeOfVirtualNode(e){return this.virtualNodesToOutEdges[e-this.firstVirtualNode]}static FirstEdge(e){return e.LayerEdges[0]}InEdgesCount(e){return this.RealInEdgesCount(e)}RealInEdgesCount(e){return e<this.BaseGraph.nodeCount?this.BaseGraph.inEdges[e].filter(t=>null!=t.LayerEdges).length:1}OutEdgesCount(e){return this.RealOutEdgesCount(e)}RealOutEdgesCount(e){return e<this.BaseGraph.nodeCount?this.BaseGraph.outEdges[e].filter(t=>null!=t.LayerEdges).length:1}get NodeCount(){return this.totalNumberOfNodes}IsRealNode(e){return e<this.BaseGraph.nodeCount}IsVirtualNode(e){return!this.IsRealNode(e)}ReversedClone(){const e=this.CreateReversedEdges();return new Qh(new Cy(e,this.BaseGraph.nodeCount))}CreateReversedEdges(){const e=new Array;for(const t of this.BaseGraph.edges)t.isSelfEdge()||e.push(t.reversedClone());return e}*Succ(e){for(const t of this.OutEdges(e))yield t.Target}*Pred(e){for(const t of this.InEdges(e))yield t.Source}}var cT=p(5027);class Ry{constructor(e,t,n,i){this.la=t,this.database=n,this.layeredGraph=e,this.intGraph=i}static InsertLayers(e,t,n,i){const s=new Ry(e,t,n,i);return s.InsertLayers(),{layeredGraph:s.nLayeredGraph,la:s.Nla.DropEmptyLayers()}}get NLayering(){return this.Nla.y}InsertLayers(){this.EditOldLayering(),this.CreateFullLayeredGraph(),this.InitNewLayering(),this.MapVirtualNodesToEdges(),this.FillUnsortedNewOddLayers(),this.WidenOriginalLayers(),this.SortNewOddLayers()}EditOldLayering(){let e=this.intGraph.nodeCount;for(const t of this.database.RegularMultiedges()){let n=0;const i=t[0];if(n=2*i.LayerSpan,n>0){for(const s of i.LayerEdges)s.Target!=i.target&&(e++,this.UpdateOldLayer(e++,s.Target));e+=(n-1)*(t.length-1)+1}}}UpdateOldLayer(e,t){this.la.Layers[this.la.y[t]][this.la.x[t]]=e}WidenOriginalLayers(){for(let e=0;e<this.la.Layers.length;e++){const t=this.Nla.Layers[2*e];let n=0;for(const i of this.la.Layers[e]){const s=this.virtNodesToIntEdges[i];if(null!=s){const o=this.NLayering[s.source]-this.NLayering[i],a=this.database.Multiedges.get(s.source,s.target);for(const l of a)if(l!=s){const c=l.LayerEdges[o].Source;t[n]=c,this.Nla.x[c]=n++}else t[n]=i,this.Nla.x[i]=n++}else t[n]=i,this.Nla.x[i]=n++}}}FillUnsortedNewOddLayers(){const e=new Array(this.Nla.Layers.length).fill(0);for(let t=this.intGraph.nodeCount;t<this.nLayeredGraph.NodeCount;t++){const n=this.NLayering[t];n%2==1&&(this.Nla.Layers[n][e[n]++]=t)}}MapVirtualNodesToEdges(){this.virtNodesToIntEdges=new Array(this.NLayering.length);for(const e of this.database.AllIntEdges())if(e.source!=e.target&&null!=e.LayerEdges)for(const t of e.LayerEdges)t.Target!=e.target&&(this.virtNodesToIntEdges[t.Target]=e)}CreateFullLayeredGraph(){this.totalNodes=this.intGraph.nodeCount;for(const e of this.database.RegularMultiedges()){let t=0,n=!0;for(const i of e)if(n&&(n=!1,t=2*i.LayerSpan),t>0){i.LayerEdges=new Array(t);for(let s=0;s<t;s++){const o={currentVV:this.totalNodes},a=Xh.GetSource(o,i,s);this.totalNodes=o.currentVV;const l=Xh.GetTarget(this.totalNodes,i,s,t);i.LayerEdges[s]=new Au(a,l,i.CrossingWeight)}Ry.RegisterDontStepOnVertex(this.database,i)}}this.nLayeredGraph=new Qh(this.intGraph)}SortNewOddLayers(){for(let e=1;e<this.Nla.Layers.length;e+=2){const t=new cT.SortedMap,n=this.Nla.Layers[e];for(const s of n){let o=-1;for(const c of this.nLayeredGraph.InEdges(s))o=c.Source;let a=-1;for(const c of this.nLayeredGraph.OutEdges(s))a=c.Target;const l=this.Nla.x[o]+this.Nla.x[a];if(t.has(l)){const c=t.get(l);if("number"==typeof c){const d=new Array;d.push(c),d.push(s),t.set(l,d)}else c.push(s)}else t.set(l,s)}let i=0;for(const s of t.values())if("number"==typeof s)n[i++]=s;else for(const o of s)n[i++]=o;for(let s=0;s<n.length;s++)this.Nla.x[n[s]]=s}}InitNewLayering(){this.Nla=new fc(new Array(this.totalNodes));for(let n=0;n<this.layeredGraph.NodeCount;n++)this.NLayering[n]=2*this.la.y[n];for(const[n,i]of this.database.Multiedges.keyValues())if(n.x!=n.y&&this.la.y[n.x]!=this.la.y[n.y]){const s=2*this.la.y[n.x];for(const o of i){let a=s-1;for(const l of o.LayerEdges)l.Target!=o.target&&(this.NLayering[l.Target]=a--)}}const e=new Array(2*this.la.Layers.length-1),t=new Array(e.length).fill(0);for(const n of this.NLayering)t[n]++;for(let n=0;n<t.length;n++)e[n]=new Array(t[n]);this.Nla=new fc(this.NLayering),this.Nla.Layers=e}static RegisterDontStepOnVertex(e,t){e.Multiedges.get(t.source,t.target).length>1&&e.MultipleMiddles.add(t.LayerEdges[t.LayerEdges.length/2].Source)}}class Xh{constructor(e,t,n,i){this.virtNodesToIntEdges=new Map,this.la=t,this.database=n,this.layeredGraph=e,this.intGraph=i}get NLayering(){return this.Nla.y}static InsertPaths(e,t,n,i){const s=new Xh(e,t,n,i);return s.InsertPaths(),{layeredGraph:s.NLayeredGraph,la:s.Nla}}InsertPaths(){this.CreateFullLayeredGraph(),this.InitNewLayering(),this.MapVirtualNodesToEdges(),this.WidenOriginalLayers()}WidenOriginalLayers(){for(let e=0;e<this.la.Layers.length;e++){const t=this.Nla.Layers[e];let n=0;for(const i of this.la.Layers[e]){const s=this.virtNodesToIntEdges.get(i);if(null!=s){const o=this.NLayering[s.source]-this.NLayering[i],a=this.database.Multiedges.get(s.source,s.target);for(const l of a)if(!this.EdgeIsFlat(l))if(l!=s){const c=l.LayerEdges[o].Source;t[n]=c,this.Nla.x[c]=n++}else t[n]=i,this.Nla.x[i]=n++}else t[n]=i,this.Nla.x[i]=n++}}}EdgeIsFlat(e){return this.la.y[e.source]==this.la.y[e.target]}MapVirtualNodesToEdges(){for(const e of this.database.RegularMultiedges())for(const t of e)if(!this.EdgeIsFlat(t))for(const n of t.LayerEdges)n.Target!=t.target&&this.virtNodesToIntEdges.set(n.Target,t)}CreateFullLayeredGraph(){let e=this.layeredGraph.NodeCount;for(const[t,n]of this.database.Multiedges.keyValues())if(t.x!=t.y){let i=!0,s=0;for(const o of n){if(i)i=!1,s=o.LayerSpan;else if(o.LayerEdges=new Array(s),1==s)o.LayerEdges[0]=new Au(o.source,o.target,o.CrossingWeight);else for(let a=0;a<s;a++){const l={currentVV:e},c=Xh.GetSource(l,o,a);e=l.currentVV;const d=Xh.GetTarget(e,o,a,s);o.LayerEdges[a]=new Au(c,d,o.CrossingWeight)}Ry.RegisterDontStepOnVertex(this.database,o)}}this.NLayeredGraph=new Qh(this.intGraph)}static GetTarget(e,t,n,i){return n<i-1?e:t.target}static GetSource(e,t,n){return 0==n?t.source:e.currentVV++}InitNewLayering(){this.Nla=new fc(new Array(this.NLayeredGraph.NodeCount));for(let n=0;n<this.layeredGraph.NodeCount;n++)this.NLayering[n]=this.la.y[n];for(const[n,i]of this.database.Multiedges.keyValues())if(n.x!=n.y&&this.la.y[n.x]!=this.la.y[n.y]){let s=0,o=!0;for(const a of i){o&&(o=!1,s=this.la.y[a.source]);let l=s-1;for(const c of a.LayerEdges)this.NLayering[c.Target]=l--}}const e=new Array(this.la.Layers.length),t=new Array(e.length).fill(0);for(const n of this.NLayering)t[n]++;for(let n=0;n<t.length;n++)e[n]=new Array(t[n]);this.Nla=new fc(this.NLayering),this.Nla.Layers=e}}const Kx=BigInt("6364136223846793005"),uT=(BigInt(1)<<BigInt(32))-BigInt(1),gc=(BigInt(1)<<BigInt(64))-BigInt(1);class hT{constructor(e,t){this._state=BigInt(0),this._inc=(BigInt(t)<<BigInt(1)|BigInt(1))&gc,this._random_b(),this._state=this._state+BigInt(e)&gc,this._random_b()}_random_b(){const e=this._state;this._state=e*Kx+this._inc&gc;const t=(e>>BigInt(18)^e)>>BigInt(27),n=e>>BigInt(59);return(t>>n|t<<(n^BigInt(31)))&uT}_advance(e){e&=gc;let t=BigInt(1),n=Kx,i=BigInt(0),s=this._inc;for(;e>0;)e&BigInt(1)&&(t=t*n&gc,i=i*n+s&gc),s=(n+BigInt(1))*s&gc,n=n*n&gc,e>>=BigInt(1);this._state=t*this._state+i&gc}randint(e){if(e>uT)throw new TypeError(`Bound too large: ${e}`);if(e<=0)throw new TypeError(`Empty sample space for r: 0 \u2264 r < ${e}`);const t=BigInt(e),n=(uT^t)%t;for(;;){const i=this._random_b();if(i>=n)return Number(i%t)}}random(){return Number(this._random_b())/Math.pow(2,32)}}let Zh;function Ty(r){return null==Zh&&(Zh=new hT(0,0)),Zh.randint(r)}function dT(){return null==Zh&&(Zh=new hT(0,0)),Zh.random()}class Jx{constructor(e,t,n){this.numberOfCrossings=t,this.la=e,this.virtVertexStart=n}LayerGroupDisbalance(e,t,n){return 1==t?this.LayerGroupDisbalanceWithOrigSeparators(e,n):this.LayerGroupDisbalanceWithVirtSeparators(e,t)}LayerGroupDisbalanceWithVirtSeparators(e,t){let n=0;for(let i=0;i<e.length;){const s=this.CurrentOrigGroupDelta(i,e,t);i=s.i,n+=s.ret}return n}CurrentOrigGroupDelta(e,t,n){let i=0,s=e;for(;s<t.length&&t[s]<this.virtVertexStart;s++)i++;return e=s+1,{ret:Math.abs(n-i),i:e}}LayerGroupDisbalanceWithOrigSeparators(e,t){let n=0;for(let i=0;i<e.length;){const s=this.CurrentVirtGroupDelta(i,e,t);n+=s.ret,i=s.i}return n}CurrentVirtGroupDelta(e,t,n){let i=0,s=e;for(;s<t.length&&t[s]>=this.virtVertexStart;s++)i++;return e=s+1,{ret:Math.abs(n-i),i:e}}static less(e,t){return e.numberOfCrossings<t.numberOfCrossings}static greater(e,t){return e.numberOfCrossings>t.numberOfCrossings}IsPerfect(){return 0==this.numberOfCrossings}}class FW{constructor(e){this.x=e}Compare(e,t){const n=this.x[e.Source]-this.x[t.Source];return 0!=n?n:this.x[e.Target]-this.x[t.Target]}}class BW{constructor(e){this.x=e}Compare(e,t){const n=this.x[e.Target]-this.x[t.Target];return 0!=n?n:this.x[e.Source]-this.x[t.Source]}}class qi{constructor(e,t){IS(e,t)<0?(this.first=e,this.second=t):(this.first=t,this.second=e)}get First(){return this.first}get Second(){return this.second}get Length(){return Dn(this.first,this.second)}CompareTo(e){const t=IS(this.first,e.first);return 0!=t?t:IS(this.second,e.second)}static equal(e,t){return e.first.equal(t.first)&&e.second.equal(t.second)}toString(){return this.first+" "+this.second}}class Fr{constructor(){this.size_=0,this.mapOfSets=new Map}delete(e){return this.deletexy(e.x,e.y)}clear(){this.mapOfSets.clear(),this.size_=0}get size(){return this.size_}static mk(e){const t=new Fr;for(const n of e)t.add(n);return t}addxy(e,t){let n=this.mapOfSets.get(e);null==n&&this.mapOfSets.set(e,n=new Set),n.has(t)||this.size_++,n.add(t)}add(e){return this.addxy(e.x,e.y),this}deletexy(e,t){const n=this.mapOfSets.get(e);return!(null==n||!n.delete(t)||(this.size_--,0))}hasxy(e,t){return this.mapOfSets.has(e)&&this.mapOfSets.get(e).has(t)}has(e){return this.hasxy(e.x,e.y)}forEach(e,t){for(const n of this)e(n,n,t)}*entries(){for(const e of this)yield[e,e]}keys(){return this.values()}*values(){for(const e of this.mapOfSets)for(const t of e[1])yield new k(e[0],t)}[(Symbol,Symbol.iterator)](){return this.values()}}function Zf(r,e){const t=new Set;for(const n of r)e.has(n)||t.add(n);return t}function eg(r,e){const t=new Set(r);for(const n of e)t.add(n);return t}function bu(r,e){for(const t of e)r.push(t)}function Cu(r,e){const t=new Set;if(r.size<e.size)for(const n of r)e.has(n)&&t.add(n);else for(const n of e)r.has(n)&&t.add(n);return t}function Oy(r,e){for(const t of e)r.add(t)}function LS(r,e){if(r.size!=e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0}function Iy(r,e){const t=[];for(const n of r)for(const i of e(n))t.push(i);return t}function MS(r,e,t){let n=r.get(e);n||(n=new Set,r.set(e,n)),n.add(t)}function tg(r,e,t){let n=r.get(e);n||(n=new Array,r.set(e,n)),n.push(t)}function qx(r,e,t){let n=r.get(e);n||(n=new Set,r.set(e,n)),n.add(t)}function VW(r,e,t){qx(r,new qi(e[0],e[1]),t)}function Qx(r,e,t){!function HW(r,e,t){const n=r.get(e);n&&n.delete(t)}(r,new qi(e[0],e[1]),t)}function FS(){return 0==Ty(2)}function YW(r,e,t){const n=t.Layers[r+1],i=t.Layers[r];return i.length<=n.length?function WW(r,e,t){const n=Xx(r,e),i=new FW(t.x);n.sort((l,c)=>i.Compare(l,c));let s=1;for(;s<r.length;)s*=2;const o=new Array(2*s-1).fill(0);s--;let a=0;for(const l of n){let c=s+t.x[l.Target];const d=l.CrossingWeight;for(o[c]+=d;c>0;)c%2!=0&&(a+=d*o[c+1]),c=Math.floor((c-1)/2),o[c]+=d}return a}(i,e,t):function UW(r,e,t,n){const i=Xx(e,t),s=new BW(n.x);i.sort((c,d)=>s.Compare(c,d));let o=1;for(;o<r.length;)o*=2;const a=new Array(2*o-1).fill(0);o--;let l=0;for(const c of i){let d=o+n.x[c.Source];const b=c.CrossingWeight;for(a[d]+=b;d>0;)d%2!=0&&(l+=b*a[d+1]),d=Math.floor((d-1)/2),a[d]+=b}return l}(n,i,e,t)}function Xx(r,e){return Iy(r,t=>Array.from(e.InEdges(t)))}function Zx(r,e){let t=0;for(let n=0;n<e.Layers.length-1;n++)t+=YW(n,r,e);return t}class ng extends Rr{constructor(e,t,n,i,s,o,a){super(a),this.tryReverse=!0,this.MaxNumberOfAdjacentExchanges=50,this.cancelToken=a,this.tryReverse=t,this.startOfVirtNodes=i,this.layerArrays=n,this.layering=n.y,this.nOfLayers=n.Layers.length,this.layers=n.Layers,this.properLayeredGraph=e,this.hasCrossWeights=s,this.SugSettings=o}get NoGainStepsBound(){return this.SugSettings.NoGainAdjacentSwapStepsBound*this.SugSettings.RepetitionCoefficientForOrdering}get SeedOfRandom(){return Ty(100)}get MaxOfIterations(){return this.SugSettings.MaxNumberOfPassesInOrdering*this.SugSettings.RepetitionCoefficientForOrdering}static OrderLayers(e,t,n,i,s){let o=!1;for(const l of e.Edges)if(1!=l.CrossingWeight){o=!0;break}new ng(e,!0,t,n,o,i,s).run()}run(){if(this.Calculate(),this.tryReverse){const e=this.layerArrays.ReversedClone(),t=new ng(this.properLayeredGraph.ReversedClone(),!1,e,this.startOfVirtNodes,this.hasCrossWeights,this.SugSettings,this.cancelToken);if(t.run(),t.measure<this.measure){for(let n=0;n<this.nOfLayers;n++)aT(e.Layers[n],this.layerArrays.Layers[this.nOfLayers-1-n]);this.layerArrays.UpdateXFromLayers()}}}Calculate(){this.Init(),this.layerArraysCopy=ng.CloneLayers(this.layers,this.layerArraysCopy);let e=0;this.measure=new Jx(this.layerArraysCopy,Zx(this.properLayeredGraph,this.layerArrays),this.startOfVirtNodes);for(let t=0;t<this.MaxOfIterations&&e<this.NoGainStepsBound&&!this.measure.IsPerfect();t++){this.LayerByLayerSweep(t%2==0),this.AdjacentExchange();const i=new Jx(this.layerArrays.Layers,Zx(this.properLayeredGraph,this.layerArrays),this.startOfVirtNodes);this.measure<i?(this.Restore(),e++):(i<this.measure||FS())&&(e=0,this.layerArraysCopy=ng.CloneLayers(this.layers,this.layerArraysCopy),this.measure=i)}}static CloneLayers(e,t){if(null==t){t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].map(i=>i)}else for(let n=0;n<e.length;n++)aT(e[n],t[n]);return t}Restore(){this.layerArrays.updateLayers(this.layerArraysCopy)}LayerByLayerSweep(e){if(e)for(let t=1;t<this.nOfLayers;t++)this.SweepLayer(t,!0);else for(let t=this.nOfLayers-2;t>=0;t--)this.SweepLayer(t,!1)}SweepLayer(e,t){const n=this.layers[e],i=new Array(n.length);for(let o=0;o<i.length;o++)i[o]=this.WMedian(n[o],t);this.Sort(e,i);const s=this.layerArrays.Layers[e];for(let o=0;o<s.length;o++)this.layerArrays.x[s[o]]=o}Sort(e,t){const n=new cT.SortedMap,i=this.layers[e];let s=0;for(const a of t){const l=i[s++];if(-1!=a)if(n.has(a)){const c=n.get(a);if("number"!=typeof c){const d=c;if(FS())d.push(l);else{const b=Ty(d.length),N=d[b];d[b]=l,d.push(N)}}else{const d=c,b=new Array;n.set(a,b),FS()?(b.push(d),b.push(l)):(b.push(l),b.push(d))}}else n.set(a,l)}const o=n.values();for(s=0;s<i.length;)if(-1!=t[s]){const a=o.next().value;if("number"==typeof a)i[s++]=a;else{const l=a;for(const c of l){for(;-1==t[s];)s++;i[s++]=c}}}else s++}WMedian(e,t){let n,i;if(t?(n=this.properLayeredGraph.OutEdges(e),i=this.properLayeredGraph.OutEdgesCount(e)):(n=this.properLayeredGraph.InEdges(e),i=this.properLayeredGraph.InEdgesCount(e)),0==i)return-1;const s=new Array(i);let o=0;if(t)for(const d of n)s[o++]=this.X[d.Target];else for(const d of n)s[o++]=this.X[d.Source];s.sort((d,b)=>d-b);const a=Math.floor(i/2);if(i%2==1)return s[a];if(2==i)return.5*(s[0]+s[1]);const l=s[a-1]-s[0],c=s[i-1]-s[a];return Math.floor((s[a-1]*l+s[a]*c)/(l+c))}Init(){const e=new Array(this.nOfLayers).fill(0),t=new cr.K;for(let i=0;i<this.properLayeredGraph.NodeCount;i++)0==this.properLayeredGraph.InEdgesCount(i)&&t.push(i);const n=new Array(this.properLayeredGraph.NodeCount).fill(!1);for(;t.size>0;){const i=t.pop(),s=this.layerArrays.y[i];this.layerArrays.Layers[s][e[s]]=i,this.layerArrays.x[i]=e[s],e[s]++;for(const o of this.properLayeredGraph.Succ(i))n[o]||(n[o]=!0,t.push(o))}this.X=this.layerArrays.x}AdjacentExchange(){this.InitArrays();let e=0,t=!0;for(;t&&e++<this.MaxNumberOfAdjacentExchanges;){t=!1;for(let n=0;n<this.layers.length;n++)t=this.AdjExchangeLayer(n)||t;for(let n=this.layers.length-2;n>=0;n--)t=this.AdjExchangeLayer(n)||t}}AllocArrays(){const e=this.properLayeredGraph.NodeCount;this.predecessors=new Array(e),this.successors=new Array(e),this.pOrder=new Array(e),this.sOrder=new Array(e),this.hasCrossWeights&&(this.outCrossingCount=new Array(e),this.inCrossingCount=new Array(e));for(let t=0;t<e;t++){let n=this.properLayeredGraph.InEdgesCount(t);if(this.predecessors[t]=new Array(n),this.hasCrossWeights){const i=this.inCrossingCount[t]=new Map;for(const s of this.properLayeredGraph.InEdges(t))i.set(s.Source,s.CrossingWeight)}if(this.pOrder[t]=new Map,n=this.properLayeredGraph.OutEdgesCount(t),this.successors[t]=new Array(n),this.sOrder[t]=new Map,this.hasCrossWeights){const i=this.outCrossingCount[t]=new Map;for(const s of this.properLayeredGraph.OutEdges(t))i.set(s.Target,s.CrossingWeight)}}}InitArrays(){null==this.successors&&this.AllocArrays();for(let e=0;e<this.properLayeredGraph.NodeCount;e++)this.pOrder[e]=new Map,this.sOrder[e]=new Map;for(const e of this.layers)this.InitPsArraysForLayer(e)}CalcPair(e,t){const n=this.successors[e],i=this.successors[t],s=this.predecessors[e],o=this.predecessors[t];if(this.hasCrossWeights){const a=this.outCrossingCount[e],l=this.outCrossingCount[t],c=this.inCrossingCount[e],d=this.inCrossingCount[t];return{cuv:this.CountOnArraysUV(n,i,a,l)+this.CountOnArraysUV(s,o,c,d),cvu:this.CountOnArraysUV(i,n,l,a)+this.CountOnArraysUV(o,s,d,c)}}return{cuv:this.CountOnArrays(n,i)+this.CountOnArrays(s,o),cvu:this.CountOnArrays(i,n)+this.CountOnArrays(o,s)}}InitPsArraysForLayer(e){for(const t of e){for(const n of this.properLayeredGraph.Pred(t)){const i=this.sOrder[n],s=i.size;this.successors[n][s]=t,i.set(t,s)}for(const n of this.properLayeredGraph.Succ(t)){const i=this.pOrder[n],s=i.size;this.predecessors[n][s]=t,i.set(t,s)}}}CountOnArrays(e,t){let n=0;const i=t.length-1;let s=-1,o=0;for(const a of e){const l=this.X[a];for(;s<i&&this.X[t[s+1]]<l;s++)o++;n+=o}return n}CountOnArraysUV(e,t,n,i){let s=0;const o=t.length-1;let a=-1,l=0;for(const c of e){const d=this.X[c];let b;for(;a<o&&this.X[b=t[a+1]]<d;a++)l+=i.get(b);s+=l*n.get(c)}return s}AdjExchangeLayer(e){const t=this.layers[e];return!!this.ExchangeWithGainWithNoDisturbance(t)||(this.DisturbLayer(t),this.ExchangeWithGainWithNoDisturbance(t))}Swap(e,t){const n=this.X[e],i=this.X[t],o=this.layers[this.layering[e]];o[n]=t,o[i]=e,this.X[e]=i,this.X[t]=n,this.UpdateSsContainingUv(e,t),this.UpdatePsContainingUv(e,t)}UpdatePsContainingUv(e,t){if(this.successors[e].length<=this.successors[t].length)for(const n of this.successors[e]){const i=this.pOrder[n];if(i.has(t)){const s=i.get(t),o=this.predecessors[n];o[s-1]=t,o[s]=e,i.set(t,s-1),i.set(e,s)}}else for(const n of this.successors[t]){const i=this.pOrder[n];if(i.has(e)){const s=i.get(t),o=this.predecessors[n];o[s-1]=t,o[s]=e,i.set(t,s-1),i.set(e,s)}}}UpdateSsContainingUv(e,t){if(this.predecessors[e].length<=this.predecessors[t].length)for(const n of this.predecessors[e]){const i=this.sOrder[n];if(i.has(t)){const s=i.get(t),o=this.successors[n];o[s-1]=t,o[s]=e,i.set(t,s-1),i.set(e,s)}}else for(const n of this.predecessors[t]){const i=this.sOrder[n];if(i.has(e)){const s=i.get(t),o=this.successors[n];o[s-1]=t,o[s]=e,i.set(t,s-1),i.set(e,s)}}}DisturbLayer(e){for(let t=0;t<e.length-1;t++)this.AdjacentSwapToTheRight(e,t)}ExchangeWithGainWithNoDisturbance(e){let n,t=!1;do{n=this.ExchangeWithGain(e),t=t||n}while(n);return t}ExchangeWithGain(e){for(let t=0;t<e.length-1;t++)if(this.SwapWithGain(e[t],e[t+1]))return this.SwapToTheLeft(e,t),this.SwapToTheRight(e,t+1),!0;return!1}SwapToTheLeft(e,t){for(let n=t-1;n>=0;n--)this.AdjacentSwapToTheRight(e,n)}SwapToTheRight(e,t){for(let n=t;n<e.length-1;n++)this.AdjacentSwapToTheRight(e,n)}AdjacentSwapToTheRight(e,t){const n=e[t],i=e[t+1],s=this.SwapGain(n,i);(s>0||0==s&&FS())&&this.Swap(n,i)}SwapGain(e,t){const n=this.CalcPair(e,t);return n.cuv-n.cvu}UvAreOfSameKind(e,t){return e<this.startOfVirtNodes&&t<this.startOfVirtNodes||e>=this.startOfVirtNodes&&t>=this.startOfVirtNodes}NeighborsForbidTheSwap(e,t){return this.UpperNeighborsForbidTheSwap(e,t)||this.LowerNeighborsForbidTheSwap(e,t)}LowerNeighborsForbidTheSwap(e,t){let n,i;return 0!=(n=this.properLayeredGraph.OutEdgesCount(e))&&0!=(i=this.properLayeredGraph.OutEdgesCount(t))&&this.X[this.successors[e][n>>1]]<this.X[this.successors[t][i>>1]]}UpperNeighborsForbidTheSwap(e,t){const n=this.properLayeredGraph.InEdgesCount(e),i=this.properLayeredGraph.InEdgesCount(t);return 0!=n&&0!=i&&this.X[this.predecessors[e][n>>1]]<this.X[this.predecessors[t][i>>1]]}CalcDeltaBetweenGroupsToTheLeftAndToTheRightOfTheSeparator(e,t,n){const i=this.GetKindDelegate(n);let s=0;for(let a=t-1;a>=0&&!i(e[a]);a--)s++;let o=0;for(let a=t+1;a<e.length&&!i(e[a]);a++)o++;return s-o}IsOriginal(e){return e<this.startOfVirtNodes}IsVirtual(e){return e>=this.startOfVirtNodes}GetKindDelegate(e){return this.IsVirtual(e)?this.IsVirtual:this.IsOriginal}SwapWithGain(e,t){return this.SwapGain(e,t)>0&&(this.Swap(e,t),!0)}}class Vs{constructor(){this.size_=0,this.mapOfMaps=new Map}deleteP(e){return this.delete(e.x,e.y)}clear(){this.mapOfMaps.clear(),this.size_=0}get size(){return this.size_}setxy(e,t,n){let i=this.mapOfMaps.get(e);null==i&&this.mapOfMaps.set(e,i=new Map),i.has(t)||this.size_++,i.set(t,n)}set(e,t){this.setxy(e.x,e.y,t)}delete(e,t){const n=this.mapOfMaps.get(e);return null!=n&&(n.delete(t)&&this.size_--,!0)}hasxy(e,t){const n=this.mapOfMaps.get(e);return null!=n&&n.has(t)}has(e){return this.hasxy(e.x,e.y)}getxy(e,t){const n=this.mapOfMaps.get(e);if(null!=n)return n.get(t)}get(e){return this.getxy(e.x,e.y)}*keys(){for(const e of this.mapOfMaps)for(const t of e[1])yield new k(e[0],t[0])}*[Symbol.iterator](){for(const e of this.mapOfMaps)for(const t of e[1])yield[new k(e[0],t[0]),t[1]]}*values(){for(const e of this.mapOfMaps)for(const t of e[1])yield t[1]}}class BS{constructor(e,t,n){this.properLayeredGraph=e,this.layerArrays=t,this.nodePositions=n}static UpdateLayerArrays0(e,t,n){new BS(e,t,n).UpdateLayerArrays()}static UpdateLayerArrays1(e,t){const n=BS.BuildInitialNodePositions(e,t);this.UpdateLayerArrays0(e,t,n)}static BuildInitialNodePositions(e,t){const n=new Map;for(let i=0;i<t.Layers.length;i++){let s=0,o=0;for(;s<t.Layers[i].length;){for(;s<t.Layers[i].length&&e.IsVirtualNode(t.Layers[i][s]);)s++;for(let a=o;a<s;a++)n.set(t.Layers[i][a],new k(i,o));s<t.Layers[i].length&&n.set(t.Layers[i][s],new k(i,s)),s++,o=s}}return n}UpdateLayerArrays(){let e=this.CreateInitialOrdering();e=this.BuildOrdering(e),this.RestoreLayerArrays(e)}CreateInitialOrdering(){const e=new Vs;for(const t of this.layerArrays.Layers)for(const n of t){const i=this.nodePositions.get(n);e.hasxy(i.x,i.y)||e.setxy(i.x,i.y,[]),e.getxy(i.x,i.y).push(n)}return e}BuildOrdering(e){const t=new Vs,n=new Map;for(const i of this.layerArrays.Layers)for(const s of i){const o=this.nodePositions.get(s);t.hasxy(o.x,o.y)||(this.BuildNodeOrdering(e.get(o),n),t.set(o,e.get(o)))}return t}BuildNodeOrdering(e,t){e.sort(this.Comparison(t));for(let n=0;n<e.length;n++)t.set(e[n],n)}firstSucc(e){for(const t of this.properLayeredGraph.Succ(e))return t}firstPred(e){for(const t of this.properLayeredGraph.Pred(e))return t}Comparison(e){return(t,n)=>{const i=this.firstSucc(t),s=this.firstSucc(n);let o=this.firstPred(t),a=this.firstPred(n);const l=this.nodePositions.get(i),c=this.nodePositions.get(s),d=this.nodePositions.get(o),b=this.nodePositions.get(a);if(!l.equal(c))return d.equal(b)?l.compareTo(c):d.compareTo(b);if(this.properLayeredGraph.IsVirtualNode(i))return d.equal(b)?$n(e.get(i),e.get(s)):d.compareTo(b);for(;this.nodePositions.get(o).equal(this.nodePositions.get(a))&&this.properLayeredGraph.IsVirtualNode(o);)o=this.firstPred(o),a=this.firstPred(a);return this.nodePositions.get(o).equal(this.nodePositions.get(a))?$n(t,n):this.nodePositions.get(o).compareTo(this.nodePositions.get(a))}}RestoreLayerArrays(e){for(const t of this.layerArrays.Layers){let n=0,i=0;for(;n<t.length;){for(;n<t.length&&this.nodePositions.get(t[i]).equal(this.nodePositions.get(t[n]));)n++;const s=e.get(this.nodePositions.get(t[i]));for(let o=i;o<n;o++)t[o]=s[o-i];i=n}}this.layerArrays.UpdateXFromLayers()}}class kS{static getOrder(e,t){const n=dc(t.map(([i,s])=>new fn(i,s)),e);return kS.getOrderOnGraph(n)}static getOrderOnGraph(e){const t=new Array(e.nodeCount).fill(!1),n=new cr.K,i=[];let s;for(let o=0;o<e.nodeCount;o++){if(t[o])continue;let a=o;t[a]=!0;let l=0;for(s=e.outEdges[o];;){for(;l<s.length;l++){const c=s[l].target;t[c]||(t[c]=!0,n.push({edges:s,index:l+1,current_u:a}),a=c,s=e.outEdges[a],l=-1)}if(i.push(a),!(n.length>0))break;{const c=n.pop();s=c.edges,l=c.index,a=c.current_u}}}return i.reverse()}}class jW{constructor(e){this.graph=e}GetLayers(){const e=kS.getOrderOnGraph(this.graph),t=new Array(this.graph.nodeCount).fill(0);let n=this.graph.nodeCount;for(;n-- >0;){const i=e[n];for(const s of this.graph.inEdges[i]){const o=s.source,a=t[i]+s.separation;t[o]<a&&(t[o]=a)}}return t}checkTopoOrder(e){for(const t of this.graph.edges)if(zW(t,e))return!1;return!0}}function zW(r,e){const t=e.findIndex(i=>i==r.source),n=e.findIndex(i=>i==r.target);return-1==t||-1==n||t>=n}class Hs{constructor(e){this.inTree=!1,this.cut=Hs.infinity,this.iedge=e}get source(){return this.iedge.source}get target(){return this.iedge.target}get separation(){return this.iedge.separation}get crossingWeight(){return this.iedge.CrossingWeight}get weight(){return this.iedge.weight}}Hs.infinity=Number.MAX_SAFE_INTEGER;class fT{constructor(e,t,n,i,s){this.v=e,this.outEnum=t,this.i=n,this.inEnum=i,this.j=s}}class tL{constructor(e,t){this.layers=null,this.treeVertices=[],this.vertices=[],this.leaves=[],this.graph=function $W(r){const e=new Array;for(const t of r.edges)e.push(new Hs(t));return dc(e,r.nodeCount)}(e),this.networkCancelToken=t;for(let n=0;n<this.graph.nodeCount;n++)this.vertices.push({inTree:!1,lim:-1,low:-1,parent:null})}get weight(){return this.graph.edges.map(e=>e.weight*(this.layers[e.source]-this.layers[e.target])).reduce((e,t)=>e+t,0)}get nodeCount(){return this.vertices.length}setLow(e,t){this.vertices[e].low=t}setLim(e,t){this.vertices[e].lim=t}setParent(e,t){this.vertices[e].parent=t}GetLayers(){return null==this.layers&&this.run(),this.layers}shiftLayerToZero(){const e=Math.min(...this.layers);for(let t=0;t<this.layers.length;t++)this.layers[t]-=e}addVertexToTree(e){this.vertices[e].inTree=!0}vertexInTree(e){return this.vertices[e].inTree}lim(e){return this.vertices[e].lim}low(e){return this.vertices[e].low}parent(e){return this.vertices[e].parent}feasibleTree(){for(this.initLayers();this.tightTree()<this.nodeCount;){const e=this.getNonTreeEdgeIncidentToTheTreeWithMinimalAmountOfSlack();if(null==e)break;let t=this.slack(e);this.vertexInTree(e.source)&&(t=-t);for(const n of this.treeVertices)this.layers[n]+=t}this.initCutValues()}vertexSourceTargetVal(e,t){const n=t.source,i=t.target;return this.lim(n)>this.lim(i)?this.lim(e)<=this.lim(i)&&this.low(i)<=this.lim(e)?0:1:this.lim(e)<=this.lim(n)&&this.low(n)<=this.lim(e)?1:0}incidentEdges(e){return this.graph.incidentEdges(e)}allLowCutsHaveBeenDone(e){for(const t of this.incidentEdges(e))if(t.inTree&&t.cut==Hs.infinity&&t!=this.parent(e))return!1;return!0}edgeSourceTargetVal(e,t){return this.vertexSourceTargetVal(e.source,t)-this.vertexSourceTargetVal(e.target,t)}initCutValues(){this.initLimLowAndParent();let e=new cr.K;for(const n of this.leaves)e.push(n);let t=new cr.K;for(;e.length>0;){for(;e.length>0;){const i=e.pop(),s=this.parent(i);if(null==s)continue;let o=0;for(const l of this.incidentEdges(i))if(0==l.inTree){const c=this.edgeSourceTargetVal(l,s);0!=c&&(o+=c*l.weight)}else if(l==s)o+=l.weight;else{const c=s.source==l.target||s.target==l.source?1:-1;o+=this.edgeContribution(l,i)*c}s.cut=o;const a=s.source==i?s.target:s.source;this.allLowCutsHaveBeenDone(a)&&t.push(a)}const n=e;e=t,t=n}}edgeContribution(e,t){let n=e.cut-e.weight;for(const i of this.incidentEdges(t))if(0==i.inTree){const s=this.edgeSourceTargetVal(i,e);-1==s?n+=i.weight:1==s&&(n-=i.weight)}return n}initLimLowAndParent(){this.initLowLimParentAndLeavesOnSubtree(1,0)}initLowLimParentAndLeavesOnSubtree(e,t){const n=new cr.K;let i=this.graph.outEdges[t],s=-1,o=this.graph.inEdges[t],a=-1;for(n.push(new fT(t,i,s,o,a)),this.vertices[t].low=e;n.length>0;){const l=n.pop();let c;t=l.v,i=l.outEnum,s=l.i,o=l.inEnum,a=l.j;do{for(c=!0;++s<i.length;){const d=i[s];!d.inTree||this.vertices[d.target].low>0||(n.push(new fT(t,i,s,o,a)),this.setParent(t=d.target,d),this.setLow(t,e),i=this.graph.outEdges[t],s=-1,o=this.graph.inEdges[t],a=-1)}for(;++a<o.length;){const d=o[a];if(d.inTree&&!(this.vertices[d.source].low>0)){n.push(new fT(t,i,s,o,a)),this.setLow(t=d.source,e),this.setParent(t,d),i=this.graph.outEdges[t],s=-1,o=this.graph.inEdges[t],a=-1,c=!1;break}}}while(!c);this.setLim(t,e++),this.lim(t)==this.low(t)&&this.leaves.push(t)}}updateLimLowLeavesAndParentsUnderNode(e){const t=this.vertices[e].low,n=this.vertices[e].lim;this.leaves=[];for(let i=0;i<this.nodeCount;i++)t<=this.vertices[i].lim&&this.vertices[i].lim<=n?this.setLow(i,0):this.low(i)==this.lim(i)&&this.leaves.push(i);this.initLowLimParentAndLeavesOnSubtree(t,e)}slack(e){return this.layers[e.source]-this.layers[e.target]-e.separation}getNonTreeEdgeIncidentToTheTreeWithMinimalAmountOfSlack(){let e=null,t=Hs.infinity;for(const n of this.treeVertices){for(const i of this.graph.outEdges[n]){if(this.vertexInTree(i.source)&&this.vertexInTree(i.target))continue;const s=this.slack(i);if(s<t&&(e=i,t=s,1==s))return i}for(const i of this.graph.inEdges[n]){if(this.vertexInTree(i.source)&&this.vertexInTree(i.target))continue;const s=this.slack(i);if(s<t&&(e=i,t=s,1==s))return i}}return e}tightTree(){this.treeVertices=[];for(const t of this.graph.edges)t.inTree=!1;for(let t=1;t<this.nodeCount;t++)this.vertices[t].inTree=!1;this.vertices[0].inTree=!0,this.treeVertices.push(0);const e=new cr.K;for(e.push(0);e.length>0;){const t=e.pop();for(const n of this.graph.outEdges[t])this.vertexInTree(n.target)||this.layers[n.source]-this.layers[n.target]==n.separation&&(e.push(n.target),this.addVertexToTree(n.target),this.treeVertices.push(n.target),n.inTree=!0);for(const n of this.graph.inEdges[t])this.vertexInTree(n.source)||this.layers[n.source]-this.layers[n.target]==n.separation&&(e.push(n.source),this.addVertexToTree(n.source),this.treeVertices.push(n.source),n.inTree=!0)}return this.treeVertices.length}leaveEnterEdge(){let e,t,n=0;for(const o of this.graph.edges)o.inTree&&o.cut<n&&(n=o.cut,e=o);if(null==e)return null;let i=!1,s=Hs.infinity;for(const o of this.graph.edges){const a=this.slack(o);if(0==o.inTree&&-1==this.edgeSourceTargetVal(o,e)&&(a<s||a==s&&(i=1==Ty(2)))){if(s=a,t=o,0==s&&!i)break;i=!1}}if(null==t)throw new Error;return{leaving:e,entering:t}}exchange(e,t){const n=this.commonPredecessorOfSourceAndTargetOfF(t);this.createPathForCutUpdates(e,t,n),this.updateLimLowLeavesAndParentsUnderNode(n),this.updateCuts(e),this.updateLayersUnderNode(n)}updateLayersUnderNode(e){const t=new cr.K;t.push(e);for(let n=0;n<this.nodeCount;n++)this.low(e)<=this.lim(n)&&this.lim(n)<=this.lim(e)&&n!=e&&(this.layers[n]=Hs.infinity);for(;t.length>0;){const n=t.pop();for(const i of this.graph.outEdges[n])i.inTree&&this.layers[i.target]==Hs.infinity&&(this.layers[i.target]=this.layers[n]-i.separation,t.push(i.target));for(const i of this.graph.inEdges[n])i.inTree&&this.layers[i.source]==Hs.infinity&&(this.layers[i.source]=this.layers[n]+i.separation,t.push(i.source))}}updateCuts(e){let t=new cr.K,n=new cr.K;for(t.push(e.source),t.push(e.target);t.length>0;){for(;t.length>0;){const s=t.pop(),o=this.parent(s);if(null==o||o.cut!=Hs.infinity)continue;let a=0;for(const c of this.incidentEdges(s))if(0==c.inTree)a+=this.edgeSourceTargetVal(c,o)*c.weight;else if(c==o)a+=c.weight;else{const d=o.source==c.target||o.target==c.source?1:-1;a+=this.edgeContribution(c,s)*d}o.cut=a;const l=o.source==s?o.target:o.source;this.allLowCutsHaveBeenDone(l)&&n.push(l)}const i=t;t=n,n=i}}createPathForCutUpdates(e,t,n){let i=t.target;for(;i!=n;){const s=this.parent(i);s.cut=Hs.infinity,i=s.source==i?s.target:s.source}t.cut=Hs.infinity,e.inTree=!1,t.inTree=!0}commonPredecessorOfSourceAndTargetOfF(e){let t,n;this.lim(e.source)<this.lim(e.target)?(t=this.lim(e.source),n=this.lim(e.target)):(t=this.lim(e.target),n=this.lim(e.source));let i=e.source;for(;!(this.low(i)<=t&&n<=this.lim(i));){const s=this.parent(i);s.cut=Hs.infinity,i=s.source==i?s.target:s.source}return i}checkCutValues(){for(const e of this.graph.edges)if(e.inTree){let t=0;for(const n of this.graph.edges)t+=this.edgeSourceTargetVal(n,e)*n.weight;e.cut!=t&&console.log(pi.String.Format("cuts are wrong for {0}; should be {1} but is {2}",e,t,e.cut))}}initLayers(){const e=new jW(this.graph);return this.layers=e.GetLayers()}run(){if(0==this.graph.edges.length&&0==this.graph.nodeCount)this.layers=[];else{let e;for(this.feasibleTree();null!=(e=this.leaveEnterEdge());)this.exchange(e.leaving,e.entering);this.shiftLayerToZero()}}}class KW{constructor(e,t){this.graph=e,this.Cancel=t}GetLayers(){return new tL(this.graph,this.Cancel).GetLayers()}ShrunkComponent(e){const t=[];for(const n of e){const i=n[0],s=n[1];for(const o of this.graph.outEdges[i]){const a=new La(s,e.get(o.target),o.edge);a.separation=o.separation,a.weight=o.weight,t.push(a)}}return new Cy(t,e.size)}}class lo{constructor(e){this.padding=0,this.alreadySitsOnASpline=!1,this.labelIsToTheLeftOfTheSpline=!1,this.labelIsToTheRightOfTheSpline=!1,this.labelCornersPreserveCoefficient=e}toString(){return"la:ra "+this.la+" "+this.ra+" ta:ba "+this.ta+" "+this.ba+" x:y "+this.x_+" "+this.y_}get leftAnchor(){return this.la}set leftAnchor(e){this.la=Math.max(e,0)}get rightAnchor(){return this.ra}set rightAnchor(e){this.ra=Math.max(e,0)}get topAnchor(){return this.ta}set topAnchor(e){this.ta=Math.max(e,0)}get bottomAnchor(){return this.ba}set bottomAnchor(e){this.ba=Math.max(e,0)}get left(){return this.x_-this.la}get right(){return this.x_+this.ra}get top(){return this.y_+this.ta}set top(e){this.y_+=e-this.ta}get bottom(){return this.y_-this.ba}set bottom(e){this.y_+=e-this.ba}get leftTop(){return new k(this.left,this.top)}get leftBottom(){return new k(this.left,this.bottom)}get rightBottom(){return new k(this.right,this.bottom)}get node(){return this.node_}set node(e){this.node_=e,this.polygonalBoundary_=null}get rightTop(){return new k(this.right,this.top)}static mkAnchor(e,t,n,i,s,o){const a=new lo(o);return a.la=e,a.ra=t,a.ta=n,a.ba=i,a.node=s,a}get x(){return this.x_}set x(e){this.polygonalBoundary_=null,this.x_=e}get y(){return this.y_}set y(e){this.polygonalBoundary_=null,this.y_=e}get origin(){return new k(this.x,this.y)}get width(){return this.la+this.ra}get height(){return this.ta+this.ba}get hasLabel(){return this.labelIsToTheLeftOfTheSpline||this.labelIsToTheLeftOfTheSpline}get LabelWidth(){if(this.labelIsToTheLeftOfTheSpline)return this.leftAnchor;if(this.labelIsToTheRightOfTheSpline)return this.rightAnchor;throw new Error}get polygonalBoundary(){return null!=this.polygonalBoundary_?this.polygonalBoundary_:this.polygonalBoundary_=lo.pad(this.creatPolygonalBoundaryWithoutPadding(),this.padding)}static pad(e,t){return 0==t?e:lo.curveIsConvex(e)?lo.padConvexCurve(e,t):lo.padConvexCurve(e.boundingBox.perimeter(),t)}static padCorner(e,t,n,i,s){const o=lo.getPaddedCorner(t,n,i,s);e.addPoint(o.a),2==o.numberOfPoints&&e.addPoint(o.b)}static padConvexCurve(e,t){const n=new At;lo.padCorner(n,e.endPoint.prev,e.endPoint,e.startPoint,t),lo.padCorner(n,e.endPoint,e.startPoint,e.startPoint.next,t);for(let i=e.startPoint;null!=i.next.next;i=i.next)lo.padCorner(n,i,i.next,i.next.next,t);return n.closed=!0,n}static getPaddedCorner(e,t,n,i){const s=e.point,o=t.point,a=n.point,l=k.getTriangleOrientation(s,o,a)==nt.Counterclockwise,c=o.sub(s),d=c.rotate((l?-Math.PI:Math.PI)/2).normalize(),b=c.normalize().add(o.sub(a).normalize());if(b.length<le.intersectionEpsilon)return{a:o.add(d.mul(i)),b:null,numberOfPoints:1};const N=b.normalize().mul(i),F=N.rotate(Math.PI/2),G=(i-N.dot(d))/F.dot(d);return{a:N.add(F.mul(G)).add(o),b:N.sub(F.mul(G)).add(o),numberOfPoints:2}}static*orientations(e){yield k.getTriangleOrientation(e.endPoint.point,e.startPoint.point,e.startPoint.next.point),yield k.getTriangleOrientation(e.endPoint.prev.point,e.endPoint.point,e.startPoint.point);let t=e.startPoint;for(;null!=t.next.next;)yield k.getTriangleOrientation(t.point,t.next.point,t.next.next.point),t=t.next}static curveIsConvex(e){let t=nt.Collinear;for(const n of lo.orientations(e))if(n!=nt.Collinear)if(t==nt.Collinear)t=n;else if(n!=t)return!1;return!0}creatPolygonalBoundaryWithoutPadding(){return this.hasLabel?this.labelIsToTheLeftOfTheSpline?this.polygonOnLeftLabel():this.polygonOnRightLabel():null==this.nodeBoundary?this.standardRectBoundary():fe.polylineAroundClosedCurve(this.nodeBoundary)}get nodeBoundary(){return null==this.node?null:this.node.boundaryCurve}standardRectBoundary(){const e=new At;return e.addPoint(this.leftTop),e.addPoint(this.rightTop),e.addPoint(this.rightBottom),e.addPoint(this.leftBottom),e.closed=!0,e}polygonOnLeftLabel(){const e=this.left+(1-this.labelCornersPreserveCoefficient)*this.LabelWidth;return At.mkClosedFromPoints([new k(e,this.top),this.rightTop,this.rightBottom,new k(e,this.bottom),new k(this.left,this.y)])}polygonOnRightLabel(){const e=this.right-(1-this.labelCornersPreserveCoefficient)*this.LabelWidth;return At.mkClosedFromPoints([new k(e,this.top),new k(this.right,this.y),new k(e,this.bottom),this.leftBottom,this.leftTop])}move(e){this.x+=e.x,this.y+=e.y}}let JW=(()=>{class r{constructor(t,n,i,s,o){this.xCoords=new Array(4),this.la=t,this.graph=n,this.nOfOriginalVertices=i,this.nOfVertices=this.graph.NodeCount,this.markedEdges=new Ma,this.h=this.la.Layers.length,this.root=new Array(this.nOfVertices),this.align=new Array(this.nOfVertices),this.anchors=s,this.nodeSep=o}get CurrentEnumRightUp(){return(this.LR?0:1)+2*(this.BT?0:1)}IsVirtual(t){return t>=this.nOfOriginalVertices}Source(t){return this.BT?t.Source:t.Target}Target(t){return this.BT?t.Target:t.Source}static CalculateXCoordinates(t,n,i,s,o){new r(t,n,i,s,o).Calculate()}Calculate(){this.SortInAndOutEdges(),this.RightUpSetup(),this.CalcBiasedAlignment(),this.LeftUpSetup(),this.CalcBiasedAlignment(),this.RightDownSetup(),this.CalcBiasedAlignment(),this.LeftDownSetup(),this.CalcBiasedAlignment(),this.HorizontalBalancing()}SortInAndOutEdges(){this.FillLowMedians(),this.FillUpperMedins()}FillUpperMedins(){this.upperMedians=new Array(this.graph.NodeCount);for(let t=0;t<this.graph.NodeCount;t++)this.FillUpperMediansForNode(t)}CompareByX(t,n){return this.la.x[t]-this.la.x[n]}FillUpperMediansForNode(t){let n=this.graph.InEdgesCount(t);if(n>0){const i=new Array(n);n=0;for(const o of this.graph.InEdges(t))i[n++]=o.Source;i.sort((o,a)=>this.CompareByX(o,a));const s=Math.floor(n/2);this.upperMedians[t]=2*s==n?new fn(i[s-1],i[s]):i[s]}else this.upperMedians[t]=-1}FillLowMedians(){this.lowMedians=new Array(this.graph.NodeCount);for(let t=0;t<this.graph.NodeCount;t++)this.FillLowMediansForNode(t)}FillLowMediansForNode(t){let n=this.graph.OutEdgesCount(t);if(n>0){const i=new Array(n);n=0;for(const o of this.graph.OutEdges(t))i[n++]=o.Target;i.sort((o,a)=>this.CompareByX(o,a));const s=Math.floor(n/2);this.lowMedians[t]=2*s==n?new fn(i[s-1],i[s]):i[s]}else this.lowMedians[t]=-1}HorizontalBalancing(){let t=-1;const n=new Array(4),i=new Array(4);let s=Number.MAX_VALUE;for(let a=0;a<4;a++){const l={a:0,b:0};this.AssignmentBounds(a,l),n[a]=l.a,i[a]=l.b;const c=i[a]-n[a];c<s&&(t=a,s=c)}for(let a=0;a<4;a++){let l;if(l=r.IsLeftMostAssignment(a)?n[t]-n[a]:i[t]-i[a],this.x=this.xCoords[a],0!=l)for(let c=0;c<this.nOfVertices;c++)this.x[c]=this.x[c]+l}const o=new Array(4);for(let a=0;a<this.nOfVertices;a++)o[0]=this.xCoords[0][a],o[1]=this.xCoords[1][a],o[2]=this.xCoords[2][a],o[3]=this.xCoords[3][a],o.sort((l,c)=>l-c),this.anchors[a].x=(o[1]+o[2])/2}static IsLeftMostAssignment(t){return 0==t||2==t}AssignmentBounds(t,n){if(0==this.nOfVertices)n.a=0,n.b=0;else{this.x=this.xCoords[t],n.a=n.b=this.x[0];for(let i=1;i<this.nOfVertices;i++){const s=this.x[i];s<n.a?n.a=s:s>n.b&&(n.b=s)}}}CalcBiasedAlignment(){this.ConflictElimination(),this.Align()}LeftUpSetup(){this.LR=!1,this.BT=!0}LeftDownSetup(){this.LR=!1,this.BT=!1}RightDownSetup(){this.LR=!0,this.BT=!1}RightUpSetup(){this.LR=!0,this.BT=!0}ConflictElimination(){this.RemoveMarksFromEdges(),this.MarkConflictingEdges()}*UpperEdgeMedians(t){const n=this.BT?this.upperMedians[t]:this.lowMedians[t];if("number"!=typeof n){const s=n;this.LR?(yield s.x,yield s.y):(yield s.y,yield s.x)}else{const s=n;s>=0&&(yield s)}}MarkConflictingEdges(){let t=this.LowerOf(0,this.h-1);const n=t,i=this.UpperOf(0,this.h-1),s=this.NextLower(i);for(;this.IsBelow(t,i);t=this.NextUpper(t))this.IsBelow(n,t)&&this.IsBelow(t,s)&&this.ConflictsWithAtLeastOneInnerEdgeForALayer(t)}NextUpper(t){return this.BT?t+1:t-1}NextLower(t){return this.BT?t-1:t+1}UpperOf(t,n){return this.BT?Math.max(t,n):Math.min(t,n)}LowerOf(t,n){return this.BT?Math.min(t,n):Math.max(t,n)}IsBelow(t,n){return this.BT?t<n:n<t}LeftMost(t,n){return this.LR?Math.min(t,n):Math.max(t,n)}RightMost(t,n){return this.LR?Math.max(t,n):Math.min(t,n)}IsNotRightFrom(t,n){return this.LR?t<=n:n<=t}IsLeftFrom(t,n){return this.LR?t<n:n<t}NextRight(t){return this.LR?t+1:t-1}NextLeft(t){return this.LR?t-1:t+1}ConflictsWithAtLeastOneInnerEdgeForALayer(t){if(t>=0&&t<this.la.Layers.length){const n=this.la.Layers[t];let i=null,s=this.LeftMost(0,n.length-1);const o=this.RightMost(0,n.length-1);for(;this.IsNotRightFrom(s,o)&&null==i;s=this.NextRight(s))i=this.InnerEdgeByTarget(n[s]);if(null!=i){const a=this.Pos(this.Source(i));for(let c=this.LeftMost(0,n.length-1);this.IsLeftFrom(c,s);c=this.NextRight(c))for(const d of this.InEdges(n[c]))this.IsLeftFrom(a,this.Pos(this.Source(d)))&&this.MarkEdge(d);let l=this.Pos(this.Source(i));for(;this.IsNotRightFrom(s,o);){const c=this.AlignmentToTheRightOfInner(n,s,a);if(s=this.NextRight(s),null!=c){const d=this.Pos(this.Source(c));this.MarkEdgesBetweenInnerAndNewInnerEdges(n,i,c,l,d),i=c,l=d}}for(let c=this.NextRight(this.Pos(this.Target(i)));this.IsNotRightFrom(c,o);c=this.NextRight(c))for(const d of this.InEdges(n[c]))this.IsLeftFrom(this.Pos(this.Source(d)),this.Pos(this.Source(i)))&&this.MarkEdge(d)}}}InEdgeOfVirtualNode(t){return this.BT?this.graph.InEdgeOfVirtualNode(t):this.graph.OutEdgeOfVirtualNode(t)}InEdges(t){return this.BT?this.graph.InEdges(t):this.graph.OutEdges(t)}MarkEdgesBetweenInnerAndNewInnerEdges(t,n,i,s,o){let a=this.NextRight(this.Pos(this.Target(n)));for(;this.IsLeftFrom(a,this.Pos(this.Target(i)));a=this.NextRight(a))for(const l of this.InEdges(t[a])){const c=this.Pos(this.Source(l));(this.IsLeftFrom(c,s)||this.IsLeftFrom(o,c))&&this.MarkEdge(l)}}AlignmentToTheRightOfInner(t,n,i){if(1==this.NumberOfInEdges(t[n])){let o=null;for(const a of this.InEdges(t[n]))o=a;return this.IsInnerEdge(o)&&this.IsLeftFrom(i,this.Pos(o.Source))?o:null}return null}NumberOfInEdges(t){return this.BT?this.graph.InEdgesCount(t):this.graph.OutEdgesCount(t)}Pos(t){return this.la.x[t]}InnerEdgeByTarget(t){if(this.IsVirtual(t)){const n=this.InEdgeOfVirtualNode(t);if(this.IsVirtual(this.Source(n)))return n}return null}IsInnerEdge(t){return this.IsVirtual(t.Source)&&this.IsVirtual(t.Target)}RemoveMarksFromEdges(){this.markedEdges.clear()}Align(){this.CreateBlocks(),this.AssignCoordinatesByLongestPath()}AssignCoordinatesByLongestPath(){this.x=this.xCoords[this.CurrentEnumRightUp]=new Array(this.nOfVertices);const t=new Array;for(let s=0;s<this.nOfVertices;s++)if(s==this.root[s]){let o=s;do{const a={neighbor:0};this.TryToGetRightNeighbor(o,a)&&t.push(new La(s,this.root[a.neighbor],null)),o=this.align[o]}while(o!=s)}const n=dc(t,this.nOfVertices),i=kS.getOrderOnGraph(n);for(const s of i)if(s==this.root[s]){let o=0,a=!0,l=s;do{const c={neighbor:0};this.TryToGetLeftNeighbor(l,c)&&(a?(o=this.x[this.root[c.neighbor]]+this.DeltaBetweenVertices(c.neighbor,l),a=!1):o=this.RightMost(o,this.x[this.root[c.neighbor]]+this.DeltaBetweenVertices(c.neighbor,l))),l=this.align[l]}while(l!=s);this.x[s]=o}for(const s of i)if(s==this.root[s]&&0==n.inEdges[s].length){let o=s,a=this.RightMost(-r.infinity,r.infinity);const l=a;do{const c={neighbor:0};this.TryToGetRightNeighbor(o,c)&&(a=this.LeftMost(a,this.x[this.root[c.neighbor]]-this.DeltaBetweenVertices(o,c.neighbor))),o=this.align[o]}while(o!=s);l!=a&&(this.x[s]=a)}for(let s=0;s<this.nOfVertices;s++)s!=this.root[s]&&(this.x[s]=this.x[this.root[s]])}TryToGetRightNeighbor(t,n){const i=this.NextRight(this.Pos(t)),s=this.la.Layers[this.la.y[t]];return i>=0&&i<s.length&&(n.neighbor=s[i],!0)}TryToGetLeftNeighbor(t,n){const i=this.NextLeft(this.Pos(t)),s=this.la.Layers[this.la.y[t]];return i>=0&&i<s.length&&(n.neighbor=s[i],!0)}CreateBlocks(){for(let n=0;n<this.nOfVertices;n++)this.root[n]=this.align[n]=n;const t=this.LowerOf(0,this.h-1);for(let n=this.NextLower(this.UpperOf(0,this.h-1));!this.IsBelow(n,t);n=this.NextLower(n)){const i=this.la.Layers[n];let s=this.LeftMost(-1,this.la.Layers[this.NextUpper(n)].length);const o=this.RightMost(0,i.length-1);for(let a=this.LeftMost(0,i.length-1);this.IsNotRightFrom(a,o);a=this.NextRight(a)){const l=i[a];for(const c of this.UpperEdgeMedians(l))if(!this.IsMarked(l,c)&&this.IsLeftFrom(s,this.Pos(c))){this.align[c]=l,this.root[l]=this.root[c],this.align[l]=this.root[c],s=this.Pos(c);break}}}}IsMarked(t,n){return this.BT?this.markedEdges.hasxy(n,t):this.markedEdges.hasxy(t,n)}MarkEdge(t){this.markedEdges.addNN(t.Source,t.Target)}DeltaBetweenVertices(t,n){let i;if(this.Pos(t)>this.Pos(n)){const s=t;t=n,n=s,i=-1}else i=1;return(this.anchors[t].rightAnchor+this.anchors[n].leftAnchor+this.nodeSep)*i}}return r.infinity=1e7,r})();class qW extends ps{constructor(e,t,n,i,s){super(),this.weightMultiplierOfOriginalOriginal=1,this.weightMultOfOneVirtual=3,this.weightMultiplierOfTwoVirtual=8,this.SetEdges(i,s),this.virtualVerticesStart=e.nodeCount,this.virtualVerticesEnd=t.NodeCount-1,this.layeredGraph=t,this.layerArrays=n}EdgeWeightMultiplier(e){const t=e.source,n=e.target;if(t<this.layeredGraph.NodeCount&&this.layerArrays.y[t]==this.layerArrays.y[n]&&this.layerArrays.x[t]==this.layerArrays.x[n]+1)return 0;let i=0,s=-1,o=-1;for(const l of this.outEdges[t])-1==o?o=l.target:s=l.target;return o>=this.virtualVerticesStart&&o<=this.virtualVerticesEnd&&i++,s>=this.virtualVerticesStart&&s<=this.virtualVerticesEnd&&i++,0==i?this.weightMultiplierOfOriginalOriginal:1==i?this.weightMultOfOneVirtual:this.weightMultiplierOfTwoVirtual}SetEdgeWeights(){for(const e of this.edges)e.weight=e.weight*this.EdgeWeightMultiplier(e)}}var mi=(()=>{return(r=mi||(mi={}))[r.Top=0]="Top",r[r.Internal=1]="Internal",r[r.Bottom=2]="Bottom",mi;var r})();class rg{constructor(e,t){this.groupSplitThreshold=2,this.initialNodes=e,this.groupSplitThreshold=t}static Calculate(e,t=0){return new rg(e,t).Calculate()}Calculate(){return this.Calc(this.initialNodes)}Calc(e){if(0==e.length)return null;if(1==e.length)return e[0];const t=e[0].parallelogram;let s,n=1,i=gn.parallelogramOfTwo(t,e[n].parallelogram).area;for(let d=2;d<e.length;d++){const b=gn.parallelogramOfTwo(t,e[d].parallelogram).area;b>i&&(n=d,i=b)}for(let d=0;d<e.length;d++)if(d!=n){s=d;break}i=gn.parallelogramOfTwo(e[n].parallelogram,e[s].parallelogram).area;for(let d=0;d<e.length;d++){if(d==n)continue;const b=gn.parallelogramOfTwo(e[n].parallelogram,e[d].parallelogram).area;b>i&&(s=d,i=b)}const o=new Array,a=new Array;o.push(e[n]),a.push(e[s]);let l=e[n].parallelogram,c=e[s].parallelogram;for(let d=0;d<e.length;d++){if(d==n||d==s)continue;const b=gn.parallelogramOfTwo(l,e[d].parallelogram),N=b.area-l.area,F=gn.parallelogramOfTwo(c,e[d].parallelogram),G=F.area-c.area;o.length*this.groupSplitThreshold<a.length?(o.push(e[d]),l=b):a.length*this.groupSplitThreshold<o.length?(a.push(e[d]),c=F):N<G?(o.push(e[d]),l=b):(a.push(e[d]),c=F)}return{parallelogram:gn.parallelogramOfTwo(l,c),node:{children:[this.Calc(o),this.Calc(a)]},seg:void 0,leafBoxesOffset:void 0}}}class co{constructor(e,t,n,i,s,o,a,l){this.topNode=e,this.bottomNode=t,this.topSite=n,this.bottomSite=n.next,this.currentTopSite=n,this.currentBottomSite=n.next,this.layerArrays=i,this.layeredGraph=s,this.originalGraph=o,this.anchors=a,this.layerSeparation=l}static Refine(e,t,n,i,s,o,a,l){new co(e,t,n,s,o,a,i,l).Refine()}Refine(){for(this.Init();this.InsertSites(););}FixCorner(e,t,n){if(e.equal(t))return t;const i=k.ClosestPointAtLineSegment(t,e,n);let s=t.sub(i);const o=Math.abs(s.y),a=this.layerSeparation/2;return o>a&&(s=s.mul(a/(2*o))),s.add(t)}InsertSites(){return 0==Ty(2)?this.CalculateNewTopSite()||this.CalculateNewBottomSite():this.CalculateNewBottomSite()||this.CalculateNewTopSite()}CalculateNewBottomSite(){const e=this.currentBottomSite.point.sub(this.currentTopSite.point);let n,t=co.absCotan(e),i=!1;for(const s of this.bottomCorners()){const o=co.absCotan(s.sub(this.currentBottomSite.point));o<t&&(t=o,n=s,i=!0)}return!!i&&!an(t,co.absCotan(e))&&(this.currentBottomSite=lr.mkSiteSPS(this.currentTopSite,this.FixCorner(this.currentTopSite.point,n,this.currentBottomSite.point),this.currentBottomSite),!0)}static absCotan(e){return Math.abs(e.x/e.y)}CalculateNewTopSite(){const e=this.currentBottomSite.point.sub(this.currentTopSite.point);let n,t=co.absCotan(e),i=!1;for(const s of this.topCorners()){const o=co.absCotan(s.sub(this.currentTopSite.point));o<t&&(t=o,n=s,i=!0)}return!!i&&!an(t,co.absCotan(e))&&(this.currentTopSite=lr.mkSiteSPS(this.currentTopSite,this.FixCorner(this.currentTopSite.point,n,this.currentBottomSite.point),this.currentBottomSite),!0)}Init(){this.IsTopToTheLeftOfBottom()?(this.topCorners=()=>this.CornersToTheRightOfTop(),this.bottomCorners=()=>this.CornersToTheLeftOfBottom()):(this.topCorners=()=>this.CornersToTheLeftOfTop(),this.bottomCorners=()=>this.CornersToTheRightOfBottom())}IsTopToTheLeftOfBottom(){return this.topSite.point.x<this.topSite.next.point.x}*NodeCorners(e){for(const t of this.anchors[e].polygonalBoundary.polylinePoints())yield t.point}*CornersToTheLeftOfBottom(){const e=this.layerArrays.x[this.bottomNode],t=this.currentTopSite.point.x,n=this.currentBottomSite.point.x;for(const i of this.LeftFromTheNode(this.NodeLayer(this.bottomNode),e,mi.Bottom,t,n))for(const s of this.NodeCorners(i))s.y>this.currentBottomSite.point.y&&co.PossibleCorner(t,n,s)&&(yield s)}*CornersToTheLeftOfTop(){const e=this.layerArrays.x[this.topNode],t=this.currentBottomSite.point.x,n=this.currentTopSite.point.x;for(const i of this.LeftFromTheNode(this.NodeLayer(this.topNode),e,mi.Top,t,n))for(const s of this.NodeCorners(i))s.y<this.currentTopSite.point.y&&co.PossibleCorner(t,n,s)&&(yield s)}*CornersToTheRightOfBottom(){const e=this.layerArrays.x[this.bottomNode],t=this.currentBottomSite.point.x,n=this.currentTopSite.point.x;for(const i of this.RightFromTheNode(this.NodeLayer(this.bottomNode),e,mi.Bottom,t,n))for(const s of this.NodeCorners(i))s.y>this.currentBottomSite.point.y&&co.PossibleCorner(t,n,s)&&(yield s)}*CornersToTheRightOfTop(){const e=this.layerArrays.x[this.topNode],t=this.currentTopSite.point.x,n=this.currentBottomSite.point.x;for(const i of this.RightFromTheNode(this.NodeLayer(this.topNode),e,mi.Top,t,n))for(const s of this.NodeCorners(i))s.y<this.currentTopSite.point.y&&co.PossibleCorner(t,n,s)&&(yield s)}static PossibleCorner(e,t,n){return n.x>e&&n.x<t}NodeLayer(e){return this.layerArrays.Layers[this.layerArrays.y[e]]}IsLabel(e){return this.anchors[e].hasLabel}NodeUCanBeCrossedByNodeV(e,t){return!this.IsLabel(e)&&!this.IsLabel(t)&&!!(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t)&&this.AdjacentEdgesIntersect(e,t))}AdjacentEdgesIntersect(e,t){return this.Intersect(this.IncomingEdge(e),this.IncomingEdge(t))||this.Intersect(this.OutcomingEdge(e),this.OutcomingEdge(t))}Intersect(e,t){return(this.layerArrays.x[e.Source]-this.layerArrays.x[t.Source])*(this.layerArrays.x[e.Target]-this.layerArrays.x[t.Target])<0}IncomingEdge(e){for(const t of this.layeredGraph.InEdges(e))return t;throw new Error}OutcomingEdge(e){for(const t of this.layeredGraph.OutEdges(e))return t;throw new Error}IsVirtualVertex(e){return e>=this.originalGraph.shallowNodeCount}*RightFromTheNode(e,t,n,i,s){let o=0,a=0;n==mi.Bottom&&(o=Number.MAX_VALUE),n==mi.Top&&(a=Number.MAX_VALUE);const l=e[t];for(let c=t+1;c<e.length;c++){const d=e[c];if(this.NodeUCanBeCrossedByNodeV(d,l))continue;const b=this.anchors[d];if(b.left>=s)break;b.right>i&&(b.topAnchor>a+le.distanceEpsilon?(a=b.topAnchor,yield d):b.bottomAnchor>o+le.distanceEpsilon&&(o=b.bottomAnchor,yield d))}}*LeftFromTheNode(e,t,n,i,s){let o=0,a=0;n==mi.Bottom&&(o=Number.MAX_VALUE),n==mi.Top&&(a=Number.MAX_VALUE);const l=e[t];for(let c=t-1;c>-1;c--){const d=e[c];if(this.NodeUCanBeCrossedByNodeV(d,l))continue;const b=this.anchors[d];if(b.right<=i)break;b.left<s&&(b.topAnchor>a+le.distanceEpsilon?(a=b.topAnchor,yield d):b.bottomAnchor>o+le.distanceEpsilon&&(o=b.bottomAnchor,yield d))}}}class Qi{constructor(e,t,n,i,s,o,a){this.thinRightNodes=new Array,this.thinWestNodes=new Array,this.database=a,this.edgePath=e,this.anchors=t,this.layerArrays=s,this.originalGraph=n,this.settings=i,this.layeredGraph=o,this.eastHierarchy=this.BuildEastHierarchy(),this.westHierarchy=this.BuildWestHierarchy()}BuildEastHierarchy(){const e=this.FindEastBoundaryAnchorCurves(),t=new Array;for(const n of e)t.push(n.pNodeOverICurve());return this.thinEastHierarchy=rg.Calculate(this.thinRightNodes),rg.Calculate(t)}BuildWestHierarchy(){const e=this.FindWestBoundaryAnchorCurves(),t=new Array;for(const n of e)t.push(n.pNodeOverICurve());return this.thinWestHierarchy=rg.Calculate(this.thinWestNodes),rg.Calculate(t)}FindEastBoundaryAnchorCurves(){const e=new Array;let t=0;for(const n of this.edgePath){let i=null;for(const s of this.EastBoundaryNodesOfANode(n,_u.GetNodeKind(t,this.edgePath))){const o=this.anchors[s];(null==i||i.origin.x>o.origin.x)&&(i=o),e.push(o.polygonalBoundary)}null!=i&&this.thinRightNodes.push(Me.mkLinePXY(i.origin,this.originalGraph.right,i.y).pNodeOverICurve()),t++}return e}FindWestBoundaryAnchorCurves(){const e=[];let t=0;for(const n of this.edgePath.nodes()){let i=-1;for(const s of this.LeftBoundaryNodesOfANode(n,_u.GetNodeKind(t,this.edgePath)))(-1==i||this.layerArrays.x[s]>this.layerArrays.x[i])&&(i=s),e.push(this.anchors[s].polygonalBoundary);if(-1!=i){const s=this.anchors[i];this.thinWestNodes.push(Me.mkLinePXY(s.origin,this.originalGraph.left,s.origin.y).pNodeOverICurve())}t++}return e}*FillRightTopAndBottomVerts(e,t,n){let i=0,s=0;n==mi.Bottom?i=Number.MAX_VALUE:n==mi.Top&&(s=Number.MAX_VALUE);const o=e[t];for(let a=t+1;a<e.length;a++){const l=e[a],c=this.anchors[l];c.topAnchor>s?this.NodeUCanBeCrossedByNodeV(l,o)||(s=c.topAnchor,c.bottomAnchor>i&&(i=c.bottomAnchor),yield l):c.bottomAnchor>i&&(this.NodeUCanBeCrossedByNodeV(l,o)||(i=c.bottomAnchor,c.topAnchor>s&&(s=c.topAnchor),yield l))}}*FillLeftTopAndBottomVerts(e,t,n){let i=0,s=0;n==mi.Top?s=Number.MAX_VALUE:n==mi.Bottom&&(i=Number.MAX_VALUE);const o=e[t];for(let a=t-1;a>=0;a--){const l=e[a],c=this.anchors[l];c.topAnchor>s+le.distanceEpsilon?this.NodeUCanBeCrossedByNodeV(l,o)||(s=c.topAnchor,i=Math.max(i,c.bottomAnchor),yield l):c.bottomAnchor>i+le.distanceEpsilon&&(this.NodeUCanBeCrossedByNodeV(l,o)||(s=Math.max(s,c.topAnchor),i=c.bottomAnchor,yield l))}}IsVirtualVertex(e){return e>=this.originalGraph.shallowNodeCount}IsLabel(e){return this.anchors[e].hasLabel}NodeUCanBeCrossedByNodeV(e,t){return!this.IsLabel(e)&&!this.IsLabel(t)&&!!(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t)&&this.EdgesIntersectSomewhere(e,t))}EdgesIntersectSomewhere(e,t){return!this.UVAreMiddlesOfTheSameMultiEdge(e,t)&&(this.IntersectAbove(e,t)||this.IntersectBelow(e,t))}UVAreMiddlesOfTheSameMultiEdge(e,t){return!(!this.database.MultipleMiddles.has(e)||!this.database.MultipleMiddles.has(t)||this.SourceOfTheOriginalEdgeContainingAVirtualNode(e)!=this.SourceOfTheOriginalEdgeContainingAVirtualNode(t))}SourceOfTheOriginalEdgeContainingAVirtualNode(e){for(;this.IsVirtualVertex(e);)e=this.IncomingEdge(e).Source;return e}IntersectBelow(e,t){do{const n=this.OutcomingEdge(e),i=this.OutcomingEdge(t);if(this.Intersect(n,i))return!0;e=n.Target,t=i.Target}while(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t));return e==t}IntersectAbove(e,t){do{const n=this.IncomingEdge(e),i=this.IncomingEdge(t);if(this.Intersect(n,i))return!0;e=n.Source,t=i.Source}while(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t));return e==t}Intersect(e,t){const n=this.layerArrays.x[e.Source]-this.layerArrays.x[t.Source],i=this.layerArrays.x[e.Target]-this.layerArrays.x[t.Target];return n>0&&i<0||n<0&&i>0}IncomingEdge(e){return this.layeredGraph.InEdgeOfVirtualNode(e)}OutcomingEdge(e){return this.layeredGraph.OutEdgeOfVirtualNode(e)}EastBoundaryNodesOfANode(e,t){return this.FillRightTopAndBottomVerts(this.NodeLayer(e),this.layerArrays.x[e],t)}NodeLayer(e){return this.layerArrays.Layers[this.layerArrays.y[e]]}LeftBoundaryNodesOfANode(e,t){return this.FillLeftTopAndBottomVerts(this.NodeLayer(e),this.layerArrays.x[e],t)}getSpline(e){return this.createRefinedPolyline(e),this.createSmoothedPolyline()}get GetPolyline(){return new Jr(this.headSite)}LineSegIntersectBound(e,t){const n=Me.mkPP(e,t);return Qi.CurveIntersectsHierarchy(n,this.westHierarchy)||Qi.CurveIntersectsHierarchy(n,this.thinWestHierarchy)||Qi.CurveIntersectsHierarchy(n,this.eastHierarchy)||Qi.CurveIntersectsHierarchy(n,this.thinEastHierarchy)}SegIntersectWestBound(e,t){return Qi.SegIntersectsBound(e,t,this.westHierarchy)||Qi.SegIntersectsBound(e,t,this.thinWestHierarchy)}SegIntersectEastBound(e,t){return Qi.SegIntersectsBound(e,t,this.eastHierarchy)||Qi.SegIntersectsBound(e,t,this.thinEastHierarchy)}TryToRemoveInflectionCorner(e){if(!e.s.next||!e.s.prev||e.s.turn==nt.Counterclockwise&&this.SegIntersectEastBound(e.s.prev,e.s.next)||e.s.turn==nt.Clockwise&&this.SegIntersectWestBound(e.s.prev,e.s.next))return e.cut=!1,void(e.s=e.s.next);const t=e.s.next;e.s.prev.next=t,t.prev=e.s.prev,e.s=t,e.cut=!0}static SegIntersectsBound(e,t,n){return Qi.CurveIntersectsHierarchy(Me.mkPP(e.point,t.point),n)}static CurveIntersectsHierarchy(e,t){if(null==t||!gn.intersect(e.pNodeOverICurve().parallelogram,t.parallelogram))return!1;if(t.node.hasOwnProperty("children")){const n=t.node;return Qi.CurveIntersectsHierarchy(e,n.children[0])||Qi.CurveIntersectsHierarchy(e,n.children[1])}return null!=fe.intersectionOne(e,t.seg,!1)}static Flat(e){return k.getTriangleOrientation(e.prev.point,e.point,e.next.point)==nt.Collinear}Reverse(){const e=new Qi(this.edgePath,this.anchors,this.originalGraph,this.settings,this.layerArrays,this.layeredGraph,this.database);let t=this.headSite,n=null;for(;null!=t;)e.headSite=t.clone(),e.headSite.next=n,null!=n&&(n.prev=e.headSite),n=e.headSite,t=t.next;return e}createRefinedPolyline(e){this.CreateInitialListOfSites();let n,t=this.headSite;for(let i=0;i<this.edgePath.count;i++)n=t.next,this.RefineBeetweenNeighborLayers(t,this.EdgePathNode(i),this.EdgePathNode(i+1)),t=n;this.TryToRemoveInflections(),e&&this.OptimizeShortPath()}RefineBeetweenNeighborLayers(e,t,n){co.Refine(t,n,e,this.anchors,this.layerArrays,this.layeredGraph,this.originalGraph,this.settings.LayerSeparation)}CreateInitialListOfSites(){let e=this.headSite=lr.mkSiteP(this.EdgePathPoint(0));for(let t=1;t<=this.edgePath.count;t++)e=lr.mkSiteSP(e,this.EdgePathPoint(t))}get TailSite(){let e=this.headSite;for(;null!=e.next;)e=e.next;return e}OptimizeForThreeSites(){const e=this.EdgePathNode(0),t=this.EdgePathNode(2),n=this.anchors[e],i=this.anchors[t];if(an(n.x,i.x))return;const s={ax:n.x,bx:i.x,sign:0};if(!this.FindLegalPositions(n,i,s))return;const o=(n.y-i.y)/(n.bottom-i.top),a=.5*(s.ax+s.bx),l=s.sign*(.5*(s.ax-s.bx));s.ax=a+o*(l*s.sign),s.bx=a-o*(l*s.sign),this.headSite.point=new k(s.ax,n.y);const c=this.headSite.next,d=c.point.y;c.point=new k(this.MiddlePos(s.ax,s.bx,n,i,d),d),c.next.point=new k(s.bx,i.y),this.anchors[this.EdgePathNode(1)].x=c.point.x}OptimizeForTwoSites(){const e=this.EdgePathNode(0),t=this.EdgePathNode(1),n=this.anchors[e],i=this.anchors[t];if(an(n.x,i.x))return;const s={ax:n.x,bx:i.x,sign:0};if(!this.FindPositions(n,i,s))return;const o=(n.y-i.y)/(n.bottom-i.top),a=.5*(s.ax+s.bx),l=s.sign*(.5*(s.ax-s.bx));s.ax=a+o*(l*s.sign),s.bx=a-o*(l*s.sign),this.headSite.point=new k(s.ax,n.y),this.headSite.next.point=new k(s.bx,i.y)}FindLegalPositions(e,t,n){return!!this.FindPositions(e,t,n)&&this.PositionsAreLegal(n.ax,n.bx,n.sign,e,t,this.EdgePathNode(1))}FindPositions(e,t,n){let i,s;if(n.ax<n.bx?(n.sign=1,s=Math.max(n.ax,t.left),i=Math.min(e.right,n.bx)):(n.sign=-1,s=Math.max(e.left,n.bx),i=Math.min(t.right,n.ax)),s<=i)n.bx=.5*(s+i),n.ax=.5*(s+i);else{if(this.OriginToOriginSegCrossesAnchorSide(e,t))return!1;1==n.sign?(n.ax=e.right-.1*e.rightAnchor,n.bx=t.left):(n.ax=e.left+.1*e.leftAnchor,n.bx=t.right)}return!0}OriginToOriginSegCrossesAnchorSide(e,t){const n=Me.mkPP(e.origin,t.origin);return e.x<t.x&&fe.CurvesIntersect(n,Me.mkPP(e.rightBottom,e.rightTop))||fe.CurvesIntersect(n,Me.mkPP(t.leftBottom,e.leftTop))||e.x>t.x&&fe.CurvesIntersect(n,Me.mkPP(e.leftBottom,e.leftTop))||fe.CurvesIntersect(n,Me.mkPP(t.rightBottom,e.rightTop))}OptimizeShortPath(){this.edgePath.count>2||(2==this.edgePath.count&&null!=this.headSite.next.next&&null==this.headSite.next.next.next&&null==this.anchors[this.EdgePathNode(1)].node?this.OptimizeForThreeSites():1==this.edgePath.count&&this.OptimizeForTwoSites())}PositionsAreLegal(e,t,n,i,s,o){if(!an(e,t)&&(e-t)*n>0)return!1;const a=this.anchors[o],l=this.MiddlePos(e,t,i,s,a.y);return!!this.MiddleAnchorLegal(l,o,a)&&!this.LineSegIntersectBound(new k(e,i.bottom),new k(t,s.top))}MiddleAnchorLegal(e,t,n){const i=this.NodeLayer(t),s=this.layerArrays.x[t],o=e-n.x;return!(s>0&&this.anchors[i[s-1]].right>o+n.left||s<i.length-1&&this.anchors[i[s+1]].left<o+n.right)}MiddlePos(e,t,n,i,s){const o=n.y-s,a=s-i.y;return(e*o+t*a)/(o+a)}TryToRemoveInflections(){if(this.TurningAlwaySameDirection())return;let e=!0;for(;e;){e=!1;for(const t={s:this.headSite,cut:!1};t.s;)this.TryToRemoveInflectionCorner(t),e=t.cut||e}}TurningAlwaySameDirection(){let e=0;for(let t=this.headSite.next;null!=t&&null!=t.next;t=t.next){const n=t.turn;if(0==e)n>0?e=1:n<0&&(e=-1);else if(e*n<0)return!1}return!0}EdgePathPoint(e){return this.anchors[this.EdgePathNode(e)].origin}EdgePathNode(e){return e==this.edgePath.count?this.edgePath.LayerEdges[this.edgePath.count-1].Target:this.edgePath.LayerEdges[e].Source}createSmoothedPolyline(){this.RemoveVerticesWithNoTurns();let e=new fe;const t=this.headSite,n=fe.findCorner(t);return null!=n?(this.createFilletCurve(e,{a:t,b:n.b,c:n.c}),e=this.ExtendCurveToEndpoints(e)):e.addSegment(Me.mkPP(this.headSite.point,this.TailSite.point)),e}curveIsLegal(e){return!0}RemoveVerticesWithNoTurns(){for(;this.RemoveVerticesWithNoTurnsOnePass(););}RemoveVerticesWithNoTurnsOnePass(){let e=!1;for(let t=this.headSite;null!=t.next&&null!=t.next.next;t=t.next)Qi.Flat(t.next)&&(e=!0,t.next=t.next.next,t.next.prev=t);return e}ExtendCurveToEndpoints(e){let t=this.headSite.point;if(!k.closeDistEps(t,e.start)){const n=new fe;n.addSegs([Me.mkPP(t,e.start),e]),e=n}return t=this.TailSite.point,k.closeDistEps(t,e.end)||e.addSegment(Me.mkPP(e.end,t)),e}createFilletCurve(e,t){for(;this.AddSmoothedCorner(t.a,t.b,t.c,e),t.a=t.b,t.b=t.c,null!=t.b.next;)t.c=t.b.next}AddSmoothedCorner(e,t,n,i){let o,s=.5;do{o=fe.createBezierSeg(s,s,e,t,n),t.previouisBezierCoefficient=s,s/=2}while(this.BezierSegIntersectsBoundary(o));if(s*=2,s<.5){s=.5*(s+2*s);const a=fe.createBezierSeg(s,s,e,t,n);this.BezierSegIntersectsBoundary(a)||(t.nextBezierCoefficient=s,t.previouisBezierCoefficient=s,o=a)}i.segs.length>0&&!k.closeDistEps(i.end,o.start)&&i.addSegment(Me.mkPP(i.end,o.start)),i.addSegment(o)}BezierSegIntersectsBoundary(e){return k.signedDoubledTriangleArea(e.B(0),e.B(1),e.B(2))<0?this.BezierSegIntersectsTree(e,this.thinWestHierarchy)||this.BezierSegIntersectsTree(e,this.westHierarchy):this.BezierSegIntersectsTree(e,this.thinEastHierarchy)||this.BezierSegIntersectsTree(e,this.eastHierarchy)}BezierSegIntersectsTree(e,t){if(null==t)return!1;if(gn.intersect(e.pNodeOverICurve().parallelogram,t.parallelogram)){if(t.node.hasOwnProperty("children")){const n=t.node;return this.BezierSegIntersectsTree(e,n.children[0])||this.BezierSegIntersectsTree(e,n.children[1])}return Qi.BezierSegIntersectsBoundary(e,t.seg)}return!1}static BezierSegIntersectsBoundary(e,t){for(const n of fe.getAllIntersections(e,t,!1)){if(!(t instanceof fe))return!0;if(fe.realCutWithClosedCurve(n,t,!1))return!0}return!1}}class ig{constructor(e=null){this.parents=new Set,this.children=new Set,this.ports=new Set,this.BoundaryCurve=e}get Parents(){return Array.from(this.parents.values())}get Children(){return Array.from(this.children.values())}get BoundaryCurve(){return this.boundaryCurve}set BoundaryCurve(e){this.boundaryCurve=e}get BoundingBox(){return this.BoundaryCurve.boundingBox}get Ports(){return this.ports}static mkShape(){return new ig(null)}get IsGroup(){return this.children.size>0}*Descendants(){const e=new mu.c;for(const t of this.Children)e.enqueue(t);for(;e.length>0;){const t=e.dequeue();yield t;for(const n of t.Children)e.enqueue(n)}}*Ancestors(){const e=new mu.c;for(const t of this.Parents)e.enqueue(t);for(;e.length>0;){const t=e.dequeue();yield t;for(const n of t.Parents)e.enqueue(n)}}AddParent(e){this.parents.add(e),e.children.add(this)}AddChild(e){e.parents.add(this),this.children.add(e)}RemoveChild(e){this.children.delete(e),e.parents.delete(this)}RemoveParent(e){this.parents.delete(e),e.children.delete(this)}ToString(){return this.UserData?this.UserData.toString():"null"}}class gT{}class pl extends gT{constructor(e,t){super(),this.curve=this.curve,this.location=t.clone()}get Location(){return this.location}set Location(e){this.location=e}Translate(e){this.location=this.location.add(e)}get Curve(){return this.curve}set Curve(e){this.curve=e}}class Ru extends pl{constructor(e,t,n){super(null,t().add(n)),this.LocationOffset=n,this.CurveDelegate=e,this.CenterDelegate=t}static mk(e,t){return new Ru(e,t,new k(0,0))}get CenterDelegate(){return this.centerDelegate}set CenterDelegate(e){this.centerDelegate=e}get CurveDelegate(){return this.curveDelegate}set CurveDelegate(e){this.curveDelegate=e}get LocationOffset(){return this.locationOffset}set LocationOffset(e){this.locationOffset=e}get Location(){return this.CenterDelegate().add(this.LocationOffset)}get Curve(){return this.CurveDelegate()}}let qt=(()=>{class r{static mkDebugCurveTWCILD(t,n,i,s,o,a,l=!1){const c=new r;return c.transparency=t,c.width=n,c.color=i,c.icurve=s,c.label=o,c.dashArray=a,c.drawPN=l,c}static mkDebugCurveTWCI(t,n,i,s){return r.mkDebugCurveTWCILD(t,n,i,s,null,null)}static mkDebugCurveWCI(t,n,i){return r.mkDebugCurveTWCI(255,t,n,i)}static mkDebugCurveCI(t,n){return r.mkDebugCurveWCI(1,t,n)}static mkDebugCurveI(t){return r.mkDebugCurveCI("Black",t)}}return r.colors=["DeepSkyBlue","IndianRed","Orange","Gold","DarkRed","Plum","Red","Violet","Indigo","Yellow","OrangeRed","Tomato","Purple","SaddleBrown","Green","Navy","Aqua","Pink","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","Lime","BurlyWood","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","CadetBlue","Chartreuse","DarkBlue","DarkCyan","DarkGoldenrod","DarkGray","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkTurquoise","DarkViolet","DeepPink","DimGray","DodgerBlue","Firebrick","FloralWhite","ForestGreen","Fuchsia","CodeAnalysis","Gainsboro","GhostWhite","Goldenrod","Gray","GreenYellow","Honeydew","HotPink","Ivory","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenrodYellow","LightGray","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSteelBlue","LightYellow","LimeGreen","Linen","Magenta","Maroon","MediumAquamarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","OldLace","Olive","OliveDrab","Orchid","PaleGoldenrod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","PowderBlue","RosyBrown","RoyalBlue","Salmon","SandyBrown","SeaGreen","CodeAnalysis","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Transparent","Turquoise","Aquamarine","Azure","Beige","Wheat","White","WhiteSmoke","YellowGreen","Khaki","AntiqueWhite"],r})();class pT{constructor(e,t,n,i,s){this.color=e,void 0!==t&&(this.item=t),void 0!==n&&(this.parent=n),void 0!==i&&(this.left=i),void 0!==s&&(this.right=s)}toString(){return this.item.toString()}}var Bt=(()=>{return(r=Bt||(Bt={}))[r.Red=0]="Red",r[r.Black=1]="Black",Bt;var r})();class uo{constructor(e){this.comparer=e,this.count=0,this.root=this.nil=new pT(Bt.Black)}[Symbol.iterator](){return this.allNodes()}clear(){this.root=this.nil=new pT(Bt.Black)}toNull(e){return e!=this.nil?e:null}isEmpty(){return this.root==this.nil}getComparer(){return this.comparer}getRoot(){return this.root}find(e,t=this.root){let n;for(;t!=this.nil&&0!=(n=this.comparer(e,t.item));)t=n<0?t.left:t.right;return this.toNull(t)}findFirst(e,t=this.root){if(t==this.nil)return null;let n=null;for(;t!=this.nil;)t=e(t.item)?(n=t).left:t.right;return n}findLast(e,t=this.root){if(t==this.nil)return null;let n=null;for(;t!=this.nil;)t=e(t.item)?(n=t).right:t.left;return n}treeMinimum(e=this.root){for(;e.left!=this.nil;)e=e.left;return this.toNull(e)}treeMaximum(e=this.root){for(;e.right!=this.nil;)e=e.right;return this.toNull(e)}next(e){if(e.right!=this.nil)return this.treeMinimum(e.right);let t=e.parent;for(;t!=this.nil&&e==t.right;)e=t,t=t.parent;return this.toNull(t)}previous(e){if(e.left!=this.nil)return this.treeMaximum(e.left);let t=e.parent;for(;t!=this.nil&&e==t.left;)e=t,t=t.parent;return this.toNull(t)}leftRotate(e){const t=e.right;e.right=t.left,t.left!=this.nil&&(t.left.parent=e),t.parent=e.parent,e.parent==this.nil?this.root=t:e==e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}rightRotate(e){const t=e.left;e.left=t.right,t.right!=this.nil&&(t.right.parent=e),t.parent=e.parent,e.parent==this.nil?this.root=t:e==e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}deleteFixup(e){for(;e!=this.root&&e.color==Bt.Black;)if(e==e.parent.left){let t=e.parent.right;t.color==Bt.Red&&(t.color=Bt.Black,e.parent.color=Bt.Red,this.leftRotate(e.parent),t=e.parent.right),t.left.color==Bt.Black&&t.right.color==Bt.Black?(t.color=Bt.Red,e=e.parent):(t.right.color==Bt.Black&&(t.left.color=Bt.Black,t.color=Bt.Red,this.rightRotate(t),t=e.parent.right),t.color=e.parent.color,e.parent.color=Bt.Black,t.right.color=Bt.Black,this.leftRotate(e.parent),e=this.root)}else{let t=e.parent.left;t.color==Bt.Red&&(t.color=Bt.Black,e.parent.color=Bt.Red,this.rightRotate(e.parent),t=e.parent.left),t.right.color==Bt.Black&&t.left.color==Bt.Black?(t.color=Bt.Red,e=e.parent):(t.left.color==Bt.Black&&(t.right.color=Bt.Black,t.color=Bt.Red,this.leftRotate(t),t=e.parent.left),t.color=e.parent.color,e.parent.color=Bt.Black,t.left.color=Bt.Black,this.rightRotate(e.parent),e=this.root)}e.color=Bt.Black}deleteSubTree(e){let t;if(e.left==this.nil||e.right==this.nil)t=e;else for(t=e.right;t.left!=this.nil;)t=t.left;const n=t.left!=this.nil?t.left:t.right;return n.parent=t.parent,t.parent==this.nil?this.root=n:t==t.parent.left?t.parent.left=n:t.parent.right=n,t!=e&&(e.item=t.item),t.color==Bt.Black&&this.deleteFixup(n),this.toNull(e)}deleteNodeInternal(e){this.count--,this.deleteSubTree(e)}remove(e){const t=this.find(e);return null!=t?(this.count--,this.deleteSubTree(t)):null}insert(e){const t=this.treeInsert(e);return this.insertPrivate(t),this.toNull(t)}treeInsert(e){let t=this.nil,n=this.root,i=0;for(;n!=this.nil;)t=n,i=this.comparer(e,n.item),n=i<0?n.left:n.right;const s=new pT(Bt.Black,e,t,this.nil,this.nil);return t==this.nil?this.root=s:i<0?t.left=s:t.right=s,this.toNull(s)}insertPrivate(e){for(this.count++,e.color=Bt.Red;e!=this.root&&e.parent.color==Bt.Red;)if(e.parent==e.parent.parent.left){const t=e.parent.parent.right;t.color==Bt.Red?(e.parent.color=Bt.Black,t.color=Bt.Black,e.parent.parent.color=Bt.Red,e=e.parent.parent):(e==e.parent.right&&this.leftRotate(e=e.parent),e.parent.color=Bt.Black,e.parent.parent.color=Bt.Red,this.rightRotate(e.parent.parent))}else{const t=e.parent.parent.left;t.color==Bt.Red?(e.parent.color=Bt.Black,t.color=Bt.Black,e.parent.parent.color=Bt.Red,e=e.parent.parent):(e==e.parent.left&&this.rightRotate(e=e.parent),e.parent.color=Bt.Black,e.parent.parent.color=Bt.Red,this.leftRotate(e.parent.parent))}this.root.color=Bt.Black}*allNodes(){if(this.isEmpty())return;let e=this.treeMinimum();for(;null!=e;)yield e.item,e=this.next(e)}toString(){let e="{",t=0;for(const n of this.allNodes())e+=n.toString(),t!=this.count-1&&(e+="\n"),t++;return e+"}"}}class mT{constructor(e){this.heapSize=0,this.A=[],this.compare=e}Enqueue(e){let t=this.heapSize+1;this.A[t]=e,this.heapSize++;let i,s,n=t>>1;for(;t>1&&this.Less(i=this.A[t],s=this.A[n]);)this.A[n]=i,this.A[t]=s,t=n,n=t>>1}Dequeue(){if(this.heapSize<1)throw new Error;const e=this.A[1],t=this.A[this.heapSize];return this.heapSize--,this.ChangeMinimum(t),e}ChangeMinimum(e){this.A[1]=e;let t=1,n=2,i=!1;for(;n<this.heapSize&&!i;){i=!0;const s=this.A[n],o=this.A[n+1];this.compare(s,o)<0?this.compare(s,e)<0&&(this.A[t]=s,this.A[n]=e,i=!1,t=n,n=t<<1):this.compare(o,e)<0&&(this.A[t]=o,this.A[n+1]=e,i=!1,t=n+1,n=t<<1)}if(n==this.heapSize){const s=this.A[n];this.compare(s,e)<0&&(this.A[t]=s,this.A[n]=e)}}get Count(){return this.heapSize}Less(e,t){return this.compare(e,t)<0}GetMinimum(){return this.A[1]}}class pc{}class sg extends pc{constructor(e){super(),this.Vertex=e}get Site(){return this.Vertex.point}get Polyline(){return this.Vertex.polyline}}class QW extends sg{constructor(e){super(e)}}class XW{constructor(e){this.lineSweeper=e}Compare(e,t){switch(k.getTriangleOrientation(t.Start,t.End,this.x)){case nt.Collinear:return 0;case nt.Clockwise:return 1;default:return-1}}SetOperand(e){this.x=this.IntersectionOfSideAndSweepLine(e)}IntersectionOfSideAndSweepLine(e){const t=e.Direction.dot(this.lineSweeper.SweepDirection),n=(this.lineSweeper.Z-e.Start.dot(this.lineSweeper.SweepDirection))/t;return e.Start.add(e.Direction.mul(n))}}class ZW extends pc{constructor(e){super(),this.site=e}get Site(){return this.site}}class nL{constructor(e,t){this.PreviousZ=Number.NEGATIVE_INFINITY,this.z=Number.NEGATIVE_INFINITY,this.Obstacles=null!=e?e:[],this.SweepDirection=t,this.DirectionPerp=t.rotate(-Math.PI/2),this.EventQueue=new mT((n,i)=>this.Compare(n,i)),this.ObstacleSideComparer=new XW(this),this.LeftObstacleSideTree=new uo((n,i)=>this.ObstacleSideComparer.Compare(n,i)),this.RightObstacleSideTree=new uo((n,i)=>this.ObstacleSideComparer.Compare(n,i))}get EventQueue(){return this.eventQueue}set EventQueue(e){this.eventQueue=e}get DirectionPerp(){return this.directionPerp}set DirectionPerp(e){this.directionPerp=e}get Z(){return this.z}set Z(e){e>this.z+le.tolerance&&(this.PreviousZ=this.z),this.z=e}GetZS(e){return this.SweepDirection.dot(e.Site)}GetZP(e){return this.SweepDirection.dot(e)}SegmentIsNotHorizontal(e,t){return Math.abs(e.sub(t).dot(this.SweepDirection))>le.distanceEpsilon}RemoveLeftSide(e){this.ObstacleSideComparer.SetOperand(e),this.LeftObstacleSideTree.remove(e)}RemoveRightSide(e){this.ObstacleSideComparer.SetOperand(e),this.RightObstacleSideTree.remove(e)}InsertLeftSide(e){this.ObstacleSideComparer.SetOperand(e),this.LeftObstacleSideTree.insert(e)}InsertRightSide(e){this.ObstacleSideComparer.SetOperand(e),this.RightObstacleSideTree.insert(e)}FindFirstObstacleSideToTheLeftOfPoint(e){const t=this.RightObstacleSideTree.findLast(n=>k.pointToTheRightOfLineOrOnLine(e,n.Start,n.End));return null==t?null:t.item}FindFirstObstacleSideToToTheRightOfPoint(e){const t=this.LeftObstacleSideTree.findFirst(n=>!k.pointToTheRightOfLineOrOnLine(e,n.Start,n.End));return null==t?null:t.item}EnqueueEvent(e){this.eventQueue.Enqueue(e)}InitQueueOfEvents(){for(const e of this.Obstacles)this.EnqueueLowestPointsOnObstacles(e);if(null!=this.Ports)for(const e of this.Ports.values())this.EnqueueEvent(new ZW(e))}EnqueueLowestPointsOnObstacles(e){const t=this.GetLowestPoint(e);this.EnqueueEvent(new QW(t))}GetLowestPoint(e){let t=e.startPoint,n=e.startPoint.next;for(;null!=n;n=n.next)this.Less(n.point,t.point)&&(t=n);return t}Compare(e,t){return this.ComparePoints(e.Site,t.Site)}Less(e,t){return this.ComparePoints(e,t)<0}ComparePoints(e,t){let n=this.SweepDirection.dot(e),i=this.SweepDirection.dot(t);return n<i?-1:n>i?1:(n=this.directionPerp.dot(e),i=this.directionPerp.dot(t),n<i?-1:n>i?1:0)}}class Xi{constructor(e,t,n=1){this.LengthMultiplier=1,(Xi.closeuv(e,t)||Xi.closeuv(t,e))&&console.log(e),this.Source=e,this.Target=t,this.Weight=n}static closeuv(e,t){return k.closeDistEps(e.point,Xi.u,.1)&&k.closeDistEps(t.point,Xi.v,.1)}get SourcePoint(){return this.Source.point}get TargetPoint(){return this.Target.point}get Length(){return this.SourcePoint.sub(this.TargetPoint).length*this.LengthMultiplier}toString(){return pi.String.Format("{0}->{1} ({2})",this.Source,this.Target,this.Weight)}ReversedClone(){return new Xi(this.Target,this.Source)}Clone(){return new Xi(this.Source,this.Target)}}Xi.u=new k(545.833,840.458),Xi.v=new k(606.1667261889578,786.2917261889578),Xi.DefaultWeight=1;class ml extends Xi{static constructorVV(e,t){return new ml(e,t,0)}constructor(e,t,n=0){super(e,t,n)}}class og{constructor(e){this._inEdges=new Array,this._outEdges=new uo((t,n)=>this.Compare(t,n)),this.point=e}get InEdges(){return this._inEdges}get OutEdges(){return this._outEdges}get Degree(){return this._inEdges.length+this.OutEdges.count}InEdgesLength(){return this._inEdges.length}addInEdge(e){this._inEdges.push(e)}get IsTerminal(){return this._isTerminal}set IsTerminal(e){this._isTerminal=e}get IsShortestPathTerminal(){return this._isShortestPathTerminal}set IsShortestPathTerminal(e){this._isShortestPathTerminal=e}toString(){return this.point.toString()}RemoveOutEdge(e){this.OutEdges.remove(e)}RemoveInEdge(e){const t=this._inEdges.indexOf(e);if(-1==t)return;const n=this._inEdges.length-1;t!=n&&(this._inEdges[t]=this._inEdges[n]),this._inEdges.pop()}static FindFirst(e,t){return og.FindFirst_t(e.root,e,t)}static FindFirst_t(e,t,n){if(e==t.nil)return null;let i=null;for(;e!=t.nil;)e=e.item.TargetPoint.compareTo(n)>=0?(i=e).left:e.right;return i}get(e){let t=og.FindFirst(this.OutEdges,e.point);return null!=t&&t.item.Target==e||(t=og.FindFirst(e.OutEdges,this.point),null!=t&&t.item.Target==this)?t.item:null}Compare(e,t){return e.TargetPoint.compareTo(t.TargetPoint)}ClearEdges(){this._outEdges.clear(),this._inEdges=[]}}class Or{constructor(){this._prevEdgesMap=new Map,this.visVertexToId=new Map,this.VertexFactory=e=>new og(e),this.pointToVertexMap=new Vs}*edges_(){for(const e of this.pointToVertexMap.values())for(const t of e.OutEdges)yield t}get Edges(){return this.edges_()}ClearPrevEdgesTable(){this._prevEdgesMap.clear()}ShrinkLengthOfPrevEdge(e,t){this._prevEdgesMap.get(e).LengthMultiplier=t}PreviosVertex(e){const t=this._prevEdgesMap.get(e);return t?t.Source==e?t.Target:t.Source:null}SetPreviousEdge(e,t){this._prevEdgesMap.set(e,t)}AddHole(e){let t=e.startPoint;for(;t!=e.endPoint;)this.AddEdgePlPl(t,t.next),t=t.next;this.AddEdgePlPl(e.endPoint,e.startPoint)}static*OrientHolesClockwise(e){for(const t of e)for(let n=t.startPoint;;n=n.next){const i=k.getTriangleOrientation(n.point,n.next.point,n.next.next.point);if(i!=nt.Collinear){yield i==nt.Clockwise?t:t.reverse();break}}}AddVertexP(e){const t=this.pointToVertexMap.get(e);if(t)return t;const n=this.VertexFactory(e);return this.pointToVertexMap.set(e,n),n}AddVertexV(e){this.pointToVertexMap.set(e.point,e)}ContainsVertex(e){return this.pointToVertexMap.has(e)}static AddEdgeVV(e,t){let n;if(n=e.get(t))return n;if(e==t)throw new Error("Self-edges are not allowed");const i=new Xi(e,t);return e.OutEdges.insert(i),t.InEdges.push(i),i}AddEdgePlPl(e,t){this.AddEdgePP(e.point,t.point)}static AddEdge(e){e.Source.OutEdges.insert(e),e.Target.addInEdge(e)}AddEdgeF(e,t,n){let i=this.FindVertex(e),s=null;if(null!=i&&(s=this.FindVertex(t),null!=s)){const a=i.get(s);if(a)return a}null==i?(i=this.AddVertexP(e),s=this.AddVertexP(t)):null==s&&(s=this.AddVertexP(t));const o=n(i,s);return i.OutEdges.insert(o),s.addInEdge(o),o}AddEdgePP(e,t){return this.AddEdgeF(e,t,(n,i)=>new Xi(n,i))}FindVertex(e){return this.pointToVertexMap.get(e)}Vertices(){return this.pointToVertexMap.values()}RemoveVertex(e){for(const t of e.OutEdges)t.Target.RemoveInEdge(t);for(const t of e.InEdges)t.Source.RemoveOutEdge(t);this.pointToVertexMap.deleteP(e.point)}FindEdgePP(e,t){const n=this.FindVertex(e);if(null==n)return null;const i=this.FindVertex(t);return null==i?null:n.get(i)}static RemoveEdge(e){e.Source.RemoveOutEdge(e),e.Target.RemoveInEdge(e)}ClearEdges(){for(const e of this.Vertices())e.ClearEdges()}}class yT{constructor(){this.Removed=!1}}class Tu extends yT{constructor(e,t,n){super(),this.start=e,this.EndVertex=t,this.ConeSide=n}get Start(){return this.start}get End(){return this.EndVertex.point}get Direction(){return this.End.sub(this.Start)}toString(){return"BrokenConeSide: "+this.Start+","+this.End}}class ET{constructor(e,t){this.apex=e,this.coneSweeper=t}get Removed(){return this.removed}set Removed(e){this.removed=e}get Apex(){return this.apex}set Apex(e){this.apex=e}get RightSideDirection(){return this.coneSweeper.ConeRightSideDirection}get LeftSideDirection(){return this.coneSweeper.ConeLeftSideDirection}get RightSide(){return this.rightSide}set RightSide(e){this.rightSide=e,this.rightSide.Cone=this}get LeftSide(){return this.leftSide}set LeftSide(e){this.leftSide=e,this.leftSide.Cone=this}}class rL extends pc{constructor(e,t){super(),this.site=e,this.coneToClose=t}get ConeToClose(){return this.coneToClose}get Site(){return this.site}toString(){return"ConeClosureEvent "+this.site}}class yl extends yT{constructor(e){super(),this.Cone=e}get Start(){return this.Cone.Apex}get Direction(){return this.Cone.LeftSideDirection}toString(){return"ConeLeftSide "+this.Start+" "+this.Direction}}class Ou extends yT{constructor(e){super(),this.Cone=e}get Start(){return this.Cone.Apex}get Direction(){return this.Cone.RightSideDirection}toString(){return"ConeRightSide "+this.Start+" "+this.Direction}}class GS{constructor(e){this.coneSweeper=e}SetOperand(e){this.x=this.IntersectionOfSegmentAndSweepLine(e)}Compare(e,t){const i=t instanceof Tu;return e instanceof Tu?i?this.CompareBrokenSides(e,t):this.CompareObstacleSideAndConeSide(t):i?this.CompareConeSideAndObstacleSide(e,t):GS.CompareNotIntersectingSegs(e,t)}static CompareNotIntersectingSegs(e,t){switch(k.getTriangleOrientation(e.Start,t.Start,t.Start.add(t.Direction))){case nt.Counterclockwise:return-1;case nt.Clockwise:return 1;default:return 0}}CompareObstacleSideAndConeSide(e){const t=k.getTriangleOrientation(this.x,e.Start,e.Start.add(e.Direction));return t==nt.Counterclockwise?-1:t==nt.Clockwise?1:e instanceof yl?-1:1}CompareConeSideAndObstacleSide(e,t){const n=k.getTriangleOrientation(this.x,t.start,t.End);return n==nt.Counterclockwise?-1:n==nt.Clockwise||e instanceof yl?1:-1}IntersectionOfSegmentAndSweepLine(e){const t=e.Direction.dot(this.coneSweeper.SweepDirection),n=(this.coneSweeper.Z-e.Start.dot(this.coneSweeper.SweepDirection))/t;return e.Start.add(e.Direction.mul(n))}CompareBrokenSides(e,t){return e.EndVertex==t.EndVertex?GS.CompareNotIntersectingSegs(e.ConeSide,t.ConeSide):k.getTriangleOrientation(this.x,t.start,t.EndVertex.point)==nt.Counterclockwise?-1:1}}class Py extends pc{constructor(e,t,n){super(),this.coneLeftSide=e,this.intersectionPoint=t,this.endVertex=n}get EndVertex(){return this.endVertex}get Site(){return this.intersectionPoint}toString(){return"LeftIntersectionEvent "+this.intersectionPoint}}class wT{get Direction(){return this.End.sub(this.Start)}toString(){return this.Start+" "+this.End}}class vT extends wT{constructor(e){super(),this.Init(e)}Init(e){this.StartVertex=e}get Polyline(){return this.StartVertex.polyline}get Start(){return this.StartVertex.point}get End(){return this.EndVertex.point}}class ag extends vT{constructor(e){super(e),this.end=e.nextOnPolyline.point}get End(){return this.end}get EndVertex(){return this.StartVertex.nextOnPolyline}}class ed extends sg{constructor(e){super(e)}}class iL extends pc{constructor(e,t,n){super(),this.coneRightSide=e,this.intersectionPoint=t,this.endVertex=n}get EndVertex(){return this.endVertex}set EndVertex(e){this.endVertex=e}get Site(){return this.intersectionPoint}toString(){return"RightIntersectionEvent "+this.intersectionPoint}}class lg extends vT{constructor(e){super(e),this.end=e.prevOnPolyline.point}get End(){return this.end}get EndVertex(){return this.StartVertex.prevOnPolyline}}class td extends sg{constructor(e){super(e)}}class yi extends nL{constructor(e,t,n,i,s,o,a){super(e,t),this.visibilityGraph=s,this.ConeRightSideDirection=n,this.ConeLeftSideDirection=i,this.coneSideComparer=new GS(this),this.leftConeSides=new uo((l,c)=>this.coneSideComparer.Compare(l,c)),this.rightConeSides=new uo((l,c)=>this.coneSideComparer.Compare(l,c)),this.Ports=o,this.BorderPolyline=a,this.PortEdgesCreator=(l,c)=>new ml(l,c,0)}static Sweep(e,t,n,i,s,o){new yi(e,t,t.rotate(-n/2),t.rotate(n/2),i,s,o).Calculate()}Calculate(){for(this.InitQueueOfEvents();this.EventQueue.Count>0;)this.ProcessEvent(this.EventQueue.Dequeue());null!=this.BorderPolyline&&this.CloseRemainingCones(),this.CreatePortEdges()}CreatePortEdges(){if(null!=this.portEdgesGraph)for(const e of this.portEdgesGraph.Edges)this.visibilityGraph.AddEdgeF(e.SourcePoint,e.TargetPoint,this.PortEdgesCreator)}CloseRemainingCones(){if(0==this.leftConeSides.count)return;let e=this.BorderPolyline.startPoint,t=this.leftConeSides.count;do{const n=this.leftConeSides.treeMinimum().item.Cone;e=this.FindPolylineSideIntersectingConeRightSide(e,n),e=this.GetPolylinePointInsideOfConeAndRemoveCones(e,n),t--}while(this.leftConeSides.count>0&&t>0)}GetPolylinePointInsideOfConeAndRemoveCones(e,t){const n=e.nextOnPolyline,i=yi.FindInsidePoint(e.point,n.point,t);return k.closeDistEps(i,e.point)?(this.AddEdgeAndRemoveCone(t,e.point),this.AddEdgesAndRemoveRemainingConesByPoint(e.point)):k.closeDistEps(i,n.point)?(this.AddEdgeAndRemoveCone(t,n.point),this.AddEdgesAndRemoveRemainingConesByPoint(n.point),e=n):(e=yi.InsertPointIntoPolylineAfter(this.BorderPolyline,e,i),this.AddEdgeAndRemoveCone(t,e.point),this.AddEdgesAndRemoveRemainingConesByPoint(e.point)),e}static FindInsidePoint(e,t,n){return yi.FindInsidePointBool(e,t,n.Apex,n.Apex.add(n.LeftSideDirection),n.Apex.add(n.RightSideDirection))}static FindInsidePointBool(e,t,n,i,s){if(k.closeDistEps(e,t)||k.PointIsInsideCone(e,n,i,s))return e;if(k.PointIsInsideCone(t,n,i,s))return t;const o=k.middle(e,t);return k.pointToTheLeftOfLine(o,n,i)?yi.FindInsidePointBool(o,t,n,i,s):yi.FindInsidePointBool(e,o,n,i,s)}AddEdgesAndRemoveRemainingConesByPoint(e){const t=new Array;for(const n of this.leftConeSides){if(!k.PointToTheRightOfLineOrOnLine(e,n.Start,n.Start.add(n.Direction)))break;t.push(n.Cone)}for(const n of t)this.AddEdgeAndRemoveCone(n,e)}FindPolylineSideIntersectingConeRightSide(e,t){const n=e,i=t.Apex,s=t.Apex.add(this.ConeRightSideDirection);let o=yi.GetSign(e,i,s);for(;;){const a=e.nextOnPolyline,l=yi.GetSign(a,i,s);if(l-o>0)return e;if(o=l,(e=a)==n)throw new Error("cannod decide if the polyline intersects the cone!")}}static GetSign(e,t,n){const i=k.signedDoubledTriangleArea(t,n,e.point);return i<0?1:i>0?-1:0}AddEdgeAndRemoveCone(e,t){null!=this.Ports&&this.Ports.has(e.Apex)?this.CreatePortEdge(e,t):this.visibilityGraph.AddEdgePP(e.Apex,t),this.RemoveCone(e)}CreatePortEdge(e,t){null==this.portEdgesGraph&&(this.portEdgesGraph=new Or);const n=this.portEdgesGraph.FindVertex(e.Apex),i=null!=n?Array.from(n.InEdges).concat(Array.from(n.OutEdges.allNodes())):null;if(i)for(const s of i){const o=(s.Target==n?s.Source:s.Target).point;Or.RemoveEdge(s),this.portEdgesGraph.AddEdgePP(o,t)}this.portEdgesGraph.AddEdgePP(e.Apex,t)}static InsertPointIntoPolylineAfter(e,t,n){let i;return null!=t.next?(i=oo.mkFromPoint(n),i.prev=t,i.next=t.next,t.next.prev=i,t.next=i):(i=oo.mkFromPoint(n),i.prev=t,t.next=i,e.endPoint=i),i.polyline=e,e.setInitIsRequired(),i}ProcessEvent(e){e instanceof sg?this.ProcessVertexEvent(e):e instanceof iL?this.ProcessRightIntersectionEvent(e):e instanceof Py?this.ProcessLeftIntersectionEvent(e):(e instanceof rL?e.ConeToClose.Removed||this.RemoveCone(e.ConeToClose):this.ProcessPortObstacleEvent(e),this.Z=this.GetZS(e))}ProcessPortObstacleEvent(e){this.Z=this.GetZS(e),this.GoOverConesSeeingVertexEvent(e),this.CreateConeOnVertex(e)}ProcessLeftIntersectionEvent(e){if(0==e.coneLeftSide.Removed)if(Math.abs(e.EndVertex.point.sub(e.Site).dot(this.SweepDirection))<le.distanceEpsilon)this.RemoveCone(e.coneLeftSide.Cone);else{this.RemoveSegFromLeftTree(e.coneLeftSide),this.Z=this.GetZP(e.Site);const t=new Tu(e.Site,e.EndVertex,e.coneLeftSide);this.InsertToTree(this.leftConeSides,t),e.coneLeftSide.Cone.LeftSide=t,this.LookForIntersectionOfObstacleSideAndLeftConeSide(e.Site,e.EndVertex),this.TryCreateConeClosureForLeftSide(t)}else this.Z=this.GetZP(e.Site)}TryCreateConeClosureForLeftSide(e){if(e.Cone.RightSide instanceof Ou){const t=e.Cone.RightSide;k.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.EndVertex.point)==nt.Clockwise&&this.CreateConeClosureEvent(e,t)}}CreateConeClosureEvent(e,t){const n=k.RayIntersectsRayInteriors(e.start,e.Direction,t.Start,t.Direction),i=new rL(n,e.Cone);this.EnqueueEvent(i)}ProcessRightIntersectionEvent(e){if(0==e.coneRightSide.Removed){this.RemoveSegFromRightTree(e.coneRightSide),this.Z=this.GetZP(e.Site);const t=new Tu(e.Site,e.EndVertex,e.coneRightSide);this.InsertToTree(this.rightConeSides,t),e.coneRightSide.Cone.RightSide=t,this.LookForIntersectionOfObstacleSideAndRightConeSide(e.Site,e.EndVertex),this.TryCreateConeClosureForRightSide(t)}else this.Z=this.GetZP(e.Site)}TryCreateConeClosureForRightSide(e){if(e.Cone.LeftSide instanceof yl){const n=e.Cone.LeftSide;k.getTriangleOrientation(n.Start,n.Start.add(n.Direction),e.EndVertex.point)==nt.Counterclockwise&&this.CreateConeClosureEvent(e,n)}}RemoveConesClosedBySegment(e,t){this.CloseConesCoveredBySegment(e,t,this.GetZP(e)>this.GetZP(t)?this.leftConeSides:this.rightConeSides)}CloseConesCoveredBySegment(e,t,n){let i=n.findFirst(a=>k.getTriangleOrientation(a.Start,a.Start.add(a.Direction),e)==nt.Counterclockwise);if(null==i||!k.IntervalIntersectsRay(e,t,i.item.Start,i.item.Direction))return;const o=new Array;do{o.push(i.item.Cone),i=n.next(i)}while(null!=i&&null!=k.IntervalIntersectsRay(e,t,i.item.Start,i.item.Direction));for(const a of o)this.RemoveCone(a)}ProcessVertexEvent(e){this.Z=this.GetZS(e),this.GoOverConesSeeingVertexEvent(e),this.AddConeAndEnqueueEvents(e)}static Diamond(e){return gs.CreateDiamond(2,2,e)}AddConeAndEnqueueEvents(e){e instanceof ed?this.CloseConesAddConeAtLeftVertex(e,e.Vertex.nextOnPolyline):(e instanceof td||this.CloseConesAddConeAtLeftVertex(e,e.Vertex.nextOnPolyline),this.CloseConesAddConeAtRightVertex(e,e.Vertex.prevOnPolyline))}CloseConesAddConeAtRightVertex(e,t){const n=e.Vertex.nextOnPolyline.point;this.directionPerp.dot(e.Site.sub(n))>le.distanceEpsilon&&this.RemoveConesClosedBySegment(n,e.Vertex.point),this.directionPerp.dot(t.point.sub(e.Site))>le.distanceEpsilon&&this.RemoveConesClosedBySegment(e.Site,t.point);const i=e.Site,s=i.add(this.ConeLeftSideDirection),o=i.add(this.ConeRightSideDirection),a=t.point;this.GetZP(i.sub(n))>le.distanceEpsilon&&this.RemoveRightSide(new lg(e.Vertex.nextOnPolyline)),this.GetZP(i.sub(t.point))>le.distanceEpsilon&&this.RemoveLeftSide(new ag(t)),this.GetZP(a)+le.distanceEpsilon<this.GetZS(e)&&this.CreateConeOnVertex(e),k.PointToTheRightOfLineOrOnLine(a,i,s)?k.PointToTheLeftOfLineOrOnLine(a,i,o)?this.CaseToTheLeftOfLineOrOnLineConeRp(e,t):(this.GetZP(a.sub(i))>le.distanceEpsilon&&(this.LookForIntersectionOfObstacleSideAndLeftConeSide(e.Site,t),this.InsertRightSide(new lg(e.Vertex))),this.EnqueueRightVertexEvent(new td(t))):(this.CreateConeOnVertex(e),k.PointToTheLeftOfLineOrOnLine(a.add(this.DirectionPerp),a,i)&&this.EnqueueRightVertexEvent(new td(t)))}CaseToTheLeftOfLineOrOnLineConeRp(e,t){this.EnqueueRightVertexEvent(new td(t));const n=new ET(e.Vertex.point,this),i=new Tu(n.Apex,t,new yl(n));n.LeftSide=i,n.RightSide=new Ou(n);const s=this.InsertToTree(this.rightConeSides,n.RightSide);this.LookForIntersectionWithConeRightSide(s);const o=this.InsertToTree(this.leftConeSides,n.LeftSide);this.FixConeLeftSideIntersections(i,o),this.GetZP(t.point.sub(e.Site))>le.distanceEpsilon&&this.InsertRightSide(new lg(e.Vertex))}LookForIntersectionOfObstacleSideAndRightConeSide(e,t){const n=this.GetLastNodeToTheLeftOfPointInRightSegmentTree(e);if(null!=n&&n.item instanceof Ou!=null){const s=k.IntervalIntersectsRay(e,t.point,n.item.Start,this.ConeRightSideDirection);s&&this.SegmentIsNotHorizontal(s,t.point)&&this.EnqueueEvent(this.CreateRightIntersectionEvent(n.item,s,t))}}CreateRightIntersectionEvent(e,t,n){return new iL(e,t,n)}GetLastNodeToTheLeftOfPointInRightSegmentTree(e){return this.rightConeSides.findLast(t=>yi.PointIsToTheRightOfSegment(e,t))}LookForIntersectionOfObstacleSideAndLeftConeSide(e,t){const n=this.GetFirstNodeToTheRightOfPoint(e);if(null==n||!(n.item instanceof yl))return;const i=n.item,s=k.IntervalIntersectsRay(e,t.point,i.Start,this.ConeLeftSideDirection);s&&this.EnqueueEvent(new Py(i,s,t))}GetFirstNodeToTheRightOfPoint(e){return this.leftConeSides.findFirst(t=>yi.PointIsToTheLeftOfSegment(e,t))}static PointIsToTheLeftOfSegment(e,t){return k.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e)==nt.Counterclockwise}static PointIsToTheRightOfSegment(e,t){return k.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e)==nt.Clockwise}FixConeLeftSideIntersections(e,t){do{t=this.leftConeSides.next(t)}while(null!=t&&k.PointToTheRightOfLineOrOnLine(e.Start,t.item.Start,t.item.Start.add(t.item.Direction)));if(null!=t&&t.item instanceof yl){const n=t.item,i=k.IntervalIntersectsRay(e.start,e.End,n.Start,n.Direction);i&&this.EnqueueEvent(new Py(n,i,e.EndVertex))}}InsertToTree(e,t){return this.coneSideComparer.SetOperand(t),e.insert(t)}CloseConesAddConeAtLeftVertex(e,t){const n=e.Vertex.prevOnPolyline.point;e.Site.sub(n).dot(this.directionPerp)<-le.distanceEpsilon&&this.RemoveConesClosedBySegment(e.Site,n),t.point.sub(e.Site).dot(this.directionPerp)<-le.distanceEpsilon&&this.RemoveConesClosedBySegment(t.point,e.Site);const i=e.Site,s=i.add(this.ConeLeftSideDirection),o=i.add(this.ConeRightSideDirection),a=t.point;this.GetZP(i.sub(n))>le.distanceEpsilon&&this.RemoveLeftSide(new ag(e.Vertex.prevOnPolyline));const l=this.GetZP(a)-this.Z;l<-le.distanceEpsilon&&this.RemoveRightSide(new lg(t));const c=a.sub(e.Site);if(l<-le.distanceEpsilon||an(l,0)&&this.GetZP(c)>0&&c.dot(this.directionPerp)>-le.distanceEpsilon)this.CreateConeOnVertex(e);else if(k.PointToTheLeftOfLineOrOnLine(a,i,o))if(k.PointToTheLeftOfLineOrOnLine(a,i,s))this.EnqueueEvent(new ed(t)),this.GetZP(c)>le.distanceEpsilon&&(this.LookForIntersectionOfObstacleSideAndRightConeSide(e.Site,t),this.InsertLeftSide(new ag(e.Vertex)));else{this.EnqueueEvent(new ed(t));const d=new ET(e.Vertex.point,this),b=new Tu(e.Vertex.point,t,new Ou(d));d.RightSide=b,d.LeftSide=new yl(d),this.LookForIntersectionWithConeLeftSide(this.InsertToTree(this.leftConeSides,d.LeftSide));const N=this.InsertToTree(this.rightConeSides,b);this.FixConeRightSideIntersections(b,N),this.GetZP(c)>le.distanceEpsilon&&this.InsertLeftSide(new ag(e.Vertex))}else this.CreateConeOnVertex(e),this.EnqueueEvent(new ed(t))}RemoveCone(e){e.Removed=!0,this.RemoveSegFromLeftTree(e.LeftSide),this.RemoveSegFromRightTree(e.RightSide)}RemoveSegFromRightTree(e){this.coneSideComparer.SetOperand(e);let t=this.rightConeSides.remove(e);if(e.Removed=!0,null==t){const n=this.Z;this.Z=Math.max(this.GetZP(e.Start),this.Z-.01),this.coneSideComparer.SetOperand(e),t=this.rightConeSides.remove(e),this.Z=n}}RemoveSegFromLeftTree(e){if(e.Removed=!0,this.coneSideComparer.SetOperand(e),null==this.leftConeSides.remove(e)){const n=this.Z;this.Z=Math.max(this.GetZP(e.Start),this.Z-.01),this.coneSideComparer.SetOperand(e),this.leftConeSides.remove(e),this.Z=n}}FixConeRightSideIntersections(e,t){do{t=this.rightConeSides.previous(t)}while(null!=t&&k.PointToTheLeftOfLineOrOnLine(e.start,t.item.Start,t.item.Start.add(t.item.Direction)));if(null!=t){let n;if(t.item instanceof Ou){const i=t.item;(n=k.IntervalIntersectsRay(e.start,e.End,i.Start,i.Direction))&&this.EnqueueEvent(this.CreateRightIntersectionEvent(i,n,e.EndVertex))}}}CreateConeOnVertex(e){const t=new ET(e.Site,this);t.LeftSide=new yl(t),t.RightSide=new Ou(t);const n=this.InsertToTree(this.leftConeSides,t.LeftSide),i=this.InsertToTree(this.rightConeSides,t.RightSide);this.LookForIntersectionWithConeRightSide(i),this.LookForIntersectionWithConeLeftSide(n)}LookForIntersectionWithConeLeftSide(e){if(e.item instanceof yl){const n=e.item,i=this.FindFirstObstacleSideToTheLeftOfPoint(n.Start);null!=i&&this.TryIntersectionOfConeLeftSideAndObstacleSide(n,i)}else{const n=e.item;null!=(e=this.leftConeSides.next(e))&&e.item instanceof yl&&this.TryIntersectionOfConeLeftSideAndObstacleConeSide(e.item,n)}}LookForIntersectionWithConeRightSide(e){if(e.item instanceof Ou){const n=e.item,i=this.FindFirstObstacleSideToToTheRightOfPoint(n.Start);null!=i&&this.TryIntersectionOfConeRightSideAndObstacleSide(n,i)}else{const n=e.item;null!=(e=this.rightConeSides.previous(e))&&e.item instanceof Ou&&this.TryIntersectionOfConeRightSideAndObstacleConeSide(e.item,n)}}TryIntersectionOfConeRightSideAndObstacleConeSide(e,t){const n=k.IntervalIntersectsRay(t.start,t.End,e.Start,e.Direction);n&&this.EnqueueEvent(this.CreateRightIntersectionEvent(e,n,t.EndVertex))}TryIntersectionOfConeRightSideAndObstacleSide(e,t){const n=k.IntervalIntersectsRay(t.Start,t.End,e.Start,e.Direction);n&&this.EnqueueEvent(this.CreateRightIntersectionEvent(e,n,t.EndVertex))}TryIntersectionOfConeLeftSideAndObstacleConeSide(e,t){const n=k.IntervalIntersectsRay(t.start,t.End,e.Start,e.Direction);n&&this.EnqueueEvent(new Py(e,n,t.EndVertex))}TryIntersectionOfConeLeftSideAndObstacleSide(e,t){const n=k.IntervalIntersectsRay(t.Start,t.End,e.Start,e.Direction);n&&this.EnqueueEvent(new Py(e,n,t.EndVertex))}Show(e,t){let n=Array.from(this.Obstacles).map(i=>qt.mkDebugCurveTWCI(200,.5,"Blue",i));for(const i of this.rightConeSides)n.push(qt.mkDebugCurveWCI(.5,"Brown",this.ExtendSegmentToZ(i))),i instanceof Tu&&n.push(qt.mkDebugCurveCI("brown",yi.Diamond(i.start))),n.push(qt.mkDebugCurveWCI(.5,"Green",this.ExtendSegmentToZ(i.Cone.LeftSide))),i.Cone.LeftSide instanceof Tu&&n.push(qt.mkDebugCurveCI("green",yi.Diamond(i.Cone.LeftSide.start)));n=n.concat(Array.from(this.visibilityGraph.Edges).map(i=>qt.mkDebugCurveWCI(2,"Black",Me.mkPP(i.SourcePoint,i.TargetPoint)))),n=n.concat(e.map(i=>qt.mkDebugCurveCI("Red",i)))}ExtendSegmentToZ(e){const t=e.Direction.dot(this.SweepDirection),n=(this.Z+40-e.Start.dot(this.SweepDirection))/t;return Me.mkPP(e.Start,e.Start.add(e.Direction.mul(n)))}GoOverConesSeeingVertexEvent(e){let t=this.FindFirstSegmentInTheRightTreeNotToTheLeftOfVertex(e);if(null==t)return;const i=t.item.Cone,s=i.LeftSide;if(yi.VertexIsToTheLeftOfSegment(e,s))return;const o=[i];if(this.coneSideComparer.SetOperand(s),t=this.leftConeSides.find(s),null==t){const a=this.Z;this.Z=Math.max(this.GetZP(s.Start),this.PreviousZ),this.coneSideComparer.SetOperand(s),t=this.leftConeSides.find(s),this.Z=a}if(null!=t||(t=this.GetRbNodeEmergency(t,s),null!=t)){for(t=this.leftConeSides.next(t);null!=t&&!yi.VertexIsToTheLeftOfSegment(e,t.item);)o.push(t.item.Cone),t=this.leftConeSides.next(t);for(const a of o)this.AddEdgeAndRemoveCone(a,e.Site)}}GetRbNodeEmergency(e,t){for(let n=this.leftConeSides.treeMinimum();null!=n;n=this.leftConeSides.next(n))if(n.item==t){e=n;break}return e}static VertexIsToTheLeftOfSegment(e,t){return k.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.Site)==nt.Counterclockwise}static VertexIsToTheRightOfSegment(e,t){return k.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.Site)==nt.Clockwise}FindFirstSegmentInTheRightTreeNotToTheLeftOfVertex(e){return this.rightConeSides.findFirst(t=>!yi.VertexIsToTheRightOfSegment(e,t))}EnqueueRightVertexEvent(e){this.GetZP(e.Site.sub(e.Vertex.prevOnPolyline.point))>le.tolerance||this.EnqueueEvent(e)}invariant(){for(const e of this.leftConeSides)if(e.Removed)return!1;for(const e of this.rightConeSides)if(e.Removed)return!1;return!0}}class Ny extends Rr{constructor(e,t){super(null),this.coneAngle=Math.PI/6,this.ports=new Fr,this._obstacles=Array.from(Or.OrientHolesClockwise(e)),this._visibilityGraph=t}static mk(e,t,n,i,s){const o=new Ny(e,t);return o.Ports=i,o.BorderPolyline=s,o.ConeAngle=n,o}get ConeAngle(){return this.coneAngle}set ConeAngle(e){this.coneAngle=e}get Ports(){return this.ports}set Ports(e){this.ports=e}get BorderPolyline(){return this.borderPolyline}set BorderPolyline(e){this.borderPolyline=e}get Bidirectional(){return this._bidirectional}set Bidirectional(e){this._bidirectional=e}static GetTotalSteps(e){return Math.floor((2*Math.PI-e/2)/e)+1}run(){const e=2*Math.PI-this.coneAngle/2;if(this.Bidirectional)this.HandleBideractionalCase();else{let t;for(let n=0;(t=this.coneAngle*n)<=e;n++)super.ProgressStep(),this.AddDirection(new k(Math.cos(t),Math.sin(t)),this.BorderPolyline,this._visibilityGraph)}}HandleBideractionalCase(){const e=Math.PI/this.coneAngle;for(let t=0;t<e;t++){const n=t*this.coneAngle,i=new Or;this.AddDirection(new k(Math.cos(n),Math.sin(n)),this.BorderPolyline,i);const s=new Or;this.AddDirection(new k(-1*Math.cos(n),-1*Math.sin(n)),this.BorderPolyline,s),this.AddIntersectionOfBothDirectionSweepsToTheResult(i,s)}}AddIntersectionOfBothDirectionSweepsToTheResult(e,t){for(const n of e.Edges)null!=t.FindEdgePP(n.SourcePoint,n.TargetPoint)&&this._visibilityGraph.AddEdgePP(n.SourcePoint,n.TargetPoint)}AddDirection(e,t,n){yi.Sweep(this._obstacles,e,this.coneAngle,n,this.Ports,t)}}class Zi extends gT{constructor(e){super(),this.adjustmentAngle=Math.PI/10,this.hookSize=9,this.curve=e,this.location=this.curve().start}mk(e,t){const n=new Zi(e);return n.HookSize=t,n}get Location(){return this.location}get Curve(){return this.curve()}SetLocation(e){this.location=e}get AdjustmentAngle(){return this.adjustmentAngle}set AdjustmentAngle(e){this.adjustmentAngle=e}get HookSize(){return this.hookSize}set HookSize(e){this.hookSize=e}}class $o extends Ru{constructor(e,t,n=new k(0,0)){super(e,t,n)}get LoosePolyline(){return this.loosePolyline}set LoosePolyline(e){this.loosePolyline=e}static mk(e,t){return new $o(e,t)}}class Ys extends gT{get Location(){return this.curve.value(this.parameter)}set Location(e){throw new Error("Method should not be called.")}static mk(e,t){const n=new Ys;return n.curve=e,n.parameter=t,n}get Parameter(){return this.parameter}set Parameter(e){this.parameter=e}get Curve(){return this.curve}set Curve(e){this.curve=e}}class ST extends ig{constructor(e){super(null),this.curveDelegate=e}get BoundaryCurve(){return this.curveDelegate()}set BoundaryCurve(e){if(e)throw new Error("Cannot set BoundaryCurve directly for RelativeShape")}}class Fa{static GetShapes(e,t){const n=new Map;for(const i of e)Fa.ProcessAncestorDescendantCouple(i.target,i.source,n),Fa.InsertEdgePortsToShapes(n,i);for(const i of t)Fa.ProcessAncestorDescendantCouple(i.source,i.target,n),Fa.InsertEdgePortsToShapes(n,i);return Fa.BindShapes(n),Array.from(n.values())}static InsertEdgePortsToShapes(e,t){e.get(t.target).Ports.add(t.targetPort),e.get(t.source).Ports.add(t.sourcePort)}static BindShapes(e){for(const[t,n]of e){if(!(t instanceof xa))continue;const i=t;for(const s of AT(i)){const o=e.get(s);o&&n.AddChild(o)}}}static ProcessAncestorDescendantCouple(e,t,n){let i=VS(t);for(;;){for(const s of AT(i))Fa.CreateShapeIfNeeeded(s,n);if(i==e)break;i=VS(i)}Fa.CreateShapeIfNeeeded(i,n)}static CreateShapeIfNeeeded(e,t){t.has(e)||t.set(e,new ST(()=>e.boundaryCurve))}static NumberOfActiveNodesIsUnderThreshold(e,t,n){const i=new Set;for(const s of e)if(Fa.SetOfActiveNodesIsLargerThanThreshold(s.target,s.source,i,n))return!1;for(const s of t)if(Fa.SetOfActiveNodesIsLargerThanThreshold(s.source,s.target,i,n))return!1;return!0}static SetOfActiveNodesIsLargerThanThreshold(e,t,n,i){let s=VS(t);for(;;){for(const o of AT(s))if(n.add(o),n.size>i)return!0;if(s==e)break;s=VS(s)}return n.add(s),n.size>i}}function VS(r){return di.getGeom(r.node.parent)}function*AT(r){for(const e of r.graph.shallowNodes)yield di.getGeom(e)}class Ba{constructor(e){this.stamp=0,this.SetPivotAndAllocateHullPointsArray(e)}SetPivotAndAllocateHullPointsArray(e){this.pivot=new k(0,Number.MAX_SAFE_INTEGER);let t=-1,n=0;for(const i of e)(i.y<this.pivot.y||i.y==this.pivot.y&&i.x>this.pivot.x)&&(this.pivot=i,t=n),n++;if(n>=1){this.hullPoints=new Array(n-1),n=0;for(const i of e)n!=t?this.hullPoints[n++]={point:i,deleted:!1,stamp:this.stamp++}:t=-1}}get StackTopPoint(){return this.stack.point}get StackSecondPoint(){return this.stack.next.point}static*CalculateConvexHull(e){const t=new Ba(e);for(const n of t.Calculate())yield n}*Calculate(){if(this.pivot.y!=Number.MAX_SAFE_INTEGER){if(0==this.hullPoints.length)return void(yield this.pivot);this.SortAllPointsWithoutPivot(),this.Scan();for(const e of this.EnumerateStack())yield e}}*EnumerateStack(){let e=this.stack;for(;null!=e;)yield e.point,e=e.next}Scan(){let e=0;for(;this.hullPoints[e].deleted;)e++;for(this.stack={point:this.pivot,next:null},this.Push(e++),e<this.hullPoints.length&&(this.hullPoints[e].deleted?e++:this.Push(e++));e<this.hullPoints.length;)this.hullPoints[e].deleted?e++:this.LeftTurn(e)?this.Push(e++):this.Pop();for(;this.StackHasMoreThanTwoPoints()&&!this.LeftTurnToPivot();)this.Pop()}LeftTurnToPivot(){return k.getTriangleOrientation(this.StackSecondPoint,this.StackTopPoint,this.pivot)==nt.Counterclockwise}StackHasMoreThanTwoPoints(){return null!=this.stack.next&&null!=this.stack.next.next}Pop(){this.stack=this.stack.next}LeftTurn(e){if(null==this.stack.next)return!0;const t=k.getTriangleOrientationWithIntersectionEpsilon(this.StackSecondPoint,this.StackTopPoint,this.hullPoints[e].point);return t==nt.Counterclockwise||t!=nt.Clockwise&&this.BackSwitchOverPivot(this.hullPoints[e].point)}BackSwitchOverPivot(e){return null==this.stack.next.next&&this.StackTopPoint.x>this.pivot.x+le.distanceEpsilon&&e.x<this.pivot.x-le.distanceEpsilon}Push(e){this.stack={point:this.hullPoints[e].point,next:this.stack}}SortAllPointsWithoutPivot(){this.hullPoints.sort(function e4(r){return(e,t)=>{if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;switch(k.getTriangleOrientationWithIntersectionEpsilon(r,e.point,t.point)){case nt.Counterclockwise:return-1;case nt.Clockwise:return 1;case nt.Collinear:const n=e.point.x-r.x,i=t.point.x-r.x;if(n>le.distanceEpsilon&&i<-1*le.distanceEpsilon)return-1;if(n<-1*le.distanceEpsilon&&i>le.distanceEpsilon)return 1;const s=e.point.sub(r),o=t.point.sub(r),a=s.l1-o.l1;return a<0?(e.deleted=!0,-1):a>0?(t.deleted=!0,1):(e.stamp>t.stamp?e.deleted=!0:t.deleted=!0,0)}throw new Error}}(this.pivot))}static createConvexHullAsClosedPolyline(e){return At.mkClosedFromPoints(Array.from(Ba.CalculateConvexHull(e)))}}function ho(r,e,t){!r.irect.intersects_rect(e.irect)||(null==r.Left?null==e.Left?t(r.UserData,e.UserData):(ho(r,e.Left,t),ho(r,e.Right,t)):null!=e.Left?(ho(r.Left,e.Left,t),ho(r.Left,e.Right,t),ho(r.Right,e.Left,t),ho(r.Right,e.Right,t)):(ho(r.Left,e,t),ho(r.Right,e,t)))}function es(r,e,t){!r.irect.intersects_rect(e.irect)||(r==e?function n4(r,e){null!=r.Left&&(es(r.Left,r.Left,e),es(r.Left,r.Right,e),es(r.Right,r.Right,e))}(r,t):null==r.Left?null==e.Left?t(r.UserData,e.UserData):(es(r,e.Left,t),es(r,e.Right,t)):null!=e.Left?(es(r.Left,e.Left,t),es(r.Left,e.Right,t),es(r.Right,e.Left,t),es(r.Right,e.Right,t)):(es(r.Left,e,t),es(r.Right,e,t)))}function Ko(r,e,t){if(!r.irect.intersects_rect(e.irect))return!1;if(r==e)return function t4(r,e){return null!=r.Left&&(Ko(r.Left,r.Left,e)||Ko(r.Left,r.Right,e)||Ko(r.Right,r.Right,e))}(r,t);if(null==r.Left){if(null==e.Left)return t(r.UserData,e.UserData);if(Ko(r,e.Left,t)||Ko(r,e.Right,t))return!0}else if(null!=e.Left){if(Ko(r.Left,e.Left,t)||Ko(r.Left,e.Right,t)||Ko(r.Right,e.Left,t)||Ko(r.Right,e.Right,t))return!0}else if(Ko(r.Left,e,t)||Ko(r.Right,e,t))return!0;return!1}var Ei=(()=>{return(r=Ei||(Ei={}))[r.Increasing=0]="Increasing",r[r.Decreasing=1]="Decreasing",r[r.Extremum=2]="Extremum",Ei;var r})();class HS{constructor(e,t){this.f=e,this.length=t}get Sequence(){return this.f}set Sequence(e){this.f=e}get Length(){return this.length}set Length(e){this.length=e}FindMinimum(){let e=0,t=this.length-1,n=e+Math.floor((t-e)/2);const i=this.f(n);if(i>=this.f(0)&&i>=this.f(this.length-1))return this.f(0)<this.f(this.length-1)?0:this.length-1;for(;t-e>1;)switch(n=e+Math.floor((t-e)/2),this.BehaviourAtIndex(n)){case Ei.Decreasing:e=n;break;case Ei.Increasing:t=n;break;case Ei.Extremum:return n}return e==t||this.f(e)<=this.f(t)?e:t}BehaviourAtIndex(e){const t=this.f(e);if(0==e){const s=this.f(1);return s==t?Ei.Extremum:s>t?Ei.Increasing:Ei.Decreasing}if(e==this.length-1){const s=this.f(this.length-2);return s==t?Ei.Extremum:s>t?Ei.Decreasing:Ei.Increasing}const n=t-this.f(e-1);return n*(this.f(e+1)-t)<=0?Ei.Extremum:n>0?Ei.Increasing:Ei.Decreasing}FindMaximum(){let e=0,t=this.length-1,n=e+Math.floor((t-e)/2);const i=this.f(n);if(i<=this.f(0)&&i<=this.f(this.length-1))return this.f(0)>this.f(this.length-1)?0:this.length-1;for(;t-e>1;)switch(n=e+Math.floor((t-e)/2),this.BehaviourAtIndex(n)){case Ei.Decreasing:t=n;break;case Ei.Increasing:e=n;break;case Ei.Extremum:return n}return e==t||this.f(e)>this.f(t)?e:t}}class r4{constructor(e,t){this.f=e,this.length=t}toArray(){const e=[];for(let t=0;t<this.length;t++)e.push(this.f(t));return e}GetAdjustedSequenceForMinimum(){const e=this.f(0),n=(this.f(this.length-1)-e)/(this.length-1);return i=>Math.min(this.f(i),e+n*i)}GetAdjustedSequenceForMaximum(){const e=this.f(0),n=(this.f(this.length-1)-e)/(this.length-1);return i=>Math.max(this.f(i),e+n*i)}FindMinimum(){return this.f(0)==this.f(this.length-1)?new HS(this.f,this.length).FindMinimum():new HS(this.GetAdjustedSequenceForMinimum(),this.length).FindMinimum()}FindMaximum(){return this.f(0)==this.f(this.length-1)?new HS(this.f,this.length).FindMaximum():new HS(this.GetAdjustedSequenceForMaximum(),this.length).FindMaximum()}}class YS{constructor(e,t){this.P=e,this.Q=t}LeftFromLineOnP(e,t,n){const i=this.P.pnt(e);return this.upperBranchOnP?k.pointToTheLeftOfLineOrOnLine(n,i,t):k.pointToTheRightOfLineOrOnLine(n,i,t)}LeftFromLineOnQ(e,t,n){const i=this.Q.pnt(e);return this.lowerBranchOnQ?k.pointToTheLeftOfLineOrOnLine(n,i,t):k.pointToTheRightOfLineOrOnLine(n,i,t)}PrevOnP(e){return this.upperBranchOnP?this.P.Prev(e):this.P.Next(e)}PrevOnQ(e){return this.lowerBranchOnQ?this.Q.Prev(e):this.Q.Next(e)}NextOnP(e){return this.upperBranchOnP?this.P.Next(e):this.P.Prev(e)}NextOnQ(e){return this.lowerBranchOnQ?this.Q.Next(e):this.Q.Prev(e)}MedianOnP(e,t){return this.upperBranchOnP?this.P.Median(e,t):this.P.Median(t,e)}MedianOnQ(e,t){return this.lowerBranchOnQ?this.Q.Median(e,t):this.Q.Median(t,e)}ModuleP(e,t){return this.P.Module(this.upperBranchOnP?t-e:e-t)}ModuleQ(e,t){return this.Q.Module(this.lowerBranchOnQ?t-e:e-t)}TangentBetweenBranches(e,t,n,i){for(;t!=e||i!=n;){const s=t!=e?this.MedianOnP(e,t):e,o=i!=n?this.MedianOnQ(n,i):n,a=this.P.pnt(s),l=this.Q.pnt(o);let c=!0;this.ModuleP(e,t)>1?this.LeftFromLineOnP(this.NextOnP(s),a,l)?e=s:this.LeftFromLineOnP(this.PrevOnP(s),a,l)?t=s:c=!1:t!=e?this.LeftFromLineOnP(t,this.P.pnt(e),l)?e=t:this.LeftFromLineOnP(e,this.P.pnt(t),l)?t=e:c=!1:c=!1;let d=!0;this.ModuleQ(n,i)>1?this.LeftFromLineOnQ(this.NextOnQ(o),l,a)?n=o:this.LeftFromLineOnQ(this.PrevOnQ(o),l,a)?i=o:d=!1:i!=n?this.LeftFromLineOnQ(i,this.Q.pnt(n),a)?n=i:this.LeftFromLineOnQ(n,this.Q.pnt(i),a)?i=n:d=!1:d=!1,!c&&!d&&(e=s,t=s,n=o,i=o)}return[e,i]}FindDividingBisector(e){const t={pClosest:void 0,qClosest:void 0,p1:void 0,p2:void 0,q1:void 0,q2:void 0};this.FindClosestFeatures(t),e.bisectorPivot=k.middle(t.pClosest,t.qClosest),e.bisectorRay=t.pClosest.add(t.qClosest).rotate(Math.PI/2)}FindClosestPoints(){const e={q2:void 0,p1:void 0,p2:void 0,q1:void 0,pClosest:void 0,qClosest:void 0};return this.FindClosestFeatures(e),{pClosest:e.pClosest,qClosest:e.qClosest}}FindClosestFeatures(e){const t={leftTangentPoint:void 0,rightTangentPoint:void 0};this.P.GetTangentPoints(t,this.Q.pp(0).point),e.p2=t.leftTangentPoint,e.p1=t.rightTangentPoint,e.p2==e.p1&&(e.p2+=this.P.count),this.Q.GetTangentPoints(t,this.P.pp(0).point),e.q1=t.leftTangentPoint,e.q2=t.rightTangentPoint,e.q2==e.q1&&(e.q2+=this.Q.count),this.FindClosestPoints_(e)}FindClosestPoints_(e){for(;this.ChunksAreLong(e.p2,e.p1,e.q2,e.q1);)this.ShrinkChunks(e);e.p1==e.p2?(e.pClosest=this.P.pp(e.p2).point,e.q1==e.q2?e.qClosest=this.Q.pp(e.q1).point:(e.qClosest=k.ClosestPointAtLineSegment(e.pClosest,this.Q.pp(e.q1).point,this.Q.pp(e.q2).point),k.closeDistEps(e.qClosest,this.Q.pnt(e.q1))?e.q2=e.q1:k.closeDistEps(e.qClosest,this.Q.pnt(e.q2))&&(e.q1=e.q2))):(e.qClosest=this.Q.pp(e.q1).point,e.pClosest=k.ClosestPointAtLineSegment(e.qClosest,this.P.pp(e.p1).point,this.P.pp(e.p2).point),k.closeDistEps(e.pClosest,this.P.pnt(e.p1))?e.p2=e.p1:k.closeDistEps(e.qClosest,this.P.pnt(e.p2))&&(e.p1=e.p2))}ChunksAreLong(e,t,n,i){const s=this.P.Module(e-t)+1;if(s>2)return!0;const o=this.Q.Module(i-n)+1;return o>2||2==s&&2==o}ShrinkChunks(e){const t=e.p1==e.p2?e.p1:this.P.Median(e.p1,e.p2),n=e.q1==e.q2?e.q1:this.Q.Median(e.q2,e.q1),i=this.P.pp(t).point,s=this.Q.pp(n).point,o={a1:void 0,a2:void 0,b1:void 0,b2:void 0};if(this.GetAnglesAtTheMedian(t,n,i,s,o),!this.InternalCut(e,t,n,o.a1,o.a2,o.b1,o.b2)&&!YS.OneOfChunksContainsOnlyOneVertex(e,t,n,o.a1,o.b1)&&!this.OnlyOneChunkContainsExactlyTwoVertices(e,{mp:t,mq:n},o)){if(e.p2==this.P.Next(e.p1)&&e.q1==this.Q.Next(e.q2)){const a=Me.minDistBetweenLineSegments(this.P.pnt(e.p1),this.P.pnt(e.p2),this.Q.pnt(e.q1),this.Q.pnt(e.q2));return void(0==a.parab?e.p2=e.p1:1==a.parab?e.p1=e.p2:0==a.parcd?e.q2=e.q1:1==a.parcd&&(e.q1=e.q2))}o.a1<=Math.PI&&o.a2<=Math.PI&&o.b1<=Math.PI&&o.b2<=Math.PI?o.a1+o.b1>Math.PI?o.a1>=Math.PI/2?e.p1=t:e.q1=n:o.a2>=Math.PI/2?e.p2=t:e.q2=n:o.a1>Math.PI?e.p1=t:o.a2>Math.PI?e.p2=t:o.b1>Math.PI?e.q1=n:e.q2=n}}InternalCut(e,t,n,i,s,o,a){let l=!1;if(i>=Math.PI&&s>=Math.PI){const c=this.P.pp(t).point,d=this.Q.pp(n).point,b=this.P.pp(this.P.Next(t)).point;k.getTriangleOrientation(c,d,this.Q.pp(0).point)==k.getTriangleOrientation(c,d,b)?e.p1=this.P.Next(t):e.p2=this.P.Prev(t),l=!0}if(o>=Math.PI&&a>=Math.PI){const c=this.P.pp(t).point,d=this.Q.pp(n).point,b=this.Q.pp(this.Q.Next(n)).point;k.getTriangleOrientation(c,d,this.P.pp(0).point)==k.getTriangleOrientation(c,d,b)?e.q2=this.Q.Next(n):e.q1=this.Q.Prev(n),l=!0}return l}GetAnglesAtTheMedian(e,t,n,i,s){s.a1=k.anglePCP(i,n,this.P.pnt(this.P.Prev(e))),s.a2=k.anglePCP(this.P.pnt(this.P.Next(e)),n,i),s.b1=k.anglePCP(this.Q.pnt(this.Q.Next(t)),i,n),s.b2=k.anglePCP(n,i,this.Q.pnt(this.Q.Prev(t)))}OnlyOneChunkContainsExactlyTwoVertices(e,t,n){const i=e.p2==this.P.Next(e.p1),s=e.q1==this.Q.Next(e.q2);return i&&!s?(this.ProcessShortSide(e,t.mp,t.mq,n.a1,n.b1,n.a2,n.b2),!0):!(!s||i||(this.SwapEverything(e,t,n),this.ProcessShortSide(e,t.mp,t.mq,n.a1,n.b1,n.a2,n.b2),this.SwapEverything(e,t,n),0))}SwapEverything(e,t,n){this.SwapPq();let i=e.p2;e.p2=e.q1,e.q1=i,i=e.q2,e.q2=e.p1,e.p1=i,i=t.mq,t.mq=t.mp,t.mp=i,i=n.a2,n.a2=n.b1,n.b1=i,i=n.b2,n.b2=n.a1,n.a1=i}ProcessShortSide(e,t,n,i,s,o,a){t==e.p2?this.ProcessSide(e,n,i,s,a):o<=Math.PI?o+a>=Math.PI?o>=Math.PI/2?e.p2=e.p1:e.q2=n:s>=Math.PI/2?e.q1=n:o<a&&(k.canProject(this.Q.pnt(n),this.P.pp(e.p1).point,this.P.pp(e.p2).point)?e.q1=n:e.p1=e.p2):i+s<=Math.PI?e.p1=e.p2:e.p2=e.p1}SwapPq(){const e=this.P;this.P=this.Q,this.Q=e}ProcessSide(e,t,n,i,s){const o=this.Q.pnt(t);n<=Math.PI?n+i>=Math.PI?n>=Math.PI/2?e.p1=e.p2:e.q1=t:s>=Math.PI/2?e.q2=t:n<s&&(k.canProject(o,this.P.pp(e.p1).point,this.P.pp(e.p2).point)?e.q2=t:e.p2=e.p1):(e.p2=e.p1,i>=Math.PI?e.q1=t:s>=Math.PI&&(e.q2=t))}static OneOfChunksContainsOnlyOneVertex(e,t,n,i,s){return e.p1==e.p2?(s>=Math.PI/2?e.q1=n:e.q2=n,!0):e.q1==e.q2&&(i>=Math.PI/2?e.p1=t:e.p2=t,!0)}CalculateLeftTangents(){let e;this.FindDividingBisector(e);const t=this.P.FindTheFurthestVertexFromBisector(e.p1,e.p2,e.bisectorPivot,e.bisectorRay),n=this.Q.FindTheFurthestVertexFromBisector(e.q2,e.q1,e.bisectorPivot,e.bisectorRay);this.upperBranchOnP=!1,this.lowerBranchOnQ=!0,this.leftPLeftQ=this.TangentBetweenBranches(t,e.p1,n,e.q1),this.lowerBranchOnQ=!1,this.leftPRightQ=this.TangentBetweenBranches(t,e.p1,n,e.q2)}CalculateRightTangents(){let e;this.FindDividingBisector(e);const t=this.P.FindTheFurthestVertexFromBisector(e.p1,e.p2,e.bisectorPivot,e.bisectorRay),n=this.Q.FindTheFurthestVertexFromBisector(e.q2,e.q1,e.bisectorPivot,e.bisectorRay);this.upperBranchOnP=!0,this.lowerBranchOnQ=!0,this.rightPLeftQ=this.TangentBetweenBranches(t,e.p2,n,e.q1),this.lowerBranchOnQ=!1,this.rightPRightQ=this.TangentBetweenBranches(t,e.p2,n,e.q2)}}class Us{constructor(e){this.polyline=e,this.points=new Array;for(let t=this.polyline.startPoint;t;t=t.next)this.points.push(t)}static mkFromPoints(e){return new Us(At.mkClosedFromPoints(e))}get Polyline(){return this.polyline}Next(e){return this.Module(e+1)}Prev(e){return this.Module(e-1)}get count(){return this.Polyline.count}Module(e){return e<0?e+this.count:e<this.count?e:e-this.count}pp(e){return this.points[this.Module(e)]}pnt(e){return this.pp(e).point}toString(){return this.polyline.toString()}Median(e,t){return t>e?Math.floor((t+e)/2):this.Module(t+Math.floor((this.count+e)/2))}FindTheFurthestVertexFromBisector(e,t,n,i){let s=i.rotate(Math.PI/2);this.polyline.startPoint.point.sub(n).dot(s)<0&&(s=s.mul(-1)),e==t&&(t=this.Next(e));do{const o=this.Median(t,e),a=this.pnt(o);this.pnt(this.Next(o)).sub(a).dot(s)>=0?t=this.Next(o):this.pnt(this.Prev(o)).sub(a).dot(s)>=0?e=this.Prev(o):t=o,e=o}while(e!=t);return e}static TestPolygonDist(e,t){let n=Number.MAX_SAFE_INTEGER;for(let i=0;i<e.count;i++)for(let s=0;s<t.count;s++){const o=Me.minDistBetweenLineSegments(e.pnt(i),e.pnt(i+1),t.pnt(s),t.pnt(s+1));n=Math.min(n,o.dist)}return n}static Distance(e,t){const i=new YS(e,t).FindClosestPoints();return{p:i.pClosest,q:i.qClosest,dist:i.pClosest.sub(i.qClosest).length}}static DistanceOnly(e,t){return Us.Distance(e,t).dist}static PolygonIsLegalDebug(e){for(let n=e.Polyline.startPoint;null!=n.next&&null!=n.next.next;n=n.next)if(k.getTriangleOrientation(n.point,n.next.point,n.next.next.point)==nt.Collinear)return!1;return!0}static DistancePoint(e,t){let n=Number.MAX_VALUE;for(let i=0;i<e.count;i++){const s=k.distToLineSegment(t,e.points[i].point,e.points[(i+1)%e.count].point).dist;n=Math.min(n,s)}return n}GetTangentPoints(e,t){const n=new r4(this.GetSequenceDelegate(t),this.count);e.leftTangentPoint=n.FindMaximum(),e.rightTangentPoint=n.FindMinimum()}GetSequenceDelegate(e){const t=this.pnt(0);return n=>{const i=k.anglePCP(t,e,this.pnt(n));return i<Math.PI?i:i-2*Math.PI}}}let Jo=(()=>{class r{constructor(t,n,i,s){this.Obstacles=t,this.TightPadding=n,this.LoosePadding=i,this.IgnoreTightPadding=s}ObstaclesIntersectLine(t,n){return this.ObstaclesIntersectICurve(Me.mkPP(t,n))}static PadCorner(t,n,i,s,o){const a=r.GetPaddedCorner(n,i,s,o);return-1!=a.numberOfPoints&&(t.addPoint(a.a),2==a.numberOfPoints&&t.addPoint(a.b),!0)}static CurveIsClockwise(t,n){return k.getTriangleOrientation(n,t.start,t.start.add(t.derivative(t.parStart)))==nt.Clockwise}static PaddedPolylineBoundaryOfNode(t,n){return r.CreatePaddedPolyline(fe.polylineAroundClosedCurve(t),n)}static LoosePolylineWithFewCorners(t,n){return n<le.distanceEpsilon?t:r.CreateLoosePolylineOnBisectors(t,n)}static CreateLoosePolylineOnBisectors(t,n){return At.mkClosedFromPoints(Ba.CalculateConvexHull(r.BisectorPoints(t,n)))}static CreateRectNodeOfPolyline(t){return gi(t,t.boundingBox)}CreateLooseObstacles(){this.tightPolylinesToLooseDistances=new Map,this.LooseObstacles=new Array;for(const t of this.TightObstacles){const n=r.FindMaxPaddingForTightPolyline(this.RootOfTightHierarchy,t,this.LoosePadding);this.tightPolylinesToLooseDistances.set(t,n),this.LooseObstacles.push(r.LoosePolylineWithFewCorners(t,n))}this.RootOfLooseHierarchy=r.CalculateHierarchy(this.LooseObstacles)}CreateTightObstacles(){this.RootOfTightHierarchy=r.CreateTightObstacles_(this.Obstacles,this.TightPadding,this.TightObstacles),this.OverlapsDetected=this.TightObstacles.size<this.Obstacles.length}Calculate(){this.IgnoreTightPadding?this.CreateTightObstaclesIgnoringTightPadding():this.CreateTightObstacles(),this.IsEmpty()||this.CreateLooseObstacles()}IsEmpty(){return null==this.TightObstacles||0==this.TightObstacles.size}ObstaclesIntersectICurve(t){return r.CurveIntersectsRectangleNode(t,t.boundingBox,this.RootOfTightHierarchy)}static CurveIntersectsRectangleNode(t,n,i){if(!i.irect.intersects(n))return!1;if(null!=i.UserData){const s=i.UserData;return null!=fe.intersectionOne(s,t,!1)||r.PointIsInside(s.start,t)}return r.CurveIntersectsRectangleNode(t,n,i.Left)||r.CurveIntersectsRectangleNode(t,n,i.Right)}static PointIsInside(t,n){return fe.PointRelativeToCurveLocation(t,n)==Ot.Inside}CreateTightObstaclesIgnoringTightPadding(){const t=this.Obstacles.map(s=>fe.polylineAroundClosedCurve(s)),n=r.CalculateHierarchy(t),i=r.GetOverlappedPairSet(n);if(this.TightObstacles=new Set,0==i.size){for(const s of t){const o=r.FindMaxPaddingForTightPolyline(n,s,this.TightPadding);this.TightObstacles.add(r.LoosePolylineWithFewCorners(s,o))}this.RootOfTightHierarchy=r.CalculateHierarchy(Array.from(this.TightObstacles))}else{for(const s of t)this.TightObstacles.add(r.CreatePaddedPolyline(s,this.TightPadding));if(!this.IsEmpty())for(this.RootOfTightHierarchy=r.CalculateHierarchy(Array.from(this.TightObstacles)),this.OverlapsDetected=!1;r.GetOverlappedPairSet(this.RootOfTightHierarchy).size>0;)this.RootOfTightHierarchy=r.ReplaceTightObstaclesWithConvexHulls(this.TightObstacles,Array.from(i)),this.OverlapsDetected=!0}}static CreateTightObstacles_(t,n,i){if(0==t.length)return null;for(const s of t)r.CalculateTightPolyline(i,n,s);return r.RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(i)}static CalculateTightPolyline(t,n,i){const s=r.PaddedPolylineBoundaryOfNode(i,n);t.add(s)}static CalculateHierarchy(t){return Tr(t.map(i=>r.CreateRectNodeOfPolyline(i)))}static RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(t){let i,n=r.CalculateHierarchy(Array.from(t));for(;(i=r.GetOverlappedPairSet(n)).size>0;)n=r.ReplaceTightObstaclesWithConvexHulls(t,Array.from(i));return n}static MapToInt(t){const n=new Map;for(let i=0;i<t.length;i++)n.set(t[i],i);return n}static ReplaceTightObstaclesWithConvexHulls(t,n){const i=new Set;for(const c of n)i.add(c[0]),i.add(c[1]);const s=Array.from(i),o=r.MapToInt(s),l=by(Ux(Array.from(n).map(c=>new fn(o.get(c[0]),o.get(c[1])))));for(const c of l){const d=c.map(F=>s[F]),b=Iy(d,F=>Array.from(F)),N=Ba.createConvexHullAsClosedPolyline(b);for(const F of d)t.delete(F);t.add(N)}return r.CalculateHierarchy(Array.from(t))}static OneCurveLiesInsideOfOther(t,n){return fe.PointRelativeToCurveLocation(t.start,n)!=Ot.Outside||fe.PointRelativeToCurveLocation(n.start,t)!=Ot.Outside}static PolylinesIntersect(t,n){return fe.CurvesIntersect(t,n)||r.OneCurveLiesInsideOfOther(t,n)}static GetOverlappedPairSet(t){const n=new Set;return es(t,t,(i,s)=>{r.PolylinesIntersect(i,s)&&n.add([i,s])}),n}static BisectorPoints(t,n){const i=new Array;for(let s=t.startPoint;null!=s;s=s.next){const o={skip:!1},a=r.GetStickingVertexOnBisector(s,n,o);o.skip||i.push(a)}return i}static GetStickingVertexOnBisector(t,n,i){const s=t.polyline.prev(t).point,o=t.point,a=t.polyline.next(t).point;let l=o.sub(s).normalize().add(o.sub(a).normalize());const c=l.length;return c<le.tolerance?i.skip=!0:(i.skip=!1,l=l.div(c)),l.mul(n).add(o)}static FindMaxPaddingForTightPolyline(t,n,i){let s=i;const o=new Us(n),a=n.boundingBox.clone();a.pad(2*i);for(const l of Array.from(t.GetNodeItemsIntersectingRectangle(a)).filter(c=>c!=n)){const c=Us.Distance(o,new Us(l)).dist;s=Math.min(s,c/r.LooseDistCoefficient)}return s}static GetPaddedCorner(t,n,i,s){const o=t.point,a=n.point,l=i.point;if(k.getTriangleOrientation(o,a,l)==nt.Counterclockwise)return{a:void 0,b:void 0,numberOfPoints:-1};let c=a.sub(o).rotate(Math.PI/2).normalize();if(r.CornerIsNotTooSharp(o,a,l)){c=c.mul(s);const W=l.sub(a).normalize().mul(s).rotate(Math.PI/2),ie=k.lineLineIntersection(o.add(c),a.add(c),a.add(W),l.add(W));return{a:ie,b:ie,numberOfPoints:1}}const d=a.sub(o).normalize().add(a.sub(l).normalize());if(d.length<le.intersectionEpsilon){const W=a.add(c.mul(s));return{a:W,b:W,numberOfPoints:1}}const b=d.normalize().mul(s),N=b.rotate(Math.PI/2),F=(s-b.dot(c))/N.dot(c),G=N.mul(F);return{a:b.add(G).add(a),b:b.sub(G).add(a),numberOfPoints:2}}static CornerIsNotTooSharp(t,n,i){const s=t.sub(n).rotate(Math.PI/4).add(n);return k.getTriangleOrientation(n,s,i)==nt.Counterclockwise}static CreatePaddedPolyline(t,n){const i=new At;if(!r.PadCorner(i,t.endPoint.prev,t.endPoint,t.startPoint,n)||!r.PadCorner(i,t.endPoint,t.startPoint,t.startPoint.next,n))return r.CreatePaddedPolyline(At.mkClosedFromPoints(Array.from(Ba.CalculateConvexHull(t))),n);for(let s=t.startPoint;null!=s.next.next;s=s.next)if(!r.PadCorner(i,s,s.next,s.next.next,n))return r.CreatePaddedPolyline(At.mkClosedFromPoints(Array.from(Ba.CalculateConvexHull(t))),n);return i.closed=!0,i}}return r.LooseDistCoefficient=2.1,r})();class bT{get TightPolyline(){return this.tightPoly}set TightPolyline(e){this.tightPoly=e}static mk(e,t,n){const i=new bT;return i.TightPolyline=e,i.LooseShape=t,i.Distance=n,i}toString(){return(null==this.TightPolyline?"null":this.TightPolyline.toString().substring(0,5))+","+(null==this.LooseShape?"null":this.LooseShape.toString().substring(0,5))}}class CT{constructor(e,t,n,i){this.MainShape=e,this.TightPadding=t,this.LoosePadding=n,this.ShapesToTightLooseCouples=i}Calculate(){0!=this.MainShape.Children.length&&(this.CreateTightObstacles(),this.CreateTigthLooseCouples(),this.FillTheMapOfShapeToTightLooseCouples())}FillTheMapOfShapeToTightLooseCouples(){ho(Tr(this.MainShape.Children.map(t=>gi(t,t.BoundingBox))),this.coupleHierarchy,this.TryMapShapeToTightLooseCouple.bind(this))}TryMapShapeToTightLooseCouple(e,t){CT.ShapeIsInsideOfPoly(e,t.TightPolyline)&&this.ShapesToTightLooseCouples.set(e,t)}static ShapeIsInsideOfPoly(e,t){return fe.PointRelativeToCurveLocation(e.BoundaryCurve.start,t)==Ot.Inside}CreateTigthLooseCouples(){const e=new Array;for(const t of this.tightHierarchy.GetAllLeaves()){const n=Jo.FindMaxPaddingForTightPolyline(this.tightHierarchy,t,this.LoosePadding),i=Jo.LoosePolylineWithFewCorners(t,n);e.push(bT.mk(t,new ig(i),n))}this.coupleHierarchy=Tr(e.map(t=>gi(t,t.TightPolyline.boundingBox)))}CreateTightObstacles(){const e=new Set(this.MainShape.Children.map(this.InitialTightPolyline.bind(this))),t=e.size;this.tightHierarchy=Jo.RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(e),this.OverlapsDetected=t>e.size}InitialTightPolyline(e){const t=Jo.PaddedPolylineBoundaryOfNode(e.BoundaryCurve,this.TightPadding),n=Iy(this.LoosePolylinesUnderShape(e),s=>Array.from(s)).filter(s=>fe.PointRelativeToCurveLocation(s,t)==Ot.Outside);if(n.length<=0)return t;const i=Array.from(t).concat(n);return At.mkClosedFromPoints(Ba.CalculateConvexHull(i))}LoosePolylinesUnderShape(e){return e.Children.map(t=>this.ShapesToTightLooseCouples.get(t).LooseShape.BoundaryCurve)}}class i4{constructor(e,t,n){this.indexToA=e,this.priority=t,this.v=n}}class Iu{constructor(e=$n){this.heapSize=0,this.compare=e,this.cache=new Map,this.A=[]}get count(){return this.heapSize}ContainsElement(e){return this.cache.has(e)}SwapWithParent(e){const t=this.A[e>>1];this.PutAtI(e>>1,this.A[e]),this.PutAtI(e,t)}Enqueue(e,t){let n=++this.heapSize;const i=new i4(n,t,e);for(this.cache.set(e,i),this.A[n]=i;n>1&&this.compare(this.A[n>>1].priority,t)>0;)this.SwapWithParent(n),n>>=1}IsEmpty(){return 0==this.heapSize}PutAtI(e,t){this.A[e]=t,t.indexToA=e}Dequeue(){if(0==this.heapSize)throw new Error("dequeue on an empty queue");const e=this.A[1].v;return this.MoveQueueOneStepForward(e),e}DequeueAndGetPriority(e){if(0==this.heapSize)throw new Error("dequeue on an empty queue");const t=this.A[1].v;return e.priority=this.A[1].priority,this.MoveQueueOneStepForward(t),t}MoveQueueOneStepForward(e){this.cache.delete(e),this.PutAtI(1,this.A[this.heapSize]);let t=1;for(;;){let n=t;const i=t<<1;i<=this.heapSize&&this.compare(this.A[i].priority,this.A[t].priority)<0&&(n=i);const s=i+1;if(s<=this.heapSize&&this.compare(this.A[s].priority,this.A[n].priority)<0&&(n=s),n==t)break;this.SwapWithParent(n),t=n}this.heapSize--}DecreasePriority(e,t){const n=this.cache.get(e);if(!n)return;n.priority=t;let i=n.indexToA;for(;i>1&&this.compare(this.A[i].priority,this.A[i>>1].priority)<0;)this.SwapWithParent(i),i>>=1}*GetEnumerator(){for(let e=1;e<=this.heapSize;e++)yield this.A[e].v}Peek(e){if(0!=this.count)return e.priority=this.A[1].priority,this.A[1].v;e.priority=0}toString(){const e=new pi.StringBuilder;for(const t of this.A)e.Append(t+",");return e.ToString()}}class _y{constructor(e,t,n){this.upperBound=Number.POSITIVE_INFINITY,this._visGraph=n,this._visGraph.ClearPrevEdgesTable();for(const i of n.Vertices())i.Distance=Number.POSITIVE_INFINITY;this.source=e,this.targets=new Set(t),this.source.Distance=0}GetPath(){const e=new Iu($n);for(this.source.Distance=0,e.Enqueue(this.source,0);!e.IsEmpty()&&(this.current=e.Dequeue(),!this.targets.has(this.current));){for(const t of this.current.OutEdges)this.PassableOutEdge(t)&&this.ProcessNeighbor(e,t,t.Target);for(const t of this.current.InEdges)this.PassableInEdge(t)&&this.ProcessNeighbor(e,t,t.Source)}return null==this._visGraph.PreviosVertex(this.current)?null:this.CalculatePath()}PassableOutEdge(e){return e.Source==this.source||this.targets.has(e.Target)||!_y.IsForbidden(e)}PassableInEdge(e){return this.targets.has(e.Source)||e.Target==this.source||!_y.IsForbidden(e)}static IsForbidden(e){return null!=e.IsPassable&&!e.IsPassable()||e instanceof ml}ProcessNeighbor(e,t,n){const s=this.current.Distance+t.Length;s>=this.upperBound||(this.targets.has(n)&&(this.upperBound=s,this.closestTarget=n),n!=this.source&&null==this._visGraph.PreviosVertex(n)?(n.Distance=s,this._visGraph.SetPreviousEdge(n,t),e.Enqueue(n,s)):s<n.Distance&&(n.Distance=s,this._visGraph.SetPreviousEdge(n,t),e.DecreasePriority(n,s)))}CalculatePath(){if(null==this.closestTarget)return null;const e=new Array;let t=this.closestTarget;do{e.push(t),t=this._visGraph.PreviosVertex(t)}while(t!=this.source);return e.push(this.source),e.reverse()}}class US{constructor(e,t,n){this._lengthMultiplier=1,this._lengthMultiplierForAStar=1,this._visGraph=e,this._source=t,this._target=n,this._source.Distance=0}get LengthMultiplier(){return this._lengthMultiplier}set LengthMultiplier(e){this._lengthMultiplier=e}get LengthMultiplierForAStar(){return this._lengthMultiplierForAStar}set LengthMultiplierForAStar(e){this._lengthMultiplierForAStar=e}GetPath(e){const t=new Iu($n);for(this._source.Distance=0,this._target.Distance=Number.POSITIVE_INFINITY,t.Enqueue(this._source,this.H(this._source));!t.IsEmpty();){const n={priority:0},i=t.DequeueAndGetPriority(n);if(n.priority>=this._target.Distance)break;for(const s of i.OutEdges)this.PassableOutEdge(s)&&this.ProcessNeighbor(t,i,s,s.Target);for(const s of i.InEdges)this.PassableInEdge(s)&&this.ProcessNeighbor(t,i,s,s.Source)}return null==this._visGraph.PreviosVertex(this._target)?null:this.CalculatePath(e)}PassableOutEdge(e){return e.Source==this._source||e.Target==this._target||!US.IsForbidden(e)}PassableInEdge(e){return e.Source==this._target||e.Target==this._source||!US.IsForbidden(e)}static IsForbidden(e){return null!=e.IsPassable&&!e.IsPassable()||e instanceof ml}ProcessNeighborN(e,t,n,i,s){const a=t.Distance+(n.Length+s);i!=this._source&&null==this._visGraph.PreviosVertex(i)?(i.Distance=a,this._visGraph.SetPreviousEdge(i,n),i!=this._target&&e.Enqueue(i,this.H(i))):i!=this._source&&a<i.Distance&&(i.Distance=a,this._visGraph.SetPreviousEdge(i,n),i!=this._target&&e.DecreasePriority(i,this.H(i)))}ProcessNeighbor(e,t,n,i){const o=t.Distance+n.Length;i!=this._source&&null==this._visGraph.PreviosVertex(i)?(i.Distance=o,this._visGraph.SetPreviousEdge(i,n),i!=this._target&&e.Enqueue(i,this.H(i))):i!=this._source&&o<i.Distance&&(i.Distance=o,this._visGraph.SetPreviousEdge(i,n),i!=this._target&&e.DecreasePriority(i,this.H(i)))}H(e){return e.Distance+e.point.sub(this._target.point).length*this.LengthMultiplierForAStar}CalculatePath(e){const t=new Array;let n=this._target;do{t.push(n),e&&this._visGraph.ShrinkLengthOfPrevEdge(n,this.LengthMultiplier),n=this._visGraph.PreviosVertex(n)}while(n!=this._source);return t.push(this._source),t.reverse()}}var El=(()=>{return(r=El||(El={}))[r.Regular=0]="Regular",r[r.Tangent=1]="Tangent",El;var r})();class sL{constructor(e,t){this.LeftTangent=e,this.RightTangent=t}toString(){return pi.String.Format("{0},{1}",this.Start,this.End)}get Start(){return this.leftTangent.End.point}get End(){return this.rightTangent.End.point}get LeftTangent(){return this.leftTangent}set LeftTangent(e){this.leftTangent=e}get RightTangent(){return this.rightTangent}set RightTangent(e){this.rightTangent=e}get RbNode(){return this.rbNode}set RbNode(e){this.rbNode=e}}class oL{constructor(e,t){this.start=e,this.End=t}get Comp(){return this.comp}set Comp(e){this.comp=e}get IsHigh(){return!this.IsLow}get IsLow(){return this.lowTangent}set IsLow(e){this.lowTangent=e}get SeparatingPolygons(){return this.separatingPolygons}set SeparatingPolygons(e){this.separatingPolygons=e}get Diagonal(){return this.diagonal}set Diagonal(e){this.diagonal=e}get Start(){return this.start}set Start(e){this.start=e}get End(){return this.end}set End(e){this.end=e}toString(){return pi.String.Format("{0},{1}",this.Start,this.End)}}class aL{get PointOnTangentAndInsertedDiagonal(){return this.pointOnTheRay}set PointOnTangentAndInsertedDiagonal(e){this.pointOnTheRay=e}Compare(e,t){return e.Start.equal(t.Start)?0:k.getTriangleOrientation(this.PointOnTangentAndInsertedDiagonal,t.Start,t.End)===nt.Counterclockwise?-1:1}static BelongsToTheDiagonal(e,t,n){return k.closeDistEps(e,k.ClosestPointAtLineSegment(e,t,n))}static IntersectDiagonalWithRay(e,t,n){const i=t.sub(e),s=n.Start,o=n.End,a=vy.solve(o.x-s.x,-1*i.x,e.x-s.x,o.y-s.y,-1*i.y,e.y-s.y);return e.add(i.mul(a.y))}}class cg{constructor(e){this.pivot=e}IComparer(e,t){if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;const n=e.Start.point.sub(this.pivot),i=t.Start.point.sub(this.pivot);return cg.CompareVectorsByAngleToXAxis(n,i)}static CompareVectorsByAngleToXAxis(e,t){return e.y>=0?t.y<0?-1:cg.CompareVectorsPointingToTheSameYHalfPlane(e,t):t.y>=0?1:cg.CompareVectorsPointingToTheSameYHalfPlane(e,t)}static CompareVectorsPointingToTheSameYHalfPlane(e,t){const n=e.x*t.y-e.y*t.x;if(n>le.tolerance)return-1;if(n<-le.tolerance)return 1;if(e.x>=0){if(t.x<0)return-1}else if(t.x>=0)return 1;let i=Math.abs(e.x)-Math.abs(t.x);return i<0?-1:i>0?1:(i=Math.abs(e.y)-Math.abs(t.y),i<0?-1:i>0?1:0)}}class Pu extends Rr{constructor(e,t,n){super(null),this.activeDiagonalComparer=new aL,this.polygons=e,this.visibilityGraph=n,this.addedPolygons=t}run(){this.useLeftPTangents=!0,this.CalculateAndAddEdges(),this.useLeftPTangents=!1,this.CalculateAndAddEdges()}CalculateAndAddEdges(){for(const e of this.addedPolygons)this.CalculateVisibleTangentsFromPolygon(e);this.ProgressStep()}CalculateVisibleTangentsFromPolygon(e){this.currentPolygon=e,this.AllocateDataStructures(),this.OrganizeTangents(),this.InitActiveDiagonals(),this.Sweep()}AllocateDataStructures(){this.tangents=new Array,this.diagonals=new Array,this.activeDiagonalTree=new uo(this.activeDiagonalComparer.Compare.bind(this.activeDiagonalComparer))}Sweep(){if(!(this.tangents.length<2))for(let e=1;e<this.tangents.length;e++){const t=this.tangents[e];null!=t.Diagonal?(t.Diagonal.RbNode==this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(t),t.IsHigh&&this.RemoveDiagonalFromActiveNodes(t.Diagonal)):t.IsLow&&(this.activeDiagonalComparer.PointOnTangentAndInsertedDiagonal=t.End.point,this.InsertActiveDiagonal(new sL(t,t.Comp)),t.Diagonal.RbNode==this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(t))}}AddVisibleEdge(e){Or.AddEdgeVV(lL(this.visibilityGraph,e.start),lL(this.visibilityGraph,e.End))}InitActiveDiagonals(){if(0==this.tangents.length)return;const e=this.tangents[0],t=e.start.point,n=e.End.point;for(const i of this.diagonals)Pu.RayIntersectDiagonal(t,n,i)&&(this.activeDiagonalComparer.PointOnTangentAndInsertedDiagonal=aL.IntersectDiagonalWithRay(t,n,i),this.InsertActiveDiagonal(i)),e.Diagonal.RbNode==this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(e),0==e.IsLow&&this.RemoveDiagonalFromActiveNodes(e.Diagonal)}RemoveDiagonalFromActiveNodes(e){const t=this.activeDiagonalTree.deleteSubTree(e.RbNode);null!=t&&null!=t.item&&(t.item.RbNode=t),e.LeftTangent.Diagonal=null,e.RightTangent.Diagonal=null}InsertActiveDiagonal(e){e.RbNode=this.activeDiagonalTree.insert(e),Pu.MarkDiagonalAsActiveInTangents(e)}static MarkDiagonalAsActiveInTangents(e){e.LeftTangent.Diagonal=e,e.RightTangent.Diagonal=e}static RayIntersectDiagonal(e,t,n){const i=n.Start,s=n.End;return k.getTriangleOrientation(e,i,s)==nt.Counterclockwise&&k.getTriangleOrientation(e,t,i)!=nt.Counterclockwise&&k.getTriangleOrientation(e,t,s)!=nt.Clockwise}static TangentComparison(e,t){return cg.CompareVectorsByAngleToXAxis(e.End.point.sub(e.start.point),t.End.point.sub(t.start.point))}*AllObstacles(){for(const e of this.addedPolygons)yield e;for(const e of this.polygons)yield e}OrganizeTangents(){for(const e of this.AllObstacles())e!=this.currentPolygon&&this.ProcessPolygonQ(e);this.tangents.sort(Pu.TangentComparison)}ProcessPolygonQ(e){const t=new YS(this.currentPolygon,e);this.useLeftPTangents?t.CalculateLeftTangents():t.CalculateRightTangents();let n=this.useLeftPTangents?t.leftPLeftQ:t.rightPLeftQ;const i=new oL(this.currentPolygon.pp(n[0]),e.pp(n[1]));i.IsLow=!0,i.SeparatingPolygons=!this.useLeftPTangents,n=this.useLeftPTangents?t.leftPRightQ:t.rightPRightQ;const s=new oL(this.currentPolygon.pp(n[0]),e.pp(n[1]));s.IsLow=!1,s.SeparatingPolygons=this.useLeftPTangents,i.Comp=s,s.Comp=i,this.tangents.push(i),this.tangents.push(s),this.diagonals.push(new sL(i,s))}}function lL(r,e){return r.FindVertex(e.point)}class RT{get Pivot(){return this.pivot}set Pivot(e){this.pivot=e}get IntersectionOfTheRayAndInsertedEdge(){return this.pointOnTheRay}set IntersectionOfTheRayAndInsertedEdge(e){this.pointOnTheRay=e}Compare(e,t){return k.getTriangleOrientation(this.IntersectionOfTheRayAndInsertedEdge,t.point,t.nextOnPolyline.point)===nt.Counterclockwise?-1:1}IntersectionPointBelongsToTheInsertedEdge(e){const t=e.point.sub(this.IntersectionOfTheRayAndInsertedEdge),n=e.nextOnPolyline.point.sub(this.IntersectionOfTheRayAndInsertedEdge);return Math.abs(t.x*n.y-n.x*t.y)<le.distanceEpsilon}IntersectEdgeWithRayPPP(e,t,n){const i=vy.solve(t.x-e.x,-n.x,this.Pivot.x-e.x,t.y-e.y,-n.y,this.Pivot.y-e.y);if(!(-le.tolerance<=i.x&&i.x<=1+le.tolerance))throw new Error;if(!i)throw new Error;return this.Pivot.add(n.mul(i.y))}IntersectEdgeWithRay(e,t){return this.IntersectEdgeWithRayPPP(e.point,e.nextOnPolyline.point,t)}static constructorPP(e,t){const n=new RT;return n.pivot=e,n.pointOnTheRay=t,n}}class Dy{constructor(e,t){this.start=e,this.end=t}get Start(){return this.start}set Start(e){this.start=e}get End(){return this.end}set End(e){this.end=e}*Sides(){let e=this.start;for(;e!=this.end;){const t=e;yield t,e=t.nextOnPolyline}}MoveStartClockwise(){return this.Start!=this.End&&(this.Start=this.Start.nextOnPolyline,!0)}toString(){return pi.String.Format("Stem({0},{1})",this.Start,this.End)}}class mc{constructor(e,t,n,i){this.sideNodes=new Map,this.visibleBoundaries=new Map,this.sortedListOfPolypoints=new Array,this.holes=Array.from(e),this.visibilityGraph=t,this.q=n,this.qPolylinePoint=oo.mkFromPoint(this.q),this.QVertex=this.visibilityGraph.AddVertexP(this.qPolylinePoint.point),this.visibilityKind=i;const s=new cg(this.q);this.heapForSorting=new mT(s.IComparer.bind(s))}get QVertex(){return this.qV}set QVertex(e){this.qV=e}static CalculatePointVisibilityGraph(e,t,n,i){const s=t.FindVertex(n);if(null!=s)return s;const o=new mc(e,t,n,i);return o.FillGraph(),o.QVertex}FillGraph(){this.ComputeHoleBoundariesPossiblyVisibleFromQ(),this.visibleBoundaries.size>0&&(this.SortSAndInitActiveSides(),this.Sweep())}SortSAndInitActiveSides(){this.InitHeapAndInsertActiveSides();for(let e=this.heapForSorting.GetMinimum();this.sortedListOfPolypoints.push(e.Start),e.MoveStartClockwise()?this.heapForSorting.ChangeMinimum(e):this.heapForSorting.Dequeue(),0!=this.heapForSorting.Count;e=this.heapForSorting.GetMinimum());}InitHeapAndInsertActiveSides(){for(const e of this.GetInitialVisibleBoundaryStemsAndInsertActiveSides())this.heapForSorting.Enqueue(e)}*GetInitialVisibleBoundaryStemsAndInsertActiveSides(){for(const[e,t]of this.visibleBoundaries){let n=!1;for(const i of t.Sides()){const s=i;if(s.point.y<this.q.y){if(i.nextOnPolyline.point.y>=this.q.y){const o=k.getTriangleOrientation(this.q,s.point,i.nextOnPolyline.point);if(o==nt.Counterclockwise||o==nt.Collinear){n=!0,yield new Dy(t.Start,i),yield new Dy(i.nextOnPolyline,t.End),this.RegisterActiveSide(i);break}}}else{if(s.point.y>this.q.y)break;if(i.point.x>=this.q.x){n=!0,yield new Dy(i,t.End),i!=t.Start&&(yield new Dy(t.Start,e.prev(s))),this.RegisterActiveSide(i);break}}}n||(yield t)}}RegisterActiveSide(e){this.activeEdgeComparer.IntersectionOfTheRayAndInsertedEdge=this.activeEdgeComparer.IntersectEdgeWithRay(e,new k(1,0)),this.sideNodes.set(e,this.activeSidesTree.insert(e))}Sweep(){for(const e of this.sortedListOfPolypoints)this.SweepPolylinePoint(e)}SweepPolylinePoint(e){const t=mc.GetIncomingSide(e),n=this.GetOutgoingSide(e);let i;if(this.activeEdgeComparer.IntersectionOfTheRayAndInsertedEdge=e.point,i=this.sideNodes.get(t)){if(i==this.activeSidesTree.treeMinimum()&&this.AddEdge(e),null!=n)i.item=n,this.sideNodes.set(n,i);else{const s=this.activeSidesTree.deleteSubTree(i);null!=s&&null!=s.item&&this.sideNodes.set(s.item,s)}this.sideNodes.delete(t)}else{if(null==n)throw new Error;{let s;(s=this.sideNodes.get(n))||(s=this.activeSidesTree.insert(n),this.sideNodes.set(n,s),s==this.activeSidesTree.treeMinimum()&&this.AddEdge(e))}}}AddEdge(e){(this.visibilityKind==El.Regular||this.visibilityKind==El.Tangent&&mc.LineTouchesPolygon(this.QVertex.point,e))&&this.visibilityGraph.AddEdgeF(this.QVertex.point,e.point,(t,n)=>new ml(t,n))}static LineTouchesPolygon(e,t){const n=t.polyline.prev(t).point,i=t.polyline.next(t).point,s=t.point;return k.signedDoubledTriangleArea(e,s,n)*k.signedDoubledTriangleArea(e,s,i)>=0}GetOutgoingSide(e){return e==this.visibleBoundaries.get(e.polyline).End?null:e}static GetIncomingSide(e){return e.prevOnPolyline}ComputeHoleBoundariesPossiblyVisibleFromQ(){this.InitActiveEdgesAndActiveEdgesComparer();for(const e of this.holes)this.ComputeVisiblePartOfTheHole(e)}InitActiveEdgesAndActiveEdgesComparer(){this.activeEdgeComparer=new RT,this.activeEdgeComparer.pivot=this.q,this.activeSidesTree=new uo(this.activeEdgeComparer.Compare.bind(this.activeEdgeComparer))}ComputeVisiblePartOfTheHole(e){let t,n=!0;for(t=e.startPoint;!this.HoleSideIsVisibleFromQ(e,t);t=e.next(t))n=!1;let i=e.next(t);if(n)for(;this.HoleSideIsVisibleFromQ(e,e.prev(t));)t=e.prev(t);for(;this.HoleSideIsVisibleFromQ(e,i);i=e.next(i));this.visibleBoundaries.set(e,new Dy(t,i))}HoleSideIsVisibleFromQ(e,t){return k.signedDoubledTriangleArea(this.q,t.point,e.next(t).point)>=-le.squareOfDistanceEpsilon}}class cL{constructor(e,t){this.next=null,this.prev=null,this.PolylinePoint=e,this.OriginalPosition=t}get PolylinePoint(){return this.polylinePoint}set PolylinePoint(e){this.polylinePoint=e}get OriginalPosition(){return this.originalPosition}set OriginalPosition(e){this.originalPosition=e}get Next(){return this.next}set Next(e){this.next=e}get Prev(){return this.prev}set Prev(e){this.prev=e}}class On extends Rr{constructor(){super(...arguments),this.IgnoreTightPadding=!0,this.activeRectangle=lt.mkEmpty(),this.activePolygons=new Array,this.alreadyAddedOrExcludedPolylines=new Set,this.UseEdgeLengthMultiplier=!1,this.UseInnerPolylingShortcutting=!0,this.UsePolylineEndShortcutting=!0,this.AllowedShootingStraightLines=!0,this.LookForRoundedVertices=!1}get Obstacles(){return this.obstacles_}set Obstacles(e){this.obstacles_=e}get EnteringAngleBound(){return this.enteringAngleBound_}set EnteringAngleBound(e){this.enteringAngleBound_=e}get SourceTightPolyline(){return this._sourceTightPolyline}set SourceTightPolyline(e){this._sourceTightPolyline=e}get TargetTightPolyline(){return this.targetTightPolyline}set TargetTightPolyline(e){this.targetTightPolyline=e}get TargetLoosePolyline(){return this.targetLoosePolyline}set TargetLoosePolyline(e){this.targetLoosePolyline=e}get VisibilityGraph(){return this.visibilityGraph}set VisibilityGraph(e){this.visibilityGraph=e}get SourcePort(){return this.sourcePort}set SourcePort(e){if(this.sourcePort=e,null!=this.sourcePort)if(this.SourceTightPolyline=On.GetFirstHitPolyline(this.sourcePort.Location,this.ObstacleCalculator.RootOfTightHierarchy),this.sourcePort instanceof pl)this.alreadyAddedOrExcludedPolylines.add(this.SourceLoosePolyline),this.StartPointOfEdgeRouting=this.SourcePort.Location;else{const t=this.sourcePort;this.StartPointOfEdgeRouting=this.TakeBoundaryPortOutsideOfItsLoosePolyline(t.Curve,t.Parameter,this.SourceLoosePolyline)}}get TargetPort(){return this.targetPort}set TargetPort(e){this.targetPort=e}get LoosePadding(){return this.loosePadding}set LoosePadding(e){this.loosePadding=e,null!=this.ObstacleCalculator&&(this.ObstacleCalculator.LoosePadding=e)}get StartPointOfEdgeRouting(){return this.startPointOfRouting_}set StartPointOfEdgeRouting(e){this.startPointOfRouting_=e}ExtendVisibilityGraphToLocation(e){null==this.VisibilityGraph&&(this.VisibilityGraph=new Or);let t=null;if(!this.activeRectangle.contains(e)){this.activeRectangle.isEmpty?this.activeRectangle=lt.mkPP(this.SourcePort.Location,e):this.activeRectangle.add(e),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle();for(const n of t)this.VisibilityGraph.AddHole(n.Polyline)}null==t||0==t.length?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraph(e)):(this.RemovePointVisibilityGraphs(),new Pu(t,this.activePolygons,this.VisibilityGraph).run(),bu(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraph(e),this.CalculateSourcePortVisibilityGraph())}RemovePointVisibilityGraphs(){null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),null!=this.sourceVV&&this.VisibilityGraph.RemoveVertex(this.sourceVV)}CalculateEdgeTargetVisibilityGraph(e){this.targetVV=mc.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()),this.VisibilityGraph,e,El.Tangent)}CalculateSourcePortVisibilityGraph(){this.sourceVV=mc.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()),this.VisibilityGraph,this.StartPointOfEdgeRouting,El.Tangent)}TakeBoundaryPortOutsideOfItsLoosePolyline(e,t,n){const i=e.value(t);let s=e.leftDerivative(t).normalize().add(e.rightDerivative(t).normalize()).normalize();k.getTriangleOrientation(On.PointInsideOfConvexCurve(e),i,i.add(s))==nt.Counterclockwise&&(s=s.mul(-1)),s=s.rotate(Math.PI/2);let a=Me.mkPP(i,i.add(s.mul(n.boundingBox.diagonal)));const l=fe.intersectionOne(a,n,!1).x;let c=s.mul(l.sub(i).length/2);for(;;){a=Me.mkPP(i,l.add(c));let d=!1;for(const b of On.IntersectionsOfLineAndRectangleNodeOverPolylineLR(a,this.ObstacleCalculator.RootOfLooseHierarchy))if(b.seg1!=n){c=c.div(1.5),d=!0;break}if(!d)break}return a.end}static PointInsideOfConvexCurve(e){return e.value(0).add(e.value(1.5)).div(2)}*GetActivePolylines(){for(const e of this.activePolygons)yield e.Polyline}GetAddedPolygonesAndMaybeExtendActiveRectangle(){const e=this.activeRectangle,t=new Array;let n;do{n=!1;for(const i of this.ObstacleCalculator.RootOfLooseHierarchy.GetNodeItemsIntersectingRectangle(this.activeRectangle))this.alreadyAddedOrExcludedPolylines.has(i)||(e.addRec(i.boundingBox),t.push(new Us(i)),this.alreadyAddedOrExcludedPolylines.add(i),n=!0);n&&(this.activeRectangle=e)}while(n);return t}RelaxPolyline(){let e=On.CreateRelaxedPolylinePoints(this._polyline);for(e=e.Next;null!=e.Next;e=e.Next)this.RelaxPolylinePoint(e)}static CreateRelaxedPolylinePoints(e){let t=e.startPoint;const n=new cL(t,t.point);let i=n;for(;null!=t.next;){t=t.next;const s=new cL(t,t.point);s.Prev=i,i.Next=s,i=s}return n}RelaxPolylinePoint(e){if(!(null==e.PolylinePoint.prev.prev&&this.SourcePort instanceof Ys&&e.PolylinePoint.polyline!=this.SourceLoosePolyline||null==e.PolylinePoint.next.next&&this.TargetPort instanceof Ys&&e.PolylinePoint.polyline!=this.TargetLoosePolyline))for(let t=this.OffsetForPolylineRelaxing;t>le.distanceEpsilon&&!this.RelaxWithGivenOffset(t,e);)t/=2}RelaxWithGivenOffset(e,t){return On.SetRelaxedPointLocation(e,t),!!this.StickingSegmentDoesNotIntersectTightObstacles(t)||(On.PullCloserRelaxedPoint(t.Prev),!1)}static PullCloserRelaxedPoint(e){e.PolylinePoint.point=e.OriginalPosition.mul(.2).add(e.PolylinePoint.point.mul(.8))}StickingSegmentDoesNotIntersectTightObstacles(e){return!(this.PolylineSegmentIntersectsTightHierarchy(e.PolylinePoint.point,e.Prev.PolylinePoint.point)||null!=e.Next&&this.PolylineSegmentIntersectsTightHierarchy(e.PolylinePoint.point,e.Next.PolylinePoint.point))}PolylineSegmentIntersectsTightHierarchy(e,t){return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchyPPR(e,t,this.ObstacleCalculator.RootOfTightHierarchy)}PolylineIntersectsPolyRectangleNodeOfTightHierarchyPPR(e,t,n){return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(Me.mkPP(e,t),n)}PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t){if(!e.boundingBox.intersects(t.irect))return!1;if(null!=t.UserData){for(const n of fe.getAllIntersections(e,t.UserData,!1))if(n.seg1!=this.SourceTightPolyline&&n.seg1!=this.TargetTightPolyline||(n.seg1==this.SourceTightPolyline&&this.SourcePort)instanceof Ys||(n.seg1==this.TargetTightPolyline&&this.TargetPort)instanceof Ys)return!0;return!1}return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t.Left)||this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t.Right)}static IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,t){const n=new Array;return On.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t,n),n}static IntersectionsOfLineAndRectangleNodeOverPolyline(e,t,n){if(null!=t&&e.boundingBox.intersects(t.irect)){if(null!=t.UserData)return void bu(n,fe.getAllIntersections(e,t.UserData,!0));On.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t.Left,n),On.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t.Right,n)}}LineCanBeAcceptedForRouting(e){const n=this.TargetPort instanceof pl;if(!((this.SourcePort instanceof pl||this.targetIsInsideOfSourceTightPolyline||this.InsideOfTheAllowedConeOfBoundaryPort(e.end,this.SourcePort))&&(n||null==this.TargetPort||this.sourceIsInsideOfTargetTightPolyline||this.InsideOfTheAllowedConeOfBoundaryPort(e.start,this.TargetPort))))return!1;const i=On.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy);for(const s of i)if(s.seg1!=this.SourceTightPolyline&&s.seg1!=this.targetTightPolyline)return!1;return!0}InsideOfTheAllowedConeOfBoundaryPort(e,t){const n=t.Curve,i=Jo.CurveIsClockwise(n,On.PointInsideOfConvexCurve(n)),s=t.Location,o=this.GetPointOnTheRightBoundaryPortConeSide(s,n,i,t.Parameter),a=this.GetPointOnTheLeftBoundaryPortConeSide(s,n,i,t.Parameter);return k.getTriangleOrientation(s,o,e)!=nt.Clockwise&&k.getTriangleOrientation(s,e,a)!=nt.Clockwise}GetPointOnTheRightBoundaryPortConeSide(e,t,n,i){const s=n?t.rightDerivative(i):t.leftDerivative(i).neg();return e.add(s.rotate(this.EnteringAngleBound))}GetPointOnTheLeftBoundaryPortConeSide(e,t,n,i){const s=n?t.leftDerivative(i).neg():t.rightDerivative(i);return e.add(s.rotate(-this.EnteringAngleBound))}static SetRelaxedPointLocation(e,t){const n=k.getTriangleOrientation(t.Next.OriginalPosition,t.OriginalPosition,t.Prev.OriginalPosition)==nt.Counterclockwise;let i=t.Next.OriginalPosition.sub(t.Prev.OriginalPosition).normalize().mul(e).rotate(Math.PI/2);n||(i=i.neg()),t.PolylinePoint.point=t.OriginalPosition.add(i)}SmoothCorners(e){let t=e.headSite,n={b:null,c:null};for(;n=fe.findCorner(t);)t=this.SmoothOneCorner(t,n.c,n.b)}SmoothOneCorner(e,t,n){let a,l,c,o=.5;null==e.prev?(c=2,l=1):null==t.next?(c=1,l=2):l=1,c=1;do{a=fe.createBezierSeg(o*c,o*l,e,n,t),n.previouisBezierCoefficient=o*c,n.nextBezierCoefficient=o*l,o/=1.5}while(this.ObstacleCalculator.ObstaclesIntersectICurve(a)&&o>.01);return o*=1.5,o<.5&&o>.01&&(o=.5*(o+1.5*o),a=fe.createBezierSeg(o*c,o*l,e,n,t),this.ObstacleCalculator.ObstaclesIntersectICurve(a)||(n.previouisBezierCoefficient=o*c,n.nextBezierCoefficient=o*l)),n}TryToRemoveInflectionsAndCollinearSegments(e){let t=!0;const n={s:null};for(;t;)for(t=!1,n.s=e.headSite;null!=n.s&&null!=n.s.next;n.s=n.s.next)n.s.turn*n.s.next.turn<0&&(t=this.TryToRemoveInflectionEdge(n)||t)}TryToRemoveInflectionEdge(e){if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.prev.point,e.s.next.point)){const t=e.s.prev,n=e.s.next;return t.next=n,n.prev=t,e.s=t,!0}if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.prev.point,e.s.next.next.point)){const t=e.s.prev,n=e.s.next.next;return t.next=n,n.prev=t,e.s=t,!0}if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.point,e.s.next.next.point)){const t=e.s.next.next;return e.s.next=t,t.prev=e.s,!0}return!1}GetShortestPolyline(e,t){this.CleanTheGraphForShortestPath();const i=new US(this.visibilityGraph,e,t).GetPath(this.UseEdgeLengthMultiplier);if(null==i)return null;const s=new At;for(const o of i)s.addPoint(o.point);return On.RemoveCollinearVertices(s)}CleanTheGraphForShortestPath(){this.visibilityGraph.ClearPrevEdgesTable()}static RemoveCollinearVertices(e){for(let t=e.startPoint.next;null!=t.next;t=t.next)k.getTriangleOrientation(t.prev.point,t.point,t.next.point)==nt.Collinear&&(t.prev.next=t.next,t.next.prev=t.prev);return e}get OverlapsDetected(){return this.ObstacleCalculator.OverlapsDetected}get TightHierarchy(){return this.ObstacleCalculator.RootOfTightHierarchy}set TightHierarchy(e){this.ObstacleCalculator.RootOfTightHierarchy=e}get LooseHierarchy(){return this.ObstacleCalculator.RootOfLooseHierarchy}set LooseHierarchy(e){this.ObstacleCalculator.RootOfLooseHierarchy=e}CalculateObstacles(){this.ObstacleCalculator=new Jo(this.Obstacles,this.TightPadding,this.LoosePadding,this.IgnoreTightPadding),this.ObstacleCalculator.Calculate()}RouteEdgeToLocation(e){this.TargetPort=new pl(null,e),this.TargetTightPolyline=null,this.TargetLoosePolyline=null;const t=new vu(null);let n=Me.mkPP(this.SourcePort.Location,e);return this.LineCanBeAcceptedForRouting(n)?(this._polyline=new At,this._polyline.addPoint(n.start),this._polyline.addPoint(n.end),t.smoothedPolyline=Jr.mkFromPoints(this._polyline),t.curve=t.smoothedPolyline.createCurve(),t):this.SourcePort instanceof Ys&&(n=Me.mkPP(this.StartPointOfEdgeRouting,e),0==On.IntersectionsOfLineAndRectangleNodeOverPolylineLR(n,this.ObstacleCalculator.RootOfTightHierarchy).length)?(this._polyline=new At,this._polyline.addPoint(this.SourcePort.Location),this._polyline.addPoint(n.start),this._polyline.addPoint(n.end),t.smoothedPolyline=Jr.mkFromPoints(this._polyline),t.curve=t.smoothedPolyline.createCurve(),t):(this.ExtendVisibilityGraphToLocation(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),this.RelaxPolyline(),this.SourcePort instanceof Ys&&this._polyline.PrependPoint(this.SourcePort.Location),t.smoothedPolyline=Jr.mkFromPoints(this._polyline),t.curve=t.smoothedPolyline.createCurve(),t)}RouteEdgeToPort(e,t,n,i){return this.ObstacleCalculator.IsEmpty()?null!=this.sourcePort&&null!=this.targetPort?(i.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(this.sourcePort.Location,this.targetPort.Location),Me.mkPP(this.sourcePort.Location,this.targetPort.Location)):null:(this.TargetPort=e,this.TargetTightPolyline=On.GetFirstHitPolyline(e.Location,this.ObstacleCalculator.RootOfTightHierarchy),e instanceof Ys?this.RouteEdgeToBoundaryPort(t,n,i):this.RouteEdgeToFloatingPortOfNode(t,n,i))}SmoothedPolylineFromTwoPoints(e,t){return this._polyline=new At,this._polyline.addPoint(e),this._polyline.addPoint(t),Jr.mkFromPoints(this._polyline)}RouteEdgeToFloatingPortOfNode(e,t,n){return this.sourcePort instanceof pl?this.RouteFromFloatingPortToFloatingPort(e,t,n):this.RouteFromBoundaryPortToFloatingPort(e,t,n)}RouteFromBoundaryPortToFloatingPort(e,t,n){const i=this.SourcePort.Location,s=this.targetPort.Location;let o=Me.mkPP(i,s);if(this.LineCanBeAcceptedForRouting(o))return n.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(o.start,o.end),o;if(!this.targetIsInsideOfSourceTightPolyline){const l=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.SourcePort.Curve,this.SourcePort.Parameter,this.SourceLoosePolyline);if(o=Me.mkPP(l,s),this.LineAvoidsTightHierarchyLP(o,e))return n.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(o.start,o.end),o}this.ExtendVisibilityGraphToLocationOfTargetFloatingPort(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV);const a=this.SourceTightPolyline;return this.targetIsInsideOfSourceTightPolyline||(this.SourceTightPolyline=null),this.TryShortcutPolyline(),this.SourceTightPolyline=a,this.RelaxPolyline(),this._polyline.PrependPoint(i),this.SmoothCornersAndReturnCurve(t,n)}SmoothCornersAndReturnCurve(e,t){return t.smoothedPolyline=Jr.mkFromPoints(this._polyline),e&&this.SmoothCorners(t.smoothedPolyline),t.smoothedPolyline.createCurve()}RouteFromFloatingPortToFloatingPort(e,t,n){const s=Me.mkPP(this.StartPointOfEdgeRouting,this.TargetPort.Location);return this.AllowedShootingStraightLines&&this.LineAvoidsTightHierarchyLPP(s,this.SourceTightPolyline,this.targetTightPolyline)?(n.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(s.start,s.end),s):(this.ExtendVisibilityGraphToLocationOfTargetFloatingPort(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),null==this._polyline?null:(this.UseSpanner&&this.TryShortcutPolyline(),this.RelaxPolyline(),n.smoothedPolyline=Jr.mkFromPoints(this._polyline),this.SmoothCornersAndReturnCurve(t,n)))}TryShortcutPolyline(){if(this.UseInnerPolylingShortcutting)for(;this.ShortcutPolylineOneTime(););this.UsePolylineEndShortcutting&&this.TryShortCutThePolylineEnds()}TryShortCutThePolylineEnds(){this.TryShortcutPolylineStart(),this.TryShortcutPolylineEnd()}TryShortcutPolylineEnd(){const e=this._polyline.endPoint,t=e.prev;if(null==t)return;const n=t.prev;if(null==n)return;const i=k.middle(t.point,n.point);if(this.LineAvoidsTightHierarchyPPPP(e.point,i,this._sourceTightPolyline,this.targetTightPolyline)){const s=oo.mkFromPoint(i);s.next=e,s.prev=n,e.prev=s,n.next=s}}TryShortcutPolylineStart(){const e=this._polyline.startPoint,t=e.next;if(null==t)return;const n=t.next;if(null==n)return;const i=k.middle(t.point,n.point);if(this.LineAvoidsTightHierarchyPPPP(e.point,i,this._sourceTightPolyline,this.targetTightPolyline)){const s=oo.mkFromPoint(i);s.prev=e,s.next=n,e.next=s,n.prev=s}}ShortcutPolylineOneTime(){let e=!1;for(let t=this._polyline.startPoint;null!=t.next&&null!=t.next.next;t=t.next)e=e||this.TryShortcutPolyPoint(t);return e}TryShortcutPolyPoint(e){return!!this.LineAvoidsTightHierarchyLPP(Me.mkPP(e.point,e.next.next.point),this.SourceTightPolyline,this.targetTightPolyline)&&(e.next=e.next.next,e.next.prev=e,!0)}ExtendVisibilityGraphToLocationOfTargetFloatingPort(e){null==this.VisibilityGraph&&(this.VisibilityGraph=new Or);let t=null;const n=this.targetPort.Location;if(!this.activeRectangle.contains(n)){this.activeRectangle.isEmpty?this.activeRectangle=lt.mkPP(this.SourcePort.Location,n):this.activeRectangle.add(n),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle();for(const i of t)this.VisibilityGraph.AddHole(i.Polyline)}null==t?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraphForFloatingPort(n,e),null==this.sourceVV&&this.CalculateSourcePortVisibilityGraph()):(this.RemovePointVisibilityGraphs(),new Pu(t,this.activePolygons,this.VisibilityGraph).run(),bu(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraphForFloatingPort(n,e),this.CalculateSourcePortVisibilityGraph())}CalculateEdgeTargetVisibilityGraphForFloatingPort(e,t){this.targetVV=this.UseSpanner?this.AddTransientVisibilityEdgesForPort(e,t):mc.CalculatePointVisibilityGraph(this.GetActivePolylinesWithException(t),this.VisibilityGraph,e,El.Tangent)}AddTransientVisibilityEdgesForPort(e,t){let n=this.GetVertex(e);if(null!=n)return n;if(n=this.visibilityGraph.AddVertexP(e),null!=t)for(const i of t)this.visibilityGraph.AddEdgeF(e,i,(s,o)=>new ml(s,o));else n=mc.CalculatePointVisibilityGraph(this.GetActivePolylines(),this.VisibilityGraph,e,El.Tangent);return n}GetVertex(e){let t=this.visibilityGraph.FindVertex(e);return null==t&&this.LookForRoundedVertices&&(t=this.visibilityGraph.FindVertex(le.RoundPoint(e))),t}*GetActivePolylinesWithException(e){for(const t of this.activePolygons)t.Polyline!=e&&(yield t.Polyline)}RouteEdgeToBoundaryPort(e,t,n){return this.TargetLoosePolyline=e,this.sourcePort instanceof pl?this.RouteFromFloatingPortToBoundaryPort(t,n):this.RouteFromBoundaryPortToBoundaryPort(t,n)}RouteFromBoundaryPortToBoundaryPort(e,t){const n=this.SourcePort.Location;let i;const s=this.targetPort.Location;let o=Me.mkPP(n,s);if(this.LineCanBeAcceptedForRouting(o))this._polyline=new At,this._polyline.addPoint(o.start),this._polyline.addPoint(o.end),t.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(o.start,o.end),i=Jr.mkFromPoints(this._polyline).createCurve();else{const a=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.targetPort.Curve,this.targetPort.Parameter,this.TargetLoosePolyline);if(o=Me.mkPP(n,a),this.InsideOfTheAllowedConeOfBoundaryPort(a,this.SourcePort)&&this.LineAvoidsTightHierarchyLP(o,this._sourceTightPolyline))this._polyline=new At,this._polyline.addPoint(o.start),this._polyline.addPoint(o.end),this._polyline.addPoint(s),i=this.SmoothCornersAndReturnCurve(e,t);else if(o=Me.mkPP(this.StartPointOfEdgeRouting,s),this.InsideOfTheAllowedConeOfBoundaryPort(this.StartPointOfEdgeRouting,this.TargetPort)&&this.LineAvoidsTightHierarchy(o))this._polyline=new At,this._polyline.addPoint(n),this._polyline.addPoint(o.start),this._polyline.addPoint(o.end),i=this.SmoothCornersAndReturnCurve(e,t);else{let l;if(l=Me.IntersectPPPP(n,this.StartPointOfEdgeRouting,s,a))this._polyline=new At,this._polyline.addPoint(n),this._polyline.addPoint(l),this._polyline.addPoint(s),i=this.SmoothCornersAndReturnCurve(e,t);else if(k.closeDistEps(this.StartPointOfEdgeRouting,a))this._polyline=new At,this._polyline.addPoint(n),this._polyline.addPoint(a),this._polyline.addPoint(s),i=this.SmoothCornersAndReturnCurve(e,t);else if(this.LineAvoidsTightHierarchy(Me.mkPP(this.StartPointOfEdgeRouting,a)))this._polyline=new At,this._polyline.addPoint(n),this._polyline.addPoint(this.StartPointOfEdgeRouting),this._polyline.addPoint(a),this._polyline.addPoint(s),i=this.SmoothCornersAndReturnCurve(e,t);else{this.ExtendVisibilityGraphToTargetBoundaryPort(a),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV);const c={tmpTargetTight:null},d=this.HideSourceTargetTightsIfNeeded(c);this.TryShortcutPolyline(),this.RecoverSourceTargetTights(d,c.tmpTargetTight),this.RelaxPolyline(),this._polyline.PrependPoint(n),this._polyline.addPoint(s),i=this.SmoothCornersAndReturnCurve(e,t)}}}return i}RecoverSourceTargetTights(e,t){this.SourceTightPolyline=e,this.TargetTightPolyline=t}HideSourceTargetTightsIfNeeded(e){const t=this.SourceTightPolyline;return e.tmpTargetTight=this.TargetTightPolyline,this.TargetTightPolyline=null,this.SourceTightPolyline=null,t}LineAvoidsTightHierarchy(e){return 0==On.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy).length}RouteFromFloatingPortToBoundaryPort(e,t){const n=this.targetPort.Location;let i;if(this.InsideOfTheAllowedConeOfBoundaryPort(this.sourcePort.Location,this.targetPort)&&(i=Me.mkPP(this.SourcePort.Location,n),this.LineCanBeAcceptedForRouting(i)))return t.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(i.start,i.end),i;const s=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.TargetPort.Curve,this.TargetPort.Parameter,this.TargetLoosePolyline);return i=Me.mkPP(this.SourcePort.Location,s),this.LineAvoidsTightHierarchyLP(i,this._sourceTightPolyline)?(this._polyline=At.mkFromPoints([i.start,i.end,n]),t.smoothedPolyline=Jr.mkFromPoints(this._polyline),t.smoothedPolyline.createCurve()):(this.ExtendVisibilityGraphToTargetBoundaryPort(s),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),this.RelaxPolyline(),this._polyline.addPoint(n),this.SmoothCornersAndReturnCurve(e,{smoothedPolyline:null}))}LineAvoidsTightHierarchyLP(e,t){let n=!0;for(const i of On.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy))if(i.seg1!=t){n=!1;break}return n}LineAvoidsTightHierarchyLPP(e,t,n){let i=!0;for(const s of On.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy))if(s.seg1!=t&&s.seg1!=n){i=!1;break}return i}LineAvoidsTightHierarchyPPPP(e,t,n,i){return this.LineAvoidsTightHierarchyLPP(Me.mkPP(e,t),n,i)}ExtendVisibilityGraphToTargetBoundaryPort(e){let t=null;if(null==this.VisibilityGraph&&(this.VisibilityGraph=new Or),!this.activeRectangle.contains(e)||!this.activeRectangle.containsRect(this.TargetLoosePolyline.boundingBox)){this.activeRectangle.isEmpty?(this.activeRectangle=this.TargetLoosePolyline.boundingBox.clone(),this.activeRectangle.add(this.SourcePort.Location),this.activeRectangle.add(this.StartPointOfEdgeRouting),this.activeRectangle.add(e)):(this.activeRectangle.add(e),this.activeRectangle.addRec(this.TargetLoosePolyline.boundingBox)),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle();for(const n of t)this.VisibilityGraph.AddHole(n.Polyline)}null==t?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraph(e)):(this.RemovePointVisibilityGraphs(),new Pu(t,this.activePolygons,this.VisibilityGraph).run(),bu(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraph(e),this.CalculateSourcePortVisibilityGraph())}GetHitLoosePolyline(e){return this.ObstacleCalculator.IsEmpty()||null==this.ObstacleCalculator.RootOfLooseHierarchy?null:On.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy)}static GetFirstHitPolyline(e,t){const n=On.GetFirstHitRectangleNode(e,t);return n?n.UserData:null}static GetFirstHitRectangleNode(e,t){return null==t?null:t.FirstHitNodePF(e,(n,i)=>fe.PointRelativeToCurveLocation(n,i)!=Ot.Outside?Kn.Stop:Kn.Continue)}Clean(){this.TargetPort=null,this.SourcePort=null,this.SourceTightPolyline=null,this.SourceLoosePolyline=null,this.TargetLoosePolyline=null,this.targetTightPolyline=null,this.VisibilityGraph=null,this.targetVV=null,this.sourceVV=null,this.activePolygons=[],this.alreadyAddedOrExcludedPolylines.clear(),this.activeRectangle.setToEmpty()}SetSourcePortAndSourceLoosePolyline(e,t){this.SourceLoosePolyline=t,this.sourcePort=e,null!=this.sourcePort&&(this.SourceTightPolyline=On.GetFirstHitPolyline(this.sourcePort.Location,this.ObstacleCalculator.RootOfTightHierarchy),this.sourcePort instanceof pl?(this.alreadyAddedOrExcludedPolylines.add(this.SourceLoosePolyline),this.StartPointOfEdgeRouting=this.SourcePort.Location):this.StartPointOfEdgeRouting=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.SourcePort.Curve,this.sourcePort.Parameter,this.SourceLoosePolyline))}run(){this.CalculateWholeTangentVisibilityGraph()}CalculateWholeTangentVisibilityGraph(){this.VisibilityGraph=new Or,this.CalculateWholeVisibilityGraphOnExistingGraph()}CalculateWholeVisibilityGraphOnExistingGraph(){this.activePolygons=Array.from(this.AllPolygons());for(const t of this.ObstacleCalculator.LooseObstacles)this.VisibilityGraph.AddHole(t);let e;e=this.UseSpanner?new Ny(this.ObstacleCalculator.LooseObstacles,this.VisibilityGraph):new Pu(new Array,this.activePolygons,this.visibilityGraph),e.run()}RouteSplineFromPortToPortWhenTheWholeGraphIsReady(e,t,n,i){const s=e instanceof pl&&t instanceof Ys||e instanceof Zi;if(s){const a=e;e=t,t=a}this.sourcePort=e,this.targetPort=t,this.FigureOutSourceTargetPolylinesAndActiveRectangle();let o=this.GetEdgeGeomByRouting(n,i);return null==o?null:(this.targetVV=null,this.sourceVV=null,s&&(o=o.reverse()),o)}GetEdgeGeomByRouting(e,t){let n;if(this.sourceIsInsideOfTargetTightPolyline=null==this.TargetTightPolyline||fe.PointRelativeToCurveLocation(this.sourcePort.Location,this.TargetTightPolyline)==Ot.Inside,this.sourcePort instanceof Ys){const i=this.sourcePort;this.StartPointOfEdgeRouting=this.targetIsInsideOfSourceTightPolyline?i.Location:this.TakeBoundaryPortOutsideOfItsLoosePolyline(i.Curve,i.Parameter,this.SourceLoosePolyline),this.CalculateSourcePortVisibilityGraph();const s={smoothedPolyline:null};n=this.targetPort instanceof Ys?this.RouteFromBoundaryPortToBoundaryPort(e,s):this.RouteFromBoundaryPortToFloatingPort(this.targetLoosePolyline,e,s)}else this.targetPort instanceof pl?(this.ExtendVisibilityGraphFromFloatingSourcePort(),n=this.RouteFromFloatingPortToFloatingPort(this.targetLoosePolyline,e,t)):(OS.assert(this.targetPort instanceof Zi),n=this.RouteFromFloatingPortToAnywherePort(this.targetPort.LoosePolyline,e,t,this.targetPort));return n}RouteFromFloatingPortToAnywherePort(e,t,n,i){return i.Curve.boundingBox.contains(this.sourcePort.Location)?(this.sourceVV=this.GetVertex(this.sourcePort.Location),this._polyline=this.GetShortestPolylineToMulitpleTargets(this.sourceVV,Array.from(this.Targets(e))),null==this._polyline?null:(this.UseSpanner&&this.TryShortcutPolyline(),this.RelaxPolyline(),this.FixLastPolylinePointForAnywherePort(i),i.HookSize>0&&this.BuildHook(i),this.SmoothCornersAndReturnCurve(t,n))):(n.smoothedPolyline=null,null)}BuildHook(e){const t=e.Curve,n=Tn.mkFullEllipseNNP(e.HookSize,e.HookSize,this._polyline.end),i=fe.getAllIntersections(t,n,!0);k.getTriangleOrientation(i[0].x,this._polyline.end,this._polyline.endPoint.prev.point)==nt.Counterclockwise&&i.reverse();const s=this._polyline.end.sub(this._polyline.endPoint.prev.point).normalize(),o=t.derivative(i[0].par0).normalize(),a=o.dot(s);if(Math.abs(a)<.2)this.ExtendPolyline(o,i[0],s,e);else{const l=t.derivative(i[1].par0).normalize();l.dot(s)<a?this.ExtendPolyline(l,i[1],s,e):this.ExtendPolyline(o,i[0],s,e)}}ExtendPolyline(e,t,n,i){let s=e.rotate(Math.PI/2);s.dot(n)<0&&(s=s.neg());const o=t.x.add(s.mul(i.HookSize));let a;!(a=k.lineLineIntersection(o,o.add(e),this._polyline.end,this._polyline.end.add(n)))||(this._polyline.addPoint(a),this._polyline.addPoint(o),this._polyline.addPoint(t.x))}FixLastPolylinePointForAnywherePort(e){for(;;){const t=this.GetLastPointInsideOfCurveOnPolyline(e.Curve);t.next.next=null,this._polyline.endPoint=t.next;let n=t.next.point.sub(t.point);n=n.normalize().mul(e.Curve.boundingBox.diagonal);const i=n.rotate(-1*e.AdjustmentAngle),s=n.rotate(e.AdjustmentAngle),o=fe.intersectionOne(e.Curve,Me.mkPP(t.point,t.point.add(i)),!0),a=fe.intersectionOne(e.Curve,Me.mkPP(t.point,t.point.add(s)),!0);if(null==o||null==a)return;const l=On.GetTrimmedCurveForHookingUpAnywhere(e.Curve,t,o,a),c=l.value(l.closestParameter(t.point));if(!this.LineAvoidsTightHierarchyLPP(Me.mkPP(t.point,c),this.SourceTightPolyline,null)){const d=fe.intersectionOne(e.Curve,Me.mkPP(t.point,t.next.point),!1);if(null==d)return;this._polyline.endPoint.point=d.x;break}if(this._polyline.endPoint.point=c,null==t.prev||!this.TryShortcutPolyPoint(t.prev))break}}static GetTrimmedCurveForHookingUpAnywhere(e,t,n,i){const s=k.getTriangleOrientation(i.x,n.x,t.point)==nt.Clockwise,o=n.par0,a=i.par0;let l,c,d;return s?o<a?e.trim(o,a):(c=e.trim(o,e.parEnd),l=e.trim(e.parStart,a),d=new fe,d.addSegs([c,l])):a<o?e.trim(a,o):(c=e.trim(a,e.parEnd),l=e.trim(e.parStart,o),d=new fe,d.addSegs([c,l]))}GetLastPointInsideOfCurveOnPolyline(e){for(let t=this._polyline.endPoint.prev;null!=t;t=t.prev)if(null==t.prev||fe.PointRelativeToCurveLocation(t.point,e)==Ot.Inside)return t;throw new Error}GetShortestPolylineToMulitpleTargets(e,t){this.CleanTheGraphForShortestPath();const i=new _y(e,t,this.VisibilityGraph).GetPath();if(null==i)return null;const s=new At;for(const o of i)s.addPoint(o.point);return On.RemoveCollinearVertices(s)}Targets(e){return Array.from(e).map(t=>this.visibilityGraph.FindVertex(t))}ExtendVisibilityGraphFromFloatingSourcePort(){this.StartPointOfEdgeRouting=this.sourcePort.Location,this.sourceVV=this.UseSpanner?this.AddTransientVisibilityEdgesForPort(this.sourcePort.Location,this.SourceLoosePolyline):mc.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()).filter(t=>t!=this.SourceLoosePolyline),this.VisibilityGraph,this.StartPointOfEdgeRouting,El.Tangent)}FigureOutSourceTargetPolylinesAndActiveRectangle(){let e=this.sourcePort.Curve.value(this.sourcePort.Curve.parStart);this._sourceTightPolyline=On.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfTightHierarchy),this.SourceLoosePolyline=On.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy),e=this.targetPort.Curve.value(this.targetPort.Curve.parStart),this.targetTightPolyline=On.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfTightHierarchy),this.targetLoosePolyline=On.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy),this.activeRectangle=lt.mkPP(new k(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),new k(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY))}*AllPolygons(){for(const e of this.ObstacleCalculator.LooseObstacles)yield new Us(e)}GetVisibilityGraph(){return this.VisibilityGraph}AddActivePolygons(e){bu(this.activePolygons,e)}ClearActivePolygons(){this.activePolygons=[]}}class xy{constructor(){this.size_=0,this.mapOfMaps=new Vs}clear(){this.mapOfMaps.clear(),this.size_=0}get size(){return this.size_}set(e,t){const n=e.first,i=e.second;let s=this.mapOfMaps.get(n);null==s&&this.mapOfMaps.set(n,s=new Vs),s.has(i)||this.size_++,s.set(i,t)}delete(e){const n=e.second,i=this.mapOfMaps.get(e.first);null!=i&&i.deleteP(n)&&this.size_--}has(e){const t=this.mapOfMaps.get(e.first);return null!=t&&t.has(e.second)}get_(e,t){return this.get(new qi(e,t))}get(e){const t=this.mapOfMaps.get(e.first);if(null!=t)return t.get(e.second)}*keys(){for(const e of this.mapOfMaps)for(const t of e[1])yield new qi(e[0],t[0])}*[Symbol.iterator](){for(const[e,t]of this.mapOfMaps)for(const[n,i]of t)yield[new qi(e,n),i]}*values(){for(const e of this.mapOfMaps)for(const t of e[1])yield t[1]}}class fo{static GetShapes(e,t=Array.from(e.edges())){const n=new Map;uL(e,n);for(const i of t){let s=n.get(i.source);s&&null!=i.sourcePort&&s.Ports.add(i.sourcePort),s=n.get(i.target),s&&null!=i.targetPort&&s.Ports.add(i.targetPort)}return Array.from(n.values())}static CreateShapeWithCenterPort(e){const t=new ST(()=>e.boundaryCurve),n=Ru.mk(()=>e.boundaryCurve,()=>e.center);t.Ports.add(n);for(const i of e.inEdges())fo.FixPortAtTarget(n,i);for(const i of e.outEdges())fo.FixPortAtSource(n,i);for(const i of e.selfEdges())fo.FixPortAtSource(n,i),fo.FixPortAtTarget(n,i);return t}static CreateShapeWithClusterBoundaryPort(e){OS.assert(e instanceof xa);const t=new ST(()=>e.boundaryCurve),n=$o.mk(()=>e.boundaryCurve,()=>e.center);let i;t.Ports.add(n);for(const s of e.inEdges())s.EdgeToAncestor()==yu.ToAncestor?(null==i&&(i=new Zi(()=>e.boundaryCurve)),s.targetPort=i):fo.FixPortAtTarget(n,s);for(const s of e.outEdges())s.EdgeToAncestor()==yu.FromAncestor?(null==i&&(i=new Zi(()=>e.boundaryCurve)),s.sourcePort=i):fo.FixPortAtSource(n,s);for(const s of e.selfEdges())fo.FixPortAtSource(n,s),fo.FixPortAtTarget(n,s);return t}static FixPortAtSource(e,t){null==t.sourcePort&&(t.sourcePort=e)}static FixPortAtTarget(e,t){null==t.targetPort&&(t.targetPort=e)}}function uL(r,e){for(const t of r.shallowNodes())if(t instanceof xa){const n=fo.CreateShapeWithClusterBoundaryPort(t);e.set(t,n);const i=t;if(!i.graph.isCollapsed){uL(i,e);for(const s of i.shallowNodes())n.AddChild(e.get(s))}}else e.set(t,fo.CreateShapeWithCenterPort(t))}class Ly{constructor(e){this.Right=e,this.Left=e}SetActiveState(e,t){this.IsActive=e,this.VectorIndex=t,this.IsActive?(this.Left.ActiveConstraintCount++,this.Right.ActiveConstraintCount++):(this.Left.ActiveConstraintCount--,this.Right.ActiveConstraintCount--)}SetVectorIndex(e){this.VectorIndex=e}Reinitialize(){this.IsActive=!1,this.IsUnsatisfiable=!1,this.ClearDfDv()}UpdateGap(e){this.Gap=e}static constructorVVNB(e,t,n,i){const s=new Ly(e);return s.Left=e,s.Right=t,s.Gap=n,s.IsEquality=i,s.Lagrangian=0,s.IsActive=!1,s}ToString(){return pi.String.Format("  Cst: [{0}] [{1}] {2} {3:F5} vio {4:F5} Lm {5:F5}/{6:F5} {7}actv",this.Left,this.Right,this.IsEquality?"==":">=",this.Gap,this.Violation,this.Lagrangian,2*this.Lagrangian,this.IsActive?"+":this.IsUnsatisfiable?"!":"-")}get Violation(){return this.Left.ActualPos*this.Left.Scale+(this.Gap-this.Right.ActualPos*this.Right.Scale)}ClearDfDv(){this.Lagrangian=0}CompareTo(e){let t=this.Left.CompareTo(e.Left);return 0==t&&(t=this.Right.CompareTo(e.Right)),0==t&&(t=$n(this.Gap,e.Gap)),t}}class My{constructor(e){this.ConstraintToEval=e,this.Depth=-1}static constructorDCVV(e,t,n,i){const s=new My(t);return s.Set(e,t,n,i),s}Set(e,t,n,i){return this.Parent=e,this.ConstraintToEval=t,this.VariableToEval=n,this.VariableDoneEval=i,this.Depth=0,this.ChildrenHaveBeenPushed=!1,t.Lagrangian=0,this}get IsLeftToRight(){return this.VariableToEval==this.ConstraintToEval.Right}toString(){return pi.String.Format("{0} {1}{2} - {3}{4} ({5})","",this.IsLeftToRight?"":"*",this.ConstraintToEval.Left.Name,this.IsLeftToRight?"*":"",this.ConstraintToEval.Right.Name,this.Depth)}}class s4{constructor(e,t){this.Constraint=e,this.IsForward=t}}class WS{constructor(e,t){this.Variables=new Array,null!=e&&this.AddVariable(e),this.allConstraints=t}toString(){return pi.String.Format("[Block: nvars = {0} refpos = {1:F5} scale = {2:F5}]",this.Variables.length,this.ReferencePos,this.Scale)}ComputeDfDv(e){this.allConstraints.DfDvStack=new cr.K;const t=new Ly(e);this.dfDvDummyParentNode=new My(t);const n=this.GetDfDvNode(this.dfDvDummyParentNode,t,e,null);for(this.allConstraints.DfDvStack.push(n);;){const i=this.allConstraints.DfDvStack.top,s=this.allConstraints.DfDvStack.length;if(!i.ChildrenHaveBeenPushed){i.ChildrenHaveBeenPushed=!0;for(const o of i.VariableToEval.LeftConstraints)if(o.IsActive&&o.Right!=i.VariableDoneEval){const a=this.GetDfDvNode(i,o,o.Right,i.VariableToEval);1==o.Right.ActiveConstraintCount?this.ProcessDfDvLeafNodeDirectly(a):this.PushDfDvNode(a)}for(const o of i.VariableToEval.RightConstraints)if(o.IsActive&&o.Left!=i.VariableDoneEval){const a=this.GetDfDvNode(i,o,o.Left,i.VariableToEval);1==o.Left.ActiveConstraintCount?this.ProcessDfDvLeafNodeDirectly(a):this.PushDfDvNode(a)}if(this.allConstraints.DfDvStack.length>s)continue}if(this.allConstraints.DfDvStack.pop(),this.ProcessDfDvLeafNode(i),i==n)break}}ProcessDfDvLeafNode(e){const t=e.VariableToEval.DfDv;e.IsLeftToRight?(e.ConstraintToEval.Lagrangian=e.ConstraintToEval.Lagrangian+t,e.Parent.ConstraintToEval.Lagrangian=e.Parent.ConstraintToEval.Lagrangian+e.ConstraintToEval.Lagrangian):(e.ConstraintToEval.Lagrangian=-1*(e.ConstraintToEval.Lagrangian+t),e.Parent.ConstraintToEval.Lagrangian=e.Parent.ConstraintToEval.Lagrangian-e.ConstraintToEval.Lagrangian),this.CheckForConstraintPathTarget(e),this.Debug_CheckForViolatedActiveConstraint(e.ConstraintToEval),this.allConstraints.RecycleDfDvNode(e)}Debug_CheckForViolatedActiveConstraint(e){}ProcessDfDvLeafNodeDirectly(e){this.ProcessDfDvLeafNode(e)}GetDfDvNode(e,t,n,i){const s=this.allConstraints.DfDvRecycleStack.size>0?this.allConstraints.DfDvRecycleStack.pop().Set(e,t,n,i):My.constructorDCVV(e,t,n,i);return s.Depth=s.Parent.Depth+1,this.allConstraints.MaxConstraintTreeDepth<s.Depth&&(this.allConstraints.MaxConstraintTreeDepth=s.Depth),s}PushDfDvNode(e){this.PushOnDfDvStack(e)}AddVariableAndPushDfDvNode(e,t){e.push(t.VariableToEval),this.PushOnDfDvStack(t)}PushOnDfDvStack(e){this.allConstraints.DfDvStack.push(e)}CheckForConstraintPathTarget(e){if(this.pathTargetVariable==e.VariableToEval){for(;e.Parent!=this.dfDvDummyParentNode;)this.constraintPath.push(new s4(e.ConstraintToEval,e.IsLeftToRight)),e=e.Parent;this.pathTargetVariable=null}}Expand(e){null==this.constraintPath&&(this.constraintPath=new Array),this.constraintPath=[],this.pathTargetVariable=e.Right,this.ComputeDfDv(e.Left);let t=null;if(this.constraintPath.length>0){for(const o of this.constraintPath)o.IsForward&&(null==t||o.Constraint.Lagrangian<t.Lagrangian)&&(o.Constraint.IsEquality||(t=o.Constraint));null!=t&&this.allConstraints.DeactivateConstraint(t)}if(this.constraintPath=[],this.pathTargetVariable=null,null==t)return e.IsUnsatisfiable=!0,void this.allConstraints.NumberOfUnsatisfiableConstraints++;const n=new Array;this.GetConnectedVariables(n,e.Right,e.Left);const i=e.Violation,s=n.length;for(let o=0;o<s;o++)n[o].OffsetInBlock=n[o].OffsetInBlock+i;this.allConstraints.ActivateConstraint(e),e.ClearDfDv(),this.UpdateReferencePos()}Split(e){if(e&&this.UpdateReferencePos(),this.Variables.length<2)return null;let t=null;this.ComputeDfDv(this.Variables[0]);let n=this.allConstraints.SolverParameters.Advanced.MinSplitLagrangianThreshold;const i=this.Variables.length;for(let s=0;s<i;s++)for(const o of this.Variables[s].LeftConstraints)o.IsActive&&!o.IsEquality&&o.Lagrangian<n&&(t=o,n=o.Lagrangian);return null==t?null:this.SplitOnConstraint(t)}SplitOnConstraint(e){this.allConstraints.DeactivateConstraint(e);let t=new WS(null,this.allConstraints);return this.TransferConnectedVariables(t,e.Right,e.Left),t.Variables.length>0?(this.UpdateReferencePos(),t.UpdateReferencePos()):t=null,t}AddVariable(e){this.Variables.push(e),e.Block=this,1==this.Variables.length?(this.Scale=e.Scale,this.ReferencePos=e.ActualPos,this.sumAd=e.ActualPos*e.Weight,this.sumAb=0,this.sumA2=e.Weight,e.OffsetInBlock=0):this.AddVariableToBlockSums(e)}UpdateReferencePos(){this.Scale=this.Variables[0].Scale,this.sumAd=0,this.sumAb=0,this.sumA2=0;const e=this.Variables.length;for(let t=0;t<e;t++)this.AddVariableToBlockSums(this.Variables[t]);this.UpdateReferencePosFromSums()}AddVariableToBlockSums(e){const t=this.Scale/e.Scale,n=e.OffsetInBlock/e.Scale,i=t*e.Weight;this.sumAd=this.sumAd+i*e.DesiredPos,this.sumAb=this.sumAb+i*n,this.sumA2=this.sumA2+i*t}UpdateReferencePosFromSums(){if(!(Number.isFinite(this.sumAd)&&Number.isFinite(this.sumAb)&&Number.isFinite(this.sumA2)))throw new Error("infinite numbers");this.ReferencePos=(this.sumAd-this.sumAb)/this.sumA2,this.UpdateVariablePositions()}UpdateVariablePositions(){const e=this.Scale*this.ReferencePos,t=this.Variables.length;for(let n=0;n<t;n++){const i=this.Variables[n];i.ActualPos=(e+i.OffsetInBlock)/i.Scale}}GetConnectedVariables(e,t,n){this.RecurseGetConnectedVariables(e,t,n)}RecurseGetConnectedVariables(e,t,n){this.allConstraints.DfDvStack=new cr.K;const i=new Ly(t);for(this.dfDvDummyParentNode=new My(i),this.allConstraints.DfDvStack.push(this.GetDfDvNode(this.dfDvDummyParentNode,i,t,n)),e.push(t);this.allConstraints.DfDvStack.length>0;){const s=this.allConstraints.DfDvStack.top,o=this.allConstraints.DfDvStack.length;if(!s.ChildrenHaveBeenPushed){s.ChildrenHaveBeenPushed=!0;for(const a of s.VariableToEval.LeftConstraints)a.IsActive&&a.Right!=s.VariableDoneEval&&(1==a.Right.ActiveConstraintCount?e.push(a.Right):this.AddVariableAndPushDfDvNode(e,this.GetDfDvNode(s,a,a.Right,s.VariableToEval)));for(const a of s.VariableToEval.RightConstraints)a.IsActive&&a.Left!=s.VariableDoneEval&&(1==a.Left.ActiveConstraintCount?e.push(a.Left):this.AddVariableAndPushDfDvNode(e,this.GetDfDvNode(s,a,a.Left,s.VariableToEval)))}this.allConstraints.DfDvStack.length>o||this.allConstraints.RecycleDfDvNode(this.allConstraints.DfDvStack.pop())}}TransferConnectedVariables(e,t,n){this.GetConnectedVariables(e.Variables,t,n);const i=e.Variables.length;for(let o=0;o<i;o++)e.Variables[o].Block=e;let s=this.Variables.length-1;for(let o=this.Variables.length-1;o>=0;o--)this.Variables[o].Block==e&&(o<s&&(this.Variables[o]=this.Variables[s]),s--);if(this.Variables=this.Variables.slice(0,s+1),0==this.Variables.length){for(let o=0;o<i;o++){const a=e.Variables[o];this.Variables.push(a),a.Block=this}e.Variables=[]}}}class o4{constructor(){this.Vector=new Array}get Count(){return this.Vector.length}item(e){return this.Vector[e]}Add(e){e.VectorIndex=this.Vector.length,this.Vector.push(e)}Remove(e){const t=this.Vector[this.Vector.length-1];this.Vector[e.VectorIndex]=t,t.VectorIndex=e.VectorIndex,this.Vector.pop()}toString(){return this.Vector.toString()}}class a4{constructor(){this.nextConstraintIndex=0,this.DfDvStack=new cr.K,this.DfDvRecycleStack=new cr.K}get IsEmpty(){return null==this.Vector}Create(e){this.Vector=new Array(e),this.firstActiveConstraintIndex=e}Add(e){e.SetVectorIndex(this.nextConstraintIndex),this.Vector[this.nextConstraintIndex++]=e}ActivateConstraint(e){this.firstActiveConstraintIndex--,this.SwapConstraint(e)}DeactivateConstraint(e){this.SwapConstraint(e),this.firstActiveConstraintIndex++}SwapConstraint(e){const t=this.Vector[this.firstActiveConstraintIndex];t.SetVectorIndex(e.VectorIndex),this.Vector[e.VectorIndex]=t,this.Vector[this.firstActiveConstraintIndex]=e,e.SetActiveState(!e.IsActive,this.firstActiveConstraintIndex)}Reinitialize(){if(null!=this.Vector){for(const e of this.Vector)e.Reinitialize();this.firstActiveConstraintIndex=this.Vector.length}}RecycleDfDvNode(e){this.DfDvRecycleStack.length<1024&&this.DfDvRecycleStack.push(e)}toString(){return this.Vector.toString()}}class TT{constructor(){this.GapTolerance=1e-4,this.QpscConvergenceEpsilon=1e-5,this.QpscConvergenceQuotient=1e-6,this.OuterProjectIterationsLimit=-1,this.InnerProjectIterationsLimit=-1,this.TimeLimit=-1,this.Advanced=new OT}Clone(){const e=this.MemberwiseClone();return e.Advanced=this.Advanced.Clone(),e}MemberwiseClone(){const e=new TT;return e.GapTolerance=this.GapTolerance,e.QpscConvergenceEpsilon=this.QpscConvergenceEpsilon,e.QpscConvergenceQuotient=this.QpscConvergenceQuotient,e.OuterProjectIterationsLimit=this.OuterProjectIterationsLimit,e.InnerProjectIterationsLimit=this.InnerProjectIterationsLimit,e.TimeLimit=this.TimeLimit,e}}class OT{constructor(){this.ForceQpsc=!1,this.ScaleInQpsc=!0,this.MinSplitLagrangianThreshold=-1e-7,this.UseViolationCache=!0,this.ViolationCacheMinBlocksDivisor=10,this.ViolationCacheMinBlocksCount=100}Clone(){const e=new OT;return e.ForceQpsc=this.ForceQpsc,e.ScaleInQpsc=this.ScaleInQpsc,e.MinSplitLagrangianThreshold=this.MinSplitLagrangianThreshold,e.UseViolationCache=this.UseViolationCache,e.ViolationCacheMinBlocksDivisor=this.ViolationCacheMinBlocksDivisor,e.ViolationCacheMinBlocksCount=this.ViolationCacheMinBlocksCount,e}}class l4{constructor(e){this.Variable=e,this.OrigWeight=e.Weight,this.OrigScale=e.Scale,this.OrigDesiredPos=this.Variable.DesiredPos}}class c4{constructor(e,t){this.Value=e,this.Column=t}}class go{constructor(e,t){this.newMatrixRow=new Array,this.previousFunctionValue=Number.MAX_VALUE,this.solverParameters=this.solverParameters,this.matrixQ=new Array(t),this.vectorWiDi=new Array(t),this.vectorQpscVars=new Array(t),this.gradientVector=new Array(t),this.vectorQg=new Array(t),this.vectorPrevY=new Array(t),this.vectorCurY=new Array(t)}AddVariable(e){if(this.isFirstProjectCall=!0,this.vectorWiDi[e.Ordinal]=e.Weight*e.DesiredPos*2*-1,this.vectorPrevY[e.Ordinal]=e.Weight,null!=e.Neighbors)for(const t of e.Neighbors)this.vectorPrevY[e.Ordinal]=this.vectorPrevY[e.Ordinal]+t.Weight,this.vectorPrevY[t.Neighbor.Ordinal]=this.vectorPrevY[t.Neighbor.Ordinal]-t.Weight;for(let t=0;t<this.vectorPrevY.length;t++)0!=this.vectorPrevY[t]&&(this.newMatrixRow.push(new c4(2*this.vectorPrevY[t],t)),this.vectorPrevY[t]=0);this.matrixQ[e.Ordinal]=Array.from(this.newMatrixRow),this.newMatrixRow=[],this.vectorQpscVars[e.Ordinal]=new l4(e),e.Weight=1}VariablesComplete(){for(const e of this.vectorQpscVars){const t=e.Variable;for(const n of this.matrixQ[t.Ordinal])n.Column==t.Ordinal&&(this.solverParameters.Advanced.ScaleInQpsc&&(t.Scale=1/Math.sqrt(Math.abs(n.Value)),Number.isFinite(t.Scale)||(t.Scale=1),this.vectorWiDi[t.Ordinal]=this.vectorWiDi[t.Ordinal]*t.Scale),this.vectorCurY[t.Ordinal]=t.ActualPos,t.DesiredPos=t.ActualPos)}if(this.solverParameters.Advanced.ScaleInQpsc)for(let e=0;e<this.matrixQ.length;e++){const t=this.matrixQ[e];for(let n=0;n<t.length;n++)t[n].Value=t[n].Column==e?1:t[n].Value*(this.vectorQpscVars[e].Variable.Scale*this.vectorQpscVars[t[n].Column].Variable.Scale)}}PreProject(){if(this.isFirstProjectCall)for(const i of this.vectorQpscVars)this.vectorCurY[i.Variable.Ordinal]=i.Variable.ActualPos;if(this.MatrixVectorMultiply(this.vectorCurY,this.gradientVector),this.HasConverged())return!1;go.VectorVectorAdd(this.gradientVector,this.vectorWiDi,this.gradientVector);const e=go.VectorVectorMultiply(this.gradientVector,this.gradientVector);let t=0;if(0!=e&&(this.MatrixVectorMultiply(this.gradientVector,this.vectorQg),t=go.VectorVectorMultiply(this.vectorQg,this.gradientVector)),0==t)return!1;const n=e/t;go.VectorCopy(this.vectorPrevY,this.vectorCurY),go.VectorScaledVectorSubtract(this.vectorPrevY,n,this.gradientVector,this.vectorCurY);for(let i=0;i<this.vectorCurY.length;i++)this.vectorQpscVars[i].Variable.DesiredPos=this.vectorCurY[i];return!0}PostProject(){for(const n of this.vectorQpscVars)this.vectorCurY[n.Variable.Ordinal]=n.Variable.ActualPos;go.VectorVectorSubtract(this.vectorPrevY,this.vectorCurY,this.vectorCurY);const e=go.VectorVectorMultiply(this.gradientVector,this.vectorCurY);let t=0;if(0!=e){this.MatrixVectorMultiply(this.vectorCurY,this.vectorQg);const n=go.VectorVectorMultiply(this.vectorQg,this.vectorCurY);t=0==n?1:e/n,t>1?t=1:t<0&&(t=0)}return go.VectorScaledVectorSubtract(this.vectorPrevY,t,this.vectorCurY,this.vectorCurY),this.isFirstProjectCall=!1,t>0}QpscComplete(){for(const e of this.vectorQpscVars)e.Variable.Weight=e.OrigWeight,e.Variable.DesiredPos=e.OrigDesiredPos,this.solverParameters.Advanced.ScaleInQpsc&&(e.Variable.ActualPos=e.Variable.ActualPos*e.Variable.Scale,e.Variable.Scale=e.OrigScale);return this.previousFunctionValue}HasConverged(){const e=this.GetFunctionValue(this.vectorCurY);let t=!1;if(!this.isFirstProjectCall){const n=this.previousFunctionValue-e;let i=0;0!=n&&(i=Math.abs(n/(0!=this.previousFunctionValue?this.previousFunctionValue:e))),(Math.abs(n)<this.solverParameters.QpscConvergenceEpsilon||Math.abs(i)<this.solverParameters.QpscConvergenceQuotient)&&(t=!0)}return this.previousFunctionValue=e,t}GetFunctionValue(e){return go.VectorVectorMultiply(this.gradientVector,e)/2+go.VectorVectorMultiply(this.vectorWiDi,e)}static VectorVectorMultiply(e,t){let n=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i];return n}MatrixVectorMultiply(e,t){let n=0;for(const i of this.matrixQ){let s=0;for(const o of i)s+=o.Value*e[o.Column];t[n++]=s}}static VectorVectorAdd(e,t,n){for(let i=0;i<e.length;i++)n[i]=e[i]+t[i]}static VectorVectorSubtract(e,t,n){for(let i=0;i<e.length;i++)n[i]=e[i]-t[i]}static VectorScaledVectorSubtract(e,t,n,i){for(let s=0;s<e.length;s++)i[s]=e[s]-t*n[s]}static VectorCopy(e,t){for(let n=0;n<t.length;n++)e[n]=t[n]}}class jS{get ExecutionLimitExceeded(){return this.TimeLimitExceeded||this.OuterProjectIterationsLimitExceeded||this.InnerProjectIterationsLimitExceeded}Clone(){const e=new jS;return e.GoalFunctionValue=this.GoalFunctionValue,e.InnerProjectIterationsLimitExceeded=this.InnerProjectIterationsLimitExceeded,e.InnerProjectIterationsTotal=this.InnerProjectIterationsTotal,e.MaxConstraintTreeDepth=this.MaxConstraintTreeDepth,e.OuterProjectIterations=this.OuterProjectIterations,e.OuterProjectIterationsLimitExceeded=this.OuterProjectIterationsLimitExceeded,e.AlgorithmUsed=this.AlgorithmUsed,e.NumberOfUnsatisfiableConstraints=this.NumberOfUnsatisfiableConstraints,e.MaxInnerProjectIterations=this.MaxInnerProjectIterations,e}}var Fy=(()=>{return(r=Fy||(Fy={}))[r.ProjectOnly=0]="ProjectOnly",r[r.QpscWithScaling=1]="QpscWithScaling",r[r.QpscWithoutScaling=2]="QpscWithoutScaling",Fy;var r})();class u4{constructor(e,t){this.Neighbor=e,this.Weight=t}}class h4{constructor(e,t,n,i,s){if(this.ActiveConstraintCount=0,i<=0)throw new Error("weight");if(s<=0)throw new Error("scale");let o=n*i;if(!Number.isFinite(o)||Number.isNaN(o))throw new Error("desiredPos");if(o=n*s,!Number.isFinite(o)||Number.isNaN(o))throw new Error("desiredPos");this.Ordinal=e,this.UserData=t,this.DesiredPos=n,this.Weight=i,this.Scale=s,this.OffsetInBlock=0,this.ActualPos=this.DesiredPos}get DfDv(){return this.Weight*(this.ActualPos-this.DesiredPos)*2/this.Scale}Reinitialize(){this.ActiveConstraintCount=0,this.OffsetInBlock=0,this.ActualPos=this.DesiredPos}AddNeighbor(e,t){null==this.Neighbors&&(this.Neighbors=new Array),this.Neighbors.push(new u4(e,t))}toString(){return pi.String.Format("{0} {1:F5} ({2:F5}) {3:F5} {4:F5}",this.Name,this.ActualPos,this.DesiredPos,this.Weight,this.Scale)}get Name(){return null==this.UserData?"-0-":this.UserData.toString()}SetConstraints(e,t){this.LeftConstraints=e,this.RightConstraints=t}CompareTo(e){return $n(this.Ordinal,e.Ordinal)}}let d4=(()=>{class r{get IsFull(){return this.numConstraints==r.MaxConstraints}Clear(){this.LowViolation=0,this.numConstraints=0,this.constraints||(this.constraints=new Array(r.MaxConstraints))}FilterBlock(t){this.LowViolation=Number.MAX_VALUE;const n=this.numConstraints>0;for(let i=this.numConstraints-1;i>=0;i--){const s=this.constraints[i];if(s.Left.Block==t||s.Right.Block==t||s.IsActive||s.IsUnsatisfiable)i<this.numConstraints-1&&(this.constraints[i]=this.constraints[this.numConstraints-1]),this.numConstraints--;else{const o=s.Left.ActualPos*s.Left.Scale+(s.Gap-s.Right.ActualPos*s.Right.Scale);o<this.LowViolation&&(this.LowViolation=o)}}return 0==this.numConstraints&&(this.LowViolation=0),n}FindIfGreater(t){let n=null;for(let i=0;i<this.numConstraints;i++){const s=this.constraints[i],o=s.Left.ActualPos*s.Left.Scale+(s.Gap-s.Right.ActualPos*s.Right.Scale);o>t&&(t=o,n=s)}return n}Insert(t,n){let i=0,s=n,o=n;for(let a=0;a<this.numConstraints;a++){const l=this.constraints[a],c=l.Left.ActualPos*l.Left.Scale+(l.Gap-l.Right.ActualPos*l.Right.Scale);c<s?(o=s,i=a,s=c):c<o&&(o=c)}this.IsFull?(this.constraints[i]=t,this.LowViolation=o):(this.constraints[this.numConstraints++]=t,this.IsFull&&(this.LowViolation=s))}}return r.MaxConstraints=20,r})();class hL{constructor(e,t){this.NumberOfLeftConstraints=0,this.Constraints=e,this.NumberOfLeftConstraints=t}}class f4{constructor(){this.allBlocks=new o4,this.allConstraints=new a4,this.numberOfConstraints=0,this.numberOfVariables=0,this.equalityConstraints=new Array,this.loadedVariablesAndConstraintLists=new Map,this.emptyConstraintList=new Array(0),this.updatedConstraints=new Array,this.violationCache=new d4,this.violationCacheMinBlockCutoff=0,this.nextVariableOrdinal=0,this.solverParams=new TT,this.solverSolution=new jS}get IsQpsc(){return this.hasNeighbourPairs||this.solverParams.Advanced.ForceQpsc}AddVariableAN(e,t){return this.AddVariableANNN(e,t,1,1)}AddVariableANN(e,t,n){return this.AddVariableANNN(e,t,n,1)}AddVariableANNN(e,t,n,i){if(!this.allConstraints.IsEmpty)throw new Error("Cannot add Variables or Constraints once Solve() has been called");const s=new h4(this.nextVariableOrdinal++,e,t,n,i),o=new WS(s,this.allConstraints);return s.Block=o,this.allBlocks.Add(o),this.numberOfVariables++,this.loadedVariablesAndConstraintLists.set(s,new hL(new Array,0)),s}UpdateVariables(){for(const e of this.allBlocks.Vector)e.UpdateReferencePos()}get Variables(){return Iy(this.allBlocks.Vector,e=>e.Variables)}get VariableCount(){return this.numberOfVariables}*Constraints(){if(this.allConstraints.IsEmpty)for(const e of this.loadedVariablesAndConstraintLists.keys()){const t=this.loadedVariablesAndConstraintLists.get(e);if(null!=t.Constraints){const n=t.Constraints.length;for(let i=0;i<n;i++){const s=t.Constraints[i];if(e==s.Left)return yield,s}}}else for(const e of this.allConstraints.Vector)yield e}get ConstraintCount(){return this.numberOfConstraints}AddEqualityConstraint(e,t,n){return this.AddConstraintVVNB(e,t,n,!0)}AddConstraintVVNB(e,t,n,i){if(!this.allConstraints.IsEmpty)throw new Error("Cannot add Variables or Constraints once Solve() has been called");if(e==t)throw new Error("Cannot add a constraint between a variable and itself");const s=this.loadedVariablesAndConstraintLists.get(e),o=this.loadedVariablesAndConstraintLists.get(t),a=Ly.constructorVVNB(e,t,n,i);return this.loadedVariablesAndConstraintLists.set(e,new hL(s.Constraints,s.NumberOfLeftConstraints+1)),s.Constraints.push(a),o.Constraints.push(a),this.numberOfConstraints++,i&&this.equalityConstraints.push(a),a}AddConstraint(e,t,n){return this.AddConstraintVVNB(e,t,n,!1)}SetConstraintUpdate(e,t){t!=e.Gap&&this.updatedConstraints.push([e,t])}AddNeighborPair(e,t,n){if(n<=0||Number.isNaN(n)||!Number.isFinite(n))throw new Error("relationshipWeight");if(e==t)throw new Error;e.AddNeighbor(t,n),t.AddNeighbor(e,n),this.hasNeighbourPairs=!0}Solve(){return this.SolvePar(null)}SolvePar(e){e&&(this.solverParams=e.Clone()),this.solverParams.OuterProjectIterationsLimit<0&&(this.solverParams.OuterProjectIterationsLimit=100*(Math.log2(this.numberOfVariables)+1)),this.solverParams.InnerProjectIterationsLimit<0&&(this.solverParams.InnerProjectIterationsLimit=2*this.numberOfConstraints+100*(Math.log2(this.numberOfConstraints)+1));const t=!this.allConstraints.IsEmpty;if(this.CheckForUpdatedConstraints(),this.solverSolution=new jS,this.solverSolution.MinInnerProjectIterations=Number.MAX_VALUE,this.allConstraints.MaxConstraintTreeDepth=0,this.allConstraints.SolverParameters=this.solverParams,0==this.numberOfConstraints){if(!this.IsQpsc)return this.solverSolution.Clone()}else t||this.SetupConstraints();return this.allConstraints.NumberOfUnsatisfiableConstraints=0,this.MergeEqualityConstraints(),this.IsQpsc?this.SolveQpsc():(this.SolveByStandaloneProject(),this.CalculateStandaloneProjectGoalFunctionValue()),this.solverSolution.MinInnerProjectIterations>this.solverSolution.MaxInnerProjectIterations&&(this.solverSolution.MinInnerProjectIterations=this.solverSolution.MaxInnerProjectIterations),this.solverSolution.NumberOfUnsatisfiableConstraints=this.allConstraints.NumberOfUnsatisfiableConstraints,this.solverSolution.MaxConstraintTreeDepth=this.allConstraints.MaxConstraintTreeDepth,this.solverSolution.Clone()}CheckForUpdatedConstraints(){if(0==this.updatedConstraints.length)return;let e=this.IsQpsc;for(const[t,n]of this.updatedConstraints){const i=t;i.UpdateGap(n),e||i.IsEquality?e=!0:this.SplitOnConstraintIfActive(i)}this.updatedConstraints=[],e&&this.ReinitializeBlocks()}SplitOnConstraintIfActive(e){if(e.IsActive){const t=e.Left.Block.SplitOnConstraint(e);null!=t&&this.allBlocks.Add(t)}}SetupConstraints(){this.allConstraints.Create(this.numberOfConstraints);for(const e of this.loadedVariablesAndConstraintLists.keys()){const t=this.loadedVariablesAndConstraintLists.get(e),n=t.Constraints;let i=0,s=0,o=0;null!=n&&(i=n.length,s=t.NumberOfLeftConstraints,o=i-s);let a=this.emptyConstraintList;0!=s&&(a=new Array(s));let l=this.emptyConstraintList;0!=o&&(l=new Array(o)),e.SetConstraints(a,l);let c=0,d=0;for(let b=0;b<i;b++){const N=n[b];e==N.Left?a[c++]=N:l[d++]=N}for(const b of e.LeftConstraints)this.allConstraints.Add(b)}this.loadedVariablesAndConstraintLists.clear(),this.violationCacheMinBlockCutoff=Number.MAX_VALUE,this.solverParams.Advanced.UseViolationCache&&this.solverParams.Advanced.ViolationCacheMinBlocksDivisor>0&&(this.violationCacheMinBlockCutoff=Math.min(this.allBlocks.Count/this.solverParams.Advanced.ViolationCacheMinBlocksDivisor,this.solverParams.Advanced.ViolationCacheMinBlocksCount))}SolveByStandaloneProject(){for(;;){let e;if(!this.RunProject(e))return;if(!this.SplitBlocks())break}}RunProject(e){return this.solverSolution.OuterProjectIterations++,this.Project(),!this.CheckForLimitsExceeded()}CheckForLimitsExceeded(){return this.solverParams.OuterProjectIterationsLimit>0&&this.solverSolution.OuterProjectIterations>=this.solverParams.OuterProjectIterationsLimit?(this.solverSolution.OuterProjectIterationsLimitExceeded=!0,!0):!!this.solverSolution.InnerProjectIterationsLimitExceeded}CalculateStandaloneProjectGoalFunctionValue(){this.solverSolution.GoalFunctionValue=0;const e=this.allBlocks.Count;for(let t=0;t<e;t++){const n=this.allBlocks.item(t),i=n.Variables.length;for(let s=0;s<i;s++){const o=n.Variables[s];this.solverSolution.GoalFunctionValue=this.solverSolution.GoalFunctionValue+o.Weight*(o.ActualPos*o.ActualPos),this.solverSolution.GoalFunctionValue=this.solverSolution.GoalFunctionValue-o.Weight*(o.DesiredPos*o.ActualPos)*2}}}SolveQpsc(){if(this.solverSolution.AlgorithmUsed=this.solverParams.Advanced.ScaleInQpsc?Fy.QpscWithScaling:Fy.QpscWithoutScaling,!this.QpscMakeFeasible())return;const e=new go(this.solverParams,this.numberOfVariables);for(const i of this.allBlocks.Vector)for(const s of i.Variables)e.AddVariable(s);e.VariablesComplete(),this.ReinitializeBlocks(),this.MergeEqualityConstraints();let t=!1;for(;(e.PreProject()||t)&&(t=this.SplitBlocks(),this.RunProject(false))&&(e.PostProject()||t););this.solverSolution.GoalFunctionValue=e.QpscComplete()}QpscMakeFeasible(){return this.RunProject(void 0)}ReinitializeBlocks(){const e=Array.from(this.allBlocks.Vector);this.allBlocks.Vector=[];for(const t of e)for(const n of t.Variables){n.Reinitialize();const i=new WS(n,this.allConstraints);this.allBlocks.Add(i)}this.allConstraints.Reinitialize(),this.violationCache.Clear()}MergeEqualityConstraints(){for(const e of this.equalityConstraints)e.Left.Block!=e.Right.Block?this.MergeBlocks(e):Math.abs(e.Violation)>this.solverParams.GapTolerance&&(e.IsUnsatisfiable=!0,this.allConstraints.NumberOfUnsatisfiableConstraints++)}Project(){if(0==this.numberOfConstraints)return!1;this.violationCache.Clear(),this.lastModifiedBlock=null;let e=this.allBlocks.Count>this.violationCacheMinBlockCutoff,t=1,i=this.GetMaxViolatedConstraint({maxViolation:0},e);if(!i)return!1;for(;i;){if(i.Left.Block==i.Right.Block?(i.Left.Block.Expand(i),i.IsUnsatisfiable&&this.violationCache.Clear(),this.lastModifiedBlock=i.Left.Block):this.lastModifiedBlock=this.MergeBlocks(i),this.solverParams.InnerProjectIterationsLimit>0&&t>=this.solverParams.InnerProjectIterationsLimit){this.solverSolution.InnerProjectIterationsLimitExceeded=!0;break}e=this.allBlocks.Count>this.violationCacheMinBlockCutoff,e||this.violationCache.Clear(),t++,i=this.GetMaxViolatedConstraint({maxViolation:0},e)}return this.solverSolution.InnerProjectIterationsTotal=this.solverSolution.InnerProjectIterationsTotal+t,this.solverSolution.MaxInnerProjectIterations<t&&(this.solverSolution.MaxInnerProjectIterations=t),this.solverSolution.MinInnerProjectIterations>t&&(this.solverSolution.MinInnerProjectIterations=t),!0}MergeBlocks(e){let t=e.Left.Block,n=e.Right.Block,i=e.Left.OffsetInBlock+(e.Gap-e.Right.OffsetInBlock);n.Variables.length>t.Variables.length&&(t=e.Right.Block,n=e.Left.Block,i*=-1);const s=n.Variables.length;for(let o=0;o<s;o++){const a=n.Variables[o];a.OffsetInBlock=a.OffsetInBlock+i,t.AddVariable(a)}return t.UpdateReferencePosFromSums(),this.allConstraints.ActivateConstraint(e),this.allBlocks.Remove(n),t}SplitBlocks(){const e=new Array,t=this.allBlocks.Count;for(let i=0;i<t;i++){const o=this.allBlocks.item(i).Split(this.IsQpsc);null!=o&&e.push(o)}const n=e.length;for(let i=0;i<n;i++)this.allBlocks.Add(e[i]);return 0!=e.length}GetMaxViolatedConstraint(e,t){e.maxViolation=this.solverParams.GapTolerance;const n=this.SearchViolationCache(e.maxViolation);return null!=n?n:this.SearchAllConstraints(e.maxViolation,t)}SearchViolationCache(e){let t=null;if(null==this.lastModifiedBlock)return;this.lastModifiedBlock.Variables.length<this.numberOfVariables+1&&this.violationCache.FilterBlock(this.lastModifiedBlock);const n=this.lastModifiedBlock.Variables.length;for(let s=0;s<n;s++){const o=this.lastModifiedBlock.Variables[s];for(const a of o.LeftConstraints)a.IsActive||a.IsUnsatisfiable||Z0(a.Left.ActualPos*a.Left.Scale+(a.Gap-a.Right.ActualPos*a.Right.Scale),e)&&(null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),e=a.Violation,t=a);for(const a of o.RightConstraints)if(!a.IsActive&&!a.IsUnsatisfiable&&a.Left.Block!=this.lastModifiedBlock){const l=a.Left.ActualPos*a.Left.Scale+(a.Gap-a.Right.ActualPos*a.Right.Scale);Z0(l,e)&&(null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),e=l,t=a)}}const i=this.violationCache.FindIfGreater(e);return null!=i&&(null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),t=i),t}SearchAllConstraints(e,t){let n=null;this.violationCache.Clear();for(const i of this.allConstraints.Vector){if(i.IsActive)break;if(i.IsUnsatisfiable)continue;const s=i.Left.ActualPos*i.Left.Scale+(i.Gap-i.Right.ActualPos*i.Right.Scale);let o=null,a=0;Z0(s,e)&&(e>this.violationCache.LowViolation&&(o=n,a=e),e=s,n=i),t&&(null==o&&i!=n&&(!this.violationCache.IsFull||s>this.violationCache.LowViolation)&&(o=i,a=s),null!=o&&a>this.violationCache.LowViolation&&this.violationCache.Insert(o,a))}return n}}let g4=(()=>{class r{constructor(){this.variables=new Map,this.fixedVars=new Map,this.FailToAdjustEpsilon=.001,this.InitSolver()}AddVariableWithIdealPositionNNN(t,n,i){this.variables.set(t,this.solver.AddVariableANN(t,n,i))}AddVariableWithIdealPositionNN(t,n){this.AddVariableWithIdealPositionNNN(t,n,1)}AddLeftRightSeparationConstraintNNNB(t,n,i,s){const o=this.GetVariable(t);if(null==o)return;const a=this.GetVariable(n);null!=a&&this.solver.AddConstraintVVNB(o,a,i,s)}AddLeftRightSeparationConstraintNNN(t,n,i){this.AddLeftRightSeparationConstraintNNNB(t,n,i,!1)}AddGoalTwoVariablesAreCloseNNN(t,n,i){const s=this.GetVariable(t);if(null==s)return;const o=this.GetVariable(n);null!=o&&this.solver.AddNeighborPair(s,o,i)}AddGoalTwoVariablesAreClose(t,n){this.AddGoalTwoVariablesAreCloseNNN(t,n,1)}GetVariable(t){return this.variables.get(t)}Solve(){this.SolveP(null)}SolveP(t){this.SolvePNS(t,{executionLimitExceeded:!1})}SolvePNS(t,n){let i;do{this.solution=null;let s=null;if(null!=t&&(s=t,null==s))throw new Error("parameters");this.solution=this.solver.SolvePar(s),n.executionLimitExceeded=this.solution.ExecutionLimitExceeded,i=this.AdjustConstraintsForMovedFixedVars()}while(i&&0==this.solution.ExecutionLimitExceeded);return 0==this.solution.ExecutionLimitExceeded}AdjustConstraintsForMovedFixedVars(){const t=new Set;for(const[n,i]of this.fixedVars.entries())r.Close(i,this.GetVariableResolvedPosition(n))||t.add(n);return 0!=t.size&&this.AdjustConstraintsForMovedFixedVarSet(t)}static Close(t,n){return Math.abs(t-n)<5e-4}AdjustConstraintsForMovedFixedVarSet(t){for(;t.size>0;){let n;for(const i of t){n=i;break}if(!this.AdjustSubtreeOfFixedVar(n,t))return!1}return!0}AdjustSubtreeOfFixedVar(t,n){const i={successInAdjusting:!1},s=this.AdjustConstraintsOfNeighborsOfFixedVariable(t,i);if(!i.successInAdjusting||0==s.length)return!1;for(const o of s)n.delete(o);return!0}AdjustConstraintsOfNeighborsOfFixedVariable(t,n){const i=this.variables.get(t).Block.Variables,s=new zo,o=new zo;let a=1;for(const l of i)!this.fixedVars.has(l.UserData)||(s.AddValue(l.ActualPos),o.AddValue(l.DesiredPos),o.length>0&&(a=Math.max(a,s.length/o.length)));return 1==a&&(a=2),n.successInAdjusting=this.FixActiveConstraints(i,a),i.map(l=>l.UserData)}FixActiveConstraints(t,n){let i=!1;for(const s of t)for(const o of s.LeftConstraints)o.IsActive&&(o.Gap>this.FailToAdjustEpsilon&&(i=!0),this.solver.SetConstraintUpdate(o,o.Gap/n));return i}GetVariableResolvedPosition(t){const n=this.GetVariable(t);return null==n?0:n.ActualPos}InitSolver(){this.solver=new f4,this.variables.clear()}AddFixedVariable(t,n){this.AddVariableWithIdealPositionNNN(t,n,r.FixedVarWeight),this.fixedVars.set(t,n)}ContainsVariable(t){return this.variables.has(t)}GetVariableIdealPosition(t){return this.variables.get(t).DesiredPos}get Solution(){return this.solution}}return r.FixedVarWeight=1e9,r})();class p4{constructor(){this.lowBound=Number.NEGATIVE_INFINITY,this.upperBound=Number.POSITIVE_INFINITY}get Position(){return this.position}set Position(e){this.position=e<this.lowBound?this.lowBound:e>this.upperBound?this.upperBound:e}get LowBound(){return this.lowBound}set LowBound(e){this.lowBound=e}get UpperBound(){return this.upperBound}set UpperBound(e){this.upperBound=e}toString(){return this.lowBound+" "+this.Position+" "+this.upperBound}}class m4{constructor(e){this.idealPositions=new Map,this.varList=new Array,this.constraints=new Set,this.solverShell=new g4,this.boundsToInt=new Map,this.varSepartion=e}SetLowBound(e,t){const n=this.Var(t);n.LowBound=Math.max(e,n.LowBound)}Var(e){return this.varList[e]}SetUpperBound(e,t){const n=this.Var(e);n.UpperBound=Math.min(t,n.UpperBound)}Solve(){this.SolveByRegularSolver()}SolveByRegularSolver(){this.CreateVariablesForBounds();for(let e=0;e<this.varList.length;e++){const t=this.varList[e];t.IsFixed?this.solverShell.AddFixedVariable(e,t.Position):(this.solverShell.AddVariableWithIdealPositionNN(e,this.idealPositions.get(e)),t.LowBound!=Number.NEGATIVE_INFINITY&&this.constraints.add(new fn(this.GetBoundId(t.LowBound),e)),t.UpperBound!=Number.POSITIVE_INFINITY&&this.constraints.add(new fn(e,this.GetBoundId(t.UpperBound))))}this.CreateGraphAndRemoveCycles();for(const e of this.graph.edges){let t=0;e.x<this.varList.length&&(t+=this.varList[e.x].Width),e.y<this.varList.length&&(t+=this.varList[e.y].Width),t/=2,this.solverShell.AddLeftRightSeparationConstraintNNN(e.x,e.y,this.varSepartion+t)}this.solverShell.Solve();for(let e=0;e<this.varList.length;e++)this.varList[e].Position=this.solverShell.GetVariableResolvedPosition(e)}GetBoundId(e){return this.boundsToInt.get(e)}CreateVariablesForBounds(){for(const e of this.varList)e.IsFixed||(e.LowBound!=Number.NEGATIVE_INFINITY&&this.RegisterBoundVar(e.LowBound),e.UpperBound!=Number.POSITIVE_INFINITY&&this.RegisterBoundVar(e.UpperBound))}RegisterBoundVar(e){if(!this.boundsToInt.has(e)){const t=this.varList.length+this.boundsToInt.size;this.boundsToInt.set(e,t),this.solverShell.AddFixedVariable(t,e)}}CreateGraphAndRemoveCycles(){this.graph=dc(Array.from(this.constraints),this.varList.length+this.boundsToInt.size);const e=Su.getFeedbackSet(this.graph);if(null!=e)for(const t of e)this.graph.removeEdge(t)}GetVariablePosition(e){return this.varList[e].Position}AddConstraint(e,t){this.constraints.add(new fn(e,t))}AddVariableNNNN(e,t,n,i){this.idealPositions.set(e,n),this.AddVariableNNBN(e,t,!1,i)}AddFixedVariable(e,t){this.AddVariableNNBN(e,t,!0,0)}AddVariableNNBN(e,t,n,i){const s=new p4;s.Position=t,s.IsFixed=n,s.Width=i,this.varList.push(s)}}class y4 extends Xi{constructor(e,t){super(e,t),this.RightNeighbors=new Set,this.setOfLongestSegs=new Set,this.RightBound=Number.POSITIVE_INFINITY,this.LeftBound=Number.NEGATIVE_INFINITY,this.Direction=Je.DirectionFromPointToPoint(e.point,t.point)}AddRightNeighbor(e){this.RightNeighbors.add(e)}get LongestNudgedSegments(){return this.setOfLongestSegs}AddLongestNudgedSegment(e){this.setOfLongestSegs.add(e)}BoundFromRight(e){e=Math.max(e,this.LeftBound),this.RightBound=Math.min(e,this.RightBound)}BoundFromLeft(e){e=Math.min(e,this.RightBound),this.LeftBound=Math.max(e,this.LeftBound)}}class yc{constructor(e){this.Point=e}*GetEnumerator(){let e;for(e=this;null!=e;e=e.Next)yield e.Point}get X(){return this.Point.x}get Y(){return this.Point.y}InsertVerts(e,t,n){for(t--;e<t;t--)this.SetNewNext(n[t])}InsertVertsInReverse(e,t,n){for(e++;e<t;e++)this.SetNewNext(n[e])}SetNewNext(e){const t=new yc(e),n=this.Next;this.Next=t,t.Next=n}}class zS{constructor(e,t){this.IsFixed=!1,this.Reversed=!1,this.index=-1,this.AxisEdge=e,this.Width=t}toString(){return this.Source+" "+this.Target}get LongestNudgedSegment(){return this.longestNudgedSegment}set LongestNudgedSegment(e){this.longestNudgedSegment=e,null!=this.longestNudgedSegment&&(this.longestNudgedSegment.AddEdge(this),this.AxisEdge.AddLongestNudgedSegment(this.longestNudgedSegment))}get Source(){return this.Reversed?this.AxisEdge.TargetPoint:this.AxisEdge.SourcePoint}get Target(){return this.Reversed?this.AxisEdge.SourcePoint:this.AxisEdge.TargetPoint}static VectorsAreParallel(e,t){return an(e.x*t.y-e.y*t.x,0)}static EdgesAreParallel(e,t){return zS.VectorsAreParallel(e.AxisEdge.TargetPoint.sub(e.AxisEdge.SourcePoint),t.AxisEdge.TargetPoint.sub(t.AxisEdge.SourcePoint))}get Direction(){return this.Reversed?Je.OppositeDir(this.AxisEdge.Direction):this.AxisEdge.Direction}get Index(){return this.index}set Index(e){this.index=e}}class Ni{constructor(e){this.pathVisibilityGraph=new Or,this.axisEdgesToPathOrders=new Map,this.OriginalPaths=e}get PathVisibilityGraph(){return this.pathVisibilityGraph}GetOrder(){return this.FillTheVisibilityGraphByWalkingThePaths(),this.InitPathOrder(),this.OrderPaths(),this.axisEdgesToPathOrders}FillTheVisibilityGraphByWalkingThePaths(){for(const e of this.OriginalPaths)this.FillTheVisibilityGraphByWalkingPath(e)}FillTheVisibilityGraphByWalkingPath(e){const t=this.CreatePathEdgesFromPoints(function*i(){if(e.PathPoints instanceof yc)for(let s=e.PathPoints;null!=s;s=s.Next)yield s.Point;else for(const s of e.PathPoints)yield s}(),e.Width);let n=t.next();for(n.done||e.SetFirstEdge(n.value);0==(n=t.next()).done;)e.AddEdge(n.value)}*CreatePathEdgesFromPoints(e,t){let n=e.next(),i=n.value;for(;!(n=e.next()).done;)yield this.CreatePathEdge(i,n.value,t),i=n.value}CreatePathEdge(e,t,n){switch(Je.DirectionFromPointToPoint(e,t)){case ve.East:case ve.North:return new zS(this.GetAxisEdge(e,t),n);case ve.South:case ve.West:{const s=new zS(this.GetAxisEdge(t,e),n);return s.Reversed=!0,s}default:throw new Error("Not a rectilinear path")}}GetAxisEdge(e,t){return this.PathVisibilityGraph.AddEdgeF(e,t,(n,i)=>new y4(n,i))}InitPathOrder(){for(const e of this.PathVisibilityGraph.Edges)this.axisEdgesToPathOrders.set(e,new Array);for(const e of this.OriginalPaths)for(const t of e.PathEdges())this.axisEdgesToPathOrders.get(t.AxisEdge).push(t)}OrderPaths(){for(const e of Ni.WalkGraphEdgesInTopologicalOrderIfPossible(this.PathVisibilityGraph))this.OrderPathEdgesSharingEdge(e)}OrderPathEdgesSharingEdge(e){const t=this.PathOrderOfVisEdge(e);t.sort(Ni.CompareTwoPathEdges);let n=0;for(const i of t)i.Index=n++}static CompareTwoPathEdges(e,t){if(e==t)return 0;const n=Ni.CompareInDirectionStartingFromAxisEdge(e,t,e.AxisEdge,e.AxisEdge.Direction);return 0!=n?n:-Ni.CompareInDirectionStartingFromAxisEdge(e,t,e.AxisEdge,Je.OppositeDir(e.AxisEdge.Direction))}static CompareInDirectionStartingFromAxisEdge(e,t,n,i){for(;;){if(null==(e=Ni.GetNextPathEdgeInDirection(e,n,i))||null==(t=Ni.GetNextPathEdgeInDirection(t,n,i)))return 0;if(e.AxisEdge==t.AxisEdge){i=Ni.FindContinuedDirection(n,i,e.AxisEdge),n=e.AxisEdge;const c=Ni.GetExistingOrder(e,t);if(c==Ni.NotOrdered)continue;return i==n.Direction?c:-c}const s=i==n.Direction?n.Target:n.Source,o=Ni.OtherVertex(e.AxisEdge,s),a=Ni.OtherVertex(t.AxisEdge,s),l=Ni.ProjectionForCompare(n,i!=n.Direction);return $n(l(o.point),l(a.point))}}static FindContinuedDirection(e,t,n){return e.Direction==t?n.Source==e.Target?n.Direction:Je.OppositeDir(n.Direction):n.Source==e.Source?n.Direction:Je.OppositeDir(n.Direction)}static OtherVertex(e,t){return e.Source==t?e.Target:e.Source}static ProjectionForCompare(e,t){return e.Direction==ve.North?t?n=>-n.x:n=>n.x:t?n=>n.y:n=>-n.y}static GetNextPathEdgeInDirection(e,t,n){return t.Direction==n?e.Reversed?e.Prev:e.Next:e.Reversed?e.Next:e.Prev}static GetExistingOrder(e,t){const n=e.Index;return-1==n?Ni.NotOrdered:$n(n,t.Index)}PathOrderOfVisEdge(e){return this.axisEdgesToPathOrders.get(e)}static InitQueueOfSources(e,t,n){for(const i of n.Vertices()){const s=i.InEdgesLength();t.set(i,s),0==s&&e.enqueue(i)}}static*WalkGraphEdgesInTopologicalOrderIfPossible(e){const t=new mu.c,n=new Map;for(Ni.InitQueueOfSources(t,n,e);t.length>0;){const i=t.dequeue();for(const s of i.OutEdges){const o=n.get(s.Target);n.set(s.Target,o-1),1==o&&t.enqueue(s.Target),yield s}}}}Ni.NotOrdered=Number.MAX_VALUE;class E4 extends pc{constructor(e,t){super(),this.site=t,this.AxisEdge=e}get Site(){return this.site}}class dL extends pc{constructor(e,t){super(),this.site=t,this.AxisEdge=e}get Site(){return this.site}}class w4{constructor(e){this.edges=new Set,this.Source=e}get Edges(){return this.edges}AddEdge(e){this.UpPoint=e.TargetPoint,this.edges.add(e)}RemoveAxis(e){this.edges.delete(e)}IsEmpty(){return 0==this.edges.size}}class Ec extends nL{constructor(e,t,n,i,s){super(t,new Je(e).ToPoint()),this.DirectionPerp=new Je(e).Right.ToPoint(),this.PathOrders=i,this.xProjection=e==ve.North?o=>o.x:o=>-o.y,this.edgeContainersTree=new uo((o,a)=>this.CompareAA(o,a)),this.SweepPole=Je.VectorDirection(this.SweepDirection),this.AxisEdges=s,this.AxisEdgesToObstaclesTheyOriginatedFrom=n}FindFreeSpace(){this.InitTheQueueOfEvents(),this.ProcessEvents()}ProcessEvents(){for(;this.EventQueue.Count>0;)this.ProcessEvent(this.EventQueue.Dequeue())}ProcessEvent(e){e instanceof sg?this.ProcessVertexEvent(e):(this.Z=this.GetZP(e.Site),e instanceof dL?this.ProcessLowEdgeEvent(e):this.ProcessHighEdgeEvent(e))}ProcessHighEdgeEvent(e){const t=e.AxisEdge;this.RemoveEdge(t),this.ConstraintEdgeWithObstaclesAtZ(t,t.Target.point)}ProcessLowEdgeEvent(e){const t=e.AxisEdge,n=this.GetOrCreateAxisEdgesContainer(t);n.item.AddEdge(t);const i=this.edgeContainersTree.previous(n);if(null!=i)for(const o of i.item.edges)for(const a of n.item.edges)this.TryToAddRightNeighbor(o,a);const s=this.edgeContainersTree.next(n);if(null!=s)for(const o of n.item.Edges)for(const a of s.item.edges)this.TryToAddRightNeighbor(o,a);this.ConstraintEdgeWithObstaclesAtZ(t,t.Source.point)}TryToAddRightNeighbor(e,t){this.ProjectionsOfEdgesOverlap(e,t)&&e.AddRightNeighbor(t)}ProjectionsOfEdgesOverlap(e,t){return this.SweepPole==ve.North?!(e.TargetPoint.y<t.SourcePoint.y-le.distanceEpsilon||t.TargetPoint.y<e.SourcePoint.y-le.distanceEpsilon):!(e.TargetPoint.x<t.SourcePoint.x-le.distanceEpsilon||t.TargetPoint.x<e.SourcePoint.x-le.distanceEpsilon)}GetObstacleBoundaries(e){return this.Obstacles.map(t=>qt.mkDebugCurveWCI(1,e,t))}ConstraintEdgeWithObstaclesAtZ(e,t){this.ConstraintEdgeWithObstaclesAtZFromLeft(e,t),this.ConstraintEdgeWithObstaclesAtZFromRight(e,t)}ConstraintEdgeWithObstaclesAtZFromRight(e,t){const n=this.GetActiveSideFromRight(t);if(null==n||this.NotRestricting(e,n.item.Polyline))return;const i=this.ObstacleSideComparer.IntersectionOfSideAndSweepLine(n.item);e.BoundFromRight(i.dot(this.DirectionPerp))}GetActiveSideFromRight(e){return this.LeftObstacleSideTree.findFirst(t=>Ec.PointToTheLeftOfLineOrOnLineLocal(e,t.Start,t.End))}ConstraintEdgeWithObstaclesAtZFromLeft(e,t){const n=this.GetActiveSideFromLeft(t);if(null==n||this.NotRestricting(e,n.item.Polyline))return;const i=this.ObstacleSideComparer.IntersectionOfSideAndSweepLine(n.item);e.BoundFromLeft(i.dot(this.DirectionPerp))}static PointToTheLeftOfLineOrOnLineLocal(e,t,n){return k.signedDoubledTriangleArea(e,t,n)>-Ec.AreaComparisonEpsilon}static PointToTheRightOfLineOrOnLineLocal(e,t,n){return k.signedDoubledTriangleArea(t,n,e)<Ec.AreaComparisonEpsilon}GetActiveSideFromLeft(e){return this.RightObstacleSideTree.findLast(t=>Ec.PointToTheRightOfLineOrOnLineLocal(e,t.Start,t.End))}static EdgeMidPoint(e){return k.middle(e.SourcePoint,e.TargetPoint)}GetOrCreateAxisEdgesContainer(e){const t=e.Source.point,n=this.GetAxisEdgesContainerNode(t);return null!=n?n:this.edgeContainersTree.insert(new w4(t))}GetAxisEdgesContainerNode(e){const t=this.xProjection(e),n=this.edgeContainersTree.findFirst(i=>this.xProjection(i.Source)>=t-le.distanceEpsilon/2);return null!=n&&this.xProjection(n.item.Source)<=t+le.distanceEpsilon/2?n:null}ProcessVertexEvent(e){this.Z=this.GetZS(e),e instanceof ed?this.ProcessLeftVertex(e,e.Vertex.nextOnPolyline):(e instanceof td||this.ProcessLeftVertex(e,e.Vertex.nextOnPolyline),this.ProcessRightVertex(e,e.Vertex.prevOnPolyline))}ProcessRightVertex(e,t){this.ProcessPrevSegmentForRightVertex(e,e.Site);const i=t.point.sub(e.Site),s=i.dot(this.DirectionPerp),o=i.dot(this.SweepDirection);o<=le.distanceEpsilon?s>0&&o>=0?this.EnqueueEvent(new td(t)):this.RestrictEdgeContainerToTheRightOfEvent(e.Vertex):(this.InsertRightSide(new lg(e.Vertex)),this.EnqueueEvent(new td(t)),this.RestrictEdgeContainerToTheRightOfEvent(e.Vertex))}RestrictEdgeContainerToTheRightOfEvent(e){const t=e.point,n=this.xProjection(t),i=this.edgeContainersTree.findFirst(s=>n<=this.xProjection(s.Source));if(null!=i)for(const s of i.item.Edges)this.NotRestricting(s,e.polyline)||s.BoundFromLeft(this.DirectionPerp.dot(t))}NotRestricting(e,t){return this.AxisEdgesToObstaclesTheyOriginatedFrom.get(e)==t}ProcessPrevSegmentForRightVertex(e,t){t.sub(e.Vertex.nextOnPolyline.point).dot(this.SweepDirection)>le.distanceEpsilon&&this.RemoveRightSide(new lg(e.Vertex.nextOnPolyline))}RemoveEdge(e){const t=this.GetAxisEdgesContainerNode(e.Source.point);t.item.RemoveAxis(e),t.item.IsEmpty()&&this.edgeContainersTree.deleteNodeInternal(t)}ProcessLeftVertex(e,t){this.ProcessPrevSegmentForLeftVertex(e,e.Site);const i=t.point.sub(e.Site),s=i.dot(this.DirectionPerp),o=i.dot(this.SweepDirection);o<=le.distanceEpsilon?s<0&&o>=0&&this.EnqueueEvent(new ed(t)):(this.InsertLeftSide(new ag(e.Vertex)),this.EnqueueEvent(new ed(t))),this.RestrictEdgeFromTheLeftOfEvent(e.Vertex)}RestrictEdgeFromTheLeftOfEvent(e){const t=e.point,n=this.GetContainerNodeToTheLeftOfEvent(t);if(null!=n)for(const i of n.item.Edges)this.NotRestricting(i,e.polyline)||i.BoundFromRight(t.dot(this.DirectionPerp))}GetContainerNodeToTheLeftOfEvent(e){const t=this.xProjection(e);return this.edgeContainersTree.findLast(n=>this.xProjection(n.Source)<=t)}ProcessPrevSegmentForLeftVertex(e,t){t.sub(e.Vertex.prevOnPolyline.point).dot(this.SweepDirection)>le.distanceEpsilon&&this.RemoveLeftSide(new ag(e.Vertex.prevOnPolyline))}InitTheQueueOfEvents(){this.InitQueueOfEvents();for(const e of this.AxisEdges)this.EnqueueEventsForEdge(e)}EnqueueEventsForEdge(e){this.EdgeIsParallelToSweepDir(e)&&(this.EnqueueEvent(Ec.EdgeLowPointEvent(e,e.Source.point)),this.EnqueueEvent(Ec.EdgeHighPointEvent(e,e.Target.point)))}EdgeIsParallelToSweepDir(e){return e.Direction==this.SweepPole||e.Direction==Je.OppositeDir(this.SweepPole)}static EdgeHighPointEvent(e,t){return new E4(e,t)}static EdgeLowPointEvent(e,t){return new dL(e,t)}CompareAA(e,t){return $n(e.Source.dot(this.DirectionPerp),t.Source.dot(this.DirectionPerp))}}Ec.AreaComparisonEpsilon=le.intersectionEpsilon;class v4 extends wT{constructor(e){super(),this.CompassDirection=ve.None,this.edges=new Array,this._isFixed=!1,this.Id=-1,this.IdealPosition=0,this.Id=e}get Start(){return this.start}get End(){return this.end}get Edges(){return this.edges}AddEdge(e){if(0==this.Edges.length){let t=Je.VectorDirectionPP(e.Source,e.Target);switch(t){case ve.South:t=ve.North;break;case ve.West:t=ve.East}this.CompassDirection=t,this.start=e.Source,this.end=e.Source}switch(this.CompassDirection){case ve.North:this.TryPointForStartAndEndNorth(e.Source),this.TryPointForStartAndEndNorth(e.Target);break;case ve.East:this.TryPointForStartAndEndEast(e.Source),this.TryPointForStartAndEndEast(e.Target)}this.Edges.push(e)}TryPointForStartAndEndNorth(e){e.y<this.start.y?this.start=e:e.y>this.end.y&&(this.end=e)}TryPointForStartAndEndEast(e){e.x<this.start.x?this.start=e:e.x>this.end.x&&(this.end=e)}get IsFixed(){return this._isFixed}set IsFixed(e){this._isFixed=e}get Width(){let e=0;for(const t of this.edges)e=Math.max(e,t.Width);return e}GetLeftBound(){if(!this.IsFixed){let e=Number.NEGATIVE_INFINITY;for(const t of this.edges)e=Math.max(e,t.AxisEdge.LeftBound);return e}return this.CompassDirection==ve.North?this.Edges[0].Source.x:-this.Edges[0].Source.y}GetRightBound(){if(!this.IsFixed){let e=Number.POSITIVE_INFINITY;for(const t of this.edges)e=Math.min(e,t.AxisEdge.RightBound);return e}return this.Position()}Position(){return this.CompassDirection==ve.North?this.Edges[0].Source.x:-this.Edges[0].Source.y}}class wl{constructor(e,t){this.tree=new uo((n,i)=>$n(n.Point.x,i.Point.x)),this.VerticalPoints=t,this.HorizontalPoints=e}SplitPoints(){0==this.VerticalPoints.length||0==this.HorizontalPoints.length||(this.InitEventQueue(),this.ProcessEvents())}ProcessEvents(){for(;!this.Queue.IsEmpty();){const e={priority:0},t=this.Queue.DequeueAndGetPriority(e);this.ProcessEvent(t,e.priority)}}ProcessEvent(e,t){an(e.Next.Point.x,e.Point.x)?t==wl.Low(e)?this.ProcessLowLinkedPointEvent(e):this.ProcessHighLinkedPointEvent(e):this.IntersectWithTree(e)}IntersectWithTree(e){let t,n,i;const s=e.Y;if(e.Point.x<e.Next.Point.x?(n=e.Point.x,t=e.Next.Point.x,i=!0):(t=e.Point.x,n=e.Next.Point.x,i=!1),i)for(let o=this.tree.findFirst(a=>n<=a.Point.x);null!=o&&o.item.Point.x<=t;o=this.tree.next(o)){const a=new k(o.item.Point.x,s);e=wl.TrySplitHorizontalPoint(e,a,!0),wl.TrySplitVerticalPoint(o.item,a)}else for(let o=this.tree.findLast(a=>a.Point.x<=t);null!=o&&o.item.Point.x>=n;o=this.tree.previous(o)){const a=new k(o.item.Point.x,s);e=wl.TrySplitHorizontalPoint(e,a,!1),wl.TrySplitVerticalPoint(o.item,a)}}static TrySplitVerticalPoint(e,t){wl.Low(e)+le.distanceEpsilon<t.y&&t.y+le.distanceEpsilon<wl.High(e)&&e.SetNewNext(t)}static TrySplitHorizontalPoint(e,t,n){return n&&e.X+le.distanceEpsilon<t.x&&t.x+le.distanceEpsilon<e.Next.X||!n&&e.Next.X+le.distanceEpsilon<t.x&&t.x+le.distanceEpsilon<e.X?(e.SetNewNext(t),e.Next):e}ProcessHighLinkedPointEvent(e){this.tree.remove(e)}ProcessLowLinkedPointEvent(e){this.tree.insert(e)}InitEventQueue(){this.Queue=new Iu($n);for(const e of this.VerticalPoints)this.Queue.Enqueue(e,wl.Low(e));for(const e of this.HorizontalPoints)this.Queue.Enqueue(e,e.Point.y)}static Low(e){return Math.min(e.Point.y,e.Next.Point.y)}static High(e){return Math.max(e.Point.y,e.Next.Point.y)}}class ug{constructor(e){this.verticesToPathOffsets=new Vs,this.Paths=e}MergePaths(){this.InitVerticesToPathOffsetsAndRemoveSelfCycles();for(const e of this.Paths)this.ProcessPath(e)}ProcessPath(e){const t=new Map;let n=null;for(let i=e.PathPoints;null!=i;i=i.Next){const s=this.verticesToPathOffsets.get(i.Point);if(null!=n){if(t.size>0)for(const[o,a]of s){const l=t.get(o);l&&(this.CollapseLoopingPath(o,l,a,e,i),t.delete(o))}for(const[o,a]of n)s.has(o)||t.set(o,a)}n=s}}CollapseLoopingPath(e,t,n,i,s){const o=ug.FindLinkedPointInPath(i,t.Point),a=Array.from(ug.GetPointsInBetween(o,s));ug.Before(t,n)?(this.CleanDisappearedPiece(t,n,e),this.ReplacePiece(t,n,a,e)):(this.CleanDisappearedPiece(n,t,e),this.ReplacePiece(n,t,a.reverse(),e))}static*GetPointsInBetween(e,t){for(let n=e.Next;n!=t;n=n.Next)yield n.Point}ReplacePiece(e,t,n,i){let s=e;for(const o of n){const a=new yc(o);s.Next=a,s=a,this.verticesToPathOffsets.get(o).set(i,s)}s.Next=t}CleanDisappearedPiece(e,t,n){for(const i of ug.GetPointsInBetween(e,t))this.verticesToPathOffsets.get(i).delete(n)}static Before(e,t){for(e=e.Next;null!=e;e=e.Next)if(e==t)return!0;return!1}static FindLinkedPointInPath(e,t){for(let n=e.PathPoints;;n=n.Next)if(n.Point.equal(t))return n}InitVerticesToPathOffsetsAndRemoveSelfCycles(){for(const e of this.Paths)for(let t=e.PathPoints;null!=t;t=t.Next){let n=this.verticesToPathOffsets.get(t.Point);n||this.verticesToPathOffsets.set(t.Point,n=new Map);const i=n.get(e);i?(this.CleanDisappearedPiece(i,t,e),i.Next=t.Next):n.set(e,t)}}}class S4{constructor(e){this.projection=e}compare(e,t){return $n(this.projection(e),this.projection(t))}}class ts{static RefinePaths(e,t){ts.AdjustPaths(e);const n=ts.CreatePathsToFirstLinkedVerticesMap(e);ts.Refine(Array.from(n.values())),ts.CrossVerticalAndHorizontalSegs(n.values()),ts.ReconstructPathsFromLinkedVertices(n),t&&new ug(e).MergePaths()}static AdjustPaths(e){for(const t of e)t.PathPoints=ts.AdjustPathPoints(t.PathPoints)}static AdjustPathPoints(e){if(!e||0==e.length)return;const t=[];let n=le.RoundPoint(e[0]);t.push(n);for(let i=1;i<e.length;i++){const s=le.RoundPoint(e[i]);n.equal(s)||(n=s,t.push(n))}return t}static CrossVerticalAndHorizontalSegs(e){const t=new Array,n=new Array;for(const i of e)for(let s=i;null!=s.Next;s=s.Next)an(s.Point.x,s.Next.Point.x)?n.push(s):t.push(s);new wl(t,n).SplitPoints()}static ReconstructPathsFromLinkedVertices(e){for(const[t,n]of e)t.PathPoints=n}static Refine(e){ts.RefineInDirection(ve.North,e),ts.RefineInDirection(ve.East,e)}static*groupByProj(e,t){const n=new Map;for(const i of t){const s=e(i.Point);let o=n.get(s);o||(o=new Array,n.set(s,o)),o.push(i)}for(const i of n.values())yield i}static RefineInDirection(e,t){const n={projectionToPerp:void 0,projectionToDirection:void 0};ts.GetProjectionsDelegates(e,n);const i=Array.from(ts.GetAllLinkedVertsInDirection(n.projectionToPerp,t)),s=ts.groupByProj(n.projectionToPerp,i);for(const o of s)ts.RefineCollinearBucket(o,n.projectionToDirection)}static GetProjectionsDelegates(e,t){e==ve.East?(t.projectionToDirection=n=>n.x,t.projectionToPerp=n=>n.y):(t.projectionToPerp=n=>n.x,t.projectionToDirection=n=>n.y)}static*GetAllLinkedVertsInDirection(e,t){for(const n of t)for(let i=n;null!=i.Next;i=i.Next)an(e(i.Point),e(i.Next.Point))&&(yield i)}static RefineCollinearBucket(e,t){const n=new cT.SortedMap(new S4(t));for(const o of e)n.has(o.Point)||n.set(o.Point,0),n.has(o.Next.Point)||n.set(o.Next.Point,0);const i=new Array(n.size);let s=0;for(const o of n.keys())i[s++]=o;for(s=0;s<i.length;s++)n.set(i[s],s);for(const o of e){s=n.get(o.Point);const a=n.get(o.Next.Point);Math.abs(a-s)>1&&ts.InsertPoints(o,i,s,a)}}static InsertPoints(e,t,n,i){n<i?e.InsertVerts(n,i,t):e.InsertVertsInReverse(i,n,t)}static CreatePathsToFirstLinkedVerticesMap(e){const t=new Map;for(const n of e)t.set(n,ts.CreateLinkedVertexOfEdgePath(n));return t}static CreateLinkedVertexOfEdgePath(e){const t=e.PathPoints;let n=new yc(t[0]);const i=n;for(let s=1;s<t.length;s++)n.Next=new yc(t[s]),n=n.Next;return i}}class nd{constructor(e,t){this.Points=e,this.I=t}static equal(e,t){return e.I==t.I&&e.Points==t.Points}get Start(){return this.Points[this.I]}get End(){return this.Points[this.I+1]}}class rd{constructor(e,t){this.segTree=new _S(null),this.crossedOutPaths=new Set,this.HierarchyOfObstacles=new _S(t),this.Paths=e}static RemoveStaircases(e,t){new rd(e,t).Calculate()}Calculate(){let e;this.InitHierarchies();do{e=!1;for(const t of this.Paths.filter(n=>!this.crossedOutPaths.has(n)))this.ProcessPath(t)&&(e=!0)}while(e)}ProcessPath(e){const t={pts:e.PathPoints,canHaveStaircase:!1};return this.ProcessPoints(t)?(e.PathPoints=t.pts,!0):(t.canHaveStaircase||this.crossedOutPaths.add(e),!1)}ProcessPoints(e){const t=this.FindStaircaseStart(e);return!(t<0||(e.pts=this.RemoveStaircasePN(e.pts,t),0))}FindStaircaseStart(e){if(e.canHaveStaircase=!1,e.pts.length<5)return-1;const t=[new nd(e.pts,0),new nd(e.pts,1),new nd(e.pts,2),new nd(e.pts,3)];let n=0;for(let i=0;;){const s={canHaveStaircaseAtI:!1};if(this.IsStaircase(e.pts,i,t,s))return e.canHaveStaircase=!0,i;if(e.canHaveStaircase=e.canHaveStaircase||s.canHaveStaircaseAtI,i++,e.pts.length<i+5)return-1;t[n]=new nd(e.pts,i+3),n++,n%=4}}static GetFlippedPoint(e,t){return an(e[t].y,e[t+1].y)?new k(e[t+4].x,e[t].y):new k(e[t].x,e[t+4].y)}Crossing(e,t,n){return rd.IsCrossing(Me.mkPP(e,t),this.segTree,n)}static IsCrossing(e,t,n){for(const i of t.GetAllIntersecting(e.boundingBox))if(-1==n.findIndex(s=>s==i))return!0;return!1}IntersectObstacleHierarchyPPP(e,t,n){return this.IntersectObstacleHierarchyL(Me.mkPP(e,t))||this.IntersectObstacleHierarchyL(Me.mkPP(t,n))}IntersectObstacleHierarchyL(e){return this.HierarchyOfObstacles.GetAllIntersecting(e.boundingBox).some(t=>null!=fe.intersectionOne(e,t,!1))}IsStaircase(e,t,n,i){const s=e[t],o=e[t+1];let a=e[t+2];const l=e[t+3],c=e[t+4];return i.canHaveStaircaseAtI=!1,Je.DirectionFromPointToPoint(s,o)==Je.DirectionFromPointToPoint(a,l)&&Je.DirectionFromPointToPoint(o,a)==Je.DirectionFromPointToPoint(l,c)&&(a=rd.GetFlippedPoint(e,t),!this.IntersectObstacleHierarchyPPP(o,a,l))&&(i.canHaveStaircaseAtI=!0,!this.Crossing(o,a,n))}RemoveStaircasePN(e,t){const s=Math.abs(e[t].y-e[t+1].y)<le.distanceEpsilon/2;return this.RemoveStaircasePNB(e,t,s)}RemoveStaircasePNB(e,t,n){this.RemoveSegs(e);const i=new Array(e.length-2);!function b4(r,e,t){let n=0;for(;t-- >0;)e[n++]=r[n++]}(e,i,t+1);const s=e[t+1],o=e[t+3];return i[t+1]=n?new k(o.x,s.y):new k(s.x,o.y),function A4(r,e,t,n,i){for(;i-- >0;)t[n++]=r[e++]}(e,t+4,i,t+2,i.length-t-2),this.InsertNewSegs(i,t),i}RemoveSegs(e){for(let t=0;t<e.length-1;t++)this.RemoveSeg(new nd(e,t))}RemoveSeg(e){this.segTree.Remove(rd.Rect(e),e)}InsertNewSegs(e,t){this.InsSeg(e,t),this.InsSeg(e,t+1)}InitHierarchies(){for(const e of this.Paths)this.InsertPathSegs(e)}InsertPathSegs(e){this.InsertSegs(e.PathPoints)}InsertSegs(e){for(let t=0;t<e.length-1;t++)this.InsSeg(e,t)}InsSeg(e,t){const n=new nd(e,t);this.segTree.Add(rd.Rect(n),n)}static Rect(e){return lt.mkPP(e.Start,e.End)}}class Jn{constructor(e,t,n,i){this.AncestorsSets=i,this.HierarchyOfGroups=Tr(Array.from(i.keys()).filter(s=>s.IsGroup).map(s=>gi(s,s.BoundingBox))),this.Obstacles=n,this.EdgeSeparation=2*t,this.Paths=e,this.HierarchyOfObstacles=Tr(n.map(s=>gi(s,s.boundingBox))),this.MapPathsToTheirObstacles()}get HasGroups(){return null!=this.HierarchyOfGroups&&this.HierarchyOfGroups.Count>0}MapPathsToTheirObstacles(){this.PathToObstacles=new Map;for(const e of this.Paths)this.MapPathToItsObstacles(e)}MapPathToItsObstacles(e){if(!e.PathPoints||0==e.PathPoints.length)return;const t=e.PathPoints,n=this.HierarchyOfObstacles.FirstHitNodeWithPredicate(t[0],Jn.ObstacleTest),i=this.HierarchyOfObstacles.FirstHitNodeWithPredicate(t[t.length-1],Jn.ObstacleTest);null!=n&&null!=i&&this.PathToObstacles.set(e,[n.UserData,i.UserData])}static ObstacleTest(e,t){return fe.PointRelativeToCurveLocation(e,t)!=Ot.Outside?Kn.Stop:Kn.Continue}Calculate(e,t){this.NudgingDirection=e,ts.RefinePaths(this.Paths,t),this.GetPathOrdersAndPathGraph(),this.MapAxisEdgesToTheirObstacles(),this.DrawPaths()}MapAxisEdgesToTheirObstacles(){this.axisEdgesToObstaclesTheyOriginatedFrom=new Map;for(const e of this.Paths)this.MapPathEndAxisEdgesToTheirObstacles(e);for(const e of this.Paths)this.UmmapPathInteriourFromStrangerObstacles(e)}UmmapPathInteriourFromStrangerObstacles(e){const t=this.FindFirstUnmappedEdge(e);if(null==t)return;const n=this.FindLastUnmappedEdge(e);for(let i=t;null!=i&&i!=n;i=i.Next)this.axisEdgesToObstaclesTheyOriginatedFrom.delete(i.AxisEdge)}FindLastUnmappedEdge(e){for(let t=e.LastEdge;null!=t;t=t.Prev)if(t.AxisEdge.Direction!=this.NudgingDirection)return t;return null}FindFirstUnmappedEdge(e){for(let t=e.FirstEdge;null!=t;t=t.Next)if(t.AxisEdge.Direction!=this.NudgingDirection)return t;return null}MapPathEndAxisEdgesToTheirObstacles(e){const t=this.PathToObstacles.get(e);t&&(this.ProcessThePathStartToMapAxisEdgesToTheirObstacles(e,t[0]),this.ProcessThePathEndToMapAxisEdgesToTheirObstacles(e,t[1]))}ProcessThePathEndToMapAxisEdgesToTheirObstacles(e,t){for(let n=e.LastEdge;null!=n&&Je.DirectionsAreParallel(n.Direction,this.NudgingDirection);n=n.Prev)this.axisEdgesToObstaclesTheyOriginatedFrom.set(n.AxisEdge,t)}ProcessThePathStartToMapAxisEdgesToTheirObstacles(e,t){for(let n=e.FirstEdge;null!=n&&Je.DirectionsAreParallel(n.Direction,this.NudgingDirection);n=n.Next)this.axisEdgesToObstaclesTheyOriginatedFrom.set(n.AxisEdge,t)}GetPathOrdersAndPathGraph(){const e=new Ni(this.Paths);this.PathOrders=e.GetOrder(),this.PathVisibilityGraph=e.PathVisibilityGraph}static GetCurvesForShow(e,t){const n=new Array;for(const i of e){const s=new At;for(const o of i.PathPoints)s.addPoint(o);n.push(s)}return n.concat(Array.from(t))}DrawPaths(){this.SetWidthsOfArrowheads(),this.CreateLongestNudgedSegments(),this.FindFreeSpaceInDirection(Array.from(this.PathVisibilityGraph.Edges)),this.MoveLongestSegsIdealPositionsInsideFeasibleIntervals(),this.PositionShiftedEdges()}SetWidthsOfArrowheads(){for(const e of this.Paths)Jn.SetWidthsOfArrowheadsForEdge(e)}static SetWidthsOfArrowheadsForEdge(e){const t=e.GeomEdge;if(null!=t.targetArrowhead){const n=e.LastEdge;n.Width=Math.max(t.targetArrowhead.width,n.Width)}if(null!=t.sourceArrowhead){const n=e.FirstEdge;n.Width=Math.max(t.sourceArrowhead.width,n.Width)}}PositionShiftedEdges(){this.Solver=new m4(this.EdgeSeparation);for(let e=0;e<this.LongestNudgedSegs.length;e++)this.CreateVariablesOfLongestSegment(this.LongestNudgedSegs[e]);this.CreateConstraintsOfTheOrder(),this.CreateConstraintsBetweenLongestSegments(),this.Solver.SolveByRegularSolver(),this.ShiftPathEdges()}MoveLongestSegsIdealPositionsInsideFeasibleIntervals(){for(let e=0;e<this.LongestNudgedSegs.length;e++)Jn.MoveLongestSegIdealPositionsInsideFeasibleInterval(this.LongestNudgedSegs[e])}static MoveLongestSegIdealPositionsInsideFeasibleInterval(e){if(e.IsFixed)return;const t=e.GetLeftBound(),n=e.GetRightBound();e.IdealPosition<t?e.IdealPosition=t:e.IdealPosition>n&&(e.IdealPosition=n)}ShiftPathEdges(){for(const e of this.Paths)e.PathPoints=this.GetShiftedPoints(e)}GetShiftedPoints(e){return Jn.RemoveSwitchbacksAndMiddlePoints(this.GetShiftedPointsSimple(e))}static Rectilinearise(e,t){return e.x==t.x||e.y==t.y?t:Math.abs(e.x-t.x)<Math.abs(e.y-t.y)?new k(e.x,t.y):new k(t.x,e.y)}GetShiftedPointsSimple(e){const t=[],n=e.FirstEdge;t.push(this.ShiftedPoint(n.Source,n.LongestNudgedSegment));for(const i of e.PathEdges())t.push(this.ShiftedEdgePositionOfTarget(i));return t}ShiftedEdgePositionOfTarget(e){return null!=e.LongestNudgedSegment||null==e.Next?this.ShiftedPoint(e.Target,e.LongestNudgedSegment):this.ShiftedPoint(e.Next.Source,e.Next.LongestNudgedSegment)}ShiftedPoint(e,t){if(null==t)return e;const n=this.Solver.GetVariablePosition(t.Id);return this.NudgingDirection==ve.North?new k(n,e.y):new k(e.x,-n)}static LineSegOfLongestSeg(e,t){const n=t==ve.East?s=>s.x:s=>s.y,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const s of e.Edges)Jn.UpdateMinMaxWithPoint(i,n,s.Source),Jn.UpdateMinMaxWithPoint(i,n,s.Target);return t==ve.East?new Me(i.min,-e.IdealPosition,i.max,-e.IdealPosition):new Me(e.IdealPosition,i.min,e.IdealPosition,i.max)}static UpdateMinMaxWithPoint(e,t,n){const i=t(n);e.min>i&&(e.min=i),e.max<i&&(e.max=i)}CreateConstraintsBetweenLongestSegments(){for(const e of this.LongestNudgedSegs)this.CreateConstraintsBetweenLongestSegmentsForSegment(e)}CreateConstraintsBetweenLongestSegmentsForSegment(e){const t=new Set;for(const n of e.Edges){const i=n.AxisEdge;if(null!=i)for(const s of i.RightNeighbors)for(const o of s.LongestNudgedSegments)t.add(o)}for(const n of t)this.ConstraintTwoLongestSegs(e,n)}CreateConstraintsOfTheOrder(){for(const e of this.PathOrders)Jn.ParallelToDirection(e[0],this.NudgingDirection)&&this.CreateConstraintsOfThePathOrder(e[1])}static ParallelToDirection(e,t){switch(t){case ve.North:case ve.South:return an(e.SourcePoint.x,e.TargetPoint.x);default:return an(e.SourcePoint.y,e.TargetPoint.y)}}CreateConstraintsOfThePathOrder(e){let t=null;for(const n of e.filter(i=>null!=i.LongestNudgedSegment))null!=t&&this.ConstraintTwoLongestSegs(t.LongestNudgedSegment,n.LongestNudgedSegment),t=n}ConstraintTwoLongestSegs(e,t){(!e.IsFixed||!t.IsFixed)&&this.Solver.AddConstraint(e.Id,t.Id)}CreateVariablesOfLongestSegment(e){if(e.IsFixed)this.Solver.AddFixedVariable(e.Id,Jn.SegmentPosition(e,this.NudgingDirection));else{const t=e.GetLeftBound(),n=e.GetRightBound();t>=n?(this.Solver.AddFixedVariable(e.Id,Jn.SegmentPosition(e,this.NudgingDirection)),e.IsFixed=!0):(this.Solver.AddVariableNNNN(e.Id,Jn.SegmentPosition(e,this.NudgingDirection),e.IdealPosition,e.Width),t!=Number.NEGATIVE_INFINITY&&this.Solver.SetLowBound(t,e.Id),n!=Number.POSITIVE_INFINITY&&this.Solver.SetUpperBound(e.Id,n))}}static SegmentPosition(e,t){return t==ve.North?e.Start.x:-e.Start.y}FindFreeSpaceInDirection(e){this.BoundAxisEdgesByRectsKnownInAdvance(),new Ec(this.NudgingDirection,this.Obstacles,this.axisEdgesToObstaclesTheyOriginatedFrom,this.PathOrders,e).FindFreeSpace()}BoundAxisEdgesByRectsKnownInAdvance(){for(const e of this.Paths)this.HasGroups&&this.BoundPathByMinCommonAncestors(e),this.BoundAxisEdgesAdjacentToSourceAndTargetOnEdge(e)}BoundPathByMinCommonAncestors(e){for(const t of this.GetMinCommonAncestors(e.GeomEdge)){const n=t.BoundingBox;for(const i of e.PathEdges()){const s=i.AxisEdge;s.Direction==this.NudgingDirection&&this.BoundAxisEdgeByRect(n,s)}}}GetMinCommonAncestors(e){null==this.PortToShapes&&(this.PortToShapes=Jn.MapPortsToShapes(this.AncestorsSets.keys()));const t=function C4(r,e){const t=new Set;if(r.size<e.size)for(const n of r)e.has(n)&&t.add(n);else for(const n of e)r.has(n)&&t.add(n);return t}(this.AncestorsForPort(e.sourcePort),this.AncestorsForPort(e.targetPort));return Array.from(t).filter(n=>!n.Children.some(i=>t.has(i)))}AncestorsForPort(e){const t=this.PortToShapes.get(e);return t?this.AncestorsSets.get(t):new Set(this.HierarchyOfGroups.AllHitItems(lt.mkPP(e.Location,e.Location),null))}BoundAxisEdgeAdjacentToObstaclePort(e,t){null==e.Curve?this.BoundAxisByPoint(e.Location,t):e.Curve.boundingBox.contains(e.Location)&&this.BoundAxisEdgeByRect(e.Curve.boundingBox,t)}BoundAxisByPoint(e,t){null!=t&&t.Direction==this.NudgingDirection&&(this.NudgingDirection==ve.North?(t.BoundFromLeft(e.x),t.BoundFromRight(e.x)):(t.BoundFromLeft(-e.y),t.BoundFromRight(-e.y)))}BoundAxisEdgesAdjacentToSourceAndTargetOnEdge(e){this.BoundAxisEdgeAdjacentToObstaclePort(e.GeomEdge.sourcePort,e.FirstEdge.AxisEdge),this.BoundAxisEdgeAdjacentToObstaclePort(e.GeomEdge.targetPort,e.LastEdge.AxisEdge)}BoundAxisEdgeByRect(e,t){null!=t&&t.Direction==this.NudgingDirection&&(this.NudgingDirection==ve.North?(t.BoundFromLeft(e.left),t.BoundFromRight(e.right)):(t.BoundFromLeft(-1*e.top),t.BoundFromRight(-1*e.bottom)))}CreateLongestNudgedSegments(){const e=this.NudgingDirection==ve.East?t=>-t.y:t=>t.x;this.LongestNudgedSegs=new Array;for(let t=0;t<this.Paths.length;t++)this.CreateLongestNudgedSegmentsForPath(this.Paths[t],e)}CreateLongestNudgedSegmentsForPath(e,t){this.GoOverPathAndCreateLongSegs(e),Jn.CalculateIdealPositionsForLongestSegs(e,t)}static CalculateIdealPositionsForLongestSegs(e,t){let n=null,i=null,s=t(e.Start);for(const o of e.PathEdges())if(null!=o.LongestNudgedSegment){if(n=o.LongestNudgedSegment,null!=i){let a;Jn.SetIdealPositionForSeg(i,a=t(i.start),s,t(n.Start)),s=a,i=null}}else null!=n&&(i=n,n=null);null!=i?Jn.SetIdealPositionForSeg(i,t(i.Start),s,t(e.End)):null!=n&&(n.IdealPosition=t(n.Start))}static SetIdealPositionForSeg(e,t,n,i){const s=Math.max(n,i),o=Math.min(n,i);e.IdealPosition=o+le.distanceEpsilon<t?t<s?.5*(s+o):s:o}GoOverPathAndCreateLongSegs(e){let t=null;const n=Je.OppositeDir(this.NudgingDirection);for(const i of e.PathEdges()){const s=i.Direction;s==this.NudgingDirection||s==n?(null==t?(i.LongestNudgedSegment=t=new v4(this.LongestNudgedSegs.length),this.LongestNudgedSegs.push(t)):i.LongestNudgedSegment=t,i.IsFixed&&(t.IsFixed=!0)):(i.LongestNudgedSegment=null,t=null)}}static BuildPolylineForPath(e){const t={points:e.PathPoints.map(n=>n.clone())};return Jn.ExtendPolylineToPorts(t,e),t.points}static ExtendPolylineToPorts(e,t){Jn.ExtendPolylineToSourcePort(e,t.GeomEdge.sourcePort.Location),Jn.ExtendPolylineToTargetPort(e,t.GeomEdge.targetPort.Location),e.points.length<2&&(e.points=new Array(2),e.points[0]=t.GeomEdge.sourcePort.Location,e.points[1]=t.GeomEdge.targetPort.Location)}static ExtendPolylineToTargetPort(e,t){const n=e.points.length-1,i=Je.VectorDirectionPP(e.points[n-1],e.points[n]);if(Jn.ProjectionsAreClose(e.points[n-1],i,t))return void(e.points=e.points.slice(0,n));const s=e.points[n];e.points[n]=i==ve.East||i==ve.West?new k(t.x,s.y):new k(s.x,t.y)}static ProjectionsAreClose(e,t,n){return t==ve.East||t==ve.West?an(e.x,n.x):an(e.y,n.y)}static ExtendPolylineToSourcePort(e,t){const n=Je.VectorDirectionPP(e.points[0],e.points[1]);if(Jn.ProjectionsAreClose(e.points[1],n,t))return void(e.points=e.points.slice(1));const i=e.points[0];e.points[0]=n==ve.East||n==ve.West?new k(t.x,i.y):new k(i.x,t.y)}static RemoveSwitchbacksAndMiddlePoints(e){const t=[];let n=e[0];t.push(n);let i=e[1],s=Je.VectorDirectionPP(n,i),o=1;for(;++o<e.length;){const a=Je.VectorDirectionPP(i,e[o]);a==s||Je.OppositeDir(a)==s||a==ve.None||(k.closeDistEps(n,i)||t.push(n=Jn.Rectilinearise(n,i)),s=a),i=e[o]}return k.closeDistEps(n,i)||t.push(Jn.Rectilinearise(n,i)),t}static NudgePaths(e,t,n,i,s){if(0==e.length)return;const o=new Jn(e,t,n,i);o.Calculate(ve.North,!0),o.Calculate(ve.East,!1),o.Calculate(ve.North,!1),s&&o.RemoveStaircases();for(const a of e)a.GeomEdge.curve=At.mkFromPoints(Jn.BuildPolylineForPath(a))}RemoveStaircases(){rd.RemoveStaircases(this.Paths,this.HierarchyOfObstacles)}static MapPortsToShapes(e){const t=new Map;for(const n of e)for(const i of n.Ports)t.set(i,n);return t}static*GetEdgePathFromPathEdgesAsDebugCurves(e,t,n,i){const s=i.ArrayOfPathPoints(),o=s.length,a=o>1?(t-e)/(o-1):1;for(let l=0;l<s.length-1;l++)yield qt.mkDebugCurveTWCI(200,e+a*l,n,Me.mkPP(s[l],s[l+1]))}}class R4{constructor(e,t){this.Crossings=[],this.Location=e,this.Crossings=t}}class By{constructor(){this.ListOfPointsAndCrossings=[],this.index=0,this.ListOfPointsAndCrossings=new Array}Count(){return this.ListOfPointsAndCrossings.length}Add(e,t){this.ListOfPointsAndCrossings.push(new R4(e,t))}Pop(){return this.ListOfPointsAndCrossings[this.index++]}CurrentIsBeforeOrAt(e){return!(this.index>=this.ListOfPointsAndCrossings.length)&&xe.ComparePP(this.ListOfPointsAndCrossings[this.index].Location,e)<=0}get First(){return this.ListOfPointsAndCrossings[0]}get Last(){return this.ListOfPointsAndCrossings[this.ListOfPointsAndCrossings.length-1]}Reset(){this.index=0}MergeFrom(e){if(this.Reset(),null==e)return;const t=this.ListOfPointsAndCrossings.length;let n=0;const i=e.ListOfPointsAndCrossings.length;let s=0;const o=new Array(this.ListOfPointsAndCrossings.length);for(;n<t||s<i;){if(n>=t){o.push(e.ListOfPointsAndCrossings[s++]);continue}if(s>=i){o.push(this.ListOfPointsAndCrossings[n++]);continue}const a=this.ListOfPointsAndCrossings[n],l=e.ListOfPointsAndCrossings[s],c=xe.ComparePP(a.Location,l.Location);0==c?(o.push(a),++n,++s):-1==c?(o.push(a),++n):(o.push(l),++s)}this.ListOfPointsAndCrossings=o}Trim(e,t){this.Reset(),null!=this.ListOfPointsAndCrossings&&0!=this.ListOfPointsAndCrossings.length&&(this.ListOfPointsAndCrossings=this.ListOfPointsAndCrossings.filter(n=>xe.ComparePP(n.Location,e)>=0&&xe.ComparePP(n.Location,t)<=0))}static ToCrossingArray(e,t){let n=0;const i=e.length;for(let a=0;a<i;a++)e[a].DirectionToInside==t&&n++;if(0==n)return null;const s=new Array(n);let o=0;for(let a=0;a<i;a++)e[a].DirectionToInside==t&&(s[o++]=e[a]);return s}ToString(){return pi.String.Format("{0} [{1}]",this.ListOfPointsAndCrossings.length,this.index)}}class Qe{static EdgeDirectionVE(e){return Qe.EdgeDirectionVV(e.Source,e.Target)}static EdgeDirectionVV(e,t){return xe.GetDirections(e.point,t.point)}static GetEdgeEnd(e,t){return t==Qe.EdgeDirectionVE(e)?e.Target:e.Source}static FindAdjacentVertex(e,t){for(const n of e.InEdges)if(xe.GetDirections(e.point,n.SourcePoint)==t)return n.Source;for(const n of e.OutEdges)if(xe.GetDirections(e.point,n.TargetPoint)==t)return n.Target;return null}static FindAdjacentEdge(e,t){for(const n of e.InEdges)if(xe.GetDirections(n.SourcePoint,e.point)==t)return n;for(const n of e.OutEdges)if(xe.GetDirections(e.point,n.TargetPoint)==t)return n;return null}static FindBendPointBetween(e,t,n){return Qe.IsVerticalD(n)?new k(t.x,e.y):new k(e.x,t.y)}static SegmentIntersectionPPP(e,t,n){const i=xe.GetDirections(e,t);return Qe.IsVerticalD(i)?new k(e.x,n.y):new k(n.x,e.y)}static SegmentIntersectionSP(e,t){return Qe.SegmentIntersectionPPP(e.Start,e.End,t)}static SegmentsIntersection(e,t){return Qe.IntervalsIntersect(e.Start,e.End,t.Start,t.End)}static SegmentsIntersectLL(e,t){return Qe.IntervalsIntersect(e.start,e.end,t.start,t.end)}static IntervalsOverlapSS(e,t){return Qe.IntervalsOverlapPPPP(e.Start,e.End,t.Start,t.End)}static IntervalsOverlapPPPP(e,t,n,i){return Qe.IntervalsAreCollinear(e,t,n,i)&&xe.ComparePP(e,i)!=xe.ComparePP(t,n)}static IntervalsAreCollinear(e,t,n,i){const s=Qe.IsVerticalPP(e,t);return Qe.IsVerticalPP(n,i)==s&&(s?xe.Equal(e.x,n.x):xe.Equal(e.y,n.y))}static IntervalsAreSame(e,t,n,i){return xe.EqualPP(e,n)&&xe.EqualPP(t,i)}static IntervalsIntersect(e,t,n,i){const s=Qe.SegmentIntersectionPPP(e,t,n);return Qe.PointIsOnSegmentPPP(e,t,s)&&Qe.PointIsOnSegmentPPP(n,i,s)?s:void 0}static SegmentIntersectionEP(e,t){return Qe.SegmentIntersectionPPP(e.SourcePoint,e.TargetPoint,t)}static PointIsOnSegmentPPP(e,t,n){return xe.EqualPP(e,n)||xe.EqualPP(t,n)||xe.GetDirections(e,n)==xe.GetDirections(n,t)}static PointIsOnSegmentSP(e,t){return Qe.PointIsOnSegmentPPP(e.Start,e.End,t)}static IsVerticalD(e){return 0!=(e&(ve.North|ve.South))}static IsVerticalE(e){return Qe.IsVerticalD(xe.GetDirections(e.SourcePoint,e.TargetPoint))}static IsVerticalPP(e,t){return Qe.IsVerticalD(xe.GetDirections(e,t))}static IsVertical(e){return Qe.IsVerticalD(xe.GetDirections(e.start,e.end))}static IsAscending(e){return 0!=(e&(ve.North|ve.East))}static Slope(e,t,n){const i=t.sub(e);return i.dot(n.PerpDirectionAsPoint)/i.dot(n.DirectionAsPoint)}static SortAscending(e,t){const n=xe.GetDirections(e,t);return ve.None==n||Qe.IsAscending(n)?[e,t]:[t,e]}static RectangleBorderIntersect(e,t,n){switch(n){case ve.North:case ve.South:return new k(t.x,Qe.GetRectangleBound(e,n));case ve.East:case ve.West:return new k(Qe.GetRectangleBound(e,n),t.y);default:throw new Error}}static GetRectangleBound(e,t){switch(t){case ve.North:return e.top;case ve.South:return e.bottom;case ve.East:return e.right;case ve.West:return e.left;default:throw new Error}}static RectangleInteriorsIntersect(e,t){return xe.Compare(e.bottom,t.top)<0&&xe.Compare(t.bottom,e.top)<0&&xe.Compare(e.left,t.right)<0&&xe.Compare(t.left,e.right)<0}static PointIsInRectangleInterior(e,t){return xe.Compare(e.y,t.top)<0&&xe.Compare(t.bottom,e.y)<0&&xe.Compare(e.x,t.right)<0&&xe.Compare(t.left,e.x)<0}}class ur{constructor(e){this.Dir=e,this.DirectionAsPoint=Je.toPoint(this.Dir),this.PerpDirection=ve.North==e?ve.East:ve.North,this.PerpDirectionAsPoint=Je.toPoint(this.PerpDirection),this.OppositeDirection=Je.OppositeDir(e)}get Dir(){return this.dir}set Dir(e){this.dir=e}get IsHorizontal(){return ve.East==this.Dir}get IsVertical(){return ve.North==this.Dir}Compare(e,t){const n=this.ComparePerpCoord(e,t);return 0!=n?n:this.CompareScanCoord(e,t)}CompareScanCoord(e,t){return xe.Compare(e.sub(t).dot(this.DirectionAsPoint),0)}ComparePerpCoord(e,t){return xe.Compare(e.sub(t).dot(this.PerpDirectionAsPoint),0)}IsFlatS(e){return this.IsFlatPP(e.Start,e.End)}IsFlatPP(e,t){return xe.Equal(t.sub(e).dot(this.PerpDirectionAsPoint),0)}IsPerpendicularS(e){return this.IsPerpendicularPP(e.Start,e.End)}IsPerpendicularPP(e,t){return xe.Equal(t.sub(e).dot(this.DirectionAsPoint),0)}Coord(e){return e.dot(this.DirectionAsPoint)}Min(e,t){return this.Compare(e,t)<=0?e:t}Max(e,t){return this.Compare(e,t)>=0?e:t}get PerpendicularInstance(){return this.IsHorizontal?ur.VerticalInstance:ur.HorizontalInstance}static GetInstance(e){return Qe.IsVerticalD(e)?ur.VerticalInstance:ur.HorizontalInstance}ToString(){return this.Dir.toString()}}ur.HorizontalInstance=new ur(ve.East),ur.VerticalInstance=new ur(ve.North);class Ht extends wT{constructor(e,t,n,i){super(),this.Update(e,t),this.Weight=n,this.GroupBoundaryPointAndCrossingsList=i}static mk(e,t){return new Ht(e,t,Ht.NormalWeight,null)}get Start(){return this.startPoint}get End(){return this.endPoint}get IsVertical(){return Ht.IsVerticalSegment(this.Start,this.End)}get ScanDirection(){return this.IsVertical?ur.VerticalInstance:ur.HorizontalInstance}get IsOverlapped(){return Ht.OverlappedWeight==this.Weight}get IsReflection(){return Ht.ReflectionWeight==this.Weight}static IsVerticalSegment(e,t){return e.x==t.x}MergeGroupBoundaryCrossingList(e){null!=e&&(null==this.GroupBoundaryPointAndCrossingsList&&(this.GroupBoundaryPointAndCrossingsList=new By),this.GroupBoundaryPointAndCrossingsList.MergeFrom(e))}TrimGroupBoundaryCrossingList(){null!=this.GroupBoundaryPointAndCrossingsList&&this.GroupBoundaryPointAndCrossingsList.Trim(this.Start,this.End)}Update(e,t){this.startPoint=e,this.endPoint=t}SetInitialVisibilityVertex(e){this.LowestVisibilityVertex=e,this.HighestVisibilityVertex=e}AppendVisibilityVertex(e,t){if(null==this.HighestVisibilityVertex)this.AddGroupCrossingsBeforeHighestVisibilityVertex(e,t)||this.SetInitialVisibilityVertex(t);else{if(xe.IsPureLower(t.point,this.HighestVisibilityVertex.point))return;this.AddGroupCrossingsBeforeHighestVisibilityVertex(e,t)||this.AppendHighestVisibilityVertex(t)}}AddVisibilityEdge(e,t){const n=new Xi(e,t,this.Weight);return Or.AddEdge(n),n}AppendHighestVisibilityVertex(e){xe.EqualPP(this.HighestVisibilityVertex.point,e.point)||(this.AddVisibilityEdge(this.HighestVisibilityVertex,e),this.HighestVisibilityVertex=e)}LoadStartOverlapVertexIfNeeded(e){if(this.NeedStartOverlapVertex){const t=e.FindVertex(this.Start);this.AppendVisibilityVertex(e,null!=t?t:e.AddVertexP(this.Start))}}LoadEndOverlapVertexIfNeeded(e){if(this.NeedEndOverlapVertex){const t=e.FindVertex(this.End);this.AppendVisibilityVertex(e,null!=t?t:e.AddVertexP(this.End))}}OnSegmentIntersectorBegin(e){this.AppendGroupCrossingsThroughPoint(e,this.Start)||this.LoadStartOverlapVertexIfNeeded(e)}OnSegmentIntersectorEnd(e){this.AppendGroupCrossingsThroughPoint(e,this.End),this.GroupBoundaryPointAndCrossingsList=null,(null==this.HighestVisibilityVertex||xe.IsPureLower(this.HighestVisibilityVertex.point,this.End))&&this.LoadEndOverlapVertexIfNeeded(e)}static Subsume(e,t,n,i,s,o,a,l){return l.extendStart=!0,l.extendEnd=!0,!(null==e.seg||!Qe.IntervalsOverlapPPPP(e.seg.Start,e.seg.End,t,n)||(e.seg.Weight!=i?e.seg.Start!=t||e.seg.End!=n||(e.seg.Weight=Math.min(e.seg.Weight,i),0):(l.extendStart=-1==o.CompareScanCoord(t,e.seg.Start),l.extendEnd=1==o.CompareScanCoord(n,e.seg.End),(l.extendStart||l.extendEnd)&&(a.Remove(e.seg),e.seg.startPoint=o.Min(e.seg.Start,t),e.seg.endPoint=o.Max(e.seg.End,n),e.seg=a.InsertUnique(e.seg).item,e.seg.MergeGroupBoundaryCrossingList(s)),0)))}IntersectsSegment(e){return null!=Qe.SegmentsIntersection(this,e)}toString(){return"["+this.Start+" -> "+this.End+(this.IsOverlapped?" olap":" free")+"]"}ContainsPoint(e){return xe.EqualPP(this.Start,e)||xe.EqualPP(this.End,e)||xe.GetDirections(this.Start,e)==xe.GetDirections(e,this.End)}get HasSparsePerpendicularCoords(){return null!=this.sparsePerpendicularCoords&&this.sparsePerpendicularCoords.size>0}CreatePointFromPerpCoord(e){return this.IsVertical?new k(this.Start.x,e):new k(e,this.Start.y)}AddSparseVertexCoord(e){null==this.sparsePerpendicularCoords&&(this.sparsePerpendicularCoords=new Set),this.sparsePerpendicularCoords.add(e)}AddSparseEndpoint(e){return!this.sparsePerpendicularCoords.has(e)&&(this.sparsePerpendicularCoords.add(e),!0)}CreateSparseVerticesAndEdges(e){var t;if(null!=this.sparsePerpendicularCoords){this.AppendGroupCrossingsThroughPoint(e,this.Start);for(const n of Array.from(this.sparsePerpendicularCoords.values()).sort($n)){const i=this.CreatePointFromPerpCoord(n);this.AppendVisibilityVertex(e,null!==(t=e.FindVertex(i))&&void 0!==t?t:e.AddVertexP(i))}this.AppendGroupCrossingsThroughPoint(e,this.End),this.GroupBoundaryPointAndCrossingsList=null,this.sparsePerpendicularCoords.clear(),this.sparsePerpendicularCoords=null}}HasVisibility(){return null!=this.LowestVisibilityVertex}AddGroupCrossingsBeforeHighestVisibilityVertex(e,t){return!!this.AppendGroupCrossingsThroughPoint(e,t.point)&&(xe.IsPureLower(this.HighestVisibilityVertex.point,t.point)&&(this.AddVisibilityEdge(this.HighestVisibilityVertex,t),this.HighestVisibilityVertex=t),!0)}AppendGroupCrossingsThroughPoint(e,t){var n;if(null==this.GroupBoundaryPointAndCrossingsList)return!1;let i=!1;for(;this.GroupBoundaryPointAndCrossingsList.CurrentIsBeforeOrAt(t);){const s=this.GroupBoundaryPointAndCrossingsList.Pop();let o=null,a=null;xe.ComparePP(s.Location,this.Start)>0&&(o=By.ToCrossingArray(s.Crossings,this.ScanDirection.OppositeDirection)),xe.ComparePP(s.Location,this.End)<0&&(a=By.ToCrossingArray(s.Crossings,this.ScanDirection.Dir)),i=!0;const l=null!==(n=e.FindVertex(s.Location))&&void 0!==n?n:e.AddVertexP(s.Location);e.AddVertexP(s.Location),null!=o||null!=a?(this.AddLowCrossings(e,l,o),this.AddHighCrossings(e,l,a)):null==this.LowestVisibilityVertex?this.SetInitialVisibilityVertex(l):this.AppendHighestVisibilityVertex(l)}return i}static GetCrossingInteriorVertex(e,t,n){var i;const s=n.GetInteriorVertexPoint(t.point);return null!==(i=e.FindVertex(s))&&void 0!==i?i:e.AddVertexP(s)}AddCrossingEdge(e,t,n,i){let s=null;null!=this.HighestVisibilityVertex&&(xe.EqualPP(this.HighestVisibilityVertex.point,n.point)?s=e.FindEdgePP(t.point,n.point):this.AppendHighestVisibilityVertex(t)),null==s&&(s=this.AddVisibilityEdge(t,n));const o=i.map(l=>l.Group.InputShape),a=s.IsPassable;s.IsPassable=null==a?()=>{for(const l of o)if(l.IsTransparent)return!0;return!1}:()=>{for(const l of o)if(l.IsTransparent||a())return!0;return!1},null==this.LowestVisibilityVertex&&this.SetInitialVisibilityVertex(t),this.HighestVisibilityVertex=n}AddLowCrossings(e,t,n){if(null!=n){const i=Ht.GetCrossingInteriorVertex(e,t,n[0]);this.AddCrossingEdge(e,i,t,n)}}AddHighCrossings(e,t,n){if(null!=n){const i=Ht.GetCrossingInteriorVertex(e,t,n[0]);this.AddCrossingEdge(e,t,i,n)}}}Ht.NormalWeight=Xi.DefaultWeight,Ht.ReflectionWeight=5,Ht.OverlappedWeight=500;class fL{constructor(e,t,n,i,s){this.IsClosed=!1,this.Vertex=e,this.Direction=null!=t?Je.DirectionFromPointToPoint(t.Vertex.point,e.point):ve.None,this.ResetEntry(t,n,i,s)}ResetEntry(e,t,n,i){this.PreviousEntry=e,this.Length=t,this.NumberOfBends=n,this.Cost=i}get PreviousVertex(){return null==this.PreviousEntry?null:this.PreviousEntry.Vertex}toString(){return this.Vertex.point+" "+this.Direction+" "+this.IsClosed+" "+this.Cost}}class IT{constructor(){this.Clear()}Set(e,t){this.Vertex=e,this.Weight=t}Clear(){this.Vertex=null,this.Weight=Number.NaN}}class In{constructor(){this.nextNeighbors=[new IT,new IT,new IT],this.LengthImportance=1,this.BendsImportance=1}CombinedCost(e,t){return this.LengthImportance*e+this.BendsImportance*t}TotalCostFromSourceToVertex(e,t){return this.CombinedCost(e,t)+this.sourceCostAdjustment}InitPath(e,t,n){if(t==n||!this.InitEntryDirectionsAtTarget(n))return!1;this.Target=n,this.Source=t;const i=this.TotalCostFromSourceToVertex(0,0)+this.HeuristicDistanceFromVertexToTarget(t.point,ve.None);return!(i>=this.upperBoundOnCost)&&(this.queue=new Iu($n),this.visitedVertices=[t],null==e?this.EnqueueInitialVerticesFromSource(i):this.EnqueueInitialVerticesFromSourceEntries(e),this.queue.count>0)}InitEntryDirectionsAtTarget(e){this.EntryDirectionsToTarget=ve.None;for(const t of e.OutEdges)this.EntryDirectionsToTarget=this.EntryDirectionsToTarget|Je.DirectionFromPointToPoint(t.TargetPoint,e.point);for(const t of e.InEdges)this.EntryDirectionsToTarget=this.EntryDirectionsToTarget|Je.DirectionFromPointToPoint(t.SourcePoint,e.point);return this.EntryDirectionsToTarget!=ve.None}static IsInDirs(e,t){return e==(e&t)}MultistageAdjustedCostBound(e){return Number.isFinite(e)?e+this.BendsImportance:e}HeuristicDistanceFromVertexToTarget(e,t){const n=this.Target.point.sub(e);if(an(n.x,0)&&an(n.y,0))return this.targetCostAdjustment;const i=Je.VectorDirection(n);let s;return s=this.GetNumberOfBends(t==ve.None?t=ve.East|ve.North|ve.West|ve.South:t,i),this.CombinedCost(In.ManhattanDistance(e,this.Target.point),s)+this.targetCostAdjustment}GetNumberOfBends(e,t){return Je.IsPureDirection(t)?this.GetNumberOfBendsForPureDirection(e,t):In.GetBendsForNotPureDirection(t,e,this.EntryDirectionsToTarget)}GetNumberOfBendsForPureDirection(e,t){return(t&e)==t?In.IsInDirs(t,this.EntryDirectionsToTarget)?0:In.IsInDirs(In.Left(t),this.EntryDirectionsToTarget)||In.IsInDirs(In.Right(t),this.EntryDirectionsToTarget)?2:4:this.GetNumberOfBendsForPureDirection(In.AddOneTurn[e],t)+1}static GetBendsForNotPureDirection(e,t,n){const i=e&t;if(i==ve.None)return In.GetBendsForNotPureDirection(e,In.AddOneTurn[t],n)+1;const s=e&n;return s==ve.None?In.GetBendsForNotPureDirection(e,t,In.AddOneTurn[n])+1:(i|s)==e?1:2}static Left(e){switch(e){case ve.None:return ve.None;case ve.North:return ve.West;case ve.East:return ve.North;case ve.South:return ve.East;case ve.West:return ve.South;default:throw new Error("direction")}}static Right(e){switch(e){case ve.None:return ve.None;case ve.North:return ve.East;case ve.East:return ve.South;case ve.South:return ve.West;case ve.West:return ve.North;default:throw new Error("direction")}}static RestorePathV(e){return In.RestorePath(e,null)}static RestorePath(e,t){if(null==e.entry)return[];const n=new Array;let i=!1,s=ve.None;for(;;){s==e.entry.Direction?i=!0:(i=!1,n.push(e.entry.Vertex.point),s=e.entry.Direction);const o=e.entry.PreviousEntry;if(null==o||e.entry.Vertex==t)break;e.entry=o}return i&&n.push(e.entry.Vertex.point),n.reverse(),n}QueueReversedEntryToNeighborVertexIfNeeded(e,t,n){const i={numberOfBends:0,length:0},s=t.PreviousVertex,o=In.GetLengthAndNumberOfBendsToNeighborVertex(e,s,n,i);if(this.CombinedCost(i.length,i.numberOfBends)<this.CombinedCost(t.Length,t.NumberOfBends)||1==e.Vertex.Degree){const a=this.TotalCostFromSourceToVertex(i.length,i.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(s.point,o);this.EnqueueEntry(e,s,i.length,i.numberOfBends,a)}}UpdateEntryToNeighborVertexIfNeeded(e,t,n){const i={numberOfBends:0,length:0},s=In.GetLengthAndNumberOfBendsToNeighborVertex(e,t.Vertex,n,i);if(this.CombinedCost(i.length,i.numberOfBends)<this.CombinedCost(t.Length,t.NumberOfBends)){const o=this.TotalCostFromSourceToVertex(i.length,i.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(t.Vertex.point,s);t.ResetEntry(e,i.length,i.numberOfBends,o),this.queue.DecreasePriority(t,o)}}CreateAndEnqueueEntryToNeighborVertex(e,t,n){const i={numberOfBends:0,length:0},s=In.GetLengthAndNumberOfBendsToNeighborVertex(e,t,n,i),o=this.TotalCostFromSourceToVertex(i.length,i.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(t.point,s);o<this.upperBoundOnCost&&(null==t.VertexEntries&&this.visitedVertices.push(t),this.EnqueueEntry(e,t,i.length,i.numberOfBends,o))}EnqueueEntry(e,t,n,i,s){const o=new fL(t,e,n,i,s);t.SetVertexEntry(o),this.queue.Enqueue(o,o.Cost)}static GetLengthAndNumberOfBendsToNeighborVertex(e,t,n,i){i.length=e.Length+In.ManhattanDistance(e.Vertex.point,t.point)*n;const s=Je.DirectionFromPointToPoint(e.Vertex.point,t.point);return i.numberOfBends=e.NumberOfBends,e.Direction!=ve.None&&s!=e.Direction&&i.numberOfBends++,s}static ManhattanDistance(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}GetPathWithCost(e,t,n,i,s,o,a){if(this.upperBoundOnCost=a,this.sourceCostAdjustment=n,this.targetCostAdjustment=o,!this.InitPath(e,t,s))return null;for(;this.queue.count>0;){const l=this.queue.Dequeue(),c=l.Vertex;if(c==this.Target){if(null==i)return this.Cleanup(),l;if(this.EntryDirectionsToTarget==ve.None){let b=0;for(const N of this.Target.VertexEntries)i[b++]=N;return this.Cleanup(),null}this.upperBoundOnCost=Math.min(this.MultistageAdjustedCostBound(l.Cost),this.upperBoundOnCost);continue}l.IsClosed=!0;for(const b of this.nextNeighbors)b.Clear();const d=In.Right(l.Direction);this.ExtendPathAlongInEdges(l,c.InEdges,d),this.ExtendPathAlongOutEdges(l,c.OutEdges,d);for(const b of this.nextNeighbors)null!=b.Vertex&&this.ExtendPathToNeighborVertex(l,b.Vertex,b.Weight)}if(null!=i&&null!=this.Target.VertexEntries)for(let l=0;l<this.Target.VertexEntries.length;l++)i[l]=this.Target.VertexEntries[l];return this.Cleanup(),null}ExtendPathAlongInEdges(e,t,n){for(const i of t)this.ExtendPathAlongEdge(e,i,!0,n)}ExtendPathAlongOutEdges(e,t,n){let i=t.isEmpty()?null:t.treeMinimum();for(;null!=i;i=t.next(i))this.ExtendPathAlongEdge(e,i.item,!1,n)}ExtendPathAlongEdge(e,t,n,i){if(!In.IsPassable(t))return;const s=n?t.Source:t.Target;if(s==e.PreviousVertex){if(e.Vertex.Degree>1||e.Vertex!=this.Source)return;return void this.ExtendPathToNeighborVertex(e,s,t.Weight)}const o=Je.DirectionFromPointToPoint(e.Vertex.point,s.point);let a=this.nextNeighbors[2];o!=e.Direction&&(a=this.nextNeighbors[o==i?1:0]),a.Set(s,t.Weight)}EnqueueInitialVerticesFromSource(e){const t=new fL(this.Source,null,0,0,e);for(const n of this.Source.OutEdges)!In.IsPassable(n)||this.ExtendPathToNeighborVertex(t,n.Target,n.Weight);for(const n of this.Source.InEdges)!In.IsPassable(n)||this.ExtendPathToNeighborVertex(t,n.Source,n.Weight)}EnqueueInitialVerticesFromSourceEntries(e){for(const t of e)null!=t&&this.queue.Enqueue(t,t.Cost)}ExtendPathToNeighborVertex(e,t,n){const i=Je.DirectionFromPointToPoint(e.Vertex.point,t.point),s=null!=t.VertexEntries?t.VertexEntries[Je.ToIndex(i)]:null;null==s?this.CreateAndEnqueueReversedEntryToNeighborVertex(e,t,n)||this.CreateAndEnqueueEntryToNeighborVertex(e,t,n):s.IsClosed||this.UpdateEntryToNeighborVertexIfNeeded(e,s,n)}CreateAndEnqueueReversedEntryToNeighborVertex(e,t,n){if(null!=e.Vertex.VertexEntries){const i=Je.DirectionFromPointToPoint(t.point,e.Vertex.point),s=e.Vertex.VertexEntries[Je.ToIndex(i)];if(null!=s)return this.QueueReversedEntryToNeighborVertexIfNeeded(e,s,n),!0}return!1}static IsPassable(e){return null==e.IsPassable||e.IsPassable()}Cleanup(){for(const e of this.visitedVertices)e.RemoveVertexEntries();this.visitedVertices=[],this.queue=null}}In.DefaultBendPenaltyAsAPercentageOfDistance=4,In.AddOneTurn=[ve.None,ve.North|ve.East|ve.West,ve.North|ve.East|ve.South,15,ve.East|ve.South|ve.West,15,15,15,13,15,15,15,15,15,15,15];class ky{constructor(e){this.bendPenaltyAsAPercentageOfDistance=In.DefaultBendPenaltyAsAPercentageOfDistance,this.currentPassTargetEntries=new Array(4),this.bendPenaltyAsAPercentageOfDistance=e}GetPath(e,t){const n={entry:this.GetPathStage(null,e,null,t)};return In.RestorePathV(n)}GetPathStage(e,t,n,i){const s=new In,o={bestEntry:null,bestCost:Number.MAX_VALUE/Ht.OverlappedWeight};let a=Number.POSITIVE_INFINITY;const l=ky.Barycenter(t),c=ky.Barycenter(i),d=In.ManhattanDistance(l,c);s.BendsImportance=Math.max(.001,d*(.01*this.bendPenaltyAsAPercentageOfDistance));const b=s.LengthImportance,N=null!=n?this.currentPassTargetEntries:null,F=[];for(const ie of t)for(const he of i)F.push([ie,he]);F.sort(([ie,he],[de,Te])=>G(ie,he)-G(de,Te));for(const[ie,he]of F){if(k.closeDistEps(ie.point,he.point))continue;const de=W(ie,l)*b,Te=W(he,c)*b;let Ke=o.bestCost;if(null!=n){for(let wt=0;wt<N.length;wt++)N[wt]=null;Ke=s.MultistageAdjustedCostBound(o.bestCost)}const Xe=s.GetPathWithCost(e,ie,de,N,he,Te,Ke);if(null!=N){ky.UpdateTargetEntriesForEachDirection(n,N,o);continue}if(null==Xe)continue;const Et=Xe.Cost/G(ie,he);(Xe.Cost<o.bestCost||an(Xe.Cost,o.bestCost)&&Et<a)&&(o.bestCost=Xe.Cost,o.bestEntry=Xe,a=Xe.Cost/G(ie,he))}return o.bestEntry;function G(ie,he){return In.ManhattanDistance(ie.point,he.point)}function W(ie,he){return In.ManhattanDistance(ie.point,he)}}static UpdateTargetEntriesForEachDirection(e,t,n){for(let i=0;i<t.length;i++){const s=t[i];null!=s&&(null==e[i]||s.Cost<e[i].Cost)&&(e[i]=s,s.Cost<n.bestCost&&(n.bestCost=s.Cost,n.bestEntry=s))}}static Barycenter(e){let t=new k(0,0);for(const n of e)t=t.add(n.point);return t.div(e.length)}}class T4{constructor(e){this.GeomEdge=e}get PathPoints(){return this._pathPoints}set PathPoints(e){this._pathPoints=e}get Width(){return this.GeomEdge.lineWidth}get End(){return this.LastEdge.Target}get Start(){return this.FirstEdge.Source}ArrayOfPathPoints(){return this._pathPoints instanceof yc?Array.from(gL(this._pathPoints)):this._pathPoints}*PathEdges(){for(let e=this.FirstEdge;null!=e;e=e.Next)yield e}AddEdge(e){e.Path=this,this.LastEdge.Next=e,e.Prev=this.LastEdge,this.LastEdge=e}SetFirstEdge(e){this.FirstEdge=e,this.LastEdge=e,e.Path=this}toString(){const e=new pi.StringBuilder;this.PathPoints instanceof yc&&e.Append("L");for(const t of gL(this.PathPoints))e.Append(t.toString());return e.ToString()}}function*gL(r){if(r instanceof yc)for(let e=r;null!=e;e=e.Next)yield e.Point;else for(const e of r)yield e}class pL extends vT{constructor(e,t,n,i){super(t),this.Slope=0,this.SlopeInverse=0,this.Obstacle=e,this.endVertex=i?t.nextOnPolyline:t.prevOnPolyline,n.IsPerpendicularPP(t.point,this.endVertex.point)||(this.Slope=Qe.Slope(t.point,this.endVertex.point,n),this.SlopeInverse=1/this.Slope)}get Obstacle(){return this.obstacle}set Obstacle(e){this.obstacle=e}get EndVertex(){return this.endVertex}}class ka extends pL{constructor(e,t,n){super(e,t,n,n.IsHorizontal)}}class Gy extends pL{constructor(e,t,n){super(e,t,n,n.IsVertical)}}let vl=(()=>{class r{constructor(t,n,i){if(null!=t){if(n){const s=t.BoundingBox.clone();s.pad(i),this.PaddedPolyline=fe.polyFromBox(s)}else this.PaddedPolyline=Jo.PaddedPolylineBoundaryOfNode(t.BoundaryCurve,i);r.RoundVerticesAndSimplify(this.PaddedPolyline),this.IsRectangle=this.IsPolylineRectangle(),this.InputShape=t,this.Ports=new Set(this.InputShape.Ports)}}get PaddedPolyline(){return this._PaddedPolyline}set PaddedPolyline(t){this._PaddedPolyline=t}GetPortChanges(t){return t.addedPorts=Zf(this.InputShape.Ports,this.Ports),t.removedPorts=Zf(this.Ports,this.InputShape.Ports),(0!=t.addedPorts.size||0!=t.removedPorts.size)&&(this.Ports=new Set(this.InputShape.Ports),!0)}get IsInConvexHull(){return null!=this.ConvexHull}get IsGroup(){return null!=this.InputShape&&this.InputShape.IsGroup}get VisibilityBoundingBox(){return this.VisibilityPolyline.boundingBox}get VisibilityPolyline(){return null!=this.ConvexHull?this.ConvexHull.Polyline:this.PaddedPolyline}static CreateSentinel(t,n,i,s){const o=r.mk(t,n,s);return o.CreateInitialSides(o.PaddedPolyline.startPoint,i),o}CreateInitialSides(t,n){this.ActiveLowSide=new ka(this,t,n),this.ActiveHighSide=new Gy(this,t,n),n.IsFlatS(this.ActiveHighSide)&&(this.ActiveHighSide=new Gy(this,this.ActiveHighSide.EndVertex,n))}static mk(t,n,i){const s=new r(null,!1,0);return s.PaddedPolyline=At.mkClosedFromPoints([le.RoundPoint(t),le.RoundPoint(n)]),s.Ordinal=i,s}IsPolylineRectangle(){if(4!=this.PaddedPolyline.count)return!1;let t=this.PaddedPolyline.startPoint,n=t.nextOnPolyline,i=Je.VectorDirectionPP(t.point,n.point);if(!Je.IsPureDirection(i))return!1;do{t=n,n=t.nextOnPolyline;const s=Je.DirectionFromPointToPoint(t.point,n.point);if(s!=Je.RotateRight(i))return!1;i=s}while(t!=this.PaddedPolyline.startPoint);return!0}static RoundVerticesAndSimplify(t){let n=t.startPoint;do{n.point=le.RoundPoint(n.point),n=n.nextOnPolyline}while(n!=t.startPoint);r.RemoveCloseAndCollinearVerticesInPlace(t),t.setInitIsRequired()}get IsPrimaryObstacle(){return null==this.ConvexHull||this==this.ConvexHull.PrimaryObstacle}static RemoveCloseAndCollinearVerticesInPlace(t){const n=10*le.intersectionEpsilon;for(let i=t.startPoint.next;null!=i;i=i.next)k.close(i.prev.point,i.point,n)&&(null==i.next?t.RemoveEndPoint():(i.prev.next=i.next,i.next.prev=i.prev));return k.close(t.start,t.end,n)&&t.RemoveStartPoint(),On.RemoveCollinearVertices(t),null!=t.endPoint.prev&&t.endPoint.prev!=t.startPoint&&k.getTriangleOrientation(t.endPoint.prev.point,t.end,t.start)==nt.Collinear&&t.RemoveEndPoint(),null!=t.startPoint.next&&t.endPoint.prev!=t.startPoint&&k.getTriangleOrientation(t.end,t.start,t.startPoint.next.point)==nt.Collinear&&t.RemoveStartPoint(),t.setInitIsRequired(),t}get isOverlapped(){return null!=this.clump&&this.clump.length>0}get IsSentinel(){return null==this.InputShape}IsInSameClump(t){return this.isOverlapped&&this.clump==t.clump}Close(){this.ActiveLowSide=null,this.ActiveHighSide=null}SetConvexHull(t){this.clump=null,this.IsRectangle=!1,this.ConvexHull=t,this.looseVisibilityPolyline=null}static CreateLoosePolyline(t){const n=Jo.CreatePaddedPolyline(t,10*le.intersectionEpsilon);return r.RoundVerticesAndSimplify(n),n}get IsTransparentAncestor(){return null!=this.InputShape&&this.InputShape.IsTransparent}set IsTransparentAncestor(t){this.InputShape.IsTransparent=t}}return r.FirstSentinelOrdinal=1,r.FirstNonSentinelOrdinal=10,r})();class O4{constructor(e,t,n,i){this.IsOverlapped=!1,this.unpaddedToPaddedBorderWeight=Ht.NormalWeight,this.ObstaclePort=e,this.UnpaddedBorderIntersect=t,this.OutwardDirection=n;const s=Me.mkPP(this.UnpaddedBorderIntersect,Qe.RectangleBorderIntersect(e.Obstacle.VisibilityBoundingBox,this.UnpaddedBorderIntersect,n)),o=fe.getAllIntersections(s,e.Obstacle.VisibilityPolyline,!0);this.VisibilityBorderIntersect=le.RoundPoint(o[0].x);const a={pacList:null};this.MaxVisibilitySegment=i.CreateMaxVisibilitySegment(this.VisibilityBorderIntersect,this.OutwardDirection,a),this.pointAndCrossingsList=a.pacList,(this.Obstacle.isOverlapped||this.Obstacle.IsGroup&&!this.Obstacle.IsInConvexHull)&&(this.IsOverlapped=i.IntersectionIsInsideAnotherObstacle(null,this.Obstacle,this.VisibilityBorderIntersect,ur.GetInstance(this.OutwardDirection)),(!this.Obstacle.IsGroup||this.IsOverlapped||this.InteriorEdgeCrossesObstacle(i))&&(this.unpaddedToPaddedBorderWeight=Ht.OverlappedWeight)),this.Obstacle.IsInConvexHull&&this.unpaddedToPaddedBorderWeight==Ht.NormalWeight&&this.SetUnpaddedToPaddedBorderWeightFromHullSiblingOverlaps(i)}get Obstacle(){return this.ObstaclePort.Obstacle}get InitialWeight(){return this.IsOverlapped?Ht.OverlappedWeight:Ht.NormalWeight}get IsCollinearWithPort(){return Je.IsPureDirection(xe.GetDirections(this.VisibilityBorderIntersect,this.ObstaclePort.Location))}get IsVertical(){return Qe.IsVertical(this.MaxVisibilitySegment)}get WantVisibilityIntersection(){return!this.IsOverlapped&&this.CanExtend&&(!this.ObstaclePort.HasCollinearEntrances||this.IsCollinearWithPort)}get CanExtend(){return xe.GetDirections(this.MaxVisibilitySegment.start,this.MaxVisibilitySegment.end)!=ve.None}SetUnpaddedToPaddedBorderWeightFromHullSiblingOverlaps(e){(this.Obstacle.IsGroup?this.InteriorEdgeCrossesObstacle(e):this.InteriorEdgeCrossesConvexHullSiblings())&&(this.unpaddedToPaddedBorderWeight=Ht.OverlappedWeight)}InteriorEdgeCrossesObstacle(e){const t=lt.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect);return this.InteriorEdgeCrossesObstacleRFI(t,n=>n.VisibilityPolyline,Array.from(e.Root.GetLeafRectangleNodesIntersectingRectangle(t)).filter(n=>!n.UserData.IsGroup&&n.UserData!=this.Obstacle).map(n=>n.UserData))}InteriorEdgeCrossesConvexHullSiblings(){const e=lt.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect);return this.InteriorEdgeCrossesObstacleRFI(e,t=>t.PaddedPolyline,this.Obstacle.ConvexHull.Obstacles.filter(t=>t!=this.Obstacle))}InteriorEdgeCrossesObstacleRFI(e,t,n){let i=null;for(const s of n){const o=t(s);if(Qe.RectangleInteriorsIntersect(e,o.boundingBox)&&(i=null!=i?i:Me.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect),null!=fe.intersectionOne(i,o,!1)||Ot.Outside!=fe.PointRelativeToCurveLocation(this.UnpaddedBorderIntersect,o)))return!0}return!1}get HasGroupCrossings(){return null!=this.pointAndCrossingsList&&this.pointAndCrossingsList.Count()>0}HasGroupCrossingBeforePoint(e){if(!this.HasGroupCrossings)return!1;const t=Qe.IsAscending(this.OutwardDirection)?this.pointAndCrossingsList.First:this.pointAndCrossingsList.Last;return xe.GetDirections(this.MaxVisibilitySegment.start,t.Location)==xe.GetDirections(t.Location,e)}AddToAdjacentVertex(e,t,n,i){let s=e.VisGraph.FindVertex(this.VisibilityBorderIntersect);null==s?(this.OutwardDirection==xe.GetDirections(t.point,this.VisibilityBorderIntersect)?(this.VisibilityBorderIntersect=t.point,s=t):(s=e.FindOrAddVertex(this.VisibilityBorderIntersect),e.FindOrAddEdge(s,t,this.InitialWeight)),this.ExtendEdgeChain(e,s,t,n,i)):this.ExtendEdgeChain(e,s,s,n,i)}ExtendEdgeChain(e,t,n,i,s){e.ExtendEdgeChainVRLPB(n,i,this.MaxVisibilitySegment,this.pointAndCrossingsList,this.IsOverlapped);const o=e.FindOrAddVertex(this.UnpaddedBorderIntersect);e.FindOrAddEdge(o,t,this.unpaddedToPaddedBorderWeight),s&&e.ConnectVertexToTargetVertex(this.ObstaclePort.CenterVertex,o,this.OutwardDirection,this.InitialWeight)}toString(){return pi.String.Format("{0} {1}~{2} {3}",this.ObstaclePort.Location,this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect,this.OutwardDirection)}}class I4{constructor(e,t){this.HasCollinearEntrances=!1,this.VisibilityRectangle=lt.mkEmpty(),this.Port=e,this.Obstacle=t,this.PortEntrances=new Array,this.Location=le.RoundPoint(this.Port.Location)}CreatePortEntrance(e,t,n){const i=new O4(this,e,t,n);this.PortEntrances.push(i),this.VisibilityRectangle.add(i.MaxVisibilitySegment.end),this.HasCollinearEntrances=this.HasCollinearEntrances||i.IsCollinearWithPort}ClearVisibility(){this.PortEntrances=[]}AddToGraph(e,t){t&&(this.CenterVertex=e.FindOrAddVertex(this.Location))}RemoveFromGraph(){this.CenterVertex=null}get LocationHasChanged(){return!k.closeDistEps(this.Location,le.RoundPoint(this.Port.Location))}get PortCurve(){return this.Port.Curve}get PortLocation(){return this.Port.Location}toString(){return this.Port+this.Obstacle.toString()}}class P4{constructor(e,t){this.maxVisibilitySegmentsAndCrossings=new Array(4),this.OutOfBoundsDirectionFromGraph=ve.None,this.GetVertex(e,t)}get Point(){return this.Vertex.point}get InitialWeight(){return this.IsOverlapped?Ht.OverlappedWeight:Ht.NormalWeight}get IsOutOfBounds(){return ve.None!=this.OutOfBoundsDirectionFromGraph}GetVertex(e,t){this.Vertex=e.FindOrAddVertex(t)}AddEdgeToAdjacentEdge(e,t,n,i){const s=Qe.SegmentIntersectionEP(t,this.Point);let o=e.VisGraph.FindVertex(s);return null!=o?this.AddToAdjacentVertex(e,o,n,i):o=e.AddEdgeToTargetEdge(this.Vertex,t,s),this.ExtendEdgeChain(e,o,n,i),o}AddToAdjacentVertex(e,t,n,i){xe.EqualPP(this.Point,t.point)||e.FindOrAddEdge(this.Vertex,t,this.InitialWeight),this.ExtendEdgeChain(e,t,n,i)}ExtendEdgeChain(e,t,n,i){let s=this.IsOverlapped;s&&(s=e.ObstacleTree.PointIsInsideAnObstaclePD(t.point,n));const o=this.GetSegmentAndCrossings(this.IsOverlapped?t:this.Vertex,n,e);e.ExtendEdgeChainVRLPB(t,i,o[0],o[1],s)}GetSegmentAndCrossings(e,t,n){const i=Je.ToIndex(t);let s=this.maxVisibilitySegmentsAndCrossings[i];if(null==s){const o={pacList:null};s=[n.ObstacleTree.CreateMaxVisibilitySegment(e.point,t,o),o.pacList],this.maxVisibilitySegmentsAndCrossings[i]=s}else xe.GetDirections(e.point,s[0].start)==t&&(s[0].start=e.point);return s}MaxVisibilityInDirectionForNonOverlappedFreePoint(e,t){return this.GetSegmentAndCrossings(this.Vertex,e,t)[0].end}AddOobEdgesFromGraphCorner(e,t){const n=xe.GetDirections(t,this.Vertex.point),i=e.VisGraph.FindVertex(t);e.ConnectVertexToTargetVertex(i,this.Vertex,n&(ve.North|ve.South),Ht.NormalWeight),e.ConnectVertexToTargetVertex(i,this.Vertex,n&(ve.East|ve.West),Ht.NormalWeight)}RemoveFromGraph(){this.Vertex=null}toString(){return this.Vertex.toString()}}class PT{constructor(e,t){this.BoundaryWidth=le.distanceEpsilon,this.Group=e,this.DirectionToInside=t}GetInteriorVertexPoint(e){return le.RoundPoint(e.add(Je.toPoint(this.DirectionToInside).mul(this.BoundaryWidth)))}toString(){return pi.String.Format("{0} {1}",this.DirectionToInside,this.Group)}}PT.BoundaryWidth=le.distanceEpsilon;class NT extends pc{constructor(e){super(),this.site=e}get Site(){return this.site}}class $S extends sg{constructor(e,t){super(t),this.Obstacle=e}}class KS extends $S{constructor(e,t){super(e,t)}}class N4{constructor(e){this.Coord=e}AddPendingPerpendicularCoord(e){null==this.pendingPerpCoords&&(this.pendingPerpCoords=new Array),this.pendingPerpCoords.push(e)}ResetForIntersections(){this.CurrentSegment=this.FirstSegment}get IsHorizontal(){return!this.FirstSegment.IsVertical}TraverseToSegmentContainingPoint(e){if(this.CurrentSegment.ContainsPoint(e))return!0;if(!xe.Equal(this.Coord,this.IsHorizontal?e.y:e.x)){for(;this.MoveNext(););return!1}for(;;){if((null==this.CurrentSegment.NextSegment||xe.GetDirections(this.CurrentSegment.End,e)==xe.GetDirections(e,this.CurrentSegment.NextSegment.Start))&&k.closeIntersections(this.CurrentSegment.End,e))return this.CurrentSegment.Update(this.CurrentSegment.Start,e),!0;if(!this.MoveNext())return!1;if(this.CurrentSegment.ContainsPoint(e))return!0;if(xe.IsPureLower(e,this.CurrentSegment.Start))return this.CurrentSegment.Update(e,this.CurrentSegment.End),!0}}MoveNext(){return this.CurrentSegment=this.CurrentSegment.NextSegment,this.HasCurrent}get HasCurrent(){return null!=this.CurrentSegment}PointIsCurrentEndAndNextStart(e){return e.equal(this.CurrentSegment.End)&&null!=this.CurrentSegment.NextSegment&&e.equal(this.CurrentSegment.NextSegment.Start)}AddPerpendicularCoord(e){const t=this.IsHorizontal?new k(e,this.Coord):new k(this.Coord,e);this.TraverseToSegmentContainingPoint(t),this.CurrentSegment.AddSparseVertexCoord(e)}toString(){return null==this.FirstSegment?"-0- "+this.Coord:this.IsHorizontal?"(H) Y == "+this.Coord:"(V) X == "}AppendScanSegment(e){null==this.FirstSegment?this.FirstSegment=e:this.CurrentSegment.NextSegment=e,this.CurrentSegment=e}AddPendingPerpendicularCoordsToScanSegments(){if(null!=this.pendingPerpCoords){this.ResetForIntersections();for(const e of this.pendingPerpCoords)this.AddPerpendicularCoord(e)}}}class mL{constructor(e,t){this.CurrentSlotIndex=0,this.vector=[],this.IsHorizontal=t;const n=Array.from(e).sort((i,s)=>i>s?1:i<s?-1:0);for(const i of n)this.vector.push(new N4(i))}get Length(){return this.vector.length}get CurrentSlot(){return this.vector[this.CurrentSlotIndex]}Item(e){return this.vector[e]}CreateScanSegment(e,t,n,i){this.CurrentSlot.AppendScanSegment(new Ht(e,t,n,i))}ScanSegmentsCompleteForCurrentSlot(){this.CurrentSlotIndex++}ScanSegmentsComplete(){for(const e of this.vector)e.AddPendingPerpendicularCoordsToScanSegments()}Items(){return this.vector}ResetForIntersections(){for(const e of this.vector)e.ResetForIntersections()}FindNearest(e,t){let n=0,i=this.vector.length-1;if(e<=this.vector[n].Coord)return n;if(e>=this.vector[i].Coord)return i;for(;i-n>2;){const s=n+(i-n>>1),o=this.vector[s];if(e<o.Coord)i=s;else{if(!(e>o.Coord))return s;n=s}}for(n++;n<=i;n++){const s=this.vector[n];if(e<s.Coord)return t>0?n:n-1;if(e==s.Coord)break}return n}CreateSparseVerticesAndEdges(e){for(const t of this.vector){t.ResetForIntersections();for(let n=t.FirstSegment;null!=n;n=n.NextSegment)n.CreateSparseVerticesAndEdges(e)}}GetParallelCoord(e){return this.IsHorizontal?e.y:e.x}GetPerpendicularCoord(e){return this.IsHorizontal?e.x:e.y}ConnectAdjoiningSegmentEndpoints(){for(const e of this.vector){e.ResetForIntersections();let t=e.FirstSegment;for(let n=t.NextSegment;null!=n;n=n.NextSegment){if(n.HasSparsePerpendicularCoords&&t.HasSparsePerpendicularCoords&&n.Start==t.End){const i=this.GetPerpendicularCoord(n.Start);t.AddSparseEndpoint(i),n.AddSparseEndpoint(i)}t=n}}}toString(){return(this.IsHorizontal?"(H) count":"(V) count == ")+this.vector.length}}class id extends pc{constructor(e,t,n){super(),this.InitialObstacle=e,this.ReflectingObstacle=t,this.site=n}static mk(e,t,n){const i=new id(e.ReflectingObstacle,t,n);return i.PreviousSite=e,i}IsStaircaseStep(e){return this.InitialObstacle==e}get Site(){return this.site}}class yL{constructor(){this.eventTree=new mT((e,t)=>this.Compare(e,t))}Reset(e){this.scanDirection=e}Enqueue(e){this.eventTree.Enqueue(e)}Dequeue(){return this.eventTree.Dequeue()}get Count(){return this.eventTree.Count}Compare(e,t){if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;let n=this.scanDirection.ComparePerpCoord(e.Site,t.Site);return n||(n=(e instanceof id?0:1)-(t instanceof id?0:1),n||this.scanDirection.CompareScanCoord(e.Site,t.Site))}}class EL{constructor(){this.pointCrossingMap=new Vs,this.pointList=new Array}AddIntersection(e,t,n){let i=this.pointCrossingMap.get(e);i||(i=new Array,this.pointCrossingMap.set(e,i));const s=i.length;for(let a=0;a<s;a++){const l=i[a];if(l.Group==t)return l}const o=new PT(t,n);return i.push(o),o}Clear(){this.pointCrossingMap.clear()}GetOrderedListBetween(e,t){if(0==this.pointCrossingMap.size)return null;if(xe.ComparePP(e,t)>0){const s=e;e=t,t=s}this.pointList=[];for(const s of this.pointCrossingMap.keys())xe.ComparePP(s,e)>=0&&xe.ComparePP(s,t)<=0&&this.pointList.push(s);this.pointList.sort((s,o)=>s.compareTo(o));const n=new By,i=this.pointList.length;for(let s=0;s<i;s++){const o=this.pointList[s];n.Add(o,this.pointCrossingMap.get(o))}return n}toString(){return pi.String.Format("{0}",this.pointCrossingMap.size)}}class wL extends id{constructor(e,t,n){super(e.ReflectingObstacle,t.Obstacle,n),this.Side=t}}class _4{constructor(e){this.staleSites=new Array,this.scanDirection=e,this.eventTree=new uo((t,n)=>this.CompareBB(t,n)),this.findFirstPred=t=>this.CompareToFindFirstPoint(t.Site)>=0}Add(e){this.eventTree.insert(e)}MarkStaleSite(e){this.staleSites.push(e)}RemoveStaleSites(){const e=this.staleSites.length;if(e>0){for(let t=0;t<e;t++)this.RemoveExact(this.staleSites[t]);this.staleSites=[]}}RemoveSitesForFlatBottom(e,t){for(let n=this.FindFirstInRange(e,t);null!=n;n=this.FindNextInRange(n,t))this.MarkStaleSite(n.item);this.RemoveStaleSites()}Find(e){return this.FindFirstInRange(e,e)}RemoveExact(e){const t=this.eventTree.find(e);return null!=t&&t.item.Site==e.Site&&(this.eventTree.deleteNodeInternal(t),!0)}FindFirstInRange(e,t){this.findFirstPoint=e;const n=this.eventTree.findFirst(this.findFirstPred);return null!=n&&this.Compare(n.item.Site,t)<=0?n:null}CompareToFindFirstPoint(e){return this.Compare(e,this.findFirstPoint)}FindNextInRange(e,t){const n=this.eventTree.next(e);return null!=n&&this.Compare(n.item.Site,t)<=0?n:null}CompareBB(e,t){return this.scanDirection.CompareScanCoord(e.Site,t.Site)}Compare(e,t){return this.scanDirection.CompareScanCoord(e,t)}}class vL extends $S{constructor(e,t){super(e,t)}}class SL extends $S{constructor(e,t){super(e,t)}}class AL extends $S{constructor(e,t){super(e,t)}}class bL extends id{constructor(e,t,n){super(e.ReflectingObstacle,t.obstacle,n),this.Side=t}}class CL{get LowNeighborSide(){return null==this.LowNeighbor?null:this.LowNeighbor.item}get HighNeighborSide(){return null==this.HighNeighbor?null:this.HighNeighbor.item}Clear(){this.LowNeighbor=null,this.LowOverlapEnd=null,this.GroupSideInterveningBeforeLowNeighbor=null,this.HighNeighbor=null,this.HighOverlapEnd=null,this.GroupSideInterveningBeforeHighNeighbor=null}SetSides(e,t,n,i){if(Qe.IsAscending(e))return this.HighNeighbor=t,this.HighOverlapEnd=n,void(this.GroupSideInterveningBeforeHighNeighbor=i);this.LowNeighbor=t,this.LowOverlapEnd=n,this.GroupSideInterveningBeforeLowNeighbor=i}}class RL{constructor(e,t){this.Polyline=e,this.Obstacles=Array.from(t),this.PrimaryObstacle=this.Obstacles[0],vl.RoundVerticesAndSimplify(this.Polyline)}}class hg{static MungeClosestIntersectionInfo(e,t,n){const i=t.seg1.boundingBox,s=le.RoundPoint(t.x).clone();return n?new k(hg.MungeIntersect(e.x,s.x,i.left,i.right),s.y):new k(s.x,hg.MungeIntersect(e.y,s.y,i.bottom,i.top))}static MungeIntersect(e,t,n,i){if(e<t){const s=Math.min(n,i);t<s&&(t=s)}else if(e>t){const s=Math.max(n,i);t>s&&(t=s)}return le.RoundDouble(t)}}class hr{constructor(){this.CurrentGroupBoundaryCrossingMap=new EL,this.overlapPairs=new Ma,this.hasOverlaps=!1,this.lookupIntPair=new fn(-1,-1)}get GraphBox(){return this.Root.irect}Init(e,t,n){this.CreateObstacleListAndOrdinals(e),this.AncestorSets=t,this.CreateRoot(),this.shapeIdToObstacleMap=n}CreateObstacleListAndOrdinals(e){this.allObstacles=Array.from(e);let t=vl.FirstNonSentinelOrdinal;for(const n of this.allObstacles)n.Ordinal=t++}OrdinalToObstacle(e){return this.allObstacles[e-vl.FirstNonSentinelOrdinal]}CreateRoot(){this.Root=hr.CalculateHierarchy(this.GetAllObstacles()),this.OverlapsExist()&&(this.AccreteClumps(),this.AccreteConvexHulls(),this.GrowGroupsToAccommodateOverlaps(),this.Root=hr.CalculateHierarchy(this.GetAllObstacles().filter(e=>e.IsPrimaryObstacle)))}OverlapsExist(){return null!=this.Root&&(es(this.Root,this.Root,(e,t)=>this.CheckForInitialOverlaps(e,t)),this.hasOverlaps)}OverlapPairAlreadyFound(e,t){return this.lookupIntPair.x=t.Ordinal,this.lookupIntPair.y=e.Ordinal,this.overlapPairs.has(this.lookupIntPair)}CheckForInitialOverlaps(e,t){if(this.hasOverlaps)return;const n={bIsInsideA:!1,aIsInsideB:!1};hr.ObstaclesIntersect(e,t,n)?this.hasOverlaps=!0:!n.aIsInsideB&&!n.bIsInsideA||e.IsGroup&&t.IsGroup||e.IsGroup&&n.bIsInsideA||t.IsGroup&&n.aIsInsideB||(this.hasOverlaps=!0)}AccreteClumps(){this.AccumulateObstaclesForClumps(),this.CreateClumps()}AccreteConvexHulls(){for(;;)if(this.AccumulateObstaclesForConvexHulls(),!this.CreateConvexHulls())return}static CalculateHierarchy(e){return Tr(Array.from(e).map(n=>gi(n,n.VisibilityBoundingBox)))}AccumulateObstaclesForClumps(){this.overlapPairs.clear();const e=hr.CalculateHierarchy(this.GetAllObstacles().filter(t=>!t.IsGroup&&t.IsRectangle));null!=e&&ho(e,e,(t,n)=>this.EvaluateOverlappedPairForClump(t,n))}EvaluateOverlappedPairForClump(e,t){if(e==t||this.OverlapPairAlreadyFound(e,t))return;const n={bIsInsideA:!1,aIsInsideB:!1};!hr.ObstaclesIntersect(e,t,n)&&!n.aIsInsideB&&!n.bIsInsideA||this.overlapPairs.add(new fn(e.Ordinal,t.Ordinal))}AccumulateObstaclesForConvexHulls(){this.overlapPairs.clear();const e=hr.CalculateHierarchy(this.GetAllObstacles().filter(t=>t.IsPrimaryObstacle&&!t.IsGroup));null!=e&&ho(e,e,(t,n)=>this.EvaluateOverlappedPairForConvexHull(t,n))}EvaluateOverlappedPairForConvexHull(e,t){if(e==t||this.OverlapPairAlreadyFound(e,t))return;const n={bIsInsideA:!1,aIsInsideB:!1};!hr.ObstaclesIntersect(e,t,n)&&!n.aIsInsideB&&!n.bIsInsideA||!e.IsInConvexHull&&!t.IsInConvexHull&&e.IsRectangle&&t.IsRectangle||(this.overlapPairs.add(new fn(e.Ordinal,t.Ordinal)),this.AddClumpToConvexHull(e),this.AddClumpToConvexHull(t),this.AddConvexHullToConvexHull(e),this.AddConvexHullToConvexHull(t))}GrowGroupsToAccommodateOverlaps(){for(;;)if(this.AccumulateObstaclesForGroupOverlaps(),!this.GrowGroupsToResolveOverlaps())return}AccumulateObstaclesForGroupOverlaps(){const e=hr.CalculateHierarchy(this.GetAllObstacles().filter(n=>n.IsGroup)),t=hr.CalculateHierarchy(this.GetAllObstacles().filter(n=>n.IsPrimaryObstacle));null==e||null==t||ho(e,t,(n,i)=>this.EvaluateOverlappedPairForGroup(n,i))}EvaluateOverlappedPairForGroup(e,t){if(e==t||this.OverlapPairAlreadyFound(e,t))return;const n={bIsInsideA:!1,aIsInsideB:!1},i=hr.ObstaclesIntersect(e,t,n);if(i||n.aIsInsideB||n.bIsInsideA){if(e.IsRectangle&&t.IsRectangle)return void(t.IsGroup||(n.aIsInsideB||hr.FirstRectangleContainsACornerOfTheOther(t.VisibilityBoundingBox,e.VisibilityBoundingBox))&&(t.OverlapsGroupCorner=!0));!i&&(t.IsGroup||n.bIsInsideA)||this.overlapPairs.add(new fn(e.Ordinal,t.Ordinal))}}static FirstRectangleContainsACornerOfTheOther(e,t){return e.contains(t.leftBottom)||e.contains(t.leftTop)||e.contains(t.rightTop)||e.contains(t.rightBottom)}static FirstPolylineStartIsInsideSecondPolyline(e,t){return fe.PointRelativeToCurveLocation(e.start,t)!=Ot.Outside}AddClumpToConvexHull(e){if(e.isOverlapped){for(const t of e.clump.filter(n=>n.Ordinal!=e.Ordinal))this.overlapPairs.add(new fn(e.Ordinal,t.Ordinal));e.clump=[]}}AddConvexHullToConvexHull(e){if(e.IsInConvexHull){for(const t of e.ConvexHull.Obstacles.filter(n=>n.Ordinal!=e.Ordinal))this.overlapPairs.add(new fn(e.Ordinal,t.Ordinal));e.ConvexHull.Obstacles=[]}}CreateClumps(){const t=by(DS(Array.from(this.overlapPairs.values())));for(const n of t){if(1==n.length)continue;const i=n.map(s=>this.OrdinalToObstacle(s));for(const s of i)s.clump=i}}CreateConvexHulls(){let e=!1;const n=by(DS(Array.from(this.overlapPairs.values())));for(const i of n){if(1==i.length)continue;e=!0;const s=i.map(this.OrdinalToObstacle),o=Iy(s,l=>Array.from(l.VisibilityPolyline)),a=new RL(Ba.createConvexHullAsClosedPolyline(o),s);for(const l of s)l.SetConvexHull(a)}return e}GrowGroupsToResolveOverlaps(){let e=!1;for(const t of this.overlapPairs.values()){e=!0;const n=this.OrdinalToObstacle(t.x),i=this.OrdinalToObstacle(t.y);hr.ResolveGroupAndGroupOverlap(n,i)||hr.ResolveGroupAndObstacleOverlap(n,i)}return this.overlapPairs.clear(),e}static ResolveGroupAndGroupOverlap(e,t){return!!t.IsGroup&&(e.VisibilityPolyline.boundingBox.area>t.VisibilityPolyline.boundingBox.area?hr.ResolveGroupAndObstacleOverlap(e,t):hr.ResolveGroupAndObstacleOverlap(t,e),!0)}static ResolveGroupAndObstacleOverlap(e,t){let n=t.looseVisibilityPolyline;hr.GrowGroupAroundLoosePolyline(e,n);const i={bIsInsideA:!1,aIsInsideB:!1};for(;hr.ObstaclesIntersect(t,e,i)||!i.aIsInsideB;)n=vl.CreateLoosePolyline(n),hr.GrowGroupAroundLoosePolyline(e,n)}static GrowGroupAroundLoosePolyline(e,t){const n=Array.from(e.VisibilityPolyline).concat(Array.from(t));e.SetConvexHull(new RL(Ba.createConvexHullAsClosedPolyline(n),[e]))}static ObstaclesIntersect(e,t,n){return fe.CurvesIntersect(e.VisibilityPolyline,t.VisibilityPolyline)?(n.aIsInsideB=!1,n.bIsInsideA=!1,!0):(n.aIsInsideB=hr.FirstPolylineStartIsInsideSecondPolyline(e.VisibilityPolyline,t.VisibilityPolyline),n.bIsInsideA=!n.aIsInsideB&&hr.FirstPolylineStartIsInsideSecondPolyline(t.VisibilityPolyline,e.VisibilityPolyline),!(e.IsRectangle&&t.IsRectangle||!hr.ObstaclesAreCloseEnoughToBeConsideredTouching(e,t,n.aIsInsideB,n.bIsInsideA)||(n.aIsInsideB=!1,n.bIsInsideA=!1,0)))}static ObstaclesAreCloseEnoughToBeConsideredTouching(e,t,n,i){if(!n&&!i)return fe.CurvesIntersect(e.looseVisibilityPolyline,t.VisibilityPolyline);const s=n?e.looseVisibilityPolyline:t.looseVisibilityPolyline,o=n?t.VisibilityPolyline:e.VisibilityPolyline;for(const a of s)if(fe.PointRelativeToCurveLocation(a,o)==Ot.Outside){const l=fe.ClosestPoint(o,a);if(!k.closeIntersections(a,l))return!0}return!1}AdjustSpatialAncestors(){if(this.SpatialAncestorsAdjusted)return!1;for(const t of this.GetAllGroups()){const n=t.VisibilityBoundingBox;for(const i of this.Root.GetNodeItemsIntersectingRectangle(n))if(i!=t&&fe.ClosedCurveInteriorsIntersect(i.VisibilityPolyline,t.VisibilityPolyline)){if(i.IsInConvexHull)for(const s of i.ConvexHull.Obstacles)this.AncestorSets.get(s.InputShape).add(t.InputShape);this.AncestorSets.get(i.InputShape).add(t.InputShape)}}let e=new Array;for(const t of this.Root.GetAllLeaves()){const n=t.VisibilityBoundingBox;e=e.concat(Array.from(this.AncestorSets.get(t.InputShape)).filter(i=>!n.intersects(this.shapeIdToObstacleMap.get(i).VisibilityBoundingBox)));for(const i of e)this.AncestorSets.get(t.InputShape).delete(i);e=[]}return this.SpatialAncestorsAdjusted=!0,!0}GetAllGroups(){return this.GetAllObstacles().filter(e=>e.IsGroup)}Clear(){this.Root=null,this.AncestorSets=null}CreateMaxVisibilitySegment(e,t,n){const i=Qe.RectangleBorderIntersect(this.GraphBox,e,t);if(xe.GetDirections(e,i)==ve.None)return n.pacList=null,Me.mkPP(e,e);const s=this.RestrictSegmentWithObstacles(e,i);return n.pacList=this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(s.start,s.end),s}GetAllObstacles(){return this.allObstacles}GetAllPrimaryObstacles(){return this.Root.GetAllLeaves()}IntersectionIsInsideAnotherObstacle(e,t,n,i){return this.insideHitTestIgnoreObstacle1=t,this.insideHitTestIgnoreObstacle2=e,this.insideHitTestScanDirection=i,null!=this.Root.FirstHitNodeWithPredicate(n,this.InsideObstacleHitTest.bind(this))}PointIsInsideAnObstaclePD(e,t){return this.PointIsInsideAnObstacle(e,ur.GetInstance(t))}PointIsInsideAnObstacle(e,t){return this.insideHitTestIgnoreObstacle1=null,this.insideHitTestIgnoreObstacle2=null,this.insideHitTestScanDirection=t,null!=this.Root.FirstHitNodeWithPredicate(e,this.InsideObstacleHitTest.bind(this))}InsideObstacleHitTest(e,t){if(t==this.insideHitTestIgnoreObstacle1||t==this.insideHitTestIgnoreObstacle2||t.IsGroup||!Qe.PointIsInRectangleInterior(e,t.VisibilityBoundingBox))return Kn.Continue;const n=Qe.RectangleBorderIntersect(t.VisibilityBoundingBox,e,this.insideHitTestScanDirection.dir).add(this.insideHitTestScanDirection.DirectionAsPoint),i=Qe.RectangleBorderIntersect(t.VisibilityBoundingBox,e,this.insideHitTestScanDirection.OppositeDirection).sub(this.insideHitTestScanDirection.DirectionAsPoint),s=Me.mkPP(i,n),o=fe.getAllIntersections(s,t.VisibilityPolyline,!0);if(2==o.length){const a=le.RoundPoint(o[0].x),l=le.RoundPoint(o[1].x);if(!xe.EqualPP(e,a)&&!xe.EqualPP(e,l)&&e.compareTo(a)!=e.compareTo(l)&&!an(Math.floor(o[0].par1),Math.floor(o[1].par1)))return Kn.Stop}return Kn.Continue}SegmentCrossesAnObstacle(e,t){this.stopAtGroups=!0,this.wantGroupCrossings=!1;const n=this.RestrictSegmentPrivate(e,t);return!xe.EqualPP(n.end,t)}SegmentCrossesANonGroupObstacle(e,t){this.stopAtGroups=!1,this.wantGroupCrossings=!1;const n=this.RestrictSegmentPrivate(e,t);return!xe.EqualPP(n.end,t)}RestrictSegmentWithObstacles(e,t){return this.stopAtGroups=!1,this.wantGroupCrossings=!0,this.RestrictSegmentPrivate(e,t)}RestrictSegmentPrivate(e,t){return this.GetRestrictedIntersectionTestSegment(e,t),this.currentRestrictedRay=Me.mkPP(e,t),this.restrictedRayLengthSquared=e.sub(t).lengthSquared,this.CurrentGroupBoundaryCrossingMap.Clear(),this.RecurseRestrictRayWithObstacles(this.Root),this.currentRestrictedRay}GetRestrictedIntersectionTestSegment(e,t){const n=xe.GetDirections(e,t),s=ve.West==n?this.GraphBox.left:ve.East==n?this.GraphBox.right:t.x,a=ve.South==n?this.GraphBox.bottom:ve.North==n?this.GraphBox.top:e.y;this.restrictedIntersectionTestSegment=Me.mkPP(new k(ve.West==n?this.GraphBox.right:ve.East==n?this.GraphBox.left:e.x,ve.South==n?2*this.GraphBox.top:ve.North==n?this.GraphBox.bottom:e.y),new k(s,a))}RecurseRestrictRayWithObstacles(e){if(!Qe.RectangleInteriorsIntersect(this.currentRestrictedRay.boundingBox,e.irect))return;const t=e.UserData;if(null!=t){const n=fe.getAllIntersections(this.restrictedIntersectionTestSegment,t.VisibilityPolyline,!0);return!t.IsGroup||this.stopAtGroups?void this.LookForCloserNonGroupIntersectionToRestrictRay(n):void(this.wantGroupCrossings&&this.AddGroupIntersectionsToRestrictedRay(t,n))}this.RecurseRestrictRayWithObstacles(e.Left),this.RecurseRestrictRayWithObstacles(e.Right)}LookForCloserNonGroupIntersectionToRestrictRay(e){let t=0,n=null,i=this.restrictedRayLengthSquared;const s=xe.GetDirections(this.restrictedIntersectionTestSegment.start,this.restrictedIntersectionTestSegment.end);for(const o of e){const a=le.RoundPoint(o.x),l=xe.GetDirections(this.currentRestrictedRay.start,a);if(l==Je.OppositeDir(s))continue;if(t++,ve.None==l){i=0,n=o;continue}const c=a.sub(this.currentRestrictedRay.start).lengthSquared;if(c<i){if(o.x.sub(this.currentRestrictedRay.start).lengthSquared<le.squareOfDistanceEpsilon)continue;i=c,n=o}}if(null!=n){if(1==t){const o=le.RoundPoint(n.x);if(k.closeIntersections(o,this.currentRestrictedRay.start)||k.closeIntersections(o,this.currentRestrictedRay.end))return}this.restrictedRayLengthSquared=i,this.currentRestrictedRay.end=hg.MungeClosestIntersectionInfo(this.currentRestrictedRay.start,n,!Qe.IsVerticalPP(this.currentRestrictedRay.start,this.currentRestrictedRay.end))}}AddGroupIntersectionsToRestrictedRay(e,t){for(const n of t){const i=le.RoundPoint(n.x);if(i.sub(this.currentRestrictedRay.start).lengthSquared>this.restrictedRayLengthSquared)continue;const o=xe.GetDirections(this.currentRestrictedRay.start,this.currentRestrictedRay.end);let c=o;0!=(Je.VectorDirection(n.seg1.derivative(n.par1))&Je.RotateRight(o))&&(c=Je.OppositeDir(c)),this.CurrentGroupBoundaryCrossingMap.AddIntersection(i,e,c)}}}class D4{constructor(e,t){this.scanDirection=e,this.SideTree=new uo((n,i)=>this.Compare(n,i)),this.linePositionAtLastInsertOrRemove=t}Insert(e,t){return this.linePositionAtLastInsertOrRemove=t,this.SideTree.insert(e)}get Count(){return this.SideTree.count}Remove(e,t){this.linePositionAtLastInsertOrRemove=t,this.SideTree.remove(e)}Find(e){return-1==this.scanDirection.ComparePerpCoord(this.linePositionAtLastInsertOrRemove,e.Start)?null:this.SideTree.find(e)}NextLowB(e){return this.NextLowR(this.Find(e))}NextLowR(e){return this.SideTree.previous(e)}NextHighB(e){return this.NextHighR(this.Find(e))}NextHighR(e){return this.SideTree.next(e)}Next(e,t){return Qe.IsAscending(e)?this.SideTree.next(t):this.SideTree.previous(t)}Lowest(){return this.SideTree.treeMinimum()}Compare(e,t){if(e.Obstacle==t.Obstacle)return e==t?0:e instanceof ka?-1:1;const n=_T.ScanLineIntersectSidePBS(this.linePositionAtLastInsertOrRemove,e,this.scanDirection),i=_T.ScanLineIntersectSidePBS(this.linePositionAtLastInsertOrRemove,t,this.scanDirection);let s=n.compareTo(i);return 0==s&&(s=function hW(r,e){return(r?1:0)-(e?1:0)}(e instanceof ka,t instanceof ka),0==s&&(s=$n(e.Obstacle.Ordinal,t.Obstacle.Ordinal))),s}}class JS{constructor(e){this.lookupSegment=Ht.mk(new k(0,0),new k(0,1)),this.ScanDirection=e,this.segmentTree=new uo((t,n)=>this.Compare(t,n)),this.findIntersectorPred=t=>this.CompareIntersector(t),this.findPointPred=t=>this.CompareToPoint(t)}get Segments(){return this.segmentTree.allNodes()}InsertUnique(e){this.AssertValidSegmentForInsertion(e);const t=this.segmentTree.find(e);return null!=t?t:this.segmentTree.insert(e)}AssertValidSegmentForInsertion(e){}Remove(e){this.segmentTree.remove(e)}Find(e,t){this.lookupSegment.Update(e,t);const n=this.segmentTree.find(this.lookupSegment);return null!=n&&xe.EqualPP(n.item.End,t)?n.item:null}FindLowestIntersector(e,t){const n=this.FindLowestIntersectorNode(e,t);return null!=n?n.item:null}FindLowestIntersectorNode(e,t){this.lookupSegment.Update(e,e);let n=this.segmentTree.findLast(this.findIntersectorPred);if(xe.EqualPP(e,t))null!=n&&this.ScanDirection.Compare(n.item.End,e)<0&&(n=null);else for(this.lookupSegment.Update(e,t);null!=n&&!n.item.IntersectsSegment(this.lookupSegment);){if(this.ScanDirection.Compare(n.item.Start,t)>0)return null;n=this.segmentTree.next(n)}return n}FindHighestIntersector(e,t){this.lookupSegment.Update(t,t);let n=this.segmentTree.findLast(this.findIntersectorPred);if(xe.EqualPP(e,t))null!=n&&this.ScanDirection.Compare(n.item.End,e)<0&&(n=null);else for(this.lookupSegment.Update(e,t);null!=n&&!n.item.IntersectsSegment(this.lookupSegment);){if(this.ScanDirection.Compare(n.item.End,e)<0)return null;n=this.segmentTree.previous(n)}return null!=n?n.item:null}CompareIntersector(e){return this.ScanDirection.Compare(e.Start,this.lookupSegment.Start)<=0}FindSegmentContainingPoint(e,t){return this.FindSegmentOverlappingPoints(e,e,t)}FindSegmentOverlappingPoints(e,t,n){this.lookupSegment.Update(e,t);const i=this.segmentTree.findFirst(this.findPointPred);if(null!=i){const s=i.item;if(this.ScanDirection.Compare(s.Start,t)<=0)return s}return null}CompareToPoint(e){return this.ScanDirection.Compare(e.End,this.lookupSegment.Start)>=0}MergeAndRemoveNextNode(e,t){return-1==this.ScanDirection.Compare(e.End,t.item.End)&&e.Update(e.Start,t.item.End),e.MergeGroupBoundaryCrossingList(t.item.GroupBoundaryPointAndCrossingsList),this.segmentTree.deleteNodeInternal(t),this.segmentTree.find(e)}MergeSegments(){if(this.segmentTree.count<2)return;let e=this.segmentTree.treeMinimum(),t=this.segmentTree.next(e);for(;null!=t;t=this.segmentTree.next(e))switch(this.ScanDirection.Compare(t.item.Start,e.item.End)){case 1:e=t;break;case 0:t.item.IsOverlapped==e.item.IsOverlapped?e=this.MergeAndRemoveNextNode(e.item,t):(e.item.NeedEndOverlapVertex=!0,t.item.NeedStartOverlapVertex=!0,e=t);break;default:if(e.item.IsOverlapped!=t.item.IsOverlapped){if(e.item.IsOverlapped)e.item.Start==t.item.Start?e=this.MergeAndRemoveNextNode(t.item,e):(e.item.Update(e.item.Start,t.item.Start),e=t);else if(e.item.End==t.item.End)e=this.MergeAndRemoveNextNode(e.item,t);else{const i=t.item,s=e.item;this.segmentTree.deleteNodeInternal(t),i.Update(s.End,i.End),this.segmentTree.insert(i),i.TrimGroupBoundaryCrossingList(),e=this.segmentTree.find(s)}break}e=this.MergeAndRemoveNextNode(e.item,t)}}Compare(e,t){if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;let n=this.ScanDirection.Compare(e.Start,t.Start);return 0==n&&(n=-1*this.ScanDirection.Compare(e.End,t.End)),n}}class x4 extends og{constructor(e){super(e)}SetVertexEntry(e){null==this.VertexEntries&&(this.VertexEntries=new Array(4)),this.VertexEntries[Je.ToIndex(e.Direction)]=e}RemoveVertexEntries(){this.VertexEntries=null}}let _T=(()=>{class r{constructor(t){this.ObstacleTree=new hr,this.CurrentGroupBoundaryCrossingMap=new EL,this.LowNeighborSides=new CL,this.HighNeighborSides=new CL,this.ScanDirection=ur.HorizontalInstance,this.eventQueue=new yL,this.HorizontalScanSegments=new JS(ur.HorizontalInstance),this.VerticalScanSegments=new JS(ur.VerticalInstance),this.wantReflections=t}get ParallelScanSegments(){return this.ScanDirection.IsHorizontal?this.HorizontalScanSegments:this.VerticalScanSegments}get PerpendicularScanSegments(){return this.ScanDirection.IsHorizontal?this.VerticalScanSegments:this.HorizontalScanSegments}static NewVisibilityGraph(){const t=new Or;return t.VertexFactory=n=>new x4(n),t}GenerateVisibilityGraph(){if(null==this.ObstacleTree.Root)return;this.InitializeEventQueue(ur.HorizontalInstance);let t=vl.FirstSentinelOrdinal,n=new k(this.ObstacleTree.GraphBox.left-r.SentinelOffset,this.ObstacleTree.GraphBox.bottom-r.SentinelOffset),i=new k(this.ObstacleTree.GraphBox.left-r.SentinelOffset,this.ObstacleTree.GraphBox.top+r.SentinelOffset),s=vl.CreateSentinel(n,i,this.ScanDirection,t++);this.scanLine.Insert(s.ActiveHighSide,this.ObstacleTree.GraphBox.leftBottom),n=new k(this.ObstacleTree.GraphBox.right+r.SentinelOffset,this.ObstacleTree.GraphBox.bottom-r.SentinelOffset),i=new k(this.ObstacleTree.GraphBox.right+r.SentinelOffset,this.ObstacleTree.GraphBox.top+r.SentinelOffset),s=vl.CreateSentinel(n,i,this.ScanDirection,t++),this.scanLine.Insert(s.ActiveLowSide,this.ObstacleTree.GraphBox.leftBottom),this.ProcessEvents(),this.InitializeEventQueue(ur.VerticalInstance),n=new k(this.ObstacleTree.GraphBox.left-r.SentinelOffset,this.ObstacleTree.GraphBox.bottom-r.SentinelOffset),i=new k(this.ObstacleTree.GraphBox.right+r.SentinelOffset,this.ObstacleTree.GraphBox.bottom-r.SentinelOffset),s=vl.CreateSentinel(n,i,this.ScanDirection,t++),this.scanLine.Insert(s.ActiveHighSide,this.ObstacleTree.GraphBox.leftBottom),n=new k(this.ObstacleTree.GraphBox.left-r.SentinelOffset,this.ObstacleTree.GraphBox.top+r.SentinelOffset),i=new k(this.ObstacleTree.GraphBox.right+r.SentinelOffset,this.ObstacleTree.GraphBox.top+r.SentinelOffset),s=vl.CreateSentinel(n,i,this.ScanDirection,t),this.scanLine.Insert(s.ActiveLowSide,this.ObstacleTree.GraphBox.leftBottom),this.ProcessEvents()}static ScanLineIntersectSidePBS(t,n,i){const s=n.Direction;let o=n.Start.x,a=n.Start.y;return i.IsHorizontal?(o+=s.x/s.y*(t.y-n.Start.y),o=hg.MungeIntersect(t.x,o,n.Start.x,n.End.x),a=t.y):(o=t.x,a+=s.y/s.x*(t.x-n.Start.x),a=hg.MungeIntersect(t.y,a,n.Start.y,n.End.y)),new k(o,a)}GetOpenVertex(t){let n=t.startPoint,i=this.TraversePolylineForEvents(n),s=this.PointCompare(i.point,n.point);for(;;i=this.TraversePolylineForEvents(i)){const o=this.PointCompare(i.point,n.point);if(o<=0)n=i;else if(o>0&&s<=0)break;s=o}return n}TraversePolylineForEvents(t){return this.ScanDirection.IsHorizontal?t.nextOnPolyline:t.prevOnPolyline}InitializeEventQueue(t){this.ScanDirection=t,this.eventQueue.Reset(this.ScanDirection),this.EnqueueBottomVertexEvents(),this.scanLine=new D4(this.ScanDirection,this.ObstacleTree.GraphBox.leftBottom),this.lookaheadScan=new _4(this.ScanDirection)}EnqueueBottomVertexEvents(){for(const t of this.ObstacleTree.GetAllPrimaryObstacles()){const n=this.GetOpenVertex(t.VisibilityPolyline);this.eventQueue.Enqueue(new KS(t,n))}}IsFlat(t){return this.ScanDirection.IsFlatS(t)}IsPerpendicular(t){return this.ScanDirection.IsPerpendicularS(t)}ScanLineIntersectSide(t,n){return r.ScanLineIntersectSidePBS(t,n,this.ScanDirection)}SideReflectsUpward(t){return t instanceof ka?this.ScanDirection.Coord(t.End)>this.ScanDirection.Coord(t.Start):this.ScanDirection.Coord(t.End)<this.ScanDirection.Coord(t.Start)}SideReflectsDownward(t){return t instanceof ka?this.ScanDirection.Coord(t.End)<this.ScanDirection.Coord(t.Start):this.ScanDirection.Coord(t.End)>this.ScanDirection.Coord(t.Start)}StoreLookaheadSite(t,n,i,s){if(this.wantReflections&&!this.IsPerpendicular(n)){if(!s&&!Qe.PointIsInRectangleInterior(i,n.Obstacle.VisibilityBoundingBox))return;this.SideReflectsUpward(n)&&null==this.lookaheadScan.Find(i)&&this.lookaheadScan.Add(new id(t,n.Obstacle,i))}}LoadReflectionEvents(t){this.LoadReflectionEventsBB(t,t)}LoadReflectionEventsBB(t,n){if(null==t||this.SideReflectsUpward(t)||this.IsPerpendicular(t))return;const i=lt.mkPP(t.Start,t.End),s=lt.mkPP(n.Start,n.End);if(this.ScanDirection.IsHorizontal?!i.intersectsOnX(s):!i.intersectsOnY(s))return;const o=lt.intersect(i,s),l=o.rightTop;let c=this.lookaheadScan.FindFirstInRange(o.leftBottom,l);for(;null!=c;){const d=r.ScanLineIntersectSidePBS(c.item.Site,t,this.ScanDirection.PerpendicularInstance);this.ScanDirection.ComparePerpCoord(d,c.item.Site)>0?this.AddReflectionEvent(c.item,t,d):c.item.ReflectingObstacle!=t.Obstacle&&this.lookaheadScan.MarkStaleSite(c.item),c=this.lookaheadScan.FindNextInRange(c,l)}this.lookaheadScan.RemoveStaleSites()}AddPerpendicularReflectionSegment(t,n,i){if(this.lookaheadScan.RemoveExact(t.PreviousSite)){if(null==n)return!1;if(t.PreviousSite.IsStaircaseStep(t.ReflectingObstacle)){if(!Qe.PointIsInRectangleInterior(t.Site,t.ReflectingObstacle.VisibilityBoundingBox)||!this.InsertPerpendicularReflectionSegment(t.PreviousSite.Site,t.Site))return!1;if(null!=i&&t.IsStaircaseStep(i.Obstacle))return this.ScanLineCrossesObstacle(t.Site,i.Obstacle)}}return!1}AddParallelReflectionSegment(t,n,i,s){{const o=this.ScanLineIntersectSide(s.Site,null!=n?n:i),a=null!=n?o:s.Site,l=null!=n?s.Site:o;return null==n?n=this.scanLine.NextLowB(i).item:i=this.scanLine.NextHighB(n).item,this.InsertParallelReflectionSegment(a,l,t,n,i,s)}}AddReflectionEvent(t,n,i){this.eventQueue.Enqueue(null!=n?new bL(t,n,i):new wL(t,n,i))}AddSideToScanLine(t,n){const i=this.scanLine.Insert(t,n);return this.LoadReflectionEvents(t),i}RemoveSideFromScanLine(t,n){this.scanLine.Remove(t.item,n)}PointCompare(t,n){return this.ScanDirection.Compare(t,n)}Clear(){this.ObstacleTree.Clear(),this.eventQueue=new yL,this.HorizontalScanSegments=new JS(ur.HorizontalInstance),this.VerticalScanSegments=new JS(ur.VerticalInstance),this.VisibilityGraph=null}ProcessEvents(){for(;this.eventQueue.Count>0;){const t=this.eventQueue.Dequeue();t instanceof KS?this.ProcessEventO(t):t instanceof vL?this.ProcessEventLB(t):t instanceof SL?this.ProcessEventHB(t):t instanceof AL?this.ProcessEventCV(t):t instanceof bL?this.ProcessEventLR(t):t instanceof wL?this.ProcessEventHR(t):this.ProcessCustomEvent(t),this.LowNeighborSides.Clear(),this.HighNeighborSides.Clear()}}ProcessCustomEvent(t){}ScanLineCrossesObstacle(t,n){return this.ScanDirection.ComparePerpCoord(t,n.VisibilityBoundingBox.leftBottom)>0&&this.ScanDirection.ComparePerpCoord(t,n.VisibilityBoundingBox.rightTop)<0}FindInitialNeighborSides(t,n){n.lowNborSideNode=this.scanLine.NextLowR(t),n.highNborSideNode=this.scanLine.NextHighR(t)}FindNeighborsBRR(t,n,i){this.LowNeighborSides.Clear(),this.HighNeighborSides.Clear(),this.FindNeighbors(t,n,this.LowNeighborSides),this.FindNeighbors(t,i,this.HighNeighborSides)}FindNeighbors(t,n,i){const s=t instanceof KS?n.item.Start:n.item.End,o={lowNborSideNode:null,highNborSideNode:null};this.FindInitialNeighborSides(n,o),this.SkipToNeighbor(this.ScanDirection.OppositeDirection,n.item,s,o.lowNborSideNode,i),this.SkipToNeighbor(this.ScanDirection.Dir,n.item,s,o.highNborSideNode,i)}SkipToNeighbor(t,n,i,s,o){let a=null,l=null;for(;;s=this.scanLine.Next(t,s))if(s.item.Obstacle!=n.Obstacle){if(s.item.Obstacle.IsGroup){this.ProcessGroupSideEncounteredOnTraversalToNeighbor(s,i,t)&&null==l&&(l=s.item);continue}if(s.item instanceof Gy==Qe.IsAscending(t)){this.ScanLineCrossesObstacle(i,s.item.Obstacle)&&(a=s,l=null);continue}break}o.SetSides(t,s,a,l)}ProcessGroupSideEncounteredOnTraversalToNeighbor(t,n,i){if(!this.ScanLineCrossesObstacle(n,t.item.Obstacle))return!1;const s=t.item instanceof ka==Qe.IsAscending(i)?i:Je.OppositeDir(i),o=this.ScanLineIntersectSide(n,t.item);return this.CurrentGroupBoundaryCrossingMap.AddIntersection(o,t.item.Obstacle,s),!0}FindNeighborsAndProcessVertexEvent(t,n,i){this.CurrentGroupBoundaryCrossingMap.Clear(),this.FindNeighborsBRR(i,t,n),this.ProcessVertexEvent(t,n,i),this.CurrentGroupBoundaryCrossingMap.Clear()}ProcessEventO(t){var n,i;const s=t.Obstacle;s.CreateInitialSides(t.Vertex,this.ScanDirection),this.AddSideToScanLine(s.ActiveLowSide,t.Site);const o=this.AddSideToScanLine(s.ActiveHighSide,t.Site),a=this.scanLine.Find(s.ActiveLowSide);this.FindNeighborsAndProcessVertexEvent(a,o,t);const l=null!==(n=this.LowNeighborSides.GroupSideInterveningBeforeLowNeighbor)&&void 0!==n?n:this.LowNeighborSides.LowNeighborSide;this.SideReflectsUpward(l)&&this.LoadReflectionEvents(s.ActiveLowSide);const c=null!==(i=this.HighNeighborSides.GroupSideInterveningBeforeHighNeighbor)&&void 0!==i?i:this.HighNeighborSides.HighNeighborSide;if(this.SideReflectsUpward(c)&&this.LoadReflectionEvents(s.ActiveHighSide),s.ActiveHighSide.Start!=s.ActiveLowSide.Start){const d=new Gy(s,t.Vertex,this.ScanDirection);this.lookaheadScan.RemoveSitesForFlatBottom(d.Start,d.End)}this.EnqueueLowBendVertexEvent(s.ActiveLowSide),this.EnqueueHighBendOrCloseVertexEvent(s.ActiveHighSide)}ProcessEventLB(t){const n=t.Obstacle,i=new ka(n,t.Vertex,this.ScanDirection);this.ScanDirection.ComparePerpCoord(i.End,i.Start)>0&&(this.RemoveSideFromScanLine(this.scanLine.Find(n.ActiveLowSide),t.Site),this.AddSideToScanLine(i,t.Site),n.ActiveLowSide=i,this.EnqueueLowBendVertexEvent(i))}EnqueueLowBendVertexEvent(t){this.eventQueue.Enqueue(new vL(t.Obstacle,t.EndVertex))}ProcessEventHB(t){const n=t.Obstacle,i=new Gy(n,t.Vertex,this.ScanDirection);this.RemoveSideFromScanLine(this.scanLine.Find(n.ActiveHighSide),t.Site);const s=this.AddSideToScanLine(i,t.Site);if(n.ActiveHighSide=i,this.EnqueueHighBendOrCloseVertexEvent(n.ActiveHighSide),this.wantReflections&&this.ScanDirection.IsHorizontal&&i.Start.x==n.VisibilityBoundingBox.right&&this.SideReflectsUpward(i)){const o=this.scanLine.NextHighR(s);o.item instanceof ka&&this.SideReflectsDownward(o.item)&&(!n.isOverlapped||!this.ObstacleTree.PointIsInsideAnObstacle(i.Start,this.ScanDirection))&&(this.StoreLookaheadSite(o.item.Obstacle,i,i.Start,!0),this.LoadReflectionEvents(o.item))}}EnqueueHighBendOrCloseVertexEvent(t){const n=t.Obstacle;this.ScanDirection.ComparePerpCoord((this.ScanDirection.IsHorizontal?t.EndVertex.prevOnPolyline:t.EndVertex.nextOnPolyline).point,t.End)>0?this.eventQueue.Enqueue(new SL(n,t.EndVertex)):this.eventQueue.Enqueue(new AL(n,t.EndVertex))}CreateCloseEventSegmentsAndFindNeighbors(t){const n=t.Obstacle;let i=this.scanLine.Find(n.ActiveLowSide),s=this.scanLine.Find(n.ActiveHighSide);if(1==this.scanLine.Compare(n.ActiveLowSide,n.ActiveHighSide)){const o=i;i=s,s=o}if(this.FindNeighborsAndProcessVertexEvent(i,s,t),this.wantReflections&&n.isOverlapped)for(let o=this.scanLine.NextHighR(i);o.item!=s.item;o=this.scanLine.NextHighR(o))this.LoadReflectionEvents(o.item);this.scanLine.Remove(n.ActiveLowSide,t.Site),this.scanLine.Remove(n.ActiveHighSide,t.Site)}ProcessEventCV(t){this.CreateCloseEventSegmentsAndFindNeighbors(t);const i=this.HighNeighborSides.HighNeighbor.item,s=t.Obstacle;this.LoadReflectionEvents(this.LowNeighborSides.LowNeighbor.item),this.LoadReflectionEvents(i),s.Close()}ProcessEventLR(t){const n=t.Side.Obstacle,i=this.scanLine.NextLowB(t.Side).item;this.AddPerpendicularReflectionSegment(t,t.Side,i)&&this.AddParallelReflectionSegment(n,i,null,t)&&this.LoadReflectionEvents(n.ActiveLowSide)}ProcessEventHR(t){const n=t.Side.Obstacle,i=this.scanLine.NextHighB(t.Side).item;this.AddPerpendicularReflectionSegment(t,t.Side,i)&&this.AddParallelReflectionSegment(n,null,i,t)&&this.LoadReflectionEvents(n.ActiveHighSide)}MakeInBoundsLocation(t){const n=Math.max(t.x,this.ObstacleTree.GraphBox.left),i=Math.max(t.y,this.ObstacleTree.GraphBox.bottom);return new k(Math.min(n,this.ObstacleTree.GraphBox.right),Math.min(i,this.ObstacleTree.GraphBox.top))}IsInBoundsV(t){return this.IsInBoundsP(t.point)}IsInBoundsP(t){return xe.EqualPP(t,this.MakeInBoundsLocation(t))}}return r.SentinelOffset=1,r})();class po extends _T{constructor(){super(!1),this.horizontalVertexPoints=new Fr,this.verticalVertexPoints=new Fr,this.boundingBoxSteinerPoints=new Fr,this.xCoordAccumulator=new Set,this.yCoordAccumulator=new Set,this.horizontalCoordMap=new Map,this.verticalCoordMap=new Map}Clear(){super.Clear(),this.Cleanup()}Cleanup(){this.horizontalVertexPoints.clear(),this.verticalVertexPoints.clear(),this.boundingBoxSteinerPoints.clear(),this.xCoordAccumulator.clear(),this.yCoordAccumulator.clear(),this.horizontalCoordMap.clear(),this.verticalCoordMap.clear()}GenerateVisibilityGraph(){this.AccumulateVertexCoords(),this.CreateSegmentVectorsAndPopulateCoordinateMaps(),this.RunScanLineToCreateSegmentsAndBoundingBoxSteinerPoints(),this.GenerateSparseIntersectionsFromVertexPoints(),this.CreateScanSegmentTrees(),this.Cleanup()}AccumulateVertexCoords(){for(const e of this.ObstacleTree.GetAllObstacles())this.xCoordAccumulator.add(e.VisibilityBoundingBox.left),this.xCoordAccumulator.add(e.VisibilityBoundingBox.right),this.yCoordAccumulator.add(e.VisibilityBoundingBox.top),this.yCoordAccumulator.add(e.VisibilityBoundingBox.bottom)}CreateSegmentVectorsAndPopulateCoordinateMaps(){this.horizontalScanSegmentVector=new mL(this.yCoordAccumulator,!0),this.verticalScanSegmentVector=new mL(this.xCoordAccumulator,!1);for(let e=0;e<this.horizontalScanSegmentVector.Length;e++)this.horizontalCoordMap.set(this.horizontalScanSegmentVector.Item(e).Coord,e);for(let e=0;e<this.verticalScanSegmentVector.Length;e++)this.verticalCoordMap.set(this.verticalScanSegmentVector.Item(e).Coord,e)}RunScanLineToCreateSegmentsAndBoundingBoxSteinerPoints(){super.GenerateVisibilityGraph(),this.horizontalScanSegmentVector.ScanSegmentsComplete(),this.verticalScanSegmentVector.ScanSegmentsComplete(),this.xCoordAccumulator.clear(),this.yCoordAccumulator.clear()}InitializeEventQueue(e){super.InitializeEventQueue(e),this.SetVectorsAndCoordMaps(e),this.AddAxisCoordinateEvents(e)}AddAxisCoordinateEvents(e){if(e.IsHorizontal)for(const t of this.yCoordAccumulator)this.eventQueue.Enqueue(new NT(new k(this.ObstacleTree.GraphBox.left-po.SentinelOffset,t)));else for(const t of this.xCoordAccumulator)this.eventQueue.Enqueue(new NT(new k(t,this.ObstacleTree.GraphBox.bottom-po.SentinelOffset)))}ProcessCustomEvent(e){this.ProcessAxisCoordinate(e)||this.ProcessCustomEvent(e)}ProcessAxisCoordinate(e){return e instanceof NT&&(this.CreateScanSegmentsOnAxisCoordinate(e.Site),!0)}InsertPerpendicularReflectionSegment(e,t){return!1}InsertParallelReflectionSegment(e,t,n,i,s,o){return!1}ProcessVertexEvent(e,t,n){const i=this.ScanDirection.IsHorizontal?this.horizontalVertexPoints:this.verticalVertexPoints;i.add(n.Site);const s=this.LowNeighborSides.LowNeighbor.item,o=this.HighNeighborSides.HighNeighbor.item,a=this.ScanDirection.Dir,l=this.ScanDirection.OppositeDirection,c=this.ScanLineIntersectSide(n.Site,s),d=this.ScanLineIntersectSide(n.Site,o);if(this.ObstacleTree.GraphBox.contains(c)){const N=Qe.RectangleBorderIntersect(s.Obstacle.VisibilityBoundingBox,c,a);xe.IsPureLower(N,n.Site)&&this.boundingBoxSteinerPoints.add(N)}if(this.ObstacleTree.GraphBox.contains(d)){const N=Qe.RectangleBorderIntersect(o.Obstacle.VisibilityBoundingBox,d,l);xe.IsPureLower(n.Site,N)&&this.boundingBoxSteinerPoints.add(N)}const b={lowCorner:void 0,highCorner:void 0};po.GetBoundingCorners(e.item.Obstacle.VisibilityBoundingBox,n instanceof KS,this.ScanDirection.IsHorizontal,b),(xe.IsPureLower(c,b.lowCorner)||s.Obstacle.IsInSameClump(n.Obstacle))&&i.add(b.lowCorner),(xe.IsPureLower(b.highCorner,d)||o.Obstacle.IsInSameClump(n.Obstacle))&&i.add(b.highCorner)}static GetBoundingCorners(e,t,n,i){if(t)return i.lowCorner=e.leftBottom,void(i.highCorner=n?e.rightBottom:e.leftTop);i.lowCorner=n?e.leftTop:e.rightBottom,i.highCorner=e.rightTop}CreateScanSegmentsOnAxisCoordinate(e){this.CurrentGroupBoundaryCrossingMap.Clear();const t=this.scanLine.Lowest();let n=this.scanLine.NextHighR(t),i=0,s=e,o=!1;for(;null!=n;n=this.scanLine.NextHighR(n))if(!this.SkipSide(s,n.item))if(n.item.Obstacle.IsGroup)(0==i||o)&&this.HandleGroupCrossing(e,n.item);else if(n.item instanceof ka){if(i>0){i++;continue}s=this.CreateScanSegment(s,n.item,Ht.NormalWeight),this.CurrentGroupBoundaryCrossingMap.Clear(),i=1,o=n.item.Obstacle.isOverlapped}else i++,!(i>0)&&(s=n.item.Obstacle.isOverlapped||n.item.Obstacle.OverlapsGroupCorner?this.CreateScanSegment(s,n.item,Ht.OverlappedWeight):this.ScanLineIntersectSide(s,n.item),this.CurrentGroupBoundaryCrossingMap.Clear(),o=!1);const a=this.ScanDirection.IsHorizontal?new k(this.ObstacleTree.GraphBox.right+po.SentinelOffset,s.y):new k(s.x,this.ObstacleTree.GraphBox.top+po.SentinelOffset);this.parallelSegmentVector.CreateScanSegment(s,a,Ht.NormalWeight,this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(s,a)),this.parallelSegmentVector.ScanSegmentsCompleteForCurrentSlot()}HandleGroupCrossing(e,t){if(!this.ScanLineCrossesObstacle(e,t.Obstacle))return;const n=t instanceof ka?this.ScanDirection.Dir:this.ScanDirection.OppositeDirection,i=this.ScanLineIntersectSide(e,t),s=this.CurrentGroupBoundaryCrossingMap.AddIntersection(i,t.Obstacle,n);this.AddPerpendicularCoordForGroupCrossing(i);const o=s.GetInteriorVertexPoint(i);this.AddPerpendicularCoordForGroupCrossing(o)}AddPerpendicularCoordForGroupCrossing(e){const t=this.FindPerpendicularSlot(e,0);-1!=t&&this.perpendicularSegmentVector.Item(t).AddPendingPerpendicularCoord(this.parallelSegmentVector.CurrentSlot.Coord)}SkipSide(e,t){if(t.Obstacle.IsSentinel)return!0;const n=t.Obstacle.VisibilityBoundingBox;return this.ScanDirection.IsHorizontal?e.y==n.bottom||e.y==n.top:e.x==n.left||e.x==n.right}CreateScanSegment(e,t,n){const i=this.ScanLineIntersectSide(e,t);return e!=i&&this.parallelSegmentVector.CreateScanSegment(e,i,n,this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(e,i)),i}GenerateSparseIntersectionsFromVertexPoints(){this.VisibilityGraph=po.NewVisibilityGraph(),this.GenerateSparseIntersectionsAlongHorizontalAxis(),this.GenerateSparseIntersectionsAlongVerticalAxis(),this.ConnectAdjoiningScanSegments(),this.horizontalScanSegmentVector.CreateSparseVerticesAndEdges(this.VisibilityGraph),this.verticalScanSegmentVector.CreateSparseVerticesAndEdges(this.VisibilityGraph)}GenerateSparseIntersectionsAlongHorizontalAxis(){this.currentAxisPointComparer=IS;const e=Array.from(this.horizontalVertexPoints.values()).sort(this.currentAxisPointComparer),t=Array.from(this.boundingBoxSteinerPoints.values()).sort(this.currentAxisPointComparer);this.ScanDirection=ur.HorizontalInstance,this.SetVectorsAndCoordMaps(this.ScanDirection),this.GenerateSparseIntersections(e,t)}GenerateSparseIntersectionsAlongVerticalAxis(){this.currentAxisPointComparer=(n,i)=>n.compareTo(i);const e=Array.from(this.verticalVertexPoints.values()).sort(this.currentAxisPointComparer),t=Array.from(this.boundingBoxSteinerPoints.values()).sort(this.currentAxisPointComparer);this.ScanDirection=ur.VerticalInstance,this.SetVectorsAndCoordMaps(this.ScanDirection),this.GenerateSparseIntersections(e,t)}SetVectorsAndCoordMaps(e){e.IsHorizontal?(this.parallelSegmentVector=this.horizontalScanSegmentVector,this.perpendicularSegmentVector=this.verticalScanSegmentVector,this.perpendicularCoordMap=this.verticalCoordMap):(this.parallelSegmentVector=this.verticalScanSegmentVector,this.perpendicularSegmentVector=this.horizontalScanSegmentVector,this.perpendicularCoordMap=this.horizontalCoordMap)}ConnectAdjoiningScanSegments(){this.horizontalScanSegmentVector.ConnectAdjoiningSegmentEndpoints(),this.verticalScanSegmentVector.ConnectAdjoiningSegmentEndpoints()}GenerateSparseIntersections(e,t){this.perpendicularSegmentVector.ResetForIntersections(),this.parallelSegmentVector.ResetForIntersections();let n=1;const i={j:0};for(const s of this.parallelSegmentVector.Items())for(;s.CurrentSegment.ContainsPoint(e[n])||this.AddSteinerPointsToInterveningSegments(e[n],t,i,s)&&s.TraverseToSegmentContainingPoint(e[n]);)if(this.AddPointsToCurrentSegmentIntersections(t,i,s),this.GenerateIntersectionsFromVertexPointForCurrentSegment(e[n],s),s.PointIsCurrentEndAndNextStart(e[n]))s.MoveNext();else if(++n>=e.length)return}AddSteinerPointsToInterveningSegments(e,t,n,i){for(;n.j<t.length&&-1==this.currentAxisPointComparer(t[n.j],e);){if(!i.TraverseToSegmentContainingPoint(t[n.j]))return!1;this.AddPointsToCurrentSegmentIntersections(t,n,i)}return!0}AddPointsToCurrentSegmentIntersections(e,t,n){for(;t.j<e.length&&n.CurrentSegment.ContainsPoint(e[t.j]);t.j++){const i=this.FindPerpendicularSlot(e[t.j],0);this.AddSlotToSegmentIntersections(n,i)}}GenerateIntersectionsFromVertexPointForCurrentSegment(e,t){const n=this.FindPerpendicularSlot(t.CurrentSegment.Start,1),i=this.FindPerpendicularSlot(t.CurrentSegment.End,-1),s=this.FindPerpendicularSlot(e,0);n>=i||(this.AddSlotToSegmentIntersections(t,n),this.AddSlotToSegmentIntersections(t,i),s>n&&s<i&&(this.AddSlotToSegmentIntersections(t,s),this.AddBinaryDivisionSlotsToSegmentIntersections(t,n,s,i)))}FindPerpendicularSlot(e,t){return po.FindIntersectingSlot(this.perpendicularSegmentVector,this.perpendicularCoordMap,e,t)}static FindIntersectingSlot(e,t,n,i){const s=e.GetParallelCoord(n),o=t.get(s);return null!=o?o:0==i?-1:e.FindNearest(s,i)}AddSlotToSegmentIntersections(e,t){const n=this.perpendicularSegmentVector.Item(t);e.CurrentSegment.AddSparseVertexCoord(n.Coord),n.AddPerpendicularCoord(e.Coord)}AddBinaryDivisionSlotsToSegmentIntersections(e,t,n,i){let s=0,o=this.perpendicularSegmentVector.Length-1;for(;o-s>1;){const a=s+Math.floor((o-s)/2);n<=a?(o=a,n<o&&o<=i&&this.AddSlotToSegmentIntersections(e,o)):(s=a,n>s&&s>=t&&this.AddSlotToSegmentIntersections(e,s))}}CreateScanSegmentTrees(){po.CreateScanSegmentTree(this.horizontalScanSegmentVector,this.HorizontalScanSegments),po.CreateScanSegmentTree(this.verticalScanSegmentVector,this.VerticalScanSegments)}static CreateScanSegmentTree(e,t){for(const n of e.Items())for(let i=n.FirstSegment;null!=i;i=i.NextSegment)i.HasVisibility()&&t.InsertUnique(i)}}class mo{constructor(e){this.AddedVertices=new Array,this.AddedEdges=new Array,this.edgesToRestore=new Array,this.LimitPortVisibilitySpliceToEndpointBoundingBox=!1,this.GraphGenerator=e}get ObstacleTree(){return this.GraphGenerator.ObstacleTree}get VisGraph(){return this.GraphGenerator.VisibilityGraph}get IsSparseVg(){return this.GraphGenerator instanceof po}AddVertex(e){const t=this.VisGraph.AddVertexP(e);return this.AddedVertices.push(t),t}FindOrAddVertex(e){const t=this.VisGraph.FindVertex(e);return null!=t?t:this.AddVertex(e)}FindOrAddEdgeVV(e,t){return this.FindOrAddEdge(e,t,Ht.NormalWeight)}FindOrAddEdge(e,t,n){const i=xe.GetPureDirectionVV(e,t),s={bracketSource:void 0,bracketTarget:void 0,splitVertex:void 0};mo.GetBrackets(e,t,i,s);let o=this.VisGraph.FindEdgePP(s.bracketSource.point,s.bracketTarget.point);return o=null!=o?this.SplitEdge(o,s.splitVertex):this.CreateEdge(s.bracketSource,s.bracketTarget,n),o}static GetBrackets(e,t,n,i){if(i.splitVertex=t,!mo.FindBracketingVertices(e,t.point,n,i)){const s={bracketSource:null,bracketTarget:null};mo.FindBracketingVertices(t,e.point,Je.OppositeDir(n),s)&&(i.bracketSource=s.bracketTarget,i.splitVertex=e),i.bracketTarget=s.bracketSource}}static FindBracketingVertices(e,t,n,i){for(i.bracketSource=e;i.bracketTarget=Qe.FindAdjacentVertex(i.bracketSource,n),null!=i.bracketTarget;){if(k.closeDistEps(i.bracketTarget.point,t))return!0;if(n!=xe.GetDirections(i.bracketTarget.point,t))break;i.bracketSource=i.bracketTarget}return null!=i.bracketTarget}CreateEdge(e,t,n){let i=e,s=t;xe.IsPureLower(i.point,s.point)||(i=t,s=e);const o=new ml(i,s,n);return Or.AddEdge(o),this.AddedEdges.push(o),o}RemoveFromGraph(){this.RemoveAddedVertices(),this.RemoveAddedEdges(),this.RestoreRemovedEdges()}RemoveAddedVertices(){for(const e of this.AddedVertices)null!=this.VisGraph.FindVertex(e.point)&&this.VisGraph.RemoveVertex(e);this.AddedVertices=[]}RemoveAddedEdges(){for(const e of this.AddedEdges)null!=this.VisGraph.FindVertex(e.SourcePoint)&&Or.RemoveEdge(e);this.AddedEdges=[]}RestoreRemovedEdges(){for(const e of this.edgesToRestore)Or.AddEdge(e);this.edgesToRestore=[]}FindNextEdge(e,t){return Qe.FindAdjacentEdge(e,t)}FindPerpendicularOrContainingEdge(e,t,n){for(;;){const i=Qe.FindAdjacentVertex(e,t);if(null==i)break;const s=xe.GetDirections(i.point,n);if(0!=(Je.OppositeDir(t)&s))return this.VisGraph.FindEdgePP(e.point,i.point);e=i}return null}FindNearestPerpendicularOrContainingEdge(e,t,n){let i;xe.GetDirections(e.point,n);let a,s=e;for(;null!=ve.None;){const l=Qe.FindAdjacentVertex(s,i);if(null==l||0!=(Je.OppositeDir(i)&xe.GetDirections(l.point,n)))break;s=l,xe.GetDirections(s.point,n)}for(;a=this.FindPerpendicularOrContainingEdge(s,t,n),null==a&&s!=e;)s=Qe.FindAdjacentVertex(s,Je.OppositeDir(i));return a}ConnectVertexToTargetVertex(e,t,n,i){if(k.closeDistEps(e.point,t.point))return;const s=xe.GetDirections(e.point,t.point);if(xe.IsPureDirectionD(s))return void this.FindOrAddEdgeVV(e,t);const o=Qe.FindBendPointBetween(e.point,t.point,n),a=this.FindOrAddVertex(o);this.FindOrAddEdge(e,a,i),this.FindOrAddEdge(a,t,i)}AddEdgeToTargetEdge(e,t,n){let i=this.VisGraph.FindVertex(n);return null==i&&(i=this.AddVertex(n),this.SplitEdge(t,i)),this.FindOrAddEdgeVV(e,i),i}SplitEdge(e,t){return null==e?null:k.closeDistEps(e.Source.point,t.point)||k.closeDistEps(e.Target.point,t.point)?e:(e instanceof ml||this.edgesToRestore.push(e),Or.RemoveEdge(e),(this.IsSparseVg||e.Weight==Ht.OverlappedWeight)&&t.Degree>0?(this.FindOrAddEdge(t,e.Source,e.Weight),this.FindOrAddEdge(t,e.Target,e.Weight)):(this.CreateEdge(t,e.Target,e.Weight),this.CreateEdge(e.Source,t,e.Weight)))}ExtendEdgeChainVRLPB(e,t,n,i,s){const o=xe.GetDirections(n.start,n.end);if(o==ve.None)return;const a=Qe.GetRectangleBound(t,o),l=Qe.IsVerticalD(o)?le.RoundPoint(new k(e.point.x,a)):le.RoundPoint(new k(a,e.point.y));if(k.closeDistEps(l,e.point)||xe.GetDirections(e.point,l)!=o)return;let c=n;xe.GetDirections(l,c.end)==o&&(c=Me.mkPP(c.start,l)),this.ExtendEdgeChain(e,o,c,n,i,s)}ExtendEdgeChain(e,t,n,i,s,o){if(xe.GetDirections(e.point,n.end)!=t)return;let l=Je.RotateLeft(t),c=Qe.FindAdjacentVertex(e,l);if(null==c&&(l=Je.OppositeDir(l),c=Qe.FindAdjacentVertex(e,l),null==c))return;const d=Je.OppositeDir(l),b={spliceTarget:null};this.ExtendSpliceWorker(c,t,d,n,i,o,b)&&this.ExtendSpliceWorker(b.spliceTarget,t,l,n,i,o,b),this.SpliceGroupBoundaryCrossings(s,e,n)}SpliceGroupBoundaryCrossings(e,t,n){if(null==e||0==e.Count())return;e.Reset();let i=n.start,s=n.end,o=xe.GetDirections(i,s);Qe.IsAscending(o)||(i=n.end,s=n.start,o=Je.OppositeDir(o));for(let a=t=mo.TraverseToFirstVertexAtOrAbove(t,i,Je.OppositeDir(o));null!=a;a=Qe.FindAdjacentVertex(a,o)){const l=xe.ComparePP(a.point,s)>=0;for(;e.CurrentIsBeforeOrAt(a.point);){const c=e.Pop();xe.ComparePP(c.Location,t.point)>0&&xe.ComparePP(c.Location,s)<=0&&this.SpliceGroupBoundaryCrossing(a,c,Je.OppositeDir(o)),xe.ComparePP(c.Location,t.point)>=0&&xe.ComparePP(c.Location,s)<0&&this.SpliceGroupBoundaryCrossing(a,c,o)}if(l)break}}static TraverseToFirstVertexAtOrAbove(e,t,n){let i=e;const s=Je.OppositeDir(n);for(;;){const o=Qe.FindAdjacentVertex(i,n);if(null==o||xe.GetDirections(o.point,t)==s)break;i=o}return i}SpliceGroupBoundaryCrossing(e,t,n){var i,s;const o=By.ToCrossingArray(t.Crossings,n);if(null!=o){const a=null!==(i=this.VisGraph.FindVertex(t.Location))&&void 0!==i?i:this.AddVertex(t.Location);this.AddVertex(t.Location),e.point.equal(a.point)||this.FindOrAddEdgeVV(e,a);const l=o[0].GetInteriorVertexPoint(t.Location),c=null!==(s=this.VisGraph.FindVertex(l))&&void 0!==s?s:this.AddVertex(l);this.AddVertex(l),this.FindOrAddEdgeVV(a,c);const d=this.VisGraph.FindEdgePP(a.point,c.point),b=o.map(N=>N.Group.InputShape);d.IsPassable=()=>b.some(N=>N.IsTransparent)}}ExtendSpliceWorker(e,t,n,i,s,o,a){let l=Qe.FindAdjacentVertex(e,n);a.spliceTarget=Qe.FindAdjacentVertex(l,n);const c={spliceSource:e};for(;mo.GetNextSpliceSource(c,n,t);){const d=Qe.FindBendPointBetween(l.point,c.spliceSource.point,Je.OppositeDir(n));if(mo.IsPointPastSegmentEnd(s,d))break;if(a.spliceTarget=mo.GetSpliceTarget(c,n,d),null==a.spliceTarget){if(this.IsSkippableSpliceSourceWithNullSpliceTarget(c.spliceSource,t))continue;if(this.ObstacleTree.SegmentCrossesAnObstacle(c.spliceSource.point,d))return!1}let b=this.VisGraph.FindVertex(d);if(null!=b){if(null==a.spliceTarget||null!=this.VisGraph.FindEdgePP(l.point,d))return null==a.spliceTarget&&this.FindOrAddEdge(l,b,o?Ht.OverlappedWeight:Ht.NormalWeight),!1}else b=this.AddVertex(d);if(this.FindOrAddEdge(l,b,o?Ht.OverlappedWeight:Ht.NormalWeight),this.FindOrAddEdge(c.spliceSource,b,o?Ht.OverlappedWeight:Ht.NormalWeight),o&&(o=this.SeeIfSpliceIsStillOverlapped(t,b)),l=b,0==(t&xe.GetDirections(d,i.end))){a.spliceTarget=null;break}}return null!=a.spliceTarget}static GetNextSpliceSource(e,t,n){let i=Qe.FindAdjacentVertex(e.spliceSource,n);if(null==i)for(i=e.spliceSource;;){if(i=Qe.FindAdjacentVertex(i,Je.OppositeDir(t)),null==i)return!1;const s=Qe.FindAdjacentVertex(i,n);if(null!=s){i=s;break}}return e.spliceSource=i,!0}static GetSpliceTarget(e,t,n){const i=xe.GetDirections(e.spliceSource.point,n);let s=i,o=e.spliceSource;for(;s==i&&(e.spliceSource=o,o=Qe.FindAdjacentVertex(e.spliceSource,t),null!=o);){if(k.closeDistEps(o.point,n)){o=Qe.FindAdjacentVertex(o,t);break}s=xe.GetDirections(o.point,n)}return o}SeeIfSpliceIsStillOverlapped(e,t){let n=this.FindNextEdge(t,Je.RotateLeft(e)),i=null!=n&&Ht.NormalWeight==n.Weight;return i||(n=this.FindNextEdge(t,Je.RotateRight(e)),i=null!=n&&Ht.NormalWeight==n.Weight),!i||this.ObstacleTree.PointIsInsideAnObstaclePD(t.point,e)}IsSkippableSpliceSourceWithNullSpliceTarget(e,t){if(mo.IsSkippableSpliceSourceEdgeWithNullTarget(Qe.FindAdjacentEdge(e,t)))return!0;const n=Qe.FindAdjacentEdge(e,Je.OppositeDir(t));return mo.IsSkippableSpliceSourceEdgeWithNullTarget(n)||mo.IsReflectionEdge(n)}static IsSkippableSpliceSourceEdgeWithNullTarget(e){return null!=e&&null!=e.IsPassable&&an(e.Length,PT.BoundaryWidth)}static IsReflectionEdge(e){return null!=e&&e.Weight==Ht.ReflectionWeight}static IsPointPastSegmentEnd(e,t){return xe.GetDirections(e.start,e.end)==xe.GetDirections(e.end,t)}toString(){return pi.String.Format("{0} {1}",this.AddedVertices.length,this.edgesToRestore.length)}}class Vy{constructor(e){this.obstaclePortMap=new Map,this.freePointMap=new Vs,this.freePointLocationsUsedByRouteEdges=new Fr,this.RouteToCenterOfObstacles=!1,this.obstaclePortsInGraph=new Array,this.freePointsInGraph=new Set,this.activeAncestors=new Array,this.TransUtil=new mo(e),this.graphGenerator=e}get LimitPortVisibilitySpliceToEndpointBoundingBox(){return this.TransUtil.LimitPortVisibilitySpliceToEndpointBoundingBox}set LimitPortVisibilitySpliceToEndpointBoundingBox(e){this.TransUtil.LimitPortVisibilitySpliceToEndpointBoundingBox=e}get VisGraph(){return this.graphGenerator.VisibilityGraph}get HScanSegments(){return this.graphGenerator.HorizontalScanSegments}get VScanSegments(){return this.graphGenerator.VerticalScanSegments}get ObstacleTree(){return this.graphGenerator.ObstacleTree}get AncestorSets(){return this.ObstacleTree.AncestorSets}Clear(){this.TransUtil.RemoveFromGraph(),this.obstaclePortMap.clear()}CreateObstaclePorts(e){for(const t of e.Ports)this.CreateObstaclePort(e,t)}CreateObstaclePort(e,t){if(null==t.Curve)return null;const n=le.RoundPoint(t.Location);if(Ot.Outside==fe.PointRelativeToCurveLocation(n,e.InputShape.BoundaryCurve)||e.InputShape.BoundaryCurve!=t.Curve&&Ot.Outside==fe.PointRelativeToCurveLocation(n,t.Curve))return null;const i=new I4(t,e);return this.obstaclePortMap.set(t,i),i}FindVertices(e){const t=new Array,n=this.obstaclePortMap.get(e);if(n)if(this.RouteToCenterOfObstacles)t.push(n.CenterVertex);else for(const i of n.PortEntrances){const s=this.VisGraph.FindVertex(i.UnpaddedBorderIntersect);null!=s&&t.push(s)}else t.push(this.VisGraph.FindVertex(le.RoundPoint(e.Location)));return t}RemoveObstaclePorts(e){for(const t of e.Ports)this.RemoveObstaclePort(t)}RemoveObstaclePort(e){this.obstaclePortMap.delete(e)}AddControlPointsToGraph(e,t){this.GetPortSpliceLimitRectangle(e),this.activeAncestors=[];const n={oport:null},i={oport:null},s=this.FindAncestorsAndObstaclePort(e.sourcePort,n),o=this.FindAncestorsAndObstaclePort(e.targetPort,i);if(this.AncestorSets.size>0&&null!=n.oport&&null!=i.oport){const a=Zf(o,s),l=Zf(s,o);this.ActivateAncestors(l,a,t)}this.AddPortToGraph(e.sourcePort,n.oport),this.AddPortToGraph(e.targetPort,i.oport)}ConnectOobWaypointToEndpointVisibilityAtGraphBoundary(e,t){if(null==e||!e.IsOutOfBounds)return;const n=this.FindVertices(t);let i=e.OutOfBoundsDirectionFromGraph&(ve.North|ve.South);this.ConnectToGraphAtPointsCollinearWithVertices(e,i,n),i=e.OutOfBoundsDirectionFromGraph&(ve.East|ve.West),this.ConnectToGraphAtPointsCollinearWithVertices(e,i,n)}ConnectToGraphAtPointsCollinearWithVertices(e,t,n){if(ve.None==t)return;const i=Je.OppositeDir(t);for(const s of n){const o=this.InBoundsGraphBoxIntersect(s.point,t),a=this.VisGraph.FindVertex(o);null!=a&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,a,i,Ht.NormalWeight)}}SetAllAncestorsActive(e,t){if(0==this.AncestorSets.size)return!1;this.ObstacleTree.AdjustSpatialAncestors(),this.ClearActiveAncestors();const s=this.FindAncestorsAndObstaclePort(e.sourcePort,{oport:null}),o=this.FindAncestorsAndObstaclePort(e.targetPort,{oport:null});return this.AncestorSets.size>0&&null!=s&&null!=o&&(this.ActivateAncestors(s,o,t),!0)}SetAllGroupsActive(){this.ClearActiveAncestors();for(const e of this.ObstacleTree.GetAllGroups())e.IsTransparentAncestor=!0,this.activeAncestors.push(e)}FindAncestorsAndObstaclePort(e,t){return t.oport=this.FindObstaclePort(e),0==this.AncestorSets.size?null:null!=t.oport?this.AncestorSets.get(t.oport.Obstacle.InputShape):new Set(Array.from(this.ObstacleTree.Root.AllHitItems(lt.mkPP(e.Location,e.Location),n=>n.IsGroup)).map(n=>n.InputShape))}ActivateAncestors(e,t,n){for(const i of eg(e,t)){const s=n.get(i);s.IsTransparentAncestor=!0,this.activeAncestors.push(s)}}ClearActiveAncestors(){for(const e of this.activeAncestors)e.IsTransparentAncestor=!1;this.activeAncestors=[]}RemoveControlPointsFromGraph(){this.ClearActiveAncestors(),this.RemoveObstaclePortsFromGraph(),this.RemoveFreePointsFromGraph(),this.TransUtil.RemoveFromGraph(),this.portSpliceLimitRectangle=lt.mkEmpty()}RemoveObstaclePortsFromGraph(){for(const e of this.obstaclePortsInGraph)e.RemoveFromGraph();this.obstaclePortsInGraph=[]}RemoveFreePointsFromGraph(){for(const e of this.freePointsInGraph)e.RemoveFromGraph();this.freePointsInGraph.clear()}RemoveStaleFreePoints(){if(this.freePointMap.size>this.freePointLocationsUsedByRouteEdges.size){const e=Array.from(this.freePointMap).filter(t=>!this.freePointLocationsUsedByRouteEdges.has(t[0]));for(const t of e)this.freePointMap.deleteP(t[0])}}ClearVisibility(){this.freePointMap.clear();for(const e of this.obstaclePortMap.values())e.ClearVisibility()}BeginRouteEdges(){this.RemoveControlPointsFromGraph(),this.freePointLocationsUsedByRouteEdges.clear()}EndRouteEdges(){this.RemoveStaleFreePoints()}FindObstaclePort(e){let t=this.obstaclePortMap.get(e);if(t){const n={removedPorts:null,addedPorts:null};if(t.Obstacle.GetPortChanges(n)){for(const i of n.addedPorts)this.CreateObstaclePort(t.Obstacle,i);for(const i of n.removedPorts)this.RemoveObstaclePort(i);t=this.obstaclePortMap.get(e)}}return t}AddPortToGraph(e,t){null==t?this.AddFreePointToGraph(e.Location):this.AddObstaclePortToGraph(t)}AddObstaclePortToGraph(e){if(!e.LocationHasChanged||(this.RemoveObstaclePort(e.Port),null!=(e=this.CreateObstaclePort(e.Obstacle,e.Port)))){e.AddToGraph(this.TransUtil,this.RouteToCenterOfObstacles),this.obstaclePortsInGraph.push(e),this.CreateObstaclePortEntrancesIfNeeded(e);for(const t of e.PortEntrances)this.AddObstaclePortEntranceToGraph(t)}}CreateObstaclePortEntrancesIfNeeded(e){e.PortEntrances.length>0||this.CreateObstaclePortEntrancesFromPoints(e)}GetPortVisibilityIntersection(e){const t=this.FindObstaclePort(e.sourcePort),n=this.FindObstaclePort(e.targetPort);if(null==t||null==n||t.Obstacle.IsInConvexHull||n.Obstacle.IsInConvexHull||(this.CreateObstaclePortEntrancesIfNeeded(t),this.CreateObstaclePortEntrancesIfNeeded(n),!t.VisibilityRectangle.intersects(n.VisibilityRectangle)))return null;for(const i of t.PortEntrances)if(i.WantVisibilityIntersection)for(const s of n.PortEntrances){if(!s.WantVisibilityIntersection)continue;const o=i.IsVertical==s.IsVertical?Vy.GetPathPointsFromOverlappingCollinearVisibility(i,s):Vy.GetPathPointsFromIntersectingVisibility(i,s);if(null!=o)return o}return null}static GetPathPointsFromOverlappingCollinearVisibility(e,t){return!Qe.IntervalsAreSame(e.MaxVisibilitySegment.start,e.MaxVisibilitySegment.end,t.MaxVisibilitySegment.end,t.MaxVisibilitySegment.start)||e.HasGroupCrossings||t.HasGroupCrossings||k.closeDistEps(e.UnpaddedBorderIntersect,t.UnpaddedBorderIntersect)?null:[e.UnpaddedBorderIntersect,t.UnpaddedBorderIntersect]}static GetPathPointsFromIntersectingVisibility(e,t){const n=Qe.SegmentsIntersectLL(e.MaxVisibilitySegment,t.MaxVisibilitySegment);return!n||e.HasGroupCrossingBeforePoint(n)||t.HasGroupCrossingBeforePoint(n)?null:[e.UnpaddedBorderIntersect,n,t.UnpaddedBorderIntersect]}CreateObstaclePortEntrancesFromPoints(e){const t=this.graphGenerator.ObstacleTree.GraphBox,n=lt.mkPP(le.RoundPoint(e.PortCurve.boundingBox.leftBottom),le.RoundPoint(e.PortCurve.boundingBox.rightTop)),i=le.RoundPoint(e.PortLocation);let s=!1;const o={xx0:null,xx1:null};if(!xe.Equal(i.y,n.top)&&!xe.Equal(i.y,n.bottom)){s=!0;const a=new Me(t.left,i.y,t.right,i.y);this.GetBorderIntersections(i,a,e.PortCurve,o);let l=new k(Math.min(o.xx0.x,o.xx1.x),i.y);l.x<n.left&&(l=new k(n.left,l.y));let c=new k(Math.max(o.xx0.x,o.xx1.x),i.y);c.x>n.right&&(c=new k(n.right,c.y)),this.CreatePortEntrancesAtBorderIntersections(n,e,i,l,c)}if(!xe.Equal(i.x,n.left)&&!xe.Equal(i.x,n.right)){s=!0;const a=new Me(i.x,t.bottom,i.x,t.top);this.GetBorderIntersections(i,a,e.PortCurve,o);let l=new k(i.x,Math.min(o.xx0.y,o.xx1.y));l.y<t.bottom&&(l=new k(l.x,t.bottom));let c=new k(i.x,Math.max(o.xx0.y,o.xx1.y));c.y>t.top&&(c=new k(c.x,t.top)),this.CreatePortEntrancesAtBorderIntersections(n,e,i,l,c)}s||this.CreateEntrancesForCornerPort(n,e,i)}GetBorderIntersections(e,t,n,i){const s=fe.getAllIntersections(t,n,!0);i.xx0=le.RoundPoint(s[0].x),i.xx1=le.RoundPoint(s[1].x)}CreatePortEntrancesAtBorderIntersections(e,t,n,i,s){const o=xe.GetDirections(i,s);xe.EqualPP(i,n)||this.CreatePortEntrance(e,t,s,o),xe.EqualPP(s,n)||this.CreatePortEntrance(e,t,i,Je.OppositeDir(o))}static GetDerivative(e,t){const n=e.PortCurve.closestParameter(t);let i=e.PortCurve.derivative(n);return Jo.CurveIsClockwise(e.PortCurve,e.PortCurve.value((e.PortCurve.parStart+e.PortCurve.parEnd)/2))||(i=i.mul(-1)),i}CreatePortEntrance(e,t,n,i){t.CreatePortEntrance(n,i,this.ObstacleTree);const s=ur.GetInstance(i);let o=Qe.GetRectangleBound(e,i)-s.Coord(n);if(o<0&&(o=-o),o>le.intersectionEpsilon){const a=Je.VectorDirection(Vy.GetDerivative(t,n));let l;Je.OppositeDir(i),ve.None!=(i&a)&&(l=Je.OppositeDir(l)),t.CreatePortEntrance(n,l,this.ObstacleTree)}}CreateEntrancesForCornerPort(e,t,n){let i=ve.North;xe.EqualPP(n,e.leftBottom)?i=ve.South:xe.EqualPP(n,e.leftTop)?i=ve.West:xe.EqualPP(n,e.rightTop)?i=ve.North:xe.EqualPP(n,e.rightBottom)&&(i=ve.East),t.CreatePortEntrance(n,i,this.ObstacleTree),t.CreatePortEntrance(n,Je.RotateRight(i),this.ObstacleTree)}AddObstaclePortEntranceToGraph(e){const t=this.VisGraph.FindVertex(e.VisibilityBorderIntersect);if(t)return void e.ExtendEdgeChain(this.TransUtil,t,t,this.portSpliceLimitRectangle,this.RouteToCenterOfObstacles);const n={targetVertex:null};null!=this.FindorCreateNearestPerpEdgePPDNT(e.MaxVisibilitySegment.end,e.VisibilityBorderIntersect,e.OutwardDirection,e.IsOverlapped?Ht.OverlappedWeight:Ht.NormalWeight,n)&&e.AddToAdjacentVertex(this.TransUtil,n.targetVertex,this.portSpliceLimitRectangle,this.RouteToCenterOfObstacles)}InBoundsGraphBoxIntersect(e,t){return Qe.RectangleBorderIntersect(this.graphGenerator.ObstacleTree.GraphBox,e,t)}FindorCreateNearestPerpEdgePPDN(e,t,n,i){return this.FindorCreateNearestPerpEdgePPDNT(e,t,n,i,{targetVertex:null})}FindorCreateNearestPerpEdgePPDNT(e,t,n,i,s){const o=Qe.SortAscending(e,t),a=o[0],l=o[1],c=Qe.IsVerticalD(n)?this.HScanSegments:this.VScanSegments,d=Qe.IsAscending(n)?c.FindLowestIntersector(a,l):c.FindHighestIntersector(a,l);if(null==d)return s.targetVertex=null,null;const b=Qe.SegmentIntersectionSP(d,a);return this.FindOrCreateNearestPerpEdgeFromNearestPerpSegment(Qe.IsAscending(n)?a:l,d,b,i,s)}FindOrCreateNearestPerpEdgeFromNearestPerpSegment(e,t,n,i,s){var o;const a={segsegVertex:this.VisGraph.FindVertex(n),targetVertex:null};if(null==a.segsegVertex){const b=this.FindOrCreateSegmentIntersectionVertexAndAssociatedEdge(e,n,t,i,a);if(null!=b)return b}else if(xe.EqualPP(e,n))return s.targetVertex=a.segsegVertex,this.TransUtil.FindNextEdge(s.targetVertex,Je.OppositeDir(t.ScanDirection.Dir));const l=xe.GetDirections(n,e);let c=xe.GetDirections(a.segsegVertex.point,e);if(l==c){const b={bracketTarget:null,bracketSource:null};return mo.FindBracketingVertices(a.segsegVertex,e,l,b),null!==(o=this.TransUtil.FindNextEdge(b.bracketSource,Je.RotateLeft(l)))&&void 0!==o?o:this.TransUtil.FindNextEdge(b.bracketSource,Je.RotateRight(l))}c&=~l;const d=this.TransUtil.FindNearestPerpendicularOrContainingEdge(a.segsegVertex,c,e);return null==d?(s.targetVertex=this.TransUtil.AddVertex(n),this.TransUtil.FindOrAddEdge(s.targetVertex,t.HighestVisibilityVertex,t.Weight)):(a.segsegVertex=Qe.GetEdgeEnd(d,Je.OppositeDir(c)),n=Qe.SegmentIntersectionPPP(e,n,a.segsegVertex.point),xe.EqualPP(a.segsegVertex.point,n)?(s.targetVertex=a.segsegVertex,this.TransUtil.FindNextEdge(a.segsegVertex,c)):(s.targetVertex=this.TransUtil.FindOrAddVertex(n),this.TransUtil.FindOrAddEdge(a.segsegVertex,s.targetVertex,i)))}FindOrCreateSegmentIntersectionVertexAndAssociatedEdge(e,t,n,i,s){const a=(n.IsVertical?this.HScanSegments:this.VScanSegments).FindHighestIntersector(n.Start,t);if(null==a)return s.segsegVertex=null,s.targetVertex=this.TransUtil.AddVertex(t),this.TransUtil.FindOrAddEdge(s.targetVertex,n.LowestVisibilityVertex,n.Weight);const l=Qe.SegmentsIntersection(n,a);if(s.segsegVertex=this.VisGraph.FindVertex(l),!s.segsegVertex){s.segsegVertex=this.TransUtil.AddVertex(l);const c=this.AddEdgeToClosestSegmentEnd(n,s.segsegVertex,n.Weight);if(this.AddEdgeToClosestSegmentEnd(a,s.segsegVertex,a.Weight),xe.EqualPP(s.segsegVertex.point,t))return s.targetVertex=s.segsegVertex,c}return xe.EqualPP(e,t)?(s.targetVertex=this.TransUtil.FindOrAddVertex(t),this.TransUtil.FindOrAddEdge(s.segsegVertex,s.targetVertex,i)):(s.targetVertex=null,null)}AddEdgeToClosestSegmentEnd(e,t,n){return xe.IsPureLower(e.HighestVisibilityVertex.point,t.point)?this.TransUtil.FindOrAddEdge(e.HighestVisibilityVertex,t,n):xe.IsPureLower(t.point,e.LowestVisibilityVertex.point)?this.TransUtil.FindOrAddEdge(t,e.LowestVisibilityVertex,n):this.TransUtil.FindOrAddEdgeVV(e.LowestVisibilityVertex,t)}GetPortSpliceLimitRectangle(e){this.LimitPortVisibilitySpliceToEndpointBoundingBox?(this.portSpliceLimitRectangle=this.GetPortRectangle(e.sourcePort),this.portSpliceLimitRectangle.addRecSelf(this.GetPortRectangle(e.targetPort))):this.portSpliceLimitRectangle=this.graphGenerator.ObstacleTree.GraphBox}GetPortRectangle(e){const t=this.obstaclePortMap.get(e);return t?t.Obstacle.VisibilityBoundingBox.clone():lt.mkOnPoints([le.RoundPoint(e.Location)])}AddToLimitRectangle(e){this.graphGenerator.IsInBoundsP(e)&&this.portSpliceLimitRectangle.add(e)}FindOrCreateFreePoint(e){let t=this.freePointMap.get(e);return t?t.GetVertex(this.TransUtil,e):(t=new P4(this.TransUtil,e),this.freePointMap.set(e,t)),this.freePointsInGraph.add(t),this.freePointLocationsUsedByRouteEdges.add(e),t}AddFreePointToGraph(e){e=le.RoundPoint(e);const t=this.VisGraph.FindVertex(e),n=this.FindOrCreateFreePoint(e);if(null!=t)return n;if(!this.graphGenerator.IsInBoundsP(e))return this.CreateOutOfBoundsFreePoint(n),n;n.IsOverlapped=this.ObstacleTree.PointIsInsideAnObstacle(n.Point,this.HScanSegments.ScanDirection),this.VScanSegments.FindSegmentContainingPoint(e,!0);let o=ve.South;for(let a=0;a<4;a++)this.ConnectFreePointToLateralEdge(n,o),o=Je.RotateLeft(o);return n}CreateOutOfBoundsFreePoint(e){const t=e.Point,n=this.graphGenerator.MakeInBoundsLocation(t),i=xe.GetDirections(n,t);if(e.OutOfBoundsDirectionFromGraph=i,!xe.IsPureDirectionD(i))return void e.AddOobEdgesFromGraphCorner(this.TransUtil,n);let s=this.VisGraph.FindVertex(n);const o=Je.OppositeDir(i);if(null!=s)e.AddToAdjacentVertex(this.TransUtil,s,o,this.portSpliceLimitRectangle);else{const c=this.FindorCreateNearestPerpEdgePPDN(t,n,i,Ht.NormalWeight);null!=c&&(s=e.AddEdgeToAdjacentEdge(this.TransUtil,c,o,this.portSpliceLimitRectangle))}const a=Qe.FindAdjacentVertex(s,Je.RotateLeft(o));null!=a&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,a,o,Ht.NormalWeight);const l=Qe.FindAdjacentVertex(s,Je.RotateRight(o));null!=l&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,l,o,Ht.NormalWeight)}ConnectFreePointToLateralEdge(e,t){const n=e.IsOverlapped?this.InBoundsGraphBoxIntersect(e.Point,t):e.MaxVisibilityInDirectionForNonOverlappedFreePoint(t,this.TransUtil),i=this.FindorCreateNearestPerpEdgePPDN(n,e.Point,t,e.InitialWeight);null!=i&&e.AddEdgeToAdjacentEdge(this.TransUtil,i,t,this.portSpliceLimitRectangle)}}let L4=(()=>{class r extends Rr{constructor(t,n,i,s,o){super(null),this.Padding=0,this.CornerFitRadius=0,this.BendPenaltyAsAPercentageOfDistance=0,this.UseObstacleRectangles=!1,this.ShapeToObstacleMap=new Map,this.EdgesToRoute=new Array,this.removeStaircases=!0,this.selfEdges=new Array,this.Padding=n,this.CornerFitRadius=i,this.BendPenaltyAsAPercentageOfDistance=In.DefaultBendPenaltyAsAPercentageOfDistance,this.GraphGenerator=new po,this.UseObstacleRectangles=o,this.PortManager=new Vy(this.GraphGenerator),this.AddShapes(t)}get RouteToCenterOfObstacles(){return this.PortManager.RouteToCenterOfObstacles}set RouteToCenterOfObstacles(t){this.PortManager.RouteToCenterOfObstacles=t}get LimitPortVisibilitySpliceToEndpointBoundingBox(){return this.PortManager.LimitPortVisibilitySpliceToEndpointBoundingBox}set LimitPortVisibilitySpliceToEndpointBoundingBox(t){this.PortManager.LimitPortVisibilitySpliceToEndpointBoundingBox=t}AddEdgeGeometryToRoute(t){k.closeDistEps(le.RoundPoint(t.sourcePort.Location),le.RoundPoint(t.targetPort.Location))?this.selfEdges.push(t):this.EdgesToRoute.push(t)}get EdgeGeometriesToRoute(){return this.EdgesToRoute}RemoveAllEdgeGeometriesToRoute(){this.EdgesToRoute=[]}get UseSparseVisibilityGraph(){return this.GraphGenerator instanceof po}get Obstacles(){return Array.from(this.ShapeToObstacleMap.values()).map(t=>t.InputShape)}get PaddedObstacles(){return Array.from(this.ShapeToObstacleMap.values()).map(t=>t.PaddedPolyline)}AddObstacles(t){this.AddShapes(t),this.RebuildTreeAndGraph()}AddShapes(t){for(const n of t)this.AddObstacleWithoutRebuild(n)}AddObstacle(t){this.AddObstacleWithoutRebuild(t),this.RebuildTreeAndGraph()}UpdateObstacles(t){for(const n of t)this.UpdateObstacleWithoutRebuild(n);this.RebuildTreeAndGraph()}UpdateObstacle(t){this.UpdateObstacleWithoutRebuild(t),this.RebuildTreeAndGraph()}RemoveObstacles(t){for(const n of t)this.RemoveObstacleWithoutRebuild(n);this.RebuildTreeAndGraph()}RemoveObstacle(t){this.RemoveObstacleWithoutRebuild(t),this.RebuildTreeAndGraph()}AddObstacleWithoutRebuild(t){if(null==t.BoundaryCurve)throw new Error("Shape must have a BoundaryCurve");this.CreatePaddedObstacle(t)}UpdateObstacleWithoutRebuild(t){if(null==t.BoundaryCurve)throw new Error("Shape must have a BoundaryCurve");this.PortManager.RemoveObstaclePorts(this.ShapeToObstacleMap.get(t)),this.CreatePaddedObstacle(t)}CreatePaddedObstacle(t){const n=new vl(t,this.UseObstacleRectangles,this.Padding);this.ShapeToObstacleMap.set(t,n),this.PortManager.CreateObstaclePorts(n)}RemoveObstacleWithoutRebuild(t){const n=this.ShapeToObstacleMap.get(t);this.ShapeToObstacleMap.delete(t),this.PortManager.RemoveObstaclePorts(n)}RemoveAllObstacles(){this.InternalClear(!1)}RebuildTreeAndGraph(){const t=null!=this.ObsTree.Root,n=null!=this.GraphGenerator.VisibilityGraph;this.InternalClear(!0),t&&this.GenerateObstacleTree(),n&&this.GenerateVisibilityGraph()}get VisibilityGraph(){return this.GenerateVisibilityGraph(),this.GraphGenerator.VisibilityGraph}Clear(){this.InternalClear(!1)}static constructorEmpty(){return r.constructorC(null)}static constructorC(t){return new r([],r.DefaultPadding,r.DefaultCornerFitRadius,!1,!1)}static constructorI(t){return new r(t,r.DefaultPadding,r.DefaultCornerFitRadius,!1,!1)}static constructorINNB(t,n,i,s){return new r(t,n,i,s,!1)}static constructorGNANB(t,n,i,s,o){return this.constructorGNANBB(t,n,i,s,o,!1)}static constructorGNANBB(t,n,i,s,o,a){const l=new r(fo.GetShapes(t),i,s,o,a);if(null==n)for(const c of t.edges())l.AddEdgeGeometryToRoute(c);else for(const c of n)l.AddEdgeGeometryToRoute(c);return l}run(){this.GenerateVisibilityGraph(),this.GeneratePaths()}GeneratePaths(){const t=this.EdgesToRoute.map(n=>new T4(n));this.FillEdgePathsWithShortestPaths(t),this.NudgePaths(t),this.RouteSelfEdges(),this.FinaliseEdgeGeometries()}RouteSelfEdges(){for(const t of this.selfEdges){const n={smoothedPolyline:null};t.curve=vu.RouteSelfEdge(t.sourcePort.Curve,Math.max(this.Padding,2*t.GetMaxArrowheadLength()),n)}}FillEdgePathsWithShortestPaths(t){this.PortManager.BeginRouteEdges();const n=new ky(this.BendPenaltyAsAPercentageOfDistance);for(const i of t)this.AddControlPointsAndGeneratePath(n,i);this.PortManager.EndRouteEdges()}AddControlPointsAndGeneratePath(t,n){const i=this.PortManager.GetPortVisibilityIntersection(n.GeomEdge);null==i?this.SpliceVisibilityAndGeneratePath(t,n):this.GeneratePathThroughVisibilityIntersection(n,i)}GeneratePathThroughVisibilityIntersection(t,n){t.PathPoints=n}SpliceVisibilityAndGeneratePath(t,n){this.PortManager.AddControlPointsToGraph(n.GeomEdge,this.ShapeToObstacleMap),this.GeneratePath(t,n,!1)||this.RetryPathsWithAdditionalGroupsEnabled(t,n),this.PortManager.RemoveControlPointsFromGraph()}GeneratePath(t,n,i){const s=this.PortManager.FindVertices(n.GeomEdge.sourcePort),o=this.PortManager.FindVertices(n.GeomEdge.targetPort);return r.GetSingleStagePath(n,t,s,o,i)}static GetSingleStagePath(t,n,i,s,o){return t.PathPoints=n.GetPath(i,s),o&&r.EnsureNonNullPath(t),null!=t.PathPoints&&t.PathPoints.length>0}static EnsureNonNullPath(t){null==t.PathPoints&&(t.PathPoints=xe.IsPureDirection(t.GeomEdge.sourcePort.Location,t.GeomEdge.targetPort.Location)?[t.GeomEdge.sourcePort.Location,t.GeomEdge.targetPort.Location]:[t.GeomEdge.sourcePort.Location,new k(t.GeomEdge.sourcePort.Location.x,t.GeomEdge.targetPort.Location.y),t.GeomEdge.targetPort.Location])}RetryPathsWithAdditionalGroupsEnabled(t,n){(!this.PortManager.SetAllAncestorsActive(n.GeomEdge,this.ShapeToObstacleMap)||!this.GeneratePath(t,n,!1))&&(this.PortManager.SetAllGroupsActive(),this.GeneratePath(t,n,!0))}NudgePaths(t){const n=this.ObsTree.SpatialAncestorsAdjusted?rr.GetAncestorSetsMap(this.Obstacles):this.AncestorsSets;Jn.NudgePaths(t,this.CornerFitRadius,this.PaddedObstacles,n,this.RemoveStaircases)}get RemoveStaircases(){return this.removeStaircases}set RemoveStaircases(t){this.removeStaircases=t}FinaliseEdgeGeometries(){for(const t of this.EdgesToRoute.concat(this.selfEdges))null!=t.curve&&(t.curve instanceof At&&(t.curve=r.FitArcsIntoCorners(this.CornerFitRadius,Array.from(t.curve))),r.CalculateArrowheads(t))}CreateVisibilityGraph(){this.GraphGenerator.Clear(),this.InitObstacleTree(),this.GraphGenerator.GenerateVisibilityGraph()}static CalculateArrowheads(t){wu.trimSplineAndCalculateArrowheadsII(t,t.sourcePort.Curve,t.targetPort.Curve,t.curve,!0)}get ObsTree(){return this.GraphGenerator.ObstacleTree}GenerateObstacleTree(){if(null==this.Obstacles||0==this.Obstacles.length)throw new Error("No obstacles have been added");null==this.ObsTree.Root&&this.InitObstacleTree()}InitObstacleTree(){this.AncestorsSets=rr.GetAncestorSetsMap(this.Obstacles),this.ObsTree.Init(this.ShapeToObstacleMap.values(),this.AncestorsSets,this.ShapeToObstacleMap)}InternalClear(t){this.GraphGenerator.Clear(),this.ClearShortestPaths(),t?this.PortManager.ClearVisibility():(this.PortManager.Clear(),this.ShapeToObstacleMap.clear(),this.EdgesToRoute=[])}ClearShortestPaths(){for(const t of this.EdgesToRoute)t.curve=null}GenerateVisibilityGraph(){if(null==this.Obstacles||0==this.Obstacles.length)throw new Error("No obstacles have been set");null==this.GraphGenerator.VisibilityGraph&&this.CreateVisibilityGraph()}static FitArcsIntoCorners(t,n){const i=r.GetFittedArcSegs(t,n),s=new fe;let o=null;for(const a of i){const l=r.EllipseIsAlmostLineSegment(a);null!=o?l?fe.continueWithLineSegmentP(s,r.CornerPoint(a)):(fe.continueWithLineSegmentP(s,a.start),s.addSegment(a)):l?fe.addLineSegment(s,n[0],r.CornerPoint(a)):(fe.addLineSegment(s,n[0],a.start),s.addSegment(a)),o=a}return s.segs.length>0?fe.continueWithLineSegmentP(s,n[n.length-1]):fe.addLineSegment(s,n[0],n[n.length-1]),s}static CornerPoint(t){return t.center.add(t.aAxis.add(t.bAxis))}static EllipseIsAlmostLineSegment(t){return t.aAxis.lengthSquared<1e-4||t.aAxis.lengthSquared<1e-4}static*GetFittedArcSegs(t,n){let i=n[1].sub(n[0]),s=i.normalize(),o=Math.min(t,i.length/2);for(let a=1;a<n.length-1;a++){i=n[a+1].sub(n[a]);const l=i.length;if(l<le.intersectionEpsilon){yield new Tn(0,0,new k(0,0),new k(0,0),n[a]);continue}const c=i.div(l);Math.abs(c.dot(s))>.9&&(yield new Tn(0,0,new k(0,0),new k(0,0),n[a]));const d=Math.min(t,i.length/2),b=c.mul(-d),N=s.mul(o);yield new Tn(0,Math.PI/2,b,N,n[a].sub(N.add(b))),s=c,o=d}}}return r.DefaultPadding=1,r.DefaultCornerFitRadius=3,r})();class TL extends Rr{constructor(e,t,n){super(null),this.graph=e,this.source=t,this.length=n}get Result(){return this.result}run(){const e=new Iu((i,s)=>i-s),t=new Map;for(const i of this.graph.shallowNodes()){const s=i==this.source?0:Number.POSITIVE_INFINITY;e.Enqueue(i,s),t.set(i,s)}for(;e.count>0;){const i={priority:0},s=e.DequeueAndGetPriority(i);t.set(s,i.priority);const o=t.get(s);for(const a of s.inEdges()){const l=a.source,c=o+this.length(a);t.get(l)>c&&(t.set(l,c),e.DecreasePriority(l,c))}for(const a of s.outEdges()){const l=a.target,c=o+this.length(a);t.get(l)>c&&(t.set(l,c),e.DecreasePriority(l,c))}}this.result=new Array(this.graph.shallowNodeCount);let n=0;for(const i of this.graph.shallowNodes()){const s=t.get(i);this.result[n++]=null!=s?s:Number.POSITIVE_INFINITY}}}class DT extends Rr{constructor(e,t){super(null),this.graph=e,this.length=t}get Result(){return this.result}set Result(e){this.result=e}run(){this.result=new Array(this.graph.shallowNodeCount);let e=0;for(const t of this.graph.shallowNodes()){const n=new TL(this.graph,t,this.length);n.run(),this.Result[e++]=n.Result}}static Stress(e,t){let n=0;if(0==e.edgeCount)return n;const i=new DT(e,t);i.run();const s=i.Result;let o=0;for(const l of e.edges())o+=t(l);o/=e.edgeCount;let a=0;for(const l of e.shallowNodes()){let c=0;for(const d of e.shallowNodes()){if(a!=c){const b=l.center.sub(d.center).length,N=o*s[a][c],F=N-b;n+=F*F/(N*N)}c++}a++}return n}}class M4 extends Rr{constructor(e,t,n){super(null),this.graph=e,this.pivotArray=t,this.length=n}get Result(){return this.result}run(){this.result=new Array(this.pivotArray.length);const e=Array.from(this.graph.shallowNodes()),t=new Array(this.graph.shallowNodeCount).fill(Number.POSITIVE_INFINITY);let n=e[0];this.pivotArray[0]=0;for(let i=0;;i++){const s=new TL(this.graph,n,this.length);if(s.run(),this.Result[i]=s.Result,!(i+1<this.pivotArray.length))break;{let o=0;for(let a=0;a<this.Result[i].length;a++)t[a]=Math.min(t[a],this.Result[i][a]),t[a]>t[o]&&(o=a);n=e[o],this.pivotArray[i+1]=o}}}}class Vn{static DoubleCenter(e){const t=new Array(e.length).fill(0),n=new Array(e[0].length).fill(0);let i=0;for(let s=0;s<e.length;s++)for(let o=0;o<e[0].length;o++)t[s]+=e[s][o],n[o]+=e[s][o],i+=e[s][o];for(let s=0;s<e.length;s++)t[s]/=e.length;for(let s=0;s<e[0].length;s++)n[s]/=e[0].length;i/=e.length,i/=e[0].length;for(let s=0;s<e.length;s++)for(let o=0;o<e[0].length;o++)e[s][o]-=t[s]+n[o]-i}static SquareEntries(e){for(let t=0;t<e.length;t++)for(let n=0;n<e[0].length;n++)e[t][n]=Math.pow(e[t][n],2)}static Multiply(e,t){for(let n=0;n<e.length;n++)for(let i=0;i<e[0].length;i++)e[n][i]*=t}static MultiplyX(e,t){if(e[0].length!=t.length)return null;const n=new Array(t.length).fill(0);for(let i=0;i<e.length;i++)for(let s=0;s<e[0].length;s++)n[i]+=e[i][s]*t[s];return n}static Norm(e){let t=0;for(let n=0;n<e.length;n++)t+=Math.pow(e[n],2);return Math.sqrt(t)}static Normalize(e){const t=Vn.Norm(e);if(t<=0)return 0;for(let n=0;n<e.length;n++)e[n]/=t;return t}static RandomUnitLengthVector(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=dT();return Vn.Normalize(t),t}static SpectralDecomposition(e,t){Vn.SpectralDecompositionIE(e,t,30,1e-6)}static SpectralDecompositionIE(e,t,n,i){const s=e[0].length;t.u1=Vn.RandomUnitLengthVector(s),t.lambda1=0,t.u2=Vn.RandomUnitLengthVector(s),t.lambda2=0;let o=0;const a=1-i;for(let l=0;l<n&&o<a;l++){const c=Vn.MultiplyX(e,t.u1),d=Vn.MultiplyX(e,t.u2);t.lambda1=Vn.Normalize(c),t.lambda2=Vn.Normalize(d),Vn.MakeOrthogonal(d,c),Vn.Normalize(d),o=Math.min(Vn.DotProduct(t.u1,c),Vn.DotProduct(t.u2,d)),t.u1=c,t.u2=d}}static DotProduct(e,t){if(e.length!=t.length)return 0;let n=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i];return n}static MakeOrthogonal(e,t){if(e.length!=t.length)return;const n=Vn.DotProduct(e,t)/Vn.DotProduct(t,t);for(let i=0;i<e.length;i++)e[i]-=n*t[i]}static ClassicalScaling(e,t){const n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=e[i].slice();Vn.SquareEntries(n),Vn.DoubleCenter(n),Vn.Multiply(n,-.5),Vn.SpectralDecomposition(n,t),t.lambda1=Math.sqrt(Math.abs(t.lambda1)),t.lambda2=Math.sqrt(Math.abs(t.lambda2));for(let i=0;i<t.u1.length;i++)t.u1[i]*=t.lambda1,t.u2[i]*=t.lambda2}static DistanceScalingSubset(e,t,n,i,s){const o=t.length,a=e.length,l=new Array(a);for(let d=0;d<a;d++)for(let b=0;b<o;b++)0==e[d][b]&&(l[d]=b);const c=new Array(a).fill(0);for(let d=0;d<a;d++)for(let b=0;b<o;b++)l[d]!=b&&(c[d]+=i[d][b]);for(let d=0;d<s;d++)for(let b=0;b<a;b++){let N=0,F=0;for(let G=0;G<o;G++)if(b!=G){let W=Math.sqrt(Math.pow(t[l[b]]-t[G],2)+Math.pow(n[l[b]]-n[G],2));W>0&&(W=1/W),N+=i[b][G]*(t[G]+e[b][G]*(t[l[b]]-t[G])*W),F+=i[b][G]*(n[G]+e[b][G]*(n[l[b]]-n[G])*W)}t[l[b]]=N/c[b],n[l[b]]=F/c[b]}}static DistanceScaling(e,t,n,i,s){const o=t.length,a=new Array(o).fill(0);for(let l=0;l<o;l++)for(let c=0;c<o;c++)l!=c&&(a[l]+=i[l][c]);for(let l=0;l<s;l++)for(let c=0;c<o;c++){let d=0,b=0;for(let N=0;N<o;N++)if(c!=N){let F=Math.sqrt(Math.pow(t[c]-t[N],2)+Math.pow(n[c]-n[N],2));F>0&&(F=1/F),d+=i[c][N]*(t[N]+e[c][N]*(t[c]-t[N])*F),b+=i[c][N]*(n[N]+e[c][N]*(n[c]-n[N])*F)}t[c]=d/a[c],n[c]=b/a[c]}}static ExponentialWeightMatrix(e,t){const n=new Array(e.length);for(let i=0;i<e.length;i++){n[i]=new Array(e[i].length).fill(0);for(let s=0;s<e[i].length;s++)e[i][s]>0&&(n[i][s]=Math.pow(e[i][s],t))}return n}static EuclideanDistanceMatrix(e,t){const n=new Array(e.length);for(let i=0;i<e.length;i++){n[i]=new Array(e.length);for(let s=0;s<e.length;s++)n[i][s]=Math.sqrt(Math.pow(e[i]-e[s],2)+Math.pow(t[i]-t[s],2))}return n}static LandmarkClassicalScaling(e,t,n){const i=new Array(e.length);for(let a=0;a<e.length;a++){i[a]=new Array(e.length);for(let l=0;l<e.length;l++)i[a][l]=e[a][n[l]]}Vn.SquareEntries(i);const s=new Array(e.length).fill(0);for(let a=0;a<e.length;a++){for(let l=0;l<e.length;l++)s[a]+=i[a][l];s[a]/=e.length}Vn.DoubleCenter(i),Vn.Multiply(i,-.5);const o={u1:new Array,u2:new Array,lambda1:0,lambda2:0};Vn.SpectralDecomposition(i,o),o.lambda1=Math.sqrt(Math.abs(o.lambda1)),o.lambda2=Math.sqrt(Math.abs(o.lambda2)),t.x=new Array(e[0].length).fill(0),t.y=new Array(e[0].length).fill(0);for(let a=0;a<t.x.length;a++)for(let l=0;l<i.length;l++){const c=(Math.pow(e[l][a],2)-s[l])/2;t.x[a]-=o.u1[l]*c,t.y[a]-=o.u2[l]*c}}}class B4{constructor(e,t){this.Constrained=!1,this.Capacity=1e6,1==Ir.AbovePP(e.point,t.point)?(this.upperSite=e,this.lowerSite=t):(this.lowerSite=e,this.upperSite=t),this.upperSite.AddEdgeToSite(this)}get CcwTriangle(){return this.ccwTriangle}set CcwTriangle(e){this.ccwTriangle=e}get CwTriangle(){return this.cwTriangle}set CwTriangle(e){this.cwTriangle=e}GetOtherTriangle_c(e){return this.cwTriangle.Contains(e)?this.ccwTriangle:this.cwTriangle}IsAdjacent(e){return e==this.upperSite||e==this.lowerSite}GetOtherTriangle_T(e){return this.ccwTriangle==e?this.cwTriangle:this.ccwTriangle}toString(){return pi.String.Format("({0},{1})",this.upperSite,this.lowerSite)}OtherSite(e){return this.upperSite==e?this.lowerSite:this.upperSite}}class Hy{constructor(e){this.Owner=null,this.InEdges=new Array,this.point=e}static mkSO(e,t){const n=new Hy(e);return n.Owner=t,n}AddEdgeToSite(e){null==this.Edges&&(this.Edges=new Array),this.Edges.push(e)}EdgeBetweenUpperSiteAndLowerSite(e){if(null!=this.Edges)for(const t of this.Edges)if(t.lowerSite==e)return t;return null}AddInEdge(e){null==this.InEdges&&(this.InEdges=new Array),this.InEdges.push(e)}*Triangles(){let e;if(null!=this.Edges&&this.Edges.length>0)e=this.Edges[0];else{if(!(null!=this.InEdges&&this.InEdges.length>0))return;e=this.InEdges[0]}let t=e;do{const n=t.upperSite==this?t.CcwTriangle:t.CwTriangle;if(null==n){t=null;break}yield n,t=n.TriEdges.getItem(n.TriEdges.index(t)+2)}while(t!=e);if(t!=e)for(t=e;;){const n=t.upperSite==this?t.CwTriangle:t.CcwTriangle;if(null==n)break;yield n,t=n.TriEdges.getItem(n.TriEdges.index(t)+1)}}toString(){return this.point.toString()}}class dg{constructor(e,t){this.RightSite=t.upperSite==e?t.lowerSite:t.upperSite,this.LeftSite=e,this.Edge=t}get x(){return this.LeftSite.point.x}toString(){return"("+this.LeftSite.toString()+", "+this.Edge.toString()+","+this.RightSite.toString()+")"}}class xT{has(e){return e==this.item0||e==this.item1||e==this.item2}index(e){return e==this.item0?0:e==this.item1?1:e==this.item2?2:-1}getItem(e){switch(e){case 0:case 3:case-3:return this.item0;case 1:case 4:case-2:return this.item1;case 2:case 5:case-1:return this.item2;default:throw new Error}}setItem(e,t){switch(e){case 0:case 3:case-3:this.item0=t;break;case 1:case 4:case-2:this.item1=t;break;case 2:case 5:case-1:this.item2=t;break;default:throw new Error}}[Symbol.iterator](){return this.GetEnumerator()}*GetEnumerator(){yield this.item0,yield this.item1,yield this.item2}}class qo{constructor(){this.TriEdges=new xT,this.Sites=new xT}static mkSSSD(e,t,n,i){const s=k.getTriangleOrientation(e.point,t.point,n.point),o=new qo;switch(s){case nt.Counterclockwise:o.FillCcwTriangle(e,t,n,i);break;case nt.Clockwise:o.FillCcwTriangle(e,n,t,i);break;default:throw new Error}return o}static mkSED(e,t,n){const i=new qo;switch(k.getTriangleOrientation(t.upperSite.point,t.lowerSite.point,e.point)){case nt.Counterclockwise:t.CcwTriangle=i,i.Sites.setItem(0,t.upperSite),i.Sites.setItem(1,t.lowerSite);break;case nt.Clockwise:t.CwTriangle=i,i.Sites.setItem(0,t.lowerSite),i.Sites.setItem(1,t.upperSite);break;default:throw new Error}return i.TriEdges.setItem(0,t),i.Sites.setItem(2,e),i.CreateEdge(1,n),i.CreateEdge(2,n),i}static mkSSSEE(e,t,n,i,s,o){const a=qo.mkSSSD(e,t,n,o);return a.TriEdges.setItem(0,i),a.TriEdges.setItem(1,s),a.BindEdgeToTriangle(e,i),a.BindEdgeToTriangle(t,s),a.CreateEdge(2,o),a}BindEdgeToTriangle(e,t){e==t.upperSite?t.CcwTriangle=this:t.CwTriangle=this}FillCcwTriangle(e,t,n,i){this.Sites.setItem(0,e),this.Sites.setItem(1,t),this.Sites.setItem(2,n);for(let s=0;s<3;s++)this.CreateEdge(s,i)}CreateEdge(e,t){const n=this.Sites.getItem(e),s=t(n,this.Sites.getItem(e+1));this.TriEdges.setItem(e,s),this.BindEdgeToTriangle(n,s)}Contains(e){return this.Sites.has(e)}OppositeEdge(e){const t=this.Sites.index(e);return this.TriEdges.getItem(t+1)}OppositeSite(e){const t=this.TriEdges.index(e);return this.Sites.getItem(t+2)}BoundingBox(){const e=lt.mkPP(this.Sites.getItem(0).point,this.Sites.getItem(1).point);return e.add(this.Sites.getItem(2).point),e}static mkSSSEED(e,t,n,i,s,o){const a=new qo;return a.Sites.setItem(0,e),a.Sites.setItem(1,t),a.Sites.setItem(2,n),a.TriEdges.setItem(0,i),a.TriEdges.setItem(1,s),a.BindEdgeToTriangle(e,i),a.BindEdgeToTriangle(t,s),a.CreateEdge(2,o),a}toString(){return this.Sites.getItem(0).toString()+","+this.Sites.getItem(1).toString()+","+this.Sites.getItem(2).toString()}}class k4{constructor(e,t,n,i,s){this.elementsToBeRemovedFromFront=new Array,this.removedTriangles=new Array,this.edge=e,this.triangles=t,this.front=n,this.leftPolygon=i,this.rightPolygon=s,this.a=e.upperSite,this.b=e.lowerSite}Run(){this.Init(),this.Traverse()}Traverse(){for(;!this.BIsReached();)null!=this.piercedToTheLeftFrontElemNode?this.ProcessLeftFrontPiercedElement():null!=this.piercedToTheRightFrontElemNode?this.ProcessRightFrontPiercedElement():this.ProcessPiercedEdge();null!=this.piercedTriangle&&this.removePiercedTriangle(this.piercedTriangle),this.FindMoreRemovedFromFrontElements();for(const e of this.elementsToBeRemovedFromFront)this.front.remove(e)}ProcessLeftFrontPiercedElement(){let e=this.piercedToTheLeftFrontElemNode;do{this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToLeftPolygon(e.item.LeftSite),e=this.front.previous(e)}while(k.pointToTheLeftOfLine(e.item.LeftSite.point,this.a.point,this.b.point));this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToRightPolygon(e.item.LeftSite),e.item.LeftSite!=this.b?(this.FindPiercedTriangle(e),this.piercedToTheLeftFrontElemNode=null):this.piercedToTheLeftFrontElemNode=e}FindPiercedTriangle(e){var t;const n=e.item.Edge,i=null!==(t=n.CcwTriangle)&&void 0!==t?t:n.CwTriangle,s=i.TriEdges.index(n);for(let o=1;o<=2;o++){const a=i.TriEdges.getItem(o+s),l=zo.sign(k.signedDoubledTriangleArea(a.lowerSite.point,this.a.point,this.b.point));if(zo.sign(k.signedDoubledTriangleArea(a.upperSite.point,this.a.point,this.b.point))*l<=0){this.piercedTriangle=i,this.piercedEdge=a;break}}}FindMoreRemovedFromFrontElements(){for(const e of this.removedTriangles)for(const t of e.TriEdges)if(null==t.CcwTriangle&&null==t.CwTriangle){const i=_i.FindNodeInFrontBySite(this.front,t.upperSite.point.x<t.lowerSite.point.x?t.upperSite:t.lowerSite);i.item.Edge==t&&this.elementsToBeRemovedFromFront.push(i.item)}}ProcessPiercedEdge(){this.piercedEdge.CcwTriangle==this.piercedTriangle?(this.AddSiteToLeftPolygon(this.piercedEdge.lowerSite),this.AddSiteToRightPolygon(this.piercedEdge.upperSite)):(this.AddSiteToLeftPolygon(this.piercedEdge.upperSite),this.AddSiteToRightPolygon(this.piercedEdge.lowerSite)),this.removePiercedTriangle(this.piercedTriangle),this.PrepareNextStateAfterPiercedEdge()}PrepareNextStateAfterPiercedEdge(){var e,t;const n=null!==(e=this.piercedEdge.CwTriangle)&&void 0!==e?e:this.piercedEdge.CcwTriangle,i=n.TriEdges.index(this.piercedEdge);for(let s=1;s<=2;s++){const o=n.TriEdges.getItem(s+i),a=zo.sign(k.signedDoubledTriangleArea(o.lowerSite.point,this.a.point,this.b.point));if(zo.sign(k.signedDoubledTriangleArea(o.upperSite.point,this.a.point,this.b.point))*a<=0){if(null!=o.CwTriangle&&null!=o.CcwTriangle){this.piercedTriangle=n,this.piercedEdge=o;break}this.piercedTriangle=null,this.piercedEdge=null;const c=o.upperSite.point.x<o.lowerSite.point.x?o.upperSite:o.lowerSite,d=_i.FindNodeInFrontBySite(this.front,c);c.point.x<this.a.point.x?this.piercedToTheLeftFrontElemNode=d:this.piercedToTheRightFrontElemNode=d,this.removePiercedTriangle(null!==(t=o.CwTriangle)&&void 0!==t?t:o.CcwTriangle);break}}}removePiercedTriangle(e){this.triangles.delete(e);for(const t of e.TriEdges)t.CwTriangle==e?t.CwTriangle=null:t.CcwTriangle=null,this.removedTriangles.push(e)}ProcessRightFrontPiercedElement(){let e=this.piercedToTheRightFrontElemNode;do{this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToRightPolygon(e.item.RightSite),e=this.front.next(e)}while(k.pointToTheRightOfLine(e.item.RightSite.point,this.a.point,this.b.point));this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToLeftPolygon(e.item.RightSite),e.item.RightSite!=this.b?(this.FindPiercedTriangle(e),this.piercedToTheRightFrontElemNode=null):this.piercedToTheRightFrontElemNode=e}AddSiteToLeftPolygon(e){this.AddSiteToPolygonWithCheck(e,this.leftPolygon)}AddSiteToPolygonWithCheck(e,t){e!=this.b&&(0==t.length||t[t.length-1]!=e)&&t.push(e)}AddSiteToRightPolygon(e){this.AddSiteToPolygonWithCheck(e,this.rightPolygon)}BIsReached(){var e;const t=null!==(e=this.piercedToTheLeftFrontElemNode)&&void 0!==e?e:this.piercedToTheRightFrontElemNode;return null!=t?t.item.Edge.IsAdjacent(this.b):this.piercedEdge.IsAdjacent(this.b)}Init(){const e=_i.FindNodeInFrontBySite(this.front,this.a),t=this.front.previous(e);if(k.pointToTheLeftOfLine(this.b.point,t.item.LeftSite.point,t.item.RightSite.point))this.piercedToTheLeftFrontElemNode=t;else if(k.pointToTheRightOfLine(this.b.point,e.item.RightSite.point,e.item.LeftSite.point))this.piercedToTheRightFrontElemNode=e;else for(const n of this.a.Edges){const i=n.CcwTriangle;if(null==i||k.pointToTheLeftOfLine(this.b.point,n.lowerSite.point,n.upperSite.point))continue;const s=i.TriEdges.index(n),o=i.Sites.getItem(s+2);if(k.pointToTheLeftOfLineOrOnLine(this.b.point,o.point,n.upperSite.point)){this.piercedEdge=i.TriEdges.getItem(s+1),this.piercedTriangle=i;break}}}}class LT{constructor(e,t,n,i){this.rightPolygon=new Array,this.leftPolygon=new Array,this.addedTriangles=new Array,this.edge=e,this.triangles=t,this.front=n,this.createEdgeDelegate=i}Run(){this.TraceEdgeThroughTriangles(),this.TriangulatePolygon0(this.rightPolygon,this.edge.upperSite,this.edge.lowerSite,!0),this.TriangulatePolygon0(this.leftPolygon,this.edge.upperSite,this.edge.lowerSite,!1),this.UpdateFront()}UpdateFront(){const e=new Set;for(const t of this.addedTriangles)for(const n of t.TriEdges)(null==n.CwTriangle||null==n.CcwTriangle)&&e.add(n);for(const t of e)this.AddEdgeToFront(t)}AddEdgeToFront(e){this.front.insert(new dg(e.upperSite.point.x<e.lowerSite.point.x?e.upperSite:e.lowerSite,e))}TriangulatePolygon0(e,t,n,i){e.length>0&&this.TriangulatePolygon1(0,e.length-1,e,t,n,i)}TriangulatePolygon1(e,t,n,i,s,o){let a=n[e],l=e;for(let d=e+1;d<=t;d++){const b=n[d];LT.LocalInCircle(b,i,s,a,o)&&(l=d,a=b)}const c=qo.mkSSSD(i,s,a,this.createEdgeDelegate);this.triangles.add(c),this.addedTriangles.push(c),e<l&&this.TriangulatePolygon1(e,l-1,n,i,a,o),l<t&&this.TriangulatePolygon1(l+1,t,n,a,s,o)}static LocalInCircle(e,t,n,i,s){return s?FT(e,t,i,n):FT(e,t,n,i)}TraceEdgeThroughTriangles(){new k4(this.edge,this.triangles,this.front,this.leftPolygon,this.rightPolygon).Run()}}class OL{constructor(e){this.Edge=e}}class _i extends Rr{constructor(e,t,n,i){if(super(null),this.front=new uo((o,a)=>o.x-a.x),this.triangles=new Set,this.listOfSites=e,0==this.listOfSites.length)return;this.p_1=t,this.p_2=n,this.createEdgeDelegate=i;const s=qo.mkSSSD(t,n,this.listOfSites[0],i);this.triangles.add(s),this.front.insert(new dg(t,s.TriEdges.getItem(2))),this.front.insert(new dg(this.listOfSites[0],s.TriEdges.getItem(1)))}run(){if(0!=this.listOfSites.length){for(let e=1;e<this.listOfSites.length;e++)this.ProcessSite(this.listOfSites[e]);this.FinalizeTriangulation()}}FinalizeTriangulation(){this.RemoveP1AndP2Triangles(),this.triangles.size>0&&this.MakePerimeterConvex()}MakePerimeterConvex(){let e=this.CreateDoubleLinkedListOfPerimeter();for(;;){const t=this.FindConcaveEdge(e);if(null==t)return;e=this.ShortcutTwoListElements(t)}}FindConcaveEdge(e){let n,t=e;do{if(n=t.Next,k.getTriangleOrientation(t.Start.point,t.End.point,n.End.point)==nt.Counterclockwise)return t;t=n}while(n!=e);return null}static FindPivot(e){let t=e,n=e;do{n=n.Next,(n.Start.point.x<t.Start.point.x||n.Start.point.x==t.Start.point.x&&n.Start.point.y<t.Start.point.y)&&(t=n)}while(n!=e);return t}FindFirsePerimeterEdge(){for(const e of this.triangles)for(const t of e.TriEdges)if(null==t.GetOtherTriangle_T(e))return t;return null}CreateDoubleLinkedListOfPerimeter(){const e=this.FindFirsePerimeterEdge();let i,t=e,n=null,s=null;const o=new Array;do{i=_i.CreatePerimeterElementFromEdge(t),o.push(Me.mkPP(i.Start.point,i.End.point)),t=_i.FindNextEdgeOnPerimeter(t),null!=s?(i.Prev=s,s.Next=i):n=i,s=i}while(t!=e);return n.Prev=i,i.Next=n,n}static FindNextEdgeOnPerimeter(e){var t;let n=null!==(t=e.CwTriangle)&&void 0!==t?t:e.CcwTriangle;for(e=n.TriEdges.getItem(n.TriEdges.index(e)+2);null!=e.CwTriangle&&null!=e.CcwTriangle;)n=e.GetOtherTriangle_T(n),e=n.TriEdges.getItem(n.TriEdges.index(e)+2);return e}static CreatePerimeterElementFromEdge(e){const t=new OL(e);return null!=e.CwTriangle?(t.Start=e.upperSite,t.End=e.lowerSite):(t.End=e.upperSite,t.Start=e.lowerSite),t}RemoveP1AndP2Triangles(){const e=new Set;for(const t of this.triangles)(t.Sites.has(this.p_1)||t.Sites.has(this.p_2))&&e.add(t);for(const t of e)_i.RemoveTriangleWithEdges(this.triangles,t)}static RemoveTriangleWithEdges(e,t){e.delete(t);for(const n of t.TriEdges)n.CwTriangle==t?n.CwTriangle=null:n.CcwTriangle=null,null==n.CwTriangle&&null==n.CcwTriangle&&MT(n.upperSite.Edges,n)}static RemoveTriangleButLeaveEdges(e,t){e.delete(t);for(const n of t.TriEdges)n.CwTriangle==t?n.CwTriangle=null:n.CcwTriangle=null}ProcessSite(e){this.PointEvent(e);for(let t=0;t<e.Edges.length;t++){const n=e.Edges[t];n.Constrained&&this.EdgeEvent(n)}}EdgeEvent(e){_i.EdgeIsProcessed(e)||new LT(e,this.triangles,this.front,this.createEdgeDelegate).Run()}static EdgeIsProcessed(e){return null!=e.CwTriangle||null!=e.CcwTriangle}ShowFrontWithSite(e,t=null){const n=new Array;if(null!=e.Edges)for(const i of e.Edges)n.push(qt.mkDebugCurveTWCI(200,.8,i.Constrained?"Pink":"Brown",Me.mkPP(i.upperSite.point,i.lowerSite.point)));n.push(qt.mkDebugCurveTWCI(200,1,"Brown",Tn.mkFullEllipseNNP(.5,.5,e.point)));for(const i of this.triangles)for(let s=0;s<3;s++){const o=i.TriEdges.getItem(s);n.push(qt.mkDebugCurveTWCI(o.Constrained?155:100,o.Constrained?.8:.4,o.Constrained?"Pink":"Navy",Me.mkPP(o.upperSite.point,o.lowerSite.point)))}if(null!=t)for(const i of t)n.push(qt.mkDebugCurveTWCI(100,.5,"Red",i));for(const i of this.front)n.push(qt.mkDebugCurveTWCI(100,5.5,"Green",Me.mkPP(i.Edge.upperSite.point,i.Edge.lowerSite.point)))}Show(e){_i.ShowCdt(Array.from(this.triangles.values()),this.front,null,null,[],e)}static ShowCdt(e,t,n,i,s,o){let a=new Array;if(null!=n)for(const l of n)a.push(qt.mkDebugCurveTWCI(200,.1,"Red",l));if(null!=i)for(const l of i)a.push(qt.mkDebugCurveTWCI(200,.1,"Blue",l));if(null!=t)for(const l of t)a.push(qt.mkDebugCurveTWCI(200,.1,"Green",Me.mkPP(l.Edge.upperSite.point,l.Edge.lowerSite.point)));for(const l of e)for(let c=0;c<3;c++){const d=l.TriEdges.getItem(c);a.push(_i.GetDebugCurveOfCdtEdge(d))}a=a.concat(s)}static GetDebugCurveOfCdtEdge(e){return null==e.CcwTriangle||null==e.CwTriangle?qt.mkDebugCurveTWCI(255,.5,e.Constrained?"Brown":"Black",Me.mkPP(e.upperSite.point,e.lowerSite.point)):qt.mkDebugCurveTWCI(200,e.Constrained?.8:.2,e.Constrained?"Pink":"Navy",Me.mkPP(e.upperSite.point,e.lowerSite.point))}PointEvent(e){const t=this.ProjectToFront(e),n={rightSite:null},i=t.item.x+le.distanceEpsilon<e.point.x?this.MiddleCase(e,t,n):this.LeftCase(e,t,n);let s=this.InsertSiteIntoFront(i,e,n.rightSite);this.TriangulateEmptySpaceToTheRight(s),s=_i.FindNodeInFrontBySite(this.front,i),this.TriangulateEmptySpaceToTheLeft(s)}LeftCase(e,t,n){const i=t.item;this.InsertAndLegalizeTriangle(e,i);const s=this.front.previous(t),o=s.item.LeftSite;return n.rightSite=t.item.RightSite,this.InsertAndLegalizeTriangle(e,s.item),this.front.deleteNodeInternal(s),this.front.remove(i),o}MiddleCase(e,t,n){const i=t.item.LeftSite;return n.rightSite=t.item.RightSite,this.InsertAndLegalizeTriangle(e,t.item),this.front.deleteNodeInternal(t),i}TriangulateEmptySpaceToTheLeft(e){const t=e.item.RightSite;let n=this.front.previous(e);for(;null!=n;){const i=n.item,s=i.LeftSite,o=i.RightSite;if(!(o.point.sub(t.point).dot(s.point.sub(o.point))<0)){this.TryTriangulateBasinToTheLeft(e);break}e=this.ShortcutTwoFrontElements(n,e),n=this.front.previous(e)}}ShortcutTwoListElements(e){var t;const n=e.Next;let i=qo.mkSSSEE(e.Start,e.End,n.End,e.Edge,n.Edge,this.createEdgeDelegate);this.triangles.add(i);const s=i.TriEdges.getItem(2);this.LegalizeEdge(e.Start,i.OppositeEdge(e.Start)),i=null!==(t=s.CcwTriangle)&&void 0!==t?t:s.CwTriangle,this.LegalizeEdge(n.End,i.OppositeEdge(n.End));const o=new OL(s);return o.Start=e.Start,o.End=n.End,e.Prev.Next=o,o.Prev=e.Prev,o.Next=n.Next,n.Next.Prev=o,o}ShortcutTwoFrontElements(e,t){var n;const i=e.item,s=t.item;let o=qo.mkSSSEED(i.LeftSite,i.RightSite,s.RightSite,i.Edge,s.Edge,this.createEdgeDelegate);this.triangles.add(o),this.front.deleteNodeInternal(e),this.front.remove(s);const a=o.TriEdges.getItem(2);return this.LegalizeEdge(i.LeftSite,o.OppositeEdge(i.LeftSite)),o=null!==(n=a.CcwTriangle)&&void 0!==n?n:a.CwTriangle,this.LegalizeEdge(s.RightSite,o.OppositeEdge(s.RightSite)),this.front.insert(new dg(i.LeftSite,a))}TryTriangulateBasinToTheLeft(e){if(!_i.DropsSharpEnoughToTheLeft(e.item))return;const t=new cr.K;for(t.push(e.item.LeftSite);;){const n=t.pop();e=_i.FindNodeInFrontBySite(this.front,n);const i=this.front.previous(e);if(null==i)return;if(k.getTriangleOrientation(i.item.LeftSite.point,e.item.LeftSite.point,e.item.RightSite.point)==nt.Counterclockwise)t.push(i.item.LeftSite),this.ShortcutTwoFrontElements(i,e);else if(e.item.LeftSite.point.y>e.item.RightSite.point.y)t.push(i.item.LeftSite);else{if(i.item.LeftSite.point.y<=i.item.RightSite.point.y)return;t.push(i.item.LeftSite)}}}static DropsSharpEnoughToTheLeft(e){const t=e.Edge;if(e.RightSite!=t.upperSite)return!1;const n=t.lowerSite.point.sub(t.upperSite.point);return n.x>=.5*n.y}InsertSiteIntoFront(e,t,n){let i=null,s=null;for(const o of t.Edges)if(null==s&&o.lowerSite==e&&(s=o),null==i&&o.lowerSite==n&&(i=o),null!=s&&null!=i)break;return this.front.insert(new dg(e,s)),this.front.insert(new dg(t,i))}TriangulateEmptySpaceToTheRight(e){const n=e.item.LeftSite.point;let i=this.front.next(e);for(;null!=i;){const s=i.item,o=s.LeftSite,a=s.RightSite;if(!(o.point.sub(n).dot(a.point.sub(o.point))<0)){this.TryTriangulateBasinToTheRight(e);break}e=this.ShortcutTwoFrontElements(e,i),i=this.front.next(e)}}TryTriangulateBasinToTheRight(e){if(!_i.DropsSharpEnoughToTheRight(e.item))return;const t=new cr.K;for(t.push(e.item.LeftSite);;){const n=t.pop();e=_i.FindNodeInFrontBySite(this.front,n);const i=this.front.next(e);if(null==i)return;if(k.getTriangleOrientation(e.item.LeftSite.point,e.item.RightSite.point,i.item.RightSite.point)==nt.Counterclockwise)this.ShortcutTwoFrontElements(e,i),t.push(n);else if(e.item.LeftSite.point.y>e.item.RightSite.point.y)t.push(e.item.RightSite);else{if(i.item.LeftSite.point.y>=i.item.RightSite.point.y)return;t.push(e.item.RightSite)}}}static DropsSharpEnoughToTheRight(e){const t=e.Edge;if(e.LeftSite!=t.upperSite)return!1;const n=t.lowerSite.point.sub(t.upperSite.point);return n.x<=-.5*n.y}static FindNodeInFrontBySite(e,t){return e.findLast(n=>n.LeftSite.point.x<=t.point.x)}InsertAndLegalizeTriangle(e,t){var n;if(k.getTriangleOrientation(e.point,t.LeftSite.point,t.RightSite.point)!=nt.Collinear){const i=qo.mkSED(e,t.Edge,this.createEdgeDelegate);this.triangles.add(i),this.LegalizeEdge(e,i.TriEdges.getItem(0))}else{const i=t.Edge;MT(i.upperSite.Edges,i);let s=null!==(n=i.CcwTriangle)&&void 0!==n?n:i.CwTriangle;const o=s.OppositeSite(i);_i.RemoveTriangleButLeaveEdges(this.triangles,s),s=qo.mkSSSD(t.LeftSite,o,e,this.createEdgeDelegate);const a=qo.mkSSSD(t.RightSite,o,e,this.createEdgeDelegate);this.triangles.add(s),this.triangles.add(a),this.LegalizeEdge(e,s.OppositeEdge(e)),this.LegalizeEdge(e,a.OppositeEdge(e))}}LegalizeEdge(e,t){t.Constrained||null==t.CcwTriangle||null==t.CwTriangle||(t.CcwTriangle.Contains(e)?this.LegalizeEdgeForOtherCwTriangle(e,t):this.LegalizeEdgeForOtherCcwTriangle(e,t))}LegalizeEdgeForOtherCwTriangle(e,t){const n=t.CwTriangle.TriEdges.index(t);if(IL(e,t.upperSite,t.CwTriangle.Sites.getItem(n+2),t.lowerSite)){const i=PL(e,t);this.LegalizeEdge(e,i.CwTriangle.OppositeEdge(e)),this.LegalizeEdge(e,i.CcwTriangle.OppositeEdge(e))}}LegalizeEdgeForOtherCcwTriangle(e,t){const n=t.CcwTriangle.TriEdges.index(t);if(IL(e,t.lowerSite,t.CcwTriangle.Sites.getItem(n+2),t.upperSite)){const i=PL(e,t);this.LegalizeEdge(e,i.CwTriangle.OppositeEdge(e)),this.LegalizeEdge(e,i.CcwTriangle.OppositeEdge(e))}}ProjectToFront(e){return this.front.findLast(t=>t.x<=e.point.x)}}function MT(r,e){if(0==r.length)return;const t=r.findIndex(n=>e==n);t>=0&&(t!=r.length-1&&(r[t]=r[r.length-1]),r.pop())}function IL(r,e,t,n){return function G4(r,e,t,n){return k.getTriangleOrientation(e.point,r.point,t.point)==nt.Clockwise&&k.getTriangleOrientation(t.point,r.point,n.point)==nt.Clockwise}(r,e,t,n)&&FT(r,e,t,n)}function FT(r,e,t,n){const i=e.point.x-r.point.x,s=e.point.y-r.point.y,o=t.point.x-r.point.x,a=t.point.y-r.point.y,l=n.point.x-r.point.x,c=n.point.y-r.point.y,d=i*i+s*s,b=o*o+a*a,N=l*l+c*c;return i*(a*N-c*b)-o*(s*N-c*d)+l*(s*b-a*d)>le.tolerance}function PL(r,e){let t,n;e.CcwTriangle.Contains(r)?(t=e.CcwTriangle,n=e.CwTriangle):(t=e.CwTriangle,n=e.CcwTriangle);const i=t.TriEdges.index(e),s=n.TriEdges.index(e),o=n.Sites.getItem(s+2),a=t.TriEdges.getItem(i+1),l=n.TriEdges.getItem(s+1),c=Ir.GetOrCreateEdge(r,o);return t.Sites.setItem(i+1,o),t.TriEdges.setItem(i,l),t.TriEdges.setItem(i+1,c),n.Sites.setItem(s+1,r),n.TriEdges.setItem(s,a),n.TriEdges.setItem(s+1,c),l.lowerSite==o?l.CcwTriangle=t:l.CwTriangle=t,a.lowerSite==r?a.CcwTriangle=n:a.CwTriangle=n,c.upperSite==r?(c.CcwTriangle=n,c.CwTriangle=t):(c.CcwTriangle=t,c.CwTriangle=n),MT(e.upperSite.Edges,e),c}class Ir extends Rr{constructor(e,t,n){super(null),this.isolatedSites=[],this.obstacles=[],this.PointsToSites=new Vs,this.cdtTree=null,this.isolatedSites=e,this.obstacles=t,this.isolatedSegments=n}static constructor_(e){const t=new Ir(null,null,null);return t.isolatedSitesWithObject=e,t}FillAllInputSites(){if(null!=this.isolatedSitesWithObject)for(const e of this.isolatedSitesWithObject)this.AddSite(e[0],e[1]);if(null!=this.isolatedSites)for(const e of this.isolatedSites)this.AddSite(e,null);if(null!=this.obstacles)for(const e of this.obstacles)this.AddPolylineToAllInputSites(e);if(null!=this.isolatedSegments)for(const e of this.isolatedSegments)this.AddConstrainedEdge(e.A,e.B,null);this.AddP1AndP2(),this.allInputSites=Array.from(this.PointsToSites.values())}AddSite(e,t){let n;return(n=this.PointsToSites.get(e))?n.Owner=t:(n=Hy.mkSO(e,t),this.PointsToSites.set(e,n)),n}AddP1AndP2(){const e=lt.mkEmpty();for(const i of this.PointsToSites.keys())e.add(i);const t=Math.max(e.width/3,1),n=Math.max(e.height/3,1);this.P1=new Hy(e.leftBottom.add(new k(-t,-n))),this.P2=new Hy(e.rightBottom.add(new k(t,-n)))}AddPolylineToAllInputSites(e){for(let t=e.startPoint;null!=t.next;t=t.next)this.AddConstrainedEdge(t.point,t.next.point,e);e.closed&&this.AddConstrainedEdge(e.endPoint.point,e.startPoint.point,e)}AddConstrainedEdge(e,t,n){let s,o;Ir.AbovePP(e,t)>0?(s=this.AddSite(e,n),o=this.AddSite(t,n)):(s=this.AddSite(t,n),o=this.AddSite(e,n)),Ir.CreateEdgeOnOrderedCouple(s,o).Constrained=!0}static GetOrCreateEdge(e,t){if(1==Ir.AboveCC(e,t)){const n=e.EdgeBetweenUpperSiteAndLowerSite(t);return null!=n?n:Ir.CreateEdgeOnOrderedCouple(e,t)}{const n=t.EdgeBetweenUpperSiteAndLowerSite(e);return null!=n?n:Ir.CreateEdgeOnOrderedCouple(t,e)}}static CreateEdgeOnOrderedCouple(e,t){return new B4(e,t)}GetTriangles(){return this.sweeper.triangles}run(){this.Initialization(),this.SweepAndFinalize()}SweepAndFinalize(){this.sweeper=new _i(this.allInputSites,this.P1,this.P2,Ir.GetOrCreateEdge),this.sweeper.run()}Initialization(){this.FillAllInputSites(),this.allInputSites.sort(Ir.OnComparison)}static OnComparison(e,t){return Ir.AboveCC(e,t)}static AbovePP(e,t){let n=e.y-t.y;return n>0?1:n<0?-1:(n=e.x-t.x,n>0?-1:n<0?1:0)}static AboveCC(e,t){return Ir.AbovePP(e.point,t.point)}RestoreEdgeCapacities(){for(const e of this.allInputSites)for(const t of e.Edges)t.Constrained||(t.ResidualCapacity=t.Capacity)}SetInEdges(){for(const e of this.PointsToSites.values())for(const t of e.Edges)t.lowerSite.AddInEdge(t)}FindSite(e){return this.PointsToSites.get(e)}static PointIsInsideOfTriangle(e,t){for(let n=0;n<3;n++){const i=t.Sites.getItem(n).point,s=t.Sites.getItem(n+1).point;if(k.signedDoubledTriangleArea(e,i,s)<-1*le.distanceEpsilon)return!1}return!0}GetCdtTree(){return null==this.cdtTree&&(this.cdtTree=Tr(Array.from(this.GetTriangles().values()).map(e=>gi(e,e.BoundingBox())))),this.cdtTree}EdgeIsCorrect(e){const t=e.upperSite;let n=!1;for(const s of t.Edges)if(s==e){n=!0;break}return!!n&&this.PointsToSites.get(t.point)==t}}class Yy{constructor(e,t){this.start=e,this.end=t}add(e){this.add_d(e)}add_rect(e){const t=e,n=this.clone();return n.add_d(t.start),n.add_d(t.end),n}clone(){return new Yy(this.start,this.end)}contains_point(e){return this.contains_d(e)}contains_rect(e){const t=e;return this.contains_d(t.start)&&this.contains_d(t.end)}intersection_rect(e){const t=e;return new Yy(Math.max(this.start,t.start),Math.min(this.end,t.end))}intersects_rect(e){return this.intersects(e)}contains_point_radius(e,t){return this.contains_d(e-t)&&this.contains_d(e+t)}static mkInterval(e,t){const n=new Yy(e.start,e.end);return n.add_d(t.start),n.add_d(t.end),n}add_d(e){this.start>e&&(this.start=e),this.end<e&&(this.end=e)}get Start(){return this.start}set Start(e){this.start=e}get Length(){return this.end-this.start}contains_d(e){return this.start<=e&&e<=this.end}GetInRange(e){return e<this.start?this.start:e>this.end?this.end:e}intersects(e){return!(e.start>this.end+le.distanceEpsilon||e.end<this.start-le.distanceEpsilon)}}class NL{constructor(e){this.heapSize=0,this._priors=new Array(e),this._heap=new Array(e+1),this._reverse_heap=new Array(e)}get Count(){return this.heapSize}SwapWithParent(e){const t=this._heap[e>>1];this.PutAtI(e>>1,this._heap[e]),this.PutAtI(e,t)}Enqueue(e,t){this.heapSize++;let n=this.heapSize;for(this._priors[e]=t,this.PutAtI(n,e);n>1&&this._priors[this._heap[n>>1]]>t;)this.SwapWithParent(n),n>>=1}PutAtI(e,t){this._heap[e]=t,this._reverse_heap[t]=e}Dequeue(){if(0==this.heapSize)throw new Error;const e=this._heap[1];if(this.heapSize>1){this.PutAtI(1,this._heap[this.heapSize]);let t=1;for(;;){let n=t;const i=t<<1;i<=this.heapSize&&this._priors[this._heap[i]]<this._priors[this._heap[t]]&&(n=i);const s=i+1;if(s<=this.heapSize&&this._priors[this._heap[s]]<this._priors[this._heap[n]]&&(n=s),n==t)break;this.SwapWithParent(n),t=n}}return this.heapSize--,e}IsEmpty(){return 0==this.heapSize}DecreasePriority(e,t){this._priors[e]=t;let n=this._reverse_heap[e];for(;n>1&&this._priors[this._heap[n]]<this._priors[this._heap[n>>1]];)this.SwapWithParent(n),n>>=1}}class V4{constructor(e,t,n,i){this._numberOfOverlaps=0,this._proximityEdges=e,this._nodeSizes=t,this._nodePositions=n,this._forLayers=i,this._q=new NL(2*t.length)}Run(){return this.InitQueue(),this.FindOverlaps(),this._numberOfOverlaps}FindOverlaps(){for(;this._q.Count>0;){let e=this._q.Dequeue();e<this._nodePositions.length?(this.FindOverlapsWithInterval(e),this.AddIntervalToTree(e)):(e-=this._nodePositions.length,this.RemoveIntervalFromTree(e))}}RemoveIntervalFromTree(e){this._intervalTree.Remove(this.GetInterval(e),e)}AddIntervalToTree(e){const t=this.GetInterval(e);null==this._intervalTree&&(this._intervalTree=sT([])),this._intervalTree.Add(t,e)}FindOverlapsWithInterval(e){if(null==this._intervalTree)return;const t=this.GetInterval(e);for(const n of this._intervalTree.GetAllIntersecting(t)){const i=Sl.GetIdealEdge(e,n,this._nodePositions[e],this._nodePositions[n],this._nodeSizes);if(i.overlapFactor<=1)return;this._proximityEdges.push(i),this._numberOfOverlaps++}}GetInterval(e){const t=this._nodeSizes[e].width/2,n=this._nodePositions[e].x;return new Yy(n-t,n+t)}InitQueue(){for(let e=0;e<this._nodeSizes.length;e++){const t=this._nodeSizes[e].height/2,n=this._nodePositions[e].y;this._q.Enqueue(e,n-t),this._q.Enqueue(this._nodeSizes.length+e,n+t)}}}class _L{constructor(e,t,n){this.treeNodes=new Set,this.hedgehog=new Map,this.graph=e,this.weight=t,this.root=n,this.q=new NL(this.graph.nodeCount)}NodeIsInTree(e){return this.treeNodes.has(e)}GetTreeEdges(){const e=new Array;for(this.Init();e.length<this.graph.nodeCount-1&&this.q.Count>0;)this.AddEdgeToTree(e);return e}AddEdgeToTree(e){const t=this.q.Dequeue(),n=this.hedgehog.get(t);this.treeNodes.add(t),e.push(n),this.UpdateOutEdgesOfV(t),this.UpdateInEdgesOfV(t)}UpdateOutEdgesOfV(e){for(const t of this.graph.outEdges[e]){const n=t.target;if(this.NodeIsInTree(n))continue;const i=this.hedgehog.get(n);if(i){const s=this.weight(i),o=this.weight(t);o<s&&(this.q.DecreasePriority(n,o),this.hedgehog.set(n,t))}else this.q.Enqueue(n,this.weight(t)),this.hedgehog.set(n,t)}}UpdateInEdgesOfV(e){for(const t of this.graph.inEdges[e]){const n=t.source;if(this.NodeIsInTree(n))continue;const i=this.hedgehog.get(n);if(i){const s=this.weight(i),o=this.weight(t);o<s&&(this.q.DecreasePriority(n,o),this.hedgehog.set(n,t))}else this.q.Enqueue(n,this.weight(t)),this.hedgehog.set(n,t)}}Init(){this.treeNodes.add(this.root);for(const e of this.graph.outEdges[this.root]){const t=this.weight(e);this.q.Enqueue(e.target,t),this.hedgehog.set(e.target,e)}for(const e of this.graph.inEdges[this.root]){const t=this.weight(e);this.q.Enqueue(e.source,t),this.hedgehog.set(e.source,e)}}}class BT{static GetMst(e,t){if(0==e.length)return null;const n=e.map(l=>new fn(l.source,l.target)),i=n.reduce((l,c)=>Math.max(l,Math.max(c.x,c.y)),0),s=new qf(i+1);for(let l=0;l<e.length;l++)s.setPair(n[l],e[l]);const o=dc(n,t);return new _L(o,l=>s.get(l.source,l.target).weight,n[0].source).GetTreeEdges().map(l=>s.get(l.source,l.target))}static GetMstOnCdt(e,t){const n=Array.from(e.PointsToSites.values()),i=new Map;for(let l=0;l<n.length;l++)i.set(n[l],l);const s=BT.GetEdges(n,i),o=Ux(Array.from(s.keys()));return new _L(o,l=>t(s.get(l.source,l.target)),0).GetTreeEdges().map(l=>s.get(l.source,l.target))}static GetEdges(e,t){const n=new qf(e.length);for(let i=0;i<e.length;i++){const s=e[i],o=t.get(s);for(const a of s.Edges)n.set(o,t.get(a.lowerSite),a)}return n}}class kT{constructor(){this.epsilon=.01,this.iterationsMax=1e3,this.stopOnMaxIterat=!1,this.nodeSeparation=4,this.randomizationSeed=1,this.randomizeAllPointsOnStart=!1}get StopOnMaxIterat(){return this.stopOnMaxIterat}set StopOnMaxIterat(e){this.stopOnMaxIterat=e}get Epsilon(){return this.epsilon}set Epsilon(e){this.epsilon=e}get IterationsMax(){return this.iterationsMax}set IterationsMax(e){this.iterationsMax=e}get NodeSeparation(){return this.nodeSeparation}set NodeSeparation(e){this.nodeSeparation=e}get RandomizationSeed(){return this.randomizationSeed}set RandomizationSeed(e){this.randomizationSeed=e}get RandomizeAllPointsOnStart(){return this.randomizeAllPointsOnStart}set RandomizeAllPointsOnStart(e){this.randomizeAllPointsOnStart=e}Clone(){const e=new kT;return e.Epsilon=this.Epsilon,e.IterationsMax=this.IterationsMax,e.StopOnMaxIterat=this.StopOnMaxIterat,e.NodeSeparation=this.NodeSeparation,e.RandomizationSeed=this.RandomizationSeed,e.RandomizeAllPointsOnStart=this.randomizeAllPointsOnStart,e}}class Sl{constructor(e,t){this._settings=e,this._nodes=t}static RemoveOverlaps(e,t){const n=new kT;n.RandomizeAllPointsOnStart=!0,n.NodeSeparation=t,new Sl(n,e).RemoveOverlaps()}RemoveOverlaps(){if(this._nodes.length<3)return void this.RemoveOverlapsOnTinyGraph();const e={nodePositions:new Array,nodeSizes:new Array};for(function H4(r,e,t){t.nodePositions=e.map(n=>n.center),t.nodeSizes=e.map(n=>{const i=n.boundingBox.size;return i.width+=r.NodeSeparation,i.height+=r.NodeSeparation,i})}(this._settings,this._nodes,e),this.lastRunNumberIterations=0;this.OneIteration(e.nodePositions,e.nodeSizes,!1);)this.lastRunNumberIterations++;for(;this.OneIteration(e.nodePositions,e.nodeSizes,!0);)this.lastRunNumberIterations++;for(let t=0;t<this._nodes.length;t++)this._nodes[t].center=e.nodePositions[t]}RemoveOverlapsOnTinyGraph(){if(1!=this._nodes.length&&2==this._nodes.length){const e=this._nodes[0],t=this._nodes[1];k.closeDistEps(e.center,t.center)&&(t.center=t.center.add(new k(.001,0)));const n=this.GetIdealDistanceBetweenTwoNodes(e,t),i=k.middle(e.center,t.center);let s=e.center.sub(t.center);s=s.mul(n/s.length*.5),e.center=i.add(s),t.center=i.sub(s)}}GetIdealDistanceBetweenTwoNodes(e,t){const n=e.center.sub(t.center),i=Math.abs(n.x),s=Math.abs(n.y);let l=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY;return i>le.tolerance&&(l=((e.width+t.width)/2+this._settings.NodeSeparation)/i),s>le.tolerance&&(c=((e.height+t.height)/2+this._settings.NodeSeparation)/s),Math.min(l,c)*n.length}static AvgEdgeLength(e){let t=0,n=0;for(const i of e)for(const s of i.outEdges())n+=i.center.sub(s.target.center).length,t++;return t>0?n/t:1}OneIteration(e,t,n){const i=new Array;for(let d=0;d<e.length;d++)i.push([e[d],d]);const s=Ir.constructor_(i);s.run();const o=new Map;for(let d=0;d<e.length;d++)o.set(s.PointsToSites.get(e[d]),d);let a=0;const l=new Array;for(const d of s.PointsToSites.values())for(const b of d.Edges){const N=b.upperSite.point,F=b.lowerSite.point,G=o.get(b.upperSite),W=o.get(b.lowerSite),ie=Sl.GetIdealEdge(G,W,N,F,t);l.push(ie),ie.overlapFactor>1&&a++}if(0==a||n){const d=this.FindProximityEdgesWithSweepLine(l,t,e);if(0==a&&0==d||0==a&&!n)return!1}const c=BT.GetMst(l,e.length);return Sl.MoveNodePositions(c,e,c[0].source),!0}FindProximityEdgesWithSweepLine(e,t,n){return new V4(e,t,n,this._overlapForLayers).Run()}static GetIdealEdge(e,t,n,i,s){const o={overlapFactor:0},a=Sl.GetIdealEdgeLength(e,t,n,i,s,o),l=n.sub(i).length,c=lt.mkSizeCenter(s[e],n),d=lt.mkSizeCenter(s[t],i),b=o.overlapFactor>1?l-a:Sl.GetDistanceRects(c,d);return{source:Math.min(e,t),target:Math.max(e,t),overlapFactor:o.overlapFactor,idealDistance:a,weight:b}}static GetIdealEdgeLength(e,t,n,i,s,o){const a=n.sub(i),l=a.length,c=Math.abs(a.x),d=Math.abs(a.y),b=(s[e].width+s[t].width)/2,N=(s[e].height+s[t].height)/2;if(c>=b||d>=N)return o.overlapFactor=1,a.length;let F;const G=1e-10;if(c>G)F=d>G?Math.min(b/c,N/d):b/c;else{if(!(d>G))return o.overlapFactor=2,Math.sqrt(b*b+N*N)/4;F=N/d}return F=Math.max(F,1.001),o.overlapFactor=F,F*l}static GetDistanceRects(e,t){if(e.intersects(t))return 0;let n=0,i=0;return(e.right<t.left||t.right<e.left)&&(i=e.left-t.right),e.top<t.bottom?n=t.bottom-e.top:t.top<e.bottom&&(n=e.bottom-t.top),Math.sqrt(i*i+n*n)}static MoveNodePositions(e,t,n){const i=t.map(o=>o.clone()),s=new Set;s.add(n);for(let o=0;o<e.length;o++){const a=e[o];s.has(a.source)?Sl.MoveNode(a.source,a.target,i,t,s,a.idealDistance):Sl.MoveNode(a.target,a.source,i,t,s,a.idealDistance)}}static MoveNode(e,t,n,i,s,o){let a=n[t].sub(n[e]);a=a.mul(o/a.length+.01),i[t]=i[e].add(a),s.add(t)}GetLastRunIterations(){return this.lastRunNumberIterations}}class qS extends Rr{constructor(e,t,n,i){super(n),this.settings=e,this.graph=t,this.length=i}run(){this.LayoutConnectedGraphWithMds(),this.SetGraphBoundingBox()}SetGraphBoundingBox(){this.graph.boundingBox=this.graph.pumpTheBoxToTheGraphWithMargins(this.settings.NodeSeparation/2)}static ScaleToAverageEdgeLength(e,t,n,i){const s=new Map;let o=0;for(const c of e.shallowNodes())s.set(c,o),o++;let a=0,l=0;for(const c of e.edges()){const d=s.get(c.source),b=s.get(c.target);l+=Math.sqrt(Math.pow(t[d]-t[b],2)+Math.pow(n[d]-n[b],2)),a+=i(c)}if(a>0&&(l/=a),l>0)for(let c=0;c<t.length;c++)t[c]/=l,n[c]/=l}static LayoutGraphWithMds(e,t,n,i){if(n.x=new Array(e.shallowNodeCount),n.y=new Array(e.shallowNodeCount),0==n.x.length)return;if(1==n.x.length)return void(n.x[0]=n.y[0]=0);const s=Math.min(t.PivotNumber,e.shallowNodeCount),o=t.GetNumberOfIterationsWithMajorization(e.shallowNodeCount),a=t.Exponent,l=new Array(s),c=new M4(e,l,i);if(c.run(),Vn.LandmarkClassicalScaling(c.Result,n,l),qS.ScaleToAverageEdgeLength(e,n.x,n.y,i),o>0){const b=new DT(e,i);b.run();const N=b.Result,F=Vn.ExponentialWeightMatrix(N,a);Vn.DistanceScalingSubset(N,n.x,n.y,F,o)}}LayoutConnectedGraphWithMds(){const e={x:[],y:[]};qS.LayoutGraphWithMds(this.graph,this.settings,e,this.length),0!=this.settings.RotationAngle&&class F4{static Rotate(e,t,n){const i=Math.sin(n*(Math.PI/180)),s=Math.cos(n*(Math.PI/180));for(let o=0;o<e.length;o++){const a=s*e[o]+i*t[o];t[o]=s*t[o]-i*e[o],e[o]=a}}}.Rotate(e.x,e.y,this.settings.RotationAngle);let t=0;for(const n of this.graph.shallowNodes())n.boundingBox&&(n.center=new k(e.x[t]*this.settings.ScaleX,e.y[t]*this.settings.ScaleY)),t++;this.settings.RemoveOverlaps&&Sl.RemoveOverlaps(Array.from(this.graph.shallowNodes()),this.settings.NodeSeparation),this.graph.pumpTheBoxToTheGraphWithMargins(this.settings.NodeSeparation/2)}ScaleNodes(e,t){for(const n of e)n.center=n.center.mul(t)}static PackGraphs(e,t){if(0==e.length)return lt.mkEmpty();if(1==e.length)return e[0].boundingBox;const n=e.map(o=>o.boundingBox),i=new Array;for(const o of e)i.push({g:o,lb:o.boundingBox.leftBottom.clone()});const s=new Bx(n,t.PackingAspectRatio);s.run();for(const{g:o,lb:a}of i){const l=o.boundingBox.leftBottom.sub(a);o.translate(l)}return new lt({left:0,bottom:0,right:s.PackedWidth,top:s.PackedHeight})}}class DL extends $x{constructor(){super(...arguments),this.pivotNumber=50,this.iterationsWithMajorization=30,this.scaleX=200,this.scaleY=200,this.exponent=-2,this.rotationAngle=0,this.removeOverlaps=!0,this._callIterationsWithMajorizationThreshold=3e3,this.adjustScale=!1}get RemoveOverlaps(){return this.removeOverlaps}set RemoveOverlaps(e){this.removeOverlaps=e}get PivotNumber(){return this.pivotNumber}set PivotNumber(e){this.pivotNumber=e}get IterationsWithMajorization(){return this.iterationsWithMajorization}set IterationsWithMajorization(e){this.iterationsWithMajorization=e}get ScaleX(){return this.scaleX}set ScaleX(e){this.scaleX=e}get ScaleY(){return this.scaleY}set ScaleY(e){this.scaleY=e}get Exponent(){return this.exponent}set Exponent(e){this.exponent=e}get RotationAngle(){return this.rotationAngle}set RotationAngle(e){this.rotationAngle=e%360}get IdealEdgeLength(){return this.edgeConstraints}set IdealEdgeLength(e){this.edgeConstraints=e}get AdjustScale(){return this.adjustScale}set AdjustScale(e){this.adjustScale=e}GetNumberOfIterationsWithMajorization(e){return e>this.CallIterationsWithMajorizationThreshold?0:this.IterationsWithMajorization}get CallIterationsWithMajorizationThreshold(){return this._callIterationsWithMajorizationThreshold}set CallIterationsWithMajorizationThreshold(e){this._callIterationsWithMajorizationThreshold=e}}class xL extends Rr{constructor(e,t,n,i){super(t),this.graph=e,this.length=n,this.settings=i,this.settings.ScaleX=this.settings.ScaleY=200}get scaleX(){return this.settings.ScaleX}set scaleX(e){this.settings.ScaleX=e}get scaleY(){return this.settings.ScaleY}set scaleY(e){this.settings.ScaleY=e}run(){new qS(this.settings,this.graph,this.cancelToken,this.length).run()}}function LL(r,e){r.layoutSettings||(r.layoutSettings=e);for(const t of r.shallowNodes())t instanceof xa&&LL(t,r.layoutSettings)}function ML(r){for(;;){if(r.layoutSettings&&r.layoutSettings.edgeRoutingSettings)return r.layoutSettings.edgeRoutingSettings;const t=r.graph.parent;if(!t)break;r=di.getGeom(t)}const e=new zx;return e.EdgeRoutingMode=Mr.Spline,e}function FL(r,e,t){const n=ML(r);n.EdgeRoutingMode==Mr.Rectilinear?function z4(r,e,t,n=1,i=3){L4.constructorGNANB(r,e,n,i,!0).run()}(r,e):n.EdgeRoutingMode==Mr.Spline||n.EdgeRoutingMode==Mr.SplineBundling?function a5(r,e,t){const n=r.layoutSettings?r.layoutSettings.edgeRoutingSettings:ML(r);new rr(r,e,n.Padding,n.PolylinePadding,n.coneAngle,n.BundlingSettings,t).run()}(r,e,t):n.EdgeRoutingMode==Mr.StraightLine?function l5(r,e,t){if(e)for(const n of e){if(t&&t.canceled)return;Ws.RouteEdge(n,r.padding)}else for(const n of r.deepNodes()){if(t&&t.canceled)return;for(const i of n.outEdges())null==i.curve&&Ws.RouteEdge(i,r.padding);for(const i of n.selfEdges())null==i.curve&&Ws.RouteEdge(i,r.padding)}}(r,e,t):n.EdgeRoutingMode!=Mr.None&&new rr(r,e).run()}function GT(r,e,t,n,i,s=!0,o=1){if(r.graph.isEmpty())return;!function MW(r){Zh=new hT(r,0)}(o);const a=function F(){const W=new Set,ie=r.graph;if(null==ie.parent)return W;for(const he of ie.shallowNodes){for(const de of he.outEdges){const Te=ie.liftNode(de.target);(null==Te||Te==he)&&W.add(de)}for(const de of he.inEdges){const Te=ie.liftNode(de.source);(null==Te||Te==he)&&W.add(de)}}for(const he of W)he.remove();return W}();!function N(W){for(const ie of W.shallowNodes())if(ie instanceof xa){const he=ie;if(GT(he,e,t,n,i),!he.graph.isEmpty()){const de=he.boundingBox;de&&!de.isEmpty()&&(ie.boundaryCurve=gs.mkRectangleWithRoundedCorners(de.width,de.height,Math.min(10,de.width/10),Math.min(10,de.height/10),de.center))}}}(r);const l=function W4(r){const e=new Array;for(const t of r.deepNodes){const n=r.liftNode(t);if(null!=n)for(const i of t.outEdges.values()){const s=i.target,o=r.liftNode(s);if(null==o||n==t&&o==s||n==o)continue;i.remove();const a=new Mx(n,o),l=new vu(a);e.push([l,i])}}return e}(r.graph),c=function j4(r){const e=r.graph,t=function*uW(r){const e=new Set,t=new mu.c;for(const s of r.shallowNodes){if(e.has(s))continue;const o=new Array;for(i(s,t,e);t.length>0;){const a=t.dequeue();o.push(a);for(const l of n(a))i(l,t,e)}yield o}function*n(s){for(const o of s.outEdges)yield o.target;for(const o of s.inEdges)yield o.source}function i(s,o,a){a.has(s)||(o.enqueue(s),a.add(s))}}(e),n=[];let i=0;for(const s of t){const o=new so(e.id+i++);o.parent=e;const a=new xa(o);a.layoutSettings=r.layoutSettings;for(const l of s)l.parent=o,o.addNode(l);n.push(a)}return n}(r);(function G(){if(0!=c.length){for(const W of c)t(W,e);i(r,c)}})(),l.forEach(W=>{W[0].edge.remove(),W[1].add()}),c.forEach(W=>{for(const ie of W.graph.shallowNodes)ie.parent=r.graph});const d=function b(W){const ie=[];for(const he of W.deepNodes()){for(const de of he.outEdges())null==de.curve&&ie.push(de);for(const de of he.selfEdges())null==de.curve&&ie.push(de)}return ie}(r);a.forEach(W=>W.add()),n(r,d,e),null==r.graph.parent&&s&&r.FlipYAndMoveLeftTopToOrigin()}class VT{static constructorStatic(e,t){const n=new VT;n.edges=e,n.nodeBoundaries=t,n.boundingBox=lt.mkEmpty();for(const i of n.nodeBoundaries)n.boundingBox=n.boundingBox.addRec(i.boundingBox);return n}AddGraph(e){this.edges=this.edges.concat(e.edges),this.nodeBoundaries=eg(this.nodeBoundaries,e.nodeBoundaries),this.boundingBox.addRec(e.boundingBox)}AddNodeBoundary(e){this.nodeBoundaries.add(e),this.boundingBox.addRec(e.boundingBox)}}var Uy=(()=>{return(r=Uy||(Uy={}))[r.Success=0]="Success",r[r.Overlaps=1]="Overlaps",r[r.EdgeSeparationIsTooLarge=2]="EdgeSeparationIsTooLarge",Uy;var r})(),BL=p(2243);class QS{constructor(e,t,n){this.currentTriangle=e,this.start=t,this.end=n}get CurrentPiercedEdge(){return this.currentPiercedEdge}get CurrentTriangle(){return this.currentTriangle}*Triangles(){for(;this.MoveNext();)yield this.CurrentTriangle}FindFirstPiercedEdge(){const e=this.GetHyperplaneSign(this.currentTriangle.Sites.item0),t=this.GetHyperplaneSign(this.currentTriangle.Sites.item1);if(e!=t&&k.getTriangleOrientation(this.end,this.currentTriangle.Sites.item0.point,this.currentTriangle.Sites.item1.point)==nt.Clockwise)return this.positiveSign=e,this.negativeSign=t,this.currentTriangle.TriEdges.item0;const n=this.GetHyperplaneSign(this.currentTriangle.Sites.item2);return t!=n&&k.getTriangleOrientation(this.end,this.currentTriangle.Sites.item1.point,this.currentTriangle.Sites.item2.point)==nt.Clockwise?(this.positiveSign=t,this.negativeSign=n,this.currentTriangle.TriEdges.item1):(this.positiveSign=n,this.negativeSign=e,this.currentTriangle.TriEdges.item2)}static PointLocationForTriangle(e,t){let n=!1;for(let i=0;i<3;i++){const s=k.signedDoubledTriangleArea(e,t.Sites.getItem(i).point,t.Sites.getItem(i+1).point);if(s<-1*le.distanceEpsilon)return Ot.Outside;s<le.distanceEpsilon&&(n=!0)}return n?Ot.Boundary:Ot.Inside}FindNextPierced(){if(this.currentTriangle=this.currentPiercedEdge.GetOtherTriangle_T(this.currentTriangle),null==this.currentTriangle)return void(this.currentPiercedEdge=null);const e=this.currentTriangle.TriEdges.index(this.currentPiercedEdge);let t;const n=this.currentTriangle.Sites.getItem(e+2),i=this.GetHyperplaneSign(n);0==this.negativeSign?-1==i||0==i?(this.negativeSign=i,t=e+1):t=e+2:0==this.positiveSign?1==i||0==i?(this.positiveSign=i,t=e+2):t=e+1:i!=this.positiveSign?(this.negativeSign=i,t=e+1):(this.positiveSign=i,t=e+2),this.currentPiercedEdge=k.signedDoubledTriangleArea(this.end,this.currentTriangle.Sites.getItem(t).point,this.currentTriangle.Sites.getItem(t+1).point)<-le.distanceEpsilon?this.currentTriangle.TriEdges.getItem(t):null}GetHyperplaneSign(e){const t=k.signedDoubledTriangleArea(this.start,e.point,this.end);return t>le.distanceEpsilon?1:t<-1*le.distanceEpsilon?-1:0}MoveNext(){return null==this.currentPiercedEdge?this.currentPiercedEdge=this.FindFirstPiercedEdge():this.FindNextPierced(),null!=this.currentPiercedEdge}}class HT{constructor(e,t){this.ComputeForcesForBundles=!1,this.metroGraphData=e,this.bundlingSettings=t}EdgeIsLegal_(e,t,n,i){if(Ir.PointIsInsideOfTriangle(t,n))return!0;const s=new QS(n,e,t);for(;s.MoveNext();){const o=s.CurrentPiercedEdge;if(o.Constrained&&!i.has(o.lowerSite.Owner))return!1}return!0}BundleAvoidsObstacles(e,t,n,i,s,o){o.closestDist=new Array;const a=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,t),l=this.FindCloseObstaclesForBundle(t.CdtTriangle,i,n,a,s);if(null==l)return!1;for(const c of l)o.closestDist.push(c[1]);return!0}FindCloseObstaclesForBundle(e,t,n,i,s){const o=new Map,a=[];if(!this.ThreadLineSegmentThroughTriangles(e,t,n,i,a))return null;if(!this.ComputeForcesForBundles&&!this.bundlingSettings.HighestQuality)return o;const l=new BL.HashSet;for(const c of a)for(const d of c.Sites){if(l.has(d))continue;l.add(d);const b=d.Owner;if(i.has(b))continue;const N=HT.FindPolylinePoint(b,d.point),F=Me.minDistBetweenLineSegments(N.point,N.nextOnPolyline.point,t,n),G=F.dist,W=F.parab,ie=F.parcd,he=Me.minDistBetweenLineSegments(N.point,N.prevOnPolyline.point,t,n),de=he.dist,Te=he.parab,Ke=he.parcd;let Xe,Et,wt;if(G<de){if(wt=G,wt>s)continue;Xe=N.point.add(N.nextOnPolyline.point.sub(N.point).mul(W)),Et=t.add(n.sub(t).mul(ie))}else{if(wt=de,wt>s)continue;Xe=N.point.add(N.prevOnPolyline.point.sub(N.point).mul(Te)),Et=t.add(n.sub(t).mul(Ke))}o.get(b)||o.set(b,[Xe,Et])}return o}ThreadLineSegmentThroughTriangles(e,t,n,i,s){if(Ir.PointIsInsideOfTriangle(n,e))return s.push(e),!0;const o=new QS(e,t,n);for(s.push(e);o.MoveNext();){s.push(o.CurrentTriangle);const a=o.CurrentPiercedEdge;if(a.Constrained&&!i.has(a.lowerSite.Owner))return!1}return null!=o.CurrentTriangle&&s.push(o.CurrentTriangle),!0}static PointLocationInsideTriangle(e,t){let n=!1;for(let i=0;i<3;i++){const s=k.signedDoubledTriangleArea(e,t.Sites.getItem(i).point,t.Sites.getItem(i+1).point);if(s<-1*le.distanceEpsilon)return Ot.Outside;s<le.distanceEpsilon&&(n=!0)}return n?Ot.Boundary:Ot.Inside}static FindPolylinePoint(e,t){for(const n of e.polylinePoints())if(n.point.equal(t))return n;throw new Error("polyline point "+t+" not found")}EdgeIsLegal(e,t,n,i){const o=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,t);return this.ThreadLineSegmentThroughTriangles(e.CdtTriangle,n,i,o,[])}static closedeb(e,t){return e.Position.sub(new k(360.561,428.416)).length<.1&&t.Position.sub(new k(414.281,440.732)).length<.1}EdgeIsLegalSSPPS(e,t,n){const i=e.Position,s=e.CdtTriangle,o=t.Position;if(Ir.PointIsInsideOfTriangle(o,s))return!0;const a=new QS(s,i,o);for(;a.MoveNext();){const l=a.CurrentPiercedEdge;if(l.Constrained&&!n.has(l.lowerSite.Owner))return!1}return!0}}class Ga{constructor(e,t,n,i){this.metroGraphData=e,this.obstaclesToIgnoreLambda=i,this.bundlingSettings=t,this.obstacleTree=n}ObstaclesToIgnoreForBundle(e,t){return null!=e&&null!=t?eg(this.obstaclesToIgnoreLambda(e),this.obstaclesToIgnoreLambda(t)):null==e&&null==t?new Set:this.obstaclesToIgnoreLambda(null!=e?e:t)}HubAvoidsObstaclesSPNBA(e,t,n,i){const s={minimalDistance:n};return Ga.IntersectCircleWithTree(this.obstacleTree,t,n,this.obstaclesToIgnoreLambda(e),i.touchedObstacles,s)}HubAvoidsObstaclesPNS__(e,t,n){const i={touchedObstacles:Array()};return this.HubAvoidsObstaclesPNSTT(e,t,n,i,{minimalDistance:0})}GetMinimalDistanceToObstacles(e,t,n){const i=new Array,s={minimalDistance:n};return Ga.IntersectCircleWithTree(this.obstacleTree,t,n,this.obstaclesToIgnoreLambda(e),i,s)?s.minimalDistance:0}HubAvoidsObstaclesPNSTT(e,t,n,i,s){return i.touchedObstacles=new Array,s.minimalDistance=t,Ga.IntersectCircleWithTree(this.obstacleTree,e,t,n,i.touchedObstacles,s)}static IntersectCircleWithTree(e,t,n,i,s,o){if(!e.irect.contains_point_radius(t,n))return!0;if(null==e.UserData){let a=Ga.IntersectCircleWithTree(e.Left,t,n,i,s,o);if(!a||(a=Ga.IntersectCircleWithTree(e.Right,t,n,i,s,o),!a))return!1}else{const a=e.UserData;if(i.has(a))return!0;if(fe.PointRelativeToCurveLocation(t,a)!=Ot.Outside)return Ga.containingPoly=a,!1;const c=a.value(a.closestParameter(t)),d=c.sub(t).length;d<=n&&s.push([a,c]),o.minimalDistance=Math.min(d,o.minimalDistance)}return!0}static Create4gon(e,t,n,i){let s=t.sub(e).normalize();return s=new k(s.y,-1*s.x),At.mkFromPoints([e.add(s.mul(n/2)),e.sub(s.mul(n/2)),t.sub(s.mul(i/2)),t.add(s.mul(i/2))])}}class $4{constructor(e,t,n,i){this.Width=t,this.Polyline=e,this.sourceAndTargetLoosePolylines=n,this.Index=i}UpdateLengths(){let e=0;for(let t=this.Polyline.startPoint;null!=t.next;t=t.next)e+=t.next.point.sub(t.point).length;this.Length=e,this.IdealLength=this.Polyline.end.sub(this.Polyline.start).length}}class K4{constructor(e,t,n){this.metroline=e,this.station=t,this.polyPoint=n}get Metroline(){return this.metroline}get PolyPoint(){return this.polyPoint}}class J4{constructor(e,t,n){this.Radius=0,this.BundleBases=new Map,this.MetroNodeInfos=new Array,this._cachedIdealRadius=0,this.SerialNumber=e,this.IsReal=t,this.Position=n}debStop(){return 28==this.SerialNumber&&this.Position.sub(new k(841.2662778763244,303.3817005853006)).length<.001}get Position(){return this._Position}set Position(e){this._Position=e}getELP(){return this.EnterableLoosePolylines}setELP(e){this.EnterableLoosePolylines=e}addEL(e){this.EnterableLoosePolylines.add(e)}static less(e,t){return e.SerialNumber<t.SerialNumber}static greater(e,t){return e.SerialNumber>t.SerialNumber}get cachedIdealRadius(){return this._cachedIdealRadius}set cachedIdealRadius(e){this._cachedIdealRadius=e}AddEnterableLoosePolyline(e){null==this.EnterableLoosePolylines&&(this.EnterableLoosePolylines=new Set),this.EnterableLoosePolylines.add(e)}AddEnterableTightPolyline(e){null==this.EnterableTightPolylines&&(this.EnterableTightPolylines=new Set),this.EnterableTightPolylines.add(e)}}class q4{constructor(){this.Width=0,this.Metrolines=new Array,this.cachedBundleCost=0}get Count(){return this.Metrolines.length}}class ns{constructor(e,t){this.metroGraphData=e,this.bundlingSettings=t}CreateNodeRadii(){for(const e of this.metroGraphData.VirtualStations())e.Radius=0,e.cachedIdealRadius=ns.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e);this.GrowHubs(!1),this.GrowHubs(!0);for(const e of this.metroGraphData.VirtualStations())e.Radius=Math.max(e.Radius,this.bundlingSettings.MinHubRadius)}GrowHubs(e){const t=new Iu($n);for(const i of this.metroGraphData.VirtualStations())t.Enqueue(i,-this.CalculatePotential(i,e));let n=!1;for(;!t.IsEmpty();){const i={priority:0},s=t.DequeueAndGetPriority(i);if(i.priority>=0)break;this.TryGrowHub(s,e)&&(t.Enqueue(s,-this.CalculatePotential(s,e)),n=!0)}return n}TryGrowHub(e,t){const n=this.CalculateAllowedHubRadius(e);if(e.Radius>=n)return!1;const i=t?ns.CalculateIdealHubRadiusWithAdjacentEdges(this.bundlingSettings,e):e.cachedIdealRadius;if(e.Radius>=i)return!1;let o=.05*(i-e.Radius);o<1&&(o=1);const a=Math.min(e.Radius+o,n);return!(a<=e.Radius||(e.Radius=a,0))}CalculatePotential(e,t){const n=t?ns.CalculateIdealHubRadiusWithAdjacentEdges(this.bundlingSettings,e):e.cachedIdealRadius;return n<=e.Radius?0:(n-e.Radius)/n}CalculateAllowedHubRadius(e){let t=this.bundlingSettings.MaxHubRadius;for(const i of e.Neighbors){const s=i.Position.sub(e.Position).length;t=Math.min(t,s/1.05-i.Radius)}const n=this.metroGraphData.tightIntersections.GetMinimalDistanceToObstacles(e,e.Position,t);return n<t&&(t=n-.001),Math.max(t,.1)}static CalculateIdealHubRadius(e,t,n){let i=1;for(const s of n.Neighbors){const a=e.GetWidthSSN(s,n,t.EdgeSeparation)/2+t.EdgeSeparation;i=Math.max(i,a)}return i=Math.min(i,2*t.MaxHubRadius),i}static CalculateIdealHubRadiusWithNeighborsMBS(e,t,n){return ns.CalculateIdealHubRadiusWithNeighborsMBNP(e,t,n,n.Position)}static CalculateIdealHubRadiusWithNeighborsMBNP(e,t,n,i){let s=ns.CalculateIdealHubRadius(e,t,n);if(n.Neighbors.length>1){const o=n.Neighbors;for(let a=0;a<o.length;a++)s=Math.max(s,ns.GetMinRadiusForTwoAdjacentBundles(s,n,i,o[a],o[(a+1)%o.length],e,t))}return s=Math.min(s,2*t.MaxHubRadius),s}static CalculateIdealHubRadiusWithAdjacentEdges(e,t){let n=e.MaxHubRadius;for(const i of t.Neighbors)n=Math.min(n,t.Position.sub(i.Position).length/2);return n}static GetMinRadiusForTwoAdjacentBundles(e,t,n,i,s,o,a){const l=o.GetWidthSSN(t,i,a.EdgeSeparation),c=o.GetWidthSSN(t,s,a.EdgeSeparation);return ns.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(e,n,i.Position,s.Position,l,c,a)}static GetMinRadiusForTwoAdjacentBundlesNPPPNNB(e,t,n,i,s,o,a){if(s<le.distanceEpsilon||o<le.distanceEpsilon)return e;let l=k.anglePCP(n,t,i);if(l=Math.min(l,2*Math.PI-l),l<le.distanceEpsilon)return 2*a.MaxHubRadius;if(l>=Math.PI/2)return 1.05*e;const c=Math.sin(l),d=Math.cos(l),b=s/(4*c),N=o/(4*c);let F=2*Math.sqrt(b*b+(N*N+b*(N*d)*2));return F=Math.min(F,2*a.MaxHubRadius),F=Math.max(F,e),F}}class XS{constructor(e,t,n,i){this.metroGraphData=e,this.bundlingSettings=t,this.costCalculator=n,this.cdt=i}InitializeCostCache(){for(const e of this.metroGraphData.VirtualStations())e.cachedIdealRadius=ns.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e),e.cachedRadiusCost=this.costCalculator.RadiusCost(e,e.Position),e.cachedBundleCost=0;for(const e of this.metroGraphData.VirtualEdges()){const t=e[0],n=e[1],i=this.metroGraphData.GetIjInfo(t,n);i.cachedBundleCost=this.costCalculator.BundleCost(t,n,t.Position),t.cachedBundleCost+=i.cachedBundleCost,n.cachedBundleCost+=i.cachedBundleCost}}UpdateCostCache(e){const t=this.cdt.GetCdtTree();e.CdtTriangle=t.FirstHitNodeWithPredicate(e.Position,XS.testPointInside).UserData,e.cachedIdealRadius=ns.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e),e.cachedRadiusCost=this.costCalculator.RadiusCost(e,e.Position),e.cachedBundleCost=0;for(const n of e.Neighbors){n.IsReal||(n.cachedIdealRadius=ns.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,n),n.cachedRadiusCost=this.costCalculator.RadiusCost(n,n.Position));const i=this.metroGraphData.GetIjInfo(e,n);n.cachedBundleCost-=i.cachedBundleCost,i.cachedBundleCost=this.costCalculator.BundleCost(e,n,e.Position),e.cachedBundleCost+=i.cachedBundleCost,n.cachedBundleCost+=i.cachedBundleCost}}static testPointInside(e,t){return Ir.PointIsInsideOfTriangle(e,t)?Kn.Stop:Kn.Continue}}class kL{constructor(){this.mainMap=new Map}get isEmpty(){return 0==this.mainMap.size||this.everyMapIsEmpty()}everyMapIsEmpty(){for(const e of this.mainMap.values())if(e.size)return!1;return!0}get(e,t){const n=this.mainMap.get(e);if(n)return n.get(t)}has(e,t){const n=this.mainMap.get(e);return!!n&&n.has(t)}set(e,t,n){let i=this.mainMap.get(e);i||(i=new Map,this.mainMap.set(e,i)),i.set(t,n)}*[Symbol.iterator](){for(const[e,t]of this.mainMap)for(const[n,i]of t)yield[e,n,i]}*keys(){for(const[e,t]of this.mainMap)for(const[n]of t)yield[e,n]}}class Q4{constructor(e,t,n,i,s,o,a,l){this.cachedEnterableLooseForEnd=new Vs,this.regularEdges=e,this.Cdt=null!=s?s:fg.CreateConstrainedDelaunayTriangulation(t),this.EdgeLooseEnterable=o,this.EdgeTightEnterable=a,this.LoosePolylineOfPort=l,this.looseIntersections=new Ga(this,i,t,c=>c.getELP()),this.tightIntersections=new Ga(this,i,n,c=>c.EnterableTightPolylines),this.cdtIntersections=new HT(this,i),this.Initialize(!1)}get Ink(){return this.ink}get Edges(){return this.regularEdges}VirtualStations(){return Array.from(this.Stations).filter(e=>!e.IsReal)}get Metrolines(){return this.metrolines}get LooseTree(){return this.looseIntersections.obstacleTree}get TightTree(){return this.tightIntersections.obstacleTree}*VirtualEdges(){for(const e of this.edgeInfoDictionary.keys())yield e}RealEdgeCount(e,t){const n=e.SerialNumber<t.SerialNumber?[e,t]:[t,e],i=this.edgeInfoDictionary.get(n[0],n[1]);return i?i.Count:0}MetroNodeInfosOfNode(e){return e.MetroNodeInfos}GetIjInfo(e,t){const n=e.SerialNumber<t.SerialNumber?[e,t]:[t,e];return this.edgeInfoDictionary.get(n[0],n[1])}MoveNode(e,t){const n=e.Position;this.PointToStations.deleteP(n),this.PointToStations.set(t,e),e.Position=t;for(const i of this.MetroNodeInfosOfNode(e))i.PolyPoint.point=t;for(const i of this.MetroNodeInfosOfNode(e)){const o=i.PolyPoint.prev.point,a=i.PolyPoint.next.point;i.Metroline.Length+=a.sub(t).length+o.sub(t).length-a.sub(n).length-o.sub(n).length}for(const i of e.Neighbors)this.ink+=t.sub(i.Position).length-n.sub(i.Position).length;this.SortNeighbors(e);for(const i of e.Neighbors)this.SortNeighbors(i)}GetWidthSSN(e,t,n){const i=e.SerialNumber<t.SerialNumber?[e,t]:[t,e],s=this.edgeInfoDictionary.get(i[0],i[1]);return s?s.Width+(s.Count-1)*n:0}GetWidthAN(e,t){let n=0;for(const s of e)n+=s.Width;const i=e.length;return n+=i>0?(i-1)*t:0,n}Initialize(e){this.SimplifyRegularEdges(),this.InitializeStationData(),this.InitializeEdgeData(),this.InitializeVirtualGraph(),this.InitializeEdgeNodeInfo(e),this.InitializeCdtInfo()}SimplifyRegularEdges(){for(const e of this.regularEdges)this.SimplifyRegularEdge(e)}SimplifyRegularEdge(e){const t=e.curve,n=new cr.K,i=new Fr;for(let s=t.endPoint;null!=s;s=s.prev){const o=s.point;if(i.has(s.point)){let a=s.next;for(;;){const l=n.top;if(l.equal(o))break;i.delete(l),n.pop(),a=a.next}a.prev=s.prev,a.prev.next=a}else n.push(o),i.add(o)}}InitializeStationData(){this.Stations=[],this.PointToStations=new Vs;for(const e of this.regularEdges)this.ProcessPolylinePoints(e.curve)}ProcessPolylinePoints(e){let t=e.startPoint;for(this.RegisterStation(t,!0),t=t.next;t!=e.endPoint;t=t.next)this.RegisterStation(t,!1);this.RegisterStation(t,!0)}RegisterStation(e,t){if(!this.PointToStations.has(e.point)){const n=new J4(this.Stations.length,t,e.point);this.PointToStations.set(e.point,n),this.Stations.push(n)}}InitializeEdgeData(){this.metrolines=new Array;for(let e=0;e<this.regularEdges.length;e++)this.InitEdgeData(this.regularEdges[e],e)}InitEdgeData(e,t){const n=new $4(e.curve,e.lineWidth,this.EdgeSourceAndTargetFunc(e),t);this.metrolines.push(n),this.PointToStations.get(n.Polyline.start).BoundaryCurve=e.sourcePort.Curve,this.PointToStations.get(n.Polyline.end).BoundaryCurve=e.targetPort.Curve}EdgeSourceAndTargetFunc(e){return()=>[this.LoosePolylineOfPort(e.sourcePort),this.LoosePolylineOfPort(e.targetPort)]}InitializeVirtualGraph(){const e=new Map;for(const t of this.metrolines){let i,n=this.PointToStations.get(t.Polyline.start);for(let s=t.Polyline.startPoint;null!=s.next;s=s.next,n=i)i=this.PointToStations.get(s.next.point),MS(e,n,i),MS(e,i,n)}for(const t of this.Stations)t.Neighbors=Array.from(e.get(t))}GetUnorderedIjInfo(e,t){return e.SerialNumber<t.SerialNumber?this.GetCreateOrderedIjInfo(e,t):this.GetCreateOrderedIjInfo(t,e)}static closedeb(e,t){return e.Position.sub(new k(360.561,428.416)).length<.1&&t.Position.sub(new k(414.281,440.732)).length<.1}GetCreateOrderedIjInfo(e,t){let n=this.edgeInfoDictionary.get(e,t);return n||(n=new q4,this.edgeInfoDictionary.set(e,t,n),n)}InitializeEdgeNodeInfo(e){this.edgeInfoDictionary=new kL,this.InitAllMetroNodeInfos(e),this.SortAllNeighbors(),this.InitEdgeIjInfos(),this.ink=0;for(const t of this.VirtualEdges())this.ink+=t[0].Position.sub(t[1].Position).length}InitAllMetroNodeInfos(e){for(let t=0;t<this.metrolines.length;t++){const n=this.metrolines[t];this.InitMetroNodeInfos(n),this.InitNodeEnterableLoosePolylines(n,this.regularEdges[t]),e&&this.InitNodeEnterableTightPolylines(n,this.regularEdges[t]),n.UpdateLengths()}}InitMetroNodeInfos(e){for(let t=e.Polyline.startPoint;null!=t;t=t.next){const n=this.PointToStations.get(t.point);n.MetroNodeInfos.push(new K4(e,n,t))}}InitNodeEnterableLoosePolylines(e,t){const n=null!=this.EdgeLooseEnterable?this.EdgeLooseEnterable.get(t):new Set;for(let i=e.Polyline.startPoint.next;null!=i&&null!=i.next;i=i.next){const s=this.PointToStations.get(i.point);null!=s.getELP()?s.setELP(Cu(s.getELP(),n)):s.setELP(new Set(n))}this.AddLooseEnterableForMetrolineStartEndPoints(e)}AddLooseEnterableForMetrolineStartEndPoints(e){this.AddLooseEnterableForEnd(e.Polyline.start),this.AddLooseEnterableForEnd(e.Polyline.end)}AddTightEnterableForMetrolineStartEndPoints(e){this.AddTightEnterableForEnd(e.Polyline.start),this.AddTightEnterableForEnd(e.Polyline.end)}AddLooseEnterableForEnd(e){const t=this.PointToStations.get(e);if(this.cachedEnterableLooseForEnd.has(e))t.setELP(this.cachedEnterableLooseForEnd.get(e));else{for(const n of this.LooseTree.AllHitItems_(e))fe.PointRelativeToCurveLocation(e,n)==Ot.Inside&&t.AddEnterableLoosePolyline(n);this.cachedEnterableLooseForEnd.set(e,t.getELP())}}AddTightEnterableForEnd(e){const t=this.PointToStations.get(e);for(const n of this.TightTree.AllHitItems_(e))fe.PointRelativeToCurveLocation(e,n)==Ot.Inside&&t.AddEnterableTightPolyline(n)}InitNodeEnterableTightPolylines(e,t){const n=null!=this.EdgeTightEnterable?this.EdgeTightEnterable.get(t):new Set;for(let i=e.Polyline.startPoint.next;null!=i&&null!=i.next;i=i.next){const s=this.PointToStations.get(i.point),o=s.EnterableTightPolylines;s.EnterableTightPolylines=null!=o?Cu(o,n):new Set(n)}this.AddTightEnterableForMetrolineStartEndPoints(e)}SortAllNeighbors(){for(const e of this.Stations)this.SortNeighbors(e)}SortNeighbors(e){if(e.Neighbors.length<=2)return;const t=e.Neighbors[0].Position,n=e.Position;e.Neighbors.sort((i,s)=>sd(t.sub(n),i.Position.sub(n),s.Position.sub(n)))}InitEdgeIjInfos(){for(const e of this.metrolines){let i,n=this.PointToStations.get(e.Polyline.start);for(let s=e.Polyline.startPoint;null!=s.next;s=s.next,n=i){i=this.PointToStations.get(s.next.point);const o=this.GetUnorderedIjInfo(n,i);o.Width+=e.Width,o.Metrolines.push(e)}}}InitializeCdtInfo(){const e=this.Cdt.GetCdtTree();for(const t of this.Stations)t.CdtTriangle=e.FirstHitNodeWithPredicate(t.Position,XS.testPointInside).UserData}PointIsAcceptableForEdge(e,t){if(null==this.LoosePolylineOfPort)return!0;const n=e.sourceAndTargetLoosePolylines();return fe.PointRelativeToCurveLocation(t,n[0])==Ot.Outside&&fe.PointRelativeToCurveLocation(t,n[1])==Ot.Outside}}function sd(r,e,t){r=r.mul(1e3),e=e.mul(1e3),t=t.mul(1e3);const i=k.crossProduct(r,t),s=r.dot(t),o=k.crossProduct(r,e),a=r.dot(e);return an(o,0)&&ZS(a,0)?an(i,0)&&ZS(s,0)?0:1:an(i,0)&&ZS(s,0)?-1:an(o,0)||an(i,0)||o*i>0?Jf(k.crossProduct(t,e),0):-Jf(Math.sign(o),0)}function ZS(r,e){return Jf(r,e)>=0}let yo=(()=>{class r{constructor(t,n){this.metroGraphData=t,this.bundlingSettings=n}static InkError(t,n,i){return(t-n)*i.InkImportance}static PathLengthsError(t,n,i,s){return s.PathLengthImportance/i*(t-n)}static RError(t,n,i){return t<=n?0:i.HubRepulsionImportance*((1-n/t)*(t-n))}static BundleError(t,n,i){return t<=n?0:i.BundleRepulsionImportance*((1-n/t)*(t-n))}static Cost(t,n){let i=n.InkImportance*t.Ink;for(const s of t.Metrolines)i+=n.PathLengthImportance*s.Length/s.IdealLength;return i+=this.CostOfForces(t),i}static CostOfForces(t){let n=0;for(const i of t.VirtualStations())n+=i.cachedRadiusCost;for(const i of t.VirtualEdges())n+=t.GetIjInfo(i[0],i[1]).cachedBundleCost;return n}InkGain(t,n){const i=this.metroGraphData.Ink;let s=this.metroGraphData.Ink;for(const o of t.Neighbors){const a=o.Position;s-=a.sub(t.Position).length,s+=a.sub(n).length}return r.InkError(i,s,this.bundlingSettings)}PathLengthsGain(t,n){let i=0;for(const s of this.metroGraphData.MetroNodeInfosOfNode(t)){const o=s.Metroline.Length,a=s.PolyPoint.prev.point,l=s.PolyPoint.next.point,c=s.Metroline.Length+l.sub(n).length+a.sub(n).length-l.sub(t.Position).length-a.sub(t.Position).length;i+=r.PathLengthsError(o,c,s.Metroline.IdealLength,this.bundlingSettings)}return i}RadiusGain(t,n){let i=0;return i+=t.cachedRadiusCost,i-=this.RadiusCost(t,n),i}RadiusCost(t,n){let i;i=k.closeDistEps(t.Position,n)?t.cachedIdealRadius:ns.CalculateIdealHubRadiusWithNeighborsMBNP(this.metroGraphData,this.bundlingSettings,t,n);const s={touchedObstacles:[]};if(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesSPNBA(t,n,i,s))return r.Inf;let o=0;for(const a of s.touchedObstacles){const l=a[1].sub(n).length;o+=r.RError(i,l,this.bundlingSettings)}return o}BundleGain(t,n){let i=t.cachedBundleCost;for(const s of t.Neighbors){const o=this.BundleCost(t,s,n);if(ZS(o,r.Inf))return-r.Inf;i-=o}return i}BundleCost(t,n,i){const s=this.metroGraphData.GetWidthSSN(t,n,this.bundlingSettings.EdgeSeparation),o={closestDist:[]};if(!this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(t,n,i,n.Position,s,o))return r.Inf;let a=0;for(const l of o.closestDist){const c=l[0].sub(l[1]).length;a+=r.BundleError(s/2,c,this.bundlingSettings)}return a}}return r.Inf=1e9,r})();class X4{constructor(e){this.polylineToEdgeGeom=new Map,this.pathsThroughPoints=new Vs,this.interestingPoints=new Fr,this.metroGraphData=e}get Polylines(){return Array.from(this.polylineToEdgeGeom.keys())}Run(){this.Init(),this.SwitchFlips()}Init(){for(const e of this.metroGraphData.Edges)this.polylineToEdgeGeom.set(e.curve,e);for(const e of this.Polylines)this.RegisterPolylinePointInPathsThrough(e.polylinePoints())}RegisterPolylinePointInPathsThrough(e){for(const t of e)this.RegisterPolylinePointInPathsThroughP(t)}RegisterPolylinePointInPathsThroughP(e){!function Z4(r,e,t){let n=r.get(e);n||(n=new Set,r.set(e,n)),n.add(t)}(this.pathsThroughPoints,e.point,e)}UnregisterPolylinePointsInPathsThrough(e){for(const t of e)this.UnregisterPolylinePointInPathsThrough(t)}UnregisterPolylinePointInPathsThrough(e){!function e5(r,e,t){const n=r.get(e);!n||(n.delete(t),0==n.size&&r.deleteP(e))}(this.pathsThroughPoints,e.point,e)}SwitchFlips(){const e=new Set(this.Polylines),t=new mu.c;for(const n of this.Polylines)t.enqueue(n);for(;t.length>0;){const n=t.dequeue();e.delete(n);const i=this.ProcessPolyline(n);null!=i&&(e.has(n)||(e.add(n),t.enqueue(n)),e.has(i)||(e.add(i),t.enqueue(i)))}}ProcessPolyline(e){const t=new Map;for(let n=e.startPoint.next;null!=n;n=n.next){this.FillDepartedPolylinePoints(n,t);for(const i of this.pathsThroughPoints.get(n.point)){const s=t.get(i.polyline);if(s){if(this.ProcessFlip(n,s))return i.polyline;t.delete(i.polyline)}}}return null}FillDepartedPolylinePoints(e,t){const n=e.prev.point;for(const i of this.pathsThroughPoints.get(n))this.IsNeighborOnTheSamePolyline(i,e)||t.has(i.polyline)||t.set(i.polyline,i)}ProcessFlip(e,t){const n=e.polyline,i=t.polyline,s=e.point,o=t.point,a=this.polylineToEdgeGeom.get(n),l=this.polylineToEdgeGeom.get(i);if(a.lineWidth!=l.lineWidth||null==this.metroGraphData.EdgeLooseEnterable||!LS(this.metroGraphData.EdgeLooseEnterable.get(a),this.metroGraphData.EdgeLooseEnterable.get(l)))return!1;let c=this.FindPointsOnPolyline(n,s,o);const d=c[0],b=c[1],N=c[2];c=this.FindPointsOnPolyline(i,s,o);const F=c[0],G=c[1],W=c[2],ie=this.FindRelationOnFirstPoint(d,F,N,W),he=this.FindRelationOnLastPoint(b,G,N,W);return(2==ie||2==he)&&1!=ie&&1!=he&&(this.UnregisterPolylinePointsInPathsThrough(n.polylinePoints()),this.UnregisterPolylinePointsInPathsThrough(i.polylinePoints()),this.Swap(d,F,b,G,N,W),this.RegisterPolylinePointInPathsThrough(n.polylinePoints()),this.RegisterPolylinePointInPathsThrough(i.polylinePoints()),this.RegisterInterestingPoint(d.point),this.RegisterInterestingPoint(b.point),this.numberOfReducedCrossings++,!0)}FindPointsOnPolyline(e,t,n){let i,s;for(let o=e.startPoint;null!=o;o=o.next)if(null==i)if(o.point.equal(t)){if(null!=s)return[o,s,!1];i=o}else null==s&&o.point.equal(n)&&(s=o);else if(o.point.equal(n))return[i,o,!0]}PolylinePointsAreInForwardOrder(e,t){for(let n=e;null!=n;n=n.next)if(n==t)return!0;return!1}Next(e,t){return t?e.next:e.prev}Prev(e,t){return t?e.prev:e.next}FindRelationOnFirstPoint(e,t,n,i){const s=e,o=t;for(;;){const a=this.Prev(e,n),l=this.Prev(t,i);if(null==a||null==l)return 0;if(!a.point.equal(l.point))break;e=a,t=l}return this.PolylinesIntersect(s,o,e,t,n,i)}FindRelationOnLastPoint(e,t,n,i){const s=e,o=t;for(;;){const a=this.Next(e,n),l=this.Next(t,i);if(null==a||null==l)return 0;if(!a.point.equal(l.point))break;e=a,t=l}for(;this.Next(e,n).point.equal(this.Prev(t,i).point);)e=this.Next(e,n),t=this.Prev(t,i);return this.PolylinesIntersect(e,t,s,o,n,i)}PolylinesIntersect(e,t,n,i,s,o){const a=this.Prev(e,s),l=this.Next(e,s),c=this.Next(n,s),d=this.Prev(n,s),b=this.Next(t,o),N=this.Prev(i,o);if(e.point.equal(n.point)){const F=e.point;return sd(d.point.sub(F),N.point.sub(F),l.point.sub(F))==sd(d.point.sub(F),b.point.sub(F),l.point.sub(F))?1:2}return sd(a.point.sub(e.point),l.point.sub(e.point),b.point.sub(e.point))==sd(c.point.sub(n.point),N.point.sub(n.point),d.point.sub(n.point))?1:2}Swap(e,t,n,i,s,o){const a=this.GetRangeOnPolyline(this.Next(e,s),n,s),l=this.GetRangeOnPolyline(this.Next(t,o),i,o);this.ChangePolylineSegment(e,n,s,l),this.ChangePolylineSegment(t,i,o,a),Wy.RemoveSelfCyclesFromPolyline(e.polyline),Wy.RemoveSelfCyclesFromPolyline(t.polyline)}ChangePolylineSegment(e,t,n,i){let s=e;for(const o of i){const a=oo.mkFromPoint(o.point);a.polyline=s.polyline,n?(a.prev=s,s.next=a):(a.next=s,s.prev=a),s=a}n?(s.next=t,t.prev=s):(s.prev=t,t.next=s)}GetRangeOnPolyline(e,t,n){const i=new Array;for(let s=e;s!=t;s=this.Next(s,n))i.push(s);return i}IsNeighborOnTheSamePolyline(e,t){return null!=e.prev&&e.prev.point.equal(t.point)||null!=e.next&&e.next.point.equal(t.point)}RegisterInterestingPoint(e){this.interestingPoints.has(e)||this.interestingPoints.add(e)}GetChangedHubs(){return this.interestingPoints}NumberOfReducedCrossings(){return this.numberOfReducedCrossings}PolylineIsOK(e){const t=new Fr;for(let n=e.startPoint;null!=n;n=n.next){if(n==e.startPoint){if(null!=n.prev)return!1}else if(n.prev.next!=n)return!1;if(n==e.endPoint){if(null!=n.next)return!1}else if(n.next.prev!=n)return!1;if(t.has(n.point))return!1;t.add(n.point)}return!(null!=e.startPoint.prev||null!=e.endPoint.next)}}class Wy{constructor(e,t){this.foundCrossings=new Fr,this.crossingsThatShouldBecomeHubs=new Fr,this.metroGraphData=e,this.polylineAcceptsPoint=t}*Vertices(){for(const e of this.Polylines)for(const t of e.polylinePoints())yield t}get Polylines(){return this.metroGraphData.Edges.map(e=>e.curve)}Edges(){const e=new xy;for(const t of this.Vertices())t.next&&e.set(new qi(t.point,t.next.point),0);return Array.from(e.keys())}run(){if(0==this.metroGraphData.Edges.length)return!1;const e=new xy,t=new _S(null);for(const a of this.Vertices()){const l=lt.mkOnPoints([a.point]);l.pad(le.intersectionEpsilon),t.Add(l,a.point)}const n=nT(this.Edges(),a=>lt.mkPP(a.First,a.Second));es(n,n,(a,l)=>this.IntersectTwoEdges.bind(a,l,e,t)),this.SortInsertedPoints(e);const i=this.InsertPointsIntoPolylines(e),s=this.FixPaths(),o=this.RemoveUnimportantCrossings();return s||i||o}FixPaths(){let e=!1;return this.RemoveSelfCycles()&&(e=!0),this.ReduceEdgeCrossings()&&(e=!0),e}SortInsertedPoints(e){for(const t of e)this.SortInsideSegment(t[0],t[1])}SortInsideSegment(e,t){t.sort((n,i)=>$n(Dn(n,e.First),Dn(i,e.First)))}InsertPointsIntoPolylines(e){let t=!1;for(const n of this.metroGraphData.Metrolines)return this.InsertPointsIntoPolyline(n,e)&&(t=!0),t}InsertPointsIntoPolyline(e,t){let n=!1;for(let i=e.Polyline.startPoint;null!=i.next;i=i.next)this.InsertPointsOnPolypoint(i,t,e)&&(n=!0);return n}InsertPointsOnPolypoint(e,t,n){const i=new qi(e.point,e.next.point),s=e.point!=i.First,o=t.get(i);if(!o)return!1;const a=e.next,l=e.polyline;if(s)for(let c=o.length-1;c>=0;c--){if(null!=this.polylineAcceptsPoint&&!this.polylineAcceptsPoint(n,o[c]))continue;const d=oo.mkFromPoint(o[c]);d.prev=e,d.polyline=l,e.next=d,e=d}else for(let c=0;c<o.length;c++){if(null!=this.polylineAcceptsPoint&&!this.polylineAcceptsPoint(n,o[c]))continue;const d=oo.mkFromPoint(o[c]);d.prev=e,d.polyline=l,e.next=d,e=d}return e.next=a,a.prev=e,!0}RemoveSelfCycles(){let e=!1;for(const t of this.Polylines)Wy.RemoveSelfCyclesFromPolyline(t)&&(e=!0);return e}static RemoveSelfCyclesFromPolyline(e){let t=!1;const n=new Vs;for(let i=e.startPoint;null!=i;i=i.next){const o=n.get(i.point);if(o){for(let a=o.next;a!=i.next;a=a.next)n.deleteP(a.point);o.next=i.next,i.next.prev=o,t=!0}else n.set(i.point,i)}return t}ReduceEdgeCrossings(){const e=new X4(this.metroGraphData);e.Run();for(const t of e.GetChangedHubs())this.crossingsThatShouldBecomeHubs.add(t);return e.NumberOfReducedCrossings()>0}RemoveUnimportantCrossings(){let e=!1;this.pointsToDelete=function kW(r,e){const t=new Fr;for(const n of r)e.has(n)||t.add(n);return t}(this.foundCrossings,this.crossingsThatShouldBecomeHubs);for(const t of this.Polylines)this.RemoveUnimportantCrossingsFromPolyline(t)&&(e=!0);return e}RemoveUnimportantCrossingsFromPolyline(e){let t=!1;for(let n=e.startPoint.next;null!=n&&null!=n.next;n=n.next)if(this.pointsToDelete.has(n.point)&&k.getTriangleOrientation(n.prev.point,n.point,n.next.point)==nt.Collinear){const i=n.prev,s=n.next;i.next=s,s.prev=i,n=i,t=!0}return t}IntersectTwoEdges(e,t,n,i){const s=Me.IntersectPPPP(e.First,e.Second,t.First,t.Second);if(s){const o=this.FindExistingVertexOrCreateNew(i,s);(this.AddVertexToSplittingList(e,n,o)||this.AddVertexToSplittingList(t,n,o))&&this.foundCrossings.add(o)}}FindExistingVertexOrCreateNew(e,t){const n=e.RootNode.FirstHitNode(t);if(null!=n)return n.UserData;const i=lt.mkOnPoints([t]).pad(le.intersectionEpsilon);return e.Add(i,t),t}AddVertexToSplittingList(e,t,n){if(!fe.closeIntersectionPoints(n,e.First)&&!fe.closeIntersectionPoints(n,e.Second)){let i=t.get(e);if(i||(i=new Array,t.set(e,i)),!i.find(s=>s.equal(n)))return i.push(n),!0}return!1}}class GL{constructor(e,t,n,i){this.BelongsToRealNode=i,this.Curve=t,this.Position=n,this.points=new Array(e),this.tangents=new Array(e),this.OrientedHubSegments=new Array(e),this.ParameterSpan=this.Curve.parEnd-this.Curve.parStart}get Count(){return this.points.length}get CurveCenter(){return this.Curve.boundingBox.center}get OppositeBase(){return null!=this.OutgoingBundleInfo?this.OutgoingBundleInfo.TargetBase:this.IncomingBundleInfo.SourceBase}get length(){return this.points.length}get Points(){return this.points}get Tangents(){return this.tangents}get InitialMidParameter(){return this.initialMidParameter}set InitialMidParameter(e){this.initialMidParameter=e,this.InitialMidPoint=this.Curve.value(e)}get ParRight(){return this.parRight}set ParRight(e){this.parRight=e,this.RightPoint=this.Curve.value(this.parRight)}get ParLeft(){return this.parLeft}set ParLeft(e){this.parLeft=e,this.LeftPoint=this.Curve.value(this.parLeft)}get ParMid(){return(this.parRight+this.parLeft)/2}get MidPoint(){return k.middle(this.RightPoint,this.LeftPoint)}get Span(){return this.SpanBetweenTwoPoints(this.parRight,this.parLeft)}SpanBetweenTwoPoints(e,t){return e<=t?t-e:t-e+this.ParameterSpan}RotateLeftPoint(e,t){return 0==e?this.LeftPoint:this.RotatePoint(e,this.parLeft,t)}RotateRigthPoint(e,t){return 0==e?this.RightPoint:this.RotatePoint(e,this.parRight,t)}RotatePoint(e,t,n){return t=this.AdjustParam(t+=e*(this.ParameterSpan*n)),this.Curve.value(t)}AdjustParam(e){return e>this.Curve.parEnd?e=this.Curve.parStart+(e-this.Curve.parEnd):e<this.Curve.parStart&&(e=this.Curve.parEnd-(this.Curve.parStart-e)),e}RotateBy(e,t,n){const i=this.ParameterSpan*n;0!=e&&(this.ParRight=this.AdjustParam(this.ParRight+e*i)),0!=t&&(this.ParLeft=this.AdjustParam(this.ParLeft+t*i))}Intersect(e){return this.IntersectNNNB(this.parRight,this.parLeft,e.parRight,e.parLeft)}IntersectNNNB(e,t,n,i){return e>t?this.IntersectNNNB(e,this.Curve.parEnd,n,i)||this.IntersectNNNB(this.Curve.parStart,t,n,i):n>i?this.IntersectNNNB(e,t,n,this.Curve.parEnd)||this.IntersectNNNB(e,t,this.Curve.parStart,i):!(Jf(t,n)||Jf(i,e))}RelativeOrderOfBasesIsPreserved(e,t,n){const i=this.ParameterSpan*n,s=this.parRight+e*i,o=this.parRight<this.parLeft?this.parLeft+t*i:this.parLeft+this.ParameterSpan+t*i;if(s>o||this.SpanBetweenTwoPoints(s,o)>this.ParameterSpan/2)return!1;if(null==this.Prev||this.SpanBetweenTwoPoints(this.Prev.ParMid,this.ParMid)>i&&this.SpanBetweenTwoPoints(this.ParMid,this.Next.ParMid)>i)return!0;const a=this.RotateLeftPoint(t,n),l=this.RotateRigthPoint(e,n),c=k.middle(a,l),d=this.MidPoint;return!(k.getTriangleOrientation(this.CurveCenter,this.Prev.MidPoint,d)!=k.getTriangleOrientation(this.CurveCenter,this.Prev.MidPoint,c)||k.getTriangleOrientation(this.CurveCenter,this.Next.MidPoint,d)!=k.getTriangleOrientation(this.CurveCenter,this.Next.MidPoint,c))}}let t5=(()=>{class r{constructor(t,n,i,s,o){this.SourceBase=t,this.TargetBase=n,this.obstaclesToIgnore=i,this.EdgeSeparation=s,this.HalfWidthArray=o,this.TotalRequiredWidth=this.EdgeSeparation*(this.HalfWidthArray.length-1)+2*this.HalfWidthArray.reduce((l,c)=>l+c,0),this.longEnoughSideLength=t.Curve.boundingBox.addRec(n.Curve.boundingBox).diagonal;const a=Math.max(t.Curve.boundingBox.diagonal,n.Curve.boundingBox.diagonal);if(this.TotalRequiredWidth>a){const l=this.TotalRequiredWidth/a;for(let c=0;c<this.HalfWidthArray.length;c++)this.HalfWidthArray[c]/=l;this.TotalRequiredWidth/=l,this.EdgeSeparation/=l}}SetParamsFeasiblySymmetrically(t){this.CalculateTightObstaclesForBundle(t,this.obstaclesToIgnore),this.SetEndParamsSymmetrically()}CalculateTightObstaclesForBundle(t,n){const o=Ga.Create4gon(this.SourceBase.Position,this.TargetBase.Position,this.SourceBase.Curve.boundingBox.diagonal/2*2,this.TargetBase.Curve.boundingBox.diagonal/2*2);this.tightObstaclesInTheBoundingBox=Array.from(t.AllHitItems(o.boundingBox,a=>!n.has(a)&&fe.ClosedCurveInteriorsIntersect(o,a)))}SetEndParamsSymmetrically(){const t=this.TargetBase.Position,n=this.SourceBase.Position,i=t.sub(n).normalize(),s=i.rotate90Ccw(),o=k.middle(t,n),a=i.mul(this.longEnoughSideLength),l=o.add(a),c=o.sub(a);if(this.SetRLParamsIfWidthIsFeasible(s.mul(this.TotalRequiredWidth/2),l,c))return void this.SetInitialMidParams();let d=this.TotalRequiredWidth,b=0,N=d/2;for(;d-b>r.FeasibleWidthEpsilon;)this.SetRLParamsIfWidthIsFeasible(s.mul(N/2),l,c)?b=N:d=N,N=.5*(d+b);N<=r.FeasibleWidthEpsilon&&(this.SetRLParamsIfWidthIsFeasible_(s.mul(r.FeasibleWidthEpsilon),new k(0,0),l,c)||this.SetRLParamsIfWidthIsFeasible_(new k(0,0),s.mul(-r.FeasibleWidthEpsilon),l,c))&&(N=2*r.FeasibleWidthEpsilon),this.SourceBase.InitialMidParameter=this.SourceBase.AdjustParam(this.SourceBase.ParRight+this.SourceBase.Span/2),this.TargetBase.InitialMidParameter=this.TargetBase.AdjustParam(this.TargetBase.ParRight+this.TargetBase.Span/2)}mkNameFromLRST(){return"/tmp/leftRight"+this.SourceBase.Position.toString()+"_"+this.TargetBase.Position.toString()+".svg"}SetRLParamsIfWidthIsFeasible(t,n,i){return this.SetRLParamsIfWidthIsFeasible_(t,t.neg(),n,i)}SetRLParamsIfWidthIsFeasible_(t,n,i,s){const o={par:0},a={par:0},l={par:0},c={par:0};let d=this.TrimSegWithBoundaryCurves(Me.mkPP(i.add(t),s.add(t)),a,l);return null!=d&&!this.tightObstaclesInTheBoundingBox.find(N=>null!=fe.intersectionOne(d,N,!1))&&(d=this.TrimSegWithBoundaryCurves(Me.mkPP(i.add(n),s.add(n)),c,o),null!=d)&&!this.tightObstaclesInTheBoundingBox.find(N=>null!=fe.intersectionOne(d,N,!1))&&(this.SourceBase.IsParent?(this.SourceBase.ParRight=a.par,this.SourceBase.ParLeft=c.par):(this.SourceBase.ParRight=c.par,this.SourceBase.ParLeft=a.par),this.TargetBase.IsParent?(this.TargetBase.ParRight=o.par,this.TargetBase.ParLeft=l.par):(this.TargetBase.ParRight=l.par,this.TargetBase.ParLeft=o.par),!0)}SetInitialMidParams(){const t={par:0},n={par:0};null!=this.TrimSegWithBoundaryCurves(Me.mkPP(this.TargetBase.CurveCenter,this.TargetBase.CurveCenter),n,t)?(this.SourceBase.InitialMidParameter=n.par,this.TargetBase.InitialMidParameter=t.par):(this.SourceBase.InitialMidParameter=this.SourceBase.AdjustParam(this.SourceBase.ParRight+this.SourceBase.Span/2),this.TargetBase.InitialMidParameter=this.TargetBase.AdjustParam(this.TargetBase.ParRight+this.TargetBase.Span/2))}mkNameFromST(){return"/tmp/mparam"+this.SourceBase.Position.toString()+"_"+this.TargetBase.Position.toString()+".svg"}TrimSegWithBoundaryCurves(t,n,i){let o,a,s=fe.getAllIntersections(t,this.SourceBase.Curve,!0);return 0==s.length?(i.par=0,n.par=0,null):(o=1==s.length?s[0]:this.SourceBase.IsParent?s[0].par0<s[1].par0?s[1]:s[0]:s[0].par0<s[1].par0?s[0]:s[1],s=fe.getAllIntersections(t,this.TargetBase.Curve,!0),0==s.length?(i.par=0,n.par=0,null):(a=1==s.length?s[0]:this.TargetBase.IsParent?s[0].par0>s[1].par0?s[1]:s[0]:s[0].par0>s[1].par0?s[0]:s[1],n.par=o.par1,i.par=a.par1,Me.mkPP(o.x,a.x)))}RotateBy(t,n,i,s,o){const a=0!=t||0!=n,l=0!=i||0!=s;a&&this.SourceBase.RotateBy(t,n,o),l&&this.TargetBase.RotateBy(i,s,o),this.UpdateSourceAndTargetBases(a,l)}UpdateSourceAndTargetBases(t,n){t&&this.UpdatePointsOnBundleBase(this.SourceBase),n&&this.UpdatePointsOnBundleBase(this.TargetBase),this.UpdateTangentsOnBases()}UpdateTangentsOnBases(){const t=this.TargetBase.length;for(let n=0;n<t;n++){let i=this.TargetBase.Points[n].sub(this.SourceBase.Points[t-1-n]);const s=i.length;s>=le.tolerance&&(i=i.div(s),this.TargetBase.Tangents[n]=i,this.SourceBase.Tangents[t-1-n]=i.neg())}}UpdatePointsOnBundleBase(t){const n=t.length,i=t.Points,s=Me.mkPP(t.LeftPoint,t.RightPoint),o=1/this.TotalRequiredWidth;let a=this.HalfWidthArray[0];i[0]=s.value(a*o);for(let l=1;l<n;l++)a+=this.HalfWidthArray[l-1]+this.EdgeSeparation+this.HalfWidthArray[l],i[l]=s.value(a*o)}RotationIsLegal(t,n,i,s,o){if(this.SourceBase.IsParent||this.TargetBase.IsParent){if(0!=n||0!=s){const a=this.SourceBase.RotateLeftPoint(n,o),l=this.TargetBase.RotateLeftPoint(s,o);if(!this.LineIsLegal(a,l))return!1}if(0!=t||0!=i){const a=this.SourceBase.RotateRigthPoint(t,o),l=this.TargetBase.RotateRigthPoint(i,o);if(!this.LineIsLegal(a,l))return!1}}else{if(0!=n||0!=i){const a=this.SourceBase.RotateLeftPoint(n,o),l=this.TargetBase.RotateRigthPoint(i,o);if(!this.LineIsLegal(a,l))return!1}if(0!=t||0!=s){const a=this.SourceBase.RotateRigthPoint(t,o),l=this.TargetBase.RotateLeftPoint(s,o);if(!this.LineIsLegal(a,l))return!1}}return!((0!=t||0!=n)&&!this.SourceBase.RelativeOrderOfBasesIsPreserved(t,n,o)||(0!=i||0!=s)&&!this.TargetBase.RelativeOrderOfBasesIsPreserved(i,s,o))}LineIsLegal(t,n){return null==this.tightObstaclesInTheBoundingBox.find(i=>null!=fe.intersectionOne(Me.mkPP(t,n),i,!1))}}return r.FeasibleWidthEpsilon=.1,r})();class VL{constructor(e,t,n,i){this.Segment=e,this.Reversed=t,this.Index=n,this.BundleBase=i}get Segment(){return this.segment}set Segment(e){this.segment=e}value(e){return this.Segment.value(this.Reversed?this.Segment.parEnd-e:e)}}let n5=(()=>{class r{constructor(t,n,i){this.fixedBundles=new BL.HashSet,this.stepsWithProgress=0,this.metroOrdering=t,this.metroGraphData=n,this.bundlingSettings=i}Run(){this.AllocateBundleBases(),this.SetBasesRightLeftParamsToTheMiddles(),this.bundlingSettings.KeepOverlaps?(this.UpdateSourceAndTargetBases(),this.CreateOrientedSegs()):(this.SetRightLeftParamsFeasiblySymmetrically(),this.AdjustStartEndParamsToAvoidBaseOverlaps(),this.UpdateSourceAndTargetBases(),this.CreateOrientedSegs(),this.bundlingSettings.RotateBundles&&this.RotateBundlesToDiminishCost(),this.AdjustStartEndParamsToAvoidBaseOverlaps(),this.UpdateSourceAndTargetBases())}AllocateBundleBases(){this.externalBases=new Map,this.internalBases=new Map,this.Bundles=new Array;for(const t of this.metroGraphData.Stations)null==t.BoundaryCurve&&(t.BoundaryCurve=Tn.mkCircle(t.Radius,t.Position));for(const t of this.metroGraphData.Stations)for(const n of t.Neighbors)if(t.SerialNumber<n.SerialNumber){const i=new GL(this.metroGraphData.RealEdgeCount(t,n),t.BoundaryCurve,t.Position,t.IsReal);t.BundleBases.set(n,i);const s=new GL(this.metroGraphData.RealEdgeCount(t,n),n.BoundaryCurve,n.Position,n.IsReal);n.BundleBases.set(t,s),fe.PointRelativeToCurveLocation(n.Position,t.BoundaryCurve)!=Ot.Outside?(i.IsParent=!0,tg(this.internalBases,t.BoundaryCurve,i),tg(this.externalBases,n.BoundaryCurve,s)):fe.PointRelativeToCurveLocation(t.Position,n.BoundaryCurve)!=Ot.Outside?(s.IsParent=!0,tg(this.externalBases,t.BoundaryCurve,i),tg(this.internalBases,n.BoundaryCurve,s)):(tg(this.externalBases,t.BoundaryCurve,i),tg(this.externalBases,n.BoundaryCurve,s));const o=this.metroGraphData.tightIntersections.ObstaclesToIgnoreForBundle(t,n),a=new t5(i,s,o,this.bundlingSettings.EdgeSeparation,Array.from(this.metroOrdering.GetOrder(t,n)).map(l=>l.Width/2));i.OutgoingBundleInfo=s.IncomingBundleInfo=a,this.Bundles.push(a)}this.SetBundleBaseNeighbors()}SetBundleBaseNeighbors(){for(const t of this.externalBases.keys()){const n=this.externalBases.get(t);this.SortBundlesCounterClockwise(n),this.SetLeftRightBases(n)}for(const t of this.internalBases.keys()){const n=this.internalBases.get(t);this.SortBundlesCounterClockwise(n),this.SetLeftRightBases(n)}}SortBundlesCounterClockwise(t){if(t.length>2){const n=t[0].OppositeBase.Position,i=t[0].CurveCenter;t.sort((s,o)=>sd(n.sub(i),s.OppositeBase.Position.sub(i),o.OppositeBase.Position.sub(i)))}}SetLeftRightBases(t){const n=t.length;if(!(n<=1))for(let i=0;i<n;i++)t[i].Prev=t[(i-1+n)%n],t[i].Next=t[(i+1)%n]}CreateOrientedSegs(){for(const t of this.metroGraphData.Metrolines)this.CreateOrientedSegsOnLine(t)}CreateOrientedSegsOnLine(t){for(let n=t.Polyline.startPoint.next;null!=n.next;n=n.next)this.CreateOrientedSegsOnLineVertex(t,n)}CreateOrientedSegsOnLineVertex(t,n){const i=this.metroGraphData.PointToStations.get(n.prev.point),s=this.metroGraphData.PointToStations.get(n.point),o=this.metroGraphData.PointToStations.get(n.next.point),a=s.BundleBases.get(i),l=s.BundleBases.get(o),c=this.metroOrdering.GetLineIndexInOrder(i,s,t),d=this.metroOrdering.GetLineIndexInOrder(o,s,t),b=a.OrientedHubSegments[c]=new VL(null,!1,c,a),N=l.OrientedHubSegments[d]=new VL(null,!0,d,l);N.Other=b,b.Other=N}UpdateSourceAndTargetBases(){for(const t of this.Bundles)t.UpdateSourceAndTargetBases(!0,!0)}SetBasesRightLeftParamsToTheMiddles(){for(const t of this.Bundles){const n=t.SourceBase,i=t.TargetBase;n.ParLeft=n.ParRight=this.GetBaseMiddleParamInDirection(n,n.Position,i.Position),i.ParLeft=i.ParRight=this.GetBaseMiddleParamInDirection(i,i.Position,n.Position)}}GetBaseMiddleParamInDirection(t,n,i){const s=t.Curve;if(s instanceof Tn){const l=s;if(l.isArc())return k.angle(l.aAxis,i.sub(n))}const a=fe.getAllIntersections(s,Me.mkPP(n,i),!0);for(const l of a){const c=l.x;if(c.sub(n).dot(c.sub(i))<=0)return l.par0}throw new Error}SetRightLeftParamsFeasiblySymmetrically(){for(const t of this.Bundles)t.SetParamsFeasiblySymmetrically(this.metroGraphData.TightTree)}AdjustStartEndParamsToAvoidBaseOverlaps(){for(const t of this.externalBases.keys())this.AdjustCurrentBundleWidthsOnCurve(this.externalBases.get(t));for(const t of this.internalBases.keys())this.AdjustCurrentBundleWidthsOnCurve(this.internalBases.get(t))}AdjustCurrentBundleWidthsOnCurve(t){const n=t.length;if(!(n<=1))for(let i=0;i<n;i++){const s=t[i];this.ShrinkBasesToMakeTwoConsecutiveNeighborsHappy(s,s.Next)}}ShrinkBasesToMakeTwoConsecutiveNeighborsHappy(t,n){if(!t.Intersect(n))return;let i=t.ParRight,s=t.ParLeft,o=n.ParRight,a=n.ParLeft;const l=n.ParameterSpan;i>s&&(i-=l),o>a&&(o-=l),o>s&&(o-=l,a-=l),i>a&&(i-=l,s-=l);const c=this.RegularCut(i,s,o,a,t.Span,n.Span),d=k.getTriangleOrientation(n.CurveCenter,n.OppositeBase.InitialMidPoint,t.OppositeBase.InitialMidPoint);d==nt.Clockwise?(s=c,o=c):d==nt.Counterclockwise?(a=c,i=c):a-i>=s-o?(s=c,o=c):(a=c,i=c),n.ParRight=n.AdjustParam(o),n.ParLeft=n.AdjustParam(a),t.ParRight=t.AdjustParam(i),t.ParLeft=t.AdjustParam(s)}RegularCut(t,n,i,s,o,a){let l=(o*s+a*t)/(o+a);const c=Math.min(n,s),d=Math.max(t,i);return l<d&&(l=d),l>c&&(l=c),l}RotateBundlesToDiminishCost(){let t=r.MaxParameterChange;const n={cost:this.Cost()};let i=0;for(;i++<r.MaxIterations;){const s=n.cost;if(this.RotateBundlesToDiminishCostOneIteration(t,n),t=this.UpdateParameterChange(t,s,n.cost),t<r.MinParameterChange)break}}UpdateParameterChange(t,n,i){return i+1<n?(this.stepsWithProgress++,this.stepsWithProgress>=5&&(this.stepsWithProgress=0,this.fixedBundles.clear())):(this.stepsWithProgress=0,t*=.8,this.fixedBundles.clear()),t}RotateBundlesToDiminishCostOneIteration(t,n){let i=!1;for(const s of this.Bundles)this.fixedBundles.has(s)||(this.OptimizeBundle(s,t,n)?i=!0:this.fixedBundles.add(s));return i}OptimizeBundle(t,n,i){const s=this.CostBi(t);if(s<r.CostThreshold)return!1;let o=0,a=-1,l=-1;for(let c=0;c<r.Deltas.length-1;c++){let d=this.DeltaWithChangedAngles(r.Deltas[c][0],r.Deltas[c][1],0,0,t,s,n);d>r.CostDeltaThreshold&&d>o&&(l=c,a=r.Deltas.length-1,o=d),d=this.DeltaWithChangedAngles(0,0,r.Deltas[c][0],r.Deltas[c][1],t,s,n),d>r.CostDeltaThreshold&&d>o&&(l=r.Deltas.length-1,a=c,o=d)}return!(o<r.CostDeltaThreshold||(i.cost-=o,t.RotateBy(r.Deltas[l][0],r.Deltas[l][1],r.Deltas[a][0],r.Deltas[a][1],n),0))}DeltaWithChangedAngles(t,n,i,s,o,a,l){if(!o.RotationIsLegal(t,n,i,s,l))return 0;o.RotateBy(t,n,i,s,l);const c=this.CostBN(o,a);return o.RotateBy(-1*t,-1*n,-1*i,-1*s,l),a-c}CostBi(t){return r.SeparationCoeff*this.SeparationCost(t)+(r.SqueezeCoeff*this.SqueezeCost(t)+(r.AssymetryCoeff*this.AssymetryCost(t)+r.CenterCoeff*this.CenterCostBi(t)))}CostBN(t,n){let i=0;return i+=r.CenterCoeff*this.CenterCostBi(t),i>n||(i+=r.SeparationCoeff*this.SeparationCost(t),i>n)||(i+=r.SqueezeCoeff*this.SqueezeCost(t),i>n)||(i+=r.AssymetryCoeff*this.AssymetryCost(t)),i}SqueezeCost(t){const i=t.TargetBase.MidPoint.sub(t.SourceBase.MidPoint).normalize().rotate90Ccw(),s=Math.abs(t.SourceBase.RightPoint.sub(t.SourceBase.LeftPoint).dot(i)),o=Math.abs(t.TargetBase.RightPoint.sub(t.TargetBase.LeftPoint).dot(i)),a=Math.abs(t.TotalRequiredWidth-s)/t.TotalRequiredWidth,l=Math.abs(t.TotalRequiredWidth-o)/t.TotalRequiredWidth,c=Math.abs(s-o)/t.TotalRequiredWidth;return Math.exp(10*a)-1+(Math.exp(10*l)-1)+c}CenterCostBi(t){return t.SourceBase.BelongsToRealNode||t.TargetBase.BelongsToRealNode?this.CenterCostBb(t.SourceBase)+this.CenterCostBb(t.TargetBase):0}CenterCostBb(t){if(!t.BelongsToRealNode)return 0;const n=t.ParMid,i=Math.min(t.InitialMidParameter,n),s=Math.max(t.InitialMidParameter,n),o=Math.min(s-i,i+(t.ParameterSpan-s));return t.CurveCenter.equal(t.Position)||t.IsParent?o*o*25:o*o*500}AssymetryCost(t){return this.GetAssymetryCostForBase(t.SourceBase)+this.GetAssymetryCostForBase(t.TargetBase)}GetAssymetryCostForBase(t){if(t.BelongsToRealNode)return 0;const n=t.OppositeBase.BelongsToRealNode?200:500;let i=0;for(const s of t.OrientedHubSegments){const o=s.Index,a=s.Other.Index,d=s.Other.BundleBase,F=t.Count+d.Count;i+=this.GetAssymetryCostOnData(t.Points[o],t.Tangents[o],d.Points[a],d.Tangents[a],n)/F}return i}GetAssymetryCostOnData(t,n,i,s,o){const a=t.sub(i);if(a.length<le.distanceEpsilon)return 0;const c=n.add(s).dot(a),d=k.crossProduct(a,n),b=k.crossProduct(a,s),N=d-b;return 10*(c*c+N*N)+o*(d*d+b*b)}SeparationCost(t){return this.SeparationCostForBundleBase(t.SourceBase)+this.SeparationCostForBundleBase(t.TargetBase)}SeparationCostForBundleBase(t){return null==t.Prev?0:this.SeparationCostForAdjacentBundleBases(t,t.Prev)+this.SeparationCostForAdjacentBundleBases(t,t.Next)}SeparationCostForAdjacentBundleBases(t,n){const s=this.IntervalsOverlapLength(t.ParRight,t.ParLeft,n.ParRight,n.ParLeft,t.Curve),o=Math.min(t.Span,n.Span);return Math.exp(s/(10*o))-1}IntervalsOverlapLength(t,n,i,s,o){const a=o.parStart,l=o.parEnd;return t<n?i<s?this.IntersectRegularIntervals(t,n,i,s):this.IntersectRegularIntervals(t,n,i,l)+this.IntersectRegularIntervals(t,n,a,s):i<s?this.IntersectRegularIntervals(t,l,i,s)+this.IntersectRegularIntervals(a,n,i,s):this.IntersectRegularIntervals(t,l,i,l)+this.IntersectRegularIntervals(a,n,a,s)}IntersectRegularIntervals(t,n,i,s){const o=Math.max(t,i),a=Math.min(n,s);return o<a?a-o:0}Cost(){let t=0;for(const n of this.Bundles)t+=(r.SeparationCoeff*this.SeparationCost(n)+r.AssymetryCoeff*this.AssymetryCost(n))/2+r.SqueezeCoeff*this.SqueezeCost(n)+r.CenterCoeff*this.CenterCostBi(n);return t}}return r.Deltas=[[1,-1],[1,-1]],r.SeparationCoeff=1,r.SqueezeCoeff=1,r.CenterCoeff=10,r.AssymetryCoeff=1,r.MaxIterations=200,r.MaxParameterChange=8/360,r.MinParameterChange=.1/360,r.CostThreshold=1e-5,r.CostDeltaThreshold=.01,r})();class r5{constructor(){this.Metrolines=new Array}Add(e){this.Metrolines.push(e)}}class eA{constructor(e){this.Metrolines=e,this.BuildOrder()}*GetOrder(e,t){const n=new qi(e.Position,t.Position),i=this.bundles.get(n).Metrolines;if(e.Position==n.First)for(let s=0;s<i.length;s++)yield i[s];else for(let s=i.length-1;s>=0;s--)yield i[s]}GetLineIndexInOrder(e,t,n){const i=new qi(e.Position,t.Position),s=e.Position!=i.First,o=this.bundles.get(i).LineIndexInOrder;return s?o.size-1-o.get(n):o.get(n)}BuildOrder(){this.bundles=new xy;for(const e of this.Metrolines)for(let t=e.Polyline.startPoint;null!=t.next;t=t.next){const n=new qi(t.point,t.next.point);let i=this.bundles.get(n);i||this.bundles.set(n,i=new r5),i.Add(e)}for(const e of this.bundles)this.BuildOrderPP(e[0],e[1])}BuildOrderPP(e,t){if(!t.orderFixed){t.Metrolines.sort((n,i)=>this.CompareLines(n,i,e.First,e.Second)),t.orderFixed=!0,t.LineIndexInOrder=new Map;for(let n=0;n<t.Metrolines.length;n++)t.LineIndexInOrder.set(t.Metrolines[n],n)}}CompareLines(e,t,n,i){const s={polyPoint:null,next:null,prev:null};this.FindStationOnLine(n,i,e,s);const o=s.polyPoint,a=s.next,l=s.prev;this.FindStationOnLine(n,i,t,s);const c=s.polyPoint,d=s.next,b=s.prev;let G,W,N=o,F=c;for(;null!=(W=l(N))&&null!=(G=b(F))&&W.point.equal(G.point);){const ie=new qi(W.point,N.point);if(this.bundles.get(ie).orderFixed)return this.CompareOnFixedOrder(ie,e,t,!W.point.equal(ie.First));N=W,F=G}if(null!=W&&null!=G){const ie=N.point;return-eA.IsLeft(a(N).point.sub(ie),W.point.sub(ie),G.point.sub(ie))}for(N=o,F=c;null!=(W=a(N))&&null!=(G=d(F))&&W.point.equal(G.point);){const ie=new qi(W.point,N.point);if(this.bundles.get(ie).orderFixed)return this.CompareOnFixedOrder(ie,e,t,!N.point.equal(ie.First));N=W,F=G}if(null!=W&&null!=G){const ie=N.point;return eA.IsLeft(l(N).point.sub(ie),W.point.sub(ie),G.point.sub(ie))}return $n(e.Index,t.Index)}CompareOnFixedOrder(e,t,n,i){const s=this.bundles.get(e).LineIndexInOrder;return(i?-1:1)*$n(s.get(t),s.get(n))}FindStationOnLine(e,t,n,i){for(let s=n.Polyline.startPoint;null!=s.next;s=s.next){if(s.point.equal(e)&&s.next.point.equal(t))return i.next=o=>o.next,i.prev=o=>o.prev,void(i.polyPoint=s);if(s.point.equal(t)&&s.next.point.equal(e))return i.next=o=>o.prev,i.prev=o=>o.next,void(i.polyPoint=s.next)}throw new Error}static IsLeft(e,t,n){return sd(e,t,n)}}let tA=(()=>{class r extends Rr{constructor(t,n){super(null),this.metroGraphData=t,this.bundlingSettings=n}run(){this.CreateMetroOrdering(),this.InitRadii(),this.FinalizePaths()}InitRadii(){new ns(this.metroGraphData,this.bundlingSettings).CreateNodeRadii()}CreateMetroOrdering(){this.metroOrdering=new eA(this.metroGraphData.Metrolines)}FinalizePaths(){this.CreateBundleBases(),this.CreateSegmentsInsideHubs(),this.CreateCurves()}CreateBundleBases(){new n5(this.metroOrdering,this.metroGraphData,this.bundlingSettings).Run()}CreateCurves(){for(let t=0;t<this.metroGraphData.Metrolines.length;t++)this.CreateCurveLine(this.metroGraphData.Metrolines[t],this.metroGraphData.Edges[t])}CreateCurveLine(t,n){const i=new fe;let o=r.FindCurveStart(this.metroGraphData,this.metroOrdering,t);const a=r.HubSegsOfLine(this.metroGraphData,this.metroOrdering,t);for(const l of a)null!=l&&(i.addSegment(Me.mkPP(o,l.start)),i.addSegment(l),o=l.end);i.addSegment(Me.mkPP(o,r.FindCurveEnd(this.metroGraphData,this.metroOrdering,t))),n.curve=i}static FindCurveStart(t,n,i){const s=t.PointToStations.get(i.Polyline.startPoint.point),o=t.PointToStations.get(i.Polyline.startPoint.next.point),a=s.BundleBases.get(o),l=a.IsParent?n.GetLineIndexInOrder(s,o,i):n.GetLineIndexInOrder(o,s,i);return a.Points[l]}static FindCurveEnd(t,n,i){const s=t.PointToStations.get(i.Polyline.endPoint.prev.point),o=t.PointToStations.get(i.Polyline.endPoint.point),a=o.BundleBases.get(s),l=a.IsParent?n.GetLineIndexInOrder(o,s,i):n.GetLineIndexInOrder(s,o,i);return a.Points[l]}static*HubSegsOfLine(t,n,i){for(let s=i.Polyline.startPoint.next;null!=s.next;s=s.next)yield r.SegOnLineVertex(t,n,i,s)}static SegOnLineVertex(t,n,i,s){const o=t.PointToStations.get(s.prev.point),a=t.PointToStations.get(s.point),l=a.BundleBases.get(o),c=n.GetLineIndexInOrder(o,a,i);if(null==l.OrientedHubSegments[c]||null==l.OrientedHubSegments[c].Segment){const d=t.PointToStations.get(s.next.point),b=a.BundleBases.get(d),N=n.GetLineIndexInOrder(d,a,i);return Me.mkPP(l.Points[c],b.Points[N])}return l.OrientedHubSegments[c].Segment}CreateSegmentsInsideHubs(){for(const t of this.metroGraphData.Metrolines)this.CreateOrientedSegsOnLine(t);this.bundlingSettings.UseCubicBezierSegmentsInsideOfHubs&&this.FanBezierSegs()}CreateOrientedSegsOnLine(t){for(let n=t.Polyline.startPoint.next;null!=n.next;n=n.next)this.CreateOrientedSegsOnLineVertex(t,n)}CreateOrientedSegsOnLineVertex(t,n){const i=this.metroGraphData.PointToStations.get(n.prev.point),s=this.metroGraphData.PointToStations.get(n.point),o=this.metroGraphData.PointToStations.get(n.next.point),a=s.BundleBases.get(i),l=s.BundleBases.get(o),c=this.metroOrdering.GetLineIndexInOrder(i,s,t),d=this.metroOrdering.GetLineIndexInOrder(o,s,t),b=this.bundlingSettings.UseCubicBezierSegmentsInsideOfHubs?r.StandardBezier(a.Points[c],a.Tangents[c],l.Points[d],l.Tangents[d]):r.BiArc(a.Points[c],a.Tangents[c],l.Points[d],l.Tangents[d]);a.OrientedHubSegments[c].Segment=b,l.OrientedHubSegments[d].Segment=b}static ShowHubs(t,n,i,s,o=[]){let a=r.GetAllDebugCurves(n,t);null!=i&&a.push(qt.mkDebugCurveTWCI(255,1,"red",gs.CreateDiamond(5,25,i.Position))),a=a.concat(o)}static GetAllDebugCurves(t,n){return r.GraphNodes(n).concat(r.VertexDebugCurves(t,n)).concat(r.DebugEdges(n))}static DebugEdges(t){return t.Edges.map(n=>qt.mkDebugCurveTWCI(40,.1,"gray",n.curve))}static VertexDebugCurves(t,n){return r.DebugCircles(n).concat(r.DebugHubBases(n)).concat(r.DebugSegs(n)).concat(r.BetweenHubs(t,n))}static BetweenHubs(t,n){const i=[];for(const s of n.Metrolines){const o=r.GetInterestingSegs(n,t,s),a=r.GetMonotoneColor(s.Polyline.start,s.Polyline.end,o);for(const l of o)i.push(qt.mkDebugCurveTWCI(100,s.Width,a,Me.mkPP(l[0],l[1])))}return i}static GetInterestingSegs(t,n,i){const s=new Array;if(0==t.Stations.length||null==t.Stations[0].BundleBases||0==t.Stations[0].BundleBases.size)return[];let o=r.FindCurveStart(t,n,i);const a=r.HubSegsOfLine(t,n,i);for(const l of a)null!=l&&(s.push([o,l.start]),o=l.end);return s.push([o,r.FindCurveEnd(t,n,i)]),s}static GetMonotoneColor(t,n,i){return"green"}static DebugHubBases(t){const n=new Array;for(const i of t.Stations)for(const s of i.BundleBases.values())n.push(qt.mkDebugCurveTWCI(100,1,"red",Me.mkPP(s.LeftPoint,s.RightPoint)));return n}static DebugCircles(t){return t.Stations.map(n=>qt.mkDebugCurveTWCI(100,.1,"blue",gs.mkCircle(n.Radius,n.Position)))}static DebugSegs(t){const n=new Array;for(const i of t.VirtualStations())for(const s of i.BundleBases.values())for(const o of s.OrientedHubSegments)null!=o&&n.push(null==o.Segment?Me.mkPP(s.Points[o.Index],o.Other.BundleBase.Points[o.Other.Index]):o.Segment);return n.map(i=>qt.mkDebugCurveTWCI(100,.01,"green",i))}static GraphNodes(t){return t.Edges.map(i=>i.sourcePort.Curve).concat(t.Edges.map(i=>i.targetPort.Curve)).map(i=>qt.mkDebugCurveTWCI(40,1,"black",i))}static BiArc(t,n,i,s){const o=t.sub(i);if(o.length<le.distanceEpsilon)return null;const a=o.dot(n.sub(s)),c=2*(-n.dot(s)-1),d=2*a,b=o.dot(o);let N;if(Math.abs(c)<le.distanceEpsilon){if(!(Math.abs(d)>le.distanceEpsilon))return null;N=-b/d}else{let he=d*d-4*c*b;he<0&&(he=0),he=Math.sqrt(he),N=(-d+he)/(2*c),N<0&&(N=(-d-he)/(2*c))}const F=t.add(n.mul(N)),G=i.add(s.mul(N)),W=k.middle(F,G),ie=new fe;return ie.addSegs([r.ArcOn(t,F,W),r.ArcOn(W,G,i)]),n.dot(i.sub(t))<=0&&n.dot(s)<=0?r.StandardBezier(t,n,i,s):ie}static ArcOn(t,n,i){const s={center:null};if(Math.abs(k.signedDoubledTriangleArea(t,n,i))<1e-4||!r.FindArcCenter(t,n,i,s))return Me.mkPP(t,i);const o=s.center,a=Dn(t,o);if(Dn(t,n)/a<1e-4)return Me.mkPP(t,i);const c=t.sub(o);let d=Math.atan2(c.y,c.x);const b=i.sub(o);let N=Math.atan2(b.y,b.x),F=N-d;if(F<0&&(F+=2*Math.PI,N+=2*Math.PI),F<=Math.PI)return new Tn(d,N,new k(a,0),new k(0,a),o);for(N>2*Math.PI&&(N-=2*Math.PI),d=Math.PI-d,N=Math.PI-N,d<0&&(d+=2*Math.PI);N<d;)N+=2*Math.PI;return F=N-d,new Tn(d,N,new k(-a,0),new k(0,a),o)}static FindArcCenter(t,n,i,s){const o=n.sub(t).rotate90Cw(),a=n.sub(i).rotate90Cw();return s.center=k.lineLineIntersection(t,t.add(o),i,i.add(a)),null!=s.center}static StandardBezier(t,n,i,s){const o=Dn(t,i)/4;return Er.mkBezier([t,t.add(n.mul(o)),i.add(s.mul(o)),i])}FanBezierSegs(){let t=!0,i=0;for(;t&&i++<5;){t=!1;for(const s of this.metroGraphData.Stations)for(const o of s.BundleBases.values())t||(t=this.FanEdgesOfHubSegment(o))}}FanEdgesOfHubSegment(t){let n=!1;for(let i=0;i<t.Count-1;i++)n||(n=this.FanCouple(t,i,t.CurveCenter,t.Curve.boundingBox.diagonal/2));return n}FanCouple(t,n,i,s){const o=t.OrientedHubSegments[n],a=t.OrientedHubSegments[n+1];if(null==o||Me.IntersectPPPP(o.Segment.start,o.Segment.end,a.Segment.start,a.Segment.end)||k.getTriangleOrientation(o.value(0),o.value(.5),o.value(1))!=k.getTriangleOrientation(a.value(0),a.value(.5),a.value(1)))return!1;const c=this.BaseLength(o),d=this.BaseLength(a);return!(Math.abs(c-d)<le.intersectionEpsilon)&&(c>d?this.AdjustLongerSeg(o,a,i,s):this.AdjustLongerSeg(a,o,i,s))}AdjustLongerSeg(t,n,i,s){const o=t.value(0).sub(n.value(0)),a=t.value(1).sub(n.value(1)),l=Math.min(o.length,a.length),c=n.value(.5),d=Math.max(o.length,a.length);return 0!=this.NicelyAligned(t.Segment,o,a,c,l,d)&&this.FitLonger(t,o,a,c,l,d,i,s)}FitLonger(t,n,i,s,o,a,l,c){let d=t.Segment;const b=d.start,N=d.end;let F=0,W=d.start.mul(1-r.SqueezeBound).add(d.B(1).mul(r.SqueezeBound)),ie=d.end.mul(1-r.SqueezeBound).add(d.B(2).mul(r.SqueezeBound)),he=d.B(1).mul(2).sub(d.start),de=d.B(2).mul(2).sub(d.end);const Te={highP:he};this.PullControlPointToTheCircle(d.start,Te,l,c),he=Te.highP;let Ke=this.NicelyAligned(d,n,i,s,o,a);for(;;){if(-1==Ke){const Xe=k.middle(d.B(1),W),Et=k.middle(d.B(2),ie);he=d.B(1),de=d.B(2),d=new Er(b,Xe,Et,N)}else{const Xe=k.middle(d.B(1),he),Et=(d.B(2),de);W=d.B(1),ie=d.B(2),d=new Er(b,Xe,Et,N)}if(0==(Ke=this.NicelyAligned(d,n,i,s,o,a)))return t.Segment=d,t.Other.Segment=d,!0;if(F++>10)return!1}}PullControlPointToTheCircle(t,n,i,s){const o=k.ProjectionToLine(t,n.highP,i),a=Math.sqrt(s*s-o.sub(i).lengthSquared),l=n.highP.sub(o),c=l.length;c>a&&(n.highP=o.add(l.mul(a/c)))}NicelyAligned(t,n,i,s,o,a){const c=t.value(.5).sub(s),d=c.length;return n.dot(c)<0||i.dot(c)<0||d<o-.001?1:d>a+.001?-1:0}BaseLength(t){return t.value(0).sub(t.value(1)).lengthSquared}}return r.SqueezeBound=.2,r})(),jy=(()=>{class r{constructor(t,n){this.stepsWithProgress=0,this.metroGraphData=t,this.bundlingSettings=n,this.costCalculator=new yo(this.metroGraphData,this.bundlingSettings),this.cache=new XS(this.metroGraphData,this.bundlingSettings,this.costCalculator,this.metroGraphData.Cdt)}static FixRouting(t,n){return this.FixRoutingMBP(t,n,null)}static FixRoutingMBP(t,n,i){return new r(t,n).FixRoutingP(i)}FixRoutingP(t){this.stationsForOptimizations=this.GetStationsForOptimizations(t),this.cache.InitializeCostCache();let n=r.MaxStep,i=Number.POSITIVE_INFINITY,s=this.metroGraphData.VirtualStations().map(a=>a.Position),o=0;for(;o++<r.MaxIterations;){const a=this.TryMoveStations();if(o<=1&&!a)return!1;if(!a)break;const l=i;i=yo.Cost(this.metroGraphData,this.bundlingSettings),n=this.UpdateMaxStep(n,l,i);const c=s;if(s=this.metroGraphData.VirtualStations().map(d=>d.Position),n<r.MinStep||this.Converged(n,c,s))break}return!0}static stationsArePositionedCorrectly(t){for(const n of t.VirtualEdges())if(!this.edgeIsPositionedCorrectly(n,t))return!1;return!0}static edgeIsPositionedCorrectly(t,n){const i=t[0],s=t[1],o=n.looseIntersections.ObstaclesToIgnoreForBundle(i,s),a=Me.mkPP(i.Position,s.Position),l=Array.from(n.looseIntersections.obstacleTree.GetNodeItemsIntersectingRectangle(a.boundingBox)).filter(c=>!o.has(c)).filter(c=>fe.CurvesIntersect(a,c));return!(l.length>0&&(tA.ShowHubs(n,null,null,"/tmp/badcross.svg",[qt.mkDebugCurveTWCI(200,1,"Brown",a),qt.mkDebugCurveTWCI(200,1,"Red",gs.mkCircle(2,i.Position)),qt.mkDebugCurveTWCI(200,1,"Blue",gs.mkCircle(5,s.Position)),qt.mkDebugCurveTWCI(100,1,"Blue",gs.mkCircle(5,s.Position))].concat(l.map(c=>qt.mkDebugCurveTWCI(100,1,"Pink",c)))),1))}GetStationsForOptimizations(t){if(null==t)return new Set(this.metroGraphData.VirtualStations());{const n=new Set;for(const i of t){const s=this.metroGraphData.PointToStations.get(i);s&&!s.IsReal&&n.add(s)}return n}}Converged(t,n,i){let s=0,o=0;for(let l=0;l<n.length;l++)o+=n[l].sub(i[l]).lengthSquared,s+=n[l].lengthSquared;return Math.sqrt(o/s)<r.MinRelativeChange}UpdateMaxStep(t,n,i){return i+1<n?(this.stepsWithProgress++,this.stepsWithProgress>=5&&(this.stepsWithProgress=0,t=Math.min(r.MaxStep,t/.8))):(this.stepsWithProgress=0,t*=.8),t}TryMoveStations(){let t=!1;const n=new Set;for(const i of this.stationsForOptimizations)if(this.TryMoveStation(i)){t=!0,n.add(i);for(const s of i.Neighbors)s.IsReal||n.add(s)}return this.stationsForOptimizations=n,t}TryMoveStation(t){let n=this.BuildDirection(t);if(0==n.length)return!1;let i=this.BuildStepLength(t,n);if(i<r.MinStep&&(n=function i5(){return new k(1+2*dT(),1+2*dT())}(),i=this.BuildStepLength(t,n),i<r.MinStep))return!1;const s=n.mul(i),o=t.Position.add(s);return!(this.metroGraphData.PointToStations.has(o)||!this.moveIsLegalForAdjacentBundles(t,o)||(this.metroGraphData.MoveNode(t,o),this.cache.UpdateCostCache(t),0))}moveIsLegalForAdjacentBundles(t,n){for(const i of this.metroGraphData.looseIntersections.obstacleTree.AllHitItems(lt.mkOnPoints([n]),s=>fe.PointRelativeToCurveLocation(n,s)!=Ot.Outside))if(0==t.getELP().has(i))return!1;for(const i of t.Neighbors){const s=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(i,t);if(!this.metroGraphData.cdtIntersections.EdgeIsLegal_(i.Position,n,i.CdtTriangle,s))return!1}return!0}BuildDirection(t){const n=this.BuildForceForInk(t),i=this.BuildForceForPathLengths(t),s=this.BuildForceForRadius(t),o=this.BuildForceForBundle(t),a=n.add(i.add(s.add(o)));return a.length<.1?new k(0,0):a.normalize()}BuildStepLength(t,n){let i=r.MinStep,s=this.CostGain(t,t.Position.add(n.mul(i)));if(s<.01)return 0;for(;2*i<=r.MaxStep;){const o=this.CostGain(t,t.Position.add(n.mul(2*i)));if(o<=s)break;i*=2,s=o}return i}CostGain(t,n){const s=this.costCalculator.RadiusGain(t,n);if(s<-12345678)return-12345678;const o=this.costCalculator.BundleGain(t,n);return o<-12345678?-12345678:s+this.costCalculator.InkGain(t,n)+this.costCalculator.PathLengthsGain(t,n)+o}BuildForceForInk(t){let n=new k(0,0);for(const s of t.Neighbors){const o=s.Position.sub(t.Position);n=n.add(o.normalize())}return n.mul(this.bundlingSettings.InkImportance)}BuildForceForPathLengths(t){let n=new k(0,0);for(const s of this.metroGraphData.MetroNodeInfosOfNode(t)){const o=s.Metroline,l=s.PolyPoint.prev.point,c=s.PolyPoint.next.point.sub(t.Position),d=l.sub(t.Position);n=n.add(c.div(c.length*o.IdealLength)),n=n.add(d.div(d.length*o.IdealLength))}return n.mul(this.bundlingSettings.PathLengthImportance)}BuildForceForRadius(t){let n=new k(0,0);const i=t.cachedIdealRadius,s={touchedObstacles:[]};if(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesSPNBA(t,t.Position,i,s))throw tA.ShowHubs(this.metroGraphData,null,t,"/tmp/hubs.svg",[qt.mkDebugCurveTWCI(255,1,"Brown",Ga.containingPoly),qt.mkDebugCurveTWCI(100,1,"Blue",gs.mkCircle(i,t.Position))]),new Error;for(const l of s.touchedObstacles){const d=2*(1-l[1].sub(t.Position).length/i),b=t.Position.sub(l[1]).normalize();n=n.add(b.mul(d))}return n.mul(this.bundlingSettings.HubRepulsionImportance)}BuildForceForBundle(t){let n=new k(0,0);for(const s of t.Neighbors){const o=this.metroGraphData.GetWidthSSN(t,s,this.bundlingSettings.EdgeSeparation),a={closestDist:[]};this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(t,s,t.Position,s.Position,o/2,a)||tA.ShowHubs(this.metroGraphData,null,t,"/tmp/inside_forbid.svg",[qt.mkDebugCurveTWCI(100,.2,"Blue",Me.mkPP(t.Position,s.Position)),qt.mkDebugCurveTWCI(100,.2,"Red",gs.mkCircle(2,t.Position)),qt.mkDebugCurveTWCI(100,.2,"Red",gs.mkCircle(3,s.Position))]);for(const c of a.closestDist){const b=2*(1-c[0].sub(c[1]).length/(o/2)),N=c[0].sub(c[1]).normalize().neg();n=n.add(N.mul(b))}}return n.mul(this.bundlingSettings.BundleRepulsionImportance)}}return r.MaxIterations=100,r.MaxStep=50,r.MinStep=1,r.MinRelativeChange=5e-4,r})();class od{constructor(e,t){this.metroGraphData=e,this.bundlingSettings=t}static FixRouting(e,t){const n=new od(e,t);n.GlueConflictingStations(),n.UnglueEdgesFromBundleToSaveInk(!0);let i=0;for(;++i<10;){let o=n.GlueConflictingStations();if(o||(o=n.RelaxConstrainedEdges()),o||(o=i<=3&&n.UnglueEdgesFromBundleToSaveInk(!1)),o||(o=n.GlueCollinearNeighbors(i)),o||(o=3==i&&n.RemoveDoublePathCrossings()),!o)break}for(e.cdtIntersections.ComputeForcesForBundles=!0,n.RemoveDoublePathCrossings(),n.UnglueEdgesFromBundleToSaveInk(!0);n.GlueConflictingStations(););e.Initialize(!0)}GlueConflictingStations(){const e=this.GetCirclesHierarchy();if(null==e)return!1;const t=new Map,n=new Set;if(es(e,e,(s,o)=>this.TryToGlueStations(s,o,t,n)),0==t.size)return!1;for(let s=0;s<this.metroGraphData.Edges.length;s++)this.RegenerateEdge(t,s);const i=new Fr;for(const s of n){i.add(s.Position);for(const o of s.Neighbors)o.IsReal||i.add(o.Position)}return this.metroGraphData.Initialize(!1),jy.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,i),!0}GetCirclesHierarchy(){for(const n of this.metroGraphData.VirtualStations())n.Radius=this.GetCurrentHubRadius(n);return Tr(this.metroGraphData.VirtualStations().map(function t(n){const i=n.Position,s=Math.max(n.Radius,5),o=new k(s,s);return gi(n,lt.mkPP(i.add(o),i.sub(o)))}))}GetCurrentHubRadius(e){if(e.IsReal)return e.BoundaryCurve.boundingBox.diagonal/2;{let n=this.metroGraphData.looseIntersections.GetMinimalDistanceToObstacles(e,e.Position,e.cachedIdealRadius);for(const i of e.Neighbors)n=Math.min(n,e.Position.sub(i.Position).length);return n}}TryToGlueStations(e,t,n,i){if(!LS(e.getELP(),t.getELP()))return!1;e.Position.sub(t.Position).length>=Math.max(e.Radius,5)+Math.max(t.Radius,5)||this.TryGlueOrdered(e,t,i,n)||this.TryGlueOrdered(t,e,i,n)}TryGlueOrdered(e,t,n,i){return!(i.has(e)||n.has(e)||!this.StationGluingIsAllowed(e,t,i)||(this.Map(e,t,n,i),0))}Map(e,t,n,i){i.set(e,t),n.add(t)}StationGluingIsAllowed(e,t,n){for(const s of e.Neighbors){const o=od.Glued(s,n),a=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(o,e);if(!this.metroGraphData.cdtIntersections.EdgeIsLegalSSPPS(o,t,a))return!1}return!(this.ComputeCostDeltaAfterStationGluing(e,t,n)<0)}ComputeCostDeltaAfterStationGluing(e,t,n){const i=e.Position.sub(t.Position).length;if(e.Radius>=i||t.Radius>=i)return 1;let s=0;const o=this.metroGraphData.Ink;let a=this.metroGraphData.Ink-t.Position.sub(e.Position).length;for(const l of e.Neighbors){const c=od.Glued(l,n);a-=c.Position.sub(e.Position).length,a+=0==this.metroGraphData.RealEdgeCount(c,t)?c.Position.sub(t.Position).length:0}s+=yo.InkError(o,a,this.bundlingSettings);for(const l of this.metroGraphData.MetroNodeInfosOfNode(e)){const c=l.Metroline.Length;let d=l.Metroline.Length;const b=l.PolyPoint,N=b.prev,F=b.next;d-=N.point.sub(e.Position).length+F.point.sub(e.Position).length,d+=N.point.sub(t.Position).length+F.point.sub(t.Position).length,s+=yo.PathLengthsError(c,d,l.Metroline.IdealLength,this.bundlingSettings)}return s}RegenerateEdge(e,t){const n=this.metroGraphData.Metrolines[t].Polyline;for(const o of n)if(!this.metroGraphData.PointToStations.has(o))return;let i=!1;for(const o of n)if(e.has(this.metroGraphData.PointToStations.get(o))){i=!0;break}if(!i)return;const s=Array.from(n).map(o=>this.metroGraphData.PointToStations.get(o));this.metroGraphData.Edges[t].curve=At.mkFromPoints(od.GluedPolyline(s,e))}static GluedPolyline(e,t){let n;const i=new cr.K;i.push(e[0]);const s=new Set;for(n=1;n<e.length-1;n++){const o=od.Glued(e[n],t);if(s.has(o))for(;i.top!=o;)s.delete(i.pop());else k.closeDistEps(o.Position,i.top.Position)||(s.add(o),i.push(o))}return i.push(e[n]),Array.from(i).reverse().map(o=>o.Position)}static Glued(e,t){var n;return null!==(n=t.get(e))&&void 0!==n?n:e}UnglueEdgesFromBundleToSaveInk(e){const t=new xy;this.ink=this.metroGraphData.Ink,this.polylineLength=new Map;for(const s of this.metroGraphData.Metrolines){this.polylineLength.set(s,s.Length);for(let o=s.Polyline.startPoint;null!=o.next;o=o.next)qx(t,new qi(o.point,o.next.point),s)}const n=new Fr;let i=!1;for(const s of this.metroGraphData.Metrolines){const o=Cu(this.metroGraphData.PointToStations.get(s.Polyline.start).getELP(),this.metroGraphData.PointToStations.get(s.Polyline.end).getELP());this.TrySeparateOnPolyline(s,t,n,o)&&(i=!0)}return i&&this.metroGraphData.Initialize(!1),(e||i)&&jy.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,e?null:n),i}TrySeparateOnPolyline(e,t,n,i){let s=!1,o=!0;for(;o;){o=!1;for(let a=e.Polyline.startPoint;null!=a.next&&null!=a.next.next;a=a.next)this.TryShortcutPolypoint(a,t,n,i)&&(o=!0);o&&(s=!0)}return s}TryShortcutPolypoint(e,t,n,i){return!!this.SeparationShortcutAllowed(e,t,i)&&(n.add(e.point),n.add(e.next.point),n.add(e.next.next.point),this.RemoveShortcuttedPolypoint(e,t),!0)}SeparationShortcutAllowed(e,t,n){const i=e.point,s=e.next.point,o=e.next.next.point,a=this.metroGraphData.PointToStations.get(i),l=this.metroGraphData.PointToStations.get(s),c=this.metroGraphData.PointToStations.get(o),d=eg(a.getELP(),c.getELP()),b=function GW(r){if(0==r.length)return new Set;let e=r[0];for(let t=1;t<r.length;t++)e=Cu(e,r[t]);return e}([n,l.getELP(),d]);return!(!this.metroGraphData.cdtIntersections.EdgeIsLegalSSPPS(a,c,b)||this.GetInkgain(e,t,i,s,o)<0)}GetInkgain(e,t,n,i,s){const[o,a,l]=this.FindPolylines(e,t);let c=0;const d=this.ink;let b=this.ink;const N=n.sub(i).length,F=i.sub(s).length,G=n.sub(s).length;o.size==l.size&&(b-=N),a.size==l.size&&(b-=F);const W=t.get(new qi(n,s));(!W||0==W.size)&&(b+=G),c+=yo.InkError(d,b,this.bundlingSettings);for(const Xe of l){const Et=this.polylineLength.get(Xe);c+=yo.PathLengthsError(Et,Et-(N+F-G),Xe.IdealLength,this.bundlingSettings)}let ie=this.GetCurrentHubRadius(this.metroGraphData.PointToStations.get(n));const he=this.metroGraphData.GetWidthAN(Array.from(l),this.bundlingSettings.EdgeSeparation),de=this.metroGraphData.GetWidthAN(Array.from(Zf(o,l)),this.bundlingSettings.EdgeSeparation);let Te=ns.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(ie,n,s,i,he,de,this.bundlingSettings);Te>ie&&(c-=yo.RError(Te,ie,this.bundlingSettings)),ie=this.GetCurrentHubRadius(this.metroGraphData.PointToStations.get(s));const Ke=this.metroGraphData.GetWidthAN(Array.from(Zf(a,l)),this.bundlingSettings.EdgeSeparation);return Te=ns.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(ie,s,i,n,Ke,he,this.bundlingSettings),Te>ie&&(c-=yo.RError(Te,ie,this.bundlingSettings)),c}RemoveShortcuttedPolypoint(e,t){const n=e.point,i=e.next.point,s=e.next.next.point,[o,a,l]=this.FindPolylines(e,t),c=Dn(n,i),d=Dn(i,s),b=Dn(n,s);o.size==l.size&&(this.ink-=c),a.size==l.size&&(this.ink-=d);const N=t.get(new qi(n,s));(!N||0==N.size)&&(this.ink+=b);for(const F of l){const G=this.polylineLength.get(F);this.polylineLength.set(F,G-(c+d-b))}for(const F of l){const G=Array.from(F.Polyline.polylinePoints()).find(W=>W.point.equal(i));this.RemovePolypoint(G),Qx(t,[n,i],F),Qx(t,[i,s],F),VW(t,[n,s],F)}}FindPolylines(e,t){const i=e.next.point,s=e.next.next.point,o=t.get_(e.point,i),a=t.get_(i,s);return[o,a,Cu(o,a)]}RemovePolypoint(e){const t=e.prev,n=e.next;t.next=n,n.prev=t}GlueCollinearNeighbors(e){const t=new Fr;let n=!1;for(const i of this.metroGraphData.Stations)this.GlueCollinearNeighborsSPN(i,t,e)&&(n=!0);return n&&(this.metroGraphData.Initialize(!1),jy.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,t)),n}GlueCollinearNeighborsSPN(e,t,n){if(e.Neighbors.length<=1)return!1;const i=new kL,s=e.Neighbors;for(let o=0;o<s.length;o++)this.TryToGlueEdges(e,s[o],s[(o+1)%s.length],i,n);if(i.isEmpty)return!1;for(const o of i)this.GlueEdge(o),t.add(o[0].Position),t.add(o[1].Position),t.add(o[2]);return!0}TryToGlueEdges(e,t,n,i,s){if(k.anglePCP(t.Position,e.Position,n.Position)<this.bundlingSettings.AngleThreshold){const a=Dn(t.Position,e.Position),l=Dn(n.Position,e.Position),c=Math.min(a,l)/Math.max(a,l);if(c<.05)return;if(a<l){if(this.EdgeGluingIsAllowedSSS(e,t,n))return void this.AddEdgeToGlue(e,n,t,t.Position,i)}else if(this.EdgeGluingIsAllowedSSS(e,n,t))return void this.AddEdgeToGlue(e,t,n,n.Position,i);if(s<5&&c>.5){const d=this.ConstructGluingPoint(e,t,n);this.EdgeGluingIsAllowedSSSP(e,t,n,d)&&this.AddEdgeToGlue(e,n,t,d,i)}}}ConstructGluingPoint(e,t,n){const i=Math.min(Dn(t.Position,e.Position),Dn(n.Position,e.Position)/2),s=t.Position.sub(e.Position).normalize().add(n.Position.sub(e.Position).normalize());return e.Position.add(s.mul(i/2))}EdgeGluingIsAllowedSSS(e,t,n){if(t.IsReal||n.IsReal||!LS(t.getELP(),n.getELP())||!this.metroGraphData.cdtIntersections.EdgeIsLegal(t,n,t.Position,n.Position))return!1;const i=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,n);return!(On.IntersectionsOfLineAndRectangleNodeOverPolylineLR(Me.mkPP(e.Position,t.Position),this.metroGraphData.LooseTree).find(l=>!i.has(l.seg1))||On.IntersectionsOfLineAndRectangleNodeOverPolylineLR(Me.mkPP(t.Position,n.Position),this.metroGraphData.LooseTree).find(l=>!i.has(l.seg1))||this.ComputeCostDeltaAfterEdgeGluing(e,t,n,t.Position)<0)}EdgeGluingIsAllowedSSSP(e,t,n,i){return!(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesPNS__(i,0,Cu(t.getELP(),n.getELP()))||!this.metroGraphData.cdtIntersections.EdgeIsLegal(e,null,e.Position,i)||!this.metroGraphData.cdtIntersections.EdgeIsLegal(t,null,t.Position,i)||!this.metroGraphData.cdtIntersections.EdgeIsLegal(n,null,n.Position,i)||this.ComputeCostDeltaAfterEdgeGluing(e,t,n,i)<0)}ComputeCostDeltaAfterEdgeGluing(e,t,n,i){let s=0;const o=this.metroGraphData.Ink,a=this.metroGraphData.Ink-Dn(e.Position,n.Position)-Dn(e.Position,t.Position)+Dn(e.Position,i)+Dn(i,t.Position)+Dn(i,n.Position);s+=yo.InkError(o,a,this.bundlingSettings);for(const b of this.metroGraphData.GetIjInfo(e,n).Metrolines){const N=b.Length,F=b.Length-Dn(e.Position,n.Position)+Dn(e.Position,i)+Dn(i,n.Position);s+=yo.PathLengthsError(N,F,b.IdealLength,this.bundlingSettings)}for(const b of this.metroGraphData.GetIjInfo(e,t).Metrolines){const N=b.Length,F=b.Length-Dn(e.Position,t.Position)+Dn(e.Position,i)+Dn(i,t.Position);s+=yo.PathLengthsError(N,F,b.IdealLength,this.bundlingSettings)}const l=e.cachedIdealRadius,c=this.GetCurrentHubRadius(e),d=ns.GetMinRadiusForTwoAdjacentBundles(c,e,e.Position,t,n,this.metroGraphData,this.bundlingSettings);return d>c&&(s+=yo.RError(d,c,this.bundlingSettings)),l>Dn(e.Position,i)&&!e.IsReal&&(s-=yo.RError(l,Dn(e.Position,i),this.bundlingSettings)),s}AddEdgeToGlue(e,t,n,i,s){s.has(n,e)||s.has(t,e)||s.has(e,n)||s.has(e,t)||(s.set(e,n,i),s.set(e,t,i))}GlueEdge(e){const t=e[0],n=e[1],i=e[2];for(const s of t.MetroNodeInfos.map(o=>o.PolyPoint))null!=s.next&&s.next.point.equal(n.Position)?this.SplitPolylinePoint(s,i):null!=s.prev&&s.prev.point.equal(n.Position)&&this.SplitPolylinePoint(s.prev,i)}SplitPolylinePoint(e,t){if(e.point==t||e.next.point==t)return;const n=oo.mkFromPoint(t);n.polyline=e.polyline,n.next=e.next,n.prev=e,n.next.prev=n,n.prev.next=n}RelaxConstrainedEdges(){const e=new Fr;let t=!1;for(const n of this.metroGraphData.VirtualEdges())this.RelaxConstrainedEdge(n[0],n[1],e)&&(t=!0);return t&&(this.metroGraphData.Initialize(!1),jy.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,e)),t}RelaxConstrainedEdge(e,t,n){const i=this.metroGraphData.GetWidthSSN(e,t,this.bundlingSettings.EdgeSeparation),s={closestDist:new Array};this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(e,t,e.Position,t.Position,.99*i/2,s);const o=s.closestDist;if(o.length>0){let l,a=-1;for(const c of o){if(Math.min(Dn(e.Position,c[1]),Dn(t.Position,c[1]))/Dn(e.Position,t.Position)<.1)continue;const F=Dn(c[0],c[1]);(-1==a||F<a)&&(a=F,l=c[1])}if(-1==a||!this.metroGraphData.looseIntersections.HubAvoidsObstaclesPNS__(l,0,Cu(e.getELP(),t.getELP())))return!1;n.add(l),n.add(e.Position),n.add(t.Position);for(const c of this.metroGraphData.GetIjInfo(e,t).Metrolines){let d=null;for(const b of c.Polyline.polylinePoints())if(b.point.equal(e.Position)){d=b;break}null!=d.next&&d.next.point.equal(t.Position)?this.SplitPolylinePoint(d,l):this.SplitPolylinePoint(d.prev,l)}return!0}return!1}RemoveDoublePathCrossings(){const e=new Wy(this.metroGraphData,this.metroGraphData.PointIsAcceptableForEdge.bind(this)).run();return e&&(this.metroGraphData.Initialize(!1),jy.FixRouting(this.metroGraphData,this.bundlingSettings)),e}}class nA{constructor(e,t,n){this.upperBound=Number.POSITIVE_INFINITY,this._visGraph=n,n.ClearPrevEdgesTable();for(const i of n.Vertices())i.Distance=Number.POSITIVE_INFINITY;this.sources=e,this.targets=new Set(t)}GetPath(){const e=new Iu;for(const t of this.sources)t.Distance=0,e.Enqueue(t,0);for(;!e.IsEmpty()&&(this._current=e.Dequeue(),!this.targets.has(this._current));){for(const t of this._current.OutEdges)this.PassableOutEdge(t)&&this.ProcessNeighbor(e,t,t.Target);for(const t of this._current.InEdges.filter(this.PassableInEdge.bind))this.ProcessNeighbor(e,t,t.Source)}return null==this._visGraph.PreviosVertex(this._current)?null:this.CalculatePath()}PassableOutEdge(e){return this.targets.has(e.Target)||!nA.IsForbidden(e)}PassableInEdge(e){return this.targets.has(e.Source)||!nA.IsForbidden(e)}static IsForbidden(e){return(null!=e.IsPassable&&!e.IsPassable()||e)instanceof ml}ProcessNeighbor(e,t,n){const s=this._current.Distance+t.Length;s>=this.upperBound||(this.targets.has(n)&&(this.upperBound=s,this.closestTarget=n),null==this._visGraph.PreviosVertex(n)?(n.Distance=s,this._visGraph.SetPreviousEdge(n,t),e.Enqueue(n,s)):s<n.Distance&&(n.Distance=s,this._visGraph.SetPreviousEdge(n,t),e.DecreasePriority(n,s)))}CalculatePath(){if(null==this.closestTarget)return null;const e=new Array;let t=this.closestTarget;do{e.push(t),t=this._visGraph.PreviosVertex(t)}while(t.Distance>0);return e.push(t),e.reverse()}}let fg=(()=>{class r extends Rr{constructor(t,n,i,s,o,a,l,c,d,b){super(null),this.bundlingSettings=s,this.edgesToRoute=t,this.regularEdges=t.filter(N=>N.source!=N.target),this.VisibilityGraph=i,this.shortestPathRouter=n,this.LoosePadding=o,this.LooseHierarchy=l,this.TightHierarchy=a,this.EdgeLooseEnterable=c,this.EdgeTightEnterable=d,this.loosePolylineOfPort=b}ThereAreOverlaps(t){return Ko(t,t,fe.CurvesIntersect)}run(){this.ThereAreOverlaps(this.TightHierarchy)?this.Status=Uy.Overlaps:(this.FixLocationsForHookAnywherePorts(this.edgesToRoute),this.RoutePathsWithSteinerDijkstra()?(this.FixChildParentEdges(),this.bundlingSettings.StopAfterShortestPaths||this.OrderOptimizeNudgeEtc(),this.RouteSelfEdges(),this.FixArrowheads()):this.Status=Uy.EdgeSeparationIsTooLarge)}OrderOptimizeNudgeEtc(){const t=new Q4(this.regularEdges,this.LooseHierarchy,this.TightHierarchy,this.bundlingSettings,this.shortestPathRouter.CdtProperty,this.EdgeLooseEnterable,this.EdgeTightEnterable,this.loosePolylineOfPort);od.FixRouting(t,this.bundlingSettings),new tA(t,this.bundlingSettings).run()}FixChildParentEdges(){for(const t of this.regularEdges){const n=t.sourcePort,i=t.targetPort;if(n.Curve.boundingBox.containsRect(i.Curve.boundingBox)){const s=fe.intersectionOne(n.Curve,Me.mkPP(t.curve.start,t.curve.end),!1);t.curve.startPoint.point=s.x}if(i.Curve.boundingBox.containsRect(n.Curve.boundingBox)){const s=fe.intersectionOne(i.Curve,Me.mkPP(t.curve.start,t.curve.end),!0);t.curve.endPoint.point=s.x}}}static CreateConstrainedDelaunayTriangulation(t){const n=Array.from(t.GetAllLeaves());let i=t.irect;return i=i.pad(i.diagonal/4),r.GetConstrainedDelaunayTriangulation(n.concat([i.perimeter()]))}static GetConstrainedDelaunayTriangulation(t){const n=new Ir(null,t,null);return n.run(),n}FixLocationsForHookAnywherePorts(t){for(const n of t){let i=n.sourcePort instanceof Zi;if(i){const s=n.sourcePort;s.SetLocation(this.FigureOutHookLocation(s.LoosePolyline,n.targetPort,n))}else if(i=n.targetPort instanceof Zi,i){const s=n.targetPort;s.SetLocation(this.FigureOutHookLocation(s.LoosePolyline,n.sourcePort,n))}}}FigureOutHookLocation(t,n,i){return n instanceof $o?this.FigureOutHookLocationForClusterOtherPort(t,n,i):this.FigureOutHookLocationForSimpleOtherPort(t,n,i)}FigureOutHookLocationForClusterOtherPort(t,n,i){const s=this.shortestPathRouter.MakeTransparentShapesOfEdgeGeometry(i),a=new nA(Array.from(n.LoosePolyline).map(this.VisibilityGraph.FindVertex.bind),Array.from(t).map(this.VisibilityGraph.FindVertex.bind),this.VisibilityGraph).GetPath();for(const l of s)l.IsTransparent=!1;return a[a.length-1].point}FigureOutHookLocationForSimpleOtherPort(t,n,i){const s=n.Location,o=this.shortestPathRouter.MakeTransparentShapesOfEdgeGeometry(i),l=new _y(this.VisibilityGraph.FindVertex(s),Array.from(t).map(c=>this.VisibilityGraph.FindVertex(c)),this.VisibilityGraph).GetPath();for(const c of o)c.IsTransparent=!1;return l[l.length-1].point}RoutePathsWithSteinerDijkstra(){return this.shortestPathRouter.VisibilityGraph=this.VisibilityGraph,this.shortestPathRouter.BundlingSettings=this.bundlingSettings,this.shortestPathRouter.geomEdges=this.regularEdges,this.shortestPathRouter.ObstacleHierarchy=this.LooseHierarchy,this.shortestPathRouter.RouteEdges(),!(null!=this.shortestPathRouter.CdtProperty&&!this.AnalyzeEdgeSeparation())}AnalyzeEdgeSeparation(){const t=new Map;this.shortestPathRouter.FillCrossedCdtEdges(t);const n=this.GetPathsOnCdtEdge(t),i=this.CalculateMaxAllowedEdgeSeparation(n);if(i>=this.bundlingSettings.EdgeSeparation)return!0;if(i<=.02){for(const s of this.regularEdges)s.curve=null;return!1}return this.bundlingSettings.EdgeSeparation=i,this.shortestPathRouter.RouteEdges(),!0}GetPathsOnCdtEdge(t){const n=new Map;for(const i of t.keys())for(const s of t.get(i))MS(n,s,i);return n}CalculateMaxAllowedEdgeSeparation(t){let n=.01,i=10;if(this.EdgeSeparationIsOkMN(t,i))return i;for(;Math.abs(i-n)>.01;){const s=(n+i)/2;this.EdgeSeparationIsOkMN(t,s)?n=s:i=s}return n}EdgeSeparationIsOkMN(t,n){const i=t.size;if(0==i)return!0;let s=0;for(const o of t.keys())this.EdgeSeparationIsOk(o,t.get(o),n)&&s++;return s/i>this.bundlingSettings.MinimalRatioOfGoodCdtEdges}EdgeSeparationIsOk(t,n,i){return Array.from(n).map(o=>o.lineWidth).reduce((o,a)=>o+a,0)+(n.size-1)*i<=t.Capacity}RouteSelfEdges(){for(const t of this.edgesToRoute)t.source==t.target&&(t.curve=vu.RouteSelfEdge(t.source.boundaryCurve,2*this.LoosePadding,{smoothedPolyline:null}))}FixArrowheads(){for(const t of this.edgesToRoute)wu.trimSplineAndCalculateArrowheadsII(t,t.source.boundaryCurve,t.target.boundaryCurve,t.curve,!1)}}return r.SuperLoosePaddingCoefficient=1.1,r})();class s5{constructor(e,t,n){this.numberOfPassedPaths=0,this.VisibilityEdge=e,this.Source=t,this.Target=n}get TargetPoint(){return this.Target.Point}get SourcePoint(){return this.Source.Point}get IsOccupied(){return this.numberOfPassedPaths>0}get IsPassable(){return this.Target.IsTargetOfRouting||this.Source.IsSourceOfRouting||null==this.VisibilityEdge.IsPassable||this.VisibilityEdge.IsPassable()}AddOccupiedEdge(){this.numberOfPassedPaths++}RemoveOccupiedEdge(){this.numberOfPassedPaths--}}class o5{constructor(e){this.InBoneEdges=new Array,this.OutBoneEdges=new Array,this.VisibilityVertex=e}get Prev(){return null==this.PrevEdge?null:this.PrevEdge.Source==this?this.PrevEdge.Target:this.PrevEdge.Source}get Point(){return this.VisibilityVertex.point}get Cost(){return this.IsSourceOfRouting?this.cost:null==this.Prev?Number.POSITIVE_INFINITY:this.cost}set Cost(e){this.cost=e}SetPreviousToNull(){this.PrevEdge=null}}class Nu{constructor(e,t,n){this.EdgesToRoutes=new Map,this.EdgesToRouteSources=new Map,this.MakeTransparentShapesOfEdgeGeometry=e,this.CdtProperty=t,this.Gates=n}CreateGraphElements(){for(const e of this.vertexArray){const t=e.VisibilityVertex;for(const n of t.InEdges){const i=new s5(n,this.VisibilityVerticesToSdVerts.get(n.Source),this.VisibilityVerticesToSdVerts.get(n.Target)),s=this.VisibilityVerticesToSdVerts.get(n.Source);e.InBoneEdges.push(i),s.OutBoneEdges.push(i)}}}CreateRoutingGraph(){this.vertexArray=[],this.VisibilityVerticesToSdVerts=new Map;for(const e of this.VisibilityGraph.Vertices()){const t=new o5(e);this.vertexArray.push(t),this.VisibilityVerticesToSdVerts.set(e,t)}this.CreateGraphElements()}RouteEdges(){this.Initialize(),this.RestoreCapacities();for(const e of this.geomEdges)this.EdgesToRoutes.set(e,this.RouteEdge(e));this.RerouteEdges();for(const e of this.geomEdges)this.SetEdgeGeometryCurve(e)}SetEdgeGeometryCurve(e){const t=new At;let n=this.EdgesToRouteSources.get(e);t.addPoint(n.Point);for(const o of this.EdgesToRoutes.get(e))o.SourcePoint.equal(n.Point)?(t.addPoint(o.TargetPoint),n=o.Target):(t.addPoint(o.SourcePoint),n=o.Source);e.curve=t,e.sourcePort instanceof $o&&Nu.ExtendPolylineStartToClusterBoundary(t,e.sourcePort.Curve),e.targetPort instanceof $o&&Nu.ExtendPolylineEndToClusterBoundary(t,e.targetPort.Curve)}static ExtendPolylineEndToClusterBoundary(e,t){const n=t.closestParameter(e.end);e.addPoint(t.value(n))}static ExtendPolylineStartToClusterBoundary(e,t){const n=t.closestParameter(e.start);e.PrependPoint(t.value(n))}RerouteEdges(){this.RestoreCapacities();for(const e of this.geomEdges){const t=this.RerouteEdge(e);this.EdgesToRoutes.set(e,t)}}RestoreCapacities(){null!=this.CdtProperty&&this.CdtProperty.RestoreEdgeCapacities()}RerouteEdge(e){const t=this.EdgesToRoutes.get(e);for(const n of t)n.RemoveOccupiedEdge();return this.RouteEdge(e)}RouteEdge(e){this.CurrentEdgeGeometry=e;for(let i=0;i<this.vertexArray.length;i++){const s=this.vertexArray[i];s.SetPreviousToNull(),s.IsTargetOfRouting=s.IsSourceOfRouting=!1}const t=this.MakeTransparentShapesOfEdgeGeometry(e),n=this.RouteEdgeWithGroups();for(const i of t)i.IsTransparent=!1;return n}RouteEdgeWithGroups(){for(let e=0;e<2;e++){this.SetLengthCoefficient(),this.Queue=new Iu,this.sourceLoosePoly=this.SetPortVerticesAndObstacles(this.CurrentEdgeGeometry.sourcePort,!0),this.targetLoosePoly=this.SetPortVerticesAndObstacles(this.CurrentEdgeGeometry.targetPort,!1);const t=this.RouteOnKnownSourceTargetVertices(this.CurrentEdgeGeometry.targetPort.Location.sub(this.CurrentEdgeGeometry.sourcePort.Location).normalize(),0==e);if(null!=t)return t;for(let n=0;n<this.vertexArray.length;n++)this.vertexArray[n].SetPreviousToNull()}throw new Error}RouteOnKnownSourceTargetVertices(e,t){for(this.LowestCostToTarget=Number.POSITIVE_INFINITY,this.ClosestTargetVertex=null;this.Queue.count>0;){const n={priority:0},i=this.Queue.DequeueAndGetPriority(n);if(!(n.priority>=this.LowestCostToTarget)){for(let s=0;s<i.OutBoneEdges.length;s++){const o=i.OutBoneEdges[s];o.IsPassable&&this.ProcessOutcomingBoneEdge(i,o,e,t)}for(let s=0;s<i.InBoneEdges.length;s++){const o=i.InBoneEdges[s];o.IsPassable&&this.ProcessIncomingBoneEdge(i,o,e,t)}}}return this.GetPathAndUpdateRelatedCosts()}ProcessOutcomingBoneEdge(e,t,n,i){i&&n.dot(t.TargetPoint.sub(t.SourcePoint))<0||this.ProcessBoneEdge(e,t.Target,t)}ProcessIncomingBoneEdge(e,t,n,i){i&&n.dot(t.SourcePoint.sub(t.TargetPoint))<0||this.ProcessBoneEdge(e,t.Source,t)}ProcessBoneEdge(e,t,n){const i=this.GetEdgeAdditionalCost(n,e.Cost);if(!(t.Cost<=i))if(t.Cost=i,t.PrevEdge=n,this.Queue.ContainsElement(t))this.Queue.DecreasePriority(t,i);else{if(t.IsTargetOfRouting){let s=0;return this.CurrentEdgeGeometry.targetPort instanceof $o&&(s=this.LengthCoefficient*t.Point.sub(this.CurrentEdgeGeometry.targetPort.Location).length),void(i+s<this.LowestCostToTarget&&(this.LowestCostToTarget=i+s,this.ClosestTargetVertex=t))}this.Enqueue(t)}}GetPathAndUpdateRelatedCosts(){let e=this.ClosestTargetVertex;if(null==e)return null;const t=new Array;for(;null!=e.PrevEdge;)t.push(e.PrevEdge),this.RegisterPathInBoneEdge(e.PrevEdge),e=e.Prev;return this.EdgesToRouteSources.set(this.CurrentEdgeGeometry,e),t.reverse(),t}RegisterPathInBoneEdge(e){e.AddOccupiedEdge(),null!=this.CdtProperty&&0!=this.BundlingSettings.CapacityOverflowCoefficient&&this.UpdateResidualCostsOfCrossedCdtEdges(e)}UpdateResidualCostsOfCrossedCdtEdges(e){for(const t of e.CrossedCdtEdges)this.AdjacentToSourceOrTarget(t)||(t.ResidualCapacity-=t.ResidualCapacity==t.Capacity?this.CurrentEdgeGeometry.lineWidth:this.CurrentEdgeGeometry.lineWidth+this.BundlingSettings.EdgeSeparation)}H(e){return e.Cost+this.LengthCoefficient*e.Point.sub(this.CurrentEdgeGeometry.targetPort.Location).length}GetEdgeAdditionalCost(e,t){const n=e.TargetPoint.sub(e.SourcePoint).length;return this.LengthCoefficient*n+t+(e.IsOccupied?0:this.BundlingSettings.InkImportance*n)+this.CapacityOverflowCost(e)}CapacityOverflowCost(e){if(null==this.CdtProperty||0==this.BundlingSettings.CapacityOverflowCoefficient)return 0;let t=0;for(const n of this.CrossedCdtEdgesOfBoneEdge(e))t+=this.CostOfCrossingCdtEdgeLocal(this.capacityOverlowPenaltyMultiplier,this.BundlingSettings,this.CurrentEdgeGeometry,n);return t}CrossedCdtEdgesOfBoneEdge(e){return Array.from(null!=e.CrossedCdtEdges?e.CrossedCdtEdges:e.CrossedCdtEdges=this.ThreadBoneEdgeThroughCdt(e))}ThreadBoneEdgeThroughCdt(e){const t=e.SourcePoint,n=e.Source.Triangle,i=new Set,s=e.TargetPoint;if(Ir.PointIsInsideOfTriangle(s,n))return i;const o=new QS(n,t,s);for(;o.MoveNext();){const a=o.CurrentPiercedEdge;this.Gates.has(a)&&i.add(a)}return i}static CostOfCrossingCdtEdge(e,t,n,i){let s=n.lineWidth;i.Capacity!=i.ResidualCapacity&&(s+=t.EdgeSeparation);const o=i.ResidualCapacity-s;return o>=0?0:o*e*-1}CostOfCrossingCdtEdgeLocal(e,t,n,i){return this.AdjacentToSourceOrTarget(i)?0:Nu.CostOfCrossingCdtEdge(e,t,n,i)}AdjacentToSourceOrTarget(e){return e.upperSite.Owner==this.sourceLoosePoly||e.lowerSite.Owner==this.sourceLoosePoly||e.upperSite.Owner==this.targetLoosePoly||e.lowerSite.Owner==this.targetLoosePoly}SetLengthCoefficient(){const e=this.GetIdealDistanceBetweenSourceAndTarget(this.CurrentEdgeGeometry);this.LengthCoefficient=this.BundlingSettings.PathLengthImportance/e}GetIdealDistanceBetweenSourceAndTarget(e){return e.sourcePort.Location.sub(e.targetPort.Location).length}SetPortVerticesAndObstacles(e,t){let n;if(e instanceof $o){n=e.LoosePolyline;for(const s of n){let o=0;t&&(o=this.LengthCoefficient*s.sub(this.CurrentEdgeGeometry.sourcePort.Location).length),this.AddAndEnqueueVertexToEnds(s,t,o)}}else if(e instanceof Zi){n=e.LoosePolyline;for(const s of n)this.AddAndEnqueueVertexToEnds(s,t,0)}else{this.AddAndEnqueueVertexToEnds(e.Location,t,0);const i=Array.from(this.ObstacleHierarchy.GetNodeItemsIntersectingRectangle(e.Curve.boundingBox));let s=i[0].boundingBox.diagonal;n=i[0];for(let o=1;o<i.length;o++){const a=i[o],l=a.boundingBox.diagonal;l<s&&(s=l,n=a)}}return n}Enqueue(e){this.Queue.Enqueue(e,this.H(e))}AddAndEnqueueVertexToEnds(e,t,n){const i=this.FindVertex(e),s=this.VisibilityVerticesToSdVerts.get(i);t?(s.IsSourceOfRouting=!0,s.Cost=n,this.Enqueue(s)):s.IsTargetOfRouting=!0}FindVertex(e){return this.VisibilityGraph.FindVertex(e)}Initialize(){this.CreateRoutingGraph(),null!=this.CdtProperty&&(this.capacityOverlowPenaltyMultiplier=Nu.CapacityOverflowPenaltyMultiplier(this.BundlingSettings),this.SetVertexTriangles(),this.CalculateCapacitiesOfTrianglulation())}CalculateCapacitiesOfTrianglulation(){for(const e of this.Gates)Nu.CalculateCdtEdgeCapacityForEdge(e)}static CalculateCdtEdgeCapacityForEdge(e){if(e.Constrained||null==e.CwTriangle||null==e.CcwTriangle)return;const t=e.upperSite.Owner,n=e.lowerSite.Owner;if(t!=n){const i=Us.DistancePoint(new Us(t),e.lowerSite.point),s=Us.DistancePoint(new Us(n),e.upperSite.point);e.Capacity=(i+s)/2}}SetVertexTriangles(){ho(Tr(Array.from(this.CdtProperty.GetTriangles()).map(n=>gi(n,n.BoundingBox()))),Tr(this.vertexArray.map(n=>gi(n,lt.mkOnPoints([n.Point])))),(n,i)=>this.TryToAssigenTriangleToVertex(n,i));for(const n of this.vertexArray);}TryToAssigenTriangleToVertex(e,t){null==t.Triangle&&Ir.PointIsInsideOfTriangle(t.Point,e)&&(t.Triangle=e)}static CapacityOverflowPenaltyMultiplier(e){return e.CapacityOverflowCoefficient*(e.PathLengthImportance+e.InkImportance)}FillCrossedCdtEdges(e){for(const t of this.geomEdges){this.sourceLoosePoly=this.SetPortVerticesAndObstacles(t.sourcePort,!0),this.targetLoosePoly=this.SetPortVerticesAndObstacles(t.targetPort,!1);for(const n of this.EdgesToRoutes.get(t))for(const i of this.CrossedCdtEdgesOfBoneEdge(n))this.AdjacentToSourceOrTarget(i)||MS(e,t,i)}}}class rA{constructor(e,t,n,i,s){this.multiEdges=e,this.interactiveEdgeRouter=t,this.bundlingSettings=i,this.transparentShapeSetter=s,this.nodeTree=nT(n,o=>o.boundingBox)}run(){for(const e of this.GetIndependantPreGraphs())new fg(e.edges,new Nu(this.transparentShapeSetter,null,null),this.interactiveEdgeRouter.VisibilityGraph,this.bundlingSettings,this.interactiveEdgeRouter.LoosePadding,this.interactiveEdgeRouter.TightHierarchy,this.interactiveEdgeRouter.LooseHierarchy,null,null,null).run()}GetPortCurve(e){return this.nodeTree.FirstHitNodeWithPredicate(e.Location,(n,i)=>fe.PointRelativeToCurveLocation(n,i)!=Ot.Outside?Kn.Stop:Kn.Continue).UserData}GetIndependantPreGraphs(){const e=this.CreateInitialPregraphs();for(;;){const t=e.length;if(this.UniteConnectedPreGraphs({preGraphs:e}),t<=e.length)break}return e}UniteConnectedPreGraphs(e){const t=rA.GetIntersectionGraphOfPreGraphs(e.preGraphs);if(null==t)return;const n=by(t),i=new Array;for(const s of n){let o=null;for(const a of s)null==o?(o=e.preGraphs[a],i.push(o)):o.AddGraph(e.preGraphs[a])}e.preGraphs=i;for(const s of e.preGraphs)this.AddIntersectingNodes(s)}AddIntersectingNodes(e){const t=e.boundingBox;for(const n of this.nodeTree.GetNodeItemsIntersectingRectangle(t))e.AddNodeBoundary(n)}static GetIntersectionGraphOfPreGraphs(e){const t=rA.EnumeratePairsOfIntersectedPreGraphs(e);return t.length?dc(t,e.length):null}static EnumeratePairsOfIntersectedPreGraphs(e){const n=nT(Array.from(Array(e.length).keys()),s=>e[s].boundingBox),i=new Array;return es(n,n,(s,o)=>i.push(new fn(s,o))),i}CreateInitialPregraphs(){return this.multiEdges.map(e=>this.CreatePregraphFromSetOfEdgeGeometries(e))}CreatePregraphFromSetOfEdgeGeometries(e){const t=new Set,n=e[0],i=this.GetPortCurve(n.sourcePort),s=i.boundingBox;t.add(i),t.add(n.targetPort.Curve),s.addRec(n.targetPort.Curve.boundingBox);const o=this.nodeTree.GetNodeItemsIntersectingRectangle(s);for(const a of o)t.add(a);return VT.constructorStatic(e,t)}}class rr extends Rr{constructor(e,t,n=2,i=1.5,s=Math.PI/180*30,o=null,a=null){super(a),this.continueOnOverlaps=!0,this.shapesToTightLooseCouples=new Map,this.portLocationsToLoosePolylines=new Vs,this.multiEdgesSeparation=5,this.routeMultiEdgesAsBundles=!0,this.UsePolylineEndShortcutting=!0,this.UseInnerPolylingShortcutting=!0,this.AllowedShootingStraightLines=!0,this._overlapsDetected=!1,this.KeepOriginalSpline=!1,this.ArrowHeadRatio=0,this.bidirectional=!1,this._edges=t,this.BundlingSettings=o,this.geomGraph=e,this.LoosePadding=i,this.tightPadding=n,this.coneAngle=s}get ContinueOnOverlaps(){return this.continueOnOverlaps}set ContinueOnOverlaps(e){this.continueOnOverlaps=e}*edges(){if(null!=this._edges)for(const e of this._edges)yield e}get LoosePadding(){return this.loosePadding}set LoosePadding(e){this.loosePadding=e}get MultiEdgesSeparation(){return this.multiEdgesSeparation}set MultiEdgesSeparation(e){this.multiEdgesSeparation=e}static mk2(e,t){return rr.mk5(e,t.Padding,t.PolylinePadding,t.ConeAngle,t.BundlingSettings)}static mk4(e,t,n,i){return new rr(e,Array.from(e.edges()),t,n,i,null)}static mk5(e,t,n,i,s){return new rr(e,Array.from(e.edges()),t,n,i,s)}static mk6(e,t,n,i,s,o){const a=rr.mk4(e,t,n,i),l=Fa.GetShapes(s,o);return a.Initialize(l,i),a}Initialize(e,t){this.rootShapes=e.filter(n=>null==n.Parents||0==n.Parents.length),this.coneAngle=t,0==this.coneAngle&&(this.coneAngle=Math.PI/6)}run(){if(this.geomGraph.isEmpty())return;const e=fo.GetShapes(this.geomGraph,this._edges);null==this.BundlingSettings&&this.geomGraph.layoutSettings&&this.geomGraph.layoutSettings.edgeRoutingSettings&&this.geomGraph.layoutSettings.edgeRoutingSettings.BundlingSettings&&(this.BundlingSettings=this.geomGraph.layoutSettings.edgeRoutingSettings.BundlingSettings),this.Initialize(e,this.coneAngle),this.GetOrCreateRoot(),this.RouteOnRoot(),this.RemoveRoot()}RouteOnRoot(){this.CalculatePortsToShapes(),this.CalculatePortsToEnterableShapes(),this.CalculateShapeToBoundaries(this.root),(!this.OverlapsDetected||this.ContinueOnOverlaps)&&(this.BindLooseShapes(),this.SetLoosePolylinesForAnywherePorts(),this.CalculateVisibilityGraph(),this.RouteOnVisGraph())}CalculatePortsToEnterableShapes(){this.portsToEnterableShapes=new Map;for(const[e,t]of this.portsToShapes){const n=new Set;rr.EdgesAttachedToPortAvoidTheNode(e)||n.add(t),this.portsToEnterableShapes.set(e,n)}for(const e of this.rootShapes)for(const t of e.Descendants())for(const n of t.Ports)Oy(this.portsToEnterableShapes.get(n),Array.from(t.Ancestors()).filter(s=>null!=s.BoundaryCurve))}static EdgesAttachedToPortAvoidTheNode(e){return e instanceof Ys||e instanceof $o}SetLoosePolylinesForAnywherePorts(){for(const[e,t]of this.shapesToTightLooseCouples)for(const n of e.Ports)n instanceof Zi&&(n.LoosePolyline=t.LooseShape.BoundaryCurve),n instanceof $o&&(n.LoosePolyline=t.LooseShape.BoundaryCurve)}BindLooseShapes(){this.looseRoot=new ig;for(const e of this.root.Children){const t=this.shapesToTightLooseCouples.get(e).LooseShape;this.BindLooseShapesUnderShape(e),this.looseRoot.AddChild(t)}}BindLooseShapesUnderShape(e){const t=this.shapesToTightLooseCouples.get(e).LooseShape;for(const n of e.Children){const i=this.shapesToTightLooseCouples.get(n).LooseShape;t.AddChild(i),this.BindLooseShapesUnderShape(n)}}CalculateShapeToBoundaries(e){if(this.ProgressStep(),0==e.Children.length)return;for(const n of e.Children)this.CalculateShapeToBoundaries(n);const t=new CT(e,this.tightPadding,this.AdjustedLoosePadding,this.shapesToTightLooseCouples);t.Calculate(),this.OverlapsDetected||(this.OverlapsDetected=t.OverlapsDetected)}get OverlapsDetected(){return this._overlapsDetected}set OverlapsDetected(e){this._overlapsDetected=e}get AdjustedLoosePadding(){return null==this.BundlingSettings?this.LoosePadding:this.LoosePadding*fg.SuperLoosePaddingCoefficient}GroupEdgesByPassport(){const e=new Array;for(const t of this._edges){const n=this.EdgePassport(t);let i=e.find(s=>LS(s.passport,n));i||(i={passport:n,edges:[]},e.push(i)),i.edges.push(t)}return e}RouteOnVisGraph(){if(this.ancestorSets=rr.GetAncestorSetsMap(Array.from(this.root.Descendants())),null==this.BundlingSettings)for(const e of this.GroupEdgesByPassport()){const n=this.GetObstaclesFromPassport(e.passport),i=this.CreateInteractiveEdgeRouter(Array.from(n));this.RouteEdgesWithTheSamePassport(e,i,n)}else this.RouteBundles()}RouteEdgesWithTheSamePassport(e,t,n){const i={regularEdges:[],multiEdges:[]};if(this.RouteMultiEdgesAsBundles){this.SplitOnRegularAndMultiedges(e.edges,i);for(const s of i.regularEdges)this.RouteEdge(t,s);null!=i.multiEdges&&(this.ScaleDownLooseHierarchy(t,n),this.RouteMultiEdges(i.multiEdges,t,e.passport))}else for(const s of e.edges)this.RouteEdge(t,s)}get RouteMultiEdgesAsBundles(){return this.routeMultiEdgesAsBundles}set RouteMultiEdgesAsBundles(e){this.routeMultiEdgesAsBundles=e}RouteEdge(e,t){const n=this.MakeTransparentShapesOfEdgeGeometryAndGetTheShapes(t);this.ProgressStep(),this.RouteEdgeInternal(t,e),rr.SetTransparency(n,!1)}ScaleDownLooseHierarchy(e,t){const n=new Array;for(const i of t){const s=this.shapesToTightLooseCouples.get(i);n.push(Jo.LoosePolylineWithFewCorners(s.TightPolyline,s.Distance/1.1))}e.LooseHierarchy=rr.CreateLooseObstacleHierarachy(n),e.ClearActivePolygons(),e.AddActivePolygons(n.map(i=>new Us(i)))}RouteMultiEdges(e,t,n){const i=[];for(const a of n)for(const l of a.Children)i.push(l.BoundaryCurve);const s=new jx;s.InkImportance=1e-5,s.EdgeSeparation=this.MultiEdgesSeparation,new rA(e,t,i,s,a=>this.MakeTransparentShapesOfEdgeGeometryAndGetTheShapes(a)).run()}SplitOnRegularAndMultiedges(e,t){const n=new xy;for(const i of e)rr.IsEdgeToParent(i)?t.regularEdges.push(i):rr.RegisterInPortLocationsToEdges(i,n);t.multiEdges=null;for(const i of n.values())1==i.length||this.OverlapsDetected?bu(t.regularEdges,i):(null==t.multiEdges&&(t.multiEdges=new Array),t.multiEdges.push(i))}static RegisterInPortLocationsToEdges(e,t){let n;const i=new qi(e.sourcePort.Location,e.targetPort.Location);n=t.get(i),n||(n=new Array,t.set(i,n)),n.push(e)}static IsEdgeToParent(e){return e.sourcePort instanceof Zi||e.targetPort instanceof Zi}CreateInteractiveEdgeRouter(e){const t=new Set(e.map(i=>this.shapesToTightLooseCouples.get(i).LooseShape.BoundaryCurve)),n=new On(this.cancelToken);return n.ObstacleCalculator=new Jo(e.map(i=>i.BoundaryCurve),this.tightPadding,this.loosePadding,!1),n.VisibilityGraph=this.visGraph,n.TightHierarchy=this.CreateTightObstacleHierarachy(e),n.LooseHierarchy=rr.CreateLooseObstacleHierarachy(Array.from(t)),n.UseSpanner=!0,n.LookForRoundedVertices=!0,n.TightPadding=this.tightPadding,n.LoosePadding=this.LoosePadding,n.UseEdgeLengthMultiplier=this.UseEdgeLengthMultiplier,n.UsePolylineEndShortcutting=this.UsePolylineEndShortcutting,n.UseInnerPolylingShortcutting=this.UseInnerPolylingShortcutting,n.AllowedShootingStraightLines=this.AllowedShootingStraightLines,n.AddActivePolygons(Array.from(t).map(i=>new Us(i))),n}GetObstaclesFromPassport(e){if(0==e.size)return new Set(this.root.Children);const t=this.GetCommonAncestorsAbovePassport(e),n=this.GetAllAncestors(e),i=new Set;for(const a of e)for(const l of a.Children)n.has(l)||i.add(l);const s=eg(new Set(e),i),o=new mu.c;for(const a of e)t.has(a)||o.enqueue(a);for(;o.length>0;){const a=o.dequeue();for(const l of a.Parents){for(const c of l.Children)n.has(c)||i.add(c);!t.has(l)&&!s.has(l)&&(o.enqueue(l),s.add(l))}}return i}GetAllAncestors(e){if(0==e.size)return new Set;let t=new Set(e);for(const n of e)t=eg(t,this.ancestorSets.get(n));return t}GetCommonAncestorsAbovePassport(e){if(0==e.size)return new Set;const t=Array.from(e);let n=this.ancestorSets.get(t[0]);for(let i=1;i<t.length;i++)n=Cu(n,this.ancestorSets.get(t[i]));return n}RouteBundles(){this.ScaleLooseShapesDown(),this.CalculateEdgeEnterablePolylines();const e=this.GetLooseHierarchy(),t=fg.CreateConstrainedDelaunayTriangulation(e),n=new Nu(s=>this.MakeTransparentShapesOfEdgeGeometryAndGetTheShapes(s),t,this.FindCdtGates(t));new fg(this._edges,n,this.visGraph,this.BundlingSettings,this.LoosePadding,this.GetTightHierarchy(),e,this.enterableLoose,this.enterableTight,s=>this.LoosePolyOfOriginalShape(this.portsToShapes.get(s))).run()}CreateTheMapToParentLooseShapes(e,t){for(const n of e.Children){const s=this.shapesToTightLooseCouples.get(n).LooseShape.BoundaryCurve;t.set(s,e),this.CreateTheMapToParentLooseShapes(n,t)}}FindCdtGates(e){const t=new Map;this.CreateTheMapToParentLooseShapes(this.root,t);const n=new Set;for(const i of e.PointsToSites.values())for(const s of i.Edges){if(null==s.CwTriangle&&null==s.CcwTriangle)continue;const o=i.Owner,a=s.lowerSite.Owner;if(o==a)continue;const l=t.get(o);l&&l==t.get(a)&&n.add(s)}return n}CalculateEdgeEnterablePolylines(){this.enterableLoose=new Map,this.enterableTight=new Map;for(const e of this.edges()){const t=new Set,n=new Set;this.GetEdgeEnterablePolylines(e,t,n),this.enterableLoose.set(e,t),this.enterableTight.set(e,n)}}GetEdgeEnterablePolylines(e,t,n){const i=this.portsToShapes.get(e.sourcePort),s=this.portsToShapes.get(e.targetPort);i!=this.root&&this.GetEnterablesForShape(i,t,n),s!=this.root&&this.GetEnterablesForShape(s,t,n)}GetEnterablesForShape(e,t,n){for(const i of this.ancestorSets.get(e)){const s=this.LoosePolyOfOriginalShape(i);s&&t.add(s);const o=this.TightPolyOfOriginalShape(i);o&&n.add(o)}}GetTightHierarchy(){return Tr(Array.from(this.shapesToTightLooseCouples.values()).map(e=>gi(e.TightPolyline,e.TightPolyline.boundingBox)))}GetLooseHierarchy(){const e=new Set;for(const t of this.shapesToTightLooseCouples.values())e.add(t.LooseShape.BoundaryCurve);return Tr(Array.from(e).map(t=>gi(t,t.boundingBox)))}ScaleLooseShapesDown(){for(const[,e]of this.shapesToTightLooseCouples)e.LooseShape.BoundaryCurve=Jo.LoosePolylineWithFewCorners(e.TightPolyline,e.Distance/fg.SuperLoosePaddingCoefficient)}EdgePassport(e){const t=new Set,n=this.portsToShapes.get(e.sourcePort),i=this.portsToShapes.get(e.targetPort);return this.IsAncestor(n,i)?(Oy(t,i.Parents),t.add(n),t):this.IsAncestor(i,n)?(Oy(t,n.Parents),t.add(i),t):(n!=this.looseRoot&&Oy(t,n.Parents),i!=this.looseRoot&&Oy(t,i.Parents),t)}*AllPorts(){for(const e of this.edges())yield e.sourcePort,yield e.targetPort}CalculatePortsToShapes(){this.portsToShapes=new Map;for(const e of this.root.Descendants())for(const t of e.Ports)this.portsToShapes.set(t,e);for(const e of this.AllPorts())this.portsToShapes.has(e)||(this.root.Ports.add(e),this.portsToShapes.set(e,this.root))}RouteEdgeInternal(e,t){const n=new Array;e.sourcePort instanceof Zi||bu(n,this.AddVisibilityEdgesFromPort(e.sourcePort)),e.targetPort instanceof Zi||bu(n,this.AddVisibilityEdgesFromPort(e.targetPort));const i={smoothedPolyline:null};if(e.curve=k.closeDistEps(e.sourcePort.Location,e.targetPort.Location)?vu.RouteSelfEdge(e.sourcePort.Curve,Math.max(2*this.LoosePadding,e.GetMaxArrowheadLength()),i):t.RouteSplineFromPortToPortWhenTheWholeGraphIsReady(e.sourcePort,e.targetPort,!0,i),e.smoothedPolyline=i.smoothedPolyline,null==e.curve)throw new Error;for(const s of n)Or.RemoveEdge(s);wu.trimSplineAndCalculateArrowheadsII(e,e.sourcePort.Curve,e.targetPort.Curve,e.curve,!1)}*AddVisibilityEdgesFromPort(e){let t,n;if(e instanceof Ys||!(t=this.portsToShapes.get(e))||!(n=this.shapesToTightLooseCouples.get(t)))return;const i=n.LooseShape;for(const s of i.BoundaryCurve)null==this.visGraph.FindEdgePP(e.Location,s)&&(yield this.visGraph.AddEdgePP(e.Location,s))}MakeTransparentShapesOfEdgeGeometryAndGetTheShapes(e){const t=this.portsToShapes.get(e.sourcePort),n=this.portsToShapes.get(e.targetPort),i=new Array;for(const s of this.GetTransparentShapes(e.sourcePort,e.targetPort,t,n))null!=s&&i.push(this.LooseShapeOfOriginalShape(s));for(const s of this.portsToEnterableShapes.get(e.sourcePort))i.push(this.LooseShapeOfOriginalShape(s));for(const s of this.portsToEnterableShapes.get(e.targetPort))i.push(this.LooseShapeOfOriginalShape(s));return rr.SetTransparency(i,!0),i}LooseShapeOfOriginalShape(e){return e==this.root?this.looseRoot:this.shapesToTightLooseCouples.get(e).LooseShape}LoosePolyOfOriginalShape(e){return this.LooseShapeOfOriginalShape(e).BoundaryCurve}TightPolyOfOriginalShape(e){return e==this.root?null:this.shapesToTightLooseCouples.get(e).TightPolyline}*GetTransparentShapes(e,t,n,i){for(const s of this.ancestorSets.get(n))yield s;for(const s of this.ancestorSets.get(i))yield s;rr.EdgesAttachedToPortAvoidTheNode(e)||(yield n),rr.EdgesAttachedToPortAvoidTheNode(t)||(yield i)}static SetTransparency(e,t){for(const n of e)n.IsTransparent=t}IsAncestor(e,t){let n;return null!=t&&null!=(n=this.ancestorSets.get(t))&&n.has(e)}static CreateLooseObstacleHierarachy(e){return Tr(e.map(t=>gi(t,t.boundingBox)))}CreateTightObstacleHierarachy(e){return Tr(e.map(n=>this.shapesToTightLooseCouples.get(n).TightPolyline).map(n=>gi(n,n.boundingBox)))}CalculateVisibilityGraph(){const e=null!=this.LineSweeperPorts?Fr.mk(this.LineSweeperPorts):new Fr;this.ProcessHookAnyWherePorts(e),this.portRTree=sT(Array.from(e.values()).map(t=>[lt.rectangleOnPoint(t),t])),this.visGraph=new Or,this.FillVisibilityGraphUnderShape(this.root)}static ShowVisGraph(e,t,n,i=null,s=null){const o=Array.from(t.Edges).map(a=>qt.mkDebugCurveTWCI(100,1,null!=a.IsPassable&&a.IsPassable()?"green":"black",Me.mkPP(a.SourcePoint,a.TargetPoint)));if(null!=n)for(const a of n){o.push(qt.mkDebugCurveTWCI(100,.3,"brown",a));for(const l of a)o.push(qt.mkDebugCurveTWCI(100,1,"green",gs.mkCircle(1,l)))}if(null!=i)for(const a of i)o.push(qt.mkDebugCurveTWCI(100,10,"navy",a));if(null!=s)for(const a of s)o.push(qt.mkDebugCurveTWCI(100,10,"red",a))}ProcessHookAnyWherePorts(e){for(const t of this.edges())t.sourcePort instanceof Zi||t.sourcePort instanceof $o||e.add(t.sourcePort.Location),t.targetPort instanceof Zi||t.targetPort instanceof $o||e.add(t.targetPort.Location)}FillVisibilityGraphUnderShape(e){const t=e.Children;for(const d of t)this.FillVisibilityGraphUnderShape(d);const n=this.shapesToTightLooseCouples.get(e),i=n?n.LooseShape.BoundaryCurve:null,s=n?n.LooseShape:this.looseRoot,o=new Set(s.Children.map(d=>d.BoundaryCurve)),a=this.RemoveInsidePortsAndSplitBoundaryIfNeeded(i);let l=new Or,c=Ny.mk([],l,this.coneAngle,a,i);c.run(),l=new Or,c=Ny.mk(Array.from(o),l,this.coneAngle,a,i),c.run(),this.ProgressStep();for(const d of l.Edges)this.TryToCreateNewEdgeAndSetIsPassable(d,s);this.AddBoundaryEdgesToVisGraph(i)}get Bidirectional(){return this.bidirectional}set Bidirectional(e){this.bidirectional=e}TryToCreateNewEdgeAndSetIsPassable(e,t){let n=this.visGraph.FindEdgePP(e.SourcePoint,e.TargetPoint);null==n&&(n=this.visGraph.AddEdgePP(e.SourcePoint,e.TargetPoint),null!=t&&(n.IsPassable=()=>t.IsTransparent))}AddBoundaryEdgesToVisGraph(e){if(null==e)return;let t;for(let n=e.startPoint;t=n.nextOnPolyline,this.visGraph.AddEdgePP(n.point,t.point),t!=e.startPoint;n=t);}RemoveInsidePortsAndSplitBoundaryIfNeeded(e){const t=new Fr;if(null==e){for(const s of this.portRTree.GetAllLeaves())t.add(s);return this.portRTree.Clear(),t}const i=this.portRTree.GetAllIntersecting(e.boundingBox);for(const s of i)switch(fe.PointRelativeToCurveLocation(s,e)){case Ot.Inside:t.add(s),this.portLocationsToLoosePolylines.set(s,e),this.portRTree.Remove(lt.rectangleOnPoint(s),s);break;case Ot.Boundary:this.portRTree.Remove(lt.rectangleOnPoint(s),s),this.portLocationsToLoosePolylines.set(s,e);const o=rr.FindPointOnPolylineToInsertAfter(e,s);if(null==o)throw new Error;yi.InsertPointIntoPolylineAfter(e,o,s)}return t}static FindPointOnPolylineToInsertAfter(e,t){for(let n=e.startPoint;;){const i=n.nextOnPolyline;if(k.closeDistEps(t,n.point)||k.closeDistEps(t,i.point))return null;if(an(k.distToLineSegment(t,n.point,i.point).dist,0))return n;if(n=i,n==e.startPoint)throw new Error}}GetOrCreateRoot(){if(1==this.rootShapes.length){const e=this.rootShapes[0];if(null==e.BoundaryCurve)return void(this.root=e)}this.rootWasCreated=!0,this.root=new ig(null);for(const e of this.rootShapes)this.root.AddChild(e)}RemoveRoot(){if(this.rootWasCreated)for(const e of this.rootShapes)e.RemoveParent(this.root)}static GetAncestorSetsMap(e){const t=new Map;for(const n of e.filter(i=>!t.has(i)))t.set(n,rr.GetAncestorSet(n,t));return t}static GetAncestorSet(e,t){const n=new Set(e.Parents);for(const i of e.Parents){let s=t.get(i);s||t.set(i,s=rr.GetAncestorSet(i,t));for(const o of s)n.add(o)}return n}static CreatePortsIfNeeded(e){for(const t of e){if(null==t.sourcePort){const n=t;new Ru(()=>n.source.boundaryCurve,()=>n.source.center,new k(0,0))}if(null==t.targetPort){const n=t;new Ru(()=>n.target.boundaryCurve,()=>n.target.center,new k(0,0))}}}static ComputeLooseSplinePadding(e,t){return(e-2*t)/8}}class Ws extends Rr{constructor(e,t){super(null),this.edges=e,this.padding=t}run(){rr.CreatePortsIfNeeded(this.edges);for(const e of this.edges)Ws.RouteEdge(e,this.padding)}static RouteEdge(e,t){const n=e;null==n.sourcePort&&(n.sourcePort=Ru.mk(()=>e.source.boundaryCurve,()=>e.source.center)),null==n.targetPort&&(n.targetPort=Ru.mk(()=>e.target.boundaryCurve,()=>e.target.center)),Ws.ContainmentLoop(n,t)||(n.curve=Ws.GetEdgeLine(e)),wu.trimSplineAndCalculateArrowheadsII(n,n.sourcePort.Curve,n.targetPort.Curve,e.curve,!1)}static ContainmentLoop(e,t){const n=e.sourcePort.Curve,i=e.targetPort.Curve;if(null==n||null==i)return!1;const s=n.boundingBox,o=i.boundingBox,a=s.containsRect(o),l=!a&&o.containsRect(s);return!(!a&&!l||(e.curve=Ws.CreateLoop(s,o,l,t),0))}static CreateLoop(e,t,n,i){return n?Ws.CreateLoop_(e,t,i,!1):Ws.CreateLoop_(t,e,i,!0)}static CreateLoop_(e,t,n,i){const s=e.center,o=Ws.FindClosestPointOnBoxBoundary(e.center,t);let a=o.sub(s);const c=(Math.abs(a.x)<le.distanceEpsilon?Math.min(s.y-t.bottom,t.top-s.y):Math.min(s.x-t.left,t.right-s.x))/2,d=Math.min(n,c);a.length<=le.distanceEpsilon&&(a=new k(1,0));const b=a.normalize(),N=b.rotate(Math.PI/2),F=o.add(b.mul(n)),G=F.add(N.mul(d)),W=o.add(N.mul(d)),ie=s.add(N.mul(d));return Jr.mkFromPoints(i?[ie,W,G,F,o,s]:[s,o,F,G,W,ie]).createCurve()}static FindClosestPointOnBoxBoundary(e,t){const n=e.x-t.left<t.right-e.x?t.left:t.right,i=e.y-t.bottom<t.top-e.y?t.bottom:t.top;return Math.abs(n-e.x)<Math.abs(i-e.y)?new k(n,e.y):new k(e.x,i)}static GetEdgeLine(e){let t,n,i,s;null==e.sourcePort?(t=e.source.center,n=e.source.boundaryCurve):(t=e.sourcePort.Location,n=e.sourcePort.Curve),null==e.targetPort?(i=e.target.center,s=e.target.boundaryCurve):(i=e.targetPort.Location,s=e.targetPort.Curve);let o=Me.mkPP(t,i),a=fe.getAllIntersections(n,o,!1);if(a.length>0){let l=o.trim(a[0].par1,1);l instanceof Me&&(o=l,a=fe.getAllIntersections(s,o,!1),a.length>0&&(l=o.trim(0,a[0].par1),l instanceof Me&&(o=l)))}return o}static CreateSimpleEdgeCurveWithUnderlyingPolyline(e){const t=e.source.center,n=e.target.center;e.source==e.target?(e.underlyingPolyline=Ws.CreateUnderlyingPolylineForSelfEdge(t,2/(3*e.source.boundaryCurve.boundingBox.width),e.source.boundingBox.height/4),e.curve=e.underlyingPolyline.createCurve()):(e.underlyingPolyline=Jr.mkFromPoints([t,n]),e.curve=e.underlyingPolyline.createCurve()),wu.trimSplineAndCalculateArrowheadsII(e,e.source.boundaryCurve,e.target.boundaryCurve,e.curve,!1)}static CreateUnderlyingPolylineForSelfEdge(e,t,n){const i=e.add(new k(0,n)),s=e.add(new k(t,n)),o=e.add(new k(t,-1*n)),a=e.add(new k(0,-1*n));let l=lr.mkSiteP(e);const c=new Jr(l);return l=lr.mkSiteSP(l,i),l=lr.mkSiteSP(l,s),l=lr.mkSiteSP(l,o),l=lr.mkSiteSP(l,a),lr.mkSiteSP(l,e),c}static SetStraightLineEdgesWithUnderlyingPolylines(e){rr.CreatePortsIfNeeded(Array.from(e.edges()));for(const t of e.edges())Ws.CreateSimpleEdgeCurveWithUnderlyingPolyline(t)}}class _u extends Rr{constructor(e,t,n,i,s,o){super(null),this.settings=e,this.OriginalGraph=t,this.Database=n,this.ProperLayeredGraph=s,this.LayerArrays=i,this.IntGraph=o}run(){this.createSplines()}createSplines(){this.createRegularSplines(),this.createSelfSplines(),null!=this.IntGraph&&this.RouteFlatEdges(),null==this.OriginalGraph.graph.parent&&this.RouteUnroutedEdges()}RouteUnroutedEdges(){for(const e of this.OriginalGraph.deepNodes())for(const t of e.outEdges())t.curve||Ws.RouteEdge(t,Math.max(t.source.padding,t.target.padding))}RouteFlatEdges(){}createRegularSplines(){for(const e of this.Database.RegularMultiedges()){const t=e.length,n=1==t&&!this.FanAtSourceOrTarget(e[0]);for(let i=Math.floor(t/2);i<t;i++)this.createSplineForNonSelfEdge(e[i],n);for(let i=Math.floor(t/2)-1;i>=0;i--)this.createSplineForNonSelfEdge(e[i],n)}}FanAtSourceOrTarget(e){return this.ProperLayeredGraph.OutDegreeIsMoreThanOne(e.source)||this.ProperLayeredGraph.InDegreeIsMoreThanOne(e.target)}createSelfSplines(){for(const[e,t]of this.Database.Multiedges.keyValues()){const n=e;if(n.x==n.y){const i=this.Database.Anchors[n.x];let s=i.leftAnchor;for(const o of t){const a=this.settings.NodeSeparation+(this.settings.MinNodeWidth+s),l=i.bottomAnchor/2,c=i.origin,d=c.add(new k(0,l)),b=c.add(new k(a,l)),N=c.add(new k(a,-1*l)),F=c.add(new k(0,-1*l));let G=lr.mkSiteP(c);const W=new Jr(G);G=lr.mkSiteSP(G,d),G=lr.mkSiteSP(G,b),G=lr.mkSiteSP(G,N),G=lr.mkSiteSP(G,F),lr.mkSiteSP(G,c);const ie=W.createCurve();if(o.curve=ie,o.edge.underlyingPolyline=W,s=a,null!=o.edge.label){s+=o.edge.label.width;const he=o.edge.label.center=new k(ie.value((ie.parStart+ie.parEnd)/2).x+o.labelWidth/2,i.y),de=new k(o.edge.label.width/2,o.edge.label.height/2),Te=lt.mkPP(he.add(de),he.sub(de));o.edge.label.boundingBox=Te}wu.trimSplineAndCalculateArrowheadsII(o.edge,o.edge.source.boundaryCurve,o.edge.target.boundaryCurve,ie,!1)}}}}createSplineForNonSelfEdge(e,t){null!=e.LayerEdges&&(this.drawSplineBySmothingThePolyline(e,t),e.IsVirtualEdge||(e.updateEdgeLabelPosition(this.Database.Anchors),wu.trimSplineAndCalculateArrowheadsII(e.edge,e.edge.source.boundaryCurve,e.edge.target.boundaryCurve,e.curve,!0)))}drawSplineBySmothingThePolyline(e,t){const n=new Qi(e,this.Database.Anchors,this.OriginalGraph,this.settings,this.LayerArrays,this.ProperLayeredGraph,this.Database),i=n.getSpline(t);e.reversed?(e.curve=i.reverse(),e.underlyingPolyline=n.Reverse().GetPolyline):(e.curve=i,e.underlyingPolyline=n.GetPolyline)}static UpdateLabel(e,t){let n=null;t.labelIsToTheRightOfTheSpline?(e.label.center=new k(t.x+t.rightAnchor/2,t.y),n=Me.mkPP(e.labelBBox.leftTop,e.labelBBox.leftBottom)):t.labelIsToTheLeftOfTheSpline&&(e.label.center=new k(t.x-t.leftAnchor/2,t.y),n=Me.mkPP(e.labelBBox.rightTop,e.labelBBox.rightBottom));const i=_u.GetSegmentInFrontOfLabel(e.curve,e.label.center.y);if(null!=i&&0==fe.getAllIntersections(e.curve,fe.polyFromBox(e.labelBBox),!1).length){const s={curveClosestPoint:void 0,labelSideClosest:void 0};if(_u.FindClosestPoints(s,i,n))_u.ShiftLabel(e,s);else{const o=i.closestParameter(n.start),a=i.closestParameter(n.end);i.value(o).sub(n.start).length<i.value(a).sub(n.end).length?(s.curveClosestPoint=i.value(o),s.labelSideClosest=n.start):(s.curveClosestPoint=i.value(a),s.labelSideClosest=n.end),_u.ShiftLabel(e,s)}}}static ShiftLabel(e,t){const n=e.lineWidth/2,i=t.curveClosestPoint.sub(t.labelSideClosest),s=i.length;s>n&&(e.label.center=e.label.center.add(i.div(s*(s-n))))}static FindClosestPoints(e,t,n){const i=fe.minDistWithinIntervals(t,n,t.parStart,t.parEnd,n.parStart,n.parEnd,(t.parStart+t.parEnd)/2,(n.parStart+n.parEnd)/2);return!!i&&(e.curveClosestPoint=i.aX,e.labelSideClosest=i.bX,!0)}static GetSegmentInFrontOfLabel(e,t){if(e instanceof fe){const n=e;for(const i of n.segs)if((i.start.y-t)*(i.end.y-t)<=0)return i}return null}static GetNodeKind(e,t){return 0==e?mi.Top:e<t.count?mi.Internal:mi.Bottom}}function c5(r,e){new YT(r,r.layoutSettings,e).run()}function u5(r,e=null,t=!0){LL(r,r.layoutSettings?r.layoutSettings:new xS),GT(r,e,c5,FL,Yx,t)}class YT extends Rr{constructor(e,t,n){if(super(n),this.LayersAreDoubled=!1,null==e)return;this.originalGraph=e,this.sugiyamaSettings=t;const i=Array.from(e.shallowNodes());this.nodeIdToIndex=new Map;let s=0;for(const a of i)this.nodeIdToIndex.set(a.id,s++);const o=[];for(const a of this.originalGraph.edges()){const l=this.nodeIdToIndex.get(a.source.id);if(null==l)continue;const c=this.nodeIdToIndex.get(a.target.id);if(null==c)continue;const d=new La(l,c,a);o.push(d)}this.IntGraph=new Cy(o,e.shallowNodeCount),this.IntGraph.nodes=i,this.database=new xW(i.length);for(const a of this.IntGraph.edges)this.database.registerOriginalEdgeInMultiedges(a);this.cycleRemoval()}get verticalConstraints(){return this.sugiyamaSettings.verticalConstraints}get HorizontalConstraints(){return this.sugiyamaSettings.horizontalConstraints}run(){0!=this.originalGraph.shallowNodeCount?(function R5(r,e){if(e.isIdentity())return;const t=e.inverse();for(const n of r.shallowNodes())n.transform(t);for(const n of r.edges())if(null!=n.label){const i=lt.mkPP(t.multiplyPoint(new k(0,0)),t.multiplyPoint(new k(n.label.width,n.label.height)));n.label.width=i.width,n.label.height=i.height}}(this.originalGraph,this.sugiyamaSettings.transform),this.engineLayerArrays=this.calculateLayers(),this.sugiyamaSettings.edgeRoutingSettings.EdgeRoutingMode==Mr.SugiyamaSplines&&this.runPostLayering(),function T5(r,e){if(!e.isIdentity()){for(const t of r.shallowNodes())t.transform(e);for(const t of r.edges())if(null!=t.label){const n=lt.mkPP(e.multiplyPoint(new k(0,0)),e.multiplyPoint(new k(t.label.width,t.label.height)));t.label.width=n.width,t.label.height=n.height}!function O5(r,e){for(const t of r.edges())null!=t.label&&(t.label.center=e.multiplyPoint(t.label.center)),I5(e,t)}(r,e)}}(this.originalGraph,this.sugiyamaSettings.transform),this.originalGraph.updateBoundingBox(),this.SetMargins()):this.originalGraph.boundingBox=lt.mkEmpty()}SetMargins(){this.originalGraph.boundingBox.right+=this.sugiyamaSettings.margins.right,this.originalGraph.boundingBox.top+=this.sugiyamaSettings.margins.bottom,this.originalGraph.boundingBox.left-=this.sugiyamaSettings.margins.left,this.originalGraph.boundingBox.bottom-=this.sugiyamaSettings.margins.bottom}runPostLayering(){const t=null!=this.constrainedOrdering?Mr.Spline:this.sugiyamaSettings.edgeRoutingSettings.EdgeRoutingMode;switch(t){case Mr.SugiyamaSplines:this.calculateEdgeSplines();break;case Mr.StraightLine:case Mr.Spline:case Mr.SplineBundling:throw new Error("not implemented");case Mr.Rectilinear:case Mr.RectilinearToCenter:throw new Error("Not implemented yet");default:throw new Error("Unexpected mode "+t)}}SetLabels(){throw new Error("not implementedt")}cycleRemoval(){const e=this.sugiyamaSettings.verticalConstraints,t=e.isEmpty?Su.getFeedbackSet(this.IntGraph):e.getFeedbackSetExternal(this.IntGraph,this.nodeIdToIndex);this.database.addFeedbackSet(t)}calculateLayers(){this.CreateGluedDagSkeletonForLayering();const e=this.CalculateLayerArrays();return this.UpdateNodePositionData(),e}UpdateNodePositionData(){this.TryToSatisfyMinWidhtAndMinHeight();for(let e=0;e<this.IntGraph.nodeCount&&e<this.database.Anchors.length;e++)this.IntGraph.nodes[e].center=this.database.Anchors[e].origin;if(this.sugiyamaSettings.GridSizeByX>0)for(let e=0;e<this.originalGraph.shallowNodeCount;e++)this.SnapLeftSidesOfTheNodeToGrid(e,this.sugiyamaSettings.GridSizeByX)}SnapLeftSidesOfTheNodeToGrid(e,t){const n=this.IntGraph.nodes[e],i=this.database.Anchors[e];i.leftAnchor-=t/2,i.rightAnchor-=t/2;const s=n.boundingBox.left,a=s-Math.floor(s/t)*t;Math.abs(a)<.001||(n.center=Math.abs(a)<=t/2?n.center.add(new k(-a,0)):n.center.add(new k(t-a,0)),i.x=n.center.x)}TryToSatisfyMinWidhtAndMinHeight(){this.TryToSatisfyMinWidth(),this.TryToSatisfyMinHeight()}TryToSatisfyMinWidth(){0!=this.sugiyamaSettings.MinimalWidth&&this.GetCurrentWidth()<this.sugiyamaSettings.MinimalWidth&&this.StretchWidth()}StretchWidth(){const e=new zo;for(const n of this.originalGraph.shallowNodes())e.AddValue(n.boundingBox.width/2),e.AddValue(this.sugiyamaSettings.MinimalWidth-n.boundingBox.width/2);const t=new zo;for(const n of this.NodeAnchors())t.AddValue(n.x);if(t.length>le.distanceEpsilon){const n=e.length/t.length;if(n>1)for(const i of this.anchors)i.x*=n}}TryToSatisfyMinHeight(){0!=this.sugiyamaSettings.MinimalHeight&&this.GetCurrentHeight()<this.sugiyamaSettings.MinimalHeight&&this.StretchHeight()}GetCurrentHeight(){const e=new zo;for(const t of this.NodeAnchors())e.AddValue(t.top),e.AddValue(t.bottom);return e.length}StretchHeight(){const e=new zo;for(const n of this.originalGraph.shallowNodes())e.AddValue(n.boundingBox.height/2),e.AddValue(this.sugiyamaSettings.MinimalHeight-n.boundingBox.height/2);const t=new zo;for(const n of this.NodeAnchors())t.AddValue(n.y);if(t.length>le.distanceEpsilon){const n=e.length/t.length;if(n>1)for(const i of this.anchors)i.y*=n}}*NodeAnchors(){const e=Math.min(this.IntGraph.nodeCount,this.anchors.length);for(let t=0;t<e;t++)yield this.anchors[t]}GetCurrentWidth(){const e=new zo;for(const t of this.NodeAnchors())e.AddValue(t.left),e.AddValue(t.right);return e.length}ExtendLayeringToUngluedSameLayerVertices(e){const t=this.verticalConstraints;for(let n=0;n<e.length;n++)e[n]=e[t.nodeToRepr(n)];return e}calculateEdgeSplines(){new _u(this.sugiyamaSettings,this.originalGraph,this.database,this.engineLayerArrays,this.properLayeredGraph,this.IntGraph).run()}YLayeringAndOrdering(e){let t=e.GetLayers();lT.Balance(this.gluedDagSkeletonForLayering,t,this.GetNodeCountsOfGluedDag(),null),t=this.ExtendLayeringToUngluedSameLayerVertices(t);let n=new fc(t);if(null==this.HorizontalConstraints||this.HorizontalConstraints.IsEmpty)return n=this.YLayeringAndOrderingWithoutHorizontalConstraints(n),n;throw new Error("not implemented")}CreateProperLayeredGraph(e){const t=e.length;let n=0;for(const s of this.database.SkeletonEdges()){const o=p5(e,s);o>0&&(s.LayerEdges=new Array(o));let a=0;if(o>1){let l=t+n++,c=new Au(s.source,l,s.CrossingWeight,s.weight);s.LayerEdges[a++]=c;for(let d=0;d<o-2;d++)l++,n++,c=new Au(l-1,l,s.CrossingWeight,s.weight),s.LayerEdges[a++]=c;c=new Au(l,s.target,s.CrossingWeight,s.weight),s.LayerEdges[a]=c}else if(1==o){const l=new Au(s.source,s.target,s.CrossingWeight,s.weight);s.LayerEdges[a]=l}}const i=new Array(this.originalGraph.shallowNodeCount+n).fill(0);for(const s of this.database.SkeletonEdges())if(null!=s.LayerEdges){let o=e[s.source];i[s.source]=o--;for(const a of s.LayerEdges)i[a.Target]=o--}else i[s.source]=e[s.source],i[s.target]=e[s.target];return this.properLayeredGraph=new Qh(new Cy(Array.from(this.database.SkeletonEdges()),e.length)),this.properLayeredGraph.BaseGraph.nodes=this.IntGraph.nodes,new fc(i)}YLayeringAndOrderingWithoutHorizontalConstraints(e){const t=this.CreateProperLayeredGraph(e.y);return ng.OrderLayers(this.properLayeredGraph,t,this.originalGraph.shallowNodeCount,this.sugiyamaSettings,this.cancelToken),BS.UpdateLayerArrays1(this.properLayeredGraph,t),t}CalculateYLayers(){const e=this.YLayeringAndOrdering(new KW(this.gluedDagSkeletonForLayering,this.cancelToken));return null!=this.constrainedOrdering?e:this.InsertLayersIfNeeded(e)}InsertLayersIfNeeded(e){this.InsertVirtualEdgesIfNeeded(e);const t=this.AnalyzeNeedToInsertLayersAndHasMultiedges(e);if(t.needToInsertLayers){const n=Ry.InsertLayers(this.properLayeredGraph,e,this.database,this.IntGraph);this.properLayeredGraph=n.layeredGraph,e=n.la,this.LayersAreDoubled=!0}else if(t.multipleEdges){const n=Xh.InsertPaths(this.properLayeredGraph,e,this.database,this.IntGraph);this.properLayeredGraph=n.layeredGraph,e=n.la}return this.RecreateIntGraphFromDataBase(),e}RecreateIntGraphFromDataBase(){let e=new Array;for(const t of this.database.Multiedges.values())e=e.concat(t);this.IntGraph.SetEdges(e,this.IntGraph.nodeCount)}InsertVirtualEdgesIfNeeded(e){if(null==this.constrainedOrdering)for(const[t,n]of this.database.Multiedges.keyValues())if(n.length%2==0&&e.y[t.x]-1==e.y[t.y]){const i=new vu(null),s=new La(t.x,t.y,i);s.IsVirtualEdge=!0,n.splice(n.length/2,0,s),this.IntGraph.addEdge(s)}}AnalyzeNeedToInsertLayersAndHasMultiedges(e){let t=!1,n=!1;for(const i of this.IntGraph.edges)if(i.hasLabel&&e.y[i.source]!=e.y[i.target]){t=!0;break}if(0==t&&null==this.constrainedOrdering)for(const[i,s]of this.database.Multiedges.keyValues())if(s.length>1&&(n=!0,e.y[i.x]-e.y[i.y]==1)){t=!0;break}return{needToInsertLayers:t,multipleEdges:n}}UseBrandesXCalculations(e){return e.x.length>=this.sugiyamaSettings.BrandesThreshold}CalculateAnchorsAndYPositions(e){this.anchors=function d5(r,e,t,n,i){const s=r.Anchors=new Array(e.NodeCount);for(let o=0;o<s.length;o++)s[o]=new lo(i.LabelCornersPreserveCoefficient);for(let o=0;o<t.shallowNodeCount;o++)YT.CalcAnchorsForOriginalNode(o,n,s,r,i);for(const o of r.AllIntEdges())if(null!=o.LayerEdges){for(const a of o.LayerEdges){const l=a.Target;if(l!=o.target){const c=s[l];r.MultipleMiddles.has(l)?(c.leftAnchor=c.rightAnchor=4,c.topAnchor=c.bottomAnchor=YL(i)/2):(c.leftAnchor=c.rightAnchor=.5,c.topAnchor=c.bottomAnchor=YL(i)/2)}}if(o.hasLabel){const l=s[o.LayerEdges[o.LayerEdges.length/2].Source],d=o.labelHeight;l.rightAnchor=o.labelWidth,l.leftAnchor=8,l.topAnchor<d/2&&(l.topAnchor=l.bottomAnchor=d/2),l.labelIsToTheRightOfTheSpline=!0}}return s}(this.database,this.properLayeredGraph,this.originalGraph,this.IntGraph,this.sugiyamaSettings),function f5(r,e,t,n,i,s,o){const a=n.Anchors;let l=t.Margins+e,c=0;for(const d of r.Layers){let b=0,N=0;for(const he of d){const de=a[he];de.bottomAnchor>b&&(b=de.bottomAnchor),de.topAnchor>N&&(N=de.topAnchor)}m5(d,b,N,t.shallowNodeCount,n.Anchors);const G=l+b+UL(n,r,c,i,s,l);let W=G+N;if(y5(s)){W+=HL(W,s.GridSizeByY);for(const he of d)a[he].top=W}else if(E5(s)){let he=G-b;he+=HL(he,he);for(const de of d)a[de].bottom=he,W=Math.max(a[de].top,W)}else for(const he of d)a[he].y=G;l=W+s.ActualLayerSeparation(o),c++}UL(n,r,c,i,s,l)}(e,500,this.originalGraph,this.database,this.IntGraph,this.sugiyamaSettings,this.LayersAreDoubled)}OptimizeEdgeLabelsLocations(){for(let e=0;e<this.anchors.length;e++){const t=this.anchors[e];if(t.labelIsToTheRightOfTheSpline){const n=this.GetSuccessorAndPredecessor(e);if(!w5(t,n.predecessor,n.successor)){const i=n.predecessor.origin.sub(t.origin).length+n.successor.origin.sub(t.origin).length,o=new k(t.right-t.leftAnchor,t.y);n.predecessor.origin.sub(o).length+n.successor.origin.sub(o).length<i&&WL(t)}}}}GetSuccessorAndPredecessor(e){let t,n;for(const i of this.properLayeredGraph.InEdges(e))t=i.Source;for(const i of this.properLayeredGraph.OutEdges(e))n=i.Target;return{predecessor:this.anchors[t],successor:this.anchors[n]}}CalculateLayerArrays(){const e=this.CalculateYLayers();return null==this.constrainedOrdering?(this.CalculateAnchorsAndYPositions(e),this.UseBrandesXCalculations(e)?this.CalculateXPositionsByBrandes(e):this.CalculateXLayersByGansnerNorth(e)):this.anchors=this.database.Anchors,this.OptimizeEdgeLabelsLocations(),this.engineLayerArrays=e,this.StraightensShortEdges(),this.CalculateOriginalGraphBox(),e}StretchToDesiredAspectRatio(e,t){e>t?this.StretchInYDirection(e/t):e<t&&this.StretchInXDirection(t/e)}StretchInYDirection(e){const t=(this.originalGraph.boundingBox.top+this.originalGraph.boundingBox.bottom)/2;for(const i of this.database.Anchors)i.bottomAnchor=i.bottomAnchor*e,i.topAnchor=i.topAnchor*e,i.y=t+e*(i.y-t);const n=this.originalGraph.height*e;this.originalGraph.boundingBox=new lt({left:this.originalGraph.boundingBox.left,top:t+n/2,right:this.originalGraph.boundingBox.right,bottom:t-n/2})}StretchInXDirection(e){const t=(this.originalGraph.boundingBox.left+this.originalGraph.boundingBox.right)/2;for(const i of this.database.Anchors)i.leftAnchor=i.leftAnchor*e,i.rightAnchor=i.rightAnchor*e,i.x=t+e*(i.x-t);const n=this.originalGraph.width*e;this.originalGraph.boundingBox=new lt({left:t-n/2,top:this.originalGraph.boundingBox.top,right:t+n/2,bottom:this.originalGraph.boundingBox.bottom})}CalculateOriginalGraphBox(){if(0==this.anchors.length)return 0;const e=new lt({left:this.anchors[0].left,top:this.anchors[0].top,right:this.anchors[0].right,bottom:this.anchors[0].bottom});for(let i=1;i<this.anchors.length;i++){const s=this.anchors[i];e.add(s.leftTop),e.add(s.rightBottom)}const t=e.leftTop.sub(e.rightBottom).length/2,n=new k(-1*t,t);return e.add(e.leftTop.add(n)),e.add(e.rightBottom.sub(n)),this.originalGraph.boundingBox=e,0!=e.height?e.width/e.height:0}StraightensShortEdges(){for(;this.StraightenEdgePaths(););}StraightenEdgePaths(){let e=!1;for(const t of this.database.AllIntEdges())2==t.LayerSpan&&(e=this.ShiftVertexWithNeighbors(t.LayerEdges[0].Source,t.LayerEdges[0].Target,t.LayerEdges[1].Target)||e);return e}ShiftVertexWithNeighbors(e,t,n){const i=this.database.Anchors[e],s=this.database.Anchors[n],o=this.database.Anchors[t],a=(s.x-i.x)/(s.y-i.y)*(o.y-i.y)+i.x,l=1e-4;return a>o.x+l?this.TryShiftToTheRight(a,t):a<o.x-l&&this.TryShiftToTheLeft(a,t)}TryShiftToTheLeft(e,t){const i=this.engineLayerArrays.x[t];if(i>0){const o=Math.max(this.database.Anchors[this.engineLayerArrays.Layers[this.engineLayerArrays.y[t]][i-1]].right+(this.sugiyamaSettings.NodeSeparation+this.database.Anchors[t].leftAnchor),e);return o<this.database.Anchors[t].x-1&&(this.database.Anchors[t].x=o,!0)}return this.database.Anchors[t].x=e,!0}TryShiftToTheRight(e,t){const n=this.engineLayerArrays.Layers[this.engineLayerArrays.y[t]],i=this.engineLayerArrays.x[t];if(i<n.length-1){const o=Math.min(this.database.Anchors[n[i+1]].left-(this.sugiyamaSettings.NodeSeparation-this.database.Anchors[t].rightAnchor),e);return o>this.database.Anchors[t].x+1&&(this.database.Anchors[t].x=o,!0)}return this.database.Anchors[t].x=e,!0}CalculateXLayersByGansnerNorth(e){this.xLayoutGraph=this.CreateXLayoutGraph(e),this.CalculateXLayersByGansnerNorthOnProperLayeredGraph()}CalculateXLayersByGansnerNorthOnProperLayeredGraph(){const e=new tL(this.xLayoutGraph,null).GetLayers();for(let t=0;t<this.database.Anchors.length;t++)this.anchors[t].x=e[t]}CreateXLayoutGraph(e){let t=this.properLayeredGraph.NodeCount;const n=new Array;for(const s of this.properLayeredGraph.Edges){const o=new La(t,s.Source,null),a=new La(t,s.Target,null);a.weight=s.Weight,o.weight=s.Weight,o.separation=0,a.separation=0,t++,n.push(o),n.push(a)}for(const s of e.Layers)for(let o=s.length-1;o>0;o--){const a=s[o],l=s[o-1],c=new La(a,l,null);c.separation=Math.ceil(this.database.Anchors[a].leftAnchor+(this.database.Anchors[l].rightAnchor+this.sugiyamaSettings.NodeSeparation)+.5),n.push(c)}const i=new qW(this.IntGraph,this.properLayeredGraph,e,n,t);return i.SetEdgeWeights(),i}CalculateXPositionsByBrandes(e){JW.CalculateXCoordinates(e,this.properLayeredGraph,this.originalGraph.shallowNodeCount,this.database.Anchors,this.sugiyamaSettings.NodeSeparation)}GluedDagSkeletonEdges(){const e=new qf(this.IntGraph.nodeCount);for(const[n,i]of this.database.Multiedges.keyValues()){if(n.isDiagonal())continue;const s=this.verticalConstraints.gluedIntEdge(i[0]);s.source!=s.target&&e.set(s.source,s.target,s)}const t=Array.from(this.verticalConstraints.gluedUpDownIntConstraints.values()).map(n=>function g5(r,e){const t=new La(r.x,r.y,e);return t.weight=0,t.separation=1,t}(n,null));for(const n of t)e.set(n.source,n.target,n);return Array.from(e.values())}static CalcAnchorsForOriginalNode(e,t,n,i,s){const o={leftAnchor:0,rightAnchor:0,topAnchor:0,bottomAnchor:0};null!=t.nodes&&function A5(r,e,t){r.rightAnchor=r.leftAnchor=(e.width+t.GridSizeByX)/2,r.topAnchor=r.bottomAnchor=e.height/2}(o,t.nodes[e],s),function b5(r,e,t,n){const i=function C5(r,e,t,n){let i=0;const s=r.GetMultiedge(e,e);if(s.length>0){for(const o of s)null!=o.edge.label&&(t.rightAnchor+=o.edge.label.width,t.topAnchor<o.edge.label.height/2&&(t.topAnchor=t.bottomAnchor=o.edge.label.height/2));i+=(n.NodeSeparation+n.MinNodeWidth)*s.length}return i}(t,r,e,n);e.rightAnchor+=i}(e,o,i,s);const a=s.MinNodeWidth/2;o.leftAnchor<a&&(o.leftAnchor=a),o.rightAnchor<a&&(o.rightAnchor=a);const l=s.MinNodeHeight/2;o.topAnchor<l&&(o.topAnchor=l),o.bottomAnchor<l&&(o.bottomAnchor=l),n[e]=lo.mkAnchor(o.leftAnchor,o.rightAnchor,o.topAnchor,o.bottomAnchor,t.nodes[e],s.LabelCornersPreserveCoefficient),n[e].padding=t.nodes[e].padding}CreateGluedDagSkeletonForLayering(){this.gluedDagSkeletonForLayering=new Cy(this.GluedDagSkeletonEdges(),this.originalGraph.shallowNodeCount),this.SetGluedEdgesWeights()}SetGluedEdgesWeights(){const e=new qf(this.IntGraph.nodeCount);for(const t of this.gluedDagSkeletonForLayering.edges)e.set(t.source,t.target,t);for(const[t,n]of this.database.Multiedges.keyValues())if(t.x!=t.y){const i=this.verticalConstraints.gluedIntPair(t);if(i.x==i.y)continue;const s=e.get(i.x,i.y);for(const o of n)s.weight+=o.weight}}GetNodeCountsOfGluedDag(){return this.verticalConstraints.isEmpty?new Array(this.IntGraph.nodeCount).fill(1):this.verticalConstraints.getGluedNodeCounts()}}function HL(r,e){if(0==e)return 0;const n=r-Math.floor(r/e)*e;return Math.abs(n)<1e-4?0:e-n}function YL(r){return 1.5*r.MinNodeHeight/8}function UL(r,e,t,n,i,s){let o=0;if(t>0){const a=function v5(r,e,t){const n=new Ma;for(const i of r)if(!(i>=t.nodeCount))for(const s of t.outEdges[i])e[s.source]==e[s.target]&&n.addNN(s.source,s.target);return Array.from(n.values())}(e.Layers[t-1],e.y,n);if(a.length){const l=i.LayerSeparation/3,c=s;o=Math.max(...a.map(d=>function S5(r,e,t,n){let i=0;const s=n.GetMultiedgeI(r);for(const o of s){i+=t;const a=o.edge.label;null!=a&&(a.center=new k(a.center.x,e+i+a.height/2),i+=a.height)}return i}(d,c,l,r)))}}return o}function p5(r,e){return r[e.source]-r[e.target]}function m5(r,e,t,n,i){if(function h5(r,e){for(const t of r)if(t<e)return!0;return!1}(r,n))for(const s of r)if(s>=n){const o=i[s];o.bottomAnchor=e,o.topAnchor=t}}function y5(r){return r.SnapToGridByY==Xf.Top}function E5(r){return r.SnapToGridByY==Xf.Bottom}function w5(r,e,t){if(r.labelIsToTheRightOfTheSpline){if(k.getTriangleOrientation(e.origin,r.origin,t.origin)==nt.Clockwise)return!0;const n=r.leftAnchor,i=r.rightAnchor,s=r.x;return WL(r),k.getTriangleOrientation(e.origin,r.origin,t.origin)==nt.Counterclockwise||(r.x=s,r.leftAnchor=n,r.rightAnchor=i,r.labelIsToTheRightOfTheSpline=!0,r.labelIsToTheLeftOfTheSpline=!1,!1)}return!1}function WL(r){const e=r.right,t=r.leftAnchor;r.leftAnchor=r.rightAnchor,r.rightAnchor=t,r.x=e-r.rightAnchor,r.labelIsToTheLeftOfTheSpline=!0,r.labelIsToTheRightOfTheSpline=!1}function I5(r,e){if(null!=e.curve){e.curve=e.curve.transform(r);const t=e;null!=t.sourceArrowhead&&(t.sourceArrowhead.tipPosition=r.multiplyPoint(t.sourceArrowhead.tipPosition)),null!=t.targetArrowhead&&(t.targetArrowhead.tipPosition=r.multiplyPoint(t.targetArrowhead.tipPosition)),function P5(r,e){if(null!=r.underlyingPolyline)for(let t=r.underlyingPolyline.headSite;null!=t;t=t.next)t.point=e.multiplyPoint(t.point)}(e,r)}}class _5{constructor(e,t,n){this.useMSAGLLayeredLayout=e,this.nodeWidth=t,this.nodeHeight=n,this.cachedGeomGraph=void 0}run(e){var t,n;if(!this.cachedGeomGraph){const s=this.createGeomGraph(e);if(this.useMSAGLLayeredLayout){const o=new xS;o.layerDirection=ao.LR,o.LayerSeparation=150,o.MinNodeHeight=this.nodeHeight,o.MinNodeWidth=this.nodeWidth,s.layoutSettings=o,u5(s)}else!function U4(r,e){function t(s){s.layoutSettings||(s.layoutSettings=function i(s){return s.shallowNodeCount<200||s.edgeCount<200?new xS:new DL}(s))}t(r),GT(r,e,function n(s,o){if(t(s),s.layoutSettings instanceof xS)new YT(s,s.layoutSettings,o).run();else{if(!(s.layoutSettings instanceof DL))throw Error("not implemented");new xL(s,o,()=>1,s.layoutSettings).run()}},FL,Yx)}(s,void 0);this.cachedGeomGraph=s}e.edgeLabels=[];for(const s of this.cachedGeomGraph.shallowNodes()){const o=e.nodes.find(a=>a.id===s.id);if((null===(t=o.position)||void 0===t?void 0:t.x)===s.center.x&&(null===(n=o.position)||void 0===n?void 0:n.y)===s.center.y)break;o.position={x:s.center.x,y:s.center.y},o.dimension={width:o.dimension.width,height:o.dimension.height}}const i=Array.from(this.cachedGeomGraph.edges());for(const s of e.edges)this.updateGraphEdge(e,s,i);return e}updateEdge(e,t){return e}setNode(e,t,n,i,s=new k(0,0)){let o=e.graph.findNode(t);null==o&&e.graph.addNode(o=new Fx(t));const a=new tT(o);return a.boundaryCurve=gs.mkCircle(10,new k(10,10)),a}createGeomGraph(e){const t=xa.mk("graph",new Sy(0,0));return e.nodes.forEach(n=>{this.setNode(t,n.id,n.dimension.width,n.dimension.height)}),e.edges.forEach(n=>{t.setEdge(n.source,n.target)}),t}updateGraphEdge(e,t,n){var i;if(!t.points||0===t.points.length){const s=n.find(o=>o.source.id===t.source&&o.target.id===t.target);t.points=this.getPointsFromGeoEdge(s)}if((null===(i=t.points)||void 0===i?void 0:i.length)>0){const s=`${t.source}\x01${t.target}\x01\0`,o=e.edgeLabels[s];o?o.points=t.points:e.edgeLabels[s]={points:t.points}}return e}getPointsFromGeoEdge(e){const t=[],n=function vW(r,e){return eT(r.parStart,r.start,r.parEnd,r.end,r,e)}(e.curve,e.curve.end.sub(e.curve.start).length/20);for(let i=0;i<n.length;i++)t.push({y:n[i].y,x:n[i].x});return t.push({y:e.targetArrowhead.tipPosition.y,x:e.targetArrowhead.tipPosition.x}),t}}function zL(r,e,t){r._context.bezierCurveTo((2*r._x0+r._x1)/3,(2*r._y0+r._y1)/3,(r._x0+2*r._x1)/3,(r._y0+2*r._y1)/3,(r._x0+4*r._x1+e)/6,(r._y0+4*r._y1+t)/6)}function iA(r){this._context=r}function D5(r){return new iA(r)}iA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:zL(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:zL(this,r,e)}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e}};var $L=p(655);class KL{}const wc="*";function JL(r,e){return{type:7,name:r,definitions:e,options:{}}}function WT(r,e=null){return{type:4,styles:e,timings:r}}function qL(r,e=null){return{type:2,steps:r,options:e}}function gg(r){return{type:6,styles:r,offset:null}}function QL(r,e,t){return{type:0,name:r,styles:e,options:t}}function jT(r,e,t=null){return{type:1,expr:r,animation:e,options:t}}function XL(r){Promise.resolve(null).then(r)}class zy{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){XL(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class ZL{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const s=this.players.length;0==s?XL(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function L5(){}function $T(r){return null==r?L5:function(){return this.querySelector(r)}}function F5(){return[]}function eM(r){return null==r?F5:function(){return this.querySelectorAll(r)}}function tM(r){return function(){return this.matches(r)}}function nM(r){return new Array(r.length)}function sA(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}function H5(r,e,t,n,i,s){for(var a,o=0,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],n[o]=a):t[o]=new sA(r,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function Y5(r,e,t,n,i,s,o){var a,l,F,c={},d=e.length,b=s.length,N=new Array(d);for(a=0;a<d;++a)(l=e[a])&&(N[a]=F="$"+o.call(l,l.__data__,a,e),F in c?i[a]=l:c[F]=l);for(a=0;a<b;++a)(l=c[F="$"+o.call(r,s[a],a,s)])?(n[a]=l,l.__data__=s[a],c[F]=null):t[a]=new sA(r,s[a]);for(a=0;a<d;++a)(l=e[a])&&c[N[a]]===l&&(i[a]=l)}function J5(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}sA.prototype={constructor:sA,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};var KT="http://www.w3.org/1999/xhtml";const iM={svg:"http://www.w3.org/2000/svg",xhtml:KT,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function oA(r){var e=r+="",t=e.indexOf(":");return t>=0&&"xmlns"!==(e=r.slice(0,t))&&(r=r.slice(t+1)),iM.hasOwnProperty(e)?{space:iM[e],local:r}:r}function n8(r){return function(){this.removeAttribute(r)}}function r8(r){return function(){this.removeAttributeNS(r.space,r.local)}}function i8(r,e){return function(){this.setAttribute(r,e)}}function s8(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function o8(r,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttribute(r):this.setAttribute(r,t)}}function a8(r,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,t)}}function sM(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function c8(r){return function(){this.style.removeProperty(r)}}function u8(r,e,t){return function(){this.style.setProperty(r,e,t)}}function h8(r,e,t){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(r):this.style.setProperty(r,n,t)}}function pg(r,e){return r.style.getPropertyValue(e)||sM(r).getComputedStyle(r,null).getPropertyValue(e)}function f8(r){return function(){delete this[r]}}function g8(r,e){return function(){this[r]=e}}function p8(r,e){return function(){var t=e.apply(this,arguments);null==t?delete this[r]:this[r]=t}}function oM(r){return r.trim().split(/^|\s+/)}function JT(r){return r.classList||new aM(r)}function aM(r){this._node=r,this._names=oM(r.getAttribute("class")||"")}function lM(r,e){for(var t=JT(r),n=-1,i=e.length;++n<i;)t.add(e[n])}function cM(r,e){for(var t=JT(r),n=-1,i=e.length;++n<i;)t.remove(e[n])}function y8(r){return function(){lM(this,r)}}function E8(r){return function(){cM(this,r)}}function w8(r,e){return function(){(e.apply(this,arguments)?lM:cM)(this,r)}}function S8(){this.textContent=""}function A8(r){return function(){this.textContent=r}}function b8(r){return function(){var e=r.apply(this,arguments);this.textContent=null==e?"":e}}function R8(){this.innerHTML=""}function T8(r){return function(){this.innerHTML=r}}function O8(r){return function(){var e=r.apply(this,arguments);this.innerHTML=null==e?"":e}}function P8(){this.nextSibling&&this.parentNode.appendChild(this)}function _8(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function x8(r){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===KT&&e.documentElement.namespaceURI===KT?e.createElement(r):e.createElementNS(t,r)}}function L8(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function uM(r){var e=oA(r);return(e.local?L8:x8)(e)}function F8(){return null}function k8(){var r=this.parentNode;r&&r.removeChild(this)}function V8(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function H8(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}aM.prototype={add:function(r){this._names.indexOf(r)<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};var hM={},ad=null;function j8(r,e,t){return r=dM(r,e,t),function(n){var i=n.relatedTarget;(!i||i!==this&&!(8&i.compareDocumentPosition(this)))&&r.call(this,n)}}function dM(r,e,t){return function(n){var i=ad;ad=n;try{r.call(this,this.__data__,e,t)}finally{ad=i}}}function z8(r){return r.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function $8(r){return function(){var e=this.__on;if(e){for(var s,t=0,n=-1,i=e.length;t<i;++t)s=e[t],r.type&&s.type!==r.type||s.name!==r.name?e[++n]=s:this.removeEventListener(s.type,s.listener,s.capture);++n?e.length=n:delete this.__on}}}function K8(r,e,t){var n=hM.hasOwnProperty(r.type)?j8:dM;return function(i,s,o){var l,a=this.__on,c=n(e,s,o);if(a)for(var d=0,b=a.length;d<b;++d)if((l=a[d]).type===r.type&&l.name===r.name)return this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=c,l.capture=t),void(l.value=e);this.addEventListener(r.type,c,t),l={type:r.type,name:r.name,value:e,listener:c,capture:t},a?a.push(l):this.__on=[l]}}function fM(r,e,t){var n=sM(r),i=n.CustomEvent;"function"==typeof i?i=new i(e,t):(i=n.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),r.dispatchEvent(i)}function q8(r,e){return function(){return fM(this,r,e)}}function Q8(r,e){return function(){return fM(this,r,e.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(hM={mouseenter:"mouseover",mouseleave:"mouseout"}));var gM=[null];function Eo(r,e){this._groups=r,this._parents=e}function pM(){return new Eo([[document.documentElement]],gM)}Eo.prototype=pM.prototype={constructor:Eo,select:function M5(r){"function"!=typeof r&&(r=$T(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var l,c,s=e[i],o=s.length,a=n[i]=new Array(o),d=0;d<o;++d)(l=s[d])&&(c=r.call(l,l.__data__,d,s))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new Eo(n,this._parents)},selectAll:function B5(r){"function"!=typeof r&&(r=eM(r));for(var e=this._groups,t=e.length,n=[],i=[],s=0;s<t;++s)for(var l,o=e[s],a=o.length,c=0;c<a;++c)(l=o[c])&&(n.push(r.call(l,l.__data__,c,o)),i.push(l));return new Eo(n,i)},filter:function k5(r){"function"!=typeof r&&(r=tM(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var l,s=e[i],o=s.length,a=n[i]=[],c=0;c<o;++c)(l=s[c])&&r.call(l,l.__data__,c,s)&&a.push(l);return new Eo(n,this._parents)},data:function U5(r,e){if(!r)return F=new Array(this.size()),c=-1,this.each(function(Et){F[++c]=Et}),F;var t=e?Y5:H5,n=this._parents,i=this._groups;"function"!=typeof r&&(r=function V5(r){return function(){return r}}(r));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var d=n[c],b=i[c],N=b.length,F=r.call(d,d&&d.__data__,c,n),G=F.length,W=a[c]=new Array(G),ie=o[c]=new Array(G);t(d,b,W,ie,l[c]=new Array(N),F,e);for(var Ke,Xe,de=0,Te=0;de<G;++de)if(Ke=W[de]){for(de>=Te&&(Te=de+1);!(Xe=ie[Te])&&++Te<G;);Ke._next=Xe||null}}return(o=new Eo(o,n))._enter=a,o._exit=l,o},enter:function G5(){return new Eo(this._enter||this._groups.map(nM),this._parents)},exit:function W5(){return new Eo(this._exit||this._groups.map(nM),this._parents)},join:function j5(r,e,t){var n=this.enter(),i=this,s=this.exit();return n="function"==typeof r?r(n):n.append(r+""),null!=e&&(i=e(i)),null==t?s.remove():t(s),n&&i?n.merge(i).order():i},merge:function z5(r){for(var e=this._groups,t=r._groups,n=e.length,s=Math.min(n,t.length),o=new Array(n),a=0;a<s;++a)for(var N,l=e[a],c=t[a],d=l.length,b=o[a]=new Array(d),F=0;F<d;++F)(N=l[F]||c[F])&&(b[F]=N);for(;a<n;++a)o[a]=e[a];return new Eo(o,this._parents)},order:function $5(){for(var r=this._groups,e=-1,t=r.length;++e<t;)for(var o,n=r[e],i=n.length-1,s=n[i];--i>=0;)(o=n[i])&&(s&&4^o.compareDocumentPosition(s)&&s.parentNode.insertBefore(o,s),s=o);return this},sort:function K5(r){function e(b,N){return b&&N?r(b.__data__,N.__data__):!b-!N}r||(r=J5);for(var t=this._groups,n=t.length,i=new Array(n),s=0;s<n;++s){for(var c,o=t[s],a=o.length,l=i[s]=new Array(a),d=0;d<a;++d)(c=o[d])&&(l[d]=c);l.sort(e)}return new Eo(i,this._parents).order()},call:function q5(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this},nodes:function Q5(){var r=new Array(this.size()),e=-1;return this.each(function(){r[++e]=this}),r},node:function X5(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,s=n.length;i<s;++i){var o=n[i];if(o)return o}return null},size:function Z5(){var r=0;return this.each(function(){++r}),r},empty:function e8(){return!this.node()},each:function t8(r){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a,i=e[t],s=0,o=i.length;s<o;++s)(a=i[s])&&r.call(a,a.__data__,s,i);return this},attr:function l8(r,e){var t=oA(r);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((null==e?t.local?r8:n8:"function"==typeof e?t.local?a8:o8:t.local?s8:i8)(t,e))},style:function d8(r,e,t){return arguments.length>1?this.each((null==e?c8:"function"==typeof e?h8:u8)(r,e,null==t?"":t)):pg(this.node(),r)},property:function m8(r,e){return arguments.length>1?this.each((null==e?f8:"function"==typeof e?p8:g8)(r,e)):this.node()[r]},classed:function v8(r,e){var t=oM(r+"");if(arguments.length<2){for(var n=JT(this.node()),i=-1,s=t.length;++i<s;)if(!n.contains(t[i]))return!1;return!0}return this.each(("function"==typeof e?w8:e?y8:E8)(t,e))},text:function C8(r){return arguments.length?this.each(null==r?S8:("function"==typeof r?b8:A8)(r)):this.node().textContent},html:function I8(r){return arguments.length?this.each(null==r?R8:("function"==typeof r?O8:T8)(r)):this.node().innerHTML},raise:function N8(){return this.each(P8)},lower:function D8(){return this.each(_8)},append:function M8(r){var e="function"==typeof r?r:uM(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function B8(r,e){var t="function"==typeof r?r:uM(r),n=null==e?F8:"function"==typeof e?e:$T(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function G8(){return this.each(k8)},clone:function Y8(r){return this.select(r?H8:V8)},datum:function U8(r){return arguments.length?this.property("__data__",r):this.node().__data__},on:function J8(r,e,t){var i,o,n=z8(r+""),s=n.length;if(!(arguments.length<2)){for(a=e?K8:$8,null==t&&(t=!1),i=0;i<s;++i)this.each(a(n[i],e,t));return this}var a=this.node().__on;if(a)for(var d,l=0,c=a.length;l<c;++l)for(i=0,d=a[l];i<s;++i)if((o=n[i]).type===d.type&&o.name===d.name)return d.value},dispatch:function X8(r,e){return this.each(("function"==typeof e?Q8:q8)(r,e))}};const $y=pM;function mM(r){return"string"==typeof r?new Eo([[document.querySelector(r)]],[document.documentElement]):new Eo([[r]],gM)}function yM(r,e){this._basis=new iA(r),this._beta=e}yM.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var r=this._x,e=this._y,t=r.length-1;if(t>0)for(var l,n=r[0],i=e[0],s=r[t]-n,o=e[t]-i,a=-1;++a<=t;)this._basis.point(this._beta*r[a]+(1-this._beta)*(n+(l=a/t)*s),this._beta*e[a]+(1-this._beta)*(i+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(r,e){this._x.push(+r),this._y.push(+e)}};const Z8=function r(e){function t(n){return 1===e?new iA(n):new yM(n,e)}return t.beta=function(n){return r(+n)},t}(.85);var qT=Math.PI,QT=2*qT,ld=1e-6,ej=QT-ld;function XT(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function EM(){return new XT}XT.prototype=EM.prototype={constructor:XT,moveTo:function(r,e){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(r,e){this._+="L"+(this._x1=+r)+","+(this._y1=+e)},quadraticCurveTo:function(r,e,t,n){this._+="Q"+ +r+","+ +e+","+(this._x1=+t)+","+(this._y1=+n)},bezierCurveTo:function(r,e,t,n,i,s){this._+="C"+ +r+","+ +e+","+ +t+","+ +n+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(r,e,t,n,i){var s=this._x1,o=this._y1,a=(t=+t)-(r=+r),l=(n=+n)-(e=+e),c=s-r,d=o-e,b=c*c+d*d;if((i=+i)<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=r)+","+(this._y1=e);else if(b>ld)if(Math.abs(d*a-l*c)>ld&&i){var N=t-s,F=n-o,G=a*a+l*l,W=N*N+F*F,ie=Math.sqrt(G),he=Math.sqrt(b),de=i*Math.tan((qT-Math.acos((G+b-W)/(2*ie*he)))/2),Te=de/he,Ke=de/ie;Math.abs(Te-1)>ld&&(this._+="L"+(r+Te*c)+","+(e+Te*d)),this._+="A"+i+","+i+",0,0,"+ +(d*N>c*F)+","+(this._x1=r+Ke*a)+","+(this._y1=e+Ke*l)}else this._+="L"+(this._x1=r)+","+(this._y1=e)},arc:function(r,e,t,n,i,s){r=+r,e=+e,s=!!s;var o=(t=+t)*Math.cos(n),a=t*Math.sin(n),l=r+o,c=e+a,d=1^s,b=s?n-i:i-n;if(t<0)throw new Error("negative radius: "+t);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>ld||Math.abs(this._y1-c)>ld)&&(this._+="L"+l+","+c),t&&(b<0&&(b=b%QT+QT),b>ej?this._+="A"+t+","+t+",0,1,"+d+","+(r-o)+","+(e-a)+"A"+t+","+t+",0,1,"+d+","+(this._x1=l)+","+(this._y1=c):b>ld&&(this._+="A"+t+","+t+",0,"+ +(b>=qT)+","+d+","+(this._x1=r+t*Math.cos(i))+","+(this._y1=e+t*Math.sin(i))))},rect:function(r,e,t,n){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+e)+"h"+ +t+"v"+ +n+"h"+-t+"Z"},toString:function(){return this._}};const tj=EM;function aA(r){return function(){return r}}function wM(r){this._context=r}function nj(r){return new wM(r)}function rj(r){return r[0]}function ij(r){return r[1]}wM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;default:this._context.lineTo(r,e)}}};var vM=Math.PI;function AM(r){return(1-Math.cos(vM*r))/2}var oj={value:function(){}};function bM(){for(var n,r=0,e=arguments.length,t={};r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new lA(t)}function lA(r){this._=r}function aj(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}function lj(r,e){for(var i,t=0,n=r.length;t<n;++t)if((i=r[t]).name===e)return i.value}function CM(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=oj,r=r.slice(0,n).concat(r.slice(n+1));break}return null!=t&&r.push({name:e,value:t}),r}lA.prototype=bM.prototype={constructor:lA,on:function(r,e){var i,t=this._,n=aj(r+"",t),s=-1,o=n.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(r=n[s]).type)t[i]=CM(t[i],r.name,e);else if(null==e)for(i in t)t[i]=CM(t[i],r.name,null);return this}for(;++s<o;)if((i=(r=n[s]).type)&&(i=lj(t[i],r.name)))return i},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new lA(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var i,s,t=new Array(i),n=0;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(n=0,i=(s=this._[r]).length;n<i;++n)s[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,s=n.length;i<s;++i)n[i].value.apply(e,t)}};const ZT=bM;var cA,qy,mg=0,Ky=0,Jy=0,uA=0,cd=0,hA=0,Qy="object"==typeof performance&&performance.now?performance:Date,TM="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function yg(){return cd||(TM(cj),cd=Qy.now()+hA)}function cj(){cd=0}function Xy(){this._call=this._time=this._next=null}function dA(r,e,t){var n=new Xy;return n.restart(r,e,t),n}function OM(){yg(),++mg;for(var e,r=cA;r;)(e=cd-r._time)>=0&&r._call.call(null,e),r=r._next;--mg}function IM(){cd=(uA=Qy.now())+hA,mg=Ky=0;try{OM()}finally{mg=0,function hj(){for(var r,t,e=cA,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:cA=t);qy=r,eO(n)}(),cd=0}}function uj(){var r=Qy.now(),e=r-uA;e>1e3&&(hA-=e,uA=r)}function eO(r){mg||(Ky&&(Ky=clearTimeout(Ky)),r-cd>24?(r<1/0&&(Ky=setTimeout(IM,r-Qy.now()-hA)),Jy&&(Jy=clearInterval(Jy))):(Jy||(uA=Qy.now(),Jy=setInterval(uj,1e3)),mg=1,TM(IM)))}function tO(r,e,t){var n=new Xy;return n.restart(function(i){n.stop(),r(i+e)},e=null==e?0:+e,t),n}Xy.prototype=dA.prototype={constructor:Xy,restart:function(r,e,t){if("function"!=typeof r)throw new TypeError("callback is not a function");t=(null==t?yg():+t)+(null==e?0:+e),!this._next&&qy!==this&&(qy?qy._next=this:cA=this,qy=this),this._call=r,this._time=t,eO()},stop:function(){this._call&&(this._call=null,this._time=1/0,eO())}};var dj=ZT("start","end","cancel","interrupt"),fj=[];function pA(r,e,t,n,i,s){var o=r.__transition;if(o){if(t in o)return}else r.__transition={};!function gj(r,e,t){var i,n=r.__transition;function o(c){var d,b,N,F;if(1!==t.state)return l();for(d in n)if((F=n[d]).name===t.name){if(3===F.state)return tO(o);4===F.state?(F.state=6,F.timer.stop(),F.on.call("interrupt",r,r.__data__,F.index,F.group),delete n[d]):+d<e&&(F.state=6,F.timer.stop(),F.on.call("cancel",r,r.__data__,F.index,F.group),delete n[d])}if(tO(function(){3===t.state&&(t.state=4,t.timer.restart(a,t.delay,t.time),a(c))}),t.state=2,t.on.call("start",r,r.__data__,t.index,t.group),2===t.state){for(t.state=3,i=new Array(N=t.tween.length),d=0,b=-1;d<N;++d)(F=t.tween[d].value.call(r,r.__data__,t.index,t.group))&&(i[++b]=F);i.length=b+1}}function a(c){for(var d=c<t.duration?t.ease.call(null,c/t.duration):(t.timer.restart(l),t.state=5,1),b=-1,N=i.length;++b<N;)i[b].call(r,d);5===t.state&&(t.on.call("end",r,r.__data__,t.index,t.group),l())}function l(){for(var c in t.state=6,t.timer.stop(),delete n[e],n)return;delete r.__transition}n[e]=t,t.timer=dA(function s(c){t.state=1,t.timer.restart(o,t.delay,t.time),t.delay<=c&&o(c-t.delay)},0,t.time)}(r,t,{name:e,index:n,group:i,on:dj,tween:fj,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function iO(r,e){var t=Va(r,e);if(t.state>0)throw new Error("too late; already scheduled");return t}function vc(r,e){var t=Va(r,e);if(t.state>3)throw new Error("too late; already running");return t}function Va(r,e){var t=r.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function Du(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}var Zy,oO,LM,mA,DM=180/Math.PI,sO={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xM(r,e,t,n,i,s){var o,a,l;return(o=Math.sqrt(r*r+e*e))&&(r/=o,e/=o),(l=r*t+e*n)&&(t-=r*l,n-=e*l),(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a,l/=a),r*n<e*t&&(r=-r,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,r)*DM,skewX:Math.atan(l)*DM,scaleX:o,scaleY:a}}function MM(r,e,t,n){function i(c){return c.length?c.pop()+" ":""}return function(c,d){var b=[],N=[];return c=r(c),d=r(d),function s(c,d,b,N,F,G){if(c!==b||d!==N){var W=F.push("translate(",null,e,null,t);G.push({i:W-4,x:Du(c,b)},{i:W-2,x:Du(d,N)})}else(b||N)&&F.push("translate("+b+e+N+t)}(c.translateX,c.translateY,d.translateX,d.translateY,b,N),function o(c,d,b,N){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),N.push({i:b.push(i(b)+"rotate(",null,n)-2,x:Du(c,d)})):d&&b.push(i(b)+"rotate("+d+n)}(c.rotate,d.rotate,b,N),function a(c,d,b,N){c!==d?N.push({i:b.push(i(b)+"skewX(",null,n)-2,x:Du(c,d)}):d&&b.push(i(b)+"skewX("+d+n)}(c.skewX,d.skewX,b,N),function l(c,d,b,N,F,G){if(c!==b||d!==N){var W=F.push(i(F)+"scale(",null,",",null,")");G.push({i:W-4,x:Du(c,b)},{i:W-2,x:Du(d,N)})}else(1!==b||1!==N)&&F.push(i(F)+"scale("+b+","+N+")")}(c.scaleX,c.scaleY,d.scaleX,d.scaleY,b,N),c=d=null,function(F){for(var ie,G=-1,W=N.length;++G<W;)b[(ie=N[G]).i]=ie.x(F);return b.join("")}}}var wj=MM(function yj(r){return"none"===r?sO:(Zy||(Zy=document.createElement("DIV"),oO=document.documentElement,LM=document.defaultView),Zy.style.transform=r,r=LM.getComputedStyle(oO.appendChild(Zy),null).getPropertyValue("transform"),oO.removeChild(Zy),xM(+(r=r.slice(7,-1).split(","))[0],+r[1],+r[2],+r[3],+r[4],+r[5]))},"px, ","px)","deg)"),vj=MM(function Ej(r){return null!=r&&(mA||(mA=document.createElementNS("http://www.w3.org/2000/svg","g")),mA.setAttribute("transform",r),r=mA.transform.baseVal.consolidate())?xM((r=r.matrix).a,r.b,r.c,r.d,r.e,r.f):sO},", ",")",")");function Sj(r,e){var t,n;return function(){var i=vc(this,r),s=i.tween;if(s!==t)for(var o=0,a=(n=t=s).length;o<a;++o)if(n[o].name===e){(n=n.slice()).splice(o,1);break}i.tween=n}}function Aj(r,e,t){var n,i;if("function"!=typeof t)throw new Error;return function(){var s=vc(this,r),o=s.tween;if(o!==n){i=(n=o).slice();for(var a={name:e,value:t},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}s.tween=i}}function aO(r,e,t){var n=r._id;return r.each(function(){var i=vc(this,n);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return Va(i,n).value[e]}}function lO(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function FM(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function eE(){}var yA=1/.7,Eg="\\s*([+-]?\\d+)\\s*",nE="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Al="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Cj=/^#([0-9a-f]{3,8})$/,Rj=new RegExp("^rgb\\("+[Eg,Eg,Eg]+"\\)$"),Tj=new RegExp("^rgb\\("+[Al,Al,Al]+"\\)$"),Oj=new RegExp("^rgba\\("+[Eg,Eg,Eg,nE]+"\\)$"),Ij=new RegExp("^rgba\\("+[Al,Al,Al,nE]+"\\)$"),Pj=new RegExp("^hsl\\("+[nE,Al,Al]+"\\)$"),Nj=new RegExp("^hsla\\("+[nE,Al,Al,nE]+"\\)$"),BM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function kM(){return this.rgb().formatHex()}function GM(){return this.rgb().formatRgb()}function rE(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=Cj.exec(r))?(t=e[1].length,e=parseInt(e[1],16),6===t?VM(e):3===t?new wo(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===t?EA(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===t?EA(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Rj.exec(r))?new wo(e[1],e[2],e[3],1):(e=Tj.exec(r))?new wo(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Oj.exec(r))?EA(e[1],e[2],e[3],e[4]):(e=Ij.exec(r))?EA(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Pj.exec(r))?UM(e[1],e[2]/100,e[3]/100,1):(e=Nj.exec(r))?UM(e[1],e[2]/100,e[3]/100,e[4]):BM.hasOwnProperty(r)?VM(BM[r]):"transparent"===r?new wo(NaN,NaN,NaN,0):null}function VM(r){return new wo(r>>16&255,r>>8&255,255&r,1)}function EA(r,e,t,n){return n<=0&&(r=e=t=NaN),new wo(r,e,t,n)}function Dj(r){return r instanceof eE||(r=rE(r)),r?new wo((r=r.rgb()).r,r.g,r.b,r.opacity):new wo}function wA(r,e,t,n){return 1===arguments.length?Dj(r):new wo(r,e,t,null==n?1:n)}function wo(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}function HM(){return"#"+cO(this.r)+cO(this.g)+cO(this.b)}function YM(){var r=this.opacity;return(1===(r=isNaN(r)?1:Math.max(0,Math.min(1,r)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===r?")":", "+r+")")}function cO(r){return((r=Math.max(0,Math.min(255,Math.round(r)||0)))<16?"0":"")+r.toString(16)}function UM(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new bl(r,e,t,n)}function WM(r){if(r instanceof bl)return new bl(r.h,r.s,r.l,r.opacity);if(r instanceof eE||(r=rE(r)),!r)return new bl;if(r instanceof bl)return r;var e=(r=r.rgb()).r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),s=Math.max(e,t,n),o=NaN,a=s-i,l=(s+i)/2;return a?(o=e===s?(t-n)/a+6*(t<n):t===s?(n-e)/a+2:(e-t)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new bl(o,a,l,r.opacity)}function bl(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}function uO(r,e,t){return 255*(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)}function jM(r,e,t,n,i){var s=r*r,o=s*r;return((1-3*r+3*s-o)*e+(4-6*s+3*o)*t+(1+3*r+3*s-3*o)*n+o*i)/6}function zM(r){return function(){return r}}function KM(r,e){var t=e-r;return t?function $M(r,e){return function(t){return r+t*e}}(r,t):zM(isNaN(r)?e:r)}lO(eE,rE,{copy:function(r){return Object.assign(new this.constructor,this,r)},displayable:function(){return this.rgb().displayable()},hex:kM,formatHex:kM,formatHsl:function _j(){return WM(this).formatHsl()},formatRgb:GM,toString:GM}),lO(wo,wA,FM(eE,{brighter:function(r){return r=null==r?yA:Math.pow(yA,r),new wo(this.r*r,this.g*r,this.b*r,this.opacity)},darker:function(r){return r=null==r?.7:Math.pow(.7,r),new wo(this.r*r,this.g*r,this.b*r,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:HM,formatHex:HM,formatRgb:YM,toString:YM})),lO(bl,function xj(r,e,t,n){return 1===arguments.length?WM(r):new bl(r,e,t,null==n?1:n)},FM(eE,{brighter:function(r){return r=null==r?yA:Math.pow(yA,r),new bl(this.h,this.s,this.l*r,this.opacity)},darker:function(r){return r=null==r?.7:Math.pow(.7,r),new bl(this.h,this.s,this.l*r,this.opacity)},rgb:function(){var r=this.h%360+360*(this.h<0),e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new wo(uO(r>=240?r-240:r+120,i,n),uO(r,i,n),uO(r<120?r+240:r-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var r=this.opacity;return(1===(r=isNaN(r)?1:Math.max(0,Math.min(1,r)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===r?")":", "+r+")")}}));const JM=function r(e){var t=function Bj(r){return 1==(r=+r)?KM:function(e,t){return t-e?function Fj(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(n){return Math.pow(r+n*e,t)}}(e,t,r):zM(isNaN(e)?t:e)}}(e);function n(i,s){var o=t((i=wA(i)).r,(s=wA(s)).r),a=t(i.g,s.g),l=t(i.b,s.b),c=KM(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=a(d),i.b=l(d),i.opacity=c(d),i+""}}return n.gamma=r,n}(1);function qM(r){return function(e){var o,a,t=e.length,n=new Array(t),i=new Array(t),s=new Array(t);for(o=0;o<t;++o)a=wA(e[o]),n[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return n=r(n),i=r(i),s=r(s),a.opacity=1,function(l){return a.r=n(l),a.g=i(l),a.b=s(l),a+""}}}qM(function Lj(r){var e=r.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,e-1):Math.floor(t*e),i=r[n],s=r[n+1];return jM((t-n/e)*e,n>0?r[n-1]:2*i-s,i,s,n<e-1?r[n+2]:2*s-i)}}),qM(function Mj(r){var e=r.length;return function(t){var n=Math.floor(((t%=1)<0?++t:t)*e);return jM((t-n/e)*e,r[(n+e-1)%e],r[n%e],r[(n+1)%e],r[(n+2)%e])}});var hO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dO=new RegExp(hO.source,"g");function Vj(r,e){var n,i,s,t=hO.lastIndex=dO.lastIndex=0,o=-1,a=[],l=[];for(r+="",e+="";(n=hO.exec(r))&&(i=dO.exec(e));)(s=i.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:Du(n,i)})),t=dO.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?function Gj(r){return function(e){return r(e)+""}}(l[0].x):function kj(r){return function(){return r}}(e):(e=l.length,function(c){for(var b,d=0;d<e;++d)a[(b=l[d]).i]=b.x(c);return a.join("")})}function QM(r,e){var t;return("number"==typeof e?Du:e instanceof rE?JM:(t=rE(e))?(e=t,JM):Vj)(r,e)}function Hj(r){return function(){this.removeAttribute(r)}}function Yj(r){return function(){this.removeAttributeNS(r.space,r.local)}}function Uj(r,e,t){var n,s,i=t+"";return function(){var o=this.getAttribute(r);return o===i?null:o===n?s:s=e(n=o,t)}}function Wj(r,e,t){var n,s,i=t+"";return function(){var o=this.getAttributeNS(r.space,r.local);return o===i?null:o===n?s:s=e(n=o,t)}}function jj(r,e,t){var n,i,s;return function(){var o,l,a=t(this);return null==a?void this.removeAttribute(r):(o=this.getAttribute(r))===(l=a+"")?null:o===n&&l===i?s:(i=l,s=e(n=o,a))}}function zj(r,e,t){var n,i,s;return function(){var o,l,a=t(this);return null==a?void this.removeAttributeNS(r.space,r.local):(o=this.getAttributeNS(r.space,r.local))===(l=a+"")?null:o===n&&l===i?s:(i=l,s=e(n=o,a))}}function Kj(r,e){return function(t){this.setAttribute(r,e.call(this,t))}}function Jj(r,e){return function(t){this.setAttributeNS(r.space,r.local,e.call(this,t))}}function qj(r,e){var t,n;function i(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&Jj(r,s)),t}return i._value=e,i}function Qj(r,e){var t,n;function i(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&Kj(r,s)),t}return i._value=e,i}function Zj(r,e){return function(){iO(this,r).delay=+e.apply(this,arguments)}}function e6(r,e){return e=+e,function(){iO(this,r).delay=e}}function n6(r,e){return function(){vc(this,r).duration=+e.apply(this,arguments)}}function r6(r,e){return e=+e,function(){vc(this,r).duration=e}}function s6(r,e){if("function"!=typeof e)throw new Error;return function(){vc(this,r).ease=e}}function u6(r,e,t){var n,i,s=function c6(r){return(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(e)?iO:vc;return function(){var o=s(this,r),a=o.on;a!==n&&(i=(n=a).copy()).on(e,t),o.on=i}}var m6=$y.prototype.constructor;function XM(r){return function(){this.style.removeProperty(r)}}function b6(r,e,t){return function(n){this.style.setProperty(r,e.call(this,n),t)}}function C6(r,e,t){var n,i;function s(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&b6(r,o,t)),n}return s._value=e,s}function P6(r){return function(e){this.textContent=r.call(this,e)}}function N6(r){var e,t;function n(){var i=r.apply(this,arguments);return i!==t&&(e=(t=i)&&P6(i)),e}return n._value=r,n}var L6=0;function Sc(r,e,t,n){this._groups=r,this._parents=e,this._name=t,this._id=n}function ZM(){return++L6}var wg=$y.prototype;Sc.prototype=function M6(r){return $y().transition(r)}.prototype={constructor:Sc,select:function g6(r){var e=this._name,t=this._id;"function"!=typeof r&&(r=$T(r));for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o)for(var d,b,a=n[o],l=a.length,c=s[o]=new Array(l),N=0;N<l;++N)(d=a[N])&&(b=r.call(d,d.__data__,N,a))&&("__data__"in d&&(b.__data__=d.__data__),c[N]=b,pA(c[N],e,t,N,c,Va(d,t)));return new Sc(s,this._parents,e,t)},selectAll:function p6(r){var e=this._name,t=this._id;"function"!=typeof r&&(r=eM(r));for(var n=this._groups,i=n.length,s=[],o=[],a=0;a<i;++a)for(var d,l=n[a],c=l.length,b=0;b<c;++b)if(d=l[b]){for(var F,N=r.call(d,d.__data__,b,l),G=Va(d,t),W=0,ie=N.length;W<ie;++W)(F=N[W])&&pA(F,e,t,W,N,G);s.push(N),o.push(d)}return new Sc(s,o,e,t)},filter:function a6(r){"function"!=typeof r&&(r=tM(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var l,s=e[i],o=s.length,a=n[i]=[],c=0;c<o;++c)(l=s[c])&&r.call(l,l.__data__,c,s)&&a.push(l);return new Sc(n,this._parents,this._name,this._id)},merge:function l6(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,t=r._groups,n=e.length,s=Math.min(n,t.length),o=new Array(n),a=0;a<s;++a)for(var N,l=e[a],c=t[a],d=l.length,b=o[a]=new Array(d),F=0;F<d;++F)(N=l[F]||c[F])&&(b[F]=N);for(;a<n;++a)o[a]=e[a];return new Sc(o,this._parents,this._name,this._id)},selection:function y6(){return new m6(this._groups,this._parents)},transition:function D6(){for(var r=this._name,e=this._id,t=ZM(),n=this._groups,i=n.length,s=0;s<i;++s)for(var l,o=n[s],a=o.length,c=0;c<a;++c)if(l=o[c]){var d=Va(l,e);pA(l,r,t,c,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Sc(n,this._parents,r,t)},call:wg.call,nodes:wg.nodes,node:wg.node,size:wg.size,empty:wg.empty,each:wg.each,on:function h6(r,e){var t=this._id;return arguments.length<2?Va(this.node(),t).on.on(r):this.each(u6(t,r,e))},attr:function $j(r,e){var t=oA(r),n="transform"===t?vj:QM;return this.attrTween(r,"function"==typeof e?(t.local?zj:jj)(t,n,aO(this,"attr."+r,e)):null==e?(t.local?Yj:Hj)(t):(t.local?Wj:Uj)(t,n,e))},attrTween:function Xj(r,e){var t="attr."+r;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;var n=oA(r);return this.tween(t,(n.local?qj:Qj)(n,e))},style:function A6(r,e,t){var n="transform"==(r+="")?wj:QM;return null==e?this.styleTween(r,function E6(r,e){var t,n,i;return function(){var s=pg(this,r),o=(this.style.removeProperty(r),pg(this,r));return s===o?null:s===t&&o===n?i:i=e(t=s,n=o)}}(r,n)).on("end.style."+r,XM(r)):"function"==typeof e?this.styleTween(r,function v6(r,e,t){var n,i,s;return function(){var o=pg(this,r),a=t(this),l=a+"";return null==a&&(this.style.removeProperty(r),l=a=pg(this,r)),o===l?null:o===n&&l===i?s:(i=l,s=e(n=o,a))}}(r,n,aO(this,"style."+r,e))).each(function S6(r,e){var t,n,i,a,s="style."+e,o="end."+s;return function(){var l=vc(this,r),c=l.on,d=null==l.value[s]?a||(a=XM(e)):void 0;(c!==t||i!==d)&&(n=(t=c).copy()).on(o,i=d),l.on=n}}(this._id,r)):this.styleTween(r,function w6(r,e,t){var n,s,i=t+"";return function(){var o=pg(this,r);return o===i?null:o===n?s:s=e(n=o,t)}}(r,n,e),t).on("end.style."+r,null)},styleTween:function R6(r,e,t){var n="style."+(r+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,C6(r,e,null==t?"":t))},text:function I6(r){return this.tween("text","function"==typeof r?function O6(r){return function(){var e=r(this);this.textContent=null==e?"":e}}(aO(this,"text",r)):function T6(r){return function(){this.textContent=r}}(null==r?"":r+""))},textTween:function _6(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==r)return this.tween(e,null);if("function"!=typeof r)throw new Error;return this.tween(e,N6(r))},remove:function f6(){return this.on("end.remove",function d6(r){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==r)return;e&&e.removeChild(this)}}(this._id))},tween:function bj(r,e){var t=this._id;if(r+="",arguments.length<2){for(var o,n=Va(this.node(),t).tween,i=0,s=n.length;i<s;++i)if((o=n[i]).name===r)return o.value;return null}return this.each((null==e?Sj:Aj)(t,r,e))},delay:function t6(r){var e=this._id;return arguments.length?this.each(("function"==typeof r?Zj:e6)(e,r)):Va(this.node(),e).delay},duration:function i6(r){var e=this._id;return arguments.length?this.each(("function"==typeof r?n6:r6)(e,r)):Va(this.node(),e).duration},ease:function o6(r){var e=this._id;return arguments.length?this.each(s6(e,r)):Va(this.node(),e).ease},end:function x6(){var r,e,t=this,n=t._id,i=t.size();return new Promise(function(s,o){var a={value:o},l={value:function(){0==--i&&s()}};t.each(function(){var c=vc(this,n),d=c.on;d!==r&&((e=(r=d).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e})})}};var fO={time:null,delay:0,duration:250,ease:function F6(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}};function B6(r,e){for(var t;!(t=r.__transition)||!(t=t[e]);)if(!(r=r.parentNode))return fO.time=yg(),fO;return t}$y.prototype.interrupt=function mj(r){return this.each(function(){!function pj(r,e){var n,i,o,t=r.__transition,s=!0;if(t){for(o in e=null==e?null:e+"",t)(n=t[o]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",r,r.__data__,n.index,n.group),delete t[o]):s=!1;s&&delete r.__transition}}(this,r)})},$y.prototype.transition=function k6(r){var e,t;r instanceof Sc?(e=r._id,r=r._name):(e=ZM(),(t=fO).time=yg(),r=null==r?null:r+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var l,o=n[s],a=o.length,c=0;c<a;++c)(l=o[c])&&pA(l,r,e,c,o,t||B6(l,e));return new Sc(n,this._parents,r,e)};const V6=["addListener","removeListener"],H6=["addEventListener","removeEventListener"],Y6=["on","off"];function vg(r,e,t,n){if(w(t)&&(n=t,t=void 0),n)return vg(r,e,t).pipe(_0(n));const[i,s]=function j6(r){return w(r.addEventListener)&&w(r.removeEventListener)}(r)?H6.map(o=>a=>r[o](e,a,t)):function U6(r){return w(r.addListener)&&w(r.removeListener)}(r)?V6.map(e1(r,e)):function W6(r){return w(r.on)&&w(r.off)}(r)?Y6.map(e1(r,e)):[];if(!i&&Xr(r))return Bn(o=>vg(o,e,t))(Si(r));if(!i)throw new TypeError("Invalid event target");return new ee(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return i(a),()=>s(a)})}function e1(r,e){return t=>n=>r[t](e,n)}class z6 extends m{constructor(e,t){super()}schedule(e,t=0){return this}}const vA={setInterval(...r){const{delegate:e}=vA;return((null==e?void 0:e.setInterval)||setInterval)(...r)},clearInterval(r){const{delegate:e}=vA;return((null==e?void 0:e.clearInterval)||clearInterval)(r)},delegate:void 0};class gO extends z6{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this}requestAsyncId(e,t,n=0){return vA.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;vA.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,n=!1;try{this.work(e)}catch(s){n=!0,i=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,y(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const t1={now:()=>(t1.delegate||Date).now(),delegate:void 0};class iE{constructor(e,t=iE.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}iE.now=t1.now;class pO extends iE{constructor(e,t=iE.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const mO=new pO(gO),n1=mO;function yO(r,e=mO){return Se((t,n)=>{let i=null,s=null,o=null;const a=()=>{if(i){i.unsubscribe(),i=null;const c=s;s=null,n.next(c)}};function l(){const c=o+r,d=e.now();if(d<c)return i=this.schedule(void 0,c-d),void n.add(i);a()}t.subscribe(new Ie(n,c=>{s=c,o=e.now(),i||(i=e.schedule(l,r),n.add(i))},()=>{a(),n.complete()},void 0,()=>{s=i=null}))})}function ez(r){return void 0===r}function iz(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}function sz(r){return Array.isArray(r)?r:Array.from(r)}function sE(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];var n=function(b,N){return{a:b.a*N.a+b.c*N.b,c:b.a*N.c+b.c*N.d,e:b.a*N.e+b.c*N.f+b.e,b:b.b*N.a+b.d*N.b,d:b.b*N.c+b.d*N.d,f:b.b*N.e+b.d*N.f+b.f}};switch((e=Array.isArray(e[0])?e[0]:e).length){case 0:throw new Error("no matrices provided");case 1:return e[0];case 2:return n(e[0],e[1]);default:var i=e,s=sz(i),o=s[0],a=s[1],l=s.slice(2),c=n(o,a);return sE.apply(void 0,[c].concat(iz(l)))}}function o1(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{a:1,c:0,e:r,b:0,d:1,f:e}}"function"==typeof Symbol&&Symbol,Math,Math,Math,Math;class a1 extends Map{constructor(e,t=u1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(EO(this,e))}has(e){return super.has(EO(this,e))}set(e,t){return super.set(function l1({_intern:r,_key:e},t){const n=e(t);return r.has(n)?r.get(n):(r.set(n,t),t)}(this,e),t)}delete(e){return super.delete(function c1({_intern:r,_key:e},t){const n=e(t);return r.has(n)&&(t=r.get(n),r.delete(n)),t}(this,e))}}function EO({_intern:r,_key:e},t){const n=e(t);return r.has(n)?r.get(n):t}function u1(r){return null!==r&&"object"==typeof r?r.valueOf():r}function az(r,e){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(e).domain(r)}return this}Set;const h1=Symbol("implicit");function d1(){var r=new a1,e=[],t=[],n=h1;function i(s){let o=r.get(s);if(void 0===o){if(n!==h1)return n;r.set(s,o=e.push(s)-1)}return t[o%t.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],r=new a1;for(const o of s)r.has(o)||r.set(o,e.push(o)-1);return i},i.range=function(s){return arguments.length?(t=Array.from(s),i):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return d1(e,t).unknown(n)},az.apply(i,arguments),i}var Ag=p(9695);function lz(r,e){var t;function n(){var i,o,s=t.length,a=0,l=0;for(i=0;i<s;++i)a+=(o=t[i]).x,l+=o.y;for(a=a/s-r,l=l/s-e,i=0;i<s;++i)(o=t[i]).x-=a,o.y-=l}return null==r&&(r=0),null==e&&(e=0),n.initialize=function(i){t=i},n.x=function(i){return arguments.length?(r=+i,n):r},n.y=function(i){return arguments.length?(e=+i,n):e},n}function qr(r){return function(){return r}}function xu(){return 1e-6*(Math.random()-.5)}function f1(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,b,N,F,G,W,ie,he,de,s=r._root,o={data:n},a=r._x0,l=r._y0,c=r._x1,d=r._y1;if(!s)return r._root=o,r;for(;s.length;)if((W=e>=(b=(a+c)/2))?a=b:c=b,(ie=t>=(N=(l+d)/2))?l=N:d=N,i=s,!(s=s[he=ie<<1|W]))return i[he]=o,r;if(F=+r._x.call(null,s.data),G=+r._y.call(null,s.data),e===F&&t===G)return o.next=s,i?i[he]=o:r._root=o,r;do{i=i?i[he]=new Array(4):r._root=new Array(4),(W=e>=(b=(a+c)/2))?a=b:c=b,(ie=t>=(N=(l+d)/2))?l=N:d=N}while((he=ie<<1|W)==(de=(G>=N)<<1|F>=b));return i[de]=s,i[he]=o,r}function ms(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function Sz(r){return r[0]}function bz(r){return r[1]}function wO(r,e,t){var n=new vO(null==e?Sz:e,null==t?bz:t,NaN,NaN,NaN,NaN);return null==r?n:n.addAll(r)}function vO(r,e,t,n,i,s){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=s,this._root=void 0}function g1(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var ys=wO.prototype=vO.prototype;function Rz(r){return r.x+r.vx}function Tz(r){return r.y+r.vy}function p1(r){var e,t,n=1,i=1;function s(){for(var l,d,b,N,F,G,W,c=e.length,ie=0;ie<i;++ie)for(d=wO(e,Rz,Tz).visitAfter(o),l=0;l<c;++l)W=(G=t[(b=e[l]).index])*G,N=b.x+b.vx,F=b.y+b.vy,d.visit(he);function he(de,Te,Ke,Xe,Et){var wt=de.data,qn=de.r,Cn=G+qn;if(!wt)return Te>N+Cn||Xe<N-Cn||Ke>F+Cn||Et<F-Cn;if(wt.index>b.index){var wr=N-wt.x-wt.vx,Es=F-wt.y-wt.vy,Qr=wr*wr+Es*Es;Qr<Cn*Cn&&(0===wr&&(Qr+=(wr=xu())*wr),0===Es&&(Qr+=(Es=xu())*Es),Qr=(Cn-(Qr=Math.sqrt(Qr)))/Qr*n,b.vx+=(wr*=Qr)*(Cn=(qn*=qn)/(W+qn)),b.vy+=(Es*=Qr)*Cn,wt.vx-=wr*(Cn=1-Cn),wt.vy-=Es*Cn)}}}function o(l){if(l.data)return l.r=t[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function a(){if(e){var l,d,c=e.length;for(t=new Array(c),l=0;l<c;++l)t[(d=e[l]).index]=+r(d,l,e)}}return"function"!=typeof r&&(r=qr(null==r?1:+r)),s.initialize=function(l){e=l,a()},s.iterations=function(l){return arguments.length?(i=+l,s):i},s.strength=function(l){return arguments.length?(n=+l,s):n},s.radius=function(l){return arguments.length?(r="function"==typeof l?l:qr(+l),a(),s):r},s}ys.copy=function(){var t,n,r=new vO(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root;if(!e)return r;if(!e.length)return r._root=g1(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=g1(n));return r},ys.add=function cz(r){var e=+this._x.call(null,r),t=+this._y.call(null,r);return f1(this.cover(e,t),e,t,r)},ys.addAll=function uz(r){var e,t,i,s,n=r.length,o=new Array(n),a=new Array(n),l=1/0,c=1/0,d=-1/0,b=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(s=+this._y.call(null,e))||(o[t]=i,a[t]=s,i<l&&(l=i),i>d&&(d=i),s<c&&(c=s),s>b&&(b=s));if(l>d||c>b)return this;for(this.cover(l,c).cover(d,b),t=0;t<n;++t)f1(this,o[t],a[t],r[t]);return this},ys.cover=function hz(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,s=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,s=(n=Math.floor(e))+1;else{for(var l,c,o=i-t,a=this._root;t>r||r>=i||n>e||e>=s;)switch(c=(e<n)<<1|r<t,l=new Array(4),l[c]=a,a=l,o*=2,c){case 0:i=t+o,s=n+o;break;case 1:t=i-o,s=n+o;break;case 2:i=t+o,n=s-o;break;case 3:t=i-o,n=s-o}this._root&&this._root.length&&(this._root=a)}return this._x0=t,this._y0=n,this._x1=i,this._y1=s,this},ys.data=function dz(){var r=[];return this.visit(function(e){if(!e.length)do{r.push(e.data)}while(e=e.next)}),r},ys.extent=function fz(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ys.find=function gz(r,e,t){var n,o,a,l,c,G,W,i=this._x0,s=this._y0,d=this._x1,b=this._y1,N=[],F=this._root;for(F&&N.push(new ms(F,i,s,d,b)),null==t?t=1/0:(i=r-t,s=e-t,d=r+t,b=e+t,t*=t);G=N.pop();)if(!(!(F=G.node)||(o=G.x0)>d||(a=G.y0)>b||(l=G.x1)<i||(c=G.y1)<s))if(F.length){var ie=(o+l)/2,he=(a+c)/2;N.push(new ms(F[3],ie,he,l,c),new ms(F[2],o,he,ie,c),new ms(F[1],ie,a,l,he),new ms(F[0],o,a,ie,he)),(W=(e>=he)<<1|r>=ie)&&(G=N[N.length-1],N[N.length-1]=N[N.length-1-W],N[N.length-1-W]=G)}else{var de=r-+this._x.call(null,F.data),Te=e-+this._y.call(null,F.data),Ke=de*de+Te*Te;if(Ke<t){var Xe=Math.sqrt(t=Ke);i=r-Xe,s=e-Xe,d=r+Xe,b=e+Xe,n=F.data}}return n},ys.remove=function pz(r){if(isNaN(d=+this._x.call(null,r))||isNaN(b=+this._y.call(null,r)))return this;var e,n,i,s,d,b,N,F,G,W,ie,he,t=this._root,o=this._x0,a=this._y0,l=this._x1,c=this._y1;if(!t)return this;if(t.length)for(;;){if((G=d>=(N=(o+l)/2))?o=N:l=N,(W=b>=(F=(a+c)/2))?a=F:c=F,e=t,!(t=t[ie=W<<1|G]))return this;if(!t.length)break;(e[ie+1&3]||e[ie+2&3]||e[ie+3&3])&&(n=e,he=ie)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,i?(s?i.next=s:delete i.next,this):e?(s?e[ie]=s:delete e[ie],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[he]=t:this._root=t),this):(this._root=s,this)},ys.removeAll=function mz(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this},ys.root=function yz(){return this._root},ys.size=function Ez(){var r=0;return this.visit(function(e){if(!e.length)do{++r}while(e=e.next)}),r},ys.visit=function wz(r){var t,i,s,o,a,l,e=[],n=this._root;for(n&&e.push(new ms(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,s=t.x0,o=t.y0,a=t.x1,l=t.y1)&&n.length){var c=(s+a)/2,d=(o+l)/2;(i=n[3])&&e.push(new ms(i,c,d,a,l)),(i=n[2])&&e.push(new ms(i,s,d,c,l)),(i=n[1])&&e.push(new ms(i,c,o,a,d)),(i=n[0])&&e.push(new ms(i,s,o,c,d))}return this},ys.visitAfter=function vz(r){var n,e=[],t=[];for(this._root&&e.push(new ms(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var s,o=n.x0,a=n.y0,l=n.x1,c=n.y1,d=(o+l)/2,b=(a+c)/2;(s=i[0])&&e.push(new ms(s,o,a,d,b)),(s=i[1])&&e.push(new ms(s,d,a,l,b)),(s=i[2])&&e.push(new ms(s,o,b,d,c)),(s=i[3])&&e.push(new ms(s,d,b,l,c))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this},ys.x=function Az(r){return arguments.length?(this._x=r,this):this._x},ys.y=function Cz(r){return arguments.length?(this._y=r,this):this._y};var Qo="$";function SA(){}function m1(r,e){var t=new SA;if(r instanceof SA)r.each(function(a,l){t.set(l,a)});else if(Array.isArray(r)){var s,n=-1,i=r.length;if(null==e)for(;++n<i;)t.set(n,r[n]);else for(;++n<i;)t.set(e(s=r[n],n,r),s)}else if(r)for(var o in r)t.set(o,r[o]);return t}SA.prototype=m1.prototype={constructor:SA,has:function(r){return Qo+r in this},get:function(r){return this[Qo+r]},set:function(r,e){return this[Qo+r]=e,this},remove:function(r){var e=Qo+r;return e in this&&delete this[e]},clear:function(){for(var r in this)r[0]===Qo&&delete this[r]},keys:function(){var r=[];for(var e in this)e[0]===Qo&&r.push(e.slice(1));return r},values:function(){var r=[];for(var e in this)e[0]===Qo&&r.push(this[e]);return r},entries:function(){var r=[];for(var e in this)e[0]===Qo&&r.push({key:e.slice(1),value:this[e]});return r},size:function(){var r=0;for(var e in this)e[0]===Qo&&++r;return r},empty:function(){for(var r in this)if(r[0]===Qo)return!1;return!0},each:function(r){for(var e in this)e[0]===Qo&&r(this[e],e.slice(1),this)}};const SO=m1;function AA(){}var ud=SO.prototype;function Nz(r){return r.index}function w1(r,e){var t=r.get(e);if(!t)throw new Error("missing: "+e);return t}function v1(r){var n,s,o,a,l,e=Nz,t=function d(W){return 1/Math.min(a[W.source.index],a[W.target.index])},i=qr(30),c=1;function b(W){for(var ie=0,he=r.length;ie<c;++ie)for(var Te,Ke,Xe,Et,wt,qn,Cn,de=0;de<he;++de)Et=(Xe=(Te=r[de]).target).x+Xe.vx-(Ke=Te.source).x-Ke.vx||xu(),wt=Xe.y+Xe.vy-Ke.y-Ke.vy||xu(),wt*=qn=((qn=Math.sqrt(Et*Et+wt*wt))-s[de])/qn*W*n[de],Xe.vx-=(Et*=qn)*(Cn=l[de]),Xe.vy-=wt*Cn,Ke.vx+=Et*(Cn=1-Cn),Ke.vy+=wt*Cn}function N(){if(o){var W,Te,ie=o.length,he=r.length,de=SO(o,e);for(W=0,a=new Array(ie);W<he;++W)(Te=r[W]).index=W,"object"!=typeof Te.source&&(Te.source=w1(de,Te.source)),"object"!=typeof Te.target&&(Te.target=w1(de,Te.target)),a[Te.source.index]=(a[Te.source.index]||0)+1,a[Te.target.index]=(a[Te.target.index]||0)+1;for(W=0,l=new Array(he);W<he;++W)l[W]=a[(Te=r[W]).source.index]/(a[Te.source.index]+a[Te.target.index]);n=new Array(he),F(),s=new Array(he),G()}}function F(){if(o)for(var W=0,ie=r.length;W<ie;++W)n[W]=+t(r[W],W,r)}function G(){if(o)for(var W=0,ie=r.length;W<ie;++W)s[W]=+i(r[W],W,r)}return null==r&&(r=[]),b.initialize=function(W){o=W,N()},b.links=function(W){return arguments.length?(r=W,N(),b):r},b.id=function(W){return arguments.length?(e=W,b):e},b.iterations=function(W){return arguments.length?(c=+W,b):c},b.strength=function(W){return arguments.length?(t="function"==typeof W?W:qr(+W),F(),b):t},b.distance=function(W){return arguments.length?(i="function"==typeof W?W:qr(+W),G(),b):i},b}function _z(r){return r.x}function Dz(r){return r.y}AA.prototype=function Pz(r,e){var t=new AA;if(r instanceof AA)r.each(function(s){t.add(s)});else if(r){var n=-1,i=r.length;if(null==e)for(;++n<i;)t.add(r[n]);else for(;++n<i;)t.add(e(r[n],n,r))}return t}.prototype={constructor:AA,has:ud.has,add:function(r){return this[Qo+(r+="")]=r,this},remove:ud.remove,clear:ud.clear,values:ud.keys,size:ud.size,empty:ud.empty,each:ud.each};var Lz=Math.PI*(3-Math.sqrt(5));function S1(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),s=0,o=.6,a=SO(),l=dA(d),c=ZT("tick","end");function d(){b(),c.call("tick",e),t<n&&(l.stop(),c.call("end",e))}function b(G){var W,he,ie=r.length;void 0===G&&(G=1);for(var de=0;de<G;++de)for(t+=(s-t)*i,a.each(function(Te){Te(t)}),W=0;W<ie;++W)null==(he=r[W]).fx?he.x+=he.vx*=o:(he.x=he.fx,he.vx=0),null==he.fy?he.y+=he.vy*=o:(he.y=he.fy,he.vy=0);return e}function N(){for(var ie,G=0,W=r.length;G<W;++G){if((ie=r[G]).index=G,null!=ie.fx&&(ie.x=ie.fx),null!=ie.fy&&(ie.y=ie.fy),isNaN(ie.x)||isNaN(ie.y)){var he=10*Math.sqrt(G),de=G*Lz;ie.x=he*Math.cos(de),ie.y=he*Math.sin(de)}(isNaN(ie.vx)||isNaN(ie.vy))&&(ie.vx=ie.vy=0)}}function F(G){return G.initialize&&G.initialize(r),G}return null==r&&(r=[]),N(),e={tick:b,restart:function(){return l.restart(d),e},stop:function(){return l.stop(),e},nodes:function(G){return arguments.length?(r=G,N(),a.each(F),e):r},alpha:function(G){return arguments.length?(t=+G,e):t},alphaMin:function(G){return arguments.length?(n=+G,e):n},alphaDecay:function(G){return arguments.length?(i=+G,e):+i},alphaTarget:function(G){return arguments.length?(s=+G,e):s},velocityDecay:function(G){return arguments.length?(o=1-G,e):1-o},force:function(G,W){return arguments.length>1?(null==W?a.remove(G):a.set(G,F(W)),e):a.get(G)},find:function(G,W,ie){var Te,Ke,Xe,Et,wt,he=0,de=r.length;for(null==ie?ie=1/0:ie*=ie,he=0;he<de;++he)(Xe=(Te=G-(Et=r[he]).x)*Te+(Ke=W-Et.y)*Ke)<ie&&(wt=Et,ie=Xe);return wt},on:function(G,W){return arguments.length>1?(c.on(G,W),e):c.on(G)}}}function A1(){var r,e,t,i,n=qr(-30),s=1,o=1/0,a=.81;function l(N){var F,G=r.length,W=wO(r,_z,Dz).visitAfter(d);for(t=N,F=0;F<G;++F)e=r[F],W.visit(b)}function c(){if(r){var N,G,F=r.length;for(i=new Array(F),N=0;N<F;++N)i[(G=r[N]).index]=+n(G,N,r)}}function d(N){var G,W,he,de,Te,F=0,ie=0;if(N.length){for(he=de=Te=0;Te<4;++Te)(G=N[Te])&&(W=Math.abs(G.value))&&(F+=G.value,ie+=W,he+=W*G.x,de+=W*G.y);N.x=he/ie,N.y=de/ie}else{(G=N).x=G.data.x,G.y=G.data.y;do{F+=i[G.data.index]}while(G=G.next)}N.value=F}function b(N,F,G,W){if(!N.value)return!0;var ie=N.x-e.x,he=N.y-e.y,de=W-F,Te=ie*ie+he*he;if(de*de/a<Te)return Te<o&&(0===ie&&(Te+=(ie=xu())*ie),0===he&&(Te+=(he=xu())*he),Te<s&&(Te=Math.sqrt(s*Te)),e.vx+=ie*N.value*t/Te,e.vy+=he*N.value*t/Te),!0;if(!(N.length||Te>=o)){(N.data!==e||N.next)&&(0===ie&&(Te+=(ie=xu())*ie),0===he&&(Te+=(he=xu())*he),Te<s&&(Te=Math.sqrt(s*Te)));do{N.data!==e&&(e.vx+=ie*(de=i[N.data.index]*t/Te),e.vy+=he*de)}while(N=N.next)}}return l.initialize=function(N){r=N,c()},l.strength=function(N){return arguments.length?(n="function"==typeof N?N:qr(+N),c(),l):n},l.distanceMin=function(N){return arguments.length?(s=N*N,l):Math.sqrt(s)},l.distanceMax=function(N){return arguments.length?(o=N*N,l):Math.sqrt(o)},l.theta=function(N){return arguments.length?(a=N*N,l):Math.sqrt(a)},l}function Mz(r,e,t){var n,s,o,i=qr(.1);function a(c){for(var d=0,b=n.length;d<b;++d){var N=n[d],F=N.x-e||1e-6,G=N.y-t||1e-6,W=Math.sqrt(F*F+G*G),ie=(o[d]-W)*s[d]*c/W;N.vx+=F*ie,N.vy+=G*ie}}function l(){if(n){var c,d=n.length;for(s=new Array(d),o=new Array(d),c=0;c<d;++c)o[c]=+r(n[c],c,n),s[c]=isNaN(o[c])?0:+i(n[c],c,n)}}return"function"!=typeof r&&(r=qr(+r)),null==e&&(e=0),null==t&&(t=0),a.initialize=function(c){n=c,l()},a.strength=function(c){return arguments.length?(i="function"==typeof c?c:qr(+c),l(),a):i},a.radius=function(c){return arguments.length?(r="function"==typeof c?c:qr(+c),l(),a):r},a.x=function(c){return arguments.length?(e=+c,a):e},a.y=function(c){return arguments.length?(t=+c,a):t},a}function Fz(r){var t,n,i,e=qr(.1);function s(a){for(var d,l=0,c=t.length;l<c;++l)(d=t[l]).vx+=(i[l]-d.x)*n[l]*a}function o(){if(t){var a,l=t.length;for(n=new Array(l),i=new Array(l),a=0;a<l;++a)n[a]=isNaN(i[a]=+r(t[a],a,t))?0:+e(t[a],a,t)}}return"function"!=typeof r&&(r=qr(null==r?0:+r)),s.initialize=function(a){t=a,o()},s.strength=function(a){return arguments.length?(e="function"==typeof a?a:qr(+a),o(),s):e},s.x=function(a){return arguments.length?(r="function"==typeof a?a:qr(+a),o(),s):r},s}function Bz(r){var t,n,i,e=qr(.1);function s(a){for(var d,l=0,c=t.length;l<c;++l)(d=t[l]).vy+=(i[l]-d.y)*n[l]*a}function o(){if(t){var a,l=t.length;for(n=new Array(l),i=new Array(l),a=0;a<l;++a)n[a]=isNaN(i[a]=+r(t[a],a,t))?0:+e(t[a],a,t)}}return"function"!=typeof r&&(r=qr(null==r?0:+r)),s.initialize=function(a){t=a,o()},s.strength=function(a){return arguments.length?(e="function"==typeof a?a:qr(+a),o(),s):e},s.y=function(a){return arguments.length?(r="function"==typeof a?a:qr(+a),o(),s):r},s}var kz=p(7824);function Gz(r,e,t){var n=new Xy,i=e;return null==e?(n.restart(r,e,t),n):(e=+e,t=null==t?yg():+t,n.restart(function s(o){o+=i,n.restart(s,i+=e,t),r(o)},e,t),n)}const Vz=["linkTemplate"],Hz=["nodeTemplate"],Yz=["clusterTemplate"],Uz=["defsTemplate"],Wz=["miniMapNodeTemplate"],jz=["nodeElement"],zz=["linkElement"];function $z(r,e){1&r&&(tr(),uu(0,14)),2&r&&Wt("ngTemplateOutlet",tn(2).defsTemplate)}function Kz(r,e){if(1&r&&(tr(),Ii(0,"path",15)),2&r){const t=e.$implicit;Xn("d",t.textPath)("id",t.id)}}const oE=function(r){return{$implicit:r}};function Jz(r,e){if(1&r&&(tr(),uu(0,20)),2&r){const t=tn().$implicit;Wt("ngTemplateOutlet",tn(2).clusterTemplate)("ngTemplateOutletContext",Gf(2,oE,t))}}function qz(r,e){if(1&r&&(tr(),Lt(0,"g",21),Ii(1,"rect"),Lt(2,"text",22),Bs(3),$t()()),2&r){const t=tn().$implicit;Qt(1),Xn("width",t.dimension.width)("height",t.dimension.height)("fill",null==t.data?null:t.data.color),Qt(1),Xn("x",10)("y",t.dimension.height/2),Qt(1),Dv(" ",t.label," ")}}function Qz(r,e){if(1&r){const t=hu();tr(),Lt(0,"g",16,17),zi("click",function(){const s=Ts(t).$implicit;return tn(2).onClick(s)}),xn(2,Jz,1,4,"ng-container",18),xn(3,qz,4,6,"g",19),$t()}if(2&r){const t=e.$implicit,n=tn(2);ci("old-node",n.animate&&n.oldClusters.has(t.id)),Wt("id",t.id),Xn("transform",t.transform),Qt(2),Wt("ngIf",n.clusterTemplate),Qt(1),Wt("ngIf",!n.clusterTemplate)}}function Xz(r,e){if(1&r&&(tr(),uu(0,20)),2&r){const t=tn().$implicit;Wt("ngTemplateOutlet",tn(2).linkTemplate)("ngTemplateOutletContext",Gf(2,oE,t))}}function Zz(r,e){1&r&&(tr(),Ii(0,"path",26)),2&r&&Xn("d",tn().$implicit.line)}function e7(r,e){if(1&r&&(tr(),Lt(0,"g",23,24),xn(2,Xz,1,4,"ng-container",18),xn(3,Zz,1,1,"path",25),$t()),2&r){const t=e.$implicit,n=tn(2);Wt("id",t.id),Qt(2),Wt("ngIf",n.linkTemplate),Qt(1),Wt("ngIf",!n.linkTemplate)}}function t7(r,e){if(1&r&&(tr(),uu(0,20)),2&r){const t=tn().$implicit;Wt("ngTemplateOutlet",tn(2).nodeTemplate)("ngTemplateOutletContext",Gf(2,oE,t))}}function n7(r,e){if(1&r&&(tr(),Ii(0,"circle",30)),2&r){const t=tn().$implicit;Xn("cx",t.dimension.width/2)("cy",t.dimension.height/2)("fill",null==t.data?null:t.data.color)}}function r7(r,e){if(1&r){const t=hu();tr(),Lt(0,"g",27,28),zi("click",function(){const s=Ts(t).$implicit;return tn(2).onClick(s)})("mousedown",function(i){const o=Ts(t).$implicit;return tn(2).onNodeMouseDown(i,o)}),xn(2,t7,1,4,"ng-container",18),xn(3,n7,1,3,"circle",29),$t()}if(2&r){const t=e.$implicit,n=tn(2);ci("old-node",n.animate&&n.oldNodes.has(t.id)),Wt("id",t.id),Xn("transform",t.transform),Qt(2),Wt("ngIf",n.nodeTemplate),Qt(1),Wt("ngIf",!n.nodeTemplate)}}function i7(r,e){if(1&r){const t=hu();tr(),Lt(0,"g",4),zi("touchstart",function(i){return Ts(t),tn().onTouchStart(i)})("touchend",function(i){return Ts(t),tn().onTouchEnd(i)}),Lt(1,"defs"),xn(2,$z,1,1,"ng-container",5),xn(3,Kz,1,2,"path",6),$t(),Lt(4,"rect",7),zi("mousedown",function(){return Ts(t),tn().isPanning=!0}),$t(),$i(5),Lt(6,"g",8),xn(7,Qz,4,6,"g",9),$t(),Lt(8,"g",10),xn(9,e7,4,3,"g",11),$t(),Lt(10,"g",12),xn(11,r7,4,6,"g",13),$t()()}if(2&r){const t=tn();Xn("transform",t.transform),Qt(2),Wt("ngIf",t.defsTemplate),Qt(1),Wt("ngForOf",t.graph.edges),Qt(1),Xn("width",100*t.dims.width)("height",100*t.dims.height)("transform","translate("+50*(-t.dims.width||0)+","+50*(-t.dims.height||0)+")"),Qt(3),Wt("ngForOf",t.graph.clusters)("ngForTrackBy",t.trackNodeBy),Qt(2),Wt("ngForOf",t.graph.edges)("ngForTrackBy",t.trackLinkBy),Qt(2),Wt("ngForOf",t.graph.nodes)("ngForTrackBy",t.trackNodeBy)}}function s7(r,e){if(1&r&&(tr(),uu(0,20)),2&r){const t=tn().$implicit;Wt("ngTemplateOutlet",tn(2).miniMapNodeTemplate)("ngTemplateOutletContext",Gf(2,oE,t))}}function o7(r,e){if(1&r&&(tr(),uu(0,20)),2&r){const t=tn().$implicit;Wt("ngTemplateOutlet",tn(2).nodeTemplate)("ngTemplateOutletContext",Gf(2,oE,t))}}function a7(r,e){if(1&r&&(tr(),Ii(0,"circle",30)),2&r){const t=tn().$implicit,n=tn(2);Xn("cx",t.dimension.width/2/n.minimapScaleCoefficient)("cy",t.dimension.height/2/n.minimapScaleCoefficient)("fill",null==t.data?null:t.data.color)}}function l7(r,e){if(1&r&&(tr(),Lt(0,"g",36,28),xn(2,s7,1,4,"ng-container",18),xn(3,o7,1,4,"ng-container",18),xn(4,a7,1,3,"circle",29),$t()),2&r){const t=e.$implicit,n=tn(2);ci("old-node",n.animate&&n.oldNodes.has(t.id)),Wt("id",t.id),Xn("transform",t.transform),Qt(2),Wt("ngIf",n.miniMapNodeTemplate),Qt(1),Wt("ngIf",!n.miniMapNodeTemplate&&n.nodeTemplate),Qt(1),Wt("ngIf",!n.nodeTemplate&&!n.miniMapNodeTemplate)}}function c7(r,e){if(1&r){const t=hu();tr(),Lt(0,"g",31)(1,"rect",32),zi("mousedown",function(i){return Ts(t),tn().onMinimapPanTo(i)}),$t(),Lt(2,"g")(3,"g",33),xn(4,l7,5,7,"g",34),$t(),Lt(5,"rect",35),zi("mousedown",function(){return Ts(t),tn().onMinimapDragMouseDown()}),$t()()()}if(2&r){const t=tn();Xn("transform",t.minimapTransform)("clip-path","url(#"+t.minimapClipPathId+")"),Qt(1),Xn("width",t.graphDims.width/t.minimapScaleCoefficient)("height",t.graphDims.height/t.minimapScaleCoefficient),Qt(1),du("transform","translate("+-t.minimapOffsetX/t.minimapScaleCoefficient+"px,"+-t.minimapOffsetY/t.minimapScaleCoefficient+"px)"),Qt(1),du("transform","scale("+1/t.minimapScaleCoefficient+")"),Qt(1),Wt("ngForOf",t.graph.nodes)("ngForTrackBy",t.trackNodeBy),Qt(1),ci("panning",t.isMinimapPanning),Xn("transform","translate("+t.panOffsetX/t.zoomLevel/-t.minimapScaleCoefficient+","+t.panOffsetY/t.zoomLevel/-t.minimapScaleCoefficient+")")("width",t.width/t.minimapScaleCoefficient/t.zoomLevel)("height",t.height/t.minimapScaleCoefficient/t.zoomLevel)}}const u7=["*"],b1={};function Ac(){let r=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);return r=`a${r}`,b1[r]?Ac():(b1[r]=!0,r)}var bg=(()=>{return(r=bg||(bg={})).Both="both",r.Horizontal="horizontal",r.Vertical="vertical",bg;var r})(),Cg=(()=>{return(r=Cg||(Cg={})).UpperLeft="UpperLeft",r.UpperRight="UpperRight",Cg;var r})();function h7(r,e,t){t=t||{};let n,i,s,o=null,a=0;function l(){a=!1===t.leading?0:+new Date,o=null,s=r.apply(n,i)}return function(){const c=+new Date;!a&&!1===t.leading&&(a=c);const d=e-(c-a);return n=this,i=arguments,d<=0?(clearTimeout(o),o=null,a=c,s=r.apply(n,i)):!o&&!1!==t.trailing&&(o=setTimeout(l,d)),s}}function d7(r,e){return function(n,i,s){return{configurable:!0,enumerable:s.enumerable,get:function(){return Object.defineProperty(this,i,{configurable:!0,enumerable:s.enumerable,value:h7(s.value,r,e)}),this[i]}}}}let C1=[{name:"vivid",selectable:!0,group:"Ordinal",domain:["#647c8a","#3f51b5","#2196f3","#00b862","#afdf0a","#a7b61a","#f3e562","#ff9800","#ff5722","#ff4514"]},{name:"natural",selectable:!0,group:"Ordinal",domain:["#bf9d76","#e99450","#d89f59","#f2dfa7","#a5d7c6","#7794b1","#afafaf","#707160","#ba9383","#d9d5c3"]},{name:"cool",selectable:!0,group:"Ordinal",domain:["#a8385d","#7aa3e5","#a27ea8","#aae3f5","#adcded","#a95963","#8796c0","#7ed3ed","#50abcc","#ad6886"]},{name:"fire",selectable:!0,group:"Ordinal",domain:["#ff3d00","#bf360c","#ff8f00","#ff6f00","#ff5722","#e65100","#ffca28","#ffab00"]},{name:"solar",selectable:!0,group:"Continuous",domain:["#fff8e1","#ffecb3","#ffe082","#ffd54f","#ffca28","#ffc107","#ffb300","#ffa000","#ff8f00","#ff6f00"]},{name:"air",selectable:!0,group:"Continuous",domain:["#e1f5fe","#b3e5fc","#81d4fa","#4fc3f7","#29b6f6","#03a9f4","#039be5","#0288d1","#0277bd","#01579b"]},{name:"aqua",selectable:!0,group:"Continuous",domain:["#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00bcd4","#00acc1","#0097a7","#00838f","#006064"]},{name:"flame",selectable:!1,group:"Ordinal",domain:["#A10A28","#D3342D","#EF6D49","#FAAD67","#FDDE90","#DBED91","#A9D770","#6CBA67","#2C9653","#146738"]},{name:"ocean",selectable:!1,group:"Ordinal",domain:["#1D68FB","#33C0FC","#4AFFFE","#AFFFFF","#FFFC63","#FDBD2D","#FC8A25","#FA4F1E","#FA141B","#BA38D1"]},{name:"forest",selectable:!1,group:"Ordinal",domain:["#55C22D","#C1F33D","#3CC099","#AFFFFF","#8CFC9D","#76CFFA","#BA60FB","#EE6490","#C42A1C","#FC9F32"]},{name:"horizon",selectable:!1,group:"Ordinal",domain:["#2597FB","#65EBFD","#99FDD0","#FCEE4B","#FEFCFA","#FDD6E3","#FCB1A8","#EF6F7B","#CB96E8","#EFDEE0"]},{name:"neons",selectable:!1,group:"Ordinal",domain:["#FF3333","#FF33FF","#CC33FF","#0000FF","#33CCFF","#33FFFF","#33FF66","#CCFF33","#FFCC00","#FF6600"]},{name:"picnic",selectable:!1,group:"Ordinal",domain:["#FAC51D","#66BD6D","#FAA026","#29BB9C","#E96B56","#55ACD2","#B7332F","#2C83C9","#9166B8","#92E7E8"]},{name:"night",selectable:!1,group:"Ordinal",domain:["#2B1B5A","#501356","#183356","#28203F","#391B3C","#1E2B3C","#120634","#2D0432","#051932","#453080","#75267D","#2C507D","#4B3880","#752F7D","#35547D"]},{name:"nightLights",selectable:!1,group:"Ordinal",domain:["#4e31a5","#9c25a7","#3065ab","#57468b","#904497","#46648b","#32118d","#a00fb3","#1052a2","#6e51bd","#b63cc3","#6c97cb","#8671c1","#b455be","#7496c3"]}];class f7{constructor(e,t,n){"string"==typeof e&&(e=C1.find(i=>i.name===e)),this.colorDomain=e.domain,this.domain=t,this.customColors=n,this.scale=this.generateColorScheme(e,this.domain)}generateColorScheme(e,t){return"string"==typeof e&&(e=C1.find(n=>n.name===e)),d1().range(e.domain).domain(t)}getColor(e){if(null==e)throw new Error("Value can not be null");if("function"==typeof this.customColors)return this.customColors(e);const t=e.toString();let n;return this.customColors&&this.customColors.length>0&&(n=this.customColors.find(i=>i.name.toLowerCase()===t.toLowerCase())),n?n.value:this.scale(e)}}let p7=(()=>{class r{constructor(t,n){this.element=t,this.zone=n,this.visible=new Gn,this.isVisible=!1,this.runCheck()}destroy(){clearTimeout(this.timeout)}onVisibilityChange(){this.zone.run(()=>{this.isVisible=!0,this.visible.emit(!0)})}runCheck(){const t=()=>{if(!this.element)return;const{offsetHeight:n,offsetWidth:i}=this.element.nativeElement;n&&i?(clearTimeout(this.timeout),this.onVisibilityChange()):(clearTimeout(this.timeout),this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>t(),100)}))};this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>t())})}}return r.\u0275fac=function(t){return new(t||r)(Ue(Dr),Ue(vn))},r.\u0275dir=Mn({type:r,selectors:[["visibility-observer"]],outputs:{visible:"visible"}}),r})();var Rg=(()=>{return(r=Rg||(Rg={})).LEFT_TO_RIGHT="LR",r.RIGHT_TO_LEFT="RL",r.TOP_TO_BOTTOM="TB",r.BOTTOM_TO_TOM="BT",Rg;var r})();function Tg(r){return"string"==typeof r?{id:r,x:0,y:0}:r}function T1(r,e){return"number"==typeof e?r[e]:e}const O1={dagre:class m7{constructor(){this.defaultSettings={orientation:Rg.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}run(e){this.createDagreGraph(e),Ag.layout(this.dagreGraph),e.edgeLabels=this.dagreGraph._edgeLabels;for(const t in this.dagreGraph._nodes){const n=this.dagreGraph._nodes[t],i=e.nodes.find(s=>s.id===n.id);i.position={x:n.x,y:n.y},i.dimension={width:n.width,height:n.height}}return e}updateEdge(e,t){const n=e.nodes.find(l=>l.id===t.source),i=e.nodes.find(l=>l.id===t.target),s=n.position.y<=i.position.y?-1:1;return t.points=[{x:n.position.x,y:n.position.y-s*(n.dimension.height/2)},{x:i.position.x,y:i.position.y+s*(i.dimension.height/2)}],e}createDagreGraph(e){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new Ag.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=e.nodes.map(n=>{const i=Object.assign({},n);return i.width=n.dimension.width,i.height=n.dimension.height,i.x=n.position.x,i.y=n.position.y,i}),this.dagreEdges=e.edges.map(n=>{const i=Object.assign({},n);return i.id||(i.id=Ac()),i});for(const n of this.dagreNodes)n.width||(n.width=20),n.height||(n.height=30),this.dagreGraph.setNode(n.id,n);for(const n of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(n.source,n.target,n,n.id):this.dagreGraph.setEdge(n.source,n.target);return this.dagreGraph}},dagreCluster:class y7{constructor(){this.defaultSettings={orientation:Rg.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}run(e){this.createDagreGraph(e),Ag.layout(this.dagreGraph),e.edgeLabels=this.dagreGraph._edgeLabels;const t=n=>{const i=this.dagreGraph._nodes[n.id];return Object.assign(Object.assign({},n),{position:{x:i.x,y:i.y},dimension:{width:i.width,height:i.height}})};return e.clusters=(e.clusters||[]).map(t),e.nodes=e.nodes.map(t),e}updateEdge(e,t){const n=e.nodes.find(l=>l.id===t.source),i=e.nodes.find(l=>l.id===t.target),s=n.position.y<=i.position.y?-1:1;return t.points=[{x:n.position.x,y:n.position.y-s*(n.dimension.height/2)},{x:i.position.x,y:i.position.y+s*(i.dimension.height/2)}],e}createDagreGraph(e){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new Ag.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=e.nodes.map(n=>{const i=Object.assign({},n);return i.width=n.dimension.width,i.height=n.dimension.height,i.x=n.position.x,i.y=n.position.y,i}),this.dagreClusters=e.clusters||[],this.dagreEdges=e.edges.map(n=>{const i=Object.assign({},n);return i.id||(i.id=Ac()),i});for(const n of this.dagreNodes)this.dagreGraph.setNode(n.id,n);for(const n of this.dagreClusters)this.dagreGraph.setNode(n.id,n),n.childNodeIds.forEach(i=>{this.dagreGraph.setParent(i,n.id)});for(const n of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(n.source,n.target,n,n.id):this.dagreGraph.setEdge(n.source,n.target);return this.dagreGraph}},dagreNodesOnly:class w7{constructor(){this.defaultSettings={orientation:Rg.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,curveDistance:20,multigraph:!0,compound:!0},this.settings={}}run(e){this.createDagreGraph(e),Ag.layout(this.dagreGraph),e.edgeLabels=this.dagreGraph._edgeLabels;for(const t in this.dagreGraph._nodes){const n=this.dagreGraph._nodes[t],i=e.nodes.find(s=>s.id===n.id);i.position={x:n.x,y:n.y},i.dimension={width:n.width,height:n.height}}for(const t of e.edges)this.updateEdge(e,t);return e}updateEdge(e,t){const n=e.nodes.find(G=>G.id===t.source),i=e.nodes.find(G=>G.id===t.target),s="BT"===this.settings.orientation||"TB"===this.settings.orientation?"y":"x",o="y"===s?"x":"y",a="y"===s?"height":"width",l=n.position[s]<=i.position[s]?-1:1,c={[o]:n.position[o],[s]:n.position[s]-l*(n.dimension[a]/2)},d={[o]:i.position[o],[s]:i.position[s]+l*(i.dimension[a]/2)},b=this.settings.curveDistance||this.defaultSettings.curveDistance;t.points=[c,{[o]:c[o],[s]:c[s]-l*b},{[o]:d[o],[s]:d[s]+l*b},d];const F=e.edgeLabels[`${t.source}\x01${t.target}\x01\0`];return F&&(F.points=t.points),e}createDagreGraph(e){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new Ag.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=e.nodes.map(n=>{const i=Object.assign({},n);return i.width=n.dimension.width,i.height=n.dimension.height,i.x=n.position.x,i.y=n.position.y,i}),this.dagreEdges=e.edges.map(n=>{const i=Object.assign({},n);return i.id||(i.id=Ac()),i});for(const n of this.dagreNodes)n.width||(n.width=20),n.height||(n.height=30),this.dagreGraph.setNode(n.id,n);for(const n of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(n.source,n.target,n,n.id):this.dagreGraph.setEdge(n.source,n.target);return this.dagreGraph}},d3ForceDirected:class v7{constructor(){this.defaultSettings={force:S1().force("charge",A1().strength(-150)).force("collide",p1(5)),forceLink:v1().id(e=>e.id).distance(()=>100)},this.settings={},this.outputGraph$=new ke}run(e){return this.inputGraph=e,this.d3Graph={nodes:[...this.inputGraph.nodes.map(t=>Object.assign({},t))],edges:[...this.inputGraph.edges.map(t=>Object.assign({},t))]},this.outputGraph={nodes:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&this.settings.force.nodes(this.d3Graph.nodes).force("link",this.settings.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",()=>{this.outputGraph$.next(this.d3GraphToOutputGraph(this.d3Graph))}),this.outputGraph$.asObservable()}updateEdge(e,t){const n=Object.assign({},this.defaultSettings,this.settings);return n.force&&n.force.nodes(this.d3Graph.nodes).force("link",n.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",()=>{this.outputGraph$.next(this.d3GraphToOutputGraph(this.d3Graph))}),this.outputGraph$.asObservable()}d3GraphToOutputGraph(e){return this.outputGraph.nodes=this.d3Graph.nodes.map(t=>Object.assign(Object.assign({},t),{id:t.id||Ac(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:`translate(${t.x-(t.dimension&&t.dimension.width||20)/2||0}, ${t.y-(t.dimension&&t.dimension.height||20)/2||0})`})),this.outputGraph.edges=this.d3Graph.edges.map(t=>Object.assign(Object.assign({},t),{source:Tg(t.source).id,target:Tg(t.target).id,points:[{x:Tg(t.source).x,y:Tg(t.source).y},{x:Tg(t.target).x,y:Tg(t.target).y}]})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph}onDragStart(e,t){this.settings.force.alphaTarget(.3).restart();const n=this.d3Graph.nodes.find(i=>i.id===e.id);!n||(this.draggingStart={x:t.x-n.x,y:t.y-n.y},n.fx=t.x-this.draggingStart.x,n.fy=t.y-this.draggingStart.y)}onDrag(e,t){if(!e)return;const n=this.d3Graph.nodes.find(i=>i.id===e.id);!n||(n.fx=t.x-this.draggingStart.x,n.fy=t.y-this.draggingStart.y)}onDragEnd(e,t){if(!e)return;const n=this.d3Graph.nodes.find(i=>i.id===e.id);!n||(this.settings.force.alphaTarget(0),n.fx=void 0,n.fy=void 0)}},colaForceDirected:class S7{constructor(){this.defaultSettings={force:(0,kz.d3adaptor)(Object.assign(Object.assign(Object.assign({},S),E),O)).linkDistance(150).avoidOverlaps(!0),viewDimensions:{width:600,height:600}},this.settings={},this.outputGraph$=new ke}run(e){return this.inputGraph=e,this.inputGraph.clusters||(this.inputGraph.clusters=[]),this.internalGraph={nodes:[...this.inputGraph.nodes.map(t=>Object.assign(Object.assign({},t),{width:t.dimension?t.dimension.width:20,height:t.dimension?t.dimension.height:20}))],groups:[...this.inputGraph.clusters.map(t=>({padding:5,groups:t.childNodeIds.map(n=>this.inputGraph.clusters.findIndex(i=>i.id===n)).filter(n=>n>=0),leaves:t.childNodeIds.map(n=>this.inputGraph.nodes.findIndex(i=>i.id===n)).filter(n=>n>=0)}))],links:[...this.inputGraph.edges.map(t=>{const n=this.inputGraph.nodes.findIndex(s=>t.source===s.id),i=this.inputGraph.nodes.findIndex(s=>t.target===s.id);if(-1!==n&&-1!==i)return Object.assign(Object.assign({},t),{source:n,target:i})}).filter(t=>!!t)],groupLinks:[...this.inputGraph.edges.map(t=>{const n=this.inputGraph.nodes.findIndex(s=>t.source===s.id),i=this.inputGraph.nodes.findIndex(s=>t.target===s.id);if(!(n>=0&&i>=0))return t}).filter(t=>!!t)]},this.outputGraph={nodes:[],clusters:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&(this.settings.force=this.settings.force.nodes(this.internalGraph.nodes).groups(this.internalGraph.groups).links(this.internalGraph.links).alpha(.5).on("tick",()=>{this.settings.onTickListener&&this.settings.onTickListener(this.internalGraph),this.outputGraph$.next(this.internalGraphToOutputGraph(this.internalGraph))}),this.settings.viewDimensions&&(this.settings.force=this.settings.force.size([this.settings.viewDimensions.width,this.settings.viewDimensions.height])),this.settings.forceModifierFn&&(this.settings.force=this.settings.forceModifierFn(this.settings.force)),this.settings.force.start()),this.outputGraph$.asObservable()}updateEdge(e,t){const n=Object.assign({},this.defaultSettings,this.settings);return n.force&&n.force.start(),this.outputGraph$.asObservable()}internalGraphToOutputGraph(e){return this.outputGraph.nodes=e.nodes.map(t=>Object.assign(Object.assign({},t),{id:t.id||Ac(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:`translate(${t.x-(t.dimension&&t.dimension.width||20)/2||0}, ${t.y-(t.dimension&&t.dimension.height||20)/2||0})`})),this.outputGraph.edges=e.links.map(t=>{const n=T1(e.nodes,t.source),i=T1(e.nodes,t.target);return Object.assign(Object.assign({},t),{source:n.id,target:i.id,points:[n.bounds.rayIntersection(i.bounds.cx(),i.bounds.cy()),i.bounds.rayIntersection(n.bounds.cx(),n.bounds.cy())]})}).concat(e.groupLinks.map(t=>{const n=e.nodes.find(a=>a.id===t.source),i=e.nodes.find(a=>a.id===t.target),s=n||e.groups.find(a=>a.id===t.source),o=i||e.groups.find(a=>a.id===t.target);return Object.assign(Object.assign({},t),{source:s.id,target:o.id,points:[s.bounds.rayIntersection(o.bounds.cx(),o.bounds.cy()),o.bounds.rayIntersection(s.bounds.cx(),s.bounds.cy())]})})),this.outputGraph.clusters=e.groups.map((t,n)=>Object.assign(Object.assign({},this.inputGraph.clusters[n]),{dimension:{width:t.bounds?t.bounds.width():20,height:t.bounds?t.bounds.height():20},position:{x:t.bounds?t.bounds.x+t.bounds.width()/2:0,y:t.bounds?t.bounds.y+t.bounds.height()/2:0}})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph}onDragStart(e,t){const n=this.outputGraph.nodes.findIndex(s=>s.id===e.id),i=this.internalGraph.nodes[n];!i||(this.draggingStart={x:i.x-t.x,y:i.y-t.y},i.fixed=1,this.settings.force.start())}onDrag(e,t){if(!e)return;const n=this.outputGraph.nodes.findIndex(s=>s.id===e.id),i=this.internalGraph.nodes[n];!i||(i.x=this.draggingStart.x+t.x,i.y=this.draggingStart.y+t.y)}onDragEnd(e,t){if(!e)return;const n=this.outputGraph.nodes.findIndex(s=>s.id===e.id),i=this.internalGraph.nodes[n];!i||(i.fixed=0)}}};let I1=(()=>{class r{getLayout(t){if(O1[t])return new O1[t];throw new Error(`Unknown layout type '${t}'`)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),A7=(()=>{class r{constructor(){this.mouseWheelUp=new Gn,this.mouseWheelDown=new Gn}onMouseWheelChrome(t){this.mouseWheelFunc(t)}onMouseWheelFirefox(t){this.mouseWheelFunc(t)}onWheel(t){this.mouseWheelFunc(t)}onMouseWheelIE(t){this.mouseWheelFunc(t)}mouseWheelFunc(t){window.event&&(t=window.event);const n=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail||t.deltaY||t.deltaX)),s=t.wheelDelta?n<0:n>0;(t.wheelDelta?n>0:n<0)?this.mouseWheelUp.emit(t):s&&this.mouseWheelDown.emit(t),t.returnValue=!1,t.preventDefault&&t.preventDefault()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=Mn({type:r,selectors:[["","mouseWheel",""]],hostBindings:function(t,n){1&t&&zi("mousewheel",function(s){return n.onMouseWheelChrome(s)})("DOMMouseScroll",function(s){return n.onMouseWheelFirefox(s)})("wheel",function(s){return n.onWheel(s)})("onmousewheel",function(s){return n.onMouseWheelIE(s)})},outputs:{mouseWheelUp:"mouseWheelUp",mouseWheelDown:"mouseWheelDown"}}),r})(),b7=(()=>{class r{constructor(t,n,i,s){this.el=t,this.zone=n,this.cd=i,this.layoutService=s,this.nodes=[],this.clusters=[],this.links=[],this.activeEntries=[],this.draggingEnabled=!0,this.panningEnabled=!0,this.panningAxis=bg.Both,this.enableZoom=!0,this.zoomSpeed=.1,this.minZoomLevel=.1,this.maxZoomLevel=4,this.autoZoom=!1,this.panOnZoom=!0,this.animate=!1,this.autoCenter=!1,this.enableTrackpadSupport=!1,this.showMiniMap=!1,this.miniMapMaxWidth=100,this.miniMapPosition=Cg.UpperRight,this.scheme="cool",this.animations=!0,this.select=new Gn,this.activate=new Gn,this.deactivate=new Gn,this.zoomChange=new Gn,this.clickHandler=new Gn,this.isMouseMoveCalled=!1,this.graphSubscription=new m,this.subscriptions=[],this.isPanning=!1,this.isDragging=!1,this.initialized=!1,this.graphDims={width:0,height:0},this._oldLinks=[],this.oldNodes=new Set,this.oldClusters=new Set,this.transformationMatrix={a:1,c:0,e:0,b:0,d:1,f:0},this._touchLastX=null,this._touchLastY=null,this.minimapScaleCoefficient=3,this.minimapOffsetX=0,this.minimapOffsetY=0,this.isMinimapPanning=!1,this.groupResultsBy=o=>o.label}get zoomLevel(){return this.transformationMatrix.a}set zoomLevel(t){this.zoomTo(Number(t))}get panOffsetX(){return this.transformationMatrix.e}set panOffsetX(t){this.panTo(Number(t),null)}get panOffsetY(){return this.transformationMatrix.f}set panOffsetY(t){this.panTo(null,Number(t))}ngOnInit(){this.update$&&this.subscriptions.push(this.update$.subscribe(()=>{this.update()})),this.center$&&this.subscriptions.push(this.center$.subscribe(()=>{this.center()})),this.zoomToFit$&&this.subscriptions.push(this.zoomToFit$.subscribe(()=>{this.zoomToFit()})),this.panToNode$&&this.subscriptions.push(this.panToNode$.subscribe(t=>{this.panToNodeId(t)})),this.minimapClipPathId=`minimapClip${Ac()}`}ngOnChanges(t){this.basicUpdate();const{layoutSettings:i}=t;this.setLayout(this.layout),i&&this.setLayoutSettings(this.layoutSettings),this.update()}setLayout(t){this.initialized=!1,t||(t="dagre"),"string"==typeof t&&(this.layout=this.layoutService.getLayout(t),this.setLayoutSettings(this.layoutSettings))}setLayoutSettings(t){this.layout&&"string"!=typeof this.layout&&(this.layout.settings=t)}ngOnDestroy(){this.unbindEvents(),this.visibilityObserver&&(this.visibilityObserver.visible.unsubscribe(),this.visibilityObserver.destroy());for(const t of this.subscriptions)t.unsubscribe();this.subscriptions=null}ngAfterViewInit(){this.bindWindowResizeEvent(),this.visibilityObserver=new p7(this.el,this.zone),this.visibilityObserver.visible.subscribe(this.update.bind(this)),setTimeout(()=>this.update())}update(){this.basicUpdate(),this.curve||(this.curve=Z8.beta(1)),this.zone.run(()=>{this.dims=function g7({width:r,height:e}){let t=r,n=e;return t=Math.max(0,t),n=Math.max(0,n),{width:Math.floor(t),height:Math.floor(n)}}({width:this.width,height:this.height}),this.seriesDomain=this.getSeriesDomain(),this.setColors(),this.createGraph(),this.updateTransform(),this.initialized=!0})}createGraph(){this.graphSubscription.unsubscribe(),this.graphSubscription=new m;const t=n=>(n.meta||(n.meta={}),n.id||(n.id=Ac()),n.dimension?n.meta.forceDimensions=void 0===n.meta.forceDimensions||n.meta.forceDimensions:(n.dimension={width:this.nodeWidth?this.nodeWidth:30,height:this.nodeHeight?this.nodeHeight:30},n.meta.forceDimensions=!1),n.position={x:0,y:0},n.data=n.data?n.data:{},n);this.graph={nodes:this.nodes.length>0?[...this.nodes].map(t):[],clusters:this.clusters&&this.clusters.length>0?[...this.clusters].map(t):[],edges:this.links.length>0?[...this.links].map(n=>(n.id||(n.id=Ac()),n)):[]},requestAnimationFrame(()=>this.draw())}draw(){if(!this.layout||"string"==typeof this.layout)return;this.applyNodeDimensions();const t=this.layout.run(this.graph),n=t instanceof ee?t:Tt(t);this.graphSubscription.add(n.subscribe(i=>{this.graph=i,this.tick()})),0!==this.graph.nodes.length&&n.pipe(zh()).subscribe(()=>this.applyNodeDimensions())}tick(){const t=new Set;this.graph.nodes.map(s=>{s.transform=`translate(${s.position.x-s.dimension.width/2||0}, ${s.position.y-s.dimension.height/2||0})`,s.data||(s.data={}),s.data.color=this.colors.getColor(this.groupResultsBy(s)),t.add(s.id)});const n=new Set;(this.graph.clusters||[]).map(s=>{s.transform=`translate(${s.position.x-s.dimension.width/2||0}, ${s.position.y-s.dimension.height/2||0})`,s.data||(s.data={}),s.data.color=this.colors.getColor(this.groupResultsBy(s)),n.add(s.id)}),setTimeout(()=>{this.oldNodes=t,this.oldClusters=n},500);const i=[];for(const s in this.graph.edgeLabels){const o=this.graph.edgeLabels[s],a=s.replace(/[^\w-]*/g,""),l=this.layout&&"string"!=typeof this.layout&&this.layout.settings&&this.layout.settings.multigraph;let c=this._oldLinks.find(l?W=>`${W.source}${W.target}${W.id}`===a:W=>`${W.source}${W.target}`===a);const d=this.graph.edges.find(l?W=>`${W.source}${W.target}${W.id}`===a:W=>`${W.source}${W.target}`===a);c?c.data&&d&&d.data&&JSON.stringify(c.data)!==JSON.stringify(d.data)&&(c.data=d.data):c=d||o,c.oldLine=c.line;const b=o.points,N=this.generateLine(b),F=Object.assign({},c);F.line=N,F.points=b,this.updateMidpointOnEdge(F,b);const G=b[Math.floor(b.length/2)];G&&(F.textTransform=`translate(${G.x||0},${G.y||0})`),F.textAngle=0,F.oldLine||(F.oldLine=F.line),this.calcDominantBaseline(F),i.push(F)}this.graph.edges=i,this.graph.edges&&(this._oldLinks=this.graph.edges.map(s=>{const o=Object.assign({},s);return o.oldLine=s.line,o})),this.updateMinimap(),this.autoZoom&&this.zoomToFit(),this.autoCenter&&this.center(),requestAnimationFrame(()=>this.redrawLines()),this.cd.markForCheck()}getMinimapTransform(){switch(this.miniMapPosition){case Cg.UpperLeft:return"";case Cg.UpperRight:return"translate("+(this.dims.width-this.graphDims.width/this.minimapScaleCoefficient)+",0)";default:return""}}updateGraphDims(){let t=1/0,n=-1/0,i=1/0,s=-1/0;for(let o=0;o<this.graph.nodes.length;o++){const a=this.graph.nodes[o];t=a.position.x<t?a.position.x:t,i=a.position.y<i?a.position.y:i,n=a.position.x+a.dimension.width>n?a.position.x+a.dimension.width:n,s=a.position.y+a.dimension.height>s?a.position.y+a.dimension.height:s}t-=100,i-=100,n+=100,s+=100,this.graphDims.width=n-t,this.graphDims.height=s-i,this.minimapOffsetX=t,this.minimapOffsetY=i}updateMinimap(){this.graph.nodes&&this.graph.nodes.length&&(this.updateGraphDims(),this.miniMapMaxWidth&&(this.minimapScaleCoefficient=this.graphDims.width/this.miniMapMaxWidth),this.miniMapMaxHeight&&(this.minimapScaleCoefficient=Math.max(this.minimapScaleCoefficient,this.graphDims.height/this.miniMapMaxHeight)),this.minimapTransform=this.getMinimapTransform())}applyNodeDimensions(){this.nodeElements&&this.nodeElements.length&&this.nodeElements.map(t=>{const n=t.nativeElement,i=this.graph.nodes.find(o=>o.id===n.id);if(!i)return;let s;try{if(s=n.getBBox(),!s.width||!s.height)return}catch(o){return}if(i.dimension.height=this.nodeHeight?i.dimension.height&&i.meta.forceDimensions?i.dimension.height:this.nodeHeight:i.dimension.height&&i.meta.forceDimensions?i.dimension.height:s.height,this.nodeMaxHeight&&(i.dimension.height=Math.max(i.dimension.height,this.nodeMaxHeight)),this.nodeMinHeight&&(i.dimension.height=Math.min(i.dimension.height,this.nodeMinHeight)),this.nodeWidth)i.dimension.width=i.dimension.width&&i.meta.forceDimensions?i.dimension.width:this.nodeWidth;else if(n.getElementsByTagName("text").length){let o;try{for(const a of n.getElementsByTagName("text")){const l=a.getBBox();o?(l.width>o.width&&(o.width=l.width),l.height>o.height&&(o.height=l.height)):o=l}}catch(a){return}i.dimension.width=i.dimension.width&&i.meta.forceDimensions?i.dimension.width:o.width+20}else i.dimension.width=i.dimension.width&&i.meta.forceDimensions?i.dimension.width:s.width;this.nodeMaxWidth&&(i.dimension.width=Math.max(i.dimension.width,this.nodeMaxWidth)),this.nodeMinWidth&&(i.dimension.width=Math.min(i.dimension.width,this.nodeMinWidth))})}redrawLines(t=this.animate){this.linkElements.map(n=>{const i=this.graph.edges.find(s=>s.id===n.nativeElement.id);i&&(mM(n.nativeElement).select(".line").attr("d",i.oldLine).transition().ease(AM).duration(t?500:0).attr("d",i.line),mM(this.el.nativeElement).select(`#${i.id}`).attr("d",i.oldTextPath).transition().ease(AM).duration(t?500:0).attr("d",i.textPath),this.updateMidpointOnEdge(i,i.points))})}calcDominantBaseline(t){const n=t.points[0],i=t.points[t.points.length-1];t.oldTextPath=t.textPath,i.x<n.x?(t.dominantBaseline="text-before-edge",t.textPath=this.generateLine([...t.points].reverse())):(t.dominantBaseline="text-after-edge",t.textPath=t.line)}generateLine(t){return function sj(){var r=rj,e=ij,t=aA(!0),n=null,i=nj,s=null;function o(a){var l,d,N,c=a.length,b=!1;for(null==n&&(s=i(N=tj())),l=0;l<=c;++l)!(l<c&&t(d=a[l],l,a))===b&&((b=!b)?s.lineStart():s.lineEnd()),b&&s.point(+r(d,l,a),+e(d,l,a));if(N)return s=null,N+""||null}return o.x=function(a){return arguments.length?(r="function"==typeof a?a:aA(+a),o):r},o.y=function(a){return arguments.length?(e="function"==typeof a?a:aA(+a),o):e},o.defined=function(a){return arguments.length?(t="function"==typeof a?a:aA(!!a),o):t},o.curve=function(a){return arguments.length?(i=a,null!=n&&(s=i(n)),o):i},o.context=function(a){return arguments.length?(null==a?n=s=null:s=i(n=a),o):n},o}().x(i=>i.x).y(i=>i.y).curve(this.curve)(t)}onZoom(t,n){if(this.enableTrackpadSupport&&!t.ctrlKey)return void this.pan(-1*t.deltaX,-1*t.deltaY);const i=1+("in"===n?this.zoomSpeed:-this.zoomSpeed),s=this.zoomLevel*i;if(!(s<=this.minZoomLevel||s>=this.maxZoomLevel)&&this.enableZoom)if(!0===this.panOnZoom&&t){const o=t.clientX,a=t.clientY,l=this.el.nativeElement.querySelector("svg"),c=l.querySelector("g.chart"),d=l.createSVGPoint();d.x=o,d.y=a;const b=d.matrixTransform(c.getScreenCTM().inverse());this.pan(b.x,b.y,!0),this.zoom(i),this.pan(-b.x,-b.y,!0)}else this.zoom(i)}pan(t,n,i=!1){const s=i?1:this.zoomLevel;this.transformationMatrix=sE(this.transformationMatrix,o1(t/s,n/s)),this.updateTransform()}panTo(t,n){null==t||isNaN(t)||null==n||isNaN(n)||(this.transformationMatrix=sE(this.transformationMatrix,o1((-this.panOffsetX-t*this.zoomLevel+this.dims.width/2)/this.zoomLevel,(-this.panOffsetY-n*this.zoomLevel+this.dims.height/2)/this.zoomLevel)),this.updateTransform())}zoom(t){this.transformationMatrix=sE(this.transformationMatrix,function tz(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return ez(e)&&(e=r),{a:r,c:0,e:0,b:0,d:e,f:0}}(t,t)),this.zoomChange.emit(this.zoomLevel),this.updateTransform()}zoomTo(t){this.transformationMatrix.a=isNaN(t)?this.transformationMatrix.a:Number(t),this.transformationMatrix.d=isNaN(t)?this.transformationMatrix.d:Number(t),this.zoomChange.emit(this.zoomLevel),this.updateTransform(),this.update()}onDrag(t){if(!this.draggingEnabled)return;const n=this.draggingNode;this.layout&&"string"!=typeof this.layout&&this.layout.onDrag&&this.layout.onDrag(n,t),n.position.x+=t.movementX/this.zoomLevel,n.position.y+=t.movementY/this.zoomLevel,n.transform=`translate(${n.position.x-n.dimension.width/2}, ${n.position.y-n.dimension.height/2})`;for(const o of this.graph.edges)if((o.target===n.id||o.source===n.id||o.target.id===n.id||o.source.id===n.id)&&this.layout&&"string"!=typeof this.layout){const a=this.layout.updateEdge(this.graph,o),l=a instanceof ee?a:Tt(a);this.graphSubscription.add(l.subscribe(c=>{this.graph=c,this.redrawEdge(o)}))}this.redrawLines(!1),this.updateMinimap()}redrawEdge(t){const n=this.generateLine(t.points);this.calcDominantBaseline(t),t.oldLine=t.line,t.line=n}updateTransform(){this.transform=function rz(r){return function s1(r){return"matrix("+r.a+","+r.b+","+r.c+","+r.d+","+r.e+","+r.f+")"}(r)}(function oz(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return{a:Math.round(r.a*e)/e,b:Math.round(r.b*e)/e,c:Math.round(r.c*e)/e,d:Math.round(r.d*e)/e,e:Math.round(r.e*e)/e,f:Math.round(r.f*e)/e}}(this.transformationMatrix,100))}onClick(t){this.select.emit(t)}onActivate(t){this.activeEntries.indexOf(t)>-1||(this.activeEntries=[t,...this.activeEntries],this.activate.emit({value:t,entries:this.activeEntries}))}onDeactivate(t){const n=this.activeEntries.indexOf(t);this.activeEntries.splice(n,1),this.activeEntries=[...this.activeEntries],this.deactivate.emit({value:t,entries:this.activeEntries})}getSeriesDomain(){return this.nodes.map(t=>this.groupResultsBy(t)).reduce((t,n)=>-1!==t.indexOf(n)?t:t.concat([n]),[]).sort()}trackLinkBy(t,n){return n.id}trackNodeBy(t,n){return n.id}setColors(){this.colors=new f7(this.scheme,this.seriesDomain,this.customColors)}onMouseMove(t){this.isMouseMoveCalled=!0,(this.isPanning||this.isMinimapPanning)&&this.panningEnabled?this.panWithConstraints(this.panningAxis,t):this.isDragging&&this.draggingEnabled&&this.onDrag(t)}onMouseDown(t){this.isMouseMoveCalled=!1}graphClick(t){this.isMouseMoveCalled||this.clickHandler.emit(t)}onTouchStart(t){this._touchLastX=t.changedTouches[0].clientX,this._touchLastY=t.changedTouches[0].clientY,this.isPanning=!0}onTouchMove(t){if(this.isPanning&&this.panningEnabled){const n=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY,s=n-this._touchLastX,o=i-this._touchLastY;this._touchLastX=n,this._touchLastY=i,this.pan(s,o)}}onTouchEnd(t){this.isPanning=!1}onMouseUp(t){this.isDragging=!1,this.isPanning=!1,this.isMinimapPanning=!1,this.layout&&"string"!=typeof this.layout&&this.layout.onDragEnd&&this.layout.onDragEnd(this.draggingNode,t)}onNodeMouseDown(t,n){!this.draggingEnabled||(this.isDragging=!0,this.draggingNode=n,this.layout&&"string"!=typeof this.layout&&this.layout.onDragStart&&this.layout.onDragStart(n,t))}onMinimapDragMouseDown(){this.isMinimapPanning=!0}onMinimapPanTo(t){this.panTo((t.offsetX-(this.dims.width-(this.graphDims.width+this.minimapOffsetX)/this.minimapScaleCoefficient))*this.minimapScaleCoefficient,(t.offsetY+this.minimapOffsetY/this.minimapScaleCoefficient)*this.minimapScaleCoefficient),this.isMinimapPanning=!0}center(){this.panTo(this.graphDims.width/2,this.graphDims.height/2)}zoomToFit(){let i=Math.min(this.dims.height/this.graphDims.height,this.dims.width/this.graphDims.width,1);i<this.minZoomLevel&&(i=this.minZoomLevel),i>this.maxZoomLevel&&(i=this.maxZoomLevel),i!==this.zoomLevel&&(this.zoomLevel=i,this.updateTransform(),this.zoomChange.emit(this.zoomLevel))}panToNodeId(t){const n=this.graph.nodes.find(i=>i.id===t);!n||this.panTo(n.position.x,n.position.y)}panWithConstraints(t,n){let i=n.movementX,s=n.movementY;switch(this.isMinimapPanning&&(i=-this.minimapScaleCoefficient*i*this.zoomLevel,s=-this.minimapScaleCoefficient*s*this.zoomLevel),t){case bg.Horizontal:this.pan(i,0);break;case bg.Vertical:this.pan(0,s);break;default:this.pan(i,s)}}updateMidpointOnEdge(t,n){if(t&&n)if(n.length%2==1)t.midPoint=n[Math.floor(n.length/2)];else{const i=n[n.length/2],s=n[n.length/2-1];t.midPoint={x:(i.x+s.x)/2,y:(i.y+s.y)/2}}}basicUpdate(){if(this.view)this.width=this.view[0],this.height=this.view[1];else{const t=this.getContainerDims();t&&(this.width=t.width,this.height=t.height)}this.width||(this.width=600),this.height||(this.height=400),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this.cd&&this.cd.markForCheck()}getContainerDims(){let t,n;const i=this.el.nativeElement;if(null!==i.parentNode){const s=i.parentNode.getBoundingClientRect();t=s.width,n=s.height}return t&&n?{width:t,height:n}:null}unbindEvents(){this.resizeSubscription&&this.resizeSubscription.unsubscribe()}bindWindowResizeEvent(){const n=vg(window,"resize").pipe(yO(200)).subscribe(i=>{this.update(),this.cd&&this.cd.markForCheck()});this.resizeSubscription=n}}return r.\u0275fac=function(t){return new(t||r)(Ue(Dr),Ue(vn),Ue(Hh),Ue(I1))},r.\u0275cmp=Zn({type:r,selectors:[["ngx-graph"]],contentQueries:function(t,n,i){if(1&t&&(io(i,Vz,5),io(i,Hz,5),io(i,Yz,5),io(i,Uz,5),io(i,Wz,5)),2&t){let s;ui(s=hi())&&(n.linkTemplate=s.first),ui(s=hi())&&(n.nodeTemplate=s.first),ui(s=hi())&&(n.clusterTemplate=s.first),ui(s=hi())&&(n.defsTemplate=s.first),ui(s=hi())&&(n.miniMapNodeTemplate=s.first)}},viewQuery:function(t,n){if(1&t&&(Vf(jz,5),Vf(zz,5)),2&t){let i;ui(i=hi())&&(n.nodeElements=i),ui(i=hi())&&(n.linkElements=i)}},hostBindings:function(t,n){1&t&&zi("mousemove",function(s){return n.onMouseMove(s)},!1,tu)("mousedown",function(s){return n.onMouseDown(s)},!1,tu)("click",function(s){return n.graphClick(s)},!1,tu)("touchmove",function(s){return n.onTouchMove(s)},!1,tu)("mouseup",function(s){return n.onMouseUp(s)},!1,tu)},inputs:{nodes:"nodes",clusters:"clusters",links:"links",activeEntries:"activeEntries",curve:"curve",draggingEnabled:"draggingEnabled",nodeHeight:"nodeHeight",nodeMaxHeight:"nodeMaxHeight",nodeMinHeight:"nodeMinHeight",nodeWidth:"nodeWidth",nodeMinWidth:"nodeMinWidth",nodeMaxWidth:"nodeMaxWidth",panningEnabled:"panningEnabled",panningAxis:"panningAxis",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",minZoomLevel:"minZoomLevel",maxZoomLevel:"maxZoomLevel",autoZoom:"autoZoom",panOnZoom:"panOnZoom",animate:"animate",autoCenter:"autoCenter",update$:"update$",center$:"center$",zoomToFit$:"zoomToFit$",panToNode$:"panToNode$",layout:"layout",layoutSettings:"layoutSettings",enableTrackpadSupport:"enableTrackpadSupport",showMiniMap:"showMiniMap",miniMapMaxWidth:"miniMapMaxWidth",miniMapMaxHeight:"miniMapMaxHeight",miniMapPosition:"miniMapPosition",view:"view",scheme:"scheme",customColors:"customColors",animations:"animations",groupResultsBy:"groupResultsBy",zoomLevel:"zoomLevel",panOffsetX:"panOffsetX",panOffsetY:"panOffsetY"},outputs:{select:"select",activate:"activate",deactivate:"deactivate",zoomChange:"zoomChange",clickHandler:"clickHandler"},features:[ca],ngContentSelectors:u7,decls:6,vars:11,consts:[["mouseWheel","",1,"ngx-charts-outer",3,"mouseWheelUp","mouseWheelDown"],[1,"ngx-charts"],["class","graph chart",3,"touchstart","touchend",4,"ngIf"],["class","minimap",4,"ngIf"],[1,"graph","chart",3,"touchstart","touchend"],[3,"ngTemplateOutlet",4,"ngIf"],["class","text-path",4,"ngFor","ngForOf"],[1,"panning-rect",3,"mousedown"],[1,"clusters"],["class","node-group",3,"old-node","id","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"links"],["class","link-group",3,"id",4,"ngFor","ngForOf","ngForTrackBy"],[1,"nodes"],["class","node-group",3,"old-node","id","click","mousedown",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngTemplateOutlet"],[1,"text-path"],[1,"node-group",3,"id","click"],["clusterElement",""],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],["class","node cluster",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"node","cluster"],["alignment-baseline","central"],[1,"link-group",3,"id"],["linkElement",""],["class","edge",4,"ngIf"],[1,"edge"],[1,"node-group",3,"id","click","mousedown"],["nodeElement",""],["r","10",4,"ngIf"],["r","10"],[1,"minimap"],[1,"minimap-background",3,"mousedown"],[1,"minimap-nodes"],["class","node-group",3,"old-node","id",4,"ngFor","ngForOf","ngForTrackBy"],[1,"minimap-drag",3,"mousedown"],[1,"node-group",3,"id"]],template:function(t,n){1&t&&(Ta(),Lt(0,"div",0),zi("mouseWheelUp",function(s){return n.onZoom(s,"in")})("mouseWheelDown",function(s){return n.onZoom(s,"out")}),tr(),Lt(1,"svg",1),xn(2,i7,12,12,"g",2),Lt(3,"clipPath"),Ii(4,"rect"),$t(),xn(5,c7,6,15,"g",3),$t()()),2&t&&(du("width",n.width,"px"),Wt("@animationState","active")("@.disabled",!n.animations),Qt(1),Xn("width",n.width)("height",n.height),Qt(1),Wt("ngIf",n.initialized&&n.graph),Qt(1),Xn("id",n.minimapClipPathId),Qt(1),Xn("width",n.graphDims.width/n.minimapScaleCoefficient)("height",n.graphDims.height/n.minimapScaleCoefficient),Qt(1),Wt("ngIf",n.showMiniMap))},directives:[A7,Wh,iD,eD],styles:[".minimap .minimap-background{fill:#0000001a}.minimap .minimap-drag{fill:#0003;stroke:#fff;stroke-width:1px;stroke-dasharray:2px;stroke-dashoffset:2px;cursor:pointer}.minimap .minimap-drag.panning{fill:#0000004d}.minimap .minimap-nodes{opacity:.5;pointer-events:none}.graph{-webkit-user-select:none;user-select:none}.graph .edge{stroke:#666;fill:none}.graph .edge .edge-label{stroke:none;font-size:12px;fill:#251e1e}.graph .panning-rect{fill:#0000;cursor:move}.graph .node-group.old-node{transition:transform .5s ease-in-out}.graph .node-group .node:focus{outline:none}.graph .cluster rect{opacity:.2}\n"],encapsulation:2,data:{animation:[JL("animationState",[jT(":enter",[gg({opacity:0}),WT("500ms 100ms",gg({opacity:1}))])])]},changeDetection:0}),(0,$L.__decorate)([d7(500)],r.prototype,"updateMinimap",null),r})(),C7=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({providers:[I1],imports:[[iS]]}),r})(),R7=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[iS],C7]}),r})();function T7(r,e){1&r&&(tr(),Lt(0,"marker",4),Ii(1,"path",5),$t())}function O7(r,e){1&r&&(tr(),Lt(0,"g",6),Ii(1,"path",7),$t())}function I7(r,e){if(1&r&&(Lt(0,"ngx-graph",1),xn(1,T7,2,0,"ng-template",null,2,VR),xn(3,O7,2,0,"ng-template",null,3,VR),$t()),2&r){const t=tn();Wt("links",t.links)("nodes",t.nodes)("layout",t.useMsaglLayout?t.msaglLayout:void 0)("curve",t.curve)("enableZoom",!0)("nodeWidth",t.nodeWidth)("nodeHeight",t.nodeHeight)("draggingEnabled",!1)("autoZoom",!0)}}let P1=(()=>{class r{constructor(){this.nodes=void 0,this.links=void 0,this.nodeWidth=10,this.nodeHeight=10,this.useMsaglLayout=!0,this.useMSAGLLayeredLayout=!1,this.curve=D5}ngOnInit(){this.msaglLayout=new _5(this.useMSAGLLayeredLayout,this.nodeWidth,this.nodeHeight)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=Zn({type:r,selectors:[["ngx-graph-msagl"]],inputs:{nodes:"nodes",links:"links",nodeWidth:"nodeWidth",nodeHeight:"nodeHeight",useMsaglLayout:"useMsaglLayout",useMSAGLLayeredLayout:"useMSAGLLayeredLayout"},decls:1,vars:1,consts:[[3,"links","nodes","layout","curve","enableZoom","nodeWidth","nodeHeight","draggingEnabled","autoZoom",4,"ngIf"],[3,"links","nodes","layout","curve","enableZoom","nodeWidth","nodeHeight","draggingEnabled","autoZoom"],["defsTemplate",""],["linkTemplate",""],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","2","markerHeight","2","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[1,"edge"],["stroke-width","1","marker-end","url(#arrow)",1,"line"]],template:function(t,n){1&t&&xn(0,I7,5,9,"ngx-graph",0),2&t&&Wt("ngIf",n.nodes&&n.links)},directives:[Wh,b7],styles:["[_nghost-%COMP%]    {display:block;height:inherit;width:inherit}"],changeDetection:0}),r})();function P7(r,e){if(1&r&&Ii(0,"ngx-graph-msagl",1),2&r){const t=tn();Wt("nodes",t.nodes)("links",t.links)("useMSAGLLayeredLayout",!0)}}let N7=(()=>{class r{constructor(){this.nodes=[],this.links=[],this.shouldShowGraph=!1}ngOnInit(){var t=this;return function aW(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function o(l){xx(s,n,i,o,a,"next",l)}function a(l){xx(s,n,i,o,a,"throw",l)}o(void 0)})}}(function*(){const i=yield(yield fetch("https://raw.githubusercontent.com/microsoft/msagljs/main/modules/core/test/data/graphvis/NaN.gv")).text(),s=lW.read(i);t.nodes=s.nodes().map(o=>({id:o.replace(/\s/g,"").replaceAll(".",""),label:o})),t.links=s.edges().map(o=>({source:o.v.replace(/\s/g,"").replaceAll(".",""),target:o.w.replace(/\s/g,"").replaceAll(".","")})),t.shouldShowGraph=!0})()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=Zn({type:r,selectors:[["app-home"]],decls:1,vars:1,consts:[[3,"nodes","links","useMSAGLLayeredLayout",4,"ngIf"],[3,"nodes","links","useMSAGLLayeredLayout"]],template:function(t,n){1&t&&xn(0,P7,1,3,"ngx-graph-msagl",0),2&t&&Wt("ngIf",n.shouldShowGraph)},directives:[Wh,P1],styles:["[_nghost-%COMP%]{display:block;height:calc(100% - 36px)}"]}),r})(),_7=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=Zn({type:r,selectors:[["app-not-found"]],decls:4,vars:0,template:function(t,n){1&t&&(Lt(0,"h2"),Bs(1,"Sorry!"),$t(),Lt(2,"p"),Bs(3,"Page was not found. Please select a valid page"),$t())},styles:[""]}),r})();const N1=JSON.parse('{"t":[{"id":"ADDAM_MARBRAND","label":"Addam","weight":8},{"id":"AEGON","label":"Aegon","weight":20},{"id":"AERYS","label":"Aerys","weight":122},{"id":"ALLISER_THORNE","label":"Allister","weight":403},{"id":"ARYA","label":"Arya","weight":2791},{"id":"ASSASSIN","label":"Assassin","weight":7},{"id":"BAELOR","label":"Baelor","weight":39},{"id":"BALON","label":"Balon","weight":181},{"id":"BARRISTAN","label":"Barristan","weight":379},{"id":"BENJEN","label":"Benjen","weight":162},{"id":"BERIC","label":"Beric","weight":574},{"id":"BORCAS","label":"Borcas","weight":4},{"id":"BOWEN_MARSH","label":"Bowen","weight":42},{"id":"BRAN","label":"Bran","weight":1864},{"id":"BRANDON_STARK","label":"Brandon","weight":17},{"id":"BRONN","label":"Bronn","weight":1195},{"id":"CATELYN","label":"Catelyn","weight":1246},{"id":"CERSEI","label":"Cersei","weight":3727},{"id":"COHOLLO","label":"Cohollo","weight":3},{"id":"DAENERYS","label":"Daenerys","weight":3839},{"id":"DAREON","label":"Dareon","weight":34},{"id":"DOREAH","label":"Doreah","weight":129},{"id":"DROGO","label":"Drogo","weight":226},{"id":"GALBART_GLOVER","label":"Galbart","weight":6},{"id":"GARED","label":"Gared","weight":9},{"id":"GENDRY","label":"Gendry","weight":826},{"id":"GREATJON_UMBER","label":"Greatjon","weight":78},{"id":"GRENN","label":"Grenn","weight":419},{"id":"HIGH_SEPTON","label":"High Septon","weight":97},{"id":"HODOR","label":"Hodor","weight":448},{"id":"HOSTER","label":"Hoster","weight":35},{"id":"HOT_PIE","label":"Hot Pie","weight":213},{"id":"HOUND","label":"Sandor","weight":1454},{"id":"HUGH_OF_THE_VALE","label":"Hugh of the Vale","weight":23},{"id":"ILLYRIO","label":"Illyrio","weight":54},{"id":"ILYN_PAYNE","label":"Ilyn","weight":60},{"id":"IROGENIA","label":"Irogenia","weight":2},{"id":"IRRI","label":"Irri","weight":92},{"id":"JAIME","label":"Jaime","weight":3316},{"id":"JANOS","label":"Janos","weight":266},{"id":"JAREMY_RYKKER","label":"Jaremy","weight":6},{"id":"JEOR","label":"Jeor","weight":340},{"id":"JHIQUI","label":"Jhiqui","weight":7},{"id":"JOANNA","label":"Joanna","weight":13},{"id":"JOFFREY","label":"Joffrey","weight":1579},{"id":"JON","label":"Jon","weight":4753},{"id":"JON_ARRYN","label":"Jon Arryn","weight":75},{"id":"JONOS_BRACKEN","label":"Jonos","weight":7},{"id":"JORAH","label":"Jorah","weight":1756},{"id":"JORY_CASSEL","label":"Jory","weight":100},{"id":"JOYEUSE","label":"Joyeuse","weight":26},{"id":"KEVAN","label":"Kevan","weight":154},{"id":"LANCEL","label":"Lancel","weight":221},{"id":"LEO_LEFFORD","label":"Leo","weight":7},{"id":"LITTLE_BIRD","label":"Little Bird","weight":2},{"id":"LITTLEFINGER","label":"Petyr","weight":1661},{"id":"LOMMY_GREENHANDS","label":"Lommy","weight":14},{"id":"LORAS","label":"Loras","weight":611},{"id":"LUKE","label":"Luke","weight":4},{"id":"LYANNA","label":"Lyanna","weight":113},{"id":"LYSA","label":"Lysa","weight":333},{"id":"MACE","label":"Mac","weight":277},{"id":"MAESTER_AEMON","label":"Aemon","weight":200},{"id":"MAESTER_LUWIN","label":"Luwin","weight":263},{"id":"MAGO","label":"Mago","weight":18},{"id":"MARILLION","label":"Marillion","weight":34},{"id":"MASHA_HEDDLE","label":"Masha","weight":8},{"id":"MELESSA","label":"Melessa","weight":70},{"id":"MERYN_TRANT","label":"Meryn","weight":248},{"id":"MHAEGEN","label":"Mhaegen","weight":23},{"id":"MIRRI_MAZ_DUUR","label":"Mirri Maz Dur","weight":81},{"id":"MORD","label":"Mord","weight":52},{"id":"MOUNTAIN","label":"Gregor","weight":369},{"id":"MYCAH","label":"Mycah","weight":24},{"id":"MYRCELLA","label":"Myrcella","weight":224},{"id":"NED","label":"Ned","weight":1755},{"id":"OLD_NAN","label":"Old Nan","weight":26},{"id":"OSHA","label":"Osha","weight":426},{"id":"OTHELL_YARWYCK","label":"Othell","weight":60},{"id":"OTHOR","label":"Othor","weight":15},{"id":"PYCELLE","label":"Pycelle","weight":544},{"id":"PYP","label":"Pyp","weight":268},{"id":"QOTHO","label":"Qotho","weight":57},{"id":"RAKHARO","label":"Rakharo","weight":88},{"id":"RANDYLL","label":"Randyll","weight":168},{"id":"RAST","label":"Rast","weight":145},{"id":"RENLY","label":"Renly","weight":448},{"id":"RHAEGAR","label":"Rhaegar","weight":46},{"id":"RHAEGO","label":"Rhaego","weight":31},{"id":"RICKARD_KARSTARK","label":"Rickard Karstark","weight":145},{"id":"RICKARD_STARK","label":"Rickard Stark","weight":17},{"id":"RICKON","label":"Rickon","weight":258},{"id":"ROBB","label":"Robb","weight":1288},{"id":"ROBERT","label":"Robert","weight":754},{"id":"ROBIN","label":"Robin","weight":232},{"id":"RODRIK","label":"Rodrik","weight":164},{"id":"ROOSE_BOLTON","label":"Roose","weight":442},{"id":"ROS","label":"Ros","weight":207},{"id":"ROYCE","label":"Royce","weight":23},{"id":"RYGER_RIVERS","label":"Ryger","weight":4},{"id":"SAM","label":"Sam","weight":2062},{"id":"SANSA","label":"Sansa","weight":3607},{"id":"SEPTA_MORDANE","label":"Septa Mordane","weight":95},{"id":"SHAE","label":"Shae","weight":624},{"id":"SHAGGA","label":"Shagga","weight":35},{"id":"STABLE_BOY","label":"Stable Boy","weight":7},{"id":"STANNIS","label":"Stannis","weight":1142},{"id":"STEFFON","label":"Steffon","weight":4},{"id":"STEVRON_FREY","label":"Stevron","weight":6},{"id":"SYRIO_FOREL","label":"Syrio","weight":70},{"id":"THEON","label":"Theon","weight":1706},{"id":"TOBHO_MOTT","label":"Tobho Mott","weight":15},{"id":"TOMARD","label":"Tomard","weight":10},{"id":"TOMMEN","label":"Tommen","weight":637},{"id":"TYRION","label":"Tyrion","weight":5875},{"id":"TYSHA","label":"Tysha","weight":4},{"id":"TYWIN","label":"Tywin","weight":1499},{"id":"VARDIS_EGEN","label":"Vardis","weight":39},{"id":"VARLY","label":"Varly","weight":2},{"id":"VARYS","label":"Varys","weight":1756},{"id":"VISERYS","label":"Viserys","weight":215},{"id":"WALDER","label":"Walder","weight":262},{"id":"WAYMAR_ROYCE","label":"Waymar","weight":6},{"id":"WILL","label":"Will","weight":25},{"id":"WINE_MERCHANT","label":"Wine Merchant","weight":35},{"id":"YOREN","label":"Yoren","weight":135},{"id":"ALTON","label":"Alton","weight":93},{"id":"AMORY","label":"Amory","weight":46},{"id":"BARRA","label":"Barra","weight":6},{"id":"BILLY","label":"Billy","weight":2},{"id":"BITER","label":"Biter","weight":27},{"id":"BLACK_LORREN","label":"Black Lorren","weight":35},{"id":"BOROS","label":"Boros","weight":6},{"id":"BRIENNE","label":"Brienne","weight":1627},{"id":"CAPTAINS_DAUGHTER","label":"Captain\'s Daughter","weight":17},{"id":"COLEN","label":"Colen","weight":12},{"id":"CRASTER","label":"Craster","weight":177},{"id":"CRESSEN","label":"Cressen","weight":33},{"id":"DAGMER","label":"Dagmer","weight":82},{"id":"DAISY","label":"Daisy","weight":24},{"id":"DAVOS","label":"Davos","weight":1987},{"id":"DONTOS","label":"Dontos","weight":77},{"id":"DROWNED_PRIEST","label":"Drowned Priest","weight":5},{"id":"EDDISON_TOLLETT","label":"Eddison","weight":546},{"id":"FARLEN","label":"Farlen","weight":13},{"id":"FATHER_SEAWORTH","label":"Father Seaworth","weight":2},{"id":"FREY_DAUGHTER","label":"Frey Daughter","weight":2},{"id":"GERARD","label":"Gerard","weight":5},{"id":"GILLY","label":"Gilly","weight":717},{"id":"HARREN","label":"Harren","weight":2},{"id":"HAYLENE","label":"Haylene","weight":35},{"id":"JACKS","label":"Jacks","weight":17},{"id":"JAQEN","label":"Jaqen","weight":446},{"id":"KOVARRO","label":"Kovarro","weight":71},{"id":"LOMMY","label":"Lommy","weight":30},{"id":"MALAKKO","label":"Malakko","weight":11},{"id":"MANCE","label":"Mance","weight":238},{"id":"MANDON","label":"Mandon","weight":21},{"id":"MARGAERY","label":"Margaery","weight":1019},{"id":"MARYA","label":"Marya","weight":2},{"id":"MATTHOS","label":"Matthos","weight":109},{"id":"MELISANDRE","label":"Melisandre","weight":823},{"id":"PODRICK","label":"Podrick","weight":831},{"id":"POLLIVER","label":"Polliver","weight":83},{"id":"PORTAN","label":"Portan","weight":3},{"id":"PROTESTER","label":"Protester","weight":2},{"id":"PYATT_PREE","label":"Pyatt Pree","weight":43},{"id":"QHORIN","label":"Quorin","weight":141},{"id":"QUAITHE","label":"Quaithe","weight":24},{"id":"QUENT","label":"Quent","weight":3},{"id":"RAMSAY","label":"Ramsay","weight":774},{"id":"LORD_OF_BONES","label":"Lord of Bones","weight":73},{"id":"REGINALD","label":"Reginald","weight":10},{"id":"RENNICK","label":"Rennick","weight":2},{"id":"RHAENYS","label":"Rhaenys","weight":4},{"id":"RORGE","label":"Rorge","weight":51},{"id":"SALLADHOR","label":"Salladhor","weight":92},{"id":"SEPTON","label":"Septon","weight":5},{"id":"SILK_KING","label":"Silk King","weight":6},{"id":"SPICE_KING","label":"Spice King","weight":88},{"id":"TALISA","label":"Talisa","weight":320},{"id":"TICKLER","label":"Tickler","weight":13},{"id":"TIMETT","label":"Timett","weight":12},{"id":"TORRHEN","label":"Torrhen","weight":16},{"id":"TRYSTANE","label":"Trystane","weight":84},{"id":"VISENYA","label":"Visenya","weight":5},{"id":"WINTERFELL_SHEPHERD","label":"Shepherd","weight":13},{"id":"XARO","label":"Xaro","weight":152},{"id":"YARA","label":"Yara","weight":489},{"id":"YGRITTE","label":"Ygritte","weight":518},{"id":"ANGUY","label":"Anguy","weight":93},{"id":"LITTLE_SAM","label":"Little Sam","weight":184},{"id":"BALERION","label":"Balerion","weight":7},{"id":"BERT","label":"Bert","weight":2},{"id":"BLACK_WALDER","label":"Black Walder","weight":89},{"id":"BRYNDEN","label":"Brynden","weight":213},{"id":"DAARIO","label":"Daario","weight":518},{"id":"DESMOND","label":"Desmond","weight":6},{"id":"EDMURE","label":"Edmure","weight":262},{"id":"ELDRICK","label":"Eldrick","weight":2},{"id":"FARMER","label":"Farmer","weight":38},{"id":"FREY_SEPTON","label":"Frey Septon","weight":8},{"id":"GREIZHEN","label":"Greizhen","weight":11},{"id":"GREY_WORM","label":"Grey Worm","weight":968},{"id":"HOBB","label":"Hobb","weight":2},{"id":"JOJEN","label":"Jojen","weight":324},{"id":"KARL_TANNER","label":"Karl","weight":110},{"id":"KRAZNYS_MO_NAKLOZ","label":"Kraznys","weight":86},{"id":"LOCKE","label":"Locke","weight":183},{"id":"LOTHAR","label":"Lothar","weight":79},{"id":"MAREI","label":"Marei","weight":43},{"id":"MARTYN","label":"Martyn","weight":19},{"id":"MEERA","label":"Meera","weight":458},{"id":"MERO","label":"Mero","weight":60},{"id":"MERRY","label":"Merry","weight":3},{"id":"MISSANDEI","label":"Missandei","weight":999},{"id":"MYRANDA","label":"Myranda","weight":190},{"id":"OLENNA","label":"Olenna","weight":650},{"id":"OLYVAR","label":"Olyvar","weight":119},{"id":"ORELL","label":"Orell","weight":132},{"id":"PRENDAHL","label":"Prendahl","weight":33},{"id":"QHORIN_HALFHAND","label":"Qhorin","weight":4},{"id":"QYBURN","label":"Qyburn","weight":488},{"id":"RADZAI_MO_ERAZ","label":"Radzai","weight":24},{"id":"ROSLIN","label":"Roslin","weight":44},{"id":"RYLENE","label":"Rylene","weight":4},{"id":"SELWYN","label":"Selwyn","weight":13},{"id":"SELYSE","label":"Selyse","weight":184},{"id":"SHIREEN","label":"Shireen","weight":273},{"id":"SORCERER","label":"Sorcerer","weight":7},{"id":"STEELSHANKS_WALTON","label":"Steelshanks Walton","weight":21},{"id":"TARYN_MANT","label":"Taryn","weight":18},{"id":"THOROS","label":"Thoros","weight":356},{"id":"TORMUND","label":"Tormund","weight":1241},{"id":"TORTURER","label":"Torturer","weight":19},{"id":"VIOLET","label":"Violet","weight":36},{"id":"WILLEM_LANNISTER","label":"Willem","weight":8},{"id":"ADRACK_HUMBLE","label":"Adrack Humble","weight":6},{"id":"ANYA_WAYNWOOD","label":"Anya Waynwood","weight":49},{"id":"AXELL_FLORENT","label":"Axell Florent","weight":12},{"id":"BALON_DWARF","label":"Balon Dwarf","weight":21},{"id":"BLACK_JACK","label":"Black Jack","weight":8},{"id":"BOLTON_GUARD","label":"Bolton Guard","weight":10},{"id":"COOPER","label":"Cooper","weight":7},{"id":"CRASTERS_BABY","label":"Baby","weight":26},{"id":"DONGO_THE_GIANT","label":"Dongo the Giant","weight":9},{"id":"DONNEL_HILL","label":"Donnel Hill","weight":13},{"id":"DONNEL_WAYNWOOD","label":"Donnel Waynwood","weight":5},{"id":"DORAN","label":"Doran","weight":148},{"id":"DORNISH_LORD","label":"Dornish Lord","weight":9},{"id":"DYING_MAN","label":"Dying Man","weight":22},{"id":"ELDER_MEEREEN_SLAVE","label":"Meereen Statesman","weight":14},{"id":"ELIA","label":"Elia","weight":24},{"id":"ELLARIA","label":"Ellaria","weight":412},{"id":"ENDREW","label":"Endrew","weight":12},{"id":"FALYSE","label":"Falyse","weight":4},{"id":"FARMER_HAMLET","label":"Hamlet Farmer","weight":44},{"id":"FENNESZ","label":"Fennesz","weight":22},{"id":"FIRST_MATE","label":"First Mate","weight":14},{"id":"FOOL","label":"Fool","weight":6},{"id":"GOATHERD","label":"Goatherd","weight":19},{"id":"GOATHERDS_SON","label":"Goatherd\'s Son","weight":2},{"id":"GUYMON","label":"Guymon","weight":14},{"id":"HIZDAHR","label":"Hizdahr","weight":171},{"id":"HIZDAHRS_FATHER","label":"Hizdahr\'s Father","weight":11},{"id":"INNKEEPER","label":"Innkeeper","weight":10},{"id":"INNKEEPERS_DAUGHTER","label":"Innkeeper\'s Daughter","weight":4},{"id":"JOFFREY_DWARF","label":"Joffrey Dwarf","weight":28},{"id":"KEGS","label":"Kegs","weight":8},{"id":"LEAF","label":"Leaf","weight":74},{"id":"LHARA","label":"Lhara","weight":5},{"id":"LOLLYS","label":"Lollys","weight":24},{"id":"LUTHOR","label":"Luthor","weight":7},{"id":"MAG_THE_MIGHTY","label":"Mag the Mighty","weight":26},{"id":"MANSERVANT","label":"Manservant","weight":8},{"id":"MASTER_MIGHDAL","label":"Master Mighdal","weight":7},{"id":"MEEREEN_CHAMPION","label":"Meereen Champion","weight":13},{"id":"MEEREEN_SLAVE","label":"Meereen Slave","weight":7},{"id":"MOLES_TOWN_MADAM","label":"Mole\'s Town Madam","weight":14},{"id":"MOLES_TOWN_WHORE","label":"Mole\'s Town Whore","weight":33},{"id":"MORAG","label":"Morag","weight":28},{"id":"MORGAN","label":"Morgan","weight":58},{"id":"MORGANS_FRIEND","label":"Morgan\'s Friend","weight":24},{"id":"MOSSADOR","label":"Mossador","weight":63},{"id":"MULLY","label":"Mully","weight":8},{"id":"MUSICIAN","label":"Musician","weight":2},{"id":"NIGHT_KING","label":"Night King","weight":160},{"id":"OBERYN","label":"Oberyn","weight":501},{"id":"OLLY","label":"Olly","weight":228},{"id":"OLLYS_MOTHER","label":"Olly\'s Mother","weight":13},{"id":"ORSON","label":"Orson","weight":6},{"id":"ORYS","label":"Orys","weight":4},{"id":"ORYS_BROTHER","label":"Orys\'s Brother","weight":4},{"id":"RALF","label":"Ralf","weight":22},{"id":"RENLY_DWARF","label":"Renly Dwarf","weight":18},{"id":"ROBB_DWARF","label":"Robb Dwarf","weight":27},{"id":"SALLY","label":"Sally","weight":23},{"id":"SISSY","label":"Sissy","weight":39},{"id":"STANNIS_DWARF","label":"Stannis Dwarf","weight":18},{"id":"STYR","label":"Styr","weight":84},{"id":"TANSY","label":"Tansy","weight":27},{"id":"TERNESIO_TERYS","label":"Ternesio Terys","weight":17},{"id":"THENN_WARG","label":"Thenn Warg","weight":10},{"id":"THREE_EYED_RAVEN","label":"Three Eyed Raven","weight":166},{"id":"TOMMY","label":"Tommy","weight":8},{"id":"TYCHO","label":"Tycho","weight":107},{"id":"VANCE_CORBRAY","label":"Vance Corbray","weight":9},{"id":"VIOLA","label":"Viola","weight":4},{"id":"WALDA","label":"Walda","weight":78},{"id":"WHITE_WALKER","label":"White Walker","weight":12},{"id":"YOHN_ROYCE","label":"Yohn Royce","weight":293},{"id":"ZALA","label":"Zala","weight":2},{"id":"AREO","label":"Areo","weight":128},{"id":"BLACK_HAIRED_PROSTITUTE","label":"Strumpet","weight":17},{"id":"BRAND","label":"Brand","weight":17},{"id":"BRIAN","label":"Brian","weight":2},{"id":"CERWYN","label":"Cerwyn","weight":2},{"id":"DENYS","label":"Denys","weight":2},{"id":"DERRYK","label":"Derryk","weight":23},{"id":"DORNISH_RIDER","label":"Dornish Rider","weight":16},{"id":"HIGH_SPARROW","label":"High Sparrow","weight":423},{"id":"KARSI","label":"Karsi","weight":57},{"id":"LOBODA","label":"Loboda","weight":28},{"id":"LORD_WEEBLY","label":"Lord Weebly","weight":5},{"id":"LYANNA_MORMONT","label":"Lyanna Mormont","weight":264},{"id":"MADAME","label":"Madame","weight":8},{"id":"MAGGY","label":"Maggy","weight":24},{"id":"MAGNAR","label":"Magnar","weight":2},{"id":"MALKO","label":"Malko","weight":29},{"id":"MELARA","label":"Melara","weight":14},{"id":"NYMERIA","label":"Nymeria","weight":85},{"id":"OBARA","label":"Obara","weight":107},{"id":"OWNER","label":"Owner","weight":18},{"id":"QUICK","label":"Quick","weight":12},{"id":"RHAENYRA","label":"Rhaenyra","weight":2},{"id":"SEPTA_UNELLA","label":"Septa Unella","weight":68},{"id":"STRONG","label":"Strong","weight":12},{"id":"TANDA","label":"Tanda","weight":2},{"id":"THIN_MAN","label":"Thin Man","weight":32},{"id":"TYENE","label":"Tyene","weight":169},{"id":"WAIF","label":"Waif","weight":152},{"id":"WOLKAN","label":"Wolkan","weight":0},{"id":"AERON","label":"Aeron","weight":25},{"id":"ARTHUR","label":"Arthur","weight":22},{"id":"ARTHUR_CHILD","label":"Arthur (child)","weight":6},{"id":"BELICHO","label":"Belicho","weight":32},{"id":"BIANCA","label":"Bianca","weight":80},{"id":"BOBONO","label":"Bobono","weight":82},{"id":"CAMELLO","label":"Camello","weight":55},{"id":"CLARENZO","label":"Clarenzo","weight":73},{"id":"DICKON","label":"Dickon","weight":106},{"id":"DIM_DALBA","label":"Dim Dalba","weight":16},{"id":"DOM","label":"Dom","weight":8},{"id":"DOSH_KHALEEN_LEADER","label":"Dosh Khaleen Leader","weight":20},{"id":"EURON","label":"Euron","weight":323},{"id":"FLYNN","label":"Flynn","weight":6},{"id":"GATINS","label":"Gatins","weight":9},{"id":"GLOVER","label":"Glover","weight":21},{"id":"GUARD_CAPTAIN","label":"Guard Captain","weight":13},{"id":"HARALD","label":"Harald","weight":21},{"id":"HOWLAND","label":"Howland","weight":15},{"id":"IZEMBARO","label":"Izembaro","weight":80},{"id":"KHAL_MORO","label":"Khal Moro","weight":43},{"id":"KINVARA","label":"Kinvara","weight":28},{"id":"LADY_CRANE","label":"Lady Crane","weight":180},{"id":"LEM","label":"Lem","weight":27},{"id":"LHAZAREEN_WOMAN","label":"Lhazareen Woman","weight":30},{"id":"MAESTER_CITADEL","label":"Citadel Maester","weight":17},{"id":"MAESTER_DORNE","label":"Dorne Maester","weight":11},{"id":"MAESTER_MORMONT","label":"Mormont Maester","weight":21},{"id":"MAESTER_WOLKAN","label":"Wolkan","weight":180},{"id":"MANDERLY","label":"Manderly","weight":13},{"id":"MINISA","label":"Minisa","weight":2},{"id":"RAY","label":"Ray","weight":56},{"id":"RAZDAL","label":"Razdal","weight":46},{"id":"RED_PRIEST","label":"Red Priest","weight":10},{"id":"ROBETT","label":"Robett","weight":89},{"id":"SMALLJON","label":"Smalljon","weight":84},{"id":"SON_OF_EDMURE","label":"Edmure\'s Son","weight":8},{"id":"SON_OFWALDA","label":"Roose\'s Son","weight":21},{"id":"TALLA","label":"Talla","weight":38},{"id":"VALA","label":"Vala","weight":19},{"id":"WUN_WUN","label":"Wun Wun","weight":60},{"id":"YEZZAN","label":"Yezzan","weight":51},{"id":"ALYS","label":"Alys","weight":100},{"id":"HARRAG","label":"Harrag","weight":27},{"id":"MARWYN","label":"Marwin","weight":100},{"id":"NED_UMBER","label":"Ned Umber","weight":21},{"id":"QHONO","label":"Qhono","weight":88},{"id":"ALANNA","label":"Alanna","weight":2},{"id":"CERSEIS_BABY","label":"Cersei\'s Baby","weight":6},{"id":"CRAYAH","label":"Crayah","weight":27},{"id":"DIRAH","label":"Dirah","weight":20},{"id":"DORNISH_PRINCE","label":"Dornish Prince","weight":37},{"id":"HARRY","label":"Harry","weight":21},{"id":"IRONBORN_LORD","label":"Ironborn Lord","weight":36},{"id":"MARTHA","label":"Martha","weight":11},{"id":"NORA","label":"Nora","weight":48},{"id":"OWEN","label":"Owen","weight":6},{"id":"RIVERLANDS_LORD","label":"Riverlands Lord","weight":36},{"id":"SARRA","label":"Sarra","weight":9},{"id":"TEELA","label":"Teela","weight":16},{"id":"UNSULLIED_CAPTAIN","label":"Unsullied Captain","weight":5},{"id":"VALE_LORD","label":"Vale Lord","weight":36},{"id":"VICKY","label":"Vicky","weight":39},{"id":"WILLA","label":"Willa","weight":11},{"id":"WILLIAM","label":"William","weight":2}],"$":[{"directed":false,"source":"NED","target":"ROBERT","weight":211},{"directed":false,"source":"DAENERYS","target":"JORAH","weight":594},{"directed":false,"source":"JON","target":"SAM","weight":415},{"directed":false,"source":"LITTLEFINGER","target":"NED","weight":118},{"directed":false,"source":"NED","target":"VARYS","weight":104},{"directed":false,"source":"DAENERYS","target":"DROGO","weight":113},{"directed":false,"source":"ARYA","target":"NED","weight":110},{"directed":false,"source":"CATELYN","target":"ROBB","weight":232},{"directed":false,"source":"BRONN","target":"TYRION","weight":389},{"directed":false,"source":"CERSEI","target":"NED","weight":100},{"directed":false,"source":"CERSEI","target":"ROBERT","weight":98},{"directed":false,"source":"LITTLEFINGER","target":"VARYS","weight":98},{"directed":false,"source":"SHAE","target":"TYRION","weight":324},{"directed":false,"source":"CATELYN","target":"NED","weight":86},{"directed":false,"source":"JOFFREY","target":"SANSA","weight":187},{"directed":false,"source":"NED","target":"PYCELLE","weight":68},{"directed":false,"source":"DAENERYS","target":"VISERYS","weight":75},{"directed":false,"source":"SANSA","target":"SEPTA_MORDANE","weight":64},{"directed":false,"source":"TYRION","target":"TYWIN","weight":306},{"directed":false,"source":"JEOR","target":"JON","weight":111},{"directed":false,"source":"ROBB","target":"THEON","weight":89},{"directed":false,"source":"CERSEI","target":"JOFFREY","weight":217},{"directed":false,"source":"ARYA","target":"SANSA","weight":280},{"directed":false,"source":"BRAN","target":"MAESTER_LUWIN","weight":84},{"directed":false,"source":"JAIME","target":"NED","weight":62},{"directed":false,"source":"NED","target":"SANSA","weight":96},{"directed":false,"source":"BRAN","target":"ROBB","weight":59},{"directed":false,"source":"LORAS","target":"RENLY","weight":73},{"directed":false,"source":"CERSEI","target":"JAIME","weight":509},{"directed":false,"source":"DAENERYS","target":"MIRRI_MAZ_DUUR","weight":45},{"directed":false,"source":"JON","target":"TYRION","weight":268},{"directed":false,"source":"ARYA","target":"SYRIO_FOREL","weight":48},{"directed":false,"source":"JORY_CASSEL","target":"NED","weight":44},{"directed":false,"source":"JORAH","target":"VISERYS","weight":43},{"directed":false,"source":"JON","target":"PYP","weight":54},{"directed":false,"source":"CATELYN","target":"TYRION","weight":54},{"directed":false,"source":"ROS","target":"THEON","weight":40},{"directed":false,"source":"JOFFREY","target":"NED","weight":56},{"directed":false,"source":"CERSEI","target":"SANSA","weight":144},{"directed":false,"source":"GRENN","target":"PYP","weight":44},{"directed":false,"source":"CATELYN","target":"WALDER","weight":53},{"directed":false,"source":"DAENERYS","target":"DOREAH","weight":54},{"directed":false,"source":"JAIME","target":"TYRION","weight":358},{"directed":false,"source":"JAIME","target":"TYWIN","weight":148},{"directed":false,"source":"BENJEN","target":"JON","weight":40},{"directed":false,"source":"DAENERYS","target":"IRRI","weight":47},{"directed":false,"source":"GREATJON_UMBER","target":"ROBB","weight":31},{"directed":false,"source":"MORD","target":"TYRION","weight":31},{"directed":false,"source":"CATELYN","target":"LYSA","weight":41},{"directed":false,"source":"DOREAH","target":"VISERYS","weight":30},{"directed":false,"source":"JORAH","target":"RAKHARO","weight":30},{"directed":false,"source":"LYSA","target":"ROBIN","weight":47},{"directed":false,"source":"LYSA","target":"TYRION","weight":37},{"directed":false,"source":"NED","target":"RENLY","weight":30},{"directed":false,"source":"PYP","target":"SAM","weight":69},{"directed":false,"source":"RENLY","target":"ROBERT","weight":35},{"directed":false,"source":"BRAN","target":"NED","weight":61},{"directed":false,"source":"BRAN","target":"OSHA","weight":153},{"directed":false,"source":"JON","target":"NED","weight":79},{"directed":false,"source":"BRAN","target":"CATELYN","weight":44},{"directed":false,"source":"CATELYN","target":"JAIME","weight":70},{"directed":false,"source":"CATELYN","target":"RODRIK","weight":28},{"directed":false,"source":"DAENERYS","target":"QOTHO","weight":28},{"directed":false,"source":"JOFFREY","target":"ROBERT","weight":37},{"directed":false,"source":"JON","target":"MAESTER_AEMON","weight":55},{"directed":false,"source":"DROGO","target":"VISERYS","weight":27},{"directed":false,"source":"JAIME","target":"JORY_CASSEL","weight":27},{"directed":false,"source":"BRAN","target":"THEON","weight":107},{"directed":false,"source":"CATELYN","target":"LITTLEFINGER","weight":64},{"directed":false,"source":"CATELYN","target":"MAESTER_LUWIN","weight":26},{"directed":false,"source":"BARRISTAN","target":"NED","weight":25},{"directed":false,"source":"ILLYRIO","target":"VISERYS","weight":25},{"directed":false,"source":"JON","target":"ROBB","weight":35},{"directed":false,"source":"OSHA","target":"THEON","weight":61},{"directed":false,"source":"ARYA","target":"JOFFREY","weight":47},{"directed":false,"source":"GRENN","target":"JON","weight":82},{"directed":false,"source":"NED","target":"ROBB","weight":45},{"directed":false,"source":"BARRISTAN","target":"ROBERT","weight":27},{"directed":false,"source":"CATELYN","target":"CERSEI","weight":26},{"directed":false,"source":"LITTLEFINGER","target":"SANSA","weight":416},{"directed":false,"source":"SHAGGA","target":"TYRION","weight":22},{"directed":false,"source":"TYRION","target":"YOREN","weight":22},{"directed":false,"source":"ALLISER_THORNE","target":"JON","weight":133},{"directed":false,"source":"ARYA","target":"JON","weight":99},{"directed":false,"source":"DROGO","target":"JORAH","weight":22},{"directed":false,"source":"JAIME","target":"ROBERT","weight":23},{"directed":false,"source":"BRAN","target":"JON","weight":82},{"directed":false,"source":"DAENERYS","target":"WINE_MERCHANT","weight":19},{"directed":false,"source":"HOUND","target":"SANSA","weight":73},{"directed":false,"source":"LITTLEFINGER","target":"PYCELLE","weight":27},{"directed":false,"source":"LITTLEFINGER","target":"ROS","weight":35},{"directed":false,"source":"THEON","target":"TYRION","weight":49},{"directed":false,"source":"ALLISER_THORNE","target":"SAM","weight":41},{"directed":false,"source":"ARYA","target":"YOREN","weight":38},{"directed":false,"source":"CERSEI","target":"TYRION","weight":442},{"directed":false,"source":"BENJEN","target":"TYRION","weight":17},{"directed":false,"source":"DAENERYS","target":"RAKHARO","weight":29},{"directed":false,"source":"JEOR","target":"SAM","weight":43},{"directed":false,"source":"LITTLEFINGER","target":"RENLY","weight":39},{"directed":false,"source":"MAESTER_LUWIN","target":"ROBB","weight":17},{"directed":false,"source":"ROBERT","target":"SANSA","weight":19},{"directed":false,"source":"ROS","target":"TYRION","weight":20},{"directed":false,"source":"CATELYN","target":"THEON","weight":16},{"directed":false,"source":"GRENN","target":"SAM","weight":75},{"directed":false,"source":"HOUND","target":"JOFFREY","weight":73},{"directed":false,"source":"ROBB","target":"TYRION","weight":21},{"directed":false,"source":"BRAN","target":"TYRION","weight":72},{"directed":false,"source":"CATELYN","target":"ROBERT","weight":15},{"directed":false,"source":"JEOR","target":"TYRION","weight":19},{"directed":false,"source":"JOFFREY","target":"TYRION","weight":200},{"directed":false,"source":"JOFFREY","target":"VARYS","weight":28},{"directed":false,"source":"LANCEL","target":"ROBERT","weight":15},{"directed":false,"source":"MIRRI_MAZ_DUUR","target":"QOTHO","weight":15},{"directed":false,"source":"NED","target":"YOREN","weight":15},{"directed":false,"source":"PYCELLE","target":"VARYS","weight":37},{"directed":false,"source":"BENJEN","target":"NED","weight":24},{"directed":false,"source":"BRAN","target":"RICKON","weight":82},{"directed":false,"source":"CATELYN","target":"JON","weight":16},{"directed":false,"source":"CATELYN","target":"SANSA","weight":39},{"directed":false,"source":"JOFFREY","target":"MARILLION","weight":14},{"directed":false,"source":"KEVAN","target":"TYRION","weight":14},{"directed":false,"source":"LITTLEFINGER","target":"ROBERT","weight":14},{"directed":false,"source":"BARRISTAN","target":"CERSEI","weight":15},{"directed":false,"source":"CATELYN","target":"VARDIS_EGEN","weight":13},{"directed":false,"source":"CERSEI","target":"VARYS","weight":56},{"directed":false,"source":"DAENERYS","target":"RHAEGO","weight":17},{"directed":false,"source":"JANOS","target":"NED","weight":13},{"directed":false,"source":"JOFFREY","target":"PYCELLE","weight":26},{"directed":false,"source":"MAESTER_LUWIN","target":"THEON","weight":61},{"directed":false,"source":"NED","target":"THEON","weight":20},{"directed":false,"source":"PYCELLE","target":"SANSA","weight":18},{"directed":false,"source":"GENDRY","target":"NED","weight":14},{"directed":false,"source":"HOT_PIE","target":"LOMMY_GREENHANDS","weight":12},{"directed":false,"source":"JOFFREY","target":"LITTLEFINGER","weight":26},{"directed":false,"source":"JOFFREY","target":"MERYN_TRANT","weight":31},{"directed":false,"source":"JOFFREY","target":"ROBB","weight":31},{"directed":false,"source":"JON_ARRYN","target":"NED","weight":15},{"directed":false,"source":"KEVAN","target":"TYWIN","weight":23},{"directed":false,"source":"MAESTER_LUWIN","target":"OSHA","weight":26},{"directed":false,"source":"ARYA","target":"SEPTA_MORDANE","weight":11},{"directed":false,"source":"BRAN","target":"HODOR","weight":160},{"directed":false,"source":"BRONN","target":"SHAE","weight":18},{"directed":false,"source":"CATELYN","target":"GREATJON_UMBER","weight":11},{"directed":false,"source":"CATELYN","target":"VARYS","weight":11},{"directed":false,"source":"GREATJON_UMBER","target":"THEON","weight":11},{"directed":false,"source":"IRRI","target":"RAKHARO","weight":11},{"directed":false,"source":"MERYN_TRANT","target":"SYRIO_FOREL","weight":13},{"directed":false,"source":"NED","target":"TYRION","weight":30},{"directed":false,"source":"NED","target":"TYWIN","weight":13},{"directed":false,"source":"PYCELLE","target":"ROBERT","weight":14},{"directed":false,"source":"RENLY","target":"STANNIS","weight":54},{"directed":false,"source":"ROBB","target":"RODRIK","weight":16},{"directed":false,"source":"ROBERT","target":"VARYS","weight":16},{"directed":false,"source":"ALLISER_THORNE","target":"PYP","weight":18},{"directed":false,"source":"ARYA","target":"ROBERT","weight":15},{"directed":false,"source":"CATELYN","target":"ROBIN","weight":10},{"directed":false,"source":"DAENERYS","target":"ILLYRIO","weight":10},{"directed":false,"source":"DROGO","target":"MAGO","weight":10},{"directed":false,"source":"HOUND","target":"NED","weight":14},{"directed":false,"source":"HOUND","target":"TYRION","weight":50},{"directed":false,"source":"JAIME","target":"JON","weight":29},{"directed":false,"source":"JAIME","target":"ROBB","weight":46},{"directed":false,"source":"JEOR","target":"PYP","weight":10},{"directed":false,"source":"JOFFREY","target":"MYCAH","weight":10},{"directed":false,"source":"JORAH","target":"WINE_MERCHANT","weight":10},{"directed":false,"source":"MERYN_TRANT","target":"SANSA","weight":20},{"directed":false,"source":"NED","target":"RODRIK","weight":14},{"directed":false,"source":"NED","target":"STANNIS","weight":21},{"directed":false,"source":"NED","target":"TOBHO_MOTT","weight":10},{"directed":false,"source":"PYP","target":"RAST","weight":10},{"directed":false,"source":"ALLISER_THORNE","target":"JEOR","weight":9},{"directed":false,"source":"ARYA","target":"CERSEI","weight":34},{"directed":false,"source":"BRAN","target":"JAIME","weight":33},{"directed":false,"source":"BRAN","target":"OLD_NAN","weight":11},{"directed":false,"source":"CERSEI","target":"PYCELLE","weight":95},{"directed":false,"source":"DROGO","target":"MIRRI_MAZ_DUUR","weight":9},{"directed":false,"source":"ILLYRIO","target":"VARYS","weight":9},{"directed":false,"source":"IRRI","target":"JORAH","weight":11},{"directed":false,"source":"JEOR","target":"MAESTER_AEMON","weight":9},{"directed":false,"source":"MHAEGEN","target":"NED","weight":9},{"directed":false,"source":"NED","target":"SEPTA_MORDANE","weight":9},{"directed":false,"source":"PYCELLE","target":"ROS","weight":9},{"directed":false,"source":"RENLY","target":"VARYS","weight":9},{"directed":false,"source":"ROBB","target":"SANSA","weight":28},{"directed":false,"source":"ROBIN","target":"TYRION","weight":16},{"directed":false,"source":"RODRIK","target":"TYRION","weight":9},{"directed":false,"source":"VARDIS_EGEN","target":"TYRION","weight":9},{"directed":false,"source":"AERYS","target":"NED","weight":12},{"directed":false,"source":"BAELOR","target":"NED","weight":8},{"directed":false,"source":"CERSEI","target":"LITTLEFINGER","weight":103},{"directed":false,"source":"CERSEI","target":"ROBB","weight":14},{"directed":false,"source":"DAENERYS","target":"MAGO","weight":8},{"directed":false,"source":"DAREON","target":"PYP","weight":8},{"directed":false,"source":"HOUND","target":"MERYN_TRANT","weight":17},{"directed":false,"source":"JORAH","target":"MIRRI_MAZ_DUUR","weight":8},{"directed":false,"source":"OSHA","target":"ROBB","weight":10},{"directed":false,"source":"PYCELLE","target":"RENLY","weight":8},{"directed":false,"source":"ROBERT","target":"TYWIN","weight":15},{"directed":false,"source":"RODRIK","target":"THEON","weight":31},{"directed":false,"source":"SANSA","target":"VARYS","weight":39},{"directed":false,"source":"AERYS","target":"ROBERT","weight":16},{"directed":false,"source":"ALLISER_THORNE","target":"GRENN","weight":20},{"directed":false,"source":"ARYA","target":"CATELYN","weight":22},{"directed":false,"source":"ARYA","target":"GENDRY","weight":200},{"directed":false,"source":"ARYA","target":"HOUND","weight":314},{"directed":false,"source":"ARYA","target":"JORY_CASSEL","weight":7},{"directed":false,"source":"ARYA","target":"STABLE_BOY","weight":7},{"directed":false,"source":"ARYA","target":"VARYS","weight":14},{"directed":false,"source":"BRAN","target":"ROBERT","weight":7},{"directed":false,"source":"BRONN","target":"CATELYN","weight":7},{"directed":false,"source":"GREATJON_UMBER","target":"RODRIK","weight":7},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"JORY_CASSEL","weight":7},{"directed":false,"source":"JON","target":"RAST","weight":7},{"directed":false,"source":"JON","target":"THEON","weight":48},{"directed":false,"source":"JON_ARRYN","target":"ROBERT","weight":9},{"directed":false,"source":"JORY_CASSEL","target":"LITTLEFINGER","weight":7},{"directed":false,"source":"LYSA","target":"VARDIS_EGEN","weight":7},{"directed":false,"source":"MAESTER_AEMON","target":"TYRION","weight":7},{"directed":false,"source":"MAESTER_LUWIN","target":"TYRION","weight":7},{"directed":false,"source":"ROBERT","target":"TYRION","weight":10},{"directed":false,"source":"ROBERT","target":"VISERYS","weight":7},{"directed":false,"source":"ARYA","target":"ROBB","weight":18},{"directed":false,"source":"BARRISTAN","target":"VARYS","weight":8},{"directed":false,"source":"BRONN","target":"RODRIK","weight":6},{"directed":false,"source":"DROGO","target":"ILLYRIO","weight":6},{"directed":false,"source":"DROGO","target":"QOTHO","weight":6},{"directed":false,"source":"DROGO","target":"RHAEGO","weight":9},{"directed":false,"source":"GRENN","target":"RAST","weight":23},{"directed":false,"source":"GRENN","target":"TYRION","weight":6},{"directed":false,"source":"HOUND","target":"ROBERT","weight":6},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"NED","weight":6},{"directed":false,"source":"JAIME","target":"JOFFREY","weight":47},{"directed":false,"source":"JEOR","target":"OTHELL_YARWYCK","weight":6},{"directed":false,"source":"JEOR","target":"OTHOR","weight":6},{"directed":false,"source":"LITTLEFINGER","target":"MOUNTAIN","weight":6},{"directed":false,"source":"LITTLEFINGER","target":"TYRION","weight":70},{"directed":false,"source":"MAESTER_AEMON","target":"PYP","weight":8},{"directed":false,"source":"MAESTER_AEMON","target":"SAM","weight":61},{"directed":false,"source":"NED","target":"SYRIO_FOREL","weight":6},{"directed":false,"source":"NED","target":"TOMARD","weight":6},{"directed":false,"source":"OTHELL_YARWYCK","target":"SAM","weight":6},{"directed":false,"source":"PYP","target":"TYRION","weight":6},{"directed":false,"source":"RAST","target":"SAM","weight":19},{"directed":false,"source":"SHAGGA","target":"TYWIN","weight":6},{"directed":false,"source":"ARYA","target":"BAELOR","weight":5},{"directed":false,"source":"ARYA","target":"BRAN","weight":50},{"directed":false,"source":"ARYA","target":"HOT_PIE","weight":99},{"directed":false,"source":"ARYA","target":"LITTLEFINGER","weight":37},{"directed":false,"source":"ARYA","target":"MERYN_TRANT","weight":25},{"directed":false,"source":"ARYA","target":"MYCAH","weight":7},{"directed":false,"source":"BARRISTAN","target":"JOFFREY","weight":7},{"directed":false,"source":"BENJEN","target":"ROBB","weight":5},{"directed":false,"source":"BENJEN","target":"YOREN","weight":5},{"directed":false,"source":"BRAN","target":"RODRIK","weight":25},{"directed":false,"source":"BRONN","target":"LYSA","weight":5},{"directed":false,"source":"BRONN","target":"SHAGGA","weight":5},{"directed":false,"source":"BRONN","target":"TYWIN","weight":12},{"directed":false,"source":"CATELYN","target":"MORD","weight":5},{"directed":false,"source":"DAENERYS","target":"ROBERT","weight":13},{"directed":false,"source":"DOREAH","target":"IRRI","weight":9},{"directed":false,"source":"DROGO","target":"RAKHARO","weight":5},{"directed":false,"source":"GARED","target":"ROYCE","weight":5},{"directed":false,"source":"GENDRY","target":"TOBHO_MOTT","weight":5},{"directed":false,"source":"HOUND","target":"LITTLEFINGER","weight":5},{"directed":false,"source":"HOUND","target":"MOUNTAIN","weight":39},{"directed":false,"source":"JAIME","target":"KEVAN","weight":17},{"directed":false,"source":"JAIME","target":"LITTLEFINGER","weight":9},{"directed":false,"source":"JANOS","target":"VARYS","weight":8},{"directed":false,"source":"JOFFREY","target":"SEPTA_MORDANE","weight":5},{"directed":false,"source":"JON","target":"OTHELL_YARWYCK","weight":14},{"directed":false,"source":"JON","target":"OTHOR","weight":5},{"directed":false,"source":"JON_ARRYN","target":"LITTLEFINGER","weight":9},{"directed":false,"source":"JON_ARRYN","target":"LYSA","weight":13},{"directed":false,"source":"JONOS_BRACKEN","target":"ROBB","weight":5},{"directed":false,"source":"JORAH","target":"QOTHO","weight":5},{"directed":false,"source":"LYSA","target":"MORD","weight":5},{"directed":false,"source":"MAESTER_LUWIN","target":"NED","weight":5},{"directed":false,"source":"MARILLION","target":"RODRIK","weight":5},{"directed":false,"source":"MARILLION","target":"TYRION","weight":5},{"directed":false,"source":"MASHA_HEDDLE","target":"TYRION","weight":5},{"directed":false,"source":"MOUNTAIN","target":"NED","weight":5},{"directed":false,"source":"RENLY","target":"SANSA","weight":7},{"directed":false,"source":"ROBB","target":"ROBERT","weight":7},{"directed":false,"source":"ROBB","target":"TYWIN","weight":22},{"directed":false,"source":"ROBB","target":"WALDER","weight":35},{"directed":false,"source":"ROBERT","target":"STANNIS","weight":18},{"directed":false,"source":"AERYS","target":"RICKARD_STARK","weight":4},{"directed":false,"source":"ALLISER_THORNE","target":"RAST","weight":4},{"directed":false,"source":"ARYA","target":"ILYN_PAYNE","weight":6},{"directed":false,"source":"BAELOR","target":"YOREN","weight":4},{"directed":false,"source":"BARRISTAN","target":"JAIME","weight":4},{"directed":false,"source":"BARRISTAN","target":"LITTLEFINGER","weight":4},{"directed":false,"source":"BARRISTAN","target":"PYCELLE","weight":4},{"directed":false,"source":"BRAN","target":"CERSEI","weight":4},{"directed":false,"source":"BRONN","target":"VARDIS_EGEN","weight":4},{"directed":false,"source":"CATELYN","target":"JON_ARRYN","weight":6},{"directed":false,"source":"CATELYN","target":"MARILLION","weight":4},{"directed":false,"source":"CATELYN","target":"TYWIN","weight":6},{"directed":false,"source":"CERSEI","target":"HOUND","weight":22},{"directed":false,"source":"DAENERYS","target":"VARYS","weight":132},{"directed":false,"source":"DAREON","target":"JON","weight":4},{"directed":false,"source":"DAREON","target":"SAM","weight":6},{"directed":false,"source":"GARED","target":"WILL","weight":4},{"directed":false,"source":"GRENN","target":"JEOR","weight":11},{"directed":false,"source":"HOUND","target":"LORAS","weight":4},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"LITTLEFINGER","weight":4},{"directed":false,"source":"ILYN_PAYNE","target":"JOFFREY","weight":6},{"directed":false,"source":"ILYN_PAYNE","target":"NED","weight":6},{"directed":false,"source":"ILYN_PAYNE","target":"SANSA","weight":8},{"directed":false,"source":"ILYN_PAYNE","target":"YOREN","weight":4},{"directed":false,"source":"JAIME","target":"ROS","weight":4},{"directed":false,"source":"JAIME","target":"THEON","weight":8},{"directed":false,"source":"JORY_CASSEL","target":"ROBERT","weight":4},{"directed":false,"source":"LANCEL","target":"NED","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"SEPTA_MORDANE","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"TYWIN","weight":38},{"directed":false,"source":"LORAS","target":"MOUNTAIN","weight":4},{"directed":false,"source":"LORAS","target":"NED","weight":4},{"directed":false,"source":"LORAS","target":"SANSA","weight":37},{"directed":false,"source":"LYANNA","target":"NED","weight":41},{"directed":false,"source":"MIRRI_MAZ_DUUR","target":"RAKHARO","weight":4},{"directed":false,"source":"MOUNTAIN","target":"ROBERT","weight":4},{"directed":false,"source":"MOUNTAIN","target":"SANSA","weight":4},{"directed":false,"source":"MYCAH","target":"SANSA","weight":4},{"directed":false,"source":"NED","target":"RICKARD_STARK","weight":9},{"directed":false,"source":"OLD_NAN","target":"ROBB","weight":4},{"directed":false,"source":"ROYCE","target":"WILL","weight":4},{"directed":false,"source":"RYGER_RIVERS","target":"WALDER","weight":4},{"directed":false,"source":"SANSA","target":"YOREN","weight":4},{"directed":false,"source":"SHAE","target":"TYWIN","weight":29},{"directed":false,"source":"STEVRON_FREY","target":"WALDER","weight":4},{"directed":false,"source":"WAYMAR_ROYCE","target":"WILL","weight":4},{"directed":false,"source":"ADDAM_MARBRAND","target":"KEVAN","weight":3},{"directed":false,"source":"ADDAM_MARBRAND","target":"LEO_LEFFORD","weight":3},{"directed":false,"source":"AERYS","target":"JAIME","weight":13},{"directed":false,"source":"AERYS","target":"RHAEGAR","weight":3},{"directed":false,"source":"ALLISER_THORNE","target":"OTHELL_YARWYCK","weight":12},{"directed":false,"source":"ARYA","target":"JAIME","weight":8},{"directed":false,"source":"ARYA","target":"PYCELLE","weight":3},{"directed":false,"source":"ASSASSIN","target":"CATELYN","weight":3},{"directed":false,"source":"BAELOR","target":"ILYN_PAYNE","weight":3},{"directed":false,"source":"BALON","target":"THEON","weight":84},{"directed":false,"source":"BARRISTAN","target":"LANCEL","weight":3},{"directed":false,"source":"BARRISTAN","target":"RENLY","weight":3},{"directed":false,"source":"BERIC","target":"NED","weight":8},{"directed":false,"source":"BRAN","target":"WILL","weight":3},{"directed":false,"source":"BRANDON_STARK","target":"NED","weight":3},{"directed":false,"source":"BRONN","target":"MORD","weight":3},{"directed":false,"source":"BRONN","target":"ROBIN","weight":3},{"directed":false,"source":"CATELYN","target":"HOSTER","weight":13},{"directed":false,"source":"CATELYN","target":"JOFFREY","weight":8},{"directed":false,"source":"CATELYN","target":"MASHA_HEDDLE","weight":3},{"directed":false,"source":"CATELYN","target":"YOREN","weight":3},{"directed":false,"source":"CERSEI","target":"ILYN_PAYNE","weight":8},{"directed":false,"source":"CERSEI","target":"JON","weight":30},{"directed":false,"source":"CERSEI","target":"JON_ARRYN","weight":3},{"directed":false,"source":"CERSEI","target":"LANCEL","weight":60},{"directed":false,"source":"CERSEI","target":"RENLY","weight":3},{"directed":false,"source":"CERSEI","target":"TYWIN","weight":214},{"directed":false,"source":"COHOLLO","target":"DROGO","weight":3},{"directed":false,"source":"DAENERYS","target":"NED","weight":6},{"directed":false,"source":"DOREAH","target":"DROGO","weight":3},{"directed":false,"source":"DOREAH","target":"WINE_MERCHANT","weight":3},{"directed":false,"source":"GENDRY","target":"HOT_PIE","weight":40},{"directed":false,"source":"GREATJON_UMBER","target":"JAIME","weight":3},{"directed":false,"source":"GREATJON_UMBER","target":"TYWIN","weight":3},{"directed":false,"source":"HODOR","target":"ROBB","weight":3},{"directed":false,"source":"HODOR","target":"THEON","weight":8},{"directed":false,"source":"HODOR","target":"TYRION","weight":3},{"directed":false,"source":"HOSTER","target":"WALDER","weight":6},{"directed":false,"source":"HOUND","target":"ILYN_PAYNE","weight":5},{"directed":false,"source":"IRRI","target":"JHIQUI","weight":3},{"directed":false,"source":"IRRI","target":"VISERYS","weight":3},{"directed":false,"source":"JANOS","target":"RENLY","weight":3},{"directed":false,"source":"JEOR","target":"NED","weight":3},{"directed":false,"source":"JEOR","target":"ROBERT","weight":3},{"directed":false,"source":"JOFFREY","target":"RENLY","weight":13},{"directed":false,"source":"JOFFREY","target":"TYWIN","weight":98},{"directed":false,"source":"JOFFREY","target":"YOREN","weight":3},{"directed":false,"source":"JON","target":"ROBERT","weight":6},{"directed":false,"source":"JON","target":"WILL","weight":3},{"directed":false,"source":"JON_ARRYN","target":"PYCELLE","weight":5},{"directed":false,"source":"JON_ARRYN","target":"ROBIN","weight":5},{"directed":false,"source":"JORAH","target":"RHAEGO","weight":3},{"directed":false,"source":"LITTLEFINGER","target":"STANNIS","weight":16},{"directed":false,"source":"LORAS","target":"ROBERT","weight":3},{"directed":false,"source":"LYANNA","target":"ROBERT","weight":5},{"directed":false,"source":"MERYN_TRANT","target":"NED","weight":3},{"directed":false,"source":"MORD","target":"ROBIN","weight":3},{"directed":false,"source":"MORD","target":"VARDIS_EGEN","weight":3},{"directed":false,"source":"MYCAH","target":"NED","weight":3},{"directed":false,"source":"MYRCELLA","target":"TYRION","weight":16},{"directed":false,"source":"NED","target":"PYP","weight":3},{"directed":false,"source":"NED","target":"WILL","weight":3},{"directed":false,"source":"OSHA","target":"RICKON","weight":34},{"directed":false,"source":"QOTHO","target":"RAKHARO","weight":3},{"directed":false,"source":"RAKHARO","target":"VISERYS","weight":3},{"directed":false,"source":"RAKHARO","target":"WINE_MERCHANT","weight":3},{"directed":false,"source":"RAST","target":"TYRION","weight":3},{"directed":false,"source":"RENLY","target":"ROBB","weight":11},{"directed":false,"source":"RICKON","target":"ROBB","weight":5},{"directed":false,"source":"ROBIN","target":"VARDIS_EGEN","weight":3},{"directed":false,"source":"THEON","target":"WALDER","weight":3},{"directed":false,"source":"VARYS","target":"YOREN","weight":3},{"directed":false,"source":"ADDAM_MARBRAND","target":"TYWIN","weight":2},{"directed":false,"source":"AEGON","target":"AERYS","weight":2},{"directed":false,"source":"AEGON","target":"MAESTER_AEMON","weight":5},{"directed":false,"source":"AERYS","target":"BARRISTAN","weight":7},{"directed":false,"source":"AERYS","target":"CATELYN","weight":2},{"directed":false,"source":"AERYS","target":"JORAH","weight":2},{"directed":false,"source":"AERYS","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"AERYS","target":"RENLY","weight":2},{"directed":false,"source":"AERYS","target":"SANSA","weight":4},{"directed":false,"source":"AERYS","target":"SEPTA_MORDANE","weight":2},{"directed":false,"source":"ALLISER_THORNE","target":"MAESTER_AEMON","weight":17},{"directed":false,"source":"ARYA","target":"ILLYRIO","weight":2},{"directed":false,"source":"ARYA","target":"LOMMY_GREENHANDS","weight":2},{"directed":false,"source":"ARYA","target":"TYRION","weight":18},{"directed":false,"source":"ASSASSIN","target":"BRAN","weight":2},{"directed":false,"source":"ASSASSIN","target":"ROBB","weight":2},{"directed":false,"source":"BAELOR","target":"CERSEI","weight":2},{"directed":false,"source":"BAELOR","target":"HOUND","weight":2},{"directed":false,"source":"BAELOR","target":"JOFFREY","weight":4},{"directed":false,"source":"BAELOR","target":"PYCELLE","weight":2},{"directed":false,"source":"BAELOR","target":"SANSA","weight":2},{"directed":false,"source":"BALON","target":"TYRION","weight":2},{"directed":false,"source":"BENJEN","target":"CATELYN","weight":2},{"directed":false,"source":"BENJEN","target":"CERSEI","weight":2},{"directed":false,"source":"BENJEN","target":"JEOR","weight":2},{"directed":false,"source":"BENJEN","target":"ROBERT","weight":2},{"directed":false,"source":"BERIC","target":"ROBERT","weight":2},{"directed":false,"source":"BORCAS","target":"DAREON","weight":2},{"directed":false,"source":"BORCAS","target":"PYP","weight":2},{"directed":false,"source":"BOWEN_MARSH","target":"DAREON","weight":2},{"directed":false,"source":"BOWEN_MARSH","target":"PYP","weight":2},{"directed":false,"source":"BRAN","target":"BRANDON_STARK","weight":2},{"directed":false,"source":"BRAN","target":"HOUND","weight":2},{"directed":false,"source":"BRANDON_STARK","target":"CATELYN","weight":5},{"directed":false,"source":"BRANDON_STARK","target":"JON","weight":2},{"directed":false,"source":"BRANDON_STARK","target":"RICKARD_STARK","weight":2},{"directed":false,"source":"BRONN","target":"KEVAN","weight":2},{"directed":false,"source":"BRONN","target":"MARILLION","weight":2},{"directed":false,"source":"CATELYN","target":"DAENERYS","weight":2},{"directed":false,"source":"CATELYN","target":"HOUND","weight":4},{"directed":false,"source":"CATELYN","target":"STEVRON_FREY","weight":2},{"directed":false,"source":"CERSEI","target":"JEOR","weight":2},{"directed":false,"source":"CERSEI","target":"LYANNA","weight":2},{"directed":false,"source":"CERSEI","target":"MERYN_TRANT","weight":30},{"directed":false,"source":"CERSEI","target":"ROS","weight":2},{"directed":false,"source":"CERSEI","target":"STANNIS","weight":9},{"directed":false,"source":"CERSEI","target":"YOREN","weight":2},{"directed":false,"source":"DAENERYS","target":"JHIQUI","weight":2},{"directed":false,"source":"DAENERYS","target":"SANSA","weight":73},{"directed":false,"source":"DAREON","target":"GRENN","weight":2},{"directed":false,"source":"DAREON","target":"JEOR","weight":2},{"directed":false,"source":"DAREON","target":"LUKE","weight":2},{"directed":false,"source":"DAREON","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"DAREON","target":"RAST","weight":2},{"directed":false,"source":"DOREAH","target":"IROGENIA","weight":2},{"directed":false,"source":"DOREAH","target":"JHIQUI","weight":2},{"directed":false,"source":"DOREAH","target":"JORAH","weight":9},{"directed":false,"source":"DROGO","target":"IRRI","weight":2},{"directed":false,"source":"DROGO","target":"ROBERT","weight":2},{"directed":false,"source":"GALBART_GLOVER","target":"GREATJON_UMBER","weight":2},{"directed":false,"source":"GALBART_GLOVER","target":"JONOS_BRACKEN","weight":2},{"directed":false,"source":"GALBART_GLOVER","target":"ROBB","weight":2},{"directed":false,"source":"GENDRY","target":"VARYS","weight":2},{"directed":false,"source":"GENDRY","target":"YOREN","weight":9},{"directed":false,"source":"GREATJON_UMBER","target":"NED","weight":2},{"directed":false,"source":"GREATJON_UMBER","target":"RENLY","weight":2},{"directed":false,"source":"GREATJON_UMBER","target":"RICKARD_KARSTARK","weight":2},{"directed":false,"source":"GREATJON_UMBER","target":"STANNIS","weight":2},{"directed":false,"source":"GREATJON_UMBER","target":"WALDER","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"NED","weight":2},{"directed":false,"source":"HODOR","target":"OSHA","weight":38},{"directed":false,"source":"HOUND","target":"JAIME","weight":15},{"directed":false,"source":"HOUND","target":"ROBB","weight":4},{"directed":false,"source":"HOUND","target":"YOREN","weight":2},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"JON_ARRYN","weight":2},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"MOUNTAIN","weight":2},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"SANSA","weight":2},{"directed":false,"source":"ILLYRIO","target":"JORAH","weight":2},{"directed":false,"source":"ILYN_PAYNE","target":"MERYN_TRANT","weight":4},{"directed":false,"source":"ILYN_PAYNE","target":"VARYS","weight":2},{"directed":false,"source":"JAIME","target":"JON_ARRYN","weight":2},{"directed":false,"source":"JAIME","target":"RICKARD_STARK","weight":2},{"directed":false,"source":"JAIME","target":"SANSA","weight":30},{"directed":false,"source":"JAIME","target":"TYSHA","weight":2},{"directed":false,"source":"JANOS","target":"LITTLEFINGER","weight":6},{"directed":false,"source":"JANOS","target":"PYCELLE","weight":4},{"directed":false,"source":"JAREMY_RYKKER","target":"JEOR","weight":2},{"directed":false,"source":"JAREMY_RYKKER","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"JAREMY_RYKKER","target":"PYP","weight":2},{"directed":false,"source":"JEOR","target":"JOFFREY","weight":2},{"directed":false,"source":"JOANNA","target":"TYRION","weight":2},{"directed":false,"source":"JOFFREY","target":"JON","weight":2},{"directed":false,"source":"JOFFREY","target":"TOMMEN","weight":26},{"directed":false,"source":"JOFFREY","target":"WILL","weight":2},{"directed":false,"source":"JON","target":"RODRIK","weight":2},{"directed":false,"source":"JON","target":"ROS","weight":2},{"directed":false,"source":"JON_ARRYN","target":"VARYS","weight":2},{"directed":false,"source":"JORAH","target":"LITTLE_BIRD","weight":2},{"directed":false,"source":"JORAH","target":"NED","weight":2},{"directed":false,"source":"JORAH","target":"VARYS","weight":25},{"directed":false,"source":"JORY_CASSEL","target":"MHAEGEN","weight":2},{"directed":false,"source":"JORY_CASSEL","target":"THEON","weight":2},{"directed":false,"source":"JOYEUSE","target":"WALDER","weight":6},{"directed":false,"source":"KEVAN","target":"LEO_LEFFORD","weight":2},{"directed":false,"source":"KEVAN","target":"SHAGGA","weight":2},{"directed":false,"source":"LANCEL","target":"RENLY","weight":2},{"directed":false,"source":"LEO_LEFFORD","target":"TYRION","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"LORAS","weight":19},{"directed":false,"source":"LITTLEFINGER","target":"MHAEGEN","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"YOREN","weight":2},{"directed":false,"source":"LORAS","target":"MACE","weight":8},{"directed":false,"source":"LUKE","target":"PYP","weight":2},{"directed":false,"source":"MAESTER_LUWIN","target":"ROBERT","weight":2},{"directed":false,"source":"MAESTER_LUWIN","target":"RODRIK","weight":7},{"directed":false,"source":"MAESTER_LUWIN","target":"SANSA","weight":2},{"directed":false,"source":"MARILLION","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"MARILLION","target":"YOREN","weight":2},{"directed":false,"source":"MELESSA","target":"SAM","weight":25},{"directed":false,"source":"MORD","target":"RODRIK","weight":2},{"directed":false,"source":"NED","target":"ROOSE_BOLTON","weight":2},{"directed":false,"source":"NED","target":"ROS","weight":2},{"directed":false,"source":"NED","target":"STEFFON","weight":2},{"directed":false,"source":"NED","target":"VARLY","weight":2},{"directed":false,"source":"OLD_NAN","target":"THEON","weight":2},{"directed":false,"source":"OTHELL_YARWYCK","target":"PYP","weight":2},{"directed":false,"source":"OTHOR","target":"PYP","weight":2},{"directed":false,"source":"OTHOR","target":"SAM","weight":2},{"directed":false,"source":"PYCELLE","target":"TYWIN","weight":28},{"directed":false,"source":"PYCELLE","target":"YOREN","weight":2},{"directed":false,"source":"RANDYLL","target":"SAM","weight":30},{"directed":false,"source":"RENLY","target":"TOMARD","weight":2},{"directed":false,"source":"RHAEGAR","target":"ROBERT","weight":6},{"directed":false,"source":"RHAEGO","target":"VISERYS","weight":2},{"directed":false,"source":"RICKARD_KARSTARK","target":"ROBB","weight":52},{"directed":false,"source":"RICKARD_KARSTARK","target":"THEON","weight":4},{"directed":false,"source":"ROBB","target":"STANNIS","weight":11},{"directed":false,"source":"ROBB","target":"VARYS","weight":4},{"directed":false,"source":"ROBERT","target":"ROS","weight":2},{"directed":false,"source":"ROBERT","target":"TOMMEN","weight":4},{"directed":false,"source":"RODRIK","target":"TYWIN","weight":2},{"directed":false,"source":"SANSA","target":"STANNIS","weight":8},{"directed":false,"source":"STANNIS","target":"TOMARD","weight":2},{"directed":false,"source":"THEON","target":"WILL","weight":2},{"directed":false,"source":"TYRION","target":"TYSHA","weight":2},{"directed":false,"source":"TYRION","target":"VARYS","weight":511},{"directed":false,"source":"ARYA","target":"JAQEN","weight":346},{"directed":false,"source":"DAVOS","target":"STANNIS","weight":316},{"directed":false,"source":"JON","target":"YGRITTE","weight":286},{"directed":false,"source":"ROBB","target":"TALISA","weight":197},{"directed":false,"source":"ARYA","target":"TYWIN","weight":103},{"directed":false,"source":"THEON","target":"YARA","weight":218},{"directed":false,"source":"DAENERYS","target":"XARO","weight":80},{"directed":false,"source":"JON","target":"QHORIN","weight":73},{"directed":false,"source":"SANSA","target":"SHAE","weight":122},{"directed":false,"source":"DAENERYS","target":"SPICE_KING","weight":58},{"directed":false,"source":"DAVOS","target":"MATTHOS","weight":59},{"directed":false,"source":"MELISANDRE","target":"STANNIS","weight":171},{"directed":false,"source":"BRIENNE","target":"CATELYN","weight":73},{"directed":false,"source":"BRIENNE","target":"JAIME","weight":397},{"directed":false,"source":"PYCELLE","target":"TYRION","weight":64},{"directed":false,"source":"DAGMER","target":"THEON","weight":48},{"directed":false,"source":"ALTON","target":"JAIME","weight":48},{"directed":false,"source":"DAVOS","target":"MELISANDRE","weight":183},{"directed":false,"source":"JANOS","target":"TYRION","weight":39},{"directed":false,"source":"LORAS","target":"TYRION","weight":51},{"directed":false,"source":"LANCEL","target":"TYRION","weight":37},{"directed":false,"source":"PODRICK","target":"TYRION","weight":186},{"directed":false,"source":"MARGAERY","target":"RENLY","weight":39},{"directed":false,"source":"EDDISON_TOLLETT","target":"SAM","weight":72},{"directed":false,"source":"ROBB","target":"ROOSE_BOLTON","weight":51},{"directed":false,"source":"BRIENNE","target":"RENLY","weight":39},{"directed":false,"source":"DAENERYS","target":"KOVARRO","weight":31},{"directed":false,"source":"CATELYN","target":"RENLY","weight":30},{"directed":false,"source":"CRASTER","target":"JEOR","weight":46},{"directed":false,"source":"LITTLEFINGER","target":"MARGAERY","weight":28},{"directed":false,"source":"QHORIN","target":"YGRITTE","weight":28},{"directed":false,"source":"DAVOS","target":"SALLADHOR","weight":69},{"directed":false,"source":"EDDISON_TOLLETT","target":"GRENN","weight":70},{"directed":false,"source":"CERSEI","target":"TOMMEN","weight":160},{"directed":false,"source":"SANSA","target":"TYRION","weight":249},{"directed":false,"source":"GILLY","target":"SAM","weight":392},{"directed":false,"source":"DAENERYS","target":"PYATT_PREE","weight":23},{"directed":false,"source":"LORAS","target":"MARGAERY","weight":115},{"directed":false,"source":"ALTON","target":"ROBB","weight":22},{"directed":false,"source":"ROS","target":"VARYS","weight":47},{"directed":false,"source":"BLACK_LORREN","target":"THEON","weight":21},{"directed":false,"source":"CERSEI","target":"SHAE","weight":28},{"directed":false,"source":"MATTHOS","target":"STANNIS","weight":21},{"directed":false,"source":"SPICE_KING","target":"XARO","weight":20},{"directed":false,"source":"STANNIS","target":"TYRION","weight":20},{"directed":false,"source":"JORAH","target":"QUAITHE","weight":18},{"directed":false,"source":"CAPTAINS_DAUGHTER","target":"THEON","weight":17},{"directed":false,"source":"CATELYN","target":"RICKARD_KARSTARK","weight":22},{"directed":false,"source":"CRASTER","target":"JON","weight":28},{"directed":false,"source":"DAISY","target":"ROS","weight":17},{"directed":false,"source":"AMORY","target":"ARYA","weight":16},{"directed":false,"source":"ARYA","target":"RORGE","weight":20},{"directed":false,"source":"CRESSEN","target":"DAVOS","weight":16},{"directed":false,"source":"HODOR","target":"RICKON","weight":25},{"directed":false,"source":"LORD_OF_BONES","target":"YGRITTE","weight":20},{"directed":false,"source":"BALON","target":"YARA","weight":49},{"directed":false,"source":"JORAH","target":"KOVARRO","weight":15},{"directed":false,"source":"AMORY","target":"TYWIN","weight":14},{"directed":false,"source":"MATTHOS","target":"SALLADHOR","weight":14},{"directed":false,"source":"BRONN","target":"HOUND","weight":16},{"directed":false,"source":"CATELYN","target":"STANNIS","weight":13},{"directed":false,"source":"DONTOS","target":"JOFFREY","weight":19},{"directed":false,"source":"DOREAH","target":"XARO","weight":13},{"directed":false,"source":"HAYLENE","target":"TYRION","weight":13},{"directed":false,"source":"JEOR","target":"QHORIN","weight":13},{"directed":false,"source":"MERYN_TRANT","target":"TYRION","weight":29},{"directed":false,"source":"CERSEI","target":"MYRCELLA","weight":34},{"directed":false,"source":"DAVOS","target":"RENLY","weight":12},{"directed":false,"source":"JOFFREY","target":"LANCEL","weight":12},{"directed":false,"source":"JON","target":"LORD_OF_BONES","weight":20},{"directed":false,"source":"JORAH","target":"XARO","weight":12},{"directed":false,"source":"MOUNTAIN","target":"TYWIN","weight":20},{"directed":false,"source":"BRONN","target":"VARYS","weight":16},{"directed":false,"source":"CATELYN","target":"TALISA","weight":44},{"directed":false,"source":"CERSEI","target":"JANOS","weight":11},{"directed":false,"source":"SHAE","target":"VARYS","weight":33},{"directed":false,"source":"BRONN","target":"HAYLENE","weight":10},{"directed":false,"source":"CRESSEN","target":"MELISANDRE","weight":10},{"directed":false,"source":"GILLY","target":"JON","weight":25},{"directed":false,"source":"HOT_PIE","target":"LOMMY","weight":10},{"directed":false,"source":"KOVARRO","target":"XARO","weight":10},{"directed":false,"source":"PODRICK","target":"VARYS","weight":17},{"directed":false,"source":"QHORIN","target":"LORD_OF_BONES","weight":10},{"directed":false,"source":"ALTON","target":"CERSEI","weight":9},{"directed":false,"source":"BRONN","target":"JOFFREY","weight":15},{"directed":false,"source":"CATELYN","target":"LORAS","weight":9},{"directed":false,"source":"HODOR","target":"MAESTER_LUWIN","weight":9},{"directed":false,"source":"HOUND","target":"LANCEL","weight":9},{"directed":false,"source":"JAQEN","target":"RORGE","weight":9},{"directed":false,"source":"JOFFREY","target":"ROS","weight":9},{"directed":false,"source":"JOFFREY","target":"STANNIS","weight":14},{"directed":false,"source":"MANCE","target":"QHORIN","weight":9},{"directed":false,"source":"PYATT_PREE","target":"XARO","weight":9},{"directed":false,"source":"SANSA","target":"TOMMEN","weight":13},{"directed":false,"source":"AMORY","target":"YOREN","weight":8},{"directed":false,"source":"ARYA","target":"BITER","weight":8},{"directed":false,"source":"BALON","target":"ROBB","weight":10},{"directed":false,"source":"BITER","target":"RORGE","weight":10},{"directed":false,"source":"CATELYN","target":"JACKS","weight":8},{"directed":false,"source":"EDDISON_TOLLETT","target":"JON","weight":117},{"directed":false,"source":"JOFFREY","target":"LORAS","weight":19},{"directed":false,"source":"JOFFREY","target":"MYRCELLA","weight":8},{"directed":false,"source":"MANDON","target":"TYRION","weight":8},{"directed":false,"source":"MELISANDRE","target":"RENLY","weight":8},{"directed":false,"source":"REGINALD","target":"TYWIN","weight":8},{"directed":false,"source":"ARYA","target":"POLLIVER","weight":26},{"directed":false,"source":"BLACK_LORREN","target":"DAGMER","weight":7},{"directed":false,"source":"BRIENNE","target":"JACKS","weight":7},{"directed":false,"source":"BRIENNE","target":"LORAS","weight":9},{"directed":false,"source":"DAISY","target":"JOFFREY","weight":7},{"directed":false,"source":"THEON","target":"WINTERFELL_SHEPHERD","weight":7},{"directed":false,"source":"ARYA","target":"LOMMY","weight":8},{"directed":false,"source":"ARYA","target":"MOUNTAIN","weight":10},{"directed":false,"source":"BRAN","target":"DAGMER","weight":6},{"directed":false,"source":"BRAN","target":"FARLEN","weight":6},{"directed":false,"source":"BRONN","target":"LANCEL","weight":6},{"directed":false,"source":"BRONN","target":"PYCELLE","weight":8},{"directed":false,"source":"CRASTER","target":"GILLY","weight":6},{"directed":false,"source":"GENDRY","target":"TICKLER","weight":6},{"directed":false,"source":"LOMMY","target":"POLLIVER","weight":6},{"directed":false,"source":"MANCE","target":"YGRITTE","weight":16},{"directed":false,"source":"MANDON","target":"PODRICK","weight":6},{"directed":false,"source":"RICKON","target":"THEON","weight":13},{"directed":false,"source":"ROOSE_BOLTON","target":"TALISA","weight":13},{"directed":false,"source":"ALTON","target":"TORRHEN","weight":5},{"directed":false,"source":"ARYA","target":"TICKLER","weight":5},{"directed":false,"source":"BALON","target":"NED","weight":5},{"directed":false,"source":"BITER","target":"JAQEN","weight":5},{"directed":false,"source":"BRIENNE","target":"MARGAERY","weight":17},{"directed":false,"source":"BRIENNE","target":"ROBB","weight":5},{"directed":false,"source":"BRIENNE","target":"STANNIS","weight":18},{"directed":false,"source":"BRONN","target":"MERYN_TRANT","weight":13},{"directed":false,"source":"CATELYN","target":"MARGAERY","weight":5},{"directed":false,"source":"CERSEI","target":"LORAS","weight":48},{"directed":false,"source":"CRASTER","target":"SAM","weight":13},{"directed":false,"source":"CRESSEN","target":"STANNIS","weight":5},{"directed":false,"source":"DAGMER","target":"MAESTER_LUWIN","weight":5},{"directed":false,"source":"DROWNED_PRIEST","target":"THEON","weight":5},{"directed":false,"source":"GERARD","target":"RENLY","weight":5},{"directed":false,"source":"JOFFREY","target":"PODRICK","weight":10},{"directed":false,"source":"JON","target":"MANCE","weight":124},{"directed":false,"source":"JORAH","target":"PYATT_PREE","weight":5},{"directed":false,"source":"LORAS","target":"STANNIS","weight":5},{"directed":false,"source":"MYRCELLA","target":"SANSA","weight":5},{"directed":false,"source":"MYRCELLA","target":"TOMMEN","weight":9},{"directed":false,"source":"PYCELLE","target":"TIMETT","weight":5},{"directed":false,"source":"QHORIN","target":"SAM","weight":5},{"directed":false,"source":"TYWIN","target":"VARYS","weight":33},{"directed":false,"source":"ALTON","target":"RICKARD_KARSTARK","weight":4},{"directed":false,"source":"BARRA","target":"MHAEGEN","weight":4},{"directed":false,"source":"BRONN","target":"SANSA","weight":7},{"directed":false,"source":"BRONN","target":"TIMETT","weight":4},{"directed":false,"source":"CATELYN","target":"COLEN","weight":4},{"directed":false,"source":"CATELYN","target":"ROOSE_BOLTON","weight":17},{"directed":false,"source":"CERSEI","target":"PODRICK","weight":9},{"directed":false,"source":"DAENERYS","target":"QUAITHE","weight":4},{"directed":false,"source":"DAENERYS","target":"SILK_KING","weight":4},{"directed":false,"source":"DAGMER","target":"RICKON","weight":4},{"directed":false,"source":"DONTOS","target":"MERYN_TRANT","weight":4},{"directed":false,"source":"DOREAH","target":"KOVARRO","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"GILLY","weight":8},{"directed":false,"source":"GENDRY","target":"JAQEN","weight":4},{"directed":false,"source":"GENDRY","target":"LOMMY","weight":4},{"directed":false,"source":"GENDRY","target":"TYWIN","weight":6},{"directed":false,"source":"HAYLENE","target":"HOUND","weight":4},{"directed":false,"source":"HAYLENE","target":"JOFFREY","weight":4},{"directed":false,"source":"HOUND","target":"PODRICK","weight":16},{"directed":false,"source":"ILYN_PAYNE","target":"SHAE","weight":4},{"directed":false,"source":"JAIME","target":"RICKARD_KARSTARK","weight":4},{"directed":false,"source":"JAIME","target":"STANNIS","weight":9},{"directed":false,"source":"JANOS","target":"JOFFREY","weight":4},{"directed":false,"source":"JANOS","target":"MHAEGEN","weight":4},{"directed":false,"source":"JANOS","target":"ROS","weight":4},{"directed":false,"source":"JOFFREY","target":"MANDON","weight":4},{"directed":false,"source":"JOFFREY","target":"MARGAERY","weight":110},{"directed":false,"source":"LANCEL","target":"SANSA","weight":4},{"directed":false,"source":"MAESTER_LUWIN","target":"RICKON","weight":4},{"directed":false,"source":"MATTHOS","target":"MELISANDRE","weight":4},{"directed":false,"source":"RICKARD_KARSTARK","target":"TORRHEN","weight":4},{"directed":false,"source":"ROBB","target":"YARA","weight":4},{"directed":false,"source":"STANNIS","target":"VARYS","weight":6},{"directed":false,"source":"ALTON","target":"TYRION","weight":3},{"directed":false,"source":"AMORY","target":"JAQEN","weight":3},{"directed":false,"source":"AMORY","target":"POLLIVER","weight":3},{"directed":false,"source":"ARYA","target":"VISENYA","weight":3},{"directed":false,"source":"BLACK_LORREN","target":"RODRIK","weight":3},{"directed":false,"source":"BRAN","target":"JOFFREY","weight":3},{"directed":false,"source":"BRAN","target":"WINTERFELL_SHEPHERD","weight":3},{"directed":false,"source":"BRONN","target":"JANOS","weight":3},{"directed":false,"source":"BRONN","target":"PODRICK","weight":61},{"directed":false,"source":"CERSEI","target":"MANDON","weight":3},{"directed":false,"source":"CRASTER","target":"EDDISON_TOLLETT","weight":12},{"directed":false,"source":"DAENERYS","target":"MALAKKO","weight":3},{"directed":false,"source":"DAGMER","target":"OSHA","weight":3},{"directed":false,"source":"DAGMER","target":"RODRIK","weight":3},{"directed":false,"source":"FARLEN","target":"THEON","weight":3},{"directed":false,"source":"GENDRY","target":"MOUNTAIN","weight":3},{"directed":false,"source":"GENDRY","target":"RORGE","weight":3},{"directed":false,"source":"HOT_PIE","target":"JAQEN","weight":3},{"directed":false,"source":"HOT_PIE","target":"MOUNTAIN","weight":3},{"directed":false,"source":"HOUND","target":"SHAE","weight":3},{"directed":false,"source":"IRRI","target":"KOVARRO","weight":3},{"directed":false,"source":"IRRI","target":"XARO","weight":3},{"directed":false,"source":"JAIME","target":"MATTHOS","weight":3},{"directed":false,"source":"JAIME","target":"TORRHEN","weight":3},{"directed":false,"source":"JANOS","target":"PODRICK","weight":3},{"directed":false,"source":"JAQEN","target":"TYWIN","weight":3},{"directed":false,"source":"JOFFREY","target":"TALISA","weight":3},{"directed":false,"source":"JORAH","target":"SPICE_KING","weight":3},{"directed":false,"source":"KOVARRO","target":"MALAKKO","weight":3},{"directed":false,"source":"KOVARRO","target":"PYATT_PREE","weight":3},{"directed":false,"source":"LANCEL","target":"STANNIS","weight":3},{"directed":false,"source":"LITTLEFINGER","target":"ROBB","weight":5},{"directed":false,"source":"LITTLEFINGER","target":"ROBIN","weight":43},{"directed":false,"source":"LORAS","target":"PYCELLE","weight":5},{"directed":false,"source":"LORAS","target":"TYWIN","weight":20},{"directed":false,"source":"MAESTER_LUWIN","target":"PORTAN","weight":3},{"directed":false,"source":"MAESTER_LUWIN","target":"WINTERFELL_SHEPHERD","weight":3},{"directed":false,"source":"MALAKKO","target":"XARO","weight":3},{"directed":false,"source":"MANCE","target":"LORD_OF_BONES","weight":3},{"directed":false,"source":"MOUNTAIN","target":"POLLIVER","weight":5},{"directed":false,"source":"MYRCELLA","target":"ROBIN","weight":3},{"directed":false,"source":"NED","target":"YARA","weight":3},{"directed":false,"source":"PODRICK","target":"PYCELLE","weight":3},{"directed":false,"source":"PODRICK","target":"SHAE","weight":8},{"directed":false,"source":"PYATT_PREE","target":"SPICE_KING","weight":3},{"directed":false,"source":"QUENT","target":"ROBB","weight":3},{"directed":false,"source":"ROBB","target":"SEPTON","weight":3},{"directed":false,"source":"RORGE","target":"YOREN","weight":3},{"directed":false,"source":"SANSA","target":"TYWIN","weight":24},{"directed":false,"source":"SHAE","target":"TOMMEN","weight":3},{"directed":false,"source":"STANNIS","target":"TYWIN","weight":8},{"directed":false,"source":"THEON","target":"VARYS","weight":14},{"directed":false,"source":"TIMETT","target":"TYRION","weight":3},{"directed":false,"source":"TOMMEN","target":"TYRION","weight":15},{"directed":false,"source":"AEGON","target":"ARYA","weight":2},{"directed":false,"source":"AERYS","target":"PYCELLE","weight":2},{"directed":false,"source":"AERYS","target":"TYWIN","weight":2},{"directed":false,"source":"ALTON","target":"TALISA","weight":2},{"directed":false,"source":"AMORY","target":"HOT_PIE","weight":2},{"directed":false,"source":"ARYA","target":"KEVAN","weight":2},{"directed":false,"source":"ARYA","target":"REGINALD","weight":2},{"directed":false,"source":"ARYA","target":"RHAENYS","weight":2},{"directed":false,"source":"BALON","target":"CATELYN","weight":2},{"directed":false,"source":"BARRA","target":"JANOS","weight":2},{"directed":false,"source":"BENJEN","target":"CRASTER","weight":2},{"directed":false,"source":"BILLY","target":"RICKON","weight":2},{"directed":false,"source":"BITER","target":"YOREN","weight":2},{"directed":false,"source":"BLACK_LORREN","target":"MAESTER_LUWIN","weight":2},{"directed":false,"source":"BLACK_LORREN","target":"OSHA","weight":2},{"directed":false,"source":"BOROS","target":"JOFFREY","weight":2},{"directed":false,"source":"BRAN","target":"SANSA","weight":79},{"directed":false,"source":"BRIENNE","target":"COLEN","weight":2},{"directed":false,"source":"BRIENNE","target":"DAVOS","weight":35},{"directed":false,"source":"BRIENNE","target":"LITTLEFINGER","weight":48},{"directed":false,"source":"BRIENNE","target":"MELISANDRE","weight":12},{"directed":false,"source":"BRIENNE","target":"RICKARD_KARSTARK","weight":2},{"directed":false,"source":"BRONN","target":"CERSEI","weight":18},{"directed":false,"source":"CATELYN","target":"DAVOS","weight":2},{"directed":false,"source":"CATELYN","target":"MELISANDRE","weight":2},{"directed":false,"source":"CATELYN","target":"RICKON","weight":4},{"directed":false,"source":"CERSEI","target":"DAVOS","weight":6},{"directed":false,"source":"CERSEI","target":"HAYLENE","weight":2},{"directed":false,"source":"CERSEI","target":"JOANNA","weight":4},{"directed":false,"source":"CERSEI","target":"MATTHOS","weight":2},{"directed":false,"source":"CERSEI","target":"SALLADHOR","weight":2},{"directed":false,"source":"COLEN","target":"LORAS","weight":2},{"directed":false,"source":"COLEN","target":"MARGAERY","weight":2},{"directed":false,"source":"COLEN","target":"RENLY","weight":2},{"directed":false,"source":"CRASTER","target":"MANCE","weight":4},{"directed":false,"source":"CRESSEN","target":"MATTHOS","weight":2},{"directed":false,"source":"DAGMER","target":"FARLEN","weight":2},{"directed":false,"source":"DAGMER","target":"HODOR","weight":2},{"directed":false,"source":"DAGMER","target":"YARA","weight":2},{"directed":false,"source":"DAVOS","target":"FATHER_SEAWORTH","weight":2},{"directed":false,"source":"DAVOS","target":"JOFFREY","weight":2},{"directed":false,"source":"DAVOS","target":"LORAS","weight":2},{"directed":false,"source":"DAVOS","target":"MARYA","weight":2},{"directed":false,"source":"DAVOS","target":"ROBB","weight":4},{"directed":false,"source":"DAVOS","target":"ROBERT","weight":5},{"directed":false,"source":"DONTOS","target":"SANSA","weight":32},{"directed":false,"source":"EDDISON_TOLLETT","target":"JEOR","weight":8},{"directed":false,"source":"FARLEN","target":"RICKON","weight":2},{"directed":false,"source":"FREY_DAUGHTER","target":"ROBB","weight":2},{"directed":false,"source":"GILLY","target":"GRENN","weight":2},{"directed":false,"source":"HARREN","target":"TYWIN","weight":2},{"directed":false,"source":"HAYLENE","target":"PODRICK","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"MYRCELLA","weight":2},{"directed":false,"source":"HOT_PIE","target":"POLLIVER","weight":2},{"directed":false,"source":"HOT_PIE","target":"TICKLER","weight":2},{"directed":false,"source":"HOUND","target":"STANNIS","weight":2},{"directed":false,"source":"HOUND","target":"TOMMEN","weight":2},{"directed":false,"source":"ILYN_PAYNE","target":"LANCEL","weight":2},{"directed":false,"source":"ILYN_PAYNE","target":"TOMMEN","weight":2},{"directed":false,"source":"JACKS","target":"JAIME","weight":2},{"directed":false,"source":"JAQEN","target":"YOREN","weight":2},{"directed":false,"source":"JOFFREY","target":"MATTHOS","weight":2},{"directed":false,"source":"JOFFREY","target":"SHAE","weight":12},{"directed":false,"source":"JORAH","target":"MALAKKO","weight":2},{"directed":false,"source":"KEVAN","target":"STANNIS","weight":2},{"directed":false,"source":"KOVARRO","target":"SPICE_KING","weight":2},{"directed":false,"source":"LANCEL","target":"SHAE","weight":2},{"directed":false,"source":"LANCEL","target":"TOMMEN","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"MYRCELLA","weight":2},{"directed":false,"source":"LORAS","target":"MELISANDRE","weight":2},{"directed":false,"source":"LORAS","target":"ROBB","weight":2},{"directed":false,"source":"LORAS","target":"TOMMEN","weight":25},{"directed":false,"source":"MARGAERY","target":"STANNIS","weight":2},{"directed":false,"source":"MARGAERY","target":"TYWIN","weight":12},{"directed":false,"source":"MATTHOS","target":"ROBERT","weight":2},{"directed":false,"source":"MERYN_TRANT","target":"TOMMEN","weight":2},{"directed":false,"source":"MHAEGEN","target":"ROS","weight":2},{"directed":false,"source":"MYRCELLA","target":"ROBERT","weight":2},{"directed":false,"source":"MYRCELLA","target":"TRYSTANE","weight":26},{"directed":false,"source":"POLLIVER","target":"TYWIN","weight":2},{"directed":false,"source":"PROTESTER","target":"TYRION","weight":2},{"directed":false,"source":"QUAITHE","target":"XARO","weight":2},{"directed":false,"source":"RAMSAY","target":"ROOSE_BOLTON","weight":122},{"directed":false,"source":"RENNICK","target":"ROBB","weight":2},{"directed":false,"source":"RHAENYS","target":"VISENYA","weight":2},{"directed":false,"source":"RICKARD_KARSTARK","target":"ROOSE_BOLTON","weight":11},{"directed":false,"source":"RICKARD_KARSTARK","target":"TALISA","weight":5},{"directed":false,"source":"RICKON","target":"RODRIK","weight":2},{"directed":false,"source":"ROBERT","target":"THEON","weight":2},{"directed":false,"source":"SEPTON","target":"TALISA","weight":2},{"directed":false,"source":"SILK_KING","target":"SPICE_KING","weight":2},{"directed":false,"source":"TALISA","target":"TORRHEN","weight":2},{"directed":false,"source":"THEON","target":"TORRHEN","weight":2},{"directed":false,"source":"TRYSTANE","target":"TYRION","weight":2},{"directed":false,"source":"RAMSAY","target":"THEON","weight":235},{"directed":false,"source":"DAENERYS","target":"MISSANDEI","weight":221},{"directed":false,"source":"BRAN","target":"JOJEN","weight":107},{"directed":false,"source":"ARYA","target":"THOROS","weight":63},{"directed":false,"source":"MARGAERY","target":"SANSA","weight":71},{"directed":false,"source":"JAIME","target":"LOCKE","weight":59},{"directed":false,"source":"BARRISTAN","target":"JORAH","weight":91},{"directed":false,"source":"KRAZNYS_MO_NAKLOZ","target":"MISSANDEI","weight":54},{"directed":false,"source":"JAIME","target":"QYBURN","weight":90},{"directed":false,"source":"DAVOS","target":"GENDRY","weight":111},{"directed":false,"source":"EDMURE","target":"ROBB","weight":46},{"directed":false,"source":"GENDRY","target":"MELISANDRE","weight":48},{"directed":false,"source":"DAVOS","target":"SHIREEN","weight":103},{"directed":false,"source":"OLENNA","target":"VARYS","weight":40},{"directed":false,"source":"BARRISTAN","target":"DAENERYS","weight":107},{"directed":false,"source":"JON","target":"ORELL","weight":37},{"directed":false,"source":"DAARIO","target":"DAENERYS","weight":225},{"directed":false,"source":"OLENNA","target":"TYWIN","weight":49},{"directed":false,"source":"JON","target":"TORMUND","weight":286},{"directed":false,"source":"MEERA","target":"OSHA","weight":34},{"directed":false,"source":"ARYA","target":"BERIC","weight":51},{"directed":false,"source":"CERSEI","target":"MARGAERY","weight":131},{"directed":false,"source":"ORELL","target":"YGRITTE","weight":32},{"directed":false,"source":"OLENNA","target":"TYRION","weight":40},{"directed":false,"source":"OLENNA","target":"SANSA","weight":33},{"directed":false,"source":"ORELL","target":"TORMUND","weight":30},{"directed":false,"source":"BRAN","target":"MEERA","weight":148},{"directed":false,"source":"JAIME","target":"ROOSE_BOLTON","weight":29},{"directed":false,"source":"TORMUND","target":"YGRITTE","weight":58},{"directed":false,"source":"BERIC","target":"THOROS","weight":66},{"directed":false,"source":"JOJEN","target":"OSHA","weight":28},{"directed":false,"source":"BRYNDEN","target":"CATELYN","weight":27},{"directed":false,"source":"ANGUY","target":"ARYA","weight":26},{"directed":false,"source":"BERIC","target":"HOUND","weight":148},{"directed":false,"source":"CERSEI","target":"OLENNA","weight":87},{"directed":false,"source":"JOJEN","target":"MEERA","weight":68},{"directed":false,"source":"DAENERYS","target":"KRAZNYS_MO_NAKLOZ","weight":23},{"directed":false,"source":"HODOR","target":"JOJEN","weight":44},{"directed":false,"source":"ROOSE_BOLTON","target":"WALDER","weight":23},{"directed":false,"source":"MYRANDA","target":"VIOLET","weight":22},{"directed":false,"source":"MARGAERY","target":"OLENNA","weight":123},{"directed":false,"source":"SELYSE","target":"STANNIS","weight":60},{"directed":false,"source":"ANGUY","target":"HOUND","weight":20},{"directed":false,"source":"ANGUY","target":"THOROS","weight":20},{"directed":false,"source":"GENDRY","target":"THOROS","weight":34},{"directed":false,"source":"DAENERYS","target":"RADZAI_MO_ERAZ","weight":19},{"directed":false,"source":"JEOR","target":"RAST","weight":19},{"directed":false,"source":"THEON","target":"TORTURER","weight":19},{"directed":false,"source":"BRYNDEN","target":"EDMURE","weight":29},{"directed":false,"source":"BRAN","target":"SAM","weight":63},{"directed":false,"source":"BRYNDEN","target":"ROBB","weight":17},{"directed":false,"source":"DAARIO","target":"JORAH","weight":104},{"directed":false,"source":"DAARIO","target":"MERO","weight":17},{"directed":false,"source":"HOUND","target":"THOROS","weight":99},{"directed":false,"source":"DAENERYS","target":"MERO","weight":16},{"directed":false,"source":"SHIREEN","target":"STANNIS","weight":70},{"directed":false,"source":"BRIENNE","target":"LOCKE","weight":15},{"directed":false,"source":"CATELYN","target":"EDMURE","weight":17},{"directed":false,"source":"HODOR","target":"MEERA","weight":73},{"directed":false,"source":"JAIME","target":"STEELSHANKS_WALTON","weight":14},{"directed":false,"source":"MANCE","target":"TORMUND","weight":26},{"directed":false,"source":"MELISANDRE","target":"THOROS","weight":16},{"directed":false,"source":"CRASTER","target":"KARL_TANNER","weight":18},{"directed":false,"source":"JORAH","target":"MISSANDEI","weight":44},{"directed":false,"source":"MEERA","target":"RICKON","weight":13},{"directed":false,"source":"MERO","target":"PRENDAHL","weight":13},{"directed":false,"source":"DAENERYS","target":"GREY_WORM","weight":110},{"directed":false,"source":"EDMURE","target":"ROSLIN","weight":12},{"directed":false,"source":"GREY_WORM","target":"JORAH","weight":41},{"directed":false,"source":"JOJEN","target":"SAM","weight":12},{"directed":false,"source":"MARTYN","target":"TALISA","weight":12},{"directed":false,"source":"MYRANDA","target":"THEON","weight":29},{"directed":false,"source":"ROS","target":"SHAE","weight":12},{"directed":false,"source":"THEON","target":"VIOLET","weight":12},{"directed":false,"source":"ANGUY","target":"BERIC","weight":11},{"directed":false,"source":"ANGUY","target":"GENDRY","weight":11},{"directed":false,"source":"EDDISON_TOLLETT","target":"RAST","weight":11},{"directed":false,"source":"LORAS","target":"OLYVAR","weight":26},{"directed":false,"source":"EDMURE","target":"WALDER","weight":15},{"directed":false,"source":"GILLY","target":"MAESTER_AEMON","weight":14},{"directed":false,"source":"LOCKE","target":"ROOSE_BOLTON","weight":12},{"directed":false,"source":"LORAS","target":"OLENNA","weight":25},{"directed":false,"source":"MANCE","target":"ORELL","weight":10},{"directed":false,"source":"TALISA","target":"WALDER","weight":10},{"directed":false,"source":"BRIENNE","target":"ROOSE_BOLTON","weight":9},{"directed":false,"source":"GENDRY","target":"STANNIS","weight":9},{"directed":false,"source":"JOJEN","target":"RICKON","weight":9},{"directed":false,"source":"LITTLE_SAM","target":"GILLY","weight":9},{"directed":false,"source":"LITTLE_SAM","target":"SAM","weight":61},{"directed":false,"source":"ROOSE_BOLTON","target":"TYWIN","weight":13},{"directed":false,"source":"BLACK_WALDER","target":"ROBB","weight":8},{"directed":false,"source":"BRYNDEN","target":"ROOSE_BOLTON","weight":8},{"directed":false,"source":"BRYNDEN","target":"TALISA","weight":8},{"directed":false,"source":"CRASTER","target":"RAST","weight":13},{"directed":false,"source":"DAENERYS","target":"PRENDAHL","weight":8},{"directed":false,"source":"EDMURE","target":"TALISA","weight":8},{"directed":false,"source":"FARMER","target":"JON","weight":8},{"directed":false,"source":"GILLY","target":"MEERA","weight":8},{"directed":false,"source":"HODOR","target":"SAM","weight":8},{"directed":false,"source":"JEOR","target":"KARL_TANNER","weight":10},{"directed":false,"source":"JOFFREY","target":"OLENNA","weight":20},{"directed":false,"source":"MEERA","target":"SAM","weight":8},{"directed":false,"source":"MERYN_TRANT","target":"TARYN_MANT","weight":8},{"directed":false,"source":"ROSLIN","target":"WALDER","weight":8},{"directed":false,"source":"BARRISTAN","target":"MISSANDEI","weight":20},{"directed":false,"source":"BERIC","target":"GENDRY","weight":24},{"directed":false,"source":"DAARIO","target":"MISSANDEI","weight":32},{"directed":false,"source":"DAARIO","target":"PRENDAHL","weight":7},{"directed":false,"source":"EDMURE","target":"LOTHAR","weight":13},{"directed":false,"source":"FARMER","target":"TORMUND","weight":7},{"directed":false,"source":"BARRISTAN","target":"DAARIO","weight":20},{"directed":false,"source":"BERIC","target":"MELISANDRE","weight":12},{"directed":false,"source":"BRYNDEN","target":"WALDER","weight":11},{"directed":false,"source":"CATELYN","target":"JOYEUSE","weight":6},{"directed":false,"source":"DAARIO","target":"GREY_WORM","weight":40},{"directed":false,"source":"FARMER","target":"YGRITTE","weight":6},{"directed":false,"source":"HOT_PIE","target":"THOROS","weight":6},{"directed":false,"source":"JAIME","target":"RENLY","weight":6},{"directed":false,"source":"JORAH","target":"MERO","weight":6},{"directed":false,"source":"MACE","target":"OLENNA","weight":20},{"directed":false,"source":"MERO","target":"MISSANDEI","weight":6},{"directed":false,"source":"ROBB","target":"ROSLIN","weight":6},{"directed":false,"source":"ARYA","target":"MELISANDRE","weight":18},{"directed":false,"source":"BARRISTAN","target":"GREY_WORM","weight":19},{"directed":false,"source":"BLACK_WALDER","target":"EDMURE","weight":14},{"directed":false,"source":"BLACK_WALDER","target":"LOTHAR","weight":20},{"directed":false,"source":"BRYNDEN","target":"RICKARD_KARSTARK","weight":5},{"directed":false,"source":"GENDRY","target":"HOUND","weight":49},{"directed":false,"source":"HOSTER","target":"ROBB","weight":5},{"directed":false,"source":"JOJEN","target":"JON","weight":7},{"directed":false,"source":"JORAH","target":"KRAZNYS_MO_NAKLOZ","weight":5},{"directed":false,"source":"JORAH","target":"ROBERT","weight":5},{"directed":false,"source":"MARGAERY","target":"TYRION","weight":16},{"directed":false,"source":"MARTYN","target":"WILLEM_LANNISTER","weight":5},{"directed":false,"source":"BALON","target":"RAMSAY","weight":4},{"directed":false,"source":"BRAN","target":"ORELL","weight":4},{"directed":false,"source":"CATELYN","target":"ROSLIN","weight":4},{"directed":false,"source":"CERSEI","target":"TARYN_MANT","weight":4},{"directed":false,"source":"EDMURE","target":"FREY_SEPTON","weight":4},{"directed":false,"source":"EDMURE","target":"RICKARD_KARSTARK","weight":4},{"directed":false,"source":"FARMER","target":"ORELL","weight":4},{"directed":false,"source":"GILLY","target":"JOJEN","weight":4},{"directed":false,"source":"GREIZHEN","target":"MISSANDEI","weight":4},{"directed":false,"source":"JOYEUSE","target":"ROBB","weight":4},{"directed":false,"source":"JOYEUSE","target":"TALISA","weight":4},{"directed":false,"source":"LOCKE","target":"TYWIN","weight":4},{"directed":false,"source":"LORD_OF_BONES","target":"MANCE","weight":4},{"directed":false,"source":"LORD_OF_BONES","target":"TORMUND","weight":16},{"directed":false,"source":"LOTHAR","target":"WALDER","weight":13},{"directed":false,"source":"MAREI","target":"TYRION","weight":6},{"directed":false,"source":"MELISANDRE","target":"ROBERT","weight":4},{"directed":false,"source":"QYBURN","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"QYBURN","target":"TALISA","weight":4},{"directed":false,"source":"RAMSAY","target":"YARA","weight":11},{"directed":false,"source":"ROSLIN","target":"TALISA","weight":4},{"directed":false,"source":"SORCERER","target":"VARYS","weight":4},{"directed":false,"source":"TARYN_MANT","target":"TYRION","weight":4},{"directed":false,"source":"ANGUY","target":"MELISANDRE","weight":3},{"directed":false,"source":"BERIC","target":"MOUNTAIN","weight":3},{"directed":false,"source":"BLACK_WALDER","target":"BRYNDEN","weight":8},{"directed":false,"source":"BLACK_WALDER","target":"CATELYN","weight":3},{"directed":false,"source":"BRAN","target":"GILLY","weight":3},{"directed":false,"source":"BRANDON_STARK","target":"JOJEN","weight":3},{"directed":false,"source":"BRIENNE","target":"SELWYN","weight":8},{"directed":false,"source":"BRYNDEN","target":"LOTHAR","weight":7},{"directed":false,"source":"CRASTER","target":"GRENN","weight":7},{"directed":false,"source":"DAENERYS","target":"GREIZHEN","weight":3},{"directed":false,"source":"EDMURE","target":"ROOSE_BOLTON","weight":3},{"directed":false,"source":"FARMER","target":"JOJEN","weight":3},{"directed":false,"source":"GENDRY","target":"ROBERT","weight":14},{"directed":false,"source":"GILLY","target":"HODOR","weight":3},{"directed":false,"source":"GILLY","target":"RANDYLL","weight":11},{"directed":false,"source":"HIGH_SEPTON","target":"JOFFREY","weight":8},{"directed":false,"source":"HIGH_SEPTON","target":"MARGAERY","weight":7},{"directed":false,"source":"HODOR","target":"ORELL","weight":3},{"directed":false,"source":"JAIME","target":"SELWYN","weight":3},{"directed":false,"source":"JOANNA","target":"TYWIN","weight":5},{"directed":false,"source":"JOJEN","target":"NED","weight":3},{"directed":false,"source":"JOJEN","target":"ORELL","weight":3},{"directed":false,"source":"JON","target":"OSHA","weight":3},{"directed":false,"source":"LITTLEFINGER","target":"OLYVAR","weight":5},{"directed":false,"source":"LITTLEFINGER","target":"SHAE","weight":3},{"directed":false,"source":"LOTHAR","target":"ROBB","weight":3},{"directed":false,"source":"MACE","target":"MARGAERY","weight":19},{"directed":false,"source":"MEERA","target":"ORELL","weight":3},{"directed":false,"source":"MERRY","target":"WALDER","weight":3},{"directed":false,"source":"MERYN_TRANT","target":"PODRICK","weight":3},{"directed":false,"source":"MISSANDEI","target":"PRENDAHL","weight":3},{"directed":false,"source":"MISSANDEI","target":"RADZAI_MO_ERAZ","weight":3},{"directed":false,"source":"MOUNTAIN","target":"ROBB","weight":3},{"directed":false,"source":"OLENNA","target":"PODRICK","weight":3},{"directed":false,"source":"OLENNA","target":"ROBERT","weight":3},{"directed":false,"source":"ORELL","target":"OSHA","weight":3},{"directed":false,"source":"ORELL","target":"RICKON","weight":3},{"directed":false,"source":"QYBURN","target":"ROBB","weight":3},{"directed":false,"source":"RAMSAY","target":"ROBB","weight":5},{"directed":false,"source":"RICKARD_KARSTARK","target":"WILLEM_LANNISTER","weight":3},{"directed":false,"source":"ROBERT","target":"THOROS","weight":3},{"directed":false,"source":"ROOSE_BOLTON","target":"STEELSHANKS_WALTON","weight":3},{"directed":false,"source":"ROOSE_BOLTON","target":"THEON","weight":25},{"directed":false,"source":"SORCERER","target":"TYRION","weight":3},{"directed":false,"source":"AEGON","target":"DAVOS","weight":2},{"directed":false,"source":"AEGON","target":"SHIREEN","weight":2},{"directed":false,"source":"AERYS","target":"JOFFREY","weight":2},{"directed":false,"source":"ANGUY","target":"HOT_PIE","weight":2},{"directed":false,"source":"ARYA","target":"ROOSE_BOLTON","weight":2},{"directed":false,"source":"BALERION","target":"DAVOS","weight":2},{"directed":false,"source":"BALON","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"BARRISTAN","target":"KRAZNYS_MO_NAKLOZ","weight":2},{"directed":false,"source":"BARRISTAN","target":"RADZAI_MO_ERAZ","weight":2},{"directed":false,"source":"BERT","target":"SHIREEN","weight":2},{"directed":false,"source":"BLACK_WALDER","target":"JOYEUSE","weight":2},{"directed":false,"source":"BOROS","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"BRAN","target":"FARMER","weight":2},{"directed":false,"source":"BRAN","target":"TORMUND","weight":6},{"directed":false,"source":"BRAN","target":"YGRITTE","weight":2},{"directed":false,"source":"BRONN","target":"HIGH_SEPTON","weight":2},{"directed":false,"source":"BRONN","target":"LORAS","weight":2},{"directed":false,"source":"BRONN","target":"MARGAERY","weight":2},{"directed":false,"source":"BRONN","target":"OLENNA","weight":4},{"directed":false,"source":"BRONN","target":"TARYN_MANT","weight":2},{"directed":false,"source":"BRYNDEN","target":"HOSTER","weight":2},{"directed":false,"source":"BRYNDEN","target":"ROSLIN","weight":2},{"directed":false,"source":"CATELYN","target":"LOTHAR","weight":2},{"directed":false,"source":"CERSEI","target":"HIGH_SEPTON","weight":15},{"directed":false,"source":"DAREON","target":"HOBB","weight":2},{"directed":false,"source":"DAVOS","target":"RYLENE","weight":2},{"directed":false,"source":"DESMOND","target":"ELDRICK","weight":2},{"directed":false,"source":"DESMOND","target":"SANSA","weight":2},{"directed":false,"source":"DESMOND","target":"TYRION","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"KARL_TANNER","weight":2},{"directed":false,"source":"EDMURE","target":"HOUND","weight":2},{"directed":false,"source":"EDMURE","target":"JOYEUSE","weight":2},{"directed":false,"source":"EDMURE","target":"MOUNTAIN","weight":2},{"directed":false,"source":"EDMURE","target":"TYWIN","weight":2},{"directed":false,"source":"FARMER","target":"HODOR","weight":2},{"directed":false,"source":"FARMER","target":"MEERA","weight":2},{"directed":false,"source":"FARMER","target":"OSHA","weight":2},{"directed":false,"source":"FARMER","target":"RICKON","weight":2},{"directed":false,"source":"FREY_SEPTON","target":"ROSLIN","weight":2},{"directed":false,"source":"FREY_SEPTON","target":"WALDER","weight":2},{"directed":false,"source":"GILLY","target":"RAST","weight":2},{"directed":false,"source":"GREIZHEN","target":"JORAH","weight":2},{"directed":false,"source":"GREIZHEN","target":"KRAZNYS_MO_NAKLOZ","weight":2},{"directed":false,"source":"GRENN","target":"KARL_TANNER","weight":2},{"directed":false,"source":"GREY_WORM","target":"MERO","weight":2},{"directed":false,"source":"GREY_WORM","target":"MISSANDEI","weight":183},{"directed":false,"source":"HIGH_SEPTON","target":"LORAS","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"OLENNA","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"PYCELLE","weight":4},{"directed":false,"source":"HIGH_SEPTON","target":"SANSA","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"TYRION","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"TYWIN","weight":2},{"directed":false,"source":"HODOR","target":"JON","weight":2},{"directed":false,"source":"HODOR","target":"TORMUND","weight":2},{"directed":false,"source":"HODOR","target":"YGRITTE","weight":2},{"directed":false,"source":"HOUND","target":"ROOSE_BOLTON","weight":2},{"directed":false,"source":"JAIME","target":"LORAS","weight":18},{"directed":false,"source":"JAIME","target":"PYCELLE","weight":7},{"directed":false,"source":"JOJEN","target":"TORMUND","weight":2},{"directed":false,"source":"JOJEN","target":"YGRITTE","weight":2},{"directed":false,"source":"JON","target":"MEERA","weight":2},{"directed":false,"source":"JON","target":"QHORIN_HALFHAND","weight":2},{"directed":false,"source":"JON","target":"RICKON","weight":11},{"directed":false,"source":"JORAH","target":"PRENDAHL","weight":2},{"directed":false,"source":"JOYEUSE","target":"ROSLIN","weight":2},{"directed":false,"source":"KARL_TANNER","target":"RAST","weight":15},{"directed":false,"source":"KARL_TANNER","target":"SAM","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"PODRICK","weight":10},{"directed":false,"source":"LOCKE","target":"QYBURN","weight":2},{"directed":false,"source":"LOCKE","target":"STEELSHANKS_WALTON","weight":2},{"directed":false,"source":"LORAS","target":"SHAE","weight":2},{"directed":false,"source":"LOTHAR","target":"ROSLIN","weight":2},{"directed":false,"source":"LOTHAR","target":"TALISA","weight":2},{"directed":false,"source":"LYSA","target":"TYWIN","weight":2},{"directed":false,"source":"LYSA","target":"VARYS","weight":2},{"directed":false,"source":"MARGAERY","target":"PYCELLE","weight":4},{"directed":false,"source":"MARTYN","target":"ROBB","weight":2},{"directed":false,"source":"MEERA","target":"TORMUND","weight":2},{"directed":false,"source":"MEERA","target":"YGRITTE","weight":2},{"directed":false,"source":"MELISANDRE","target":"SELYSE","weight":51},{"directed":false,"source":"MOUNTAIN","target":"THOROS","weight":2},{"directed":false,"source":"MYRANDA","target":"RAMSAY","weight":55},{"directed":false,"source":"NED","target":"RICKARD_KARSTARK","weight":2},{"directed":false,"source":"NED","target":"THOROS","weight":2},{"directed":false,"source":"OLENNA","target":"PYCELLE","weight":5},{"directed":false,"source":"OLENNA","target":"RENLY","weight":2},{"directed":false,"source":"OSHA","target":"TORMUND","weight":2},{"directed":false,"source":"OSHA","target":"YGRITTE","weight":2},{"directed":false,"source":"PODRICK","target":"SANSA","weight":35},{"directed":false,"source":"QHORIN_HALFHAND","target":"YGRITTE","weight":2},{"directed":false,"source":"QYBURN","target":"SELWYN","weight":2},{"directed":false,"source":"QYBURN","target":"TYWIN","weight":2},{"directed":false,"source":"RAMSAY","target":"VIOLET","weight":2},{"directed":false,"source":"RENLY","target":"TYWIN","weight":2},{"directed":false,"source":"RICKARD_KARSTARK","target":"ROSLIN","weight":2},{"directed":false,"source":"RICKARD_KARSTARK","target":"WALDER","weight":2},{"directed":false,"source":"RICKON","target":"TORMUND","weight":4},{"directed":false,"source":"RICKON","target":"YGRITTE","weight":2},{"directed":false,"source":"RYLENE","target":"STANNIS","weight":2},{"directed":false,"source":"SALLADHOR","target":"STANNIS","weight":2},{"directed":false,"source":"SELYSE","target":"SHIREEN","weight":27},{"directed":false,"source":"STEELSHANKS_WALTON","target":"TYWIN","weight":2},{"directed":false,"source":"TYRION","target":"WALDER","weight":2},{"directed":false,"source":"TYWIN","target":"WALDER","weight":2},{"directed":false,"source":"LYSA","target":"SANSA","weight":92},{"directed":false,"source":"OBERYN","target":"TYWIN","weight":79},{"directed":false,"source":"BRIENNE","target":"PODRICK","weight":251},{"directed":false,"source":"OBERYN","target":"TYRION","weight":78},{"directed":false,"source":"CERSEI","target":"OBERYN","weight":63},{"directed":false,"source":"LITTLEFINGER","target":"LYSA","weight":58},{"directed":false,"source":"ELLARIA","target":"OBERYN","weight":58},{"directed":false,"source":"ROBIN","target":"SANSA","weight":52},{"directed":false,"source":"TOMMEN","target":"TYWIN","weight":45},{"directed":false,"source":"JANOS","target":"JON","weight":59},{"directed":false,"source":"ARYA","target":"BRIENNE","weight":61},{"directed":false,"source":"OBERYN","target":"VARYS","weight":34},{"directed":false,"source":"STYR","target":"YGRITTE","weight":32},{"directed":false,"source":"LITTLEFINGER","target":"YOHN_ROYCE","weight":60},{"directed":false,"source":"BRONN","target":"JAIME","weight":284},{"directed":false,"source":"HOUND","target":"POLLIVER","weight":29},{"directed":false,"source":"MARGAERY","target":"TOMMEN","weight":144},{"directed":false,"source":"ALLISER_THORNE","target":"JANOS","weight":32},{"directed":false,"source":"DAENERYS","target":"HIZDAHR","weight":93},{"directed":false,"source":"GILLY","target":"MOLES_TOWN_WHORE","weight":24},{"directed":false,"source":"MELISANDRE","target":"SHIREEN","weight":33},{"directed":false,"source":"BRIENNE","target":"HOT_PIE","weight":25},{"directed":false,"source":"BRIENNE","target":"HOUND","weight":47},{"directed":false,"source":"ANYA_WAYNWOOD","target":"LITTLEFINGER","weight":21},{"directed":false,"source":"JON","target":"LOCKE","weight":21},{"directed":false,"source":"MACE","target":"TYWIN","weight":21},{"directed":false,"source":"OBERYN","target":"OLYVAR","weight":21},{"directed":false,"source":"FARMER_HAMLET","target":"HOUND","weight":20},{"directed":false,"source":"GILLY","target":"LITTLE_SAM","weight":61},{"directed":false,"source":"STYR","target":"TORMUND","weight":20},{"directed":false,"source":"CERSEI","target":"QYBURN","weight":173},{"directed":false,"source":"DAVOS","target":"TYCHO","weight":18},{"directed":false,"source":"ELLARIA","target":"OLYVAR","weight":18},{"directed":false,"source":"MORGAN","target":"OBERYN","weight":18},{"directed":false,"source":"MOUNTAIN","target":"OBERYN","weight":22},{"directed":false,"source":"RALF","target":"THEON","weight":18},{"directed":false,"source":"ARYA","target":"TERNESIO_TERYS","weight":17},{"directed":false,"source":"KARL_TANNER","target":"MEERA","weight":17},{"directed":false,"source":"STANNIS","target":"TYCHO","weight":17},{"directed":false,"source":"DAENERYS","target":"FENNESZ","weight":15},{"directed":false,"source":"RAMSAY","target":"TANSY","weight":15},{"directed":false,"source":"SANSA","target":"YOHN_ROYCE","weight":58},{"directed":false,"source":"BRIENNE","target":"CERSEI","weight":18},{"directed":false,"source":"ELIA","target":"OBERYN","weight":14},{"directed":false,"source":"GRENN","target":"LOCKE","weight":14},{"directed":false,"source":"JOJEN","target":"KARL_TANNER","weight":14},{"directed":false,"source":"JON","target":"OLLY","weight":61},{"directed":false,"source":"MACE","target":"OBERYN","weight":14},{"directed":false,"source":"MACE","target":"TYRION","weight":14},{"directed":false,"source":"ARYA","target":"FARMER_HAMLET","weight":13},{"directed":false,"source":"BRAN","target":"LOCKE","weight":13},{"directed":false,"source":"CERSEI","target":"MACE","weight":45},{"directed":false,"source":"CERSEI","target":"MOUNTAIN","weight":75},{"directed":false,"source":"GRENN","target":"JANOS","weight":13},{"directed":false,"source":"JAIME","target":"PODRICK","weight":44},{"directed":false,"source":"JAIME","target":"TOMMEN","weight":54},{"directed":false,"source":"DYING_MAN","target":"HOUND","weight":12},{"directed":false,"source":"JAIME","target":"OBERYN","weight":12},{"directed":false,"source":"JON","target":"STANNIS","weight":106},{"directed":false,"source":"MANCE","target":"STANNIS","weight":26},{"directed":false,"source":"PYCELLE","target":"QYBURN","weight":35},{"directed":false,"source":"ANYA_WAYNWOOD","target":"SANSA","weight":11},{"directed":false,"source":"DONTOS","target":"LITTLEFINGER","weight":11},{"directed":false,"source":"ELLARIA","target":"TYRION","weight":18},{"directed":false,"source":"FARMER_HAMLET","target":"SALLY","weight":11},{"directed":false,"source":"JAIME","target":"MARGAERY","weight":19},{"directed":false,"source":"JON","target":"KARL_TANNER","weight":11},{"directed":false,"source":"ANYA_WAYNWOOD","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"ARYA","target":"DYING_MAN","weight":10},{"directed":false,"source":"KARL_TANNER","target":"SISSY","weight":10},{"directed":false,"source":"MORGAN","target":"MORGANS_FRIEND","weight":10},{"directed":false,"source":"OLLY","target":"STYR","weight":10},{"directed":false,"source":"BRAN","target":"THREE_EYED_RAVEN","weight":85},{"directed":false,"source":"ELLARIA","target":"MAREI","weight":9},{"directed":false,"source":"ELLARIA","target":"TYWIN","weight":9},{"directed":false,"source":"JANOS","target":"SAM","weight":17},{"directed":false,"source":"JOFFREY","target":"MACE","weight":9},{"directed":false,"source":"BALON_DWARF","target":"ROBB_DWARF","weight":8},{"directed":false,"source":"BRONN","target":"OBERYN","weight":8},{"directed":false,"source":"DONNEL_HILL","target":"GRENN","weight":8},{"directed":false,"source":"EDDISON_TOLLETT","target":"JANOS","weight":11},{"directed":false,"source":"ELLARIA","target":"MORGAN","weight":8},{"directed":false,"source":"JAIME","target":"MACE","weight":16},{"directed":false,"source":"JOFFREY","target":"OBERYN","weight":8},{"directed":false,"source":"JON","target":"MORAG","weight":8},{"directed":false,"source":"MACE","target":"VARYS","weight":8},{"directed":false,"source":"MORGANS_FRIEND","target":"OBERYN","weight":8},{"directed":false,"source":"ALLISER_THORNE","target":"LOCKE","weight":7},{"directed":false,"source":"BOLTON_GUARD","target":"YARA","weight":7},{"directed":false,"source":"BRAN","target":"KARL_TANNER","weight":7},{"directed":false,"source":"BRAN","target":"LEAF","weight":26},{"directed":false,"source":"CERSEI","target":"ELLARIA","weight":30},{"directed":false,"source":"DAENERYS","target":"MEEREEN_CHAMPION","weight":7},{"directed":false,"source":"DAVOS","target":"JON","weight":261},{"directed":false,"source":"DONGO_THE_GIANT","target":"MAG_THE_MIGHTY","weight":7},{"directed":false,"source":"DORNISH_LORD","target":"TYRION","weight":7},{"directed":false,"source":"EDDISON_TOLLETT","target":"PYP","weight":9},{"directed":false,"source":"ENDREW","target":"JAIME","weight":7},{"directed":false,"source":"GILLY","target":"PYP","weight":7},{"directed":false,"source":"GRENN","target":"MAG_THE_MIGHTY","weight":7},{"directed":false,"source":"GUYMON","target":"OLLY","weight":7},{"directed":false,"source":"HIZDAHR","target":"HIZDAHRS_FATHER","weight":7},{"directed":false,"source":"HODOR","target":"LOCKE","weight":7},{"directed":false,"source":"JON","target":"SISSY","weight":7},{"directed":false,"source":"MACE","target":"TOMMEN","weight":9},{"directed":false,"source":"MAREI","target":"OBERYN","weight":7},{"directed":false,"source":"MOLES_TOWN_MADAM","target":"SAM","weight":7},{"directed":false,"source":"OBERYN","target":"PYCELLE","weight":7},{"directed":false,"source":"OBERYN","target":"SHAE","weight":7},{"directed":false,"source":"OLLY","target":"SAM","weight":37},{"directed":false,"source":"OLLY","target":"YGRITTE","weight":7},{"directed":false,"source":"RENLY_DWARF","target":"STANNIS_DWARF","weight":7},{"directed":false,"source":"ARYA","target":"SALLY","weight":6},{"directed":false,"source":"BRIENNE","target":"JOFFREY","weight":6},{"directed":false,"source":"BRIENNE","target":"SANSA","weight":120},{"directed":false,"source":"CERSEI","target":"DONTOS","weight":6},{"directed":false,"source":"DAVOS","target":"MANCE","weight":6},{"directed":false,"source":"DAVOS","target":"SELYSE","weight":15},{"directed":false,"source":"ELDER_MEEREEN_SLAVE","target":"MOSSADOR","weight":6},{"directed":false,"source":"FIRST_MATE","target":"YARA","weight":6},{"directed":false,"source":"GOATHERD","target":"MISSANDEI","weight":6},{"directed":false,"source":"GRENN","target":"OLLY","weight":6},{"directed":false,"source":"HOUND","target":"LYSA","weight":6},{"directed":false,"source":"HOUND","target":"RORGE","weight":6},{"directed":false,"source":"HOUND","target":"SALLY","weight":6},{"directed":false,"source":"JAIME","target":"VARYS","weight":16},{"directed":false,"source":"JOFFREY_DWARF","target":"ROBB_DWARF","weight":6},{"directed":false,"source":"JON","target":"STYR","weight":6},{"directed":false,"source":"MAREI","target":"OLYVAR","weight":6},{"directed":false,"source":"MEERA","target":"THREE_EYED_RAVEN","weight":17},{"directed":false,"source":"MORGAN","target":"OLYVAR","weight":6},{"directed":false,"source":"MOUNTAIN","target":"PYCELLE","weight":6},{"directed":false,"source":"MOUNTAIN","target":"QYBURN","weight":32},{"directed":false,"source":"MYRANDA","target":"TANSY","weight":6},{"directed":false,"source":"OBERYN","target":"TOMMEN","weight":6},{"directed":false,"source":"ORSON","target":"TYRION","weight":6},{"directed":false,"source":"SAM","target":"TORMUND","weight":36},{"directed":false,"source":"TANSY","target":"THEON","weight":6},{"directed":false,"source":"ALLISER_THORNE","target":"EDDISON_TOLLETT","weight":20},{"directed":false,"source":"ALLISER_THORNE","target":"TORMUND","weight":18},{"directed":false,"source":"BRIENNE","target":"OLENNA","weight":5},{"directed":false,"source":"BRIENNE","target":"TYRION","weight":55},{"directed":false,"source":"DAENERYS","target":"GOATHERD","weight":5},{"directed":false,"source":"DONTOS","target":"TYRION","weight":5},{"directed":false,"source":"EDDISON_TOLLETT","target":"LOCKE","weight":5},{"directed":false,"source":"EDDISON_TOLLETT","target":"MORAG","weight":5},{"directed":false,"source":"ENDREW","target":"JOFFREY","weight":5},{"directed":false,"source":"FENNESZ","target":"MASTER_MIGHDAL","weight":5},{"directed":false,"source":"FIRST_MATE","target":"THEON","weight":5},{"directed":false,"source":"GRENN","target":"MORAG","weight":5},{"directed":false,"source":"HIGH_SEPTON","target":"TOMMEN","weight":5},{"directed":false,"source":"HIZDAHR","target":"MANSERVANT","weight":5},{"directed":false,"source":"HOT_PIE","target":"PODRICK","weight":5},{"directed":false,"source":"JAIME","target":"SHAE","weight":5},{"directed":false,"source":"JANOS","target":"OLLY","weight":8},{"directed":false,"source":"JOFFREY","target":"POLLIVER","weight":5},{"directed":false,"source":"LHARA","target":"SALLADHOR","weight":5},{"directed":false,"source":"LUTHOR","target":"OLENNA","weight":5},{"directed":false,"source":"MACE","target":"PYCELLE","weight":15},{"directed":false,"source":"MACE","target":"SANSA","weight":5},{"directed":false,"source":"MACE","target":"SHAE","weight":5},{"directed":false,"source":"MARGAERY","target":"OBERYN","weight":5},{"directed":false,"source":"MOUNTAIN","target":"TYRION","weight":18},{"directed":false,"source":"OBERYN","target":"PODRICK","weight":5},{"directed":false,"source":"RAMSAY","target":"WALDA","weight":34},{"directed":false,"source":"ROOSE_BOLTON","target":"WALDA","weight":14},{"directed":false,"source":"ADRACK_HUMBLE","target":"THEON","weight":4},{"directed":false,"source":"AXELL_FLORENT","target":"MELISANDRE","weight":4},{"directed":false,"source":"AXELL_FLORENT","target":"SELYSE","weight":4},{"directed":false,"source":"BALON_DWARF","target":"JOFFREY_DWARF","weight":4},{"directed":false,"source":"BALON_DWARF","target":"STANNIS_DWARF","weight":4},{"directed":false,"source":"BLACK_JACK","target":"KEGS","weight":4},{"directed":false,"source":"BLACK_JACK","target":"MULLY","weight":4},{"directed":false,"source":"BRAN","target":"CRASTER","weight":4},{"directed":false,"source":"BRAN","target":"RAST","weight":4},{"directed":false,"source":"BRONN","target":"MORGAN","weight":4},{"directed":false,"source":"COOPER","target":"GRENN","weight":4},{"directed":false,"source":"CRASTER","target":"LOCKE","weight":4},{"directed":false,"source":"CRASTER","target":"MORAG","weight":4},{"directed":false,"source":"CRASTER","target":"SISSY","weight":4},{"directed":false,"source":"CRASTERS_BABY","target":"RAST","weight":4},{"directed":false,"source":"CRASTERS_BABY","target":"SISSY","weight":4},{"directed":false,"source":"DAARIO","target":"MEEREEN_CHAMPION","weight":4},{"directed":false,"source":"DAENERYS","target":"HIZDAHRS_FATHER","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"SISSY","weight":4},{"directed":false,"source":"ELDER_MEEREEN_SLAVE","target":"GREY_WORM","weight":4},{"directed":false,"source":"ELDER_MEEREEN_SLAVE","target":"MEEREEN_SLAVE","weight":4},{"directed":false,"source":"ELIA","target":"MOUNTAIN","weight":4},{"directed":false,"source":"ELIA","target":"TYWIN","weight":4},{"directed":false,"source":"ELLARIA","target":"JAIME","weight":25},{"directed":false,"source":"ELLARIA","target":"MOUNTAIN","weight":10},{"directed":false,"source":"ELLARIA","target":"PODRICK","weight":4},{"directed":false,"source":"GILLY","target":"JANOS","weight":7},{"directed":false,"source":"GILLY","target":"STYR","weight":4},{"directed":false,"source":"GILLY","target":"YGRITTE","weight":4},{"directed":false,"source":"GRENN","target":"SISSY","weight":4},{"directed":false,"source":"HIGH_SEPTON","target":"JAIME","weight":4},{"directed":false,"source":"JANOS","target":"MAESTER_AEMON","weight":4},{"directed":false,"source":"JOFFREY","target":"JOFFREY_DWARF","weight":4},{"directed":false,"source":"JON","target":"MAG_THE_MIGHTY","weight":4},{"directed":false,"source":"KEGS","target":"MULLY","weight":4},{"directed":false,"source":"LEAF","target":"MEERA","weight":17},{"directed":false,"source":"LITTLE_SAM","target":"MOLES_TOWN_WHORE","weight":4},{"directed":false,"source":"LOCKE","target":"RAMSAY","weight":4},{"directed":false,"source":"LORAS","target":"OBERYN","weight":4},{"directed":false,"source":"LYSA","target":"NED","weight":4},{"directed":false,"source":"LYSA","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"MERYN_TRANT","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"MERYN_TRANT","target":"TYWIN","weight":4},{"directed":false,"source":"MORAG","target":"SISSY","weight":4},{"directed":false,"source":"MORGAN","target":"TYRION","weight":4},{"directed":false,"source":"MYRANDA","target":"YARA","weight":4},{"directed":false,"source":"OBERYN","target":"SANSA","weight":4},{"directed":false,"source":"OLLY","target":"OLLYS_MOTHER","weight":4},{"directed":false,"source":"PYCELLE","target":"TOMMEN","weight":14},{"directed":false,"source":"SAM","target":"STYR","weight":4},{"directed":false,"source":"SAM","target":"YGRITTE","weight":4},{"directed":false,"source":"STYR","target":"THENN_WARG","weight":4},{"directed":false,"source":"AERYS","target":"TYRION","weight":10},{"directed":false,"source":"ALLISER_THORNE","target":"OLLY","weight":18},{"directed":false,"source":"ALLISER_THORNE","target":"QHORIN","weight":3},{"directed":false,"source":"ANYA_WAYNWOOD","target":"LYSA","weight":3},{"directed":false,"source":"ARYA","target":"PODRICK","weight":10},{"directed":false,"source":"BAELOR","target":"TYWIN","weight":3},{"directed":false,"source":"BALON_DWARF","target":"RENLY_DWARF","weight":3},{"directed":false,"source":"BOLTON_GUARD","target":"FIRST_MATE","weight":3},{"directed":false,"source":"BRAN","target":"CRASTERS_BABY","weight":3},{"directed":false,"source":"BRAN","target":"RAMSAY","weight":3},{"directed":false,"source":"BRONN","target":"ELLARIA","weight":3},{"directed":false,"source":"BRONN","target":"LOLLYS","weight":17},{"directed":false,"source":"BRONN","target":"MOUNTAIN","weight":3},{"directed":false,"source":"COOPER","target":"DONNEL_HILL","weight":3},{"directed":false,"source":"CRASTER","target":"JOJEN","weight":3},{"directed":false,"source":"CRASTER","target":"MEERA","weight":3},{"directed":false,"source":"CRASTERS_BABY","target":"MEERA","weight":3},{"directed":false,"source":"DAENERYS","target":"MANSERVANT","weight":3},{"directed":false,"source":"DONNEL_WAYNWOOD","target":"HOUND","weight":3},{"directed":false,"source":"DORAN","target":"TYRION","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"OLLY","weight":13},{"directed":false,"source":"ELLARIA","target":"JOFFREY","weight":3},{"directed":false,"source":"ELLARIA","target":"LORAS","weight":3},{"directed":false,"source":"GILLY","target":"TORMUND","weight":8},{"directed":false,"source":"GUYMON","target":"OLLYS_MOTHER","weight":3},{"directed":false,"source":"HODOR","target":"LEAF","weight":12},{"directed":false,"source":"HODOR","target":"RAST","weight":3},{"directed":false,"source":"HOSTER","target":"LYSA","weight":3},{"directed":false,"source":"HOUND","target":"INNKEEPER","weight":3},{"directed":false,"source":"HOUND","target":"SYRIO_FOREL","weight":3},{"directed":false,"source":"INNKEEPER","target":"POLLIVER","weight":3},{"directed":false,"source":"JAIME","target":"MERYN_TRANT","weight":3},{"directed":false,"source":"JAIME","target":"OLENNA","weight":50},{"directed":false,"source":"JOFFREY","target":"MOUNTAIN","weight":3},{"directed":false,"source":"JOFFREY","target":"ROBB_DWARF","weight":3},{"directed":false,"source":"JOFFREY_DWARF","target":"SANSA","weight":3},{"directed":false,"source":"JOFFREY_DWARF","target":"STANNIS_DWARF","weight":3},{"directed":false,"source":"JOJEN","target":"LEAF","weight":3},{"directed":false,"source":"JOJEN","target":"THREE_EYED_RAVEN","weight":3},{"directed":false,"source":"MAG_THE_MIGHTY","target":"MANCE","weight":3},{"directed":false,"source":"MAG_THE_MIGHTY","target":"SAM","weight":3},{"directed":false,"source":"MEEREEN_SLAVE","target":"MOSSADOR","weight":3},{"directed":false,"source":"MOLES_TOWN_MADAM","target":"MOLES_TOWN_WHORE","weight":3},{"directed":false,"source":"OLENNA","target":"TOMMEN","weight":6},{"directed":false,"source":"OLLY","target":"PYP","weight":3},{"directed":false,"source":"OLLY","target":"TORMUND","weight":8},{"directed":false,"source":"PODRICK","target":"TYWIN","weight":3},{"directed":false,"source":"PYP","target":"TORMUND","weight":3},{"directed":false,"source":"STANNIS","target":"TOMMEN","weight":3},{"directed":false,"source":"THENN_WARG","target":"TORMUND","weight":3},{"directed":false,"source":"THENN_WARG","target":"YGRITTE","weight":3},{"directed":false,"source":"VANCE_CORBRAY","target":"YOHN_ROYCE","weight":3},{"directed":false,"source":"ADRACK_HUMBLE","target":"RALF","weight":2},{"directed":false,"source":"AERYS","target":"CERSEI","weight":7},{"directed":false,"source":"ALLISER_THORNE","target":"CRASTER","weight":2},{"directed":false,"source":"ALLISER_THORNE","target":"YGRITTE","weight":2},{"directed":false,"source":"ANYA_WAYNWOOD","target":"ROBIN","weight":2},{"directed":false,"source":"ANYA_WAYNWOOD","target":"VANCE_CORBRAY","weight":2},{"directed":false,"source":"ARYA","target":"DONNEL_WAYNWOOD","weight":2},{"directed":false,"source":"ARYA","target":"INNKEEPER","weight":2},{"directed":false,"source":"ARYA","target":"INNKEEPERS_DAUGHTER","weight":2},{"directed":false,"source":"ARYA","target":"LYSA","weight":2},{"directed":false,"source":"ARYA","target":"TOMMY","weight":2},{"directed":false,"source":"AXELL_FLORENT","target":"DAVOS","weight":2},{"directed":false,"source":"AXELL_FLORENT","target":"STANNIS","weight":2},{"directed":false,"source":"BAELOR","target":"HIGH_SEPTON","weight":2},{"directed":false,"source":"BAELOR","target":"TYRION","weight":2},{"directed":false,"source":"BALON_DWARF","target":"JOFFREY","weight":2},{"directed":false,"source":"BARRISTAN","target":"GOATHERD","weight":2},{"directed":false,"source":"BITER","target":"HOUND","weight":2},{"directed":false,"source":"BOROS","target":"JAIME","weight":2},{"directed":false,"source":"BRIENNE","target":"BRONN","weight":12},{"directed":false,"source":"BRIENNE","target":"NED","weight":2},{"directed":false,"source":"BRONN","target":"FALYSE","weight":4},{"directed":false,"source":"BRONN","target":"MORGANS_FRIEND","weight":2},{"directed":false,"source":"CERSEI","target":"ELIA","weight":2},{"directed":false,"source":"CERSEI","target":"FOOL","weight":2},{"directed":false,"source":"CERSEI","target":"JOFFREY_DWARF","weight":2},{"directed":false,"source":"CERSEI","target":"ROBB_DWARF","weight":2},{"directed":false,"source":"CRASTER","target":"CRASTERS_BABY","weight":2},{"directed":false,"source":"CRASTER","target":"HODOR","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"HODOR","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"JOJEN","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"KARL_TANNER","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"NIGHT_KING","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"DAENERYS","target":"MASTER_MIGHDAL","weight":2},{"directed":false,"source":"DAENERYS","target":"RHAEGAR","weight":2},{"directed":false,"source":"DAVOS","target":"EDDISON_TOLLETT","weight":34},{"directed":false,"source":"DAVOS","target":"GRENN","weight":2},{"directed":false,"source":"DAVOS","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"DAVOS","target":"SAM","weight":18},{"directed":false,"source":"DONGO_THE_GIANT","target":"JON","weight":2},{"directed":false,"source":"DONNEL_HILL","target":"MAG_THE_MIGHTY","weight":2},{"directed":false,"source":"DORAN","target":"OBERYN","weight":10},{"directed":false,"source":"DORNISH_LORD","target":"OBERYN","weight":2},{"directed":false,"source":"DROGO","target":"RHAEGAR","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"MELISANDRE","weight":13},{"directed":false,"source":"EDDISON_TOLLETT","target":"SELYSE","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"SHIREEN","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"STANNIS","weight":6},{"directed":false,"source":"ELLARIA","target":"MACE","weight":2},{"directed":false,"source":"ELLARIA","target":"MARGAERY","weight":2},{"directed":false,"source":"ELLARIA","target":"MORGANS_FRIEND","weight":2},{"directed":false,"source":"ELLARIA","target":"SANSA","weight":2},{"directed":false,"source":"ELLARIA","target":"VARYS","weight":5},{"directed":false,"source":"FENNESZ","target":"MISSANDEI","weight":2},{"directed":false,"source":"FOOL","target":"JOFFREY","weight":2},{"directed":false,"source":"FOOL","target":"TYWIN","weight":2},{"directed":false,"source":"GILLY","target":"MOLES_TOWN_MADAM","weight":2},{"directed":false,"source":"GOATHERD","target":"GOATHERDS_SON","weight":2},{"directed":false,"source":"GOATHERD","target":"GREY_WORM","weight":2},{"directed":false,"source":"GOATHERD","target":"JORAH","weight":2},{"directed":false,"source":"GRENN","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"GRENN","target":"MELISANDRE","weight":2},{"directed":false,"source":"GRENN","target":"SELYSE","weight":2},{"directed":false,"source":"GRENN","target":"SHIREEN","weight":2},{"directed":false,"source":"GRENN","target":"STANNIS","weight":2},{"directed":false,"source":"GRENN","target":"YGRITTE","weight":2},{"directed":false,"source":"GREY_WORM","target":"MOSSADOR","weight":5},{"directed":false,"source":"GUYMON","target":"STYR","weight":2},{"directed":false,"source":"GUYMON","target":"YGRITTE","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"MACE","weight":7},{"directed":false,"source":"HIZDAHR","target":"JORAH","weight":6},{"directed":false,"source":"HODOR","target":"NED","weight":5},{"directed":false,"source":"HODOR","target":"THREE_EYED_RAVEN","weight":17},{"directed":false,"source":"HOSTER","target":"JON_ARRYN","weight":2},{"directed":false,"source":"HOSTER","target":"LITTLEFINGER","weight":2},{"directed":false,"source":"HOUND","target":"INNKEEPERS_DAUGHTER","weight":2},{"directed":false,"source":"HOUND","target":"LOMMY","weight":2},{"directed":false,"source":"HOUND","target":"TOMMY","weight":2},{"directed":false,"source":"HOUND","target":"VARYS","weight":5},{"directed":false,"source":"INNKEEPER","target":"TOMMY","weight":2},{"directed":false,"source":"JAIME","target":"JOANNA","weight":2},{"directed":false,"source":"JANOS","target":"LITTLE_SAM","weight":2},{"directed":false,"source":"JANOS","target":"LOCKE","weight":2},{"directed":false,"source":"JANOS","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"JANOS","target":"PYP","weight":2},{"directed":false,"source":"JOFFREY","target":"LYSA","weight":2},{"directed":false,"source":"JOFFREY","target":"RENLY_DWARF","weight":2},{"directed":false,"source":"JOFFREY","target":"STANNIS_DWARF","weight":2},{"directed":false,"source":"JOFFREY_DWARF","target":"MARGAERY","weight":2},{"directed":false,"source":"JOFFREY_DWARF","target":"RENLY_DWARF","weight":2},{"directed":false,"source":"JOFFREY_DWARF","target":"TYRION","weight":2},{"directed":false,"source":"JOJEN","target":"LOCKE","weight":2},{"directed":false,"source":"JOJEN","target":"RAST","weight":2},{"directed":false,"source":"JON","target":"MELISANDRE","weight":99},{"directed":false,"source":"JON","target":"SELYSE","weight":8},{"directed":false,"source":"JON","target":"SHIREEN","weight":4},{"directed":false,"source":"JORAH","target":"MEEREEN_CHAMPION","weight":2},{"directed":false,"source":"LEAF","target":"THREE_EYED_RAVEN","weight":10},{"directed":false,"source":"LITTLE_SAM","target":"MOLES_TOWN_MADAM","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"PYP","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"VANCE_CORBRAY","weight":2},{"directed":false,"source":"LOCKE","target":"MEERA","weight":2},{"directed":false,"source":"LOCKE","target":"MORAG","weight":2},{"directed":false,"source":"LOCKE","target":"RAST","weight":2},{"directed":false,"source":"LOCKE","target":"SAM","weight":2},{"directed":false,"source":"LOCKE","target":"SISSY","weight":2},{"directed":false,"source":"LOLLYS","target":"TYRION","weight":2},{"directed":false,"source":"LORAS","target":"RENLY_DWARF","weight":2},{"directed":false,"source":"LORAS","target":"STANNIS_DWARF","weight":2},{"directed":false,"source":"LUTHOR","target":"VIOLA","weight":2},{"directed":false,"source":"MACE","target":"MOUNTAIN","weight":2},{"directed":false,"source":"MACE","target":"PODRICK","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"MELISANDRE","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"OLLY","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"SELYSE","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"SHIREEN","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"STANNIS","weight":2},{"directed":false,"source":"MAREI","target":"MORGAN","weight":2},{"directed":false,"source":"MAREI","target":"SHAE","weight":2},{"directed":false,"source":"MARGAERY","target":"ROBB_DWARF","weight":2},{"directed":false,"source":"MEERA","target":"NED","weight":4},{"directed":false,"source":"MEERA","target":"RAST","weight":2},{"directed":false,"source":"MELISANDRE","target":"SAM","weight":7},{"directed":false,"source":"MERYN_TRANT","target":"THEON","weight":2},{"directed":false,"source":"MISSANDEI","target":"ZALA","weight":2},{"directed":false,"source":"MOLES_TOWN_WHORE","target":"SAM","weight":2},{"directed":false,"source":"MORGANS_FRIEND","target":"TYRION","weight":2},{"directed":false,"source":"MOUNTAIN","target":"SHAE","weight":2},{"directed":false,"source":"MUSICIAN","target":"OLENNA","weight":2},{"directed":false,"source":"MYRCELLA","target":"OBERYN","weight":4},{"directed":false,"source":"NED","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"NIGHT_KING","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"OLENNA","target":"VIOLA","weight":2},{"directed":false,"source":"OLLYS_MOTHER","target":"STYR","weight":2},{"directed":false,"source":"OLLYS_MOTHER","target":"TORMUND","weight":2},{"directed":false,"source":"OLLYS_MOTHER","target":"YGRITTE","weight":2},{"directed":false,"source":"ORYS","target":"ORYS_BROTHER","weight":2},{"directed":false,"source":"ORYS","target":"TYWIN","weight":2},{"directed":false,"source":"ORYS_BROTHER","target":"TYWIN","weight":2},{"directed":false,"source":"POLLIVER","target":"TOMMY","weight":2},{"directed":false,"source":"RALF","target":"ROOSE_BOLTON","weight":2},{"directed":false,"source":"RAMSAY","target":"RICKON","weight":15},{"directed":false,"source":"RENLY_DWARF","target":"ROBB_DWARF","weight":2},{"directed":false,"source":"ROBB_DWARF","target":"SANSA","weight":2},{"directed":false,"source":"ROBB_DWARF","target":"TYRION","weight":2},{"directed":false,"source":"SAM","target":"SELYSE","weight":7},{"directed":false,"source":"SAM","target":"SHIREEN","weight":6},{"directed":false,"source":"SAM","target":"STANNIS","weight":28},{"directed":false,"source":"SANSA","target":"VANCE_CORBRAY","weight":2},{"directed":false,"source":"SANSA","target":"WAYMAR_ROYCE","weight":2},{"directed":false,"source":"TOMMEN","target":"TYCHO","weight":2},{"directed":false,"source":"TOMMEN","target":"VARYS","weight":2},{"directed":false,"source":"TYCHO","target":"TYWIN","weight":5},{"directed":false,"source":"JORAH","target":"TYRION","weight":168},{"directed":false,"source":"DAENERYS","target":"TYRION","weight":468},{"directed":false,"source":"CERSEI","target":"HIGH_SPARROW","weight":111},{"directed":false,"source":"SANSA","target":"THEON","weight":117},{"directed":false,"source":"JAIME","target":"MYRCELLA","weight":62},{"directed":false,"source":"MYRANDA","target":"SANSA","weight":58},{"directed":false,"source":"RAMSAY","target":"SANSA","weight":91},{"directed":false,"source":"ARYA","target":"WAIF","weight":96},{"directed":false,"source":"BRONN","target":"TYENE","weight":34},{"directed":false,"source":"DORAN","target":"ELLARIA","weight":41},{"directed":false,"source":"JAQEN","target":"WAIF","weight":52},{"directed":false,"source":"HIGH_SPARROW","target":"OLENNA","weight":34},{"directed":false,"source":"DAENERYS","target":"MOSSADOR","weight":28},{"directed":false,"source":"JON","target":"KARSI","weight":28},{"directed":false,"source":"AREO","target":"DORAN","weight":30},{"directed":false,"source":"DAARIO","target":"TYRION","weight":27},{"directed":false,"source":"DAARIO","target":"HIZDAHR","weight":24},{"directed":false,"source":"DORAN","target":"JAIME","weight":24},{"directed":false,"source":"LITTLEFINGER","target":"ROOSE_BOLTON","weight":22},{"directed":false,"source":"CERSEI","target":"KEVAN","weight":39},{"directed":false,"source":"HIGH_SPARROW","target":"LORAS","weight":43},{"directed":false,"source":"CERSEI","target":"MAGGY","weight":20},{"directed":false,"source":"AREO","target":"BRONN","weight":19},{"directed":false,"source":"KARSI","target":"TORMUND","weight":19},{"directed":false,"source":"TYCHO","target":"MACE","weight":19},{"directed":false,"source":"AREO","target":"JAIME","weight":18},{"directed":false,"source":"GILLY","target":"SHIREEN","weight":18},{"directed":false,"source":"BLACK_HAIRED_PROSTITUTE","target":"TYRION","weight":17},{"directed":false,"source":"HIGH_SPARROW","target":"MARGAERY","weight":93},{"directed":false,"source":"MALKO","target":"TYRION","weight":17},{"directed":false,"source":"JAIME","target":"TRYSTANE","weight":16},{"directed":false,"source":"JON","target":"LOBODA","weight":16},{"directed":false,"source":"LITTLEFINGER","target":"OLENNA","weight":16},{"directed":false,"source":"MISSANDEI","target":"TYRION","weight":156},{"directed":false,"source":"ROOSE_BOLTON","target":"SANSA","weight":23},{"directed":false,"source":"AREO","target":"ELLARIA","weight":18},{"directed":false,"source":"AREO","target":"MYRCELLA","weight":15},{"directed":false,"source":"CERSEI","target":"SEPTA_UNELLA","weight":26},{"directed":false,"source":"LANCEL","target":"LITTLEFINGER","weight":14},{"directed":false,"source":"LITTLEFINGER","target":"RAMSAY","weight":18},{"directed":false,"source":"NYMERIA","target":"TYENE","weight":20},{"directed":false,"source":"ARYA","target":"THIN_MAN","weight":13},{"directed":false,"source":"HIZDAHR","target":"TYRION","weight":13},{"directed":false,"source":"BRONN","target":"DORNISH_RIDER","weight":12},{"directed":false,"source":"CERSEI","target":"MELARA","weight":12},{"directed":false,"source":"JORAH","target":"MALKO","weight":12},{"directed":false,"source":"BRAND","target":"DERRYK","weight":11},{"directed":false,"source":"ELLARIA","target":"OBARA","weight":17},{"directed":false,"source":"ELLARIA","target":"TYENE","weight":37},{"directed":false,"source":"HIGH_SEPTON","target":"OLYVAR","weight":11},{"directed":false,"source":"JAQEN","target":"THIN_MAN","weight":11},{"directed":false,"source":"DAVOS","target":"OLLY","weight":14},{"directed":false,"source":"ELLARIA","target":"MYRCELLA","weight":10},{"directed":false,"source":"OLLY","target":"STANNIS","weight":10},{"directed":false,"source":"BRONN","target":"MYRCELLA","weight":9},{"directed":false,"source":"DORAN","target":"MYRCELLA","weight":9},{"directed":false,"source":"DORAN","target":"TRYSTANE","weight":9},{"directed":false,"source":"HIGH_SPARROW","target":"OLYVAR","weight":9},{"directed":false,"source":"LITTLEFINGER","target":"ROYCE","weight":9},{"directed":false,"source":"MACE","target":"QYBURN","weight":9},{"directed":false,"source":"AREO","target":"TRYSTANE","weight":8},{"directed":false,"source":"HIGH_SPARROW","target":"TOMMEN","weight":57},{"directed":false,"source":"HIZDAHR","target":"MISSANDEI","weight":8},{"directed":false,"source":"KARSI","target":"LOBODA","weight":8},{"directed":false,"source":"LANCEL","target":"LORAS","weight":13},{"directed":false,"source":"SANSA","target":"WALDA","weight":8},{"directed":false,"source":"AREO","target":"OBARA","weight":7},{"directed":false,"source":"BRONN","target":"OBARA","weight":7},{"directed":false,"source":"DERRYK","target":"SAM","weight":7},{"directed":false,"source":"GILLY","target":"OLLY","weight":7},{"directed":false,"source":"HIZDAHR","target":"MOSSADOR","weight":7},{"directed":false,"source":"MACE","target":"MERYN_TRANT","weight":9},{"directed":false,"source":"MARGAERY","target":"OLYVAR","weight":7},{"directed":false,"source":"OWNER","target":"TYRION","weight":7},{"directed":false,"source":"RAMSAY","target":"STANNIS","weight":7},{"directed":false,"source":"BRAND","target":"SAM","weight":6},{"directed":false,"source":"BRONN","target":"DORAN","weight":6},{"directed":false,"source":"BRONN","target":"TRYSTANE","weight":6},{"directed":false,"source":"DAARIO","target":"MOSSADOR","weight":6},{"directed":false,"source":"GILLY","target":"SELYSE","weight":6},{"directed":false,"source":"HIGH_SEPTON","target":"LANCEL","weight":6},{"directed":false,"source":"HIGH_SEPTON","target":"QYBURN","weight":6},{"directed":false,"source":"MADAME","target":"MERYN_TRANT","weight":6},{"directed":false,"source":"MYRANDA","target":"WALDA","weight":6},{"directed":false,"source":"MYRCELLA","target":"OBARA","weight":6},{"directed":false,"source":"NYMERIA","target":"OBARA","weight":24},{"directed":false,"source":"OBARA","target":"TYENE","weight":15},{"directed":false,"source":"ALLISER_THORNE","target":"STANNIS","weight":5},{"directed":false,"source":"BRONN","target":"NYMERIA","weight":5},{"directed":false,"source":"DAENERYS","target":"OWNER","weight":5},{"directed":false,"source":"DERRYK","target":"GILLY","weight":5},{"directed":false,"source":"ELLARIA","target":"NYMERIA","weight":9},{"directed":false,"source":"KEVAN","target":"TOMMEN","weight":12},{"directed":false,"source":"PODRICK","target":"STANNIS","weight":5},{"directed":false,"source":"ALLISER_THORNE","target":"DAVOS","weight":26},{"directed":false,"source":"AREO","target":"NYMERIA","weight":4},{"directed":false,"source":"AREO","target":"TYENE","weight":7},{"directed":false,"source":"ARYA","target":"MACE","weight":4},{"directed":false,"source":"BARRISTAN","target":"MOSSADOR","weight":4},{"directed":false,"source":"CERSEI","target":"OLYVAR","weight":4},{"directed":false,"source":"CERSEI","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"DORNISH_RIDER","target":"JAIME","weight":4},{"directed":false,"source":"ELLARIA","target":"TRYSTANE","weight":4},{"directed":false,"source":"GILLY","target":"STANNIS","weight":4},{"directed":false,"source":"HIGH_SEPTON","target":"HIGH_SPARROW","weight":4},{"directed":false,"source":"HIGH_SPARROW","target":"RENLY","weight":4},{"directed":false,"source":"HIGH_SPARROW","target":"ROBERT","weight":4},{"directed":false,"source":"JAIME","target":"TYENE","weight":6},{"directed":false,"source":"JON","target":"NIGHT_KING","weight":40},{"directed":false,"source":"JORAH","target":"OWNER","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"THEON","weight":4},{"directed":false,"source":"LOBODA","target":"TORMUND","weight":4},{"directed":false,"source":"MERYN_TRANT","target":"QYBURN","weight":4},{"directed":false,"source":"MYRANDA","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"QUICK","target":"STRONG","weight":4},{"directed":false,"source":"ROOSE_BOLTON","target":"STANNIS","weight":4},{"directed":false,"source":"THEON","target":"WALDA","weight":4},{"directed":false,"source":"AERYS","target":"DAENERYS","weight":16},{"directed":false,"source":"ARYA","target":"TYCHO","weight":3},{"directed":false,"source":"BARRISTAN","target":"RHAEGAR","weight":3},{"directed":false,"source":"DORAN","target":"TOMMEN","weight":3},{"directed":false,"source":"GREY_WORM","target":"TYRION","weight":142},{"directed":false,"source":"JAIME","target":"LOLLYS","weight":3},{"directed":false,"source":"JAIME","target":"OBARA","weight":3},{"directed":false,"source":"JANOS","target":"STANNIS","weight":3},{"directed":false,"source":"KEVAN","target":"LANCEL","weight":3},{"directed":false,"source":"KEVAN","target":"PYCELLE","weight":8},{"directed":false,"source":"KEVAN","target":"QYBURN","weight":5},{"directed":false,"source":"LITTLE_SAM","target":"OLLY","weight":3},{"directed":false,"source":"LITTLEFINGER","target":"LYANNA","weight":3},{"directed":false,"source":"LORD_WEEBLY","target":"SAM","weight":3},{"directed":false,"source":"LYANNA","target":"SANSA","weight":3},{"directed":false,"source":"MANCE","target":"MELISANDRE","weight":3},{"directed":false,"source":"OBARA","target":"OBERYN","weight":3},{"directed":false,"source":"PODRICK","target":"RENLY","weight":3},{"directed":false,"source":"RICKON","target":"SANSA","weight":10},{"directed":false,"source":"ROYCE","target":"SANSA","weight":3},{"directed":false,"source":"STANNIS","target":"TORMUND","weight":7},{"directed":false,"source":"AEGON","target":"RHAENYRA","weight":2},{"directed":false,"source":"ALLISER_THORNE","target":"DENYS","weight":2},{"directed":false,"source":"ALLISER_THORNE","target":"MANCE","weight":2},{"directed":false,"source":"ARYA","target":"MADAME","weight":2},{"directed":false,"source":"ARYA","target":"WALDER","weight":22},{"directed":false,"source":"BARRISTAN","target":"HIZDAHR","weight":2},{"directed":false,"source":"BRIAN","target":"JON","weight":2},{"directed":false,"source":"BRIENNE","target":"ROBERT","weight":2},{"directed":false,"source":"CERSEI","target":"JORAH","weight":2},{"directed":false,"source":"CERWYN","target":"RAMSAY","weight":2},{"directed":false,"source":"DAARIO","target":"QUICK","weight":2},{"directed":false,"source":"DAARIO","target":"STRONG","weight":2},{"directed":false,"source":"DAENERYS","target":"QUICK","weight":2},{"directed":false,"source":"DAENERYS","target":"STRONG","weight":2},{"directed":false,"source":"DORAN","target":"OBARA","weight":2},{"directed":false,"source":"DORAN","target":"TYENE","weight":6},{"directed":false,"source":"EDDISON_TOLLETT","target":"LITTLE_SAM","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"TORMUND","weight":36},{"directed":false,"source":"GILLY","target":"MELISANDRE","weight":2},{"directed":false,"source":"HIGH_SPARROW","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"HIGH_SPARROW","target":"SEPTA_UNELLA","weight":12},{"directed":false,"source":"HIZDAHR","target":"OWNER","weight":2},{"directed":false,"source":"HIZDAHR","target":"QUICK","weight":2},{"directed":false,"source":"HIZDAHR","target":"STRONG","weight":2},{"directed":false,"source":"JAIME","target":"NYMERIA","weight":2},{"directed":false,"source":"JAQEN","target":"MACE","weight":2},{"directed":false,"source":"JAQEN","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"JON","target":"LITTLE_SAM","weight":2},{"directed":false,"source":"JON","target":"LORD_WEEBLY","weight":2},{"directed":false,"source":"JON","target":"ROOSE_BOLTON","weight":5},{"directed":false,"source":"JORAH","target":"MOSSADOR","weight":2},{"directed":false,"source":"KARSI","target":"NIGHT_KING","weight":2},{"directed":false,"source":"LANCEL","target":"OLYVAR","weight":2},{"directed":false,"source":"LANCEL","target":"PYCELLE","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"MELISANDRE","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"STANNIS","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"MYRANDA","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"TOMMEN","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"WALDA","weight":2},{"directed":false,"source":"LOLLYS","target":"TANDA","weight":2},{"directed":false,"source":"LYANNA_MORMONT","target":"STANNIS","weight":2},{"directed":false,"source":"MACE","target":"THIN_MAN","weight":2},{"directed":false,"source":"MAESTER_WOLKAN","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"MAGGY","target":"MELARA","weight":2},{"directed":false,"source":"MAGGY","target":"ROBERT","weight":2},{"directed":false,"source":"MAGNAR","target":"SAM","weight":2},{"directed":false,"source":"MANCE","target":"SAM","weight":2},{"directed":false,"source":"MARGAERY","target":"ROBERT","weight":2},{"directed":false,"source":"MELISANDRE","target":"OLLY","weight":4},{"directed":false,"source":"MERYN_TRANT","target":"MOUNTAIN","weight":2},{"directed":false,"source":"MERYN_TRANT","target":"THIN_MAN","weight":2},{"directed":false,"source":"MOSSADOR","target":"TYRION","weight":2},{"directed":false,"source":"OLENNA","target":"OLYVAR","weight":2},{"directed":false,"source":"OLYVAR","target":"TOMMEN","weight":2},{"directed":false,"source":"QUICK","target":"TYRION","weight":2},{"directed":false,"source":"ROBIN","target":"ROYCE","weight":2},{"directed":false,"source":"STANNIS","target":"STEFFON","weight":2},{"directed":false,"source":"STRONG","target":"TYRION","weight":2},{"directed":false,"source":"THIN_MAN","target":"WAIF","weight":2},{"directed":false,"source":"TYCHO","target":"JAQEN","weight":2},{"directed":false,"source":"TYCHO","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"TYCHO","target":"THIN_MAN","weight":2},{"directed":false,"source":"JON","target":"SANSA","weight":300},{"directed":false,"source":"ARYA","target":"LADY_CRANE","weight":64},{"directed":false,"source":"DAVOS","target":"TORMUND","weight":76},{"directed":false,"source":"HOUND","target":"RAY","weight":41},{"directed":false,"source":"DAVOS","target":"SANSA","weight":64},{"directed":false,"source":"BRYNDEN","target":"JAIME","weight":35},{"directed":false,"source":"DAENERYS","target":"KHAL_MORO","weight":34},{"directed":false,"source":"RAMSAY","target":"SMALLJON","weight":34},{"directed":false,"source":"HIGH_SPARROW","target":"JAIME","weight":33},{"directed":false,"source":"BRIENNE","target":"BRYNDEN","weight":32},{"directed":false,"source":"EDMURE","target":"JAIME","weight":31},{"directed":false,"source":"JON","target":"RAMSAY","weight":30},{"directed":false,"source":"BENJEN","target":"BRAN","weight":29},{"directed":false,"source":"JON","target":"LYANNA_MORMONT","weight":41},{"directed":false,"source":"SANSA","target":"TORMUND","weight":37},{"directed":false,"source":"OSHA","target":"RAMSAY","weight":23},{"directed":false,"source":"CAMELLO","target":"LADY_CRANE","weight":21},{"directed":false,"source":"GREY_WORM","target":"VARYS","weight":53},{"directed":false,"source":"MARGAERY","target":"SEPTA_UNELLA","weight":21},{"directed":false,"source":"JAIME","target":"WALDER","weight":19},{"directed":false,"source":"JON","target":"ROBETT","weight":27},{"directed":false,"source":"DAENERYS","target":"YARA","weight":24},{"directed":false,"source":"BALON","target":"EURON","weight":17},{"directed":false,"source":"DAVOS","target":"LYANNA_MORMONT","weight":24},{"directed":false,"source":"EURON","target":"YARA","weight":44},{"directed":false,"source":"BIANCA","target":"LADY_CRANE","weight":16},{"directed":false,"source":"BOBONO","target":"LADY_CRANE","weight":16},{"directed":false,"source":"EURON","target":"THEON","weight":36},{"directed":false,"source":"IZEMBARO","target":"LADY_CRANE","weight":16},{"directed":false,"source":"MISSANDEI","target":"VARYS","weight":52},{"directed":false,"source":"TYRION","target":"YEZZAN","weight":16},{"directed":false,"source":"BLACK_WALDER","target":"WALDER","weight":15},{"directed":false,"source":"DAENERYS","target":"LHAZAREEN_WOMAN","weight":15},{"directed":false,"source":"DAENERYS","target":"THEON","weight":33},{"directed":false,"source":"GILLY","target":"MELESSA","weight":15},{"directed":false,"source":"KINVARA","target":"TYRION","weight":15},{"directed":false,"source":"BLACK_WALDER","target":"JAIME","weight":14},{"directed":false,"source":"VALA","target":"VARYS","weight":14},{"directed":false,"source":"BIANCA","target":"IZEMBARO","weight":13},{"directed":false,"source":"JAIME","target":"LOTHAR","weight":13},{"directed":false,"source":"JON","target":"WUN_WUN","weight":13},{"directed":false,"source":"MAESTER_CITADEL","target":"SAM","weight":13},{"directed":false,"source":"ARTHUR","target":"NED","weight":12},{"directed":false,"source":"BENJEN","target":"MEERA","weight":12},{"directed":false,"source":"BRAN","target":"NIGHT_KING","weight":29},{"directed":false,"source":"LYANNA_MORMONT","target":"SANSA","weight":26},{"directed":false,"source":"MAESTER_WOLKAN","target":"RAMSAY","weight":12},{"directed":false,"source":"MELESSA","target":"TALLA","weight":12},{"directed":false,"source":"MELISANDRE","target":"TORMUND","weight":17},{"directed":false,"source":"TORMUND","target":"WUN_WUN","weight":12},{"directed":false,"source":"CLARENZO","target":"LADY_CRANE","weight":11},{"directed":false,"source":"DICKON","target":"SAM","weight":15},{"directed":false,"source":"EDDISON_TOLLETT","target":"SANSA","weight":13},{"directed":false,"source":"JOFFREY","target":"LADY_CRANE","weight":11},{"directed":false,"source":"LEM","target":"RAY","weight":11},{"directed":false,"source":"MELESSA","target":"RANDYLL","weight":11},{"directed":false,"source":"NED","target":"THREE_EYED_RAVEN","weight":11},{"directed":false,"source":"RAMSAY","target":"SON_OFWALDA","weight":11},{"directed":false,"source":"ARYA","target":"BIANCA","weight":10},{"directed":false,"source":"BIANCA","target":"BOBONO","weight":10},{"directed":false,"source":"BOBONO","target":"CLARENZO","weight":10},{"directed":false,"source":"BRIENNE","target":"JON","weight":30},{"directed":false,"source":"GREY_WORM","target":"YEZZAN","weight":10},{"directed":false,"source":"MELISANDRE","target":"SANSA","weight":10},{"directed":false,"source":"RAZDAL","target":"TYRION","weight":10},{"directed":false,"source":"SON_OFWALDA","target":"WALDA","weight":10},{"directed":false,"source":"AERON","target":"YARA","weight":9},{"directed":false,"source":"ARYA","target":"IZEMBARO","weight":9},{"directed":false,"source":"BOBONO","target":"IZEMBARO","weight":9},{"directed":false,"source":"BRIENNE","target":"EDDISON_TOLLETT","weight":12},{"directed":false,"source":"BRIENNE","target":"TORMUND","weight":55},{"directed":false,"source":"CLARENZO","target":"IZEMBARO","weight":9},{"directed":false,"source":"DAVOS","target":"WUN_WUN","weight":9},{"directed":false,"source":"ELLARIA","target":"OLENNA","weight":12},{"directed":false,"source":"GATINS","target":"HOUND","weight":9},{"directed":false,"source":"AERON","target":"EURON","weight":8},{"directed":false,"source":"BENJEN","target":"LYANNA","weight":8},{"directed":false,"source":"BIANCA","target":"CLARENZO","weight":8},{"directed":false,"source":"DAENERYS","target":"DOSH_KHALEEN_LEADER","weight":8},{"directed":false,"source":"DAVOS","target":"RAMSAY","weight":8},{"directed":false,"source":"DOSH_KHALEEN_LEADER","target":"LHAZAREEN_WOMAN","weight":8},{"directed":false,"source":"GILLY","target":"TALLA","weight":8},{"directed":false,"source":"HIGH_SPARROW","target":"LANCEL","weight":8},{"directed":false,"source":"JON","target":"LITTLEFINGER","weight":28},{"directed":false,"source":"JON","target":"SMALLJON","weight":8},{"directed":false,"source":"KINVARA","target":"VARYS","weight":8},{"directed":false,"source":"QYBURN","target":"TOMMEN","weight":8},{"directed":false,"source":"RAMSAY","target":"RICKARD_KARSTARK","weight":8},{"directed":false,"source":"RAMSAY","target":"TORMUND","weight":8},{"directed":false,"source":"SAM","target":"TALLA","weight":8},{"directed":false,"source":"BELICHO","target":"TYRION","weight":7},{"directed":false,"source":"BENJEN","target":"THREE_EYED_RAVEN","weight":7},{"directed":false,"source":"BOBONO","target":"CAMELLO","weight":7},{"directed":false,"source":"EDMURE","target":"GUARD_CAPTAIN","weight":7},{"directed":false,"source":"GLOVER","target":"JON","weight":7},{"directed":false,"source":"GREY_WORM","target":"RAZDAL","weight":7},{"directed":false,"source":"KEVAN","target":"OLENNA","weight":7},{"directed":false,"source":"LYANNA_MORMONT","target":"MAESTER_MORMONT","weight":7},{"directed":false,"source":"MEERA","target":"NIGHT_KING","weight":7},{"directed":false,"source":"MISSANDEI","target":"RAZDAL","weight":7},{"directed":false,"source":"MISSANDEI","target":"YEZZAN","weight":7},{"directed":false,"source":"NYMERIA","target":"TRYSTANE","weight":7},{"directed":false,"source":"OBARA","target":"OLENNA","weight":7},{"directed":false,"source":"OLENNA","target":"SEPTA_UNELLA","weight":7},{"directed":false,"source":"RAZDAL","target":"YEZZAN","weight":7},{"directed":false,"source":"ROBETT","target":"SANSA","weight":14},{"directed":false,"source":"ROBIN","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"ALLISER_THORNE","target":"BOWEN_MARSH","weight":6},{"directed":false,"source":"ARTHUR_CHILD","target":"QYBURN","weight":6},{"directed":false,"source":"ARYA","target":"CLARENZO","weight":6},{"directed":false,"source":"BELICHO","target":"RAZDAL","weight":6},{"directed":false,"source":"BOWEN_MARSH","target":"JON","weight":6},{"directed":false,"source":"BRAN","target":"LYANNA","weight":13},{"directed":false,"source":"BRYNDEN","target":"GUARD_CAPTAIN","weight":6},{"directed":false,"source":"BRYNDEN","target":"PODRICK","weight":6},{"directed":false,"source":"BRYNDEN","target":"SANSA","weight":6},{"directed":false,"source":"CAMELLO","target":"CLARENZO","weight":6},{"directed":false,"source":"CAMELLO","target":"IZEMBARO","weight":6},{"directed":false,"source":"CERSEI","target":"LADY_CRANE","weight":6},{"directed":false,"source":"DAENERYS","target":"RAZDAL","weight":6},{"directed":false,"source":"DAVOS","target":"SMALLJON","weight":6},{"directed":false,"source":"HIGH_SPARROW","target":"MACE","weight":6},{"directed":false,"source":"HOUND","target":"LEM","weight":6},{"directed":false,"source":"LADY_CRANE","target":"SANSA","weight":6},{"directed":false,"source":"LANCEL","target":"MARGAERY","weight":6},{"directed":false,"source":"LEAF","target":"NIGHT_KING","weight":6},{"directed":false,"source":"OBARA","target":"TRYSTANE","weight":6},{"directed":false,"source":"RICKON","target":"SMALLJON","weight":6},{"directed":false,"source":"SMALLJON","target":"TORMUND","weight":6},{"directed":false,"source":"TYRION","target":"YARA","weight":11},{"directed":false,"source":"ARYA","target":"BOBONO","weight":5},{"directed":false,"source":"ARYA","target":"CAMELLO","weight":5},{"directed":false,"source":"BELICHO","target":"GREY_WORM","weight":5},{"directed":false,"source":"BELICHO","target":"MISSANDEI","weight":5},{"directed":false,"source":"BELICHO","target":"YEZZAN","weight":5},{"directed":false,"source":"BLACK_WALDER","target":"BRONN","weight":5},{"directed":false,"source":"BOBONO","target":"JOFFREY","weight":5},{"directed":false,"source":"BRIENNE","target":"THEON","weight":10},{"directed":false,"source":"CLARENZO","target":"JOFFREY","weight":5},{"directed":false,"source":"CLARENZO","target":"TYRION","weight":5},{"directed":false,"source":"DAENERYS","target":"KINVARA","weight":5},{"directed":false,"source":"DAVOS","target":"LITTLEFINGER","weight":9},{"directed":false,"source":"DIM_DALBA","target":"JON","weight":5},{"directed":false,"source":"DOM","target":"VARYS","weight":5},{"directed":false,"source":"DORAN","target":"MAESTER_DORNE","weight":5},{"directed":false,"source":"DROGO","target":"KHAL_MORO","weight":5},{"directed":false,"source":"JON","target":"MAESTER_MORMONT","weight":5},{"directed":false,"source":"LADY_CRANE","target":"TYRION","weight":5},{"directed":false,"source":"LITTLE_SAM","target":"MELESSA","weight":5},{"directed":false,"source":"MAESTER_MORMONT","target":"SANSA","weight":5},{"directed":false,"source":"NIGHT_KING","target":"THREE_EYED_RAVEN","weight":5},{"directed":false,"source":"PODRICK","target":"THEON","weight":9},{"directed":false,"source":"RAMSAY","target":"WUN_WUN","weight":5},{"directed":false,"source":"RANDYLL","target":"TALLA","weight":5},{"directed":false,"source":"RICKARD_KARSTARK","target":"SMALLJON","weight":5},{"directed":false,"source":"SANSA","target":"WUN_WUN","weight":5},{"directed":false,"source":"AERON","target":"BALON","weight":4},{"directed":false,"source":"AERON","target":"THEON","weight":4},{"directed":false,"source":"ARTHUR","target":"HOWLAND","weight":4},{"directed":false,"source":"BIANCA","target":"CAMELLO","weight":4},{"directed":false,"source":"BIANCA","target":"JOFFREY","weight":4},{"directed":false,"source":"BIANCA","target":"SANSA","weight":4},{"directed":false,"source":"BOBONO","target":"SANSA","weight":4},{"directed":false,"source":"BOBONO","target":"TYRION","weight":4},{"directed":false,"source":"BOBONO","target":"TYWIN","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"DAVOS","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"EDDISON_TOLLETT","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"MELISANDRE","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"OLLY","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"OTHELL_YARWYCK","weight":6},{"directed":false,"source":"BOWEN_MARSH","target":"TORMUND","weight":4},{"directed":false,"source":"BRONN","target":"LOTHAR","weight":4},{"directed":false,"source":"CERSEI","target":"CLARENZO","weight":4},{"directed":false,"source":"CLARENZO","target":"SANSA","weight":4},{"directed":false,"source":"DAARIO","target":"LHAZAREEN_WOMAN","weight":4},{"directed":false,"source":"DAENERYS","target":"YEZZAN","weight":4},{"directed":false,"source":"DAVOS","target":"MAESTER_MORMONT","weight":4},{"directed":false,"source":"DICKON","target":"GILLY","weight":4},{"directed":false,"source":"DIM_DALBA","target":"TORMUND","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"PODRICK","weight":4},{"directed":false,"source":"GILLY","target":"MAESTER_CITADEL","weight":4},{"directed":false,"source":"GLOVER","target":"MANDERLY","weight":4},{"directed":false,"source":"HARALD","target":"RAMSAY","weight":4},{"directed":false,"source":"HODOR","target":"LYANNA","weight":4},{"directed":false,"source":"HODOR","target":"NIGHT_KING","weight":4},{"directed":false,"source":"HOWLAND","target":"NED","weight":4},{"directed":false,"source":"JAIME","target":"SON_OF_EDMURE","weight":4},{"directed":false,"source":"JON","target":"MANDERLY","weight":4},{"directed":false,"source":"JON","target":"PODRICK","weight":11},{"directed":false,"source":"KEVAN","target":"MARGAERY","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"TORMUND","weight":7},{"directed":false,"source":"LYANNA_MORMONT","target":"ROBB","weight":4},{"directed":false,"source":"MAESTER_WOLKAN","target":"MYRANDA","weight":4},{"directed":false,"source":"MAESTER_WOLKAN","target":"RICKARD_KARSTARK","weight":4},{"directed":false,"source":"NYMERIA","target":"OLENNA","weight":4},{"directed":false,"source":"PODRICK","target":"TORMUND","weight":28},{"directed":false,"source":"RED_PRIEST","target":"TYRION","weight":4},{"directed":false,"source":"SANSA","target":"SMALLJON","weight":4},{"directed":false,"source":"ALLISER_THORNE","target":"MELISANDRE","weight":3},{"directed":false,"source":"ALLISER_THORNE","target":"WUN_WUN","weight":3},{"directed":false,"source":"ARTHUR","target":"BRAN","weight":3},{"directed":false,"source":"ARTHUR","target":"THREE_EYED_RAVEN","weight":3},{"directed":false,"source":"BENJEN","target":"HODOR","weight":3},{"directed":false,"source":"BERIC","target":"LEM","weight":3},{"directed":false,"source":"BIANCA","target":"CERSEI","weight":3},{"directed":false,"source":"BIANCA","target":"NED","weight":3},{"directed":false,"source":"BIANCA","target":"TYRION","weight":3},{"directed":false,"source":"BOBONO","target":"CERSEI","weight":3},{"directed":false,"source":"BOBONO","target":"NED","weight":3},{"directed":false,"source":"BRONN","target":"EDMURE","weight":3},{"directed":false,"source":"CERSEI","target":"IZEMBARO","weight":3},{"directed":false,"source":"CLARENZO","target":"MARGAERY","weight":3},{"directed":false,"source":"DAENERYS","target":"RED_PRIEST","weight":3},{"directed":false,"source":"DAVOS","target":"GLOVER","weight":3},{"directed":false,"source":"DAVOS","target":"HARALD","weight":3},{"directed":false,"source":"DICKON","target":"RANDYLL","weight":30},{"directed":false,"source":"DIM_DALBA","target":"WUN_WUN","weight":3},{"directed":false,"source":"DOM","target":"VALA","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"WUN_WUN","weight":3},{"directed":false,"source":"GLOVER","target":"SANSA","weight":3},{"directed":false,"source":"HARALD","target":"JON","weight":3},{"directed":false,"source":"HARALD","target":"SANSA","weight":3},{"directed":false,"source":"HARALD","target":"SMALLJON","weight":3},{"directed":false,"source":"HARALD","target":"TORMUND","weight":3},{"directed":false,"source":"HIGH_SPARROW","target":"KEVAN","weight":3},{"directed":false,"source":"HOWLAND","target":"THREE_EYED_RAVEN","weight":3},{"directed":false,"source":"IZEMBARO","target":"JOFFREY","weight":3},{"directed":false,"source":"IZEMBARO","target":"NED","weight":3},{"directed":false,"source":"IZEMBARO","target":"TYWIN","weight":3},{"directed":false,"source":"JORAH","target":"LHAZAREEN_WOMAN","weight":3},{"directed":false,"source":"KEVAN","target":"LORAS","weight":3},{"directed":false,"source":"KEVAN","target":"MACE","weight":3},{"directed":false,"source":"LEM","target":"THOROS","weight":3},{"directed":false,"source":"LITTLE_SAM","target":"TALLA","weight":3},{"directed":false,"source":"LYANNA","target":"THREE_EYED_RAVEN","weight":3},{"directed":false,"source":"LYANNA_MORMONT","target":"RAMSAY","weight":3},{"directed":false,"source":"LYANNA_MORMONT","target":"TORMUND","weight":11},{"directed":false,"source":"MANDERLY","target":"ROBB","weight":3},{"directed":false,"source":"NED","target":"OLD_NAN","weight":3},{"directed":false,"source":"NED","target":"RAMSAY","weight":3},{"directed":false,"source":"OLENNA","target":"TYENE","weight":3},{"directed":false,"source":"RAZDAL","target":"VARYS","weight":3},{"directed":false,"source":"RED_PRIEST","target":"VARYS","weight":3},{"directed":false,"source":"ROBB","target":"ROBETT","weight":3},{"directed":false,"source":"ROOSE_BOLTON","target":"SMALLJON","weight":3},{"directed":false,"source":"SMALLJON","target":"WUN_WUN","weight":3},{"directed":false,"source":"AREO","target":"MAESTER_DORNE","weight":2},{"directed":false,"source":"ARYA","target":"RICKON","weight":2},{"directed":false,"source":"BELICHO","target":"DAENERYS","weight":2},{"directed":false,"source":"BELICHO","target":"VARYS","weight":2},{"directed":false,"source":"BENJEN","target":"RODRIK","weight":2},{"directed":false,"source":"BIANCA","target":"MARGAERY","weight":2},{"directed":false,"source":"BOBONO","target":"MARGAERY","weight":2},{"directed":false,"source":"BRAN","target":"HOWLAND","weight":2},{"directed":false,"source":"BRAN","target":"JAQEN","weight":2},{"directed":false,"source":"BRONN","target":"BRYNDEN","weight":2},{"directed":false,"source":"BRONN","target":"WALDER","weight":2},{"directed":false,"source":"BRYNDEN","target":"MINISA","weight":2},{"directed":false,"source":"CAMELLO","target":"NED","weight":2},{"directed":false,"source":"CAMELLO","target":"SANSA","weight":2},{"directed":false,"source":"CAMELLO","target":"TYRION","weight":2},{"directed":false,"source":"CERSEI","target":"SON_OF_EDMURE","weight":2},{"directed":false,"source":"CLARENZO","target":"ROBERT","weight":2},{"directed":false,"source":"DAARIO","target":"DOSH_KHALEEN_LEADER","weight":2},{"directed":false,"source":"DAARIO","target":"KHAL_MORO","weight":2},{"directed":false,"source":"DAENERYS","target":"VALA","weight":2},{"directed":false,"source":"DAVOS","target":"DIM_DALBA","weight":2},{"directed":false,"source":"DAVOS","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"DAVOS","target":"RICKON","weight":2},{"directed":false,"source":"DAVOS","target":"ROBETT","weight":4},{"directed":false,"source":"DICKON","target":"MELESSA","weight":2},{"directed":false,"source":"DICKON","target":"TALLA","weight":2},{"directed":false,"source":"DIM_DALBA","target":"SANSA","weight":2},{"directed":false,"source":"DOSH_KHALEEN_LEADER","target":"JORAH","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"EDMURE","target":"HOSTER","weight":2},{"directed":false,"source":"EDMURE","target":"SON_OF_EDMURE","weight":2},{"directed":false,"source":"ELLARIA","target":"MAESTER_DORNE","weight":2},{"directed":false,"source":"FLYNN","target":"LEM","weight":2},{"directed":false,"source":"FLYNN","target":"MORGAN","weight":2},{"directed":false,"source":"FLYNN","target":"RAY","weight":2},{"directed":false,"source":"GLOVER","target":"ROBB","weight":2},{"directed":false,"source":"GLOVER","target":"ROBETT","weight":2},{"directed":false,"source":"GREY_WORM","target":"THEON","weight":9},{"directed":false,"source":"GREY_WORM","target":"YARA","weight":7},{"directed":false,"source":"HARALD","target":"LYANNA_MORMONT","weight":2},{"directed":false,"source":"HODOR","target":"OLD_NAN","weight":2},{"directed":false,"source":"IZEMBARO","target":"ROBERT","weight":2},{"directed":false,"source":"IZEMBARO","target":"SANSA","weight":2},{"directed":false,"source":"IZEMBARO","target":"TYRION","weight":2},{"directed":false,"source":"JORAH","target":"KHAL_MORO","weight":2},{"directed":false,"source":"LADY_CRANE","target":"MARGAERY","weight":2},{"directed":false,"source":"LADY_CRANE","target":"ROBERT","weight":2},{"directed":false,"source":"LADY_CRANE","target":"TYWIN","weight":2},{"directed":false,"source":"LADY_CRANE","target":"WAIF","weight":2},{"directed":false,"source":"LANCEL","target":"MACE","weight":2},{"directed":false,"source":"LANCEL","target":"QYBURN","weight":2},{"directed":false,"source":"LANCEL","target":"SEPTA_UNELLA","weight":2},{"directed":false,"source":"LEM","target":"MORGAN","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"RANDYLL","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"SMALLJON","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"WUN_WUN","weight":2},{"directed":false,"source":"LYANNA_MORMONT","target":"MANDERLY","weight":2},{"directed":false,"source":"LYANNA_MORMONT","target":"SMALLJON","weight":2},{"directed":false,"source":"MAESTER_DORNE","target":"TYENE","weight":2},{"directed":false,"source":"MEERA","target":"OLD_NAN","weight":2},{"directed":false,"source":"MELISANDRE","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"MELISANDRE","target":"PODRICK","weight":2},{"directed":false,"source":"MELISANDRE","target":"RAMSAY","weight":2},{"directed":false,"source":"MISSANDEI","target":"THEON","weight":12},{"directed":false,"source":"MISSANDEI","target":"YARA","weight":4},{"directed":false,"source":"MORGAN","target":"RAY","weight":2},{"directed":false,"source":"NED","target":"ROBETT","weight":2},{"directed":false,"source":"OLD_NAN","target":"THREE_EYED_RAVEN","weight":2},{"directed":false,"source":"OLLY","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"OSHA","target":"SMALLJON","weight":2},{"directed":false,"source":"OTHELL_YARWYCK","target":"TORMUND","weight":2},{"directed":false,"source":"QYBURN","target":"VARYS","weight":2},{"directed":false,"source":"RICKON","target":"WUN_WUN","weight":2},{"directed":false,"source":"VARYS","target":"YARA","weight":4},{"directed":false,"source":"VARYS","target":"YEZZAN","weight":2},{"directed":false,"source":"DAENERYS","target":"JON","weight":372},{"directed":false,"source":"MARWYN","target":"SAM","weight":78},{"directed":false,"source":"JON","target":"JORAH","weight":70},{"directed":false,"source":"HOUND","target":"TORMUND","weight":79},{"directed":false,"source":"DAVOS","target":"TYRION","weight":118},{"directed":false,"source":"BERIC","target":"JON","weight":49},{"directed":false,"source":"CERSEI","target":"EURON","weight":78},{"directed":false,"source":"CERSEI","target":"TYCHO","weight":37},{"directed":false,"source":"JON","target":"MISSANDEI","weight":47},{"directed":false,"source":"CERSEI","target":"DAENERYS","weight":69},{"directed":false,"source":"DAENERYS","target":"DAVOS","weight":50},{"directed":false,"source":"JAIME","target":"RANDYLL","weight":33},{"directed":false,"source":"DAVOS","target":"MISSANDEI","weight":35},{"directed":false,"source":"GENDRY","target":"JON","weight":37},{"directed":false,"source":"BERIC","target":"TORMUND","weight":51},{"directed":false,"source":"HOUND","target":"JON","weight":31},{"directed":false,"source":"JORAH","target":"SAM","weight":53},{"directed":false,"source":"EURON","target":"JAIME","weight":43},{"directed":false,"source":"HOUND","target":"JORAH","weight":35},{"directed":false,"source":"ELLARIA","target":"YARA","weight":25},{"directed":false,"source":"DICKON","target":"JAIME","weight":24},{"directed":false,"source":"HARRAG","target":"THEON","weight":24},{"directed":false,"source":"JORAH","target":"TORMUND","weight":42},{"directed":false,"source":"JAIME","target":"MOUNTAIN","weight":23},{"directed":false,"source":"MELISANDRE","target":"VARYS","weight":21},{"directed":false,"source":"DAENERYS","target":"JAIME","weight":43},{"directed":false,"source":"BRAN","target":"LITTLEFINGER","weight":19},{"directed":false,"source":"JORAH","target":"THOROS","weight":19},{"directed":false,"source":"BERIC","target":"JORAH","weight":31},{"directed":false,"source":"JON","target":"VARYS","weight":67},{"directed":false,"source":"SANSA","target":"MAESTER_WOLKAN","weight":29},{"directed":false,"source":"DAENERYS","target":"OLENNA","weight":16},{"directed":false,"source":"JORAH","target":"MARWYN","weight":16},{"directed":false,"source":"CERSEI","target":"TYENE","weight":15},{"directed":false,"source":"GENDRY","target":"TORMUND","weight":34},{"directed":false,"source":"DAENERYS","target":"RANDYLL","weight":17},{"directed":false,"source":"DAVOS","target":"JORAH","weight":18},{"directed":false,"source":"DAENERYS","target":"MELISANDRE","weight":13},{"directed":false,"source":"GENDRY","target":"JORAH","weight":21},{"directed":false,"source":"DAVOS","target":"THEON","weight":15},{"directed":false,"source":"JON","target":"THOROS","weight":12},{"directed":false,"source":"BRONN","target":"DICKON","weight":11},{"directed":false,"source":"LITTLEFINGER","target":"MAESTER_WOLKAN","weight":11},{"directed":false,"source":"LYANNA_MORMONT","target":"ROBETT","weight":11},{"directed":false,"source":"THOROS","target":"TORMUND","weight":11},{"directed":false,"source":"DAENERYS","target":"DICKON","weight":12},{"directed":false,"source":"DAENERYS","target":"NIGHT_KING","weight":20},{"directed":false,"source":"DAVOS","target":"VARYS","weight":24},{"directed":false,"source":"EURON","target":"MOUNTAIN","weight":15},{"directed":false,"source":"BERIC","target":"NIGHT_KING","weight":10},{"directed":false,"source":"BRONN","target":"DAENERYS","weight":10},{"directed":false,"source":"BRONN","target":"RANDYLL","weight":8},{"directed":false,"source":"ELLARIA","target":"THEON","weight":8},{"directed":false,"source":"EURON","target":"TYRION","weight":12},{"directed":false,"source":"ROBETT","target":"YOHN_ROYCE","weight":8},{"directed":false,"source":"BRAN","target":"MAESTER_WOLKAN","weight":11},{"directed":false,"source":"DAENERYS","target":"EURON","weight":17},{"directed":false,"source":"JORAH","target":"THEON","weight":10},{"directed":false,"source":"LYANNA","target":"RHAEGAR","weight":11},{"directed":false,"source":"RANDYLL","target":"TYRION","weight":7},{"directed":false,"source":"ARYA","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"CERSEI","target":"RANDYLL","weight":6},{"directed":false,"source":"DAENERYS","target":"HOUND","weight":13},{"directed":false,"source":"ELLARIA","target":"QYBURN","weight":6},{"directed":false,"source":"EURON","target":"TYENE","weight":6},{"directed":false,"source":"LITTLEFINGER","target":"ROBETT","weight":6},{"directed":false,"source":"LYANNA_MORMONT","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"NIGHT_KING","target":"TORMUND","weight":6},{"directed":false,"source":"TYENE","target":"YARA","weight":6},{"directed":false,"source":"AERYS","target":"JON","weight":7},{"directed":false,"source":"ALYS","target":"NED_UMBER","weight":5},{"directed":false,"source":"ARYA","target":"MAESTER_WOLKAN","weight":9},{"directed":false,"source":"DAENERYS","target":"TORMUND","weight":21},{"directed":false,"source":"DAVOS","target":"HOUND","weight":8},{"directed":false,"source":"ELLARIA","target":"EURON","weight":5},{"directed":false,"source":"EURON","target":"JON","weight":5},{"directed":false,"source":"HOUND","target":"NIGHT_KING","weight":5},{"directed":false,"source":"JON","target":"MAESTER_WOLKAN","weight":11},{"directed":false,"source":"JON","target":"MOUNTAIN","weight":5},{"directed":false,"source":"JON","target":"YOHN_ROYCE","weight":9},{"directed":false,"source":"QYBURN","target":"TYENE","weight":5},{"directed":false,"source":"ARYA","target":"ROBETT","weight":4},{"directed":false,"source":"BERIC","target":"DAENERYS","weight":8},{"directed":false,"source":"BRAN","target":"EDDISON_TOLLETT","weight":4},{"directed":false,"source":"BRAN","target":"RHAEGAR","weight":4},{"directed":false,"source":"BRIENNE","target":"LYANNA_MORMONT","weight":11},{"directed":false,"source":"BRIENNE","target":"ROBETT","weight":4},{"directed":false,"source":"BRIENNE","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"CERSEI","target":"THEON","weight":4},{"directed":false,"source":"DAVOS","target":"PODRICK","weight":13},{"directed":false,"source":"DICKON","target":"TYRION","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"MEERA","weight":4},{"directed":false,"source":"EURON","target":"NYMERIA","weight":4},{"directed":false,"source":"EURON","target":"OBARA","weight":4},{"directed":false,"source":"EURON","target":"QYBURN","weight":10},{"directed":false,"source":"GENDRY","target":"TYRION","weight":10},{"directed":false,"source":"HOUND","target":"THEON","weight":4},{"directed":false,"source":"JEOR","target":"JORAH","weight":4},{"directed":false,"source":"JON","target":"LYANNA","weight":13},{"directed":false,"source":"JON","target":"NED_UMBER","weight":4},{"directed":false,"source":"JON","target":"QYBURN","weight":4},{"directed":false,"source":"JORAH","target":"NIGHT_KING","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"LYANNA_MORMONT","weight":4},{"directed":false,"source":"MAESTER_WOLKAN","target":"YOHN_ROYCE","weight":8},{"directed":false,"source":"MELISANDRE","target":"TYRION","weight":4},{"directed":false,"source":"MOUNTAIN","target":"TYENE","weight":4},{"directed":false,"source":"NYMERIA","target":"YARA","weight":4},{"directed":false,"source":"OBARA","target":"YARA","weight":4},{"directed":false,"source":"OLENNA","target":"RANDYLL","weight":4},{"directed":false,"source":"QYBURN","target":"TYRION","weight":23},{"directed":false,"source":"AEGON","target":"DAENERYS","weight":5},{"directed":false,"source":"AERYS","target":"VARYS","weight":3},{"directed":false,"source":"ALYS","target":"JON","weight":8},{"directed":false,"source":"ARYA","target":"LYANNA_MORMONT","weight":7},{"directed":false,"source":"BALERION","target":"QYBURN","weight":3},{"directed":false,"source":"BERIC","target":"DAVOS","weight":7},{"directed":false,"source":"BRAN","target":"DAENERYS","weight":19},{"directed":false,"source":"BRAN","target":"YOHN_ROYCE","weight":9},{"directed":false,"source":"BRIENNE","target":"MOUNTAIN","weight":3},{"directed":false,"source":"BRIENNE","target":"QYBURN","weight":3},{"directed":false,"source":"BRONN","target":"DAVOS","weight":13},{"directed":false,"source":"BRONN","target":"JON","weight":3},{"directed":false,"source":"DAENERYS","target":"ELLARIA","weight":3},{"directed":false,"source":"DAVOS","target":"EURON","weight":3},{"directed":false,"source":"DAVOS","target":"JAIME","weight":13},{"directed":false,"source":"DAVOS","target":"NIGHT_KING","weight":3},{"directed":false,"source":"HARRAG","target":"YARA","weight":3},{"directed":false,"source":"HOUND","target":"QYBURN","weight":7},{"directed":false,"source":"LITTLEFINGER","target":"MEERA","weight":3},{"directed":false,"source":"MOUNTAIN","target":"THEON","weight":3},{"directed":false,"source":"THEON","target":"TYENE","weight":3},{"directed":false,"source":"AERYS","target":"OLENNA","weight":2},{"directed":false,"source":"BALERION","target":"CERSEI","weight":2},{"directed":false,"source":"BRAN","target":"BRIENNE","weight":13},{"directed":false,"source":"BRAN","target":"PODRICK","weight":5},{"directed":false,"source":"BRIENNE","target":"EURON","weight":2},{"directed":false,"source":"BRIENNE","target":"JORAH","weight":15},{"directed":false,"source":"BRIENNE","target":"QHONO","weight":6},{"directed":false,"source":"BRIENNE","target":"VARYS","weight":11},{"directed":false,"source":"BRONN","target":"GREY_WORM","weight":2},{"directed":false,"source":"BRONN","target":"JORAH","weight":2},{"directed":false,"source":"BRONN","target":"THEON","weight":2},{"directed":false,"source":"CERSEI","target":"NIGHT_KING","weight":2},{"directed":false,"source":"CERSEI","target":"YARA","weight":2},{"directed":false,"source":"DAENERYS","target":"GENDRY","weight":23},{"directed":false,"source":"DAENERYS","target":"LITTLEFINGER","weight":2},{"directed":false,"source":"DAENERYS","target":"MOUNTAIN","weight":6},{"directed":false,"source":"DAENERYS","target":"QYBURN","weight":6},{"directed":false,"source":"DAENERYS","target":"TYWIN","weight":4},{"directed":false,"source":"DAVOS","target":"GREY_WORM","weight":29},{"directed":false,"source":"DAVOS","target":"MOUNTAIN","weight":2},{"directed":false,"source":"DAVOS","target":"QYBURN","weight":2},{"directed":false,"source":"DAVOS","target":"YOHN_ROYCE","weight":8},{"directed":false,"source":"DICKON","target":"OLENNA","weight":2},{"directed":false,"source":"DROGO","target":"JON","weight":2},{"directed":false,"source":"ELLARIA","target":"GREY_WORM","weight":2},{"directed":false,"source":"ELLARIA","target":"MISSANDEI","weight":2},{"directed":false,"source":"EURON","target":"HOUND","weight":2},{"directed":false,"source":"GREY_WORM","target":"JAIME","weight":21},{"directed":false,"source":"GREY_WORM","target":"JON","weight":52},{"directed":false,"source":"GREY_WORM","target":"MELISANDRE","weight":7},{"directed":false,"source":"GREY_WORM","target":"OLENNA","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"SAM","weight":2},{"directed":false,"source":"HOT_PIE","target":"JON","weight":2},{"directed":false,"source":"HOUND","target":"MISSANDEI","weight":2},{"directed":false,"source":"HOUND","target":"QHONO","weight":2},{"directed":false,"source":"HOUND","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"HOWLAND","target":"MEERA","weight":2},{"directed":false,"source":"JON","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"JON_ARRYN","target":"SANSA","weight":2},{"directed":false,"source":"JORAH","target":"PODRICK","weight":6},{"directed":false,"source":"JORAH","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"LYANNA_MORMONT","target":"PODRICK","weight":2},{"directed":false,"source":"MARWYN","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"MARWYN","target":"ROBERT","weight":2},{"directed":false,"source":"MARWYN","target":"SHIREEN","weight":2},{"directed":false,"source":"MELISANDRE","target":"MISSANDEI","weight":2},{"directed":false,"source":"MISSANDEI","target":"OLENNA","weight":2},{"directed":false,"source":"MOUNTAIN","target":"MYRCELLA","weight":2},{"directed":false,"source":"MOUNTAIN","target":"RANDYLL","weight":2},{"directed":false,"source":"NIGHT_KING","target":"TYRION","weight":2},{"directed":false,"source":"NYMERIA","target":"THEON","weight":2},{"directed":false,"source":"OBARA","target":"THEON","weight":2},{"directed":false,"source":"OLENNA","target":"THEON","weight":2},{"directed":false,"source":"OLENNA","target":"YARA","weight":2},{"directed":false,"source":"PODRICK","target":"QHONO","weight":2},{"directed":false,"source":"PODRICK","target":"ROBETT","weight":2},{"directed":false,"source":"PODRICK","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"QHONO","target":"TYRION","weight":6},{"directed":false,"source":"QYBURN","target":"RANDYLL","weight":2},{"directed":false,"source":"QYBURN","target":"THEON","weight":2},{"directed":false,"source":"ROBERT","target":"SAM","weight":4},{"directed":false,"source":"ROBETT","target":"TORMUND","weight":2},{"directed":false,"source":"TORMUND","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"TORMUND","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"JAIME","target":"TORMUND","weight":38},{"directed":false,"source":"DAENERYS","target":"SAM","weight":26},{"directed":false,"source":"SAM","target":"TYRION","weight":24},{"directed":false,"source":"BRIENNE","target":"GREY_WORM","weight":23},{"directed":false,"source":"BRIENNE","target":"SAM","weight":23},{"directed":false,"source":"GREY_WORM","target":"SAM","weight":23},{"directed":false,"source":"GREY_WORM","target":"TORMUND","weight":23},{"directed":false,"source":"ARYA","target":"DAVOS","weight":22},{"directed":false,"source":"ARYA","target":"NORA","weight":22},{"directed":false,"source":"NORA","target":"VICKY","weight":22},{"directed":false,"source":"ARYA","target":"DAENERYS","weight":21},{"directed":false,"source":"BRONN","target":"QYBURN","weight":20},{"directed":false,"source":"JAIME","target":"SAM","weight":19},{"directed":false,"source":"TORMUND","target":"TYRION","weight":19},{"directed":false,"source":"GREY_WORM","target":"SANSA","weight":18},{"directed":false,"source":"GENDRY","target":"SAM","weight":17},{"directed":false,"source":"JORAH","target":"LYANNA_MORMONT","weight":17},{"directed":false,"source":"GENDRY","target":"GREY_WORM","weight":16},{"directed":false,"source":"BERIC","target":"SAM","weight":15},{"directed":false,"source":"BRAN","target":"GREY_WORM","weight":15},{"directed":false,"source":"ARYA","target":"VICKY","weight":14},{"directed":false,"source":"JAIME","target":"JORAH","weight":14},{"directed":false,"source":"MISSANDEI","target":"SANSA","weight":14},{"directed":false,"source":"ARYA","target":"GREY_WORM","weight":13},{"directed":false,"source":"BRIENNE","target":"GENDRY","weight":13},{"directed":false,"source":"GENDRY","target":"JAIME","weight":13},{"directed":false,"source":"LYANNA_MORMONT","target":"SAM","weight":13},{"directed":false,"source":"BERIC","target":"GREY_WORM","weight":12},{"directed":false,"source":"CRAYAH","target":"DIRAH","weight":12},{"directed":false,"source":"SAM","target":"SANSA","weight":12},{"directed":false,"source":"BRIENNE","target":"DAENERYS","weight":11},{"directed":false,"source":"CERSEI","target":"HARRY","weight":11},{"directed":false,"source":"JORAH","target":"MELISANDRE","weight":11},{"directed":false,"source":"MARTHA","target":"VARYS","weight":11},{"directed":false,"source":"ARYA","target":"SAM","weight":10},{"directed":false,"source":"BERIC","target":"BRIENNE","weight":10},{"directed":false,"source":"DAENERYS","target":"MAESTER_WOLKAN","weight":10},{"directed":false,"source":"JAIME","target":"LYANNA_MORMONT","weight":10},{"directed":false,"source":"JORAH","target":"SANSA","weight":10},{"directed":false,"source":"BERIC","target":"EDDISON_TOLLETT","weight":9},{"directed":false,"source":"BERIC","target":"JAIME","weight":9},{"directed":false,"source":"BRAN","target":"DAVOS","weight":9},{"directed":false,"source":"CERSEI","target":"MISSANDEI","weight":9},{"directed":false,"source":"TYRION","target":"MAESTER_WOLKAN","weight":9},{"directed":false,"source":"TYRION","target":"YOHN_ROYCE","weight":9},{"directed":false,"source":"ALYS","target":"TYRION","weight":8},{"directed":false,"source":"BRAN","target":"VARYS","weight":8},{"directed":false,"source":"BRONN","target":"SAM","weight":8},{"directed":false,"source":"GENDRY","target":"PODRICK","weight":8},{"directed":false,"source":"GILLY","target":"SANSA","weight":8},{"directed":false,"source":"GILLY","target":"TYRION","weight":8},{"directed":false,"source":"GILLY","target":"VARYS","weight":8},{"directed":false,"source":"HOUND","target":"MELISANDRE","weight":8},{"directed":false,"source":"HOUND","target":"SAM","weight":8},{"directed":false,"source":"NIGHT_KING","target":"THEON","weight":8},{"directed":false,"source":"PODRICK","target":"SAM","weight":8},{"directed":false,"source":"ARYA","target":"TORMUND","weight":7},{"directed":false,"source":"BRONN","target":"CRAYAH","weight":7},{"directed":false,"source":"DAENERYS","target":"LYANNA_MORMONT","weight":7},{"directed":false,"source":"GREY_WORM","target":"LYANNA_MORMONT","weight":7},{"directed":false,"source":"GREY_WORM","target":"PODRICK","weight":7},{"directed":false,"source":"JON","target":"RHAEGAR","weight":7},{"directed":false,"source":"LYANNA_MORMONT","target":"TYRION","weight":7},{"directed":false,"source":"ALYS","target":"DAVOS","weight":6},{"directed":false,"source":"ALYS","target":"VARYS","weight":6},{"directed":false,"source":"BRAN","target":"JORAH","weight":6},{"directed":false,"source":"BRAN","target":"MISSANDEI","weight":6},{"directed":false,"source":"BRIENNE","target":"MAESTER_WOLKAN","weight":6},{"directed":false,"source":"BRIENNE","target":"MISSANDEI","weight":6},{"directed":false,"source":"DAENERYS","target":"YOHN_ROYCE","weight":6},{"directed":false,"source":"DAVOS","target":"GILLY","weight":6},{"directed":false,"source":"DAVOS","target":"MAESTER_WOLKAN","weight":6},{"directed":false,"source":"GREY_WORM","target":"HOUND","weight":6},{"directed":false,"source":"GREY_WORM","target":"QHONO","weight":6},{"directed":false,"source":"LITTLE_SAM","target":"SANSA","weight":6},{"directed":false,"source":"LITTLE_SAM","target":"TYRION","weight":6},{"directed":false,"source":"LITTLE_SAM","target":"VARYS","weight":6},{"directed":false,"source":"QHONO","target":"SAM","weight":6},{"directed":false,"source":"SAM","target":"VARYS","weight":6},{"directed":false,"source":"SAM","target":"YOHN_ROYCE","weight":6},{"directed":false,"source":"TORMUND","target":"VARYS","weight":6},{"directed":false,"source":"ALYS","target":"BRAN","weight":5},{"directed":false,"source":"ALYS","target":"DAENERYS","weight":5},{"directed":false,"source":"ALYS","target":"GREY_WORM","weight":5},{"directed":false,"source":"ALYS","target":"JORAH","weight":5},{"directed":false,"source":"ALYS","target":"LYANNA_MORMONT","weight":5},{"directed":false,"source":"ALYS","target":"SANSA","weight":5},{"directed":false,"source":"ARYA","target":"JORAH","weight":5},{"directed":false,"source":"ARYA","target":"MISSANDEI","weight":5},{"directed":false,"source":"BRAN","target":"LYANNA_MORMONT","weight":5},{"directed":false,"source":"BRONN","target":"DIRAH","weight":5},{"directed":false,"source":"BRONN","target":"MAREI","weight":5},{"directed":false,"source":"CERSEI","target":"GREY_WORM","weight":5},{"directed":false,"source":"EDMURE","target":"SANSA","weight":5},{"directed":false,"source":"GENDRY","target":"SANSA","weight":5},{"directed":false,"source":"GREY_WORM","target":"YOHN_ROYCE","weight":5},{"directed":false,"source":"LYANNA_MORMONT","target":"VARYS","weight":5},{"directed":false,"source":"MISSANDEI","target":"MOUNTAIN","weight":5},{"directed":false,"source":"SAM","target":"MAESTER_WOLKAN","weight":5},{"directed":false,"source":"TORMUND","target":"WILLA","weight":5},{"directed":false,"source":"VARYS","target":"MAESTER_WOLKAN","weight":5},{"directed":false,"source":"ALYS","target":"BRIENNE","weight":4},{"directed":false,"source":"ALYS","target":"JAIME","weight":4},{"directed":false,"source":"ALYS","target":"SAM","weight":4},{"directed":false,"source":"ALYS","target":"THEON","weight":4},{"directed":false,"source":"ALYS","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"ARYA","target":"OWEN","weight":4},{"directed":false,"source":"ARYA","target":"QHONO","weight":4},{"directed":false,"source":"ARYA","target":"THEON","weight":4},{"directed":false,"source":"BERIC","target":"LYANNA_MORMONT","weight":4},{"directed":false,"source":"BERIC","target":"SANSA","weight":4},{"directed":false,"source":"BRAN","target":"GENDRY","weight":4},{"directed":false,"source":"BRAN","target":"QHONO","weight":4},{"directed":false,"source":"DAENERYS","target":"PODRICK","weight":4},{"directed":false,"source":"DAENERYS","target":"QHONO","weight":4},{"directed":false,"source":"DAVOS","target":"QHONO","weight":4},{"directed":false,"source":"DAVOS","target":"TEELA","weight":4},{"directed":false,"source":"DORNISH_PRINCE","target":"YARA","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"GREY_WORM","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"JORAH","weight":4},{"directed":false,"source":"EDMURE","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"EURON","target":"HARRY","weight":4},{"directed":false,"source":"EURON","target":"MISSANDEI","weight":4},{"directed":false,"source":"GILLY","target":"MISSANDEI","weight":4},{"directed":false,"source":"GREY_WORM","target":"MAESTER_WOLKAN","weight":4},{"directed":false,"source":"HOUND","target":"NORA","weight":4},{"directed":false,"source":"JAIME","target":"QHONO","weight":4},{"directed":false,"source":"JAIME","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"JON","target":"QHONO","weight":4},{"directed":false,"source":"JORAH","target":"QHONO","weight":4},{"directed":false,"source":"JORAH","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"LYANNA_MORMONT","target":"QHONO","weight":4},{"directed":false,"source":"LYANNA_MORMONT","target":"THEON","weight":4},{"directed":false,"source":"MISSANDEI","target":"SAM","weight":4},{"directed":false,"source":"QHONO","target":"SANSA","weight":4},{"directed":false,"source":"QHONO","target":"TORMUND","weight":4},{"directed":false,"source":"QHONO","target":"VARYS","weight":4},{"directed":false,"source":"ROBIN","target":"MAESTER_WOLKAN","weight":4},{"directed":false,"source":"SAM","target":"THEON","weight":4},{"directed":false,"source":"SANSA","target":"YARA","weight":4},{"directed":false,"source":"VARYS","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"ALYS","target":"ARYA","weight":3},{"directed":false,"source":"ALYS","target":"MAESTER_WOLKAN","weight":3},{"directed":false,"source":"ALYS","target":"TORMUND","weight":3},{"directed":false,"source":"ARYA","target":"NIGHT_KING","weight":3},{"directed":false,"source":"ARYA","target":"YARA","weight":3},{"directed":false,"source":"BERIC","target":"BRAN","weight":3},{"directed":false,"source":"BERIC","target":"NED_UMBER","weight":3},{"directed":false,"source":"BERIC","target":"THEON","weight":3},{"directed":false,"source":"BERIC","target":"TYRION","weight":3},{"directed":false,"source":"BERIC","target":"VARYS","weight":3},{"directed":false,"source":"BRAN","target":"BRONN","weight":3},{"directed":false,"source":"CRAYAH","target":"MAREI","weight":3},{"directed":false,"source":"CRAYAH","target":"QYBURN","weight":3},{"directed":false,"source":"DIRAH","target":"MAREI","weight":3},{"directed":false,"source":"DORNISH_PRINCE","target":"ROBIN","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"GENDRY","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"HOUND","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"JAIME","weight":3},{"directed":false,"source":"EDMURE","target":"MAESTER_WOLKAN","weight":3},{"directed":false,"source":"EDMURE","target":"RIVERLANDS_LORD","weight":3},{"directed":false,"source":"EDMURE","target":"ROBIN","weight":3},{"directed":false,"source":"EDMURE","target":"SAM","weight":3},{"directed":false,"source":"EDMURE","target":"TYRION","weight":3},{"directed":false,"source":"GENDRY","target":"VALE_LORD","weight":3},{"directed":false,"source":"GENDRY","target":"YOHN_ROYCE","weight":3},{"directed":false,"source":"GREY_WORM","target":"MOUNTAIN","weight":3},{"directed":false,"source":"GREY_WORM","target":"UNSULLIED_CAPTAIN","weight":3},{"directed":false,"source":"HOUND","target":"SARRA","weight":3},{"directed":false,"source":"HOUND","target":"VICKY","weight":3},{"directed":false,"source":"IRONBORN_LORD","target":"VALE_LORD","weight":3},{"directed":false,"source":"IRONBORN_LORD","target":"YARA","weight":3},{"directed":false,"source":"JAIME","target":"MISSANDEI","weight":3},{"directed":false,"source":"LYANNA","target":"VARYS","weight":3},{"directed":false,"source":"LYANNA_MORMONT","target":"MISSANDEI","weight":3},{"directed":false,"source":"MISSANDEI","target":"QYBURN","weight":3},{"directed":false,"source":"NED","target":"RHAEGAR","weight":3},{"directed":false,"source":"NED_UMBER","target":"SANSA","weight":3},{"directed":false,"source":"RHAEGAR","target":"VARYS","weight":3},{"directed":false,"source":"RIVERLANDS_LORD","target":"YOHN_ROYCE","weight":3},{"directed":false,"source":"ROBIN","target":"SAM","weight":3},{"directed":false,"source":"THEON","target":"TORMUND","weight":3},{"directed":false,"source":"ALANNA","target":"OWEN","weight":2},{"directed":false,"source":"ALYS","target":"BERIC","weight":2},{"directed":false,"source":"ALYS","target":"GENDRY","weight":2},{"directed":false,"source":"ALYS","target":"MISSANDEI","weight":2},{"directed":false,"source":"ALYS","target":"QHONO","weight":2},{"directed":false,"source":"ARYA","target":"DORNISH_PRINCE","weight":2},{"directed":false,"source":"ARYA","target":"EDDISON_TOLLETT","weight":2},{"directed":false,"source":"ARYA","target":"EDMURE","weight":2},{"directed":false,"source":"ARYA","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"ARYA","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"ARYA","target":"ROBIN","weight":2},{"directed":false,"source":"ARYA","target":"VALE_LORD","weight":2},{"directed":false,"source":"BERIC","target":"GILLY","weight":2},{"directed":false,"source":"BERIC","target":"PODRICK","weight":2},{"directed":false,"source":"BERIC","target":"QHONO","weight":2},{"directed":false,"source":"BERIC","target":"TEELA","weight":2},{"directed":false,"source":"BERIC","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"BRAN","target":"DORNISH_PRINCE","weight":2},{"directed":false,"source":"BRAN","target":"EDMURE","weight":2},{"directed":false,"source":"BRAN","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"BRAN","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"BRAN","target":"ROBIN","weight":2},{"directed":false,"source":"BRAN","target":"VALE_LORD","weight":2},{"directed":false,"source":"BRAN","target":"YARA","weight":2},{"directed":false,"source":"BRIENNE","target":"DORNISH_PRINCE","weight":2},{"directed":false,"source":"BRIENNE","target":"EDMURE","weight":2},{"directed":false,"source":"BRIENNE","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"BRIENNE","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"BRIENNE","target":"ROBIN","weight":2},{"directed":false,"source":"BRIENNE","target":"VALE_LORD","weight":2},{"directed":false,"source":"BRIENNE","target":"YARA","weight":2},{"directed":false,"source":"CERSEI","target":"CERSEIS_BABY","weight":2},{"directed":false,"source":"CERSEIS_BABY","target":"JAIME","weight":2},{"directed":false,"source":"CERSEIS_BABY","target":"TYRION","weight":2},{"directed":false,"source":"CRAYAH","target":"WILLIAM","weight":2},{"directed":false,"source":"DAENERYS","target":"EDDISON_TOLLETT","weight":2},{"directed":false,"source":"DAENERYS","target":"LYANNA","weight":2},{"directed":false,"source":"DAENERYS","target":"NED_UMBER","weight":2},{"directed":false,"source":"DAVOS","target":"DORNISH_PRINCE","weight":2},{"directed":false,"source":"DAVOS","target":"EDMURE","weight":2},{"directed":false,"source":"DAVOS","target":"HARRY","weight":2},{"directed":false,"source":"DAVOS","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"DAVOS","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"DAVOS","target":"ROBIN","weight":2},{"directed":false,"source":"DAVOS","target":"VALE_LORD","weight":2},{"directed":false,"source":"DAVOS","target":"YARA","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"EDMURE","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"GENDRY","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"GREY_WORM","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"SAM","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"SANSA","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"TYRION","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"VALE_LORD","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"LYANNA_MORMONT","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"NED_UMBER","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"TEELA","weight":2},{"directed":false,"source":"EDMURE","target":"GENDRY","weight":2},{"directed":false,"source":"EDMURE","target":"GREY_WORM","weight":2},{"directed":false,"source":"EDMURE","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"EDMURE","target":"VALE_LORD","weight":2},{"directed":false,"source":"EDMURE","target":"YARA","weight":2},{"directed":false,"source":"EURON","target":"GREY_WORM","weight":2},{"directed":false,"source":"EURON","target":"VARYS","weight":2},{"directed":false,"source":"GENDRY","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"GENDRY","target":"LYANNA_MORMONT","weight":2},{"directed":false,"source":"GENDRY","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"GENDRY","target":"QHONO","weight":2},{"directed":false,"source":"GENDRY","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"GENDRY","target":"ROBIN","weight":2},{"directed":false,"source":"GENDRY","target":"YARA","weight":2},{"directed":false,"source":"GILLY","target":"PODRICK","weight":2},{"directed":false,"source":"GILLY","target":"TEELA","weight":2},{"directed":false,"source":"GREY_WORM","target":"HARRY","weight":2},{"directed":false,"source":"GREY_WORM","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"GREY_WORM","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"GREY_WORM","target":"ROBIN","weight":2},{"directed":false,"source":"GREY_WORM","target":"VALE_LORD","weight":2},{"directed":false,"source":"HARRY","target":"JON","weight":2},{"directed":false,"source":"HOUND","target":"WILLA","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"ROBIN","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"SAM","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"SANSA","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"TYRION","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"JAIME","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"JON","target":"TEELA","weight":2},{"directed":false,"source":"JON","target":"UNSULLIED_CAPTAIN","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"MISSANDEI","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"PODRICK","weight":2},{"directed":false,"source":"LYANNA","target":"SAM","weight":2},{"directed":false,"source":"MAESTER_WOLKAN","target":"YARA","weight":2},{"directed":false,"source":"MELISANDRE","target":"QHONO","weight":2},{"directed":false,"source":"MISSANDEI","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"MISSANDEI","target":"PODRICK","weight":2},{"directed":false,"source":"MISSANDEI","target":"QHONO","weight":2},{"directed":false,"source":"MISSANDEI","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"MOUNTAIN","target":"VARYS","weight":2},{"directed":false,"source":"NED_UMBER","target":"TORMUND","weight":2},{"directed":false,"source":"QHONO","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"QHONO","target":"THEON","weight":2},{"directed":false,"source":"QHONO","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"RHAEGAR","target":"SAM","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"ROBIN","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"SAM","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"SANSA","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"TYRION","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"VALE_LORD","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"YARA","weight":2},{"directed":false,"source":"ROBIN","target":"VALE_LORD","weight":2},{"directed":false,"source":"ROBIN","target":"YARA","weight":2},{"directed":false,"source":"SAM","target":"TEELA","weight":2},{"directed":false,"source":"SAM","target":"VALE_LORD","weight":2},{"directed":false,"source":"SAM","target":"YARA","weight":2},{"directed":false,"source":"SANSA","target":"SARRA","weight":2},{"directed":false,"source":"SANSA","target":"VALE_LORD","weight":2},{"directed":false,"source":"SANSA","target":"WILLA","weight":2},{"directed":false,"source":"SARRA","target":"TORMUND","weight":2},{"directed":false,"source":"SARRA","target":"WILLA","weight":2},{"directed":false,"source":"TEELA","target":"TORMUND","weight":2},{"directed":false,"source":"THEON","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"THEON","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"TYRION","target":"VALE_LORD","weight":2},{"directed":false,"source":"VALE_LORD","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"VALE_LORD","target":"YARA","weight":2},{"directed":false,"source":"VALE_LORD","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"YARA","target":"YOHN_ROYCE","weight":2}]}'),D7=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"home",component:N7},{path:"example",component:(()=>{class r{constructor(){this.nodes=[],this.links=[],this.nodes=N1.t,this.links=N1.$}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=Zn({type:r,selectors:[["app-example"]],decls:1,vars:2,consts:[[3,"nodes","links"]],template:function(t,n){1&t&&Ii(0,"ngx-graph-msagl",0),2&t&&Wt("nodes",n.nodes)("links",n.links)},directives:[P1],styles:["[_nghost-%COMP%]{display:block;height:inherit}"]}),r})()},{path:"help",component:oW},{path:"**",component:_7}];let AO,x7=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[Nx.forRoot(D7)],Nx]}),r})();try{AO="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(r){AO=!1}let aE,bA,hd,CO,Cl=(()=>{class r{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function n3(r){return r===oD}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!AO)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return r.\u0275fac=function(t){return new(t||r)($e(JR))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),_1=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({}),r})();function bO(r){return function L7(){if(null==aE&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>aE=!0}))}finally{aE=aE||!1}return aE}()?r:!!r.capture}function lE(){if("object"!=typeof document||!document)return 0;if(null==bA){const r=document.createElement("div"),e=r.style;r.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),n=t.style;n.width="2px",n.height="1px",r.appendChild(t),document.body.appendChild(r),bA=0,0===r.scrollLeft&&(r.scrollLeft=1,bA=0===r.scrollLeft?1:2),r.remove()}return bA}function cE(r){return r.composedPath?r.composedPath()[0]:r.target}function Ha(r){return null!=r&&"false"!=`${r}`}function x1(r,e=0){return function G7(r){return!isNaN(parseFloat(r))&&!isNaN(Number(r))}(r)?Number(r):e}function L1(r){return Array.isArray(r)?r:[r]}function Ig(r){return r instanceof Dr?r.nativeElement:r}const uE={schedule(r){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=uE;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);const i=e(s=>{t=void 0,r(s)});return new m(()=>null==t?void 0:t(i))},requestAnimationFrame(...r){const{delegate:e}=uE;return((null==e?void 0:e.requestAnimationFrame)||requestAnimationFrame)(...r)},cancelAnimationFrame(...r){const{delegate:e}=uE;return((null==e?void 0:e.cancelAnimationFrame)||cancelAnimationFrame)(...r)},delegate:void 0};new class H7 extends pO{flush(e){this._active=!0,this._scheduled=void 0;const{actions:t}=this;let n,i=-1;e=e||t.shift();const s=t.length;do{if(n=e.execute(e.state,e.delay))break}while(++i<s&&(e=t.shift()));if(this._active=!1,n){for(;++i<s&&(e=t.shift());)e.unsubscribe();throw n}}}(class V7 extends gO{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=uE.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);0===e.actions.length&&(uE.cancelAnimationFrame(t),e._scheduled=void 0)}});let RO,U7=1;const CA={};function M1(r){return r in CA&&(delete CA[r],!0)}const W7={setImmediate(r){const e=U7++;return CA[e]=!0,RO||(RO=Promise.resolve()),RO.then(()=>M1(e)&&r()),e},clearImmediate(r){M1(r)}},{setImmediate:j7,clearImmediate:z7}=W7,RA={setImmediate(...r){const{delegate:e}=RA;return((null==e?void 0:e.setImmediate)||j7)(...r)},clearImmediate(r){const{delegate:e}=RA;return((null==e?void 0:e.clearImmediate)||z7)(r)},delegate:void 0};new class K7 extends pO{flush(e){this._active=!0,this._scheduled=void 0;const{actions:t}=this;let n,i=-1;e=e||t.shift();const s=t.length;do{if(n=e.execute(e.state,e.delay))break}while(++i<s&&(e=t.shift()));if(this._active=!1,n){for(;++i<s&&(e=t.shift());)e.unsubscribe();throw n}}}(class $7 extends gO{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=RA.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);0===e.actions.length&&(RA.clearImmediate(t),e._scheduled=void 0)}});function F1(r=0,e,t=n1){let n=-1;return null!=e&&(ra(e)?t=e:n=e),new ee(i=>{let s=function Q7(r){return r instanceof Date&&!isNaN(r)}(r)?+r-t.now():r;s<0&&(s=0);let o=0;return t.schedule(function(){i.closed||(i.next(o++),0<=n?this.schedule(void 0,n):i.complete())},s)})}function B1(r,e=n1){return function q7(r){return Se((e,t)=>{let n=!1,i=null,s=null,o=!1;const a=()=>{if(null==s||s.unsubscribe(),s=null,n){n=!1;const c=i;i=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(new Ie(t,c=>{n=!0,i=c,s||Si(r(c)).subscribe(s=new Ie(t,a,l))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}(()=>F1(r,e))}function vo(r){return Se((e,t)=>{Si(r).subscribe(new Ie(t,()=>t.complete(),x)),!t.closed&&e.subscribe(t)})}const X7=new pt("cdk-dir-doc",{providedIn:"root",factory:function Z7(){return wh(Ln)}});let k1=(()=>{class r{constructor(t){if(this.value="ltr",this.change=new Gn,t){const i=t.documentElement?t.documentElement.dir:null,s=(t.body?t.body.dir:null)||i;this.value="ltr"===s||"rtl"===s?s:"ltr"}}ngOnDestroy(){this.change.complete()}}return r.\u0275fac=function(t){return new(t||r)($e(X7,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),G1=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({}),r})(),TO=(()=>{class r{constructor(t,n,i){this._ngZone=t,this._platform=n,this._scrolled=new ke,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new ee(n=>{this._globalSubscription||this._addGlobalListener();const i=t>0?this._scrolled.pipe(B1(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Tt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const i=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(Ki(s=>!s||i.indexOf(s)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((i,s)=>{this._scrollableContainsElement(s,t)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let i=Ig(n),s=t.getElementRef().nativeElement;do{if(i==s)return!0}while(i=i.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>vg(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return r.\u0275fac=function(t){return new(t||r)($e(vn),$e(Cl),$e(Ln,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),TA=(()=>{class r{constructor(t,n,i,s){this.elementRef=t,this.scrollDispatcher=n,this.ngZone=i,this.dir=s,this._destroyed=new ke,this._elementScrolled=new ee(o=>this.ngZone.runOutsideAngular(()=>vg(this.elementRef.nativeElement,"scroll").pipe(vo(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const n=this.elementRef.nativeElement,i=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=i?t.end:t.start),null==t.right&&(t.right=i?t.start:t.end),null!=t.bottom&&(t.top=n.scrollHeight-n.clientHeight-t.bottom),i&&0!=lE()?(null!=t.left&&(t.right=n.scrollWidth-n.clientWidth-t.left),2==lE()?t.left=t.right:1==lE()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=n.scrollWidth-n.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const n=this.elementRef.nativeElement;!function M7(){if(null==hd){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return hd=!1,hd;if("scrollBehavior"in document.documentElement.style)hd=!0;else{const r=Element.prototype.scrollTo;hd=!!r&&!/\{\s*\[native code\]\s*\}/.test(r.toString())}}return hd}()?(null!=t.top&&(n.scrollTop=t.top),null!=t.left&&(n.scrollLeft=t.left)):n.scrollTo(t)}measureScrollOffset(t){const n="left",i="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?i:n:"end"==t&&(t=o?n:i),o&&2==lE()?t==n?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==lE()?t==n?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==n?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return r.\u0275fac=function(t){return new(t||r)(Ue(Dr),Ue(TO),Ue(vn),Ue(k1,8))},r.\u0275dir=Mn({type:r,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),r})(),n9=(()=>{class r{constructor(t,n,i){this._platform=t,this._change=new ke,this._changeListener=s=>{this._change.next(s)},this._document=i,n.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:i}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+i,right:t.left+n,height:i,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),i=t.documentElement,s=i.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||n.scrollY||i.scrollTop||0,left:-s.left||t.body.scrollLeft||n.scrollX||i.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(B1(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return r.\u0275fac=function(t){return new(t||r)($e(Cl),$e(vn),$e(Ln,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),V1=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({}),r})();const H1=new Vh("13.0.2");function Y1(r){return Ki((e,t)=>r<=t)}function U1(r,e=ae){return r=null!=r?r:u9,Se((t,n)=>{let i,s=!0;t.subscribe(new Ie(n,o=>{const a=e(o);(s||!r(i,a))&&(s=!1,i=a,n.next(o))}))})}function u9(r,e){return r===e}let z1=(()=>{class r{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function g9(r){return!!(r.offsetWidth||r.offsetHeight||"function"==typeof r.getClientRects&&r.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const n=function f9(r){try{return r.frameElement}catch(e){return null}}(function A9(r){return r.ownerDocument&&r.ownerDocument.defaultView||window}(t));if(n&&(-1===K1(n)||!this.isVisible(n)))return!1;let i=t.nodeName.toLowerCase(),s=K1(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===i||"object"===i||this._platform.WEBKIT&&this._platform.IOS&&!function v9(r){let e=r.nodeName.toLowerCase(),t="input"===e&&r.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===i?!!t.hasAttribute("controls")&&-1!==s:"video"===i?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,n){return function S9(r){return!function m9(r){return function E9(r){return"input"==r.nodeName.toLowerCase()}(r)&&"hidden"==r.type}(r)&&(function p9(r){let e=r.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(r)||function y9(r){return function w9(r){return"a"==r.nodeName.toLowerCase()}(r)&&r.hasAttribute("href")}(r)||r.hasAttribute("contenteditable")||$1(r))}(t)&&!this.isDisabled(t)&&((null==n?void 0:n.ignoreVisibility)||this.isVisible(t))}}return r.\u0275fac=function(t){return new(t||r)($e(Cl))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function $1(r){if(!r.hasAttribute("tabindex")||void 0===r.tabIndex)return!1;let e=r.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function K1(r){if(!$1(r))return null;const e=parseInt(r.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class b9{constructor(e,t,n,i,s=!1){this._element=e,this._checker=t,this._ngZone=n,this._document=i,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);for(let n=0;n<t.length;n++)t[n].hasAttribute(`cdk-focus-${e}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[n]):t[n].hasAttribute(`cdk-focus-region-${e}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[n]);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),!this._checker.isFocusable(t)){const n=this._getFirstTabbableElement(t);return null==n||n.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=0;n<t.length;n++){const i=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(i)return i}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=t.length-1;n>=0;n--){const i=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(i)return i}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Ai(1)).subscribe(e)}}let C9=(()=>{class r{constructor(t,n,i){this._checker=t,this._ngZone=n,this._document=i}create(t,n=!1){return new b9(t,this._checker,this._ngZone,this._document,n)}}return r.\u0275fac=function(t){return new(t||r)($e(z1),$e(vn),$e(Ln))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function J1(r){return 0===r.offsetX&&0===r.offsetY}function q1(r){const e=r.touches&&r.touches[0]||r.changedTouches&&r.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const R9=new pt("cdk-input-modality-detector-options"),T9={ignoreKeys:[18,17,224,91,16]},Pg=bO({passive:!0,capture:!0});let O9=(()=>{class r{constructor(t,n,i,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Wo(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=cE(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(J1(o)?"keyboard":"mouse"),this._mostRecentTarget=cE(o))},this._onTouchstart=o=>{q1(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=cE(o))},this._options=Object.assign(Object.assign({},T9),s),this.modalityDetected=this._modality.pipe(Y1(1)),this.modalityChanged=this.modalityDetected.pipe(U1()),t.isBrowser&&n.runOutsideAngular(()=>{i.addEventListener("keydown",this._onKeydown,Pg),i.addEventListener("mousedown",this._onMousedown,Pg),i.addEventListener("touchstart",this._onTouchstart,Pg)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Pg),document.removeEventListener("mousedown",this._onMousedown,Pg),document.removeEventListener("touchstart",this._onTouchstart,Pg))}}return r.\u0275fac=function(t){return new(t||r)($e(Cl),$e(vn),$e(Ln),$e(R9,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const P9=new pt("cdk-focus-monitor-default-options"),OA=bO({passive:!0,capture:!0});let X1=(()=>{class r{constructor(t,n,i,s,o){this._ngZone=t,this._platform=n,this._inputModalityDetector=i,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new ke,this._rootNodeFocusAndBlurListener=a=>{const l=cE(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let d=l;d;d=d.parentElement)c.call(this,a,d)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,n=!1){const i=Ig(t);if(!this._platform.isBrowser||1!==i.nodeType)return Tt(null);const s=function B7(r){if(function F7(){if(null==CO){const r="undefined"!=typeof document?document.head:null;CO=!(!r||!r.createShadowRoot&&!r.attachShadow)}return CO}()){const e=r.getRootNode?r.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(i)||this._getDocument(),o=this._elementInfo.get(i);if(o)return n&&(o.checkChildren=!0),o.subject;const a={checkChildren:n,subject:new ke,rootNode:s};return this._elementInfo.set(i,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const n=Ig(t),i=this._elementInfo.get(n);i&&(i.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(i))}focusVia(t,n,i){const s=Ig(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,n,l)):(this._setOrigin(n),"function"==typeof s.focus&&s.focus(i))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused","touch"===n),t.classList.toggle("cdk-keyboard-focused","keyboard"===n),t.classList.toggle("cdk-mouse-focused","mouse"===n),t.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,n){const i=this._elementInfo.get(n),s=cE(t);!i||!i.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),i)}_onBlur(t,n){const i=this._elementInfo.get(n);!i||i.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(i.subject,null))}_emitOrigin(t,n){this._ngZone.run(()=>t.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const n=t.rootNode,i=this._rootNodeFocusListenerCount.get(n)||0;i||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,OA),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,OA)}),this._rootNodeFocusListenerCount.set(n,i+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(vo(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const i=this._rootNodeFocusListenerCount.get(n);i>1?this._rootNodeFocusListenerCount.set(n,i-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,OA),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,OA),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,i){this._setClasses(t,n),this._emitOrigin(i.subject,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){const n=[];return this._elementInfo.forEach((i,s)=>{(s===t||i.checkChildren&&s.contains(t))&&n.push([s,i])}),n}}return r.\u0275fac=function(t){return new(t||r)($e(vn),$e(Cl),$e(O9),$e(Ln,8),$e(P9,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const Z1="cdk-high-contrast-black-on-white",eF="cdk-high-contrast-white-on-black",OO="cdk-high-contrast-active";let N9=(()=>{class r{constructor(t,n){this._platform=t,this._document=n}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const n=this._document.defaultView||window,i=n&&n.getComputedStyle?n.getComputedStyle(t):null,s=(i&&i.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(OO),t.remove(Z1),t.remove(eF),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?(t.add(OO),t.add(Z1)):2===n&&(t.add(OO),t.add(eF))}}}return r.\u0275fac=function(t){return new(t||r)($e(Cl),$e(Ln))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const hn=!1;function tF(r){return new ot(3e3,hn)}function u$(){return"undefined"!=typeof window&&void 0!==window.document}function IO(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Lu(r){switch(r.length){case 0:return new zy;case 1:return r[0];default:return new ZL(r)}}function nF(r,e,t,n,i={},s={}){const o=[],a=[];let l=-1,c=null;if(n.forEach(d=>{const b=d.offset,N=b==l,F=N&&c||{};Object.keys(d).forEach(G=>{let W=G,ie=d[G];if("offset"!==G)switch(W=e.normalizePropertyName(W,o),ie){case"!":ie=i[G];break;case wc:ie=s[G];break;default:ie=e.normalizeStyleValue(G,W,ie,o)}F[W]=ie}),N||a.push(F),c=F,l=b}),o.length)throw function Z9(r){return new ot(3502,hn)}();return a}function PO(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&NO(t,"start",r)));break;case"done":r.onDone(()=>n(t&&NO(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&NO(t,"destroy",r)))}}function NO(r,e,t){const n=t.totalTime,s=_O(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,null==n?r.totalTime:n,!!t.disabled),o=r._data;return null!=o&&(s._data=o),s}function _O(r,e,t,n,i="",s=0,o){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:s,disabled:!!o}}function So(r,e,t){let n;return r instanceof Map?(n=r.get(e),n||r.set(e,n=t)):(n=r[e],n||(n=r[e]=t)),n}function rF(r){const e=r.indexOf(":");return[r.substring(1,e),r.substr(e+1)]}let DO=(r,e)=>!1,iF=(r,e,t)=>[],sF=null;function xO(r){const e=r.parentNode||r.host;return e===sF?null:e}(IO()||"undefined"!=typeof Element)&&(u$()?(sF=(()=>document.documentElement)(),DO=(r,e)=>{for(;e;){if(e===r)return!0;e=xO(e)}return!1}):DO=(r,e)=>r.contains(e),iF=(r,e,t)=>{if(t)return Array.from(r.querySelectorAll(e));const n=r.querySelector(e);return n?[n]:[]});let dd=null,oF=!1;function aF(r){dd||(dd=function d$(){return"undefined"!=typeof document?document.body:null}()||{},oF=!!dd.style&&"WebkitAppearance"in dd.style);let e=!0;return dd.style&&!function h$(r){return"ebkit"==r.substring(1,6)}(r)&&(e=r in dd.style,!e&&oF&&(e="Webkit"+r.charAt(0).toUpperCase()+r.substr(1)in dd.style)),e}const lF=DO,cF=iF;let uF=(()=>{class r{validateStyleProperty(t){return aF(t)}matchesElement(t,n){return!1}containsElement(t,n){return lF(t,n)}getParentElement(t){return xO(t)}query(t,n,i){return cF(t,n,i)}computeStyle(t,n,i){return i||""}animate(t,n,i,s,o,a=[],l){return new zy(i,s)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),LO=(()=>{class r{}return r.NOOP=new uF,r})();const MO="ng-enter",PA="ng-leave",NA="ng-trigger",_A=".ng-trigger",dF="ng-animating",FO=".ng-animating";function fd(r){if("number"==typeof r)return r;const e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:BO(parseFloat(e[1]),e[2])}function BO(r,e){return"s"===e?1e3*r:r}function DA(r,e,t){return r.hasOwnProperty("duration")?r:function p$(r,e,t){let i,s=0,o="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(tF()),{duration:0,delay:0,easing:""};i=BO(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=BO(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else i=r;if(!t){let a=!1,l=e.length;i<0&&(e.push(function _9(){return new ot(3100,hn)}()),a=!0),s<0&&(e.push(function D9(){return new ot(3101,hn)}()),a=!0),a&&e.splice(l,0,tF())}return{duration:i,delay:s,easing:o}}(r,e,t)}function Ng(r,e={}){return Object.keys(r).forEach(t=>{e[t]=r[t]}),e}function Mu(r,e,t={}){if(e)for(let n in r)t[n]=r[n];else Ng(r,t);return t}function gF(r,e,t){return t?e+":"+t+";":""}function pF(r){let e="";for(let t=0;t<r.style.length;t++){const n=r.style.item(t);e+=gF(0,n,r.style.getPropertyValue(n))}for(const t in r.style)r.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=gF(0,E$(t),r.style[t]));r.setAttribute("style",e)}function Rl(r,e,t){r.style&&(Object.keys(e).forEach(n=>{const i=GO(n);t&&!t.hasOwnProperty(n)&&(t[n]=r.style[i]),r.style[i]=e[n]}),IO()&&pF(r))}function gd(r,e){r.style&&(Object.keys(e).forEach(t=>{const n=GO(t);r.style[n]=""}),IO()&&pF(r))}function hE(r){return Array.isArray(r)?1==r.length?r[0]:qL(r):r}const kO=new RegExp("{{\\s*(.+?)\\s*}}","g");function mF(r){let e=[];if("string"==typeof r){let t;for(;t=kO.exec(r);)e.push(t[1]);kO.lastIndex=0}return e}function xA(r,e,t){const n=r.toString(),i=n.replace(kO,(s,o)=>{let a=e[o];return e.hasOwnProperty(o)||(t.push(function L9(r){return new ot(3003,hn)}()),a=""),a.toString()});return i==n?r:i}function LA(r){const e=[];let t=r.next();for(;!t.done;)e.push(t.value),t=r.next();return e}const y$=/-+([a-z0-9])/g;function GO(r){return r.replace(y$,(...e)=>e[1].toUpperCase())}function E$(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Ao(r,e,t){switch(e.type){case 7:return r.visitTrigger(e,t);case 0:return r.visitState(e,t);case 1:return r.visitTransition(e,t);case 2:return r.visitSequence(e,t);case 3:return r.visitGroup(e,t);case 4:return r.visitAnimate(e,t);case 5:return r.visitKeyframes(e,t);case 6:return r.visitStyle(e,t);case 8:return r.visitReference(e,t);case 9:return r.visitAnimateChild(e,t);case 10:return r.visitAnimateRef(e,t);case 11:return r.visitQuery(e,t);case 12:return r.visitStagger(e,t);default:throw function M9(r){return new ot(3004,hn)}()}}function yF(r,e){return window.getComputedStyle(r)[e]}function C$(r,e){const t=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function R$(r,e,t){if(":"==r[0]){const l=function T$(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function J9(r){return new ot(3016,hn)}()),"* => *"}}(r,t);if("function"==typeof l)return void e.push(l);r=l}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function K9(r){return new ot(3015,hn)}()),e;const i=n[1],s=n[2],o=n[3];e.push(EF(i,o));"<"==s[0]&&!("*"==i&&"*"==o)&&e.push(EF(o,i))}(n,t,e)):t.push(r),t}const kA=new Set(["true","1"]),GA=new Set(["false","0"]);function EF(r,e){const t=kA.has(r)||GA.has(r),n=kA.has(e)||GA.has(e);return(i,s)=>{let o="*"==r||r==i,a="*"==e||e==s;return!o&&t&&"boolean"==typeof i&&(o=i?kA.has(r):GA.has(r)),!a&&n&&"boolean"==typeof s&&(a=s?kA.has(e):GA.has(e)),o&&a}}const O$=new RegExp("s*:selfs*,?","g");function VO(r,e,t,n){return new I$(r).build(e,t,n)}class I${constructor(e){this._driver=e}build(e,t,n){const i=new _$(t);this._resetContextStyleTimingState(i);const s=Ao(this,hE(e),i);return i.unsupportedCSSPropertiesFound.size&&i.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function B9(){return new ot(3006,hn)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(d=>{l.name=d,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);n+=l.queryCount,i+=l.depCount,o.push(l)}else t.errors.push(function k9(){return new ot(3007,hn)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=i||{};n.styles.forEach(a=>{if(VA(a)){const l=a;Object.keys(l).forEach(c=>{mF(l[c]).forEach(d=>{o.hasOwnProperty(d)||s.add(d)})})}}),s.size&&(LA(s.values()),t.errors.push(function G9(r,e){return new ot(3008,hn)}()))}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=Ao(this,hE(e.animation),t);return{type:1,matchers:C$(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:pd(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>Ao(this,n,t)),options:pd(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const s=e.steps.map(o=>{t.currentTime=n;const a=Ao(this,o,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:s,options:pd(e.options)}}visitAnimate(e,t){const n=function x$(r,e){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return HO(DA(r,e).duration,0,"");const t=r;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=HO(0,0,"");return s.dynamic=!0,s.strValue=t,s}const i=DA(t,e);return HO(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let i,s=e.styles?e.styles:gg({});if(5==s.type)i=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};n.easing&&(c.easing=n.easing),o=gg(c)}t.currentTime+=n.duration+n.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,i=l}return t.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(o=>{"string"==typeof o?o==wc?n.push(o):t.errors.push(function V9(r){return new ot(3002,hn)}()):n.push(o)}):n.push(e.styles);let i=!1,s=null;return n.forEach(o=>{if(VA(o)){const a=o,l=a.easing;if(l&&(s=l,delete a.easing),!i)for(let c in a)if(a[c].toString().indexOf("{{")>=0){i=!0;break}}}),{type:6,styles:n,easing:s,offset:e.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete o[a],void t.unsupportedCSSPropertiesFound.add(a);const l=t.collectedStyles[t.currentQuerySelector],c=l[a];let d=!0;c&&(s!=i&&s>=c.startTime&&i<=c.endTime&&(t.errors.push(function H9(r,e,t,n,i){return new ot(3010,hn)}()),d=!1),s=c.startTime),d&&(l[a]={startTime:s,endTime:i}),t.options&&function m$(r,e,t){const n=e.params||{},i=mF(r);i.length&&i.forEach(s=>{n.hasOwnProperty(s)||t.push(function x9(r){return new ot(3001,hn)}())})}(o[a],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Y9(){return new ot(3011,hn)}()),n;let s=0;const o=[];let a=!1,l=!1,c=0;const d=e.steps.map(he=>{const de=this._makeStyleAst(he,t);let Te=null!=de.offset?de.offset:function D$(r){if("string"==typeof r)return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(VA(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(VA(r)&&r.hasOwnProperty("offset")){const t=r;e=parseFloat(t.offset),delete t.offset}return e}(de.styles),Ke=0;return null!=Te&&(s++,Ke=de.offset=Te),l=l||Ke<0||Ke>1,a=a||Ke<c,c=Ke,o.push(Ke),de});l&&t.errors.push(function U9(){return new ot(3012,hn)}()),a&&t.errors.push(function W9(){return new ot(3200,hn)}());const b=e.steps.length;let N=0;s>0&&s<b?t.errors.push(function j9(){return new ot(3202,hn)}()):0==s&&(N=1/(b-1));const F=b-1,G=t.currentTime,W=t.currentAnimateTimings,ie=W.duration;return d.forEach((he,de)=>{const Te=N>0?de==F?1:N*de:o[de],Ke=Te*ie;t.currentTime=G+W.delay+Ke,W.duration=Ke,this._validateStyleAst(he,t),he.offset=Te,n.styles.push(he)}),n}visitReference(e,t){return{type:8,animation:Ao(this,hE(e.animation),t),options:pd(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:pd(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:pd(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function P$(r){const e=!!r.split(/\s*,\s*/).find(t=>":self"==t);return e&&(r=r.replace(O$,"")),r=r.replace(/@\*/g,_A).replace(/@\w+/g,t=>_A+"-"+t.substr(1)).replace(/:animating/g,FO),[r,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,So(t.collectedStyles,t.currentQuerySelector,{});const a=Ao(this,hE(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:pd(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function z9(){return new ot(3013,hn)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:DA(e.timings,t.errors,!0);return{type:12,animation:Ao(this,hE(e.animation),t),timings:n,options:null}}}class _${constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function VA(r){return!Array.isArray(r)&&"object"==typeof r}function pd(r){return r?(r=Ng(r)).params&&(r.params=function N$(r){return r?Ng(r):null}(r.params)):r={},r}function HO(r,e,t){return{duration:r,delay:e,easing:t}}function YO(r,e,t,n,i,s,o=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class HA{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const F$=new RegExp(":enter","g"),k$=new RegExp(":leave","g");function UO(r,e,t,n,i,s={},o={},a,l,c=[]){return(new G$).buildKeyframes(r,e,t,n,i,s,o,a,l,c)}class G${buildKeyframes(e,t,n,i,s,o,a,l,c,d=[]){c=c||new HA;const b=new WO(e,t,c,i,s,d,[]);b.options=l,b.currentTimeline.setStyles([o],null,b.errors,l),Ao(this,n,b);const N=b.timelines.filter(F=>F.containsAnimation());if(Object.keys(a).length){let F;for(let G=N.length-1;G>=0;G--){const W=N[G];if(W.element===t){F=W;break}}F&&!F.allowOnlyTimelineStyles()&&F.setStyles([a],null,b.errors,l)}return N.length?N.map(F=>F.buildKeyframes()):[YO(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const i=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,i,i.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?fd(n.duration):null,a=null!=n.delay?fd(n.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Ao(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const s=e.options;if(s&&(s.params||s.delay)&&(i=t.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=YA);const o=fd(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Ao(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?fd(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Ao(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return DA(t.params?xA(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.getCurrentStyleProperties().length&&n.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},s=i.delay?fd(i.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=YA);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,d)=>{t.currentQueryIndex=d;const b=t.createSubContext(e.options,c);s&&b.delayNextStep(s),c===t.element&&(l=b.currentTimeline),Ao(this,e.animation,b),b.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,b.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=n.currentStaggerTime}const d=t.currentTimeline;l&&d.delayNextStep(l);const b=d.currentTime;Ao(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-b+(i.startTime-n.currentTimeline.startTime)}}const YA={};class WO{constructor(e,t,n,i,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=YA,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new UA(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=fd(n.duration)),null!=n.delay&&(i.delay=fd(n.delay));const s=n.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=xA(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,s=new WO(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=YA,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},s=new V$(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(F$,"."+this._enterClassName)).replace(k$,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=n);0!==n&&(c=n<0?c.slice(c.length+n,c.length):c.slice(0,n)),a.push(...c)}return!s&&0==a.length&&o.push(function $9(r){return new ot(3014,hn)}()),a}}class UA{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new UA(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||wc,this._currentKeyframe[t]=wc}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&(this._previousKeyframe.easing=t);const s=i&&i.params||{},o=function H$(r,e){const t={};let n;return r.forEach(i=>{"*"===i?(n=n||Object.keys(e),n.forEach(s=>{t[s]=wc})):Mu(i,!1,t)}),t}(e,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const l=xA(o[a],s,n);this._pendingStyles[a]=l,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:wc),this._updateStyle(a,l)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(n=>{this._currentKeyframe[n]=e[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],i=e._styleSummary[t];(!n||i.time>n.time)&&this._updateStyle(t,i.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,l)=>{const c=Mu(a,!0);Object.keys(c).forEach(d=>{const b=c[d];"!"==b?e.add(d):b==wc&&t.add(d)}),n||(c.offset=l/this.duration),i.push(c)});const s=e.size?LA(e.values()):[],o=t.size?LA(t.values()):[];if(n){const a=i[0],l=Ng(a);a.offset=0,l.offset=1,i=[a,l]}return YO(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class V$ extends UA{constructor(e,t,n,i,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,l=Mu(e[0],!1);l.offset=0,s.push(l);const c=Mu(e[0],!1);c.offset=SF(a),s.push(c);const d=e.length-1;for(let b=1;b<=d;b++){let N=Mu(e[b],!1);N.offset=SF((t+N.offset*n)/o),s.push(N)}n=o,t=0,i="",e=s}return YO(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function SF(r,e=3){const t=Math.pow(10,e-1);return Math.round(r*t)/t}class jO{}class Y$ extends jO{normalizePropertyName(e,t){return GO(e)}normalizeStyleValue(e,t,n,i){let s="";const o=n.toString().trim();if(U$[t]&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function F9(r,e){return new ot(3005,hn)}())}return o+s}}const U$=(()=>function W$(r){const e={};return r.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function AF(r,e,t,n,i,s,o,a,l,c,d,b,N){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:d,totalTime:b,errors:N}}const zO={};class bF{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function j$(r,e,t,n,i){return r.some(s=>s(e,t,n,i))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){const i=this._stateStyles["*"],s=this._stateStyles[e],o=i?i.buildStyles(t,n):{};return s?s.buildStyles(t,n):o}build(e,t,n,i,s,o,a,l,c,d){const b=[],N=this.ast.options&&this.ast.options.params||zO,G=this.buildStyles(n,a&&a.params||zO,b),W=l&&l.params||zO,ie=this.buildStyles(i,W,b),he=new Set,de=new Map,Te=new Map,Ke="void"===i,Xe={params:Object.assign(Object.assign({},N),W)},Et=d?[]:UO(e,t,this.ast.animation,s,o,G,ie,Xe,c,b);let wt=0;if(Et.forEach(Cn=>{wt=Math.max(Cn.duration+Cn.delay,wt)}),b.length)return AF(t,this._triggerName,n,i,Ke,G,ie,[],[],de,Te,wt,b);Et.forEach(Cn=>{const wr=Cn.element,Es=So(de,wr,{});Cn.preStyleProps.forEach(Ya=>Es[Ya]=!0);const Qr=So(Te,wr,{});Cn.postStyleProps.forEach(Ya=>Qr[Ya]=!0),wr!==t&&he.add(wr)});const qn=LA(he.values());return AF(t,this._triggerName,n,i,Ke,G,ie,Et,qn,de,Te,wt)}}class z${constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n={},i=Ng(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!=o&&(i[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let l=o[a];l.length>1&&(l=xA(l,i,t));const c=this.normalizer.normalizePropertyName(a,t);l=this.normalizer.normalizeStyleValue(a,c,l,t),n[c]=l})}}),n}}class K${constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states={},t.states.forEach(i=>{this.states[i.name]=new z$(i.style,i.options&&i.options.params||{},n)}),CF(this.states,"true","1"),CF(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new bF(e,i,this.states))}),this.fallbackTransition=function J$(r,e,t){return new bF(r,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(o=>o.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function CF(r,e,t){r.hasOwnProperty(e)?r.hasOwnProperty(t)||(r[t]=r[e]):r.hasOwnProperty(t)&&(r[e]=r[t])}const q$=new HA;class Q${constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],s=VO(this._driver,t,n,[]);if(n.length)throw function e$(r){return new ot(3503,hn)}();this._animations[e]=s}_buildPlayer(e,t,n){const i=e.element,s=nF(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],s=this._animations[e];let o;const a=new Map;if(s?(o=UO(this._driver,t,s,MO,PA,{},{},n,q$,i),o.forEach(d=>{const b=So(a,d.element,{});d.postStyleProps.forEach(N=>b[N]=null)})):(i.push(function t$(){return new ot(3300,hn)}()),o=[]),i.length)throw function n$(r){return new ot(3504,hn)}();a.forEach((d,b)=>{Object.keys(d).forEach(N=>{d[N]=this._driver.computeStyle(b,N,wc)})});const c=Lu(o.map(d=>{const b=a.get(d.element);return this._buildPlayer(d,{},b)}));return this._playersById[e]=c,c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw function r$(r){return new ot(3301,hn)}();return t}listen(e,t,n,i){const s=_O(t,"","","");return PO(this._getPlayer(e),n,s,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const RF="ng-animate-queued",$O="ng-animate-disabled",nK=[],TF={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},rK={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Xo="__ng_removed";class KO{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function aK(r){return null!=r?r:null}(n?e.value:e),n){const s=Ng(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(i=>{null==n[i]&&(n[i]=t[i])})}}}const dE="void",JO=new KO(dE);class iK{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Zo(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.hasOwnProperty(t))throw function i$(r,e){return new ot(3302,hn)}();if(null==n||0==n.length)throw function s$(r){return new ot(3303,hn)}();if(!function lK(r){return"start"==r||"done"==r}(n))throw function o$(r,e){return new ot(3400,hn)}();const s=So(this._elementListeners,e,[]),o={name:t,phase:n,callback:i};s.push(o);const a=So(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(Zo(e,NA),Zo(e,NA+"-"+t),a[t]=JO),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw function a$(r){return new ot(3401,hn)}();return t}trigger(e,t,n,i=!0){const s=this._getTrigger(t),o=new qO(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Zo(e,NA),Zo(e,NA+"-"+t),this._engine.statesByElement.set(e,a={}));let l=a[t];const c=new KO(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a[t]=c,l||(l=JO),c.value!==dE&&l.value===c.value){if(!function hK(r,e){const t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){const s=t[i];if(!e.hasOwnProperty(s)||r[s]!==e[s])return!1}return!0}(l.params,c.params)){const W=[],ie=s.matchStyles(l.value,l.params,W),he=s.matchStyles(c.value,c.params,W);W.length?this._engine.reportError(W):this._engine.afterFlush(()=>{gd(e,ie),Rl(e,he)})}return}const N=So(this._engine.playersByElement,e,[]);N.forEach(W=>{W.namespaceId==this.id&&W.triggerName==t&&W.queued&&W.destroy()});let F=s.matchTransition(l.value,c.value,e,c.params),G=!1;if(!F){if(!i)return;F=s.fallbackTransition,G=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:F,fromState:l,toState:c,player:o,isFallbackTransition:G}),G||(Zo(e,RF),o.onStart(()=>{_g(e,RF)})),o.onDone(()=>{let W=this.players.indexOf(o);W>=0&&this.players.splice(W,1);const ie=this._engine.playersByElement.get(e);if(ie){let he=ie.indexOf(o);he>=0&&ie.splice(he,1)}}),this.players.push(o),N.push(o),o}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,_A,!0);n.forEach(i=>{if(i[Xo])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(l=>{if(o.set(l,s[l].value),this._triggers[l]){const c=this.trigger(e,l,dE,i);c&&a.push(c)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&Lu(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const l=this._triggers[o].fallbackTransition,c=n[o]||JO,d=new KO(dE),b=new qO(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:d,player:b,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Xo];(!s||s===TF)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Zo(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const l=_O(s,n.triggerName,n.fromState.value,n.toState.value);l._data=e,PO(n.player,a.phase,l,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{const s=n.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class sK{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new iK(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,i=this.namespacesByHostElement,s=n.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(t);for(;a;){const l=i.get(a);if(l){const c=n.indexOf(l);n.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}}else for(let a=s;a>=0;a--)if(this.driver.containsElement(n[a].hostElement,t)){n.splice(a+1,0,e),o=!0;break}o||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const i=Object.keys(n);for(let s=0;s<i.length;s++){const o=n[i[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&t.add(a)}}}return t}trigger(e,t,n,i){if(WA(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!WA(t))return;const s=t[Xo];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Zo(e,$O)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),_g(e,$O))}removeNode(e,t,n,i){if(WA(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i),n){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,i)}}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,n,i,s){this.collectedLeaveElements.push(t),t[Xo]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,i,s){return WA(t)?this._fetchNamespace(e).listen(t,n,i,s):()=>{}}_buildInstruction(e,t,n,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,_A,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,FO,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Lu(this.players).onDone(()=>e());e()})}processLeaveNode(e){var t;const n=e[Xo];if(n&&n.setForRemoval){if(e[Xo]=TF,n.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(n.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}(null===(t=e.classList)||void 0===t?void 0:t.contains($O))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Zo(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?Lu(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw function l$(r){return new ot(3402,hn)}()}_flushAnimations(e,t){const n=new HA,i=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,d=new Set;this.disabledNodes.forEach(ct=>{d.add(ct);const vt=this.driver.query(ct,".ng-animate-queued",!0);for(let _t=0;_t<vt.length;_t++)d.add(vt[_t])});const b=this.bodyNode,N=Array.from(this.statesByElement.keys()),F=PF(N,this.collectedEnterElements),G=new Map;let W=0;F.forEach((ct,vt)=>{const _t=MO+W++;G.set(vt,_t),ct.forEach(Sn=>Zo(Sn,_t))});const ie=[],he=new Set,de=new Set;for(let ct=0;ct<this.collectedLeaveElements.length;ct++){const vt=this.collectedLeaveElements[ct],_t=vt[Xo];_t&&_t.setForRemoval&&(ie.push(vt),he.add(vt),_t.hasAnimation?this.driver.query(vt,".ng-star-inserted",!0).forEach(Sn=>he.add(Sn)):de.add(vt))}const Te=new Map,Ke=PF(N,Array.from(he));Ke.forEach((ct,vt)=>{const _t=PA+W++;Te.set(vt,_t),ct.forEach(Sn=>Zo(Sn,_t))}),e.push(()=>{F.forEach((ct,vt)=>{const _t=G.get(vt);ct.forEach(Sn=>_g(Sn,_t))}),Ke.forEach((ct,vt)=>{const _t=Te.get(vt);ct.forEach(Sn=>_g(Sn,_t))}),ie.forEach(ct=>{this.processLeaveNode(ct)})});const Xe=[],Et=[];for(let ct=this._namespaceList.length-1;ct>=0;ct--)this._namespaceList[ct].drainQueuedTransitions(t).forEach(_t=>{const Sn=_t.player,wi=_t.element;if(Xe.push(Sn),this.collectedEnterElements.length){const ws=wi[Xo];if(ws&&ws.setForMove){if(ws.previousTriggersValues&&ws.previousTriggersValues.has(_t.triggerName)){const Ed=ws.previousTriggersValues.get(_t.triggerName),Gu=this.statesByElement.get(_t.element);Gu&&Gu[_t.triggerName]&&(Gu[_t.triggerName].value=Ed)}return void Sn.destroy()}}const Tl=!b||!this.driver.containsElement(b,wi),bo=Te.get(wi),ku=G.get(wi),dr=this._buildInstruction(_t,n,ku,bo,Tl);if(dr.errors&&dr.errors.length)return void Et.push(dr);if(Tl)return Sn.onStart(()=>gd(wi,dr.fromStyles)),Sn.onDestroy(()=>Rl(wi,dr.toStyles)),void i.push(Sn);if(_t.isFallbackTransition)return Sn.onStart(()=>gd(wi,dr.fromStyles)),Sn.onDestroy(()=>Rl(wi,dr.toStyles)),void i.push(Sn);const pB=[];dr.timelines.forEach(ws=>{ws.stretchStartingKeyframe=!0,this.disabledNodes.has(ws.element)||pB.push(ws)}),dr.timelines=pB,n.append(wi,dr.timelines),o.push({instruction:dr,player:Sn,element:wi}),dr.queriedElements.forEach(ws=>So(a,ws,[]).push(Sn)),dr.preStyleProps.forEach((ws,Ed)=>{const Gu=Object.keys(ws);if(Gu.length){let wd=l.get(Ed);wd||l.set(Ed,wd=new Set),Gu.forEach(oI=>wd.add(oI))}}),dr.postStyleProps.forEach((ws,Ed)=>{const Gu=Object.keys(ws);let wd=c.get(Ed);wd||c.set(Ed,wd=new Set),Gu.forEach(oI=>wd.add(oI))})});if(Et.length){const ct=[];Et.forEach(vt=>{ct.push(function c$(r,e){return new ot(3505,hn)}())}),Xe.forEach(vt=>vt.destroy()),this.reportError(ct)}const wt=new Map,qn=new Map;o.forEach(ct=>{const vt=ct.element;n.has(vt)&&(qn.set(vt,vt),this._beforeAnimationBuild(ct.player.namespaceId,ct.instruction,wt))}),i.forEach(ct=>{const vt=ct.element;this._getPreviousPlayers(vt,!1,ct.namespaceId,ct.triggerName,null).forEach(Sn=>{So(wt,vt,[]).push(Sn),Sn.destroy()})});const Cn=ie.filter(ct=>_F(ct,l,c)),wr=new Map;IF(wr,this.driver,de,c,wc).forEach(ct=>{_F(ct,l,c)&&Cn.push(ct)});const Qr=new Map;F.forEach((ct,vt)=>{IF(Qr,this.driver,new Set(ct),l,"!")}),Cn.forEach(ct=>{const vt=wr.get(ct),_t=Qr.get(ct);wr.set(ct,Object.assign(Object.assign({},vt),_t))});const Ya=[],xg=[],Lg={};o.forEach(ct=>{const{element:vt,player:_t,instruction:Sn}=ct;if(n.has(vt)){if(d.has(vt))return _t.onDestroy(()=>Rl(vt,Sn.toStyles)),_t.disabled=!0,_t.overrideTotalTime(Sn.totalTime),void i.push(_t);let wi=Lg;if(qn.size>1){let bo=vt;const ku=[];for(;bo=bo.parentNode;){const dr=qn.get(bo);if(dr){wi=dr;break}ku.push(bo)}ku.forEach(dr=>qn.set(dr,wi))}const Tl=this._buildAnimation(_t.namespaceId,Sn,wt,s,Qr,wr);if(_t.setRealPlayer(Tl),wi===Lg)Ya.push(_t);else{const bo=this.playersByElement.get(wi);bo&&bo.length&&(_t.parentPlayer=Lu(bo)),i.push(_t)}}else gd(vt,Sn.fromStyles),_t.onDestroy(()=>Rl(vt,Sn.toStyles)),xg.push(_t),d.has(vt)&&i.push(_t)}),xg.forEach(ct=>{const vt=s.get(ct.element);if(vt&&vt.length){const _t=Lu(vt);ct.setRealPlayer(_t)}}),i.forEach(ct=>{ct.parentPlayer?ct.syncPlayerEvents(ct.parentPlayer):ct.destroy()});for(let ct=0;ct<ie.length;ct++){const vt=ie[ct],_t=vt[Xo];if(_g(vt,PA),_t&&_t.hasAnimation)continue;let Sn=[];if(a.size){let Tl=a.get(vt);Tl&&Tl.length&&Sn.push(...Tl);let bo=this.driver.query(vt,FO,!0);for(let ku=0;ku<bo.length;ku++){let dr=a.get(bo[ku]);dr&&dr.length&&Sn.push(...dr)}}const wi=Sn.filter(Tl=>!Tl.destroyed);wi.length?cK(this,vt,wi):this.processLeaveNode(vt)}return ie.length=0,Ya.forEach(ct=>{this.players.push(ct),ct.onDone(()=>{ct.destroy();const vt=this.players.indexOf(ct);this.players.splice(vt,1)}),ct.play()}),Ya}elementContainsData(e,t){let n=!1;const i=t[Xo];return i&&i.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==dE;a.forEach(c=>{c.queued||!l&&c.triggerName!=i||o.push(c)})}}return(n||i)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,d=c!==s,b=So(n,c,[]);this._getPreviousPlayers(c,d,o,a,t.toState).forEach(F=>{const G=F.getRealPlayer();G.beforeDestroy&&G.beforeDestroy(),F.destroy(),b.push(F)})}gd(s,t.fromStyles)}_buildAnimation(e,t,n,i,s,o){const a=t.triggerName,l=t.element,c=[],d=new Set,b=new Set,N=t.timelines.map(G=>{const W=G.element;d.add(W);const ie=W[Xo];if(ie&&ie.removedBeforeQueried)return new zy(G.duration,G.delay);const he=W!==l,de=function uK(r){const e=[];return NF(r,e),e}((n.get(W)||nK).map(wt=>wt.getRealPlayer())).filter(wt=>!!wt.element&&wt.element===W),Te=s.get(W),Ke=o.get(W),Xe=nF(0,this._normalizer,0,G.keyframes,Te,Ke),Et=this._buildPlayer(G,Xe,de);if(G.subTimeline&&i&&b.add(W),he){const wt=new qO(e,a,W);wt.setRealPlayer(Et),c.push(wt)}return Et});c.forEach(G=>{So(this.playersByQueriedElement,G.element,[]).push(G),G.onDone(()=>function oK(r,e,t){let n;if(r instanceof Map){if(n=r.get(e),n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&r.delete(e)}}else if(n=r[e],n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&delete r[e]}return n}(this.playersByQueriedElement,G.element,G))}),d.forEach(G=>Zo(G,dF));const F=Lu(N);return F.onDestroy(()=>{d.forEach(G=>_g(G,dF)),Rl(l,t.toStyles)}),b.forEach(G=>{So(i,G,[]).push(F)}),F}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new zy(e.duration,e.delay)}}class qO{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new zy,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>PO(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){So(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function WA(r){return r&&1===r.nodeType}function OF(r,e){const t=r.style.display;return r.style.display=null!=e?e:"none",t}function IF(r,e,t,n,i){const s=[];t.forEach(l=>s.push(OF(l)));const o=[];n.forEach((l,c)=>{const d={};l.forEach(b=>{const N=d[b]=e.computeStyle(c,b,i);(!N||0==N.length)&&(c[Xo]=rK,o.push(c))}),r.set(c,d)});let a=0;return t.forEach(l=>OF(l,s[a++])),o}function PF(r,e){const t=new Map;if(r.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:i.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function Zo(r,e){var t;null===(t=r.classList)||void 0===t||t.add(e)}function _g(r,e){var t;null===(t=r.classList)||void 0===t||t.remove(e)}function cK(r,e,t){Lu(t).onDone(()=>r.processLeaveNode(e))}function NF(r,e){for(let t=0;t<r.length;t++){const n=r[t];n instanceof ZL?NF(n.players,e):e.push(n)}}function _F(r,e,t){const n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(s=>i.add(s)):e.set(r,n),t.delete(r),!0}class jA{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new sK(e,t,n),this._timelineEngine=new Q$(e,t,n),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,t,n,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const l=[],d=VO(this._driver,s,l,[]);if(l.length)throw function X9(r,e){return new ot(3404,hn)}();a=function $$(r,e,t){return new K$(r,e,t)}(i,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n,i){this._transitionEngine.removeNode(e,t,i||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[s,o]=rF(n);this._timelineEngine.command(s,t,o,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,s){if("@"==n.charAt(0)){const[o,a]=rF(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let fK=(()=>{class r{constructor(t,n,i){this._element=t,this._startStyles=n,this._endStyles=i,this._state=0;let s=r.initialStylesByElement.get(t);s||r.initialStylesByElement.set(t,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Rl(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Rl(this._element,this._initialStyles),this._endStyles&&(Rl(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(r.initialStylesByElement.delete(this._element),this._startStyles&&(gd(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(gd(this._element,this._endStyles),this._endStyles=null),Rl(this._element,this._initialStyles),this._state=3)}}return r.initialStylesByElement=new WeakMap,r})();function QO(r){let e=null;const t=Object.keys(r);for(let n=0;n<t.length;n++){const i=t[n];gK(i)&&(e=e||{},e[i]=r[i])}return e}function gK(r){return"display"===r||"position"===r}class DF{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const t=this._finalKeyframe;Object.keys(t).forEach(n=>{"offset"!=n&&(e[n]=this._finished?t[n]:yF(this.element,n))})}this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class pK{validateStyleProperty(e){return aF(e)}matchesElement(e,t){return!1}containsElement(e,t){return lF(e,t)}getParentElement(e){return xO(e)}query(e,t,n){return cF(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,i,s,o=[]){const l={duration:n,delay:i,fill:0==i?"both":"forwards"};s&&(l.easing=s);const c={},d=o.filter(N=>N instanceof DF);(function w$(r,e){return 0===r||0===e})(n,i)&&d.forEach(N=>{let F=N.currentSnapshot;Object.keys(F).forEach(G=>c[G]=F[G])}),t=function v$(r,e,t){const n=Object.keys(t);if(n.length&&e.length){let s=e[0],o=[];if(n.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=t[a]}),o.length)for(var i=1;i<e.length;i++){let a=e[i];o.forEach(function(l){a[l]=yF(r,l)})}}return e}(e,t=t.map(N=>Mu(N,!1)),c);const b=function dK(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=QO(e[0]),e.length>1&&(n=QO(e[e.length-1]))):e&&(t=QO(e)),t||n?new fK(r,t,n):null}(e,t);return new DF(e,t,l,b)}}let mK=(()=>{class r extends KL{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:oe.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(t)?qL(t):t;return xF(this._renderer,null,n,"register",[i]),new yK(n,this._renderer)}}return r.\u0275fac=function(t){return new(t||r)($e(Qm),$e(Ln))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();class yK extends class x5{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new EK(this._id,e,t||{},this._renderer)}}class EK{constructor(e,t,n,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return xF(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function xF(r,e,t,n,i){return r.setProperty(e,`@@${t}:${n}`,i)}const LF="@.disabled";let wK=(()=>{class r{constructor(t,n,i){this.delegate=t,this.engine=n,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,n){const s=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let d=this._rendererCache.get(s);return d||(d=new MF("",s,this.engine),this._rendererCache.set(s,d)),d}const o=n.id,a=n.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(o,a,t,d.name,d)};return n.data.animation.forEach(l),new vK(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,i){t>=0&&t<this._microtaskId?this._zone.run(()=>n(i)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return r.\u0275fac=function(t){return new(t||r)($e(Qm),$e(jA),$e(vn))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();class MF{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?i=>t.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==LF?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class vK extends MF{constructor(e,t,n,i){super(t,n,i),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==LF?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function SK(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(e);let s=t.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function AK(r){const e=r.indexOf(".");return[r.substring(0,e),r.substr(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let bK=(()=>{class r extends jA{constructor(t,n,i){super(t.body,n,i)}ngOnDestroy(){this.flush()}}return r.\u0275fac=function(t){return new(t||r)($e(Ln),$e(LO),$e(jO))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const fE=new pt("AnimationModuleType"),FF=[{provide:KL,useClass:mK},{provide:jO,useFactory:function CK(){return new Y$}},{provide:jA,useClass:bK},{provide:Qm,useFactory:function RK(r,e,t){return new wK(r,e,t)},deps:[cS,jA,vn]}],BF=[{provide:LO,useFactory:()=>new pK},{provide:fE,useValue:"BrowserAnimations"},...FF],TK=[{provide:LO,useClass:uF},{provide:fE,useValue:"NoopAnimations"},...FF];let OK=(()=>{class r{static withConfig(t){return{ngModule:r,providers:t.disableAnimations?TK:BF}}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({providers:BF,imports:[ED]}),r})();const kF=new Vh("13.0.2"),PK=new pt("mat-sanity-checks",{providedIn:"root",factory:function IK(){return!0}});let ea=(()=>{class r{constructor(t,n,i){this._hasDoneGlobalChecks=!1,this._document=i,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=n,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!(!function fV(){return __=!0,N_}()||function k7(){return"undefined"!=typeof __karma__&&!!__karma__||"undefined"!=typeof jasmine&&!!jasmine||"undefined"!=typeof jest&&!!jest||"undefined"!=typeof Mocha&&!!Mocha}())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const n=getComputedStyle(t);n&&"none"!==n.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),t.remove()}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&kF.full!==H1.full&&console.warn("The Angular Material version ("+kF.full+") does not match the Angular CDK version ("+H1.full+").\nPlease ensure the versions of these two packages exactly match.")}}return r.\u0275fac=function(t){return new(t||r)($e(N9),$e(PK,8),$e(Ln))},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[G1],G1]}),r})();function NK(r){return class extends r{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=Ha(e)}}}function XO(r,e){return class extends r{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}function _K(r){return class extends r{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Ha(e)}}}class xK{constructor(e,t,n){this._renderer=e,this.element=t,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const GF={enterDuration:225,exitDuration:150},ZO=bO({passive:!0}),VF=["mousedown","touchstart"],HF=["mouseup","mouseleave","touchend","touchcancel"];class MK{constructor(e,t,n,i){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=Ig(n))}fadeInRipple(e,t,n={}){const i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},GF),n.animation);n.centered&&(e=i.left+i.width/2,t=i.top+i.height/2);const o=n.radius||function BK(r,e,t){const n=Math.max(Math.abs(r-t.left),Math.abs(r-t.right)),i=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+i*i)}(e,t,i),a=e-i.left,l=t-i.top,c=s.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=a-o+"px",d.style.top=l-o+"px",d.style.height=2*o+"px",d.style.width=2*o+"px",null!=n.color&&(d.style.backgroundColor=n.color),d.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(d),function FK(r){window.getComputedStyle(r).getPropertyValue("opacity")}(d),d.style.transform="scale(1)";const b=new xK(this,d,n);return b.state=0,this._activeRipples.add(b),n.persistent||(this._mostRecentTransientRipple=b),this._runTimeoutOutsideZone(()=>{const N=b===this._mostRecentTransientRipple;b.state=1,!n.persistent&&(!N||!this._isPointerDown)&&b.fadeOut()},c),b}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const n=e.element,i=Object.assign(Object.assign({},GF),e.config.animation);n.style.transitionDuration=`${i.exitDuration}ms`,n.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,n.remove()},i.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Ig(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(VF))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(HF),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=J1(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!q1(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,ZO)})})}_removeTriggerEvents(){this._triggerElement&&(VF.forEach(e=>{this._triggerElement.removeEventListener(e,this,ZO)}),this._pointerUpEventsRegistered&&HF.forEach(e=>{this._triggerElement.removeEventListener(e,this,ZO)}))}}const kK=new pt("mat-ripple-global-options");let YF=(()=>{class r{constructor(t,n,i,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new MK(this,n,t,i)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,i){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,n,Object.assign(Object.assign({},this.rippleConfig),i)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return r.\u0275fac=function(t){return new(t||r)(Ue(Dr),Ue(vn),Ue(Cl),Ue(kK,8),Ue(fE,8))},r.\u0275dir=Mn({type:r,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,n){2&t&&ci("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),r})(),GK=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[ea,_1],ea]}),r})();function eI(r){return _e(()=>r)}const $A=["*"];function VK(r,e){if(1&r){const t=hu();Lt(0,"div",2),zi("click",function(){return Ts(t),tn()._onBackdropClicked()}),$t()}2&r&&ci("mat-drawer-shown",tn()._isShowingBackdrop())}function HK(r,e){1&r&&(Lt(0,"mat-drawer-content"),$i(1,2),$t())}const YK=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],UK=["mat-drawer","mat-drawer-content","*"];function WK(r,e){if(1&r){const t=hu();Lt(0,"div",2),zi("click",function(){return Ts(t),tn()._onBackdropClicked()}),$t()}2&r&&ci("mat-drawer-shown",tn()._isShowingBackdrop())}function jK(r,e){1&r&&(Lt(0,"mat-sidenav-content",3),$i(1,2),$t())}const zK=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],$K=["mat-sidenav","mat-sidenav-content","*"],UF={transformDrawer:JL("transform",[QL("open, open-instant",gg({transform:"none",visibility:"visible"})),QL("void",gg({"box-shadow":"none",visibility:"hidden"})),jT("void => open-instant",WT("0ms")),jT("void <=> open, open-instant => void",WT("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},JK=new pt("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function qK(){return!1}}),tI=new pt("MAT_DRAWER_CONTAINER");let KA=(()=>{class r extends TA{constructor(t,n,i,s,o){super(i,s,o),this._changeDetectorRef=t,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return r.\u0275fac=function(t){return new(t||r)(Ue(Hh),Ue(ia(()=>jF)),Ue(Dr),Ue(TO),Ue(vn))},r.\u0275cmp=Zn({type:r,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,n){2&t&&du("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[rc],ngContentSelectors:$A,decls:1,vars:0,template:function(t,n){1&t&&(Ta(),$i(0))},encapsulation:2,changeDetection:0}),r})(),WF=(()=>{class r{constructor(t,n,i,s,o,a,l,c){this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=i,this._platform=s,this._ngZone=o,this._interactivityChecker=a,this._doc=l,this._container=c,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new ke,this._animationEnd=new ke,this._animationState="void",this.openedChange=new Gn(!0),this._openedStream=this.openedChange.pipe(Ki(d=>d),_e(()=>{})),this.openedStart=this._animationStarted.pipe(Ki(d=>d.fromState!==d.toState&&0===d.toState.indexOf("open")),eI(void 0)),this._closedStream=this.openedChange.pipe(Ki(d=>!d),_e(()=>{})),this.closedStart=this._animationStarted.pipe(Ki(d=>d.fromState!==d.toState&&"void"===d.toState),eI(void 0)),this._destroyed=new ke,this.onPositionChanged=new Gn,this._modeChanged=new ke,this.openedChange.subscribe(d=>{d?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{vg(this._elementRef.nativeElement,"keydown").pipe(Ki(d=>27===d.keyCode&&!this.disableClose&&!function c9(r,...e){return e.length?e.some(t=>r[t]):r.altKey||r.shiftKey||r.ctrlKey||r.metaKey}(d)),vo(this._destroyed)).subscribe(d=>this._ngZone.run(()=>{this.close(),d.stopPropagation(),d.preventDefault()}))}),this._animationEnd.pipe(U1((d,b)=>d.fromState===b.fromState&&d.toState===b.toState)).subscribe(d=>{const{fromState:b,toState:N}=d;(0===N.indexOf("open")&&"void"===b||"void"===N&&0===b.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!=this._position&&(this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=Ha(t)}get autoFocus(){const t=this._autoFocus;return null==t?"side"===this.mode?"dialog":"first-tabbable":t}set autoFocus(t){("true"===t||"false"===t)&&(t=Ha(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(Ha(t))}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{t.addEventListener("blur",()=>t.removeAttribute("tabindex")),t.addEventListener("mousedown",()=>t.removeAttribute("tabindex"))})),t.focus(n)}_focusByCssSelector(t,n){let i=this._elementRef.nativeElement.querySelector(t);i&&this._forceFocus(i,n)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){var t;const n=null===(t=this._doc)||void 0===t?void 0:t.activeElement;return!!n&&this._elementRef.nativeElement.contains(n)}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,n){t&&n&&(this._openedVia=n);const i=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),i}_setOpen(t,n,i){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(i)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(Ai(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}}return r.\u0275fac=function(t){return new(t||r)(Ue(Dr),Ue(C9),Ue(X1),Ue(Cl),Ue(vn),Ue(z1),Ue(Ln,8),Ue(tI,8))},r.\u0275cmp=Zn({type:r,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,n){1&t&&ER("@transform.start",function(s){return n._animationStarted.next(s)})("@transform.done",function(s){return n._animationEnd.next(s)}),2&t&&(Xn("align",null),AR("@transform",n._animationState),ci("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:$A,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(t,n){1&t&&(Ta(),Lt(0,"div",0),$i(1),$t())},directives:[TA],encapsulation:2,data:{animation:[UF.transformDrawer]},changeDetection:0}),r})(),jF=(()=>{class r{constructor(t,n,i,s,o,a=!1,l){this._dir=t,this._element=n,this._ngZone=i,this._changeDetectorRef=s,this._animationMode=l,this._drawers=new Vv,this.backdropClick=new Gn,this._destroyed=new ke,this._doCheckSubject=new ke,this._contentMargins={left:null,right:null},this._contentMarginChanges=new ke,t&&t.change.pipe(vo(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(vo(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=a}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=Ha(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:Ha(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(hS(this._allDrawers),vo(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(hS(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(yO(10),vo(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const i=this._left._getWidth();t+=i,n-=i}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const i=this._right._getWidth();n+=i,t-=i}t=t||null,n=n||null,(t!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:t,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(Ki(n=>n.fromState!==n.toState),vo(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(vo(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){!t||t.onPositionChanged.pipe(vo(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Ai(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(vo(Id(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const n=this._element.nativeElement.classList,i="mat-drawer-container-has-open";t?n.add(i):n.remove(i)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return r.\u0275fac=function(t){return new(t||r)(Ue(k1,8),Ue(Dr),Ue(vn),Ue(Hh),Ue(n9),Ue(JK),Ue(fE,8))},r.\u0275cmp=Zn({type:r,selectors:[["mat-drawer-container"]],contentQueries:function(t,n,i){if(1&t&&(io(i,KA,5),io(i,WF,5)),2&t){let s;ui(s=hi())&&(n._content=s.first),ui(s=hi())&&(n._allDrawers=s)}},viewQuery:function(t,n){if(1&t&&Vf(KA,5),2&t){let i;ui(i=hi())&&(n._userContent=i.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,n){2&t&&ci("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[PR([{provide:tI,useExisting:r}])],ngContentSelectors:UK,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(Ta(YK),xn(0,VK,1,2,"div",0),$i(1),$i(2,1),xn(3,HK,2,0,"mat-drawer-content",1)),2&t&&(Wt("ngIf",n.hasBackdrop),Qt(3),Wt("ngIf",!n._content))},directives:[KA,Wh],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),r})(),nI=(()=>{class r extends KA{constructor(t,n,i,s,o){super(t,n,i,s,o)}}return r.\u0275fac=function(t){return new(t||r)(Ue(Hh),Ue(ia(()=>zF)),Ue(Dr),Ue(TO),Ue(vn))},r.\u0275cmp=Zn({type:r,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,n){2&t&&du("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[rc],ngContentSelectors:$A,decls:1,vars:0,template:function(t,n){1&t&&(Ta(),$i(0))},encapsulation:2,changeDetection:0}),r})(),rI=(()=>{class r extends WF{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=Ha(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=x1(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=x1(t)}}return r.\u0275fac=function(){let e;return function(n){return(e||(e=bp(r)))(n||r)}}(),r.\u0275cmp=Zn({type:r,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,n){2&t&&(Xn("align",null),du("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),ci("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[rc],ngContentSelectors:$A,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(t,n){1&t&&(Ta(),Lt(0,"div",0),$i(1),$t())},directives:[TA],encapsulation:2,data:{animation:[UF.transformDrawer]},changeDetection:0}),r})(),zF=(()=>{class r extends jF{}return r.\u0275fac=function(){let e;return function(n){return(e||(e=bp(r)))(n||r)}}(),r.\u0275cmp=Zn({type:r,selectors:[["mat-sidenav-container"]],contentQueries:function(t,n,i){if(1&t&&(io(i,nI,5),io(i,rI,5)),2&t){let s;ui(s=hi())&&(n._content=s.first),ui(s=hi())&&(n._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,n){2&t&&ci("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[PR([{provide:tI,useExisting:r}]),rc],ngContentSelectors:$K,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],["cdkScrollable","",4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"],["cdkScrollable",""]],template:function(t,n){1&t&&(Ta(zK),xn(0,WK,1,2,"div",0),$i(1),$i(2,1),xn(3,jK,2,0,"mat-sidenav-content",1)),2&t&&(Wt("ngIf",n.hasBackdrop),Qt(3),Wt("ngIf",!n._content))},directives:[nI,Wh,TA],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),r})(),QK=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[iS,ea,_1,V1],V1,ea]}),r})();function $F(r,e){return e?t=>cy(e.pipe(Ai(1),function XK(){return Se((r,e)=>{r.subscribe(new Ie(e,x))})}()),t.pipe($F(r))):Bn((t,n)=>r(t,n).pipe(Ai(1),eI(t)))}const eJ=Zr,nJ=Symbol("__destroy"),KF=Symbol("__decoratorApplied");function JF(r){return"string"==typeof r?Symbol(`__destroy__${r}`):nJ}function qF(r,e){r[e]||(r[e]=new ke)}function QF(r,e){r[e]&&(r[e].next(),r[e].complete(),r[e]=null)}function XF(r){r instanceof m&&r.unsubscribe()}function ZF(r,e){return function(){var t;if(r&&r.call(this),QF(this,JF()),e.arrayName&&function iJ(r){Array.isArray(r)&&r.forEach(XF)}(this[e.arrayName]),e.checkProperties)for(const n in this)(null===(t=e.blackList)||void 0===t?void 0:t.includes(n))||XF(this[n])}}function eB(r,e){return t=>{const n=JF(e);return"string"==typeof e?function lJ(r,e,t){const n=r[e];qF(r,t),r[e]=function(){n.apply(this,arguments),QF(this,t),r[e]=n}}(r,e,n):qF(r,n),t.pipe(vo(r[n]))}}const tB=new Set;let Dg,cJ=(()=>{class r{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):hJ}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function uJ(r){if(!tB.has(r))try{Dg||(Dg=document.createElement("style"),Dg.setAttribute("type","text/css"),document.head.appendChild(Dg)),Dg.sheet&&(Dg.sheet.insertRule(`@media ${r} {body{ }}`,0),tB.add(r))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return r.\u0275fac=function(t){return new(t||r)($e(Cl))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function hJ(r){return{matches:"all"===r||""===r,media:r,addListener:()=>{},removeListener:()=>{}}}let dJ=(()=>{class r{constructor(t,n){this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new ke}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return nB(L1(t)).some(i=>this._registerQuery(i).mql.matches)}observe(t){let s=CD(nB(L1(t)).map(o=>this._registerQuery(o).observable));return s=cy(s.pipe(Ai(1)),s.pipe(Y1(1),yO(0))),s.pipe(_e(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const n=this._mediaMatcher.matchMedia(t),s={observable:new ee(o=>{const a=l=>this._zone.run(()=>o.next(l));return n.addListener(a),()=>{n.removeListener(a)}}).pipe(hS(n),_e(({matches:o})=>({query:t,matches:o})),vo(this._destroySubject)),mql:n};return this._queries.set(t,s),s}}return r.\u0275fac=function(t){return new(t||r)($e(cJ),$e(vn))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function nB(r){return r.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}const fJ=["*",[["mat-toolbar-row"]]],gJ=["*","mat-toolbar-row"],pJ=XO(class{constructor(r){this._elementRef=r}});let mJ=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=Mn({type:r,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),r})(),yJ=(()=>{class r extends pJ{constructor(t,n,i){super(t),this._platform=n,this._document=i}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return r.\u0275fac=function(t){return new(t||r)(Ue(Dr),Ue(Cl),Ue(Ln))},r.\u0275cmp=Zn({type:r,selectors:[["mat-toolbar"]],contentQueries:function(t,n,i){if(1&t&&io(i,mJ,5),2&t){let s;ui(s=hi())&&(n._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,n){2&t&&ci("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",0===n._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[rc],ngContentSelectors:gJ,decls:2,vars:0,template:function(t,n){1&t&&(Ta(fJ),$i(0),$i(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}\n"],encapsulation:2,changeDetection:0}),r})(),EJ=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[ea],ea]}),r})();const wJ=["mat-button",""],vJ=["*"],AJ=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],bJ=XO(NK(_K(class{constructor(r){this._elementRef=r}})));let CJ=(()=>{class r extends bJ{constructor(t,n,i){super(t),this._focusMonitor=n,this._animationMode=i,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of AJ)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);t.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,n){t?this._focusMonitor.focusVia(this._getHostElement(),t,n):this._getHostElement().focus(n)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(n=>this._getHostElement().hasAttribute(n))}}return r.\u0275fac=function(t){return new(t||r)(Ue(Dr),Ue(X1),Ue(fE,8))},r.\u0275cmp=Zn({type:r,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,n){if(1&t&&Vf(YF,5),2&t){let i;ui(i=hi())&&(n.ripple=i.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,n){2&t&&(Xn("disabled",n.disabled||null),ci("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-button-disabled",n.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[rc],attrs:wJ,ngContentSelectors:vJ,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,n){1&t&&(Ta(),Lt(0,"span",0),$i(1),$t(),Ii(2,"span",1)(3,"span",2)),2&t&&(Qt(2),ci("mat-button-ripple-round",n.isRoundButton||n.isIconButton),Wt("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n.isIconButton)("matRippleTrigger",n._getHostElement()))},directives:[YF],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),r})(),RJ=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[GK,ea],ea]}),r})();class OJ{}class Fu{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),s=i.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const i=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(i,n),this.maybeSetNormalizedName(t,i))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Fu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Fu;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Fu?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class IJ{encodeKey(e){return rB(e)}encodeValue(e){return rB(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const NJ=/%(\d[a-f0-9])/gi,_J={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function rB(r){return encodeURIComponent(r).replace(NJ,(e,t)=>{var n;return null!==(n=_J[t])&&void 0!==n?n:e})}function iB(r){return`${r}`}class Bu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new IJ,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function PJ(r,e){const t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Bu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(iB(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(iB(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class DJ{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function sB(r){return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer}function oB(r){return"undefined"!=typeof Blob&&r instanceof Blob}function aB(r){return"undefined"!=typeof FormData&&r instanceof FormData}class pE{constructor(e,t,n,i){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function xJ(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Fu),this.context||(this.context=new DJ),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Bu,this.urlWithParams=t}serializeBody(){return null===this.body?null:sB(this.body)||oB(this.body)||aB(this.body)||function LJ(r){return"undefined"!=typeof URLSearchParams&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Bu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||aB(this.body)?null:oB(this.body)?this.body.type||null:sB(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Bu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const n=e.method||this.method,i=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,d=e.params||this.params;const b=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((N,F)=>N.set(F,e.setHeaders[F]),c)),e.setParams&&(d=Object.keys(e.setParams).reduce((N,F)=>N.set(F,e.setParams[F]),d)),new pE(n,i,o,{params:d,headers:c,context:b,reportProgress:l,responseType:s,withCredentials:a})}}var Di=(()=>((Di=Di||{})[Di.Sent=0]="Sent",Di[Di.UploadProgress=1]="UploadProgress",Di[Di.ResponseHeader=2]="ResponseHeader",Di[Di.DownloadProgress=3]="DownloadProgress",Di[Di.Response=4]="Response",Di[Di.User=5]="User",Di))();class iI extends class MJ{constructor(e,t=200,n="OK"){this.headers=e.headers||new Fu,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}{constructor(e={}){super(e),this.type=Di.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new iI({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function sI(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials}}let cB=(()=>{class r{constructor(t){this.handler=t}request(t,n,i={}){let s;if(t instanceof pE)s=t;else{let l,c;l=i.headers instanceof Fu?i.headers:new Fu(i.headers),i.params&&(c=i.params instanceof Bu?i.params:new Bu({fromObject:i.params})),s=new pE(t,n,void 0!==i.body?i.body:null,{headers:l,context:i.context,params:c,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const o=Tt(s).pipe(Uf(l=>this.handler.handle(l)));if(t instanceof pE||"events"===i.observe)return o;const a=o.pipe(Ki(l=>l instanceof iI));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(_e(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(_e(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(_e(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(_e(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new Bu).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,i={}){return this.request("PATCH",t,sI(i,n))}post(t,n,i={}){return this.request("POST",t,sI(i,n))}put(t,n,i={}){return this.request("PUT",t,sI(i,n))}}return r.\u0275fac=function(t){return new(t||r)($e(OJ))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const BJ=["*"];let JA;function mE(r){var e;return(null===(e=function kJ(){if(void 0===JA&&(JA=null,"undefined"!=typeof window)){const r=window;void 0!==r.trustedTypes&&(JA=r.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return JA}())||void 0===e?void 0:e.createHTML(r))||r}function uB(r){return Error(`Unable to find icon with the name "${r}"`)}function hB(r){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${r}".`)}function dB(r){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${r}".`)}class md{constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}}let qA=(()=>{class r{constructor(t,n,i,s){this._httpClient=t,this._sanitizer=n,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=i}addSvgIcon(t,n,i){return this.addSvgIconInNamespace("",t,n,i)}addSvgIconLiteral(t,n,i){return this.addSvgIconLiteralInNamespace("",t,n,i)}addSvgIconInNamespace(t,n,i,s){return this._addSvgIconConfig(t,n,new md(i,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,n,i,s){const o=this._sanitizer.sanitize(yn.HTML,i);if(!o)throw dB(i);const a=mE(o);return this._addSvgIconConfig(t,n,new md("",a,s))}addSvgIconSet(t,n){return this.addSvgIconSetInNamespace("",t,n)}addSvgIconSetLiteral(t,n){return this.addSvgIconSetLiteralInNamespace("",t,n)}addSvgIconSetInNamespace(t,n,i){return this._addSvgIconSetConfig(t,new md(n,null,i))}addSvgIconSetLiteralInNamespace(t,n,i){const s=this._sanitizer.sanitize(yn.HTML,n);if(!s)throw dB(n);const o=mE(s);return this._addSvgIconSetConfig(t,new md("",o,i))}registerFontClassAlias(t,n=t){return this._fontCssClassesByAlias.set(t,n),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const n=this._sanitizer.sanitize(yn.RESOURCE_URL,t);if(!n)throw hB(t);const i=this._cachedIconsByUrl.get(n);return i?Tt(QA(i)):this._loadSvgIconFromConfig(new md(t,null)).pipe(Ji(s=>this._cachedIconsByUrl.set(n,s)),_e(s=>QA(s)))}getNamedSvgIcon(t,n=""){const i=fB(n,t);let s=this._svgIconConfigs.get(i);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(n,t),s)return this._svgIconConfigs.set(i,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(n);return o?this._getSvgFromIconSetConfigs(t,o):ly(uB(i))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Tt(QA(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(_e(n=>QA(n)))}_getSvgFromIconSetConfigs(t,n){const i=this._extractIconWithNameFromAnySet(t,n);return i?Tt(i):function TJ(...r){const e=bd(r),{args:t,keys:n}=AD(r),i=new ee(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let d=0;d<o;d++){let b=!1;Si(t[d]).subscribe(new Ie(s,N=>{b||(b=!0,c--),a[d]=N},()=>l--,void 0,()=>{(!l||!b)&&(c||s.next(n?bD(n,a):a),s.complete())}))}});return e?i.pipe(_0(e)):i}(n.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(cc(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(yn.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),Tt(null)})))).pipe(_e(()=>{const o=this._extractIconWithNameFromAnySet(t,n);if(!o)throw uB(t);return o}))}_extractIconWithNameFromAnySet(t,n){for(let i=n.length-1;i>=0;i--){const s=n[i];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Ji(n=>t.svgText=n),_e(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Tt(null):this._fetchIcon(t).pipe(Ji(n=>t.svgText=n))}_extractSvgIconFromSet(t,n,i){const s=t.querySelector(`[id="${n}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,i);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),i);const a=this._svgElementFromString(mE("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,i)}_svgElementFromString(t){const n=this._document.createElement("DIV");n.innerHTML=t;const i=n.querySelector("svg");if(!i)throw Error("<svg> tag not found");return i}_toSvgElement(t){const n=this._svgElementFromString(mE("<svg></svg>")),i=t.attributes;for(let s=0;s<i.length;s++){const{name:o,value:a}=i[s];"id"!==o&&n.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&n.appendChild(t.childNodes[s].cloneNode(!0));return n}_setSvgAttributes(t,n){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),n&&n.viewBox&&t.setAttribute("viewBox",n.viewBox),t}_fetchIcon(t){var n;const{url:i,options:s}=t,o=null!==(n=null==s?void 0:s.withCredentials)&&void 0!==n&&n;if(!this._httpClient)throw function GJ(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const a=this._sanitizer.sanitize(yn.RESOURCE_URL,i);if(!a)throw hB(i);const l=this._inProgressUrlFetches.get(a);if(l)return l;const c=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(_e(d=>mE(d)),_D(()=>this._inProgressUrlFetches.delete(a)),ju());return this._inProgressUrlFetches.set(a,c),c}_addSvgIconConfig(t,n,i){return this._svgIconConfigs.set(fB(t,n),i),this}_addSvgIconSetConfig(t,n){const i=this._iconSetConfigs.get(t);return i?i.push(n):this._iconSetConfigs.set(t,[n]),this}_svgElementFromConfig(t){if(!t.svgElement){const n=this._svgElementFromString(t.svgText);this._setSvgAttributes(n,t.options),t.svgElement=n}return t.svgElement}_getIconConfigFromResolvers(t,n){for(let i=0;i<this._resolvers.length;i++){const s=this._resolvers[i](n,t);if(s)return HJ(s)?new md(s.url,null,s.options):new md(s,null)}}}return r.\u0275fac=function(t){return new(t||r)($e(cB,8),$e(N0),$e(Ln,8),$e(va))},r.\u0275prov=gt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function QA(r){return r.cloneNode(!0)}function fB(r,e){return r+":"+e}function HJ(r){return!(!r.url||!r.options)}const YJ=XO(class{constructor(r){this._elementRef=r}}),UJ=new pt("mat-icon-location",{providedIn:"root",factory:function WJ(){const r=wh(Ln),e=r?r.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),gB=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],jJ=gB.map(r=>`[${r}]`).join(", "),zJ=/^url\(['"]?#(.*?)['"]?\)$/;let $J=(()=>{class r extends YJ{constructor(t,n,i,s,o){super(t),this._iconRegistry=n,this._location=s,this._errorHandler=o,this._inline=!1,this._currentIconFetch=m.EMPTY,i||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=Ha(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const n=this._cleanupFontValue(t);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const n=this._cleanupFontValue(t);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const n=t.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const n=t.querySelectorAll("style");for(let s=0;s<n.length;s++)n[s].textContent+=" ";const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let n=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const i=t.childNodes[n];(1!==i.nodeType||"svg"===i.nodeName.toLowerCase())&&i.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,n=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();n!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),n&&t.classList.add(n),this._previousFontSetClass=n),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const n=this._elementsWithExternalReferences;n&&n.forEach((i,s)=>{i.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const n=t.querySelectorAll(jJ),i=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<n.length;s++)gB.forEach(o=>{const a=n[s],l=a.getAttribute(o),c=l?l.match(zJ):null;if(c){let d=i.get(a);d||(d=[],i.set(a,d)),d.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[n,i]=this._splitIconName(t);n&&(this._svgNamespace=n),i&&(this._svgName=i),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(i,n).pipe(Ai(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${i}! ${s.message}`))})}}}return r.\u0275fac=function(t){return new(t||r)(Ue(Dr),Ue(qA),$l("aria-hidden"),Ue(UJ),Ue(va))},r.\u0275cmp=Zn({type:r,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,n){2&t&&(Xn("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet),ci("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[rc],ngContentSelectors:BJ,decls:1,vars:0,template:function(t,n){1&t&&(Ta(),$i(0))},styles:[".mat-icon{-webkit-user-select:none;-moz-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),r})(),KJ=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[ea],ea]}),r})(),JJ=(()=>{class r{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(t){this._vertical=Ha(t)}get inset(){return this._inset}set inset(t){this._inset=Ha(t)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=Zn({type:r,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(t,n){2&t&&(Xn("aria-orientation",n.vertical?"vertical":"horizontal"),ci("mat-divider-vertical",n.vertical)("mat-divider-horizontal",!n.vertical)("mat-divider-inset",n.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(t,n){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}\n"],encapsulation:2,changeDetection:0}),r})(),qJ=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r}),r.\u0275inj=Un({imports:[[ea],ea]}),r})();function QJ(r,e){1&r&&(Lt(0,"mat-icon"),Bs(1," menu "),$t())}function XJ(r,e){1&r&&(Lt(0,"mat-icon"),Bs(1," close "),$t())}function ZJ(r,e){if(1&r){const t=hu();Lt(0,"button",9),zi("click",function(){return Ts(t),tn(),Iv(6).toggle()}),xn(1,QJ,2,0,"mat-icon",10),xn(2,XJ,2,0,"mat-icon",10),$t()}if(2&r){tn();const t=Iv(6);Qt(1),Wt("ngIf",!t.opened),Qt(1),Wt("ngIf",t.opened)}}let yd=class{constructor(e,t){this.observer=e,this.router=t}ngAfterViewInit(){this.observer.observe(["(max-width: 800px)"]).pipe(function ZK(r,e=mO){const t=F1(r,e);return $F(()=>t)}(1),eB(this)).subscribe(e=>{e.matches?(this.sidenav.mode="over",this.sidenav.close()):(this.sidenav.mode="side",this.sidenav.open())}),this.router.events.pipe(eB(this),Ki(e=>e instanceof Wf)).subscribe(()=>{"over"===this.sidenav.mode&&this.sidenav.close()})}};yd.\u0275fac=function(e){return new(e||yd)(Ue(dJ),Ue(Gs))},yd.\u0275cmp=Zn({type:yd,selectors:[["app-root"]],viewQuery:function(e,t){if(1&e&&Vf(rI,5),2&e){let n;ui(n=hi())&&(t.sidenav=n.first)}},decls:28,vars:1,consts:[[1,"mat-elevation-z8"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"menuTitle"],["sidenav","matSidenav"],["src","https://avatars.githubusercontent.com/u/76245280?s=200&v=4",1,"avatar","mat-elevation-z8"],["mat-button","","routerLink","/home",1,"menu-button"],["mat-button","","routerLink","/example",1,"menu-button"],["mat-button","","routerLink","/help",1,"menu-button"],[1,"content","mat-elevation-z8"],["mat-icon-button","",3,"click"],[4,"ngIf"]],template:function(e,t){if(1&e&&(Lt(0,"mat-toolbar",0),xn(1,ZJ,3,2,"button",1),Lt(2,"span",2),Bs(3,"ngx-msagl"),$t()(),Lt(4,"mat-sidenav-container")(5,"mat-sidenav",0,3),Ii(7,"img",4)(8,"mat-divider"),Lt(9,"button",5)(10,"mat-icon"),Bs(11,"home"),$t(),Lt(12,"span"),Bs(13,"Home"),$t()(),Lt(14,"button",6)(15,"mat-icon"),Bs(16,"graphic_eq"),$t(),Lt(17,"span"),Bs(18,"MDS Example"),$t()(),Ii(19,"mat-divider"),Lt(20,"button",7)(21,"mat-icon"),Bs(22,"help"),$t(),Lt(23,"span"),Bs(24,"Help"),$t()()(),Lt(25,"mat-sidenav-content")(26,"div",8),Ii(27,"router-outlet"),$t()()()),2&e){const n=Iv(6);Qt(1),Wt("ngIf","over"===n.mode)}},directives:[yJ,Wh,CJ,$J,zF,rI,JJ,TS,nI,j0],styles:["mat-toolbar[_ngcontent-%COMP%]{background-color:#1f233e;color:#fff;height:36px}mat-toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#1f233e;color:#fff}.menuTitle[_ngcontent-%COMP%]{font-size:24px}mat-sidenav[_ngcontent-%COMP%]{width:200px;height:100%;border-right:none;background-color:#1f233e;color:#fff;padding:16px;text-align:center;border-right:1px solid white}.content[_ngcontent-%COMP%]{height:calc(100vh - 36px);background:lightgrey;overflow:hidden}mat-sidenav-container[_ngcontent-%COMP%]{height:calc(100vh - 36px)}.menu-button[_ngcontent-%COMP%]{width:100%;display:flex;background-color:#1f233e;color:#fff;align-items:center;justify-content:flex-start;font-size:1rem}.menu-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.avatar[_ngcontent-%COMP%]{margin-top:16px;width:100px;height:100px;border-radius:50%}mat-divider[_ngcontent-%COMP%]{margin-top:16px;margin-bottom:16px;background-color:#ffffff80}"]}),yd=(0,$L.__decorate)([function aJ(r={}){return e=>{!function tJ(r){return!!r[eJ]}(e)?function sJ(r,e){r.prototype.ngOnDestroy=ZF(r.prototype.ngOnDestroy,e)}(e,r):function oJ(r,e){const t=r.\u0275pipe;t.onDestroy=ZF(t.onDestroy,e)}(e,r),function rJ(r){r.prototype[KF]=!0}(e)}}()],yd);let eq=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=pr({type:r,bootstrap:[yd]}),r.\u0275inj=Un({providers:[],imports:[[ED,x7,OK,EJ,QK,RJ,KJ,qJ,R7]]}),r})();(function gV(){if(__)throw new Error("Cannot enable prod mode after platform setup.");N_=!1})(),_3().bootstrapModule(eq).catch(r=>console.error(r))},9695:(L,D,p)=>{L.exports={graphlib:p(6456),layout:p(4850),debug:p(1914),util:{time:p(1510).time,notime:p(1510).notime},version:p(8126)}},2234:(L,D,p)=>{"use strict";var E=p(5760),S=p(7365);L.exports={run:function O(f){var y="greedy"===f.graph().acyclicer?S(f,function m(T){return function(g){return T.edge(g).weight}}(f)):function w(f){var y=[],m={},T={};return E.forEach(f.nodes(),function g(C){E.has(T,C)||(T[C]=!0,m[C]=!0,E.forEach(f.outEdges(C),function(v){E.has(m,v.w)?y.push(v):g(v.w)}),delete m[C])}),y}(f);E.forEach(y,function(T){var g=f.edge(T);f.removeEdge(T),g.forwardName=T.name,g.reversed=!0,f.setEdge(T.w,T.v,g,E.uniqueId("rev"))})},undo:function R(f){E.forEach(f.edges(),function(y){var m=f.edge(y);if(m.reversed){f.removeEdge(y);var T=m.forwardName;delete m.reversed,delete m.forwardName,f.setEdge(y.w,y.v,m,T)}})}}},9999:(L,D,p)=>{var E=p(5760),S=p(1510);function w(R,f,y,m,T,g){var v=T[f][g-1],P=S.addDummyNode(R,"border",{width:0,height:0,rank:g,borderType:f},y);T[f][g]=P,R.setParent(P,m),v&&R.setEdge(v,P,{weight:1})}L.exports=function O(R){E.forEach(R.children(),function f(y){var m=R.children(y),T=R.node(y);if(m.length&&E.forEach(m,f),E.has(T,"minRank")){T.borderLeft=[],T.borderRight=[];for(var g=T.minRank,C=T.maxRank+1;g<C;++g)w(R,"borderLeft","_bl",y,T,g),w(R,"borderRight","_br",y,T,g)}})}},3870:(L,D,p)=>{"use strict";var E=p(5760);function w(g){E.forEach(g.nodes(),function(C){R(g.node(C))}),E.forEach(g.edges(),function(C){R(g.edge(C))})}function R(g){var C=g.width;g.width=g.height,g.height=C}function y(g){g.y=-g.y}function T(g){var C=g.x;g.x=g.y,g.y=C}L.exports={adjust:function S(g){var C=g.graph().rankdir.toLowerCase();("lr"===C||"rl"===C)&&w(g)},undo:function O(g){var C=g.graph().rankdir.toLowerCase();("bt"===C||"rl"===C)&&function f(g){E.forEach(g.nodes(),function(C){y(g.node(C))}),E.forEach(g.edges(),function(C){var v=g.edge(C);E.forEach(v.points,y),E.has(v,"y")&&y(v)})}(g),("lr"===C||"rl"===C)&&(function m(g){E.forEach(g.nodes(),function(C){T(g.node(C))}),E.forEach(g.edges(),function(C){var v=g.edge(C);E.forEach(v.points,T),E.has(v,"x")&&T(v)})}(g),w(g))}}},3226:L=>{function D(){var S={};S._next=S._prev=S,this._sentinel=S}function p(S){S._prev._next=S._next,S._next._prev=S._prev,delete S._next,delete S._prev}function E(S,O){if("_next"!==S&&"_prev"!==S)return O}L.exports=D,D.prototype.dequeue=function(){var S=this._sentinel,O=S._prev;if(O!==S)return p(O),O},D.prototype.enqueue=function(S){var O=this._sentinel;S._prev&&S._next&&p(S),S._next=O._next,O._next._prev=S,O._next=S,S._prev=O},D.prototype.toString=function(){for(var S=[],O=this._sentinel,w=O._prev;w!==O;)S.push(JSON.stringify(w,E)),w=w._prev;return"["+S.join(", ")+"]"}},1914:(L,D,p)=>{var E=p(5760),S=p(1510),O=p(6456).Graph;L.exports={debugOrdering:function w(R){var f=S.buildLayerMatrix(R),y=new O({compound:!0,multigraph:!0}).setGraph({});return E.forEach(R.nodes(),function(m){y.setNode(m,{label:m}),y.setParent(m,"layer"+R.node(m).rank)}),E.forEach(R.edges(),function(m){y.setEdge(m.v,m.w,{},m.name)}),E.forEach(f,function(m,T){y.setNode("layer"+T,{rank:"same"}),E.reduce(m,function(C,v){return y.setEdge(C,v,{style:"invis"}),v})}),y}}},6456:(L,D,p)=>{var E;try{E=p(5510)}catch(S){}E||(E=window.graphlib),L.exports=E},7365:(L,D,p)=>{var E=p(5760),S=p(6456).Graph,O=p(3226);L.exports=function R(g,C){if(g.nodeCount()<=1)return[];var v=function m(g,C){var v=new S,P=0,_=0;E.forEach(g.nodes(),function(H){v.setNode(H,{v:H,in:0,out:0})}),E.forEach(g.edges(),function(H){var K=v.edge(H.v,H.w)||0,V=C(H);v.setEdge(H.v,H.w,K+V),_=Math.max(_,v.node(H.v).out+=V),P=Math.max(P,v.node(H.w).in+=V)});var x=E.range(_+P+3).map(function(){return new O}),B=P+1;return E.forEach(v.nodes(),function(H){T(x,B,v.node(H))}),{graph:v,buckets:x,zeroIdx:B}}(g,C||w),P=function f(g,C,v){for(var B,P=[],_=C[C.length-1],x=C[0];g.nodeCount();){for(;B=x.dequeue();)y(g,C,v,B);for(;B=_.dequeue();)y(g,C,v,B);if(g.nodeCount())for(var H=C.length-2;H>0;--H)if(B=C[H].dequeue()){P=P.concat(y(g,C,v,B,!0));break}}return P}(v.graph,v.buckets,v.zeroIdx);return E.flatten(E.map(P,function(_){return g.outEdges(_.v,_.w)}),!0)};var w=E.constant(1);function y(g,C,v,P,_){var x=_?[]:void 0;return E.forEach(g.inEdges(P.v),function(B){var H=g.edge(B),K=g.node(B.v);_&&x.push({v:B.v,w:B.w}),K.out-=H,T(C,v,K)}),E.forEach(g.outEdges(P.v),function(B){var H=g.edge(B),V=g.node(B.w);V.in-=H,T(C,v,V)}),g.removeNode(P.v),x}function T(g,C,v){v.out?v.in?g[v.out-v.in+C].enqueue(v):g[g.length-1].enqueue(v):g[0].enqueue(v)}},4850:(L,D,p)=>{"use strict";var E=p(5760),S=p(2234),O=p(1496),w=p(4124),R=p(1510).normalizeRanks,f=p(162),y=p(1510).removeEmptyRanks,m=p(1230),T=p(9999),g=p(3870),C=p(2974),v=p(8226),P=p(1510),_=p(6456).Graph;L.exports=function x(Se,Ie){var _e=Ie&&Ie.debugTiming?P.time:P.notime;_e("layout",function(){var Oe=_e("  buildLayoutGraph",function(){return function te(Se){var Ie=new _({multigraph:!0,compound:!0}),_e=ft(Se.graph());return Ie.setGraph(E.merge({},V,je(_e,K),E.pick(_e,ne))),E.forEach(Se.nodes(),function(Oe){var Ye=ft(Se.node(Oe));Ie.setNode(Oe,E.defaults(je(Ye,se),ge)),Ie.setParent(Oe,Se.parent(Oe))}),E.forEach(Se.edges(),function(Oe){var Ye=ft(Se.edge(Oe));Ie.setEdge(Oe,E.merge({},me,je(Ye,ce),E.pick(Ye,Q)))}),Ie}(Se)});_e("  runLayout",function(){!function B(Se,Ie){Ie("    makeSpaceForEdgeLabels",function(){!function j(Se){var Ie=Se.graph();Ie.ranksep/=2,E.forEach(Se.edges(),function(_e){var Oe=Se.edge(_e);Oe.minlen*=2,"c"!==Oe.labelpos.toLowerCase()&&("TB"===Ie.rankdir||"BT"===Ie.rankdir?Oe.width+=Oe.labeloffset:Oe.height+=Oe.labeloffset)})}(Se)}),Ie("    removeSelfEdges",function(){!function Ne(Se){E.forEach(Se.edges(),function(Ie){if(Ie.v===Ie.w){var _e=Se.node(Ie.v);_e.selfEdges||(_e.selfEdges=[]),_e.selfEdges.push({e:Ie,label:Se.edge(Ie)}),Se.removeEdge(Ie)}})}(Se)}),Ie("    acyclic",function(){S.run(Se)}),Ie("    nestingGraph.run",function(){m.run(Se)}),Ie("    rank",function(){w(P.asNonCompoundGraph(Se))}),Ie("    injectEdgeLabelProxies",function(){!function $(Se){E.forEach(Se.edges(),function(Ie){var _e=Se.edge(Ie);if(_e.width&&_e.height){var Oe=Se.node(Ie.v),Ye=Se.node(Ie.w);P.addDummyNode(Se,"edge-proxy",{rank:(Ye.rank-Oe.rank)/2+Oe.rank,e:Ie},"_ep")}})}(Se)}),Ie("    removeEmptyRanks",function(){y(Se)}),Ie("    nestingGraph.cleanup",function(){m.cleanup(Se)}),Ie("    normalizeRanks",function(){R(Se)}),Ie("    assignRankMinMax",function(){!function J(Se){var Ie=0;E.forEach(Se.nodes(),function(_e){var Oe=Se.node(_e);Oe.borderTop&&(Oe.minRank=Se.node(Oe.borderTop).rank,Oe.maxRank=Se.node(Oe.borderBottom).rank,Ie=E.max(Ie,Oe.maxRank))}),Se.graph().maxRank=Ie}(Se)}),Ie("    removeEdgeLabelProxies",function(){!function ae(Se){E.forEach(Se.nodes(),function(Ie){var _e=Se.node(Ie);"edge-proxy"===_e.dummy&&(Se.edge(_e.e).labelRank=_e.rank,Se.removeNode(Ie))})}(Se)}),Ie("    normalize.run",function(){O.run(Se)}),Ie("    parentDummyChains",function(){f(Se)}),Ie("    addBorderSegments",function(){T(Se)}),Ie("    order",function(){C(Se)}),Ie("    insertSelfEdges",function(){!function Le(Se){var Ie=P.buildLayerMatrix(Se);E.forEach(Ie,function(_e){var Oe=0;E.forEach(_e,function(Ye,et){var mt=Se.node(Ye);mt.order=et+Oe,E.forEach(mt.selfEdges,function(kt){P.addDummyNode(Se,"selfedge",{width:kt.label.width,height:kt.label.height,rank:mt.rank,order:et+ ++Oe,e:kt.e,label:kt.label},"_se")}),delete mt.selfEdges})})}(Se)}),Ie("    adjustCoordinateSystem",function(){g.adjust(Se)}),Ie("    position",function(){v(Se)}),Ie("    positionSelfEdges",function(){!function ke(Se){E.forEach(Se.nodes(),function(Ie){var _e=Se.node(Ie);if("selfedge"===_e.dummy){var Oe=Se.node(_e.e.v),Ye=Oe.x+Oe.width/2,et=Oe.y,mt=_e.x-Ye,kt=Oe.height/2;Se.setEdge(_e.e,_e.label),Se.removeNode(Ie),_e.label.points=[{x:Ye+2*mt/3,y:et-kt},{x:Ye+5*mt/6,y:et-kt},{x:Ye+mt,y:et},{x:Ye+5*mt/6,y:et+kt},{x:Ye+2*mt/3,y:et+kt}],_e.label.x=_e.x,_e.label.y=_e.y}})}(Se)}),Ie("    removeBorderNodes",function(){!function De(Se){E.forEach(Se.nodes(),function(Ie){if(Se.children(Ie).length){var _e=Se.node(Ie),Oe=Se.node(_e.borderTop),Ye=Se.node(_e.borderBottom),et=Se.node(E.last(_e.borderLeft)),mt=Se.node(E.last(_e.borderRight));_e.width=Math.abs(mt.x-et.x),_e.height=Math.abs(Ye.y-Oe.y),_e.x=et.x+_e.width/2,_e.y=Oe.y+_e.height/2}}),E.forEach(Se.nodes(),function(Ie){"border"===Se.node(Ie).dummy&&Se.removeNode(Ie)})}(Se)}),Ie("    normalize.undo",function(){O.undo(Se)}),Ie("    fixupEdgeLabelCoords",function(){!function ee(Se){E.forEach(Se.edges(),function(Ie){var _e=Se.edge(Ie);if(E.has(_e,"x"))switch(("l"===_e.labelpos||"r"===_e.labelpos)&&(_e.width-=_e.labeloffset),_e.labelpos){case"l":_e.x-=_e.width/2+_e.labeloffset;break;case"r":_e.x+=_e.width/2+_e.labeloffset}})}(Se)}),Ie("    undoCoordinateSystem",function(){g.undo(Se)}),Ie("    translateGraph",function(){!function Ee(Se){var Ie=Number.POSITIVE_INFINITY,_e=0,Oe=Number.POSITIVE_INFINITY,Ye=0,et=Se.graph(),mt=et.marginx||0,kt=et.marginy||0;function Br(dn){var Hn=dn.x,nn=dn.y,fr=dn.width,Xt=dn.height;Ie=Math.min(Ie,Hn-fr/2),_e=Math.max(_e,Hn+fr/2),Oe=Math.min(Oe,nn-Xt/2),Ye=Math.max(Ye,nn+Xt/2)}E.forEach(Se.nodes(),function(dn){Br(Se.node(dn))}),E.forEach(Se.edges(),function(dn){var Hn=Se.edge(dn);E.has(Hn,"x")&&Br(Hn)}),Ie-=mt,Oe-=kt,E.forEach(Se.nodes(),function(dn){var Hn=Se.node(dn);Hn.x-=Ie,Hn.y-=Oe}),E.forEach(Se.edges(),function(dn){var Hn=Se.edge(dn);E.forEach(Hn.points,function(nn){nn.x-=Ie,nn.y-=Oe}),E.has(Hn,"x")&&(Hn.x-=Ie),E.has(Hn,"y")&&(Hn.y-=Oe)}),et.width=_e-Ie+mt,et.height=Ye-Oe+kt}(Se)}),Ie("    assignNodeIntersects",function(){!function re(Se){E.forEach(Se.edges(),function(Ie){var et,mt,_e=Se.edge(Ie),Oe=Se.node(Ie.v),Ye=Se.node(Ie.w);_e.points?(et=_e.points[0],mt=_e.points[_e.points.length-1]):(_e.points=[],et=Ye,mt=Oe),_e.points.unshift(P.intersectRect(Oe,et)),_e.points.push(P.intersectRect(Ye,mt))})}(Se)}),Ie("    reversePoints",function(){!function Ae(Se){E.forEach(Se.edges(),function(Ie){var _e=Se.edge(Ie);_e.reversed&&_e.points.reverse()})}(Se)}),Ie("    acyclic.undo",function(){S.undo(Se)})}(Oe,_e)}),_e("  updateInputGraph",function(){!function H(Se,Ie){E.forEach(Se.nodes(),function(_e){var Oe=Se.node(_e),Ye=Ie.node(_e);Oe&&(Oe.x=Ye.x,Oe.y=Ye.y,Ie.children(_e).length&&(Oe.width=Ye.width,Oe.height=Ye.height))}),E.forEach(Se.edges(),function(_e){var Oe=Se.edge(_e),Ye=Ie.edge(_e);Oe.points=Ye.points,E.has(Ye,"x")&&(Oe.x=Ye.x,Oe.y=Ye.y)}),Se.graph().width=Ie.graph().width,Se.graph().height=Ie.graph().height}(Se,Oe)})})};var K=["nodesep","edgesep","ranksep","marginx","marginy"],V={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},ne=["acyclicer","ranker","rankdir","align"],se=["width","height"],ge={width:0,height:0},ce=["minlen","weight","width","height","labeloffset"],me={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Q=["labelpos"];function je(Se,Ie){return E.mapValues(E.pick(Se,Ie),Number)}function ft(Se){var Ie={};return E.forEach(Se,function(_e,Oe){Ie[Oe.toLowerCase()]=_e}),Ie}},5760:(L,D,p)=>{var E;try{E={cloneDeep:p(733),constant:p(6684),defaults:p(8800),each:p(5474),filter:p(5281),find:p(2516),flatten:p(2274),forEach:p(9851),forIn:p(1176),has:p(4842),isUndefined:p(4235),last:p(5809),map:p(9984),mapValues:p(203),max:p(8176),merge:p(567),min:p(9439),minBy:p(9525),now:p(1710),pick:p(6372),range:p(361),reduce:p(1337),sortBy:p(2906),uniqueId:p(1541),values:p(377),zipObject:p(1617)}}catch(S){}E||(E=window._),L.exports=E},1230:(L,D,p)=>{var E=p(5760),S=p(1510);function w(m,T,g,C,v,P,_){var x=m.children(_);if(x.length){var B=S.addBorderNode(m,"_bt"),H=S.addBorderNode(m,"_bb"),K=m.node(_);m.setParent(B,_),K.borderTop=B,m.setParent(H,_),K.borderBottom=H,E.forEach(x,function(V){w(m,T,g,C,v,P,V);var ne=m.node(V),se=ne.borderTop?ne.borderTop:V,ge=ne.borderBottom?ne.borderBottom:V,ce=ne.borderTop?C:2*C,me=se!==ge?1:v-P[_]+1;m.setEdge(B,se,{weight:ce,minlen:me,nestingEdge:!0}),m.setEdge(ge,H,{weight:ce,minlen:me,nestingEdge:!0})}),m.parent(_)||m.setEdge(T,B,{weight:0,minlen:v+P[_]})}else _!==T&&m.setEdge(T,_,{weight:0,minlen:g})}L.exports={run:function O(m){var T=S.addDummyNode(m,"root",{},"_root"),g=function R(m){var T={};function g(C,v){var P=m.children(C);P&&P.length&&E.forEach(P,function(_){g(_,v+1)}),T[C]=v}return E.forEach(m.children(),function(C){g(C,1)}),T}(m),C=E.max(E.values(g))-1,v=2*C+1;m.graph().nestingRoot=T,E.forEach(m.edges(),function(_){m.edge(_).minlen*=v});var P=function f(m){return E.reduce(m.edges(),function(T,g){return T+m.edge(g).weight},0)}(m)+1;E.forEach(m.children(),function(_){w(m,T,v,P,C,g,_)}),m.graph().nodeRankFactor=v},cleanup:function y(m){var T=m.graph();m.removeNode(T.nestingRoot),delete T.nestingRoot,E.forEach(m.edges(),function(g){m.edge(g).nestingEdge&&m.removeEdge(g)})}}},1496:(L,D,p)=>{"use strict";var E=p(5760),S=p(1510);L.exports={run:function O(f){f.graph().dummyChains=[],E.forEach(f.edges(),function(y){!function w(f,y){var m=y.v,T=f.node(m).rank,g=y.w,C=f.node(g).rank,v=y.name,P=f.edge(y),_=P.labelRank;if(C!==T+1){var x,B,H;for(f.removeEdge(y),H=0,++T;T<C;++H,++T)P.points=[],x=S.addDummyNode(f,"edge",B={width:0,height:0,edgeLabel:P,edgeObj:y,rank:T},"_d"),T===_&&(B.width=P.width,B.height=P.height,B.dummy="edge-label",B.labelpos=P.labelpos),f.setEdge(m,x,{weight:P.weight},v),0===H&&f.graph().dummyChains.push(x),m=x;f.setEdge(m,g,{weight:P.weight},v)}}(f,y)})},undo:function R(f){E.forEach(f.graph().dummyChains,function(y){var g,m=f.node(y),T=m.edgeLabel;for(f.setEdge(m.edgeObj,T);m.dummy;)g=f.successors(y)[0],f.removeNode(y),T.points.push({x:m.x,y:m.y}),"edge-label"===m.dummy&&(T.x=m.x,T.y=m.y,T.width=m.width,T.height=m.height),m=f.node(y=g)})}}},3034:(L,D,p)=>{var E=p(5760);L.exports=function S(O,w,R){var y,f={};E.forEach(R,function(m){for(var g,C,T=O.parent(m);T;){if((g=O.parent(T))?(C=f[g],f[g]=T):(C=y,y=T),C&&C!==T)return void w.setEdge(C,T);T=g}})}},1323:(L,D,p)=>{var E=p(5760);L.exports=function S(O,w){return E.map(w,function(R){var f=O.inEdges(R);if(f.length){var y=E.reduce(f,function(m,T){var g=O.edge(T),C=O.node(T.v);return{sum:m.sum+g.weight*C.order,weight:m.weight+g.weight}},{sum:0,weight:0});return{v:R,barycenter:y.sum/y.weight,weight:y.weight}}return{v:R}})}},1686:(L,D,p)=>{var E=p(5760),S=p(6456).Graph;L.exports=function O(R,f,y){var m=function w(R){for(var f;R.hasNode(f=E.uniqueId("_root")););return f}(R),T=new S({compound:!0}).setGraph({root:m}).setDefaultNodeLabel(function(g){return R.node(g)});return E.forEach(R.nodes(),function(g){var C=R.node(g),v=R.parent(g);(C.rank===f||C.minRank<=f&&f<=C.maxRank)&&(T.setNode(g),T.setParent(g,v||m),E.forEach(R[y](g),function(P){var _=P.v===g?P.w:P.v,x=T.edge(_,g),B=E.isUndefined(x)?0:x.weight;T.setEdge(_,g,{weight:R.edge(P).weight+B})}),E.has(C,"minRank")&&T.setNode(g,{borderLeft:C.borderLeft[f],borderRight:C.borderRight[f]}))}),T}},8796:(L,D,p)=>{"use strict";var E=p(5760);function O(w,R,f){for(var y=E.zipObject(f,E.map(f,function(P,_){return _})),m=E.flatten(E.map(R,function(P){return E.sortBy(E.map(w.outEdges(P),function(_){return{pos:y[_.w],weight:w.edge(_).weight}}),"pos")}),!0),T=1;T<f.length;)T<<=1;var g=2*T-1;T-=1;var C=E.map(new Array(g),function(){return 0}),v=0;return E.forEach(m.forEach(function(P){var _=P.pos+T;C[_]+=P.weight;for(var x=0;_>0;)_%2&&(x+=C[_+1]),C[_=_-1>>1]+=P.weight;v+=P.weight*x})),v}L.exports=function S(w,R){for(var f=0,y=1;y<R.length;++y)f+=O(w,R[y-1],R[y]);return f}},2974:(L,D,p)=>{"use strict";var E=p(5760),S=p(9402),O=p(8796),w=p(1057),R=p(1686),f=p(3034),y=p(6456).Graph,m=p(1510);function g(P,_,x){return E.map(_,function(B){return R(P,B,x)})}function C(P,_){var x=new y;E.forEach(P,function(B){var H=B.graph().root,K=w(B,H,x,_);E.forEach(K.vs,function(V,ne){B.node(V).order=ne}),f(B,x,K.vs)})}function v(P,_){E.forEach(_,function(x){E.forEach(x,function(B,H){P.node(B).order=H})})}L.exports=function T(P){var _=m.maxRank(P),x=g(P,E.range(1,_+1),"inEdges"),B=g(P,E.range(_-1,-1,-1),"outEdges"),H=S(P);v(P,H);for(var V,K=Number.POSITIVE_INFINITY,ne=0,se=0;se<4;++ne,++se){C(ne%2?x:B,ne%4>=2),H=m.buildLayerMatrix(P);var ge=O(P,H);ge<K&&(se=0,V=E.cloneDeep(H),K=ge)}v(P,V)}},9402:(L,D,p)=>{"use strict";var E=p(5760);L.exports=function S(O){var w={},R=E.filter(O.nodes(),function(g){return!O.children(g).length}),f=E.max(E.map(R,function(g){return O.node(g).rank})),y=E.map(E.range(f+1),function(){return[]}),T=E.sortBy(R,function(g){return O.node(g).rank});return E.forEach(T,function m(g){if(!E.has(w,g)){w[g]=!0;var C=O.node(g);y[C.rank].push(g),E.forEach(O.successors(g),m)}}),y}},3826:(L,D,p)=>{"use strict";var E=p(5760);L.exports=function S(R,f){var y={};return E.forEach(R,function(T,g){var C=y[T.v]={indegree:0,in:[],out:[],vs:[T.v],i:g};E.isUndefined(T.barycenter)||(C.barycenter=T.barycenter,C.weight=T.weight)}),E.forEach(f.edges(),function(T){var g=y[T.v],C=y[T.w];!E.isUndefined(g)&&!E.isUndefined(C)&&(C.indegree++,g.out.push(y[T.w]))}),function O(R){var f=[];function y(g){return function(C){C.merged||(E.isUndefined(C.barycenter)||E.isUndefined(g.barycenter)||C.barycenter>=g.barycenter)&&function w(R,f){var y=0,m=0;R.weight&&(y+=R.barycenter*R.weight,m+=R.weight),f.weight&&(y+=f.barycenter*f.weight,m+=f.weight),R.vs=f.vs.concat(R.vs),R.barycenter=y/m,R.weight=m,R.i=Math.min(f.i,R.i),f.merged=!0}(g,C)}}function m(g){return function(C){C.in.push(g),0==--C.indegree&&R.push(C)}}for(;R.length;){var T=R.pop();f.push(T),E.forEach(T.in.reverse(),y(T)),E.forEach(T.out,m(T))}return E.map(E.filter(f,function(g){return!g.merged}),function(g){return E.pick(g,["vs","i","barycenter","weight"])})}(E.filter(y,function(T){return!T.indegree}))}},1057:(L,D,p)=>{var E=p(5760),S=p(1323),O=p(3826),w=p(3803);L.exports=function R(m,T,g,C){var v=m.children(T),P=m.node(T),_=P?P.borderLeft:void 0,x=P?P.borderRight:void 0,B={};_&&(v=E.filter(v,function(ge){return ge!==_&&ge!==x}));var H=S(m,v);E.forEach(H,function(ge){if(m.children(ge.v).length){var ce=R(m,ge.v,g,C);B[ge.v]=ce,E.has(ce,"barycenter")&&function y(m,T){E.isUndefined(m.barycenter)?(m.barycenter=T.barycenter,m.weight=T.weight):(m.barycenter=(m.barycenter*m.weight+T.barycenter*T.weight)/(m.weight+T.weight),m.weight+=T.weight)}(ge,ce)}});var K=O(H,g);!function f(m,T){E.forEach(m,function(g){g.vs=E.flatten(g.vs.map(function(C){return T[C]?T[C].vs:C}),!0)})}(K,B);var V=w(K,C);if(_&&(V.vs=E.flatten([_,V.vs,x],!0),m.predecessors(_).length)){var ne=m.node(m.predecessors(_)[0]),se=m.node(m.predecessors(x)[0]);E.has(V,"barycenter")||(V.barycenter=0,V.weight=0),V.barycenter=(V.barycenter*V.weight+ne.order+se.order)/(V.weight+2),V.weight+=2}return V}},3803:(L,D,p)=>{var E=p(5760),S=p(1510);function w(f,y,m){for(var T;y.length&&(T=E.last(y)).i<=m;)y.pop(),f.push(T.vs),m++;return m}L.exports=function O(f,y){var m=S.partition(f,function(B){return E.has(B,"barycenter")}),T=m.lhs,g=E.sortBy(m.rhs,function(B){return-B.i}),C=[],v=0,P=0,_=0;T.sort(function R(f){return function(y,m){return y.barycenter<m.barycenter?-1:y.barycenter>m.barycenter?1:f?m.i-y.i:y.i-m.i}}(!!y)),_=w(C,g,_),E.forEach(T,function(B){_+=B.vs.length,C.push(B.vs),v+=B.barycenter*B.weight,P+=B.weight,_=w(C,g,_)});var x={vs:E.flatten(C,!0)};return P&&(x.barycenter=v/P,x.weight=P),x}},162:(L,D,p)=>{var E=p(5760);L.exports=function S(R){var f=function w(R){var f={},y=0;return E.forEach(R.children(),function m(T){var g=y;E.forEach(R.children(T),m),f[T]={low:g,lim:y++}}),f}(R);E.forEach(R.graph().dummyChains,function(y){for(var m=R.node(y),T=m.edgeObj,g=function O(R,f,y,m){var P,_,T=[],g=[],C=Math.min(f[y].low,f[m].low),v=Math.max(f[y].lim,f[m].lim);P=y;do{P=R.parent(P),T.push(P)}while(P&&(f[P].low>C||v>f[P].lim));for(_=P,P=m;(P=R.parent(P))!==_;)g.push(P);return{path:T.concat(g.reverse()),lca:_}}(R,f,T.v,T.w),C=g.path,v=g.lca,P=0,_=C[P],x=!0;y!==T.w;){if(m=R.node(y),x){for(;(_=C[P])!==v&&R.node(_).maxRank<m.rank;)P++;_===v&&(x=!1)}if(!x){for(;P<C.length-1&&R.node(_=C[P+1]).minRank<=m.rank;)P++;_=C[P]}R.setParent(y,_),y=R.successors(y)[0]}})}},4058:(L,D,p)=>{"use strict";var E=p(5760),S=p(6456).Graph,O=p(1510);function w(K,V){var ne={};return E.reduce(V,function se(ge,ce){var me=0,Q=0,te=ge.length,j=E.last(ce);return E.forEach(ce,function($,J){var ae=function f(K,V){if(K.node(V).dummy)return E.find(K.predecessors(V),function(ne){return K.node(ne).dummy})}(K,$),Ee=ae?K.node(ae).order:te;(ae||$===j)&&(E.forEach(ce.slice(Q,J+1),function(re){E.forEach(K.predecessors(re),function(ee){var Ae=K.node(ee),De=Ae.order;(De<me||Ee<De)&&(!Ae.dummy||!K.node(re).dummy)&&y(ne,ee,re)})}),Q=J+1,me=Ee)}),ce}),ne}function R(K,V){var ne={};function se(ce,me,Q,te,j){var $;E.forEach(E.range(me,Q),function(J){K.node($=ce[J]).dummy&&E.forEach(K.predecessors($),function(ae){var Ee=K.node(ae);Ee.dummy&&(Ee.order<te||Ee.order>j)&&y(ne,ae,$)})})}return E.reduce(V,function ge(ce,me){var te,Q=-1,j=0;return E.forEach(me,function($,J){if("border"===K.node($).dummy){var ae=K.predecessors($);ae.length&&(te=K.node(ae[0]).order,se(me,j,J,Q,te),j=J,Q=te)}se(me,j,me.length,te,ce.length)}),me}),ne}function y(K,V,ne){if(V>ne){var se=V;V=ne,ne=se}var ge=K[V];ge||(K[V]=ge={}),ge[ne]=!0}function m(K,V,ne){if(V>ne){var se=V;V=ne,ne=se}return E.has(K[V],ne)}function T(K,V,ne,se){var ge={},ce={},me={};return E.forEach(V,function(Q){E.forEach(Q,function(te,j){ge[te]=te,ce[te]=te,me[te]=j})}),E.forEach(V,function(Q){var te=-1;E.forEach(Q,function(j){var $=se(j);if($.length)for(var J=(($=E.sortBy($,function(ee){return me[ee]})).length-1)/2,ae=Math.floor(J),Ee=Math.ceil(J);ae<=Ee;++ae){var re=$[ae];ce[j]===j&&te<me[re]&&!m(ne,j,re)&&(ce[re]=j,ce[j]=ge[j]=ge[re],te=me[re])}})}),{root:ge,align:ce}}function g(K,V,ne,se,ge){var ce={},me=function C(K,V,ne,se){var ge=new S,ce=K.graph(),me=function B(K,V,ne){return function(se,ge,ce){var j,me=se.node(ge),Q=se.node(ce),te=0;if(te+=me.width/2,E.has(me,"labelpos"))switch(me.labelpos.toLowerCase()){case"l":j=-me.width/2;break;case"r":j=me.width/2}if(j&&(te+=ne?j:-j),j=0,te+=(me.dummy?V:K)/2,te+=(Q.dummy?V:K)/2,te+=Q.width/2,E.has(Q,"labelpos"))switch(Q.labelpos.toLowerCase()){case"l":j=Q.width/2;break;case"r":j=-Q.width/2}return j&&(te+=ne?j:-j),j=0,te}}(ce.nodesep,ce.edgesep,se);return E.forEach(V,function(Q){var te;E.forEach(Q,function(j){var $=ne[j];if(ge.setNode($),te){var J=ne[te],ae=ge.edge(J,$);ge.setEdge(J,$,Math.max(me(K,j,te),ae||0))}te=j})}),ge}(K,V,ne,ge),Q=ge?"borderLeft":"borderRight";function te(J,ae){for(var Ee=me.nodes(),re=Ee.pop(),ee={};re;)ee[re]?J(re):(ee[re]=!0,Ee.push(re),Ee=Ee.concat(ae(re))),re=Ee.pop()}return te(function j(J){ce[J]=me.inEdges(J).reduce(function(ae,Ee){return Math.max(ae,ce[Ee.v]+me.edge(Ee))},0)},me.predecessors.bind(me)),te(function $(J){var ae=me.outEdges(J).reduce(function(re,ee){return Math.min(re,ce[ee.w]-me.edge(ee))},Number.POSITIVE_INFINITY),Ee=K.node(J);ae!==Number.POSITIVE_INFINITY&&Ee.borderType!==Q&&(ce[J]=Math.max(ce[J],ae))},me.successors.bind(me)),E.forEach(se,function(J){ce[J]=ce[ne[J]]}),ce}function v(K,V){return E.minBy(E.values(V),function(ne){var se=Number.NEGATIVE_INFINITY,ge=Number.POSITIVE_INFINITY;return E.forIn(ne,function(ce,me){var Q=function H(K,V){return K.node(V).width}(K,me)/2;se=Math.max(ce+Q,se),ge=Math.min(ce-Q,ge)}),se-ge})}function P(K,V){var ne=E.values(V),se=E.min(ne),ge=E.max(ne);E.forEach(["u","d"],function(ce){E.forEach(["l","r"],function(me){var j,Q=ce+me,te=K[Q];if(te!==V){var $=E.values(te);(j="l"===me?se-E.min($):ge-E.max($))&&(K[Q]=E.mapValues(te,function(J){return J+j}))}})})}function _(K,V){return E.mapValues(K.ul,function(ne,se){if(V)return K[V.toLowerCase()][se];var ge=E.sortBy(E.map(K,se));return(ge[1]+ge[2])/2})}L.exports={positionX:function x(K){var ge,V=O.buildLayerMatrix(K),ne=E.merge(w(K,V),R(K,V)),se={};E.forEach(["u","d"],function(me){ge="u"===me?V:E.values(V).reverse(),E.forEach(["l","r"],function(Q){"r"===Q&&(ge=E.map(ge,function(J){return E.values(J).reverse()}));var te=("u"===me?K.predecessors:K.successors).bind(K),j=T(0,ge,ne,te),$=g(K,ge,j.root,j.align,"r"===Q);"r"===Q&&($=E.mapValues($,function(J){return-J})),se[me+Q]=$})});var ce=v(K,se);return P(se,ce),_(se,K.graph().align)},findType1Conflicts:w,findType2Conflicts:R,addConflict:y,hasConflict:m,verticalAlignment:T,horizontalCompaction:g,alignCoordinates:P,findSmallestWidthAlignment:v,balance:_}},8226:(L,D,p)=>{"use strict";var E=p(5760),S=p(1510),O=p(4058).positionX;L.exports=function w(f){(function R(f){var y=S.buildLayerMatrix(f),m=f.graph().ranksep,T=0;E.forEach(y,function(g){var C=E.max(E.map(g,function(v){return f.node(v).height}));E.forEach(g,function(v){f.node(v).y=T+C/2}),T+=C+m})})(f=S.asNonCompoundGraph(f)),E.forEach(O(f),function(y,m){f.node(m).x=y})}},6632:(L,D,p)=>{"use strict";var E=p(5760),S=p(6456).Graph,O=p(1916).slack;function R(m,T){return E.forEach(m.nodes(),function g(C){E.forEach(T.nodeEdges(C),function(v){var P=v.v,_=C===P?v.w:P;!m.hasNode(_)&&!O(T,v)&&(m.setNode(_,{}),m.setEdge(C,_,{}),g(_))})}),m.nodeCount()}function f(m,T){return E.minBy(T.edges(),function(g){if(m.hasNode(g.v)!==m.hasNode(g.w))return O(T,g)})}function y(m,T,g){E.forEach(m.nodes(),function(C){T.node(C).rank+=g})}L.exports=function w(m){var v,P,T=new S({directed:!1}),g=m.nodes()[0],C=m.nodeCount();for(T.setNode(g,{});R(T,m)<C;)v=f(T,m),P=T.hasNode(v.v)?O(m,v):-O(m,v),y(T,m,P);return T}},4124:(L,D,p)=>{"use strict";var S=p(1916).longestPath,O=p(6632),w=p(3804);L.exports=function R(T){switch(T.graph().ranker){case"network-simplex":default:!function m(T){w(T)}(T);break;case"tight-tree":!function y(T){S(T),O(T)}(T);break;case"longest-path":f(T)}};var f=S},3804:(L,D,p)=>{"use strict";var E=p(5760),S=p(6632),O=p(1916).slack,w=p(1916).longestPath,R=p(6456).alg.preorder,f=p(6456).alg.postorder,y=p(1510).simplify;function m(ne){ne=y(ne),w(ne);var ge,se=S(ne);for(v(se),T(se,ne);ge=_(se);)B(se,ne,ge,x(se,ne,ge))}function T(ne,se){var ge=f(ne,ne.nodes());ge=ge.slice(0,ge.length-1),E.forEach(ge,function(ce){!function g(ne,se,ge){var ce=ne.node(ge);ne.edge(ge,ce.parent).cutvalue=C(ne,se,ge)}(ne,se,ce)})}function C(ne,se,ge){var me=ne.node(ge).parent,Q=!0,te=se.edge(ge,me),j=0;return te||(Q=!1,te=se.edge(me,ge)),j=te.weight,E.forEach(se.nodeEdges(ge),function($){var J=$.v===ge,ae=J?$.w:$.v;if(ae!==me){var Ee=J===Q,re=se.edge($).weight;if(j+=Ee?re:-re,function K(ne,se,ge){return ne.hasEdge(se,ge)}(ne,ge,ae)){var ee=ne.edge(ge,ae).cutvalue;j+=Ee?-ee:ee}}}),j}function v(ne,se){arguments.length<2&&(se=ne.nodes()[0]),P(ne,{},1,se)}function P(ne,se,ge,ce,me){var Q=ge,te=ne.node(ce);return se[ce]=!0,E.forEach(ne.neighbors(ce),function(j){E.has(se,j)||(ge=P(ne,se,ge,j,ce))}),te.low=Q,te.lim=ge++,me?te.parent=me:delete te.parent,ge}function _(ne){return E.find(ne.edges(),function(se){return ne.edge(se).cutvalue<0})}function x(ne,se,ge){var ce=ge.v,me=ge.w;se.hasEdge(ce,me)||(ce=ge.w,me=ge.v);var Q=ne.node(ce),te=ne.node(me),j=Q,$=!1;Q.lim>te.lim&&(j=te,$=!0);var J=E.filter(se.edges(),function(ae){return $===V(0,ne.node(ae.v),j)&&$!==V(0,ne.node(ae.w),j)});return E.minBy(J,function(ae){return O(se,ae)})}function B(ne,se,ge,ce){ne.removeEdge(ge.v,ge.w),ne.setEdge(ce.v,ce.w,{}),v(ne),T(ne,se),function H(ne,se){var ge=E.find(ne.nodes(),function(me){return!se.node(me).parent}),ce=R(ne,ge);ce=ce.slice(1),E.forEach(ce,function(me){var Q=ne.node(me).parent,te=se.edge(me,Q),j=!1;te||(te=se.edge(Q,me),j=!0),se.node(me).rank=se.node(Q).rank+(j?te.minlen:-te.minlen)})}(ne,se)}function V(ne,se,ge){return ge.low<=se.lim&&se.lim<=ge.lim}L.exports=m,m.initLowLimValues=v,m.initCutValues=T,m.calcCutValue=C,m.leaveEdge=_,m.enterEdge=x,m.exchangeEdges=B},1916:(L,D,p)=>{"use strict";var E=p(5760);L.exports={longestPath:function S(w){var R={};E.forEach(w.sources(),function f(y){var m=w.node(y);if(E.has(R,y))return m.rank;R[y]=!0;var T=E.min(E.map(w.outEdges(y),function(g){return f(g.w)-w.edge(g).minlen}));return(T===Number.POSITIVE_INFINITY||null==T)&&(T=0),m.rank=T})},slack:function O(w,R){return w.node(R.w).rank-w.node(R.v).rank-w.edge(R).minlen}}},1510:(L,D,p)=>{"use strict";var E=p(5760),S=p(6456).Graph;function O(H,K,V,ne){var se;do{se=E.uniqueId(ne)}while(H.hasNode(se));return V.dummy=K,H.setNode(se,V),se}function P(H){return E.max(E.map(H.nodes(),function(K){var V=H.node(K).rank;if(!E.isUndefined(V))return V}))}L.exports={addDummyNode:O,simplify:function w(H){var K=(new S).setGraph(H.graph());return E.forEach(H.nodes(),function(V){K.setNode(V,H.node(V))}),E.forEach(H.edges(),function(V){var ne=K.edge(V.v,V.w)||{weight:0,minlen:1},se=H.edge(V);K.setEdge(V.v,V.w,{weight:ne.weight+se.weight,minlen:Math.max(ne.minlen,se.minlen)})}),K},asNonCompoundGraph:function R(H){var K=new S({multigraph:H.isMultigraph()}).setGraph(H.graph());return E.forEach(H.nodes(),function(V){H.children(V).length||K.setNode(V,H.node(V))}),E.forEach(H.edges(),function(V){K.setEdge(V,H.edge(V))}),K},successorWeights:function f(H){var K=E.map(H.nodes(),function(V){var ne={};return E.forEach(H.outEdges(V),function(se){ne[se.w]=(ne[se.w]||0)+H.edge(se).weight}),ne});return E.zipObject(H.nodes(),K)},predecessorWeights:function y(H){var K=E.map(H.nodes(),function(V){var ne={};return E.forEach(H.inEdges(V),function(se){ne[se.v]=(ne[se.v]||0)+H.edge(se).weight}),ne});return E.zipObject(H.nodes(),K)},intersectRect:function m(H,K){var Q,te,V=H.x,ne=H.y,se=K.x-V,ge=K.y-ne,ce=H.width/2,me=H.height/2;if(!se&&!ge)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(ge)*ce>Math.abs(se)*me?(ge<0&&(me=-me),Q=me*se/ge,te=me):(se<0&&(ce=-ce),Q=ce,te=ce*ge/se),{x:V+Q,y:ne+te}},buildLayerMatrix:function T(H){var K=E.map(E.range(P(H)+1),function(){return[]});return E.forEach(H.nodes(),function(V){var ne=H.node(V),se=ne.rank;E.isUndefined(se)||(K[se][ne.order]=V)}),K},normalizeRanks:function g(H){var K=E.min(E.map(H.nodes(),function(V){return H.node(V).rank}));E.forEach(H.nodes(),function(V){var ne=H.node(V);E.has(ne,"rank")&&(ne.rank-=K)})},removeEmptyRanks:function C(H){var K=E.min(E.map(H.nodes(),function(ge){return H.node(ge).rank})),V=[];E.forEach(H.nodes(),function(ge){var ce=H.node(ge).rank-K;V[ce]||(V[ce]=[]),V[ce].push(ge)});var ne=0,se=H.graph().nodeRankFactor;E.forEach(V,function(ge,ce){E.isUndefined(ge)&&ce%se!=0?--ne:ne&&E.forEach(ge,function(me){H.node(me).rank+=ne})})},addBorderNode:function v(H,K,V,ne){var se={width:0,height:0};return arguments.length>=4&&(se.rank=V,se.order=ne),O(H,"border",se,K)},maxRank:P,partition:function _(H,K){var V={lhs:[],rhs:[]};return E.forEach(H,function(ne){K(ne)?V.lhs.push(ne):V.rhs.push(ne)}),V},time:function x(H,K){var V=E.now();try{return K()}finally{console.log(H+" time: "+(E.now()-V)+"ms")}},notime:function B(H,K){return K()}}},8126:L=>{L.exports="0.8.5"},3525:(L,D,p)=>{var E=p(6183),S=p(8840),O=p(8920),w=p(4209);L.exports={graphlib:p(8823),read:E,readMany:S,write:O,version:w,type:"dot",buffer:!1}},4674:(L,D,p)=>{"use strict";var E=p(7317),S=p(8823).Graph;function w(P,_,x,B){switch(_.type){case"node":!function R(P,_,x,B){var H=_.id,K=_.attrs;C(P,H,x,B),E.merge(P.node(H),K)}(P,_,x,B);break;case"edge":!function f(P,_,x,B){var K,V,H=_.attrs;E.each(_.elems,function(ne){switch(w(P,ne,x,B),ne.type){case"node":V=[ne.id];break;case"subgraph":V=function v(P){var B,_={},x=[],H=x.push.bind(x);for(H(P);x.length;)switch(B=x.pop(),B.type){case"node":_[B.id]=!0;break;case"edge":E.each(B.elems,H);break;case"subgraph":E.each(B.stmts,H)}return E.keys(_)}(ne)}E.each(K,function(se){E.each(V,function(ge){var ce;P.hasEdge(se,ge)&&P.isMultigraph()&&(ce=E.uniqueId("edge")),P.hasEdge(se,ge,ce)||P.setEdge(se,ge,E.clone(E.last(x).edge),ce),E.merge(P.edge(se,ge,ce),H)})}),K=V})}(P,_,x,B);break;case"subgraph":!function y(P,_,x,B){var H=_.id;void 0===H&&(H=function g(P){var _;do{_=E.uniqueId("sg")}while(P.hasNode(_));return _}(P)),x.push(E.clone(E.last(x))),C(P,H,x,B),E.each(_.stmts,function(K){w(P,K,x,H)}),P.children(H).length||P.removeNode(H),x.pop()}(P,_,x,B);break;case"attr":!function m(P,_,x){E.merge(E.last(x)[_.attrType],_.attrs)}(0,_,x);break;case"inlineAttr":!function T(P,_,x,B){E.merge(B?P.node(B):P.graph(),_.attrs)}(P,_,0,B)}}function C(P,_,x,B){P.hasNode(_)||(P.setNode(_,E.clone(E.last(x).node)),P.setParent(_,B))}L.exports=function O(P){var B=[{node:{},edge:{}}],H=P.id,K=new S({directed:"graph"!==P.type,multigraph:!P.strict,compound:!0});return K.setGraph(null===H?{}:{id:H}),E.each(P.stmts,function(V){w(K,V,B)}),K}},5393:(L,D,p)=>{L.exports=function(){function S(w,R,f,y,m,T){this.message=w,this.expected=R,this.found=f,this.offset=y,this.line=m,this.column=T,this.name="SyntaxError"}return function E(w,R){function f(){this.constructor=w}f.prototype=R.prototype,w.prototype=new f}(S,Error),{SyntaxError:S,parse:function O(w){var xl,R=arguments.length>1?arguments[1]:{},f={},y={start:Ug,graphStmt:Ku},m=Ug,g=f,C=null,v="{",P={type:"literal",value:"{",description:'"{"'},_="}",x={type:"literal",value:"}",description:'"}"'},B=function(Y,ue,Re,oe){return{type:ue,id:Re,strict:null!==Y,stmts:oe}},H=";",K={type:"literal",value:";",description:'";"'},V=function(Y,ue){for(var Re=[Y],oe=0;oe<ue.length;++oe)Re.push(ue[oe][1]);return Re},ne=function(Y,ue){return{type:"attr",attrType:Y,attrs:ue||{}}},se="=",ge={type:"literal",value:"=",description:'"="'},ce=function(Y,ue){var Re={};return Re[Y]=ue,{type:"inlineAttr",attrs:Re}},me=function(Y,ue){return{type:"node",id:Y,attrs:ue||{}}},Q=function(Y,ue,Re){for(var oe=[Y],Pe=0;Pe<ue.length;++Pe)oe.push(ue[Pe]);return{type:"edge",elems:oe,attrs:Re||{}}},te=function(Y,ue){return{type:"subgraph",id:(Y=Y&&Y[2]||[])[0],stmts:ue}},j=function(Y,ue){for(var Re=Y,oe=0;oe<ue.length;++oe)vr.merge(Re,ue[oe][1]);return Re},$="[",J={type:"literal",value:"[",description:'"["'},ae="]",Ee={type:"literal",value:"]",description:'"]"'},re=function(Y){return Y},ee=",",Ae={type:"literal",value:",",description:'","'},De=function(Y,ue){for(var Re=Y,oe=0;oe<ue.length;++oe)vr.merge(Re,ue[oe][3]);return Re},Ne="--",Le={type:"literal",value:"--",description:'"--"'},ke=function(){return bs},je=void 0,ft="->",Se={type:"literal",value:"->",description:'"->"'},Ie=function(Y,ue){var Re=[Y];if(ue)for(var oe=0;oe<ue.length;++oe)Re.push(ue[oe]);return Re},_e=function(Y,ue){var Re={};return Re[Y]=ue[3],Re},Oe=function(Y){return{type:"node",id:Y,attrs:{}}},Ye=function(Y){return Y},et=":",mt={type:"literal",value:":",description:'":"'},kt="ne",Br={type:"literal",value:"ne",description:'"ne"'},dn="se",Hn={type:"literal",value:"se",description:'"se"'},nn="sw",fr={type:"literal",value:"sw",description:'"sw"'},Xt="nw",js={type:"literal",value:"nw",description:'"nw"'},xi="n",Li={type:"literal",value:"n",description:'"n"'},zs="e",Mi={type:"literal",value:"e",description:'"e"'},Yn="s",vs={type:"literal",value:"s",description:'"s"'},Ol="w",ta={type:"literal",value:"w",description:'"w"'},Co="c",Ss={type:"literal",value:"c",description:'"c"'},Il="_",Pl={type:"literal",value:"_",description:'"_"'},bc={type:"other",description:"identifier"},Nl=/^[a-zA-Z\u0200-\u0377_]/,Xr={type:"class",value:"[a-zA-Z\\u0200-\\u0377_]",description:"[a-zA-Z\\u0200-\\u0377_]"},vi=/^[a-zA-Z\u0200-\u0377_0-9]/,_l={type:"class",value:"[a-zA-Z\\u0200-\\u0377_0-9]",description:"[a-zA-Z\\u0200-\\u0377_0-9]"},Cc=function(Y,ue){return Y+ue.join("")},Vu="-",vd={type:"literal",value:"-",description:'"-"'},Hu=".",Rc={type:"literal",value:".",description:'"."'},Ro=/^[0-9]/,na={type:"class",value:"[0-9]",description:"[0-9]"},Si=function(Y,ue,Re){return(Y||"")+ue+Re.join("")},Mg=function(Y,ue,Re){return(Y||"")+ue.join("")+(Re?Re[0]:"")+(Re?Re[1].join(""):"")},Sd='"',Yu={type:"literal",value:'"',description:'"\\""'},Tc='\\"',Uu={type:"literal",value:'\\"',description:'"\\\\\\""'},Ad=function(){return'"'},Oc="\\",As={type:"literal",value:"\\",description:'"\\\\"'},Ua=/^[^"]/,Bn={type:"class",value:'[^"]',description:'[^"]'},Wa=function(Y){return"\\"+Y},$s=function(Y){return Y.join("")},yE="node",Fg={type:"literal",value:"node",description:'"node"'},ra=function(Y){return Y.toLowerCase()},Wu="edge",bd={type:"literal",value:"edge",description:'"edge"'},ja="graph",Bg={type:"literal",value:"graph",description:'"graph"'},Cd="digraph",Rd={type:"literal",value:"digraph",description:'"digraph"'},kg="subgraph",Gg={type:"literal",value:"subgraph",description:'"subgraph"'},Vg="strict",Ic={type:"literal",value:"strict",description:'"strict"'},Td=function(Y){return bs="digraph"===Y,Y},Pc={type:"other",description:"whitespace"},Od=/^[ \t\r\n]/,gr={type:"class",value:"[ \\t\\r\\n]",description:"[ \\t\\r\\n]"},Id={type:"other",description:"comment"},Ai="//",ju={type:"literal",value:"//",description:'"//"'},Dl=/^[^\n]/,An={type:"class",value:"[^\\n]",description:"[^\\n]"},Nc="/*",pn={type:"literal",value:"/*",description:'"/*"'},To="*/",_c={type:"literal",value:"*/",description:'"*/"'},ia={type:"any",description:"any character"},z=0,Dc=0,ot={line:1,column:1,seenCR:!1},Ks=0,bt=[],ze=0;if("startRule"in R){if(!(R.startRule in y))throw new Error("Can't start parsing from rule \""+R.startRule+'".');m=y[R.startRule]}function sa(Y){return Dc!==Y&&(Dc>Y&&(Dc=0,ot={line:1,column:1,seenCR:!1}),function ue(Re,oe,Pe){var Ce,it;for(Ce=oe;Ce<Pe;Ce++)"\n"===(it=w.charAt(Ce))?(Re.seenCR||Re.line++,Re.column=1,Re.seenCR=!1):"\r"===it||"\u2028"===it||"\u2029"===it?(Re.line++,Re.column=1,Re.seenCR=!0):(Re.column++,Re.seenCR=!1)}(ot,Dc,Y),Dc=Y),ot}function qe(Y){z<Ks||(z>Ks&&(Ks=z,bt=[]),bt.push(Y))}function $u(Y,ue,Re){var Ce=sa(Re),it=Re<w.length?w.charAt(Re):null;return null!==ue&&function oe(ut){var dt=1;for(ut.sort(function(Zt,Wn){return Zt.description<Wn.description?-1:Zt.description>Wn.description?1:0});dt<ut.length;)ut[dt-1]===ut[dt]?ut.splice(dt,1):dt++}(ue),new S(null!==Y?Y:function Pe(ut,dt){var Ri,Wn=new Array(ut.length);for(Ri=0;Ri<ut.length;Ri++)Wn[Ri]=ut[Ri].description;return"Expected "+(ut.length>1?Wn.slice(0,-1).join(", ")+" or "+Wn[ut.length-1]:Wn[0])+" but "+(dt?'"'+function Zt(Bc){function Zr(Ti){return Ti.charCodeAt(0).toString(16).toUpperCase()}return Bc.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(Ti){return"\\x0"+Zr(Ti)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(Ti){return"\\x"+Zr(Ti)}).replace(/[\u0180-\u0FFF]/g,function(Ti){return"\\u0"+Zr(Ti)}).replace(/[\u1080-\uFFFF]/g,function(Ti){return"\\u"+Zr(Ti)})}(dt)+'"':"end of input")+" found."}(ue,it),ue,it,Re,Ce.line,Ce.column)}function Ug(){var Y,ue;if(Y=[],(ue=Ku())!==f)for(;ue!==f;)Y.push(ue),ue=Ku();else Y=g;return Y}function Ku(){var Y,ue,Re,oe,Pe,Ce,it,ut,dt,Zt,Wn,kr,Dt,Ri;for(Y=z,ue=[],Re=Ze();Re!==f;)ue.push(Re),Re=Ze();if(ue!==f)if(Re=z,(oe=It())!==f&&(Pe=Ze())!==f?Re=oe=[oe,Pe]:(z=Re,Re=g),Re===f&&(Re=C),Re!==f)if((oe=Ju())!==f){for(Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();if(Pe!==f)if((Ce=Oo())===f&&(Ce=C),Ce!==f){for(it=[],ut=Ze();ut!==f;)it.push(ut),ut=Ze();if(it!==f)if(123===w.charCodeAt(z)?(ut=v,z++):(ut=f,0===ze&&qe(P)),ut!==f){for(dt=[],Zt=Ze();Zt!==f;)dt.push(Zt),Zt=Ze();if(dt!==f)if((Zt=Nd())===f&&(Zt=C),Zt!==f){for(Wn=[],kr=Ze();kr!==f;)Wn.push(kr),kr=Ze();if(Wn!==f)if(125===w.charCodeAt(z)?(kr=_,z++):(kr=f,0===ze&&qe(x)),kr!==f){for(Dt=[],Ri=Ze();Ri!==f;)Dt.push(Ri),Ri=Ze();Dt!==f?Y=ue=B(Re,oe,Ce,Zt):(z=Y,Y=g)}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;else z=Y,Y=g;else z=Y,Y=g;return Y}function Nd(){var Y,ue,Re,oe,Pe,Ce,it,ut,dt,Zt;if(Y=z,(ue=xc())!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();if(Re!==f)if(59===w.charCodeAt(z)?(oe=H,z++):(oe=f,0===ze&&qe(K)),oe===f&&(oe=C),oe!==f){for(Pe=[],Ce=z,it=[],ut=Ze();ut!==f;)it.push(ut),ut=Ze();if(it!==f)if((ut=xc())!==f){for(dt=[],Zt=Ze();Zt!==f;)dt.push(Zt),Zt=Ze();dt!==f?(59===w.charCodeAt(z)?(Zt=H,z++):(Zt=f,0===ze&&qe(K)),Zt===f&&(Zt=C),Zt!==f?Ce=it=[it,ut,dt,Zt]:(z=Ce,Ce=g)):(z=Ce,Ce=g)}else z=Ce,Ce=g;else z=Ce,Ce=g;for(;Ce!==f;){for(Pe.push(Ce),Ce=z,it=[],ut=Ze();ut!==f;)it.push(ut),ut=Ze();if(it!==f)if((ut=xc())!==f){for(dt=[],Zt=Ze();Zt!==f;)dt.push(Zt),Zt=Ze();dt!==f?(59===w.charCodeAt(z)?(Zt=H,z++):(Zt=f,0===ze&&qe(K)),Zt===f&&(Zt=C),Zt!==f?Ce=it=[it,ut,dt,Zt]:(z=Ce,Ce=g)):(z=Ce,Ce=g)}else z=Ce,Ce=g;else z=Ce,Ce=g}Pe!==f?Y=ue=V(ue,Pe):(z=Y,Y=g)}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;return Y}function xc(){var Y;return(Y=Wg())===f&&(Y=Ci())===f&&(Y=Rn())===f&&(Y=jg())===f&&(Y=wE()),Y}function Wg(){var Y,ue,Re,oe;if(Y=z,(ue=Fc())===f&&(ue=Pn())===f&&(ue=mn()),ue!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();Re!==f&&(oe=_d())!==f?Y=ue=ne(ue,oe):(z=Y,Y=g)}else z=Y,Y=g;return Y}function jg(){var Y,ue,Re,oe,Pe,Ce;if(Y=z,(ue=Oo())!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();if(Re!==f)if(61===w.charCodeAt(z)?(oe=se,z++):(oe=f,0===ze&&qe(ge)),oe!==f){for(Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();Pe!==f&&(Ce=Oo())!==f?Y=ue=ce(ue,Ce):(z=Y,Y=g)}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;return Y}function wE(){var Y,ue,Re,oe;if(Y=z,(ue=Mc())!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();Re!==f?((oe=_d())===f&&(oe=C),oe!==f?Y=ue=me(ue,oe):(z=Y,Y=g)):(z=Y,Y=g)}else z=Y,Y=g;return Y}function Ci(){var Y,ue,Re,oe,Pe,Ce;if(Y=z,(ue=Un())!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();if(Re!==f)if((oe=gt())!==f){for(Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();Pe!==f?((Ce=_d())===f&&(Ce=C),Ce!==f?Y=ue=Q(ue,oe,Ce):(z=Y,Y=g)):(z=Y,Y=g)}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;return Y}function Rn(){var Y,ue,Re,oe,Pe,Ce,it,ut;if(Y=z,ue=z,(Re=$g())!==f){for(oe=[],Pe=Ze();Pe!==f;)oe.push(Pe),Pe=Ze();if(oe!==f){if(Pe=z,(Ce=Oo())!==f){for(it=[],ut=Ze();ut!==f;)it.push(ut),ut=Ze();it!==f?Pe=Ce=[Ce,it]:(z=Pe,Pe=g)}else z=Pe,Pe=g;Pe===f&&(Pe=C),Pe!==f?ue=Re=[Re,oe,Pe]:(z=ue,ue=g)}else z=ue,ue=g}else z=ue,ue=g;if(ue===f&&(ue=C),ue!==f)if(123===w.charCodeAt(z)?(Re=v,z++):(Re=f,0===ze&&qe(P)),Re!==f){for(oe=[],Pe=Ze();Pe!==f;)oe.push(Pe),Pe=Ze();if(oe!==f)if((Pe=Nd())===f&&(Pe=C),Pe!==f){for(Ce=[],it=Ze();it!==f;)Ce.push(it),it=Ze();Ce!==f?(125===w.charCodeAt(z)?(it=_,z++):(it=f,0===ze&&qe(x)),it!==f?Y=ue=te(ue,Pe):(z=Y,Y=g)):(z=Y,Y=g)}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;else z=Y,Y=g;return Y}function _d(){var Y,ue,Re,oe,Pe,Ce;if(Y=z,(ue=Dd())!==f){for(Re=[],oe=z,Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();for(Pe!==f&&(Ce=Dd())!==f?oe=Pe=[Pe,Ce]:(z=oe,oe=g);oe!==f;){for(Re.push(oe),oe=z,Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();Pe!==f&&(Ce=Dd())!==f?oe=Pe=[Pe,Ce]:(z=oe,oe=g)}Re!==f?Y=ue=j(ue,Re):(z=Y,Y=g)}else z=Y,Y=g;return Y}function Dd(){var Y,ue,Re,oe,Pe,Ce;if(Y=z,91===w.charCodeAt(z)?(ue=$,z++):(ue=f,0===ze&&qe(J)),ue!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();if(Re!==f)if((oe=vE())===f&&(oe=C),oe!==f){for(Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();Pe!==f?(93===w.charCodeAt(z)?(Ce=ae,z++):(Ce=f,0===ze&&qe(Ee)),Ce!==f?Y=ue=re(oe):(z=Y,Y=g)):(z=Y,Y=g)}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;return Y}function vE(){var Y,ue,Re,oe,Pe,Ce,it,ut;if(Y=z,(ue=Lc())!==f){for(Re=[],oe=z,Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();if(Pe!==f)if(44===w.charCodeAt(z)?(Ce=ee,z++):(Ce=f,0===ze&&qe(Ae)),Ce===f&&(Ce=C),Ce!==f){for(it=[],ut=Ze();ut!==f;)it.push(ut),ut=Ze();it!==f&&(ut=Lc())!==f?oe=Pe=[Pe,Ce,it,ut]:(z=oe,oe=g)}else z=oe,oe=g;else z=oe,oe=g;for(;oe!==f;){for(Re.push(oe),oe=z,Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();if(Pe!==f)if(44===w.charCodeAt(z)?(Ce=ee,z++):(Ce=f,0===ze&&qe(Ae)),Ce===f&&(Ce=C),Ce!==f){for(it=[],ut=Ze();ut!==f;)it.push(ut),ut=Ze();it!==f&&(ut=Lc())!==f?oe=Pe=[Pe,Ce,it,ut]:(z=oe,oe=g)}else z=oe,oe=g;else z=oe,oe=g}Re!==f?Y=ue=De(ue,Re):(z=Y,Y=g)}else z=Y,Y=g;return Y}function gt(){var Y,ue,Re,oe,Pe,Ce;if(Y=z,ue=z,w.substr(z,2)===Ne?(Re=Ne,z+=2):(Re=f,0===ze&&qe(Le)),Re!==f&&(oe=(oe=ke())?g:je)!==f?ue=Re=[Re,oe]:(z=ue,ue=g),ue===f&&(ue=z,w.substr(z,2)===ft?(Re=ft,z+=2):(Re=f,0===ze&&qe(Se)),Re!==f&&(oe=(oe=ke())?je:g)!==f?ue=Re=[Re,oe]:(z=ue,ue=g)),ue!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();if(Re!==f)if((oe=Un())!==f){for(Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();Pe!==f?((Ce=gt())===f&&(Ce=C),Ce!==f?Y=ue=Ie(oe,Ce):(z=Y,Y=g)):(z=Y,Y=g)}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;return Y}function Lc(){var Y,ue,Re,oe,Pe,Ce,it;if(Y=z,(ue=Oo())!==f){for(Re=z,oe=[],Pe=Ze();Pe!==f;)oe.push(Pe),Pe=Ze();if(oe!==f)if(61===w.charCodeAt(z)?(Pe=se,z++):(Pe=f,0===ze&&qe(ge)),Pe!==f){for(Ce=[],it=Ze();it!==f;)Ce.push(it),it=Ze();Ce!==f&&(it=Oo())!==f?Re=oe=[oe,Pe,Ce,it]:(z=Re,Re=g)}else z=Re,Re=g;else z=Re,Re=g;Re===f&&(Re=C),Re!==f?Y=ue=_e(ue,Re):(z=Y,Y=g)}else z=Y,Y=g;return Y}function Un(){var Y,ue;return(Y=Rn())===f&&(Y=z,(ue=Mc())!==f&&(ue=Oe(ue)),Y=ue),Y}function Mc(){var Y,ue,Re,oe;if(Y=z,(ue=Oo())!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();Re!==f?((oe=xd())===f&&(oe=C),oe!==f?Y=ue=Ye(ue):(z=Y,Y=g)):(z=Y,Y=g)}else z=Y,Y=g;return Y}function xd(){var Y,ue,Re,oe,Pe,Ce,it,ut,dt;if(Y=z,58===w.charCodeAt(z)?(ue=et,z++):(ue=f,0===ze&&qe(mt)),ue!==f){for(Re=[],oe=Ze();oe!==f;)Re.push(oe),oe=Ze();if(Re!==f)if((oe=Oo())!==f){for(Pe=[],Ce=Ze();Ce!==f;)Pe.push(Ce),Ce=Ze();if(Pe!==f){if(Ce=z,58===w.charCodeAt(z)?(it=et,z++):(it=f,0===ze&&qe(mt)),it!==f){for(ut=[],dt=Ze();dt!==f;)ut.push(dt),dt=Ze();ut!==f&&(dt=zg())!==f?Ce=it=[it,ut,dt]:(z=Ce,Ce=g)}else z=Ce,Ce=g;Ce===f&&(Ce=C),Ce!==f?Y=ue=[ue,Re,oe,Pe,Ce]:(z=Y,Y=g)}else z=Y,Y=g}else z=Y,Y=g;else z=Y,Y=g}else z=Y,Y=g;return Y}function zg(){var Y;return w.substr(z,2)===kt?(Y=kt,z+=2):(Y=f,0===ze&&qe(Br)),Y===f&&(w.substr(z,2)===dn?(Y=dn,z+=2):(Y=f,0===ze&&qe(Hn)),Y===f&&(w.substr(z,2)===nn?(Y=nn,z+=2):(Y=f,0===ze&&qe(fr)),Y===f&&(w.substr(z,2)===Xt?(Y=Xt,z+=2):(Y=f,0===ze&&qe(js)),Y===f&&(110===w.charCodeAt(z)?(Y=xi,z++):(Y=f,0===ze&&qe(Li)),Y===f&&(101===w.charCodeAt(z)?(Y=zs,z++):(Y=f,0===ze&&qe(Mi)),Y===f&&(115===w.charCodeAt(z)?(Y=Yn,z++):(Y=f,0===ze&&qe(vs)),Y===f&&(119===w.charCodeAt(z)?(Y=Ol,z++):(Y=f,0===ze&&qe(ta)),Y===f&&(99===w.charCodeAt(z)?(Y=Co,z++):(Y=f,0===ze&&qe(Ss)),Y===f&&(95===w.charCodeAt(z)?(Y=Il,z++):(Y=f,0===ze&&qe(Pl))))))))))),Y}function Oo(){var Y,ue,Re,oe,Pe,Ce,it;if(ze++,Y=z,Nl.test(w.charAt(z))?(ue=w.charAt(z),z++):(ue=f,0===ze&&qe(Xr)),ue!==f){for(Re=[],vi.test(w.charAt(z))?(oe=w.charAt(z),z++):(oe=f,0===ze&&qe(_l));oe!==f;)Re.push(oe),vi.test(w.charAt(z))?(oe=w.charAt(z),z++):(oe=f,0===ze&&qe(_l));Re!==f?Y=ue=Cc(ue,Re):(z=Y,Y=g)}else z=Y,Y=g;if(Y===f){if(Y=z,45===w.charCodeAt(z)?(ue=Vu,z++):(ue=f,0===ze&&qe(vd)),ue===f&&(ue=C),ue!==f)if(46===w.charCodeAt(z)?(Re=Hu,z++):(Re=f,0===ze&&qe(Rc)),Re!==f){if(oe=[],Ro.test(w.charAt(z))?(Pe=w.charAt(z),z++):(Pe=f,0===ze&&qe(na)),Pe!==f)for(;Pe!==f;)oe.push(Pe),Ro.test(w.charAt(z))?(Pe=w.charAt(z),z++):(Pe=f,0===ze&&qe(na));else oe=g;oe!==f?Y=ue=Si(ue,Re,oe):(z=Y,Y=g)}else z=Y,Y=g;else z=Y,Y=g;if(Y===f){if(Y=z,45===w.charCodeAt(z)?(ue=Vu,z++):(ue=f,0===ze&&qe(vd)),ue===f&&(ue=C),ue!==f){if(Re=[],Ro.test(w.charAt(z))?(oe=w.charAt(z),z++):(oe=f,0===ze&&qe(na)),oe!==f)for(;oe!==f;)Re.push(oe),Ro.test(w.charAt(z))?(oe=w.charAt(z),z++):(oe=f,0===ze&&qe(na));else Re=g;if(Re!==f){if(oe=z,46===w.charCodeAt(z)?(Pe=Hu,z++):(Pe=f,0===ze&&qe(Rc)),Pe!==f){for(Ce=[],Ro.test(w.charAt(z))?(it=w.charAt(z),z++):(it=f,0===ze&&qe(na));it!==f;)Ce.push(it),Ro.test(w.charAt(z))?(it=w.charAt(z),z++):(it=f,0===ze&&qe(na));Ce!==f?oe=Pe=[Pe,Ce]:(z=oe,oe=g)}else z=oe,oe=g;oe===f&&(oe=C),oe!==f?Y=ue=Mg(ue,Re,oe):(z=Y,Y=g)}else z=Y,Y=g}else z=Y,Y=g;if(Y===f)if(Y=z,34===w.charCodeAt(z)?(ue=Sd,z++):(ue=f,0===ze&&qe(Yu)),ue!==f){for(Re=[],oe=z,w.substr(z,2)===Tc?(Pe=Tc,z+=2):(Pe=f,0===ze&&qe(Uu)),Pe!==f&&(Pe=Ad()),(oe=Pe)===f&&(oe=z,92===w.charCodeAt(z)?(Pe=Oc,z++):(Pe=f,0===ze&&qe(As)),Pe!==f?(Ua.test(w.charAt(z))?(Ce=w.charAt(z),z++):(Ce=f,0===ze&&qe(Bn)),Ce!==f?oe=Pe=Wa(Ce):(z=oe,oe=g)):(z=oe,oe=g),oe===f&&(Ua.test(w.charAt(z))?(oe=w.charAt(z),z++):(oe=f,0===ze&&qe(Bn))));oe!==f;)Re.push(oe),oe=z,w.substr(z,2)===Tc?(Pe=Tc,z+=2):(Pe=f,0===ze&&qe(Uu)),Pe!==f&&(Pe=Ad()),(oe=Pe)===f&&(oe=z,92===w.charCodeAt(z)?(Pe=Oc,z++):(Pe=f,0===ze&&qe(As)),Pe!==f?(Ua.test(w.charAt(z))?(Ce=w.charAt(z),z++):(Ce=f,0===ze&&qe(Bn)),Ce!==f?oe=Pe=Wa(Ce):(z=oe,oe=g)):(z=oe,oe=g),oe===f&&(Ua.test(w.charAt(z))?(oe=w.charAt(z),z++):(oe=f,0===ze&&qe(Bn))));Re!==f?(34===w.charCodeAt(z)?(oe=Sd,z++):(oe=f,0===ze&&qe(Yu)),oe!==f?Y=ue=$s(Re):(z=Y,Y=g)):(z=Y,Y=g)}else z=Y,Y=g}}return ze--,Y===f&&(ue=f,0===ze&&qe(bc)),Y}function Pn(){var ue;return z,w.substr(z,4).toLowerCase()===yE?(ue=w.substr(z,4),z+=4):(ue=f,0===ze&&qe(Fg)),ue!==f&&(ue=ra(ue)),ue}function mn(){var ue;return z,w.substr(z,4).toLowerCase()===Wu?(ue=w.substr(z,4),z+=4):(ue=f,0===ze&&qe(bd)),ue!==f&&(ue=ra(ue)),ue}function Fc(){var ue;return z,w.substr(z,5).toLowerCase()===ja?(ue=w.substr(z,5),z+=5):(ue=f,0===ze&&qe(Bg)),ue!==f&&(ue=ra(ue)),ue}function Ld(){var ue;return z,w.substr(z,7).toLowerCase()===Cd?(ue=w.substr(z,7),z+=7):(ue=f,0===ze&&qe(Rd)),ue!==f&&(ue=ra(ue)),ue}function $g(){var ue;return z,w.substr(z,8).toLowerCase()===kg?(ue=w.substr(z,8),z+=8):(ue=f,0===ze&&qe(Gg)),ue!==f&&(ue=ra(ue)),ue}function It(){var ue;return z,w.substr(z,6).toLowerCase()===Vg?(ue=w.substr(z,6),z+=6):(ue=f,0===ze&&qe(Ic)),ue!==f&&(ue=ra(ue)),ue}function Ju(){var Y,ue;return(Y=Fc())===f&&(Y=z,(ue=Ld())!==f&&(ue=Td(ue)),Y=ue),Y}function Kg(){var Y,ue;if(ze++,Y=[],Od.test(w.charAt(z))?(ue=w.charAt(z),z++):(ue=f,0===ze&&qe(gr)),ue!==f)for(;ue!==f;)Y.push(ue),Od.test(w.charAt(z))?(ue=w.charAt(z),z++):(ue=f,0===ze&&qe(gr));else Y=g;return ze--,Y===f&&(ue=f,0===ze&&qe(Pc)),Y}function Js(){var Y,ue,Re,oe,Pe,Ce;if(ze++,Y=z,w.substr(z,2)===Ai?(ue=Ai,z+=2):(ue=f,0===ze&&qe(ju)),ue!==f){for(Re=[],Dl.test(w.charAt(z))?(oe=w.charAt(z),z++):(oe=f,0===ze&&qe(An));oe!==f;)Re.push(oe),Dl.test(w.charAt(z))?(oe=w.charAt(z),z++):(oe=f,0===ze&&qe(An));Re!==f?Y=ue=[ue,Re]:(z=Y,Y=g)}else z=Y,Y=g;if(Y===f)if(Y=z,w.substr(z,2)===Nc?(ue=Nc,z+=2):(ue=f,0===ze&&qe(pn)),ue!==f){for(Re=[],oe=z,Pe=z,ze++,w.substr(z,2)===To?(Ce=To,z+=2):(Ce=f,0===ze&&qe(_c)),ze--,Ce===f?Pe=je:(z=Pe,Pe=g),Pe!==f?(w.length>z?(Ce=w.charAt(z),z++):(Ce=f,0===ze&&qe(ia)),Ce!==f?oe=Pe=[Pe,Ce]:(z=oe,oe=g)):(z=oe,oe=g);oe!==f;)Re.push(oe),oe=z,Pe=z,ze++,w.substr(z,2)===To?(Ce=To,z+=2):(Ce=f,0===ze&&qe(_c)),ze--,Ce===f?Pe=je:(z=Pe,Pe=g),Pe!==f?(w.length>z?(Ce=w.charAt(z),z++):(Ce=f,0===ze&&qe(ia)),Ce!==f?oe=Pe=[Pe,Ce]:(z=oe,oe=g)):(z=oe,oe=g);Re!==f?(w.substr(z,2)===To?(oe=To,z+=2):(oe=f,0===ze&&qe(_c)),oe!==f?Y=ue=[ue,Re,oe]:(z=Y,Y=g)):(z=Y,Y=g)}else z=Y,Y=g;return ze--,Y===f&&(ue=f,0===ze&&qe(Id)),Y}function Ze(){var Y;return(Y=Kg())===f&&(Y=Js()),Y}var bs,vr=p(7317);if((xl=m())!==f&&z===w.length)return xl;throw xl!==f&&z<w.length&&qe({type:"end",description:"end of input"}),$u(null,bt,Ks)}}}()},8823:(L,D,p)=>{var E;try{E=p(5510)}catch(S){}E||(E=window.graphlib),L.exports=E},7317:(L,D,p)=>{var E;try{E=p(7489)}catch(S){}E||(E=window._),L.exports=E},8840:(L,D,p)=>{var E=p(7317),S=p(5393),O=p(4674);L.exports=function(R){var f=S.parse(R);return E.map(f,O)}},6183:(L,D,p)=>{var E=p(5393),S=p(4674);L.exports=function(w){var R=E.parse(w,{startRule:"graphStmt"});return S(R)}},4209:L=>{L.exports="0.6.4"},8920:(L,D,p)=>{var E=p(7317);L.exports=function O(g){var C=g.isDirected()?"->":"--",v=new T;g.isMultigraph()||v.write("strict "),v.writeLine((g.isDirected()?"digraph":"graph")+" {"),v.indent();var P=g.graph();return E.isObject(P)&&E.each(P,function(_,x){v.writeLine(m(x)+"="+m(_)+";")}),w(g,void 0,v),g.edges().forEach(function(_){!function f(g,C,v,P){var _=C.v,x=C.w,B=g.edge(C);P.write(m(_)+" "+v+" "+m(x)),y(B,P),P.writeLine()}(g,_,C,v)}),v.unindent(),v.writeLine("}"),v.toString()};var S=/^[a-zA-Z\200-\377_][a-zA-Z\200-\377_0-9]*$/;function w(g,C,v){var P=g.isCompound()?g.children(C):g.nodes();E.each(P,function(_){g.isCompound()&&g.children(_).length?(v.writeLine("subgraph "+m(_)+" {"),v.indent(),E.isObject(g.node(_))&&E.map(g.node(_),function(x,B){v.writeLine(m(B)+"="+m(x)+";")}),w(g,_,v),v.unindent(),v.writeLine("}")):function R(g,C,v){v.write(m(C)),y(g.node(C),v),v.writeLine()}(g,_,v)})}function y(g,C){if(E.isObject(g)){var v=E.map(g,function(P,_){return m(_)+"="+m(P)});v.length&&C.write(" ["+v.join(",")+"]")}}function m(g){return"number"==typeof g||g.toString().match(S)?g:'"'+g.toString().replace(/"/g,'\\"')+'"'}function T(){this._indent="",this._content="",this._shouldIndent=!0}T.prototype.INDENT="  ",T.prototype.indent=function(){this._indent+=this.INDENT},T.prototype.unindent=function(){this._indent=this._indent.slice(this.INDENT.length)},T.prototype.writeLine=function(g){this.write((g||"")+"\n"),this._shouldIndent=!0},T.prototype.write=function(g){this._shouldIndent&&(this._shouldIndent=!1,this._content+=this._indent),this._content+=g},T.prototype.toString=function(){return this._content}},5510:(L,D,p)=>{var E=p(1838);L.exports={Graph:E.Graph,json:p(1088),alg:p(3430),version:E.version}},6730:(L,D,p)=>{var E=p(9138);L.exports=function S(O){var f,w={},R=[];function y(m){E.has(w,m)||(w[m]=!0,f.push(m),E.each(O.successors(m),y),E.each(O.predecessors(m),y))}return E.each(O.nodes(),function(m){f=[],y(m),f.length&&R.push(f)}),R}},2163:(L,D,p)=>{var E=p(9138);function O(w,R,f,y,m,T){E.has(y,R)||(y[R]=!0,f||T.push(R),E.each(m(R),function(g){O(w,g,f,y,m,T)}),f&&T.push(R))}L.exports=function S(w,R,f){E.isArray(R)||(R=[R]);var y=(w.isDirected()?w.successors:w.neighbors).bind(w),m=[],T={};return E.each(R,function(g){if(!w.hasNode(g))throw new Error("Graph does not have node: "+g);O(w,g,"post"===f,T,y,m)}),m}},5668:(L,D,p)=>{var E=p(1718),S=p(9138);L.exports=function O(w,R,f){return S.transform(w.nodes(),function(y,m){y[m]=E(w,m,R,f)},{})}},1718:(L,D,p)=>{var E=p(9138),S=p(1919);L.exports=function w(f,y,m,T){return function R(f,y,m,T){var v,P,g={},C=new S,_=function(x){var B=x.v!==v?x.v:x.w,H=g[B],K=m(x),V=P.distance+K;if(K<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+x+" Weight: "+K);V<H.distance&&(H.distance=V,H.predecessor=v,C.decrease(B,V))};for(f.nodes().forEach(function(x){var B=x===y?0:Number.POSITIVE_INFINITY;g[x]={distance:B},C.add(x,B)});C.size()>0&&(v=C.removeMin(),(P=g[v]).distance!==Number.POSITIVE_INFINITY);)T(v).forEach(_);return g}(f,String(y),m||O,T||function(g){return f.outEdges(g)})};var O=E.constant(1)},9611:(L,D,p)=>{var E=p(9138),S=p(3585);L.exports=function O(w){return E.filter(S(w),function(R){return R.length>1||1===R.length&&w.hasEdge(R[0],R[0])})}},2881:(L,D,p)=>{var E=p(9138);L.exports=function O(R,f,y){return function w(R,f,y){var m={},T=R.nodes();return T.forEach(function(g){m[g]={},m[g][g]={distance:0},T.forEach(function(C){g!==C&&(m[g][C]={distance:Number.POSITIVE_INFINITY})}),y(g).forEach(function(C){var v=C.v===g?C.w:C.v,P=f(C);m[g][v]={distance:P,predecessor:g}})}),T.forEach(function(g){var C=m[g];T.forEach(function(v){var P=m[v];T.forEach(function(_){var B=C[_],H=P[_],K=P[g].distance+B.distance;K<H.distance&&(H.distance=K,H.predecessor=B.predecessor)})})}),m}(R,f||S,y||function(m){return R.outEdges(m)})};var S=E.constant(1)},3430:(L,D,p)=>{L.exports={components:p(6730),dijkstra:p(1718),dijkstraAll:p(5668),findCycles:p(9611),floydWarshall:p(2881),isAcyclic:p(6693),postorder:p(6694),preorder:p(5330),prim:p(6823),tarjan:p(3585),topsort:p(2180)}},6693:(L,D,p)=>{var E=p(2180);L.exports=function S(O){try{E(O)}catch(w){if(w instanceof E.CycleException)return!1;throw w}return!0}},6694:(L,D,p)=>{var E=p(2163);L.exports=function S(O,w){return E(O,w,"post")}},5330:(L,D,p)=>{var E=p(2163);L.exports=function S(O,w){return E(O,w,"pre")}},6823:(L,D,p)=>{var E=p(9138),S=p(6568),O=p(1919);L.exports=function w(R,f){var g,y=new S,m={},T=new O;function C(P){var _=P.v===g?P.w:P.v,x=T.priority(_);if(void 0!==x){var B=f(P);B<x&&(m[_]=g,T.decrease(_,B))}}if(0===R.nodeCount())return y;E.each(R.nodes(),function(P){T.add(P,Number.POSITIVE_INFINITY),y.setNode(P)}),T.decrease(R.nodes()[0],0);for(var v=!1;T.size()>0;){if(g=T.removeMin(),E.has(m,g))y.setEdge(g,m[g]);else{if(v)throw new Error("Input graph is not connected: "+R);v=!0}R.nodeEdges(g).forEach(C)}return y}},3585:(L,D,p)=>{var E=p(9138);L.exports=function S(O){var w=0,R=[],f={},y=[];function m(T){var g=f[T]={onStack:!0,lowlink:w,index:w++};if(R.push(T),O.successors(T).forEach(function(P){E.has(f,P)?f[P].onStack&&(g.lowlink=Math.min(g.lowlink,f[P].index)):(m(P),g.lowlink=Math.min(g.lowlink,f[P].lowlink))}),g.lowlink===g.index){var v,C=[];do{v=R.pop(),f[v].onStack=!1,C.push(v)}while(T!==v);y.push(C)}}return O.nodes().forEach(function(T){E.has(f,T)||m(T)}),y}},2180:(L,D,p)=>{var E=p(9138);function S(w){var R={},f={},y=[];if(E.each(w.sinks(),function m(T){if(E.has(f,T))throw new O;E.has(R,T)||(f[T]=!0,R[T]=!0,E.each(w.predecessors(T),m),delete f[T],y.push(T))}),E.size(R)!==w.nodeCount())throw new O;return y}function O(){}L.exports=S,S.CycleException=O,O.prototype=new Error},1919:(L,D,p)=>{var E=p(9138);function S(){this._arr=[],this._keyIndices={}}L.exports=S,S.prototype.size=function(){return this._arr.length},S.prototype.keys=function(){return this._arr.map(function(O){return O.key})},S.prototype.has=function(O){return E.has(this._keyIndices,O)},S.prototype.priority=function(O){var w=this._keyIndices[O];if(void 0!==w)return this._arr[w].priority},S.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},S.prototype.add=function(O,w){var R=this._keyIndices;if(O=String(O),!E.has(R,O)){var f=this._arr,y=f.length;return R[O]=y,f.push({key:O,priority:w}),this._decrease(y),!0}return!1},S.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var O=this._arr.pop();return delete this._keyIndices[O.key],this._heapify(0),O.key},S.prototype.decrease=function(O,w){var R=this._keyIndices[O];if(w>this._arr[R].priority)throw new Error("New priority is greater than current priority. Key: "+O+" Old: "+this._arr[R].priority+" New: "+w);this._arr[R].priority=w,this._decrease(R)},S.prototype._heapify=function(O){var w=this._arr,R=2*O,f=R+1,y=O;R<w.length&&(y=w[R].priority<w[y].priority?R:y,f<w.length&&(y=w[f].priority<w[y].priority?f:y),y!==O&&(this._swap(O,y),this._heapify(y)))},S.prototype._decrease=function(O){for(var f,w=this._arr,R=w[O].priority;0!==O&&!(w[f=O>>1].priority<R);)this._swap(O,f),O=f},S.prototype._swap=function(O,w){var R=this._arr,f=this._keyIndices,y=R[O],m=R[w];R[O]=m,R[w]=y,f[m.key]=O,f[y.key]=w}},6568:(L,D,p)=>{"use strict";var E=p(9138);L.exports=R;var O="\0";function R(C){this._isDirected=!E.has(C,"directed")||C.directed,this._isMultigraph=!!E.has(C,"multigraph")&&C.multigraph,this._isCompound=!!E.has(C,"compound")&&C.compound,this._label=void 0,this._defaultNodeLabelFn=E.constant(void 0),this._defaultEdgeLabelFn=E.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[O]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function f(C,v){C[v]?C[v]++:C[v]=1}function y(C,v){--C[v]||delete C[v]}function m(C,v,P,_){var x=""+v,B=""+P;if(!C&&x>B){var H=x;x=B,B=H}return x+"\x01"+B+"\x01"+(E.isUndefined(_)?"\0":_)}function T(C,v,P,_){var x=""+v,B=""+P;if(!C&&x>B){var H=x;x=B,B=H}var K={v:x,w:B};return _&&(K.name=_),K}function g(C,v){return m(C,v.v,v.w,v.name)}R.prototype._nodeCount=0,R.prototype._edgeCount=0,R.prototype.isDirected=function(){return this._isDirected},R.prototype.isMultigraph=function(){return this._isMultigraph},R.prototype.isCompound=function(){return this._isCompound},R.prototype.setGraph=function(C){return this._label=C,this},R.prototype.graph=function(){return this._label},R.prototype.setDefaultNodeLabel=function(C){return E.isFunction(C)||(C=E.constant(C)),this._defaultNodeLabelFn=C,this},R.prototype.nodeCount=function(){return this._nodeCount},R.prototype.nodes=function(){return E.keys(this._nodes)},R.prototype.sources=function(){var C=this;return E.filter(this.nodes(),function(v){return E.isEmpty(C._in[v])})},R.prototype.sinks=function(){var C=this;return E.filter(this.nodes(),function(v){return E.isEmpty(C._out[v])})},R.prototype.setNodes=function(C,v){var P=arguments,_=this;return E.each(C,function(x){P.length>1?_.setNode(x,v):_.setNode(x)}),this},R.prototype.setNode=function(C,v){return E.has(this._nodes,C)?(arguments.length>1&&(this._nodes[C]=v),this):(this._nodes[C]=arguments.length>1?v:this._defaultNodeLabelFn(C),this._isCompound&&(this._parent[C]=O,this._children[C]={},this._children[O][C]=!0),this._in[C]={},this._preds[C]={},this._out[C]={},this._sucs[C]={},++this._nodeCount,this)},R.prototype.node=function(C){return this._nodes[C]},R.prototype.hasNode=function(C){return E.has(this._nodes,C)},R.prototype.removeNode=function(C){var v=this;if(E.has(this._nodes,C)){var P=function(_){v.removeEdge(v._edgeObjs[_])};delete this._nodes[C],this._isCompound&&(this._removeFromParentsChildList(C),delete this._parent[C],E.each(this.children(C),function(_){v.setParent(_)}),delete this._children[C]),E.each(E.keys(this._in[C]),P),delete this._in[C],delete this._preds[C],E.each(E.keys(this._out[C]),P),delete this._out[C],delete this._sucs[C],--this._nodeCount}return this},R.prototype.setParent=function(C,v){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(E.isUndefined(v))v=O;else{for(var P=v+="";!E.isUndefined(P);P=this.parent(P))if(P===C)throw new Error("Setting "+v+" as parent of "+C+" would create a cycle");this.setNode(v)}return this.setNode(C),this._removeFromParentsChildList(C),this._parent[C]=v,this._children[v][C]=!0,this},R.prototype._removeFromParentsChildList=function(C){delete this._children[this._parent[C]][C]},R.prototype.parent=function(C){if(this._isCompound){var v=this._parent[C];if(v!==O)return v}},R.prototype.children=function(C){if(E.isUndefined(C)&&(C=O),this._isCompound){var v=this._children[C];if(v)return E.keys(v)}else{if(C===O)return this.nodes();if(this.hasNode(C))return[]}},R.prototype.predecessors=function(C){var v=this._preds[C];if(v)return E.keys(v)},R.prototype.successors=function(C){var v=this._sucs[C];if(v)return E.keys(v)},R.prototype.neighbors=function(C){var v=this.predecessors(C);if(v)return E.union(v,this.successors(C))},R.prototype.isLeaf=function(C){return 0===(this.isDirected()?this.successors(C):this.neighbors(C)).length},R.prototype.filterNodes=function(C){var v=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});v.setGraph(this.graph());var P=this;E.each(this._nodes,function(B,H){C(H)&&v.setNode(H,B)}),E.each(this._edgeObjs,function(B){v.hasNode(B.v)&&v.hasNode(B.w)&&v.setEdge(B,P.edge(B))});var _={};function x(B){var H=P.parent(B);return void 0===H||v.hasNode(H)?(_[B]=H,H):H in _?_[H]:x(H)}return this._isCompound&&E.each(v.nodes(),function(B){v.setParent(B,x(B))}),v},R.prototype.setDefaultEdgeLabel=function(C){return E.isFunction(C)||(C=E.constant(C)),this._defaultEdgeLabelFn=C,this},R.prototype.edgeCount=function(){return this._edgeCount},R.prototype.edges=function(){return E.values(this._edgeObjs)},R.prototype.setPath=function(C,v){var P=this,_=arguments;return E.reduce(C,function(x,B){return _.length>1?P.setEdge(x,B,v):P.setEdge(x,B),B}),this},R.prototype.setEdge=function(){var C,v,P,_,x=!1,B=arguments[0];"object"==typeof B&&null!==B&&"v"in B?(C=B.v,v=B.w,P=B.name,2===arguments.length&&(_=arguments[1],x=!0)):(C=B,v=arguments[1],P=arguments[3],arguments.length>2&&(_=arguments[2],x=!0)),C=""+C,v=""+v,E.isUndefined(P)||(P=""+P);var H=m(this._isDirected,C,v,P);if(E.has(this._edgeLabels,H))return x&&(this._edgeLabels[H]=_),this;if(!E.isUndefined(P)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(C),this.setNode(v),this._edgeLabels[H]=x?_:this._defaultEdgeLabelFn(C,v,P);var K=T(this._isDirected,C,v,P);return C=K.v,v=K.w,Object.freeze(K),this._edgeObjs[H]=K,f(this._preds[v],C),f(this._sucs[C],v),this._in[v][H]=K,this._out[C][H]=K,this._edgeCount++,this},R.prototype.edge=function(C,v,P){var _=1===arguments.length?g(this._isDirected,arguments[0]):m(this._isDirected,C,v,P);return this._edgeLabels[_]},R.prototype.hasEdge=function(C,v,P){var _=1===arguments.length?g(this._isDirected,arguments[0]):m(this._isDirected,C,v,P);return E.has(this._edgeLabels,_)},R.prototype.removeEdge=function(C,v,P){var _=1===arguments.length?g(this._isDirected,arguments[0]):m(this._isDirected,C,v,P),x=this._edgeObjs[_];return x&&(C=x.v,v=x.w,delete this._edgeLabels[_],delete this._edgeObjs[_],y(this._preds[v],C),y(this._sucs[C],v),delete this._in[v][_],delete this._out[C][_],this._edgeCount--),this},R.prototype.inEdges=function(C,v){var P=this._in[C];if(P){var _=E.values(P);return v?E.filter(_,function(x){return x.v===v}):_}},R.prototype.outEdges=function(C,v){var P=this._out[C];if(P){var _=E.values(P);return v?E.filter(_,function(x){return x.w===v}):_}},R.prototype.nodeEdges=function(C,v){var P=this.inEdges(C,v);if(P)return P.concat(this.outEdges(C,v))}},1838:(L,D,p)=>{L.exports={Graph:p(6568),version:p(5089)}},1088:(L,D,p)=>{var E=p(9138),S=p(6568);function w(y){return E.map(y.nodes(),function(m){var T=y.node(m),g=y.parent(m),C={v:m};return E.isUndefined(T)||(C.value=T),E.isUndefined(g)||(C.parent=g),C})}function R(y){return E.map(y.edges(),function(m){var T=y.edge(m),g={v:m.v,w:m.w};return E.isUndefined(m.name)||(g.name=m.name),E.isUndefined(T)||(g.value=T),g})}L.exports={write:function O(y){var m={options:{directed:y.isDirected(),multigraph:y.isMultigraph(),compound:y.isCompound()},nodes:w(y),edges:R(y)};return E.isUndefined(y.graph())||(m.value=E.clone(y.graph())),m},read:function f(y){var m=new S(y.options).setGraph(y.value);return E.each(y.nodes,function(T){m.setNode(T.v,T.value),T.parent&&m.setParent(T.v,T.parent)}),E.each(y.edges,function(T){m.setEdge({v:T.v,w:T.w,name:T.name},T.value)}),m}}},9138:(L,D,p)=>{var E;try{E={clone:p(1094),constant:p(6684),each:p(5474),filter:p(5281),has:p(4842),isArray:p(1503),isEmpty:p(1973),isFunction:p(5946),isUndefined:p(4235),keys:p(118),map:p(9984),reduce:p(1337),size:p(5637),transform:p(9416),union:p(8921),values:p(377)}}catch(S){}E||(E=window._),L.exports=E},5089:L=>{L.exports="2.1.8"},2186:(L,D)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});class p{constructor(...O){this._head=this._tail=null,this._length=0,O.length>0&&O.forEach(w=>{this.append(w)})}*iterator(){let O=this._head;for(;O;)yield O.value,O=O.next}[Symbol.iterator](){return this.iterator()}get head(){return this._head?this._head.value:null}get tail(){return this._tail?this._tail.value:null}get length(){return this._length}insert(O,w,R=!1){if(R&&this.isDuplicate(O))return!1;let f=new E(O),y=this._head;if(!y)return!1;for(;;){if(y.value===w)return f.next=y.next,f.prev=y,y.next=f,f.next?f.next.prev=f:this._tail=f,this._length++,!0;if(!y.next)return!1;y=y.next}}append(O,w=!1){if(w&&this.isDuplicate(O))return!1;let R=new E(O);return this._tail?(this._tail.next=R,R.prev=this._tail,this._tail=R):this._head=this._tail=R,this._length++,!0}prepend(O,w=!1){if(w&&this.isDuplicate(O))return!1;let R=new E(O);return this._head?(R.next=this._head,this._head.prev=R,this._head=R):this._head=this._tail=R,this._length++,!0}remove(O){let w=this._head;if(w){if(w.value===O)return this._head=w.next,this._head.prev=null,w.next=w.prev=null,this._length--,w.value;for(;;){if(w.value===O)return w.next?(w.prev.next=w.next,w.next.prev=w.prev,w.next=w.prev=null):(w.prev.next=null,this._tail=w.prev,w.next=w.prev=null),this._length--,w.value;if(!w.next)return;w=w.next}}}removeHead(){let O=this._head;if(O)return this._head.next?(this._head.next.prev=null,this._head=this._head.next,O.next=O.prev=null):(this._head=null,this._tail=null),this._length--,O.value}removeTail(){let O=this._tail;if(O)return this._tail.prev?(this._tail.prev.next=null,this._tail=this._tail.prev,O.next=O.prev=null):(this._head=null,this._tail=null),this._length--,O.value}first(O){let w=this.iterator(),R=[],f=Math.min(O,this.length);for(let y=0;y<f;y++){let m=w.next();R.push(m.value)}return R}toArray(){return[...this]}isDuplicate(O){return new Set(this.toArray()).has(O)}}D.LinkedList=p;class E{constructor(O){this.value=O,this.next=null,this.prev=null}}D.LinkedListItem=E},7244:(L,D,p)=>{var O=p(3436)(p(2119),"DataView");L.exports=O},4994:(L,D,p)=>{var E=p(4312),S=p(6421),O=p(5764),w=p(8685),R=p(6676);function f(y){var m=-1,T=null==y?0:y.length;for(this.clear();++m<T;){var g=y[m];this.set(g[0],g[1])}}f.prototype.clear=E,f.prototype.delete=S,f.prototype.get=O,f.prototype.has=w,f.prototype.set=R,L.exports=f},9215:(L,D,p)=>{var E=p(1840),S=p(4378),O=p(4981),w=p(7343),R=p(8895);function f(y){var m=-1,T=null==y?0:y.length;for(this.clear();++m<T;){var g=y[m];this.set(g[0],g[1])}}f.prototype.clear=E,f.prototype.delete=S,f.prototype.get=O,f.prototype.has=w,f.prototype.set=R,L.exports=f},1501:(L,D,p)=>{var O=p(3436)(p(2119),"Map");L.exports=O},9850:(L,D,p)=>{var E=p(638),S=p(1184),O=p(866),w=p(3771),R=p(1772);function f(y){var m=-1,T=null==y?0:y.length;for(this.clear();++m<T;){var g=y[m];this.set(g[0],g[1])}}f.prototype.clear=E,f.prototype.delete=S,f.prototype.get=O,f.prototype.has=w,f.prototype.set=R,L.exports=f},4267:(L,D,p)=>{var O=p(3436)(p(2119),"Promise");L.exports=O},6323:(L,D,p)=>{var O=p(3436)(p(2119),"Set");L.exports=O},8849:(L,D,p)=>{var E=p(9850),S=p(4600),O=p(1387);function w(R){var f=-1,y=null==R?0:R.length;for(this.__data__=new E;++f<y;)this.add(R[f])}w.prototype.add=w.prototype.push=S,w.prototype.has=O,L.exports=w},2858:(L,D,p)=>{var E=p(9215),S=p(3720),O=p(4410),w=p(5576),R=p(2247),f=p(1585);function y(m){var T=this.__data__=new E(m);this.size=T.size}y.prototype.clear=S,y.prototype.delete=O,y.prototype.get=w,y.prototype.has=R,y.prototype.set=f,L.exports=y},443:(L,D,p)=>{var E=p(2119);L.exports=E.Symbol},3457:(L,D,p)=>{var E=p(2119);L.exports=E.Uint8Array},4243:(L,D,p)=>{var O=p(3436)(p(2119),"WeakMap");L.exports=O},6999:L=>{L.exports=function D(p,E,S){switch(S.length){case 0:return p.call(E);case 1:return p.call(E,S[0]);case 2:return p.call(E,S[0],S[1]);case 3:return p.call(E,S[0],S[1],S[2])}return p.apply(E,S)}},6837:L=>{L.exports=function D(p,E){for(var S=-1,O=null==p?0:p.length;++S<O&&!1!==E(p[S],S,p););return p}},9779:L=>{L.exports=function D(p,E){for(var S=-1,O=null==p?0:p.length,w=0,R=[];++S<O;){var f=p[S];E(f,S,p)&&(R[w++]=f)}return R}},1253:(L,D,p)=>{var E=p(4164);L.exports=function S(O,w){return!(null==O||!O.length)&&E(O,w,0)>-1}},177:L=>{L.exports=function D(p,E,S){for(var O=-1,w=null==p?0:p.length;++O<w;)if(S(E,p[O]))return!0;return!1}},2271:(L,D,p)=>{var E=p(5334),S=p(7151),O=p(1503),w=p(891),R=p(8442),f=p(8159),m=Object.prototype.hasOwnProperty;L.exports=function T(g,C){var v=O(g),P=!v&&S(g),_=!v&&!P&&w(g),x=!v&&!P&&!_&&f(g),B=v||P||_||x,H=B?E(g.length,String):[],K=H.length;for(var V in g)(C||m.call(g,V))&&(!B||!("length"==V||_&&("offset"==V||"parent"==V)||x&&("buffer"==V||"byteLength"==V||"byteOffset"==V)||R(V,K)))&&H.push(V);return H}},4633:L=>{L.exports=function D(p,E){for(var S=-1,O=null==p?0:p.length,w=Array(O);++S<O;)w[S]=E(p[S],S,p);return w}},5059:L=>{L.exports=function D(p,E){for(var S=-1,O=E.length,w=p.length;++S<O;)p[w+S]=E[S];return p}},8745:L=>{L.exports=function D(p,E,S,O){var w=-1,R=null==p?0:p.length;for(O&&R&&(S=p[++w]);++w<R;)S=E(S,p[w],w,p);return S}},9503:L=>{L.exports=function D(p,E){for(var S=-1,O=null==p?0:p.length;++S<O;)if(E(p[S],S,p))return!0;return!1}},5481:(L,D,p)=>{var S=p(1847)("length");L.exports=S},9276:(L,D,p)=>{var E=p(5683),S=p(217);L.exports=function O(w,R,f){(void 0!==f&&!S(w[R],f)||void 0===f&&!(R in w))&&E(w,R,f)}},9719:(L,D,p)=>{var E=p(5683),S=p(217),w=Object.prototype.hasOwnProperty;L.exports=function R(f,y,m){var T=f[y];(!w.call(f,y)||!S(T,m)||void 0===m&&!(y in f))&&E(f,y,m)}},3503:(L,D,p)=>{var E=p(217);L.exports=function S(O,w){for(var R=O.length;R--;)if(E(O[R][0],w))return R;return-1}},4121:(L,D,p)=>{var E=p(1989),S=p(118);L.exports=function O(w,R){return w&&E(R,S(R),w)}},9287:(L,D,p)=>{var E=p(1989),S=p(6555);L.exports=function O(w,R){return w&&E(R,S(R),w)}},5683:(L,D,p)=>{var E=p(6713);L.exports=function S(O,w,R){"__proto__"==w&&E?E(O,w,{configurable:!0,enumerable:!0,value:R,writable:!0}):O[w]=R}},4462:(L,D,p)=>{var E=p(2858),S=p(6837),O=p(9719),w=p(4121),R=p(9287),f=p(9292),y=p(9454),m=p(4444),T=p(9905),g=p(7597),C=p(6967),v=p(8794),P=p(6782),_=p(7878),x=p(4264),B=p(1503),H=p(891),K=p(3222),V=p(5940),ne=p(799),se=p(118),ge=p(6555),te="[object Arguments]",Ee="[object Function]",De="[object Object]",nn={};nn[te]=nn["[object Array]"]=nn["[object ArrayBuffer]"]=nn["[object DataView]"]=nn["[object Boolean]"]=nn["[object Date]"]=nn["[object Float32Array]"]=nn["[object Float64Array]"]=nn["[object Int8Array]"]=nn["[object Int16Array]"]=nn["[object Int32Array]"]=nn["[object Map]"]=nn["[object Number]"]=nn[De]=nn["[object RegExp]"]=nn["[object Set]"]=nn["[object String]"]=nn["[object Symbol]"]=nn["[object Uint8Array]"]=nn["[object Uint8ClampedArray]"]=nn["[object Uint16Array]"]=nn["[object Uint32Array]"]=!0,nn["[object Error]"]=nn[Ee]=nn["[object WeakMap]"]=!1,L.exports=function fr(Xt,js,xi,Li,zs,Mi){var Yn,vs=1&js,Ol=2&js,ta=4&js;if(xi&&(Yn=zs?xi(Xt,Li,zs,Mi):xi(Xt)),void 0!==Yn)return Yn;if(!V(Xt))return Xt;var Co=B(Xt);if(Co){if(Yn=P(Xt),!vs)return y(Xt,Yn)}else{var Ss=v(Xt),Il=Ss==Ee||"[object GeneratorFunction]"==Ss;if(H(Xt))return f(Xt,vs);if(Ss==De||Ss==te||Il&&!zs){if(Yn=Ol||Il?{}:x(Xt),!vs)return Ol?T(Xt,R(Yn,Xt)):m(Xt,w(Yn,Xt))}else{if(!nn[Ss])return zs?Xt:{};Yn=_(Xt,Ss,vs)}}Mi||(Mi=new E);var Pl=Mi.get(Xt);if(Pl)return Pl;Mi.set(Xt,Yn),ne(Xt)?Xt.forEach(function(Xr){Yn.add(fr(Xr,js,xi,Xr,Xt,Mi))}):K(Xt)&&Xt.forEach(function(Xr,vi){Yn.set(vi,fr(Xr,js,xi,vi,Xt,Mi))});var Nl=Co?void 0:(ta?Ol?C:g:Ol?ge:se)(Xt);return S(Nl||Xt,function(Xr,vi){Nl&&(Xr=Xt[vi=Xr]),O(Yn,vi,fr(Xr,js,xi,vi,Xt,Mi))}),Yn}},8858:(L,D,p)=>{var E=p(5940),S=Object.create,O=function(){function w(){}return function(R){if(!E(R))return{};if(S)return S(R);w.prototype=R;var f=new w;return w.prototype=void 0,f}}();L.exports=O},3132:(L,D,p)=>{var E=p(5184),O=p(6539)(E);L.exports=O},7308:(L,D,p)=>{var E=p(4129);L.exports=function S(O,w,R){for(var f=-1,y=O.length;++f<y;){var m=O[f],T=w(m);if(null!=T&&(void 0===g?T==T&&!E(T):R(T,g)))var g=T,C=m}return C}},3609:(L,D,p)=>{var E=p(3132);L.exports=function S(O,w){var R=[];return E(O,function(f,y,m){w(f,y,m)&&R.push(f)}),R}},5317:L=>{L.exports=function D(p,E,S,O){for(var w=p.length,R=S+(O?1:-1);O?R--:++R<w;)if(E(p[R],R,p))return R;return-1}},686:(L,D,p)=>{var E=p(5059),S=p(5039);L.exports=function O(w,R,f,y,m){var T=-1,g=w.length;for(f||(f=S),m||(m=[]);++T<g;){var C=w[T];R>0&&f(C)?R>1?O(C,R-1,f,y,m):E(m,C):y||(m[m.length]=C)}return m}},755:(L,D,p)=>{var S=p(456)();L.exports=S},5184:(L,D,p)=>{var E=p(755),S=p(118);L.exports=function O(w,R){return w&&E(w,R,S)}},5456:(L,D,p)=>{var E=p(6884),S=p(8533);L.exports=function O(w,R){for(var f=0,y=(R=E(R,w)).length;null!=w&&f<y;)w=w[S(R[f++])];return f&&f==y?w:void 0}},8247:(L,D,p)=>{var E=p(5059),S=p(1503);L.exports=function O(w,R,f){var y=R(w);return S(w)?y:E(y,f(w))}},3337:(L,D,p)=>{var E=p(443),S=p(1318),O=p(2902),f=E?E.toStringTag:void 0;L.exports=function y(m){return null==m?void 0===m?"[object Undefined]":"[object Null]":f&&f in Object(m)?S(m):O(m)}},1100:L=>{L.exports=function D(p,E){return p>E}},4781:L=>{var p=Object.prototype.hasOwnProperty;L.exports=function E(S,O){return null!=S&&p.call(S,O)}},9989:L=>{L.exports=function D(p,E){return null!=p&&E in Object(p)}},4164:(L,D,p)=>{var E=p(5317),S=p(968),O=p(4977);L.exports=function w(R,f,y){return f==f?O(R,f,y):E(R,S,y)}},186:(L,D,p)=>{var E=p(3337),S=p(2671);L.exports=function w(R){return S(R)&&"[object Arguments]"==E(R)}},5740:(L,D,p)=>{var E=p(8325),S=p(2671);L.exports=function O(w,R,f,y,m){return w===R||(null==w||null==R||!S(w)&&!S(R)?w!=w&&R!=R:E(w,R,f,y,O,m))}},8325:(L,D,p)=>{var E=p(2858),S=p(3914),O=p(8583),w=p(2286),R=p(8794),f=p(1503),y=p(891),m=p(8159),g="[object Arguments]",C="[object Array]",v="[object Object]",_=Object.prototype.hasOwnProperty;L.exports=function x(B,H,K,V,ne,se){var ge=f(B),ce=f(H),me=ge?C:R(B),Q=ce?C:R(H),te=(me=me==g?v:me)==v,j=(Q=Q==g?v:Q)==v,$=me==Q;if($&&y(B)){if(!y(H))return!1;ge=!0,te=!1}if($&&!te)return se||(se=new E),ge||m(B)?S(B,H,K,V,ne,se):O(B,H,me,K,V,ne,se);if(!(1&K)){var J=te&&_.call(B,"__wrapped__"),ae=j&&_.call(H,"__wrapped__");if(J||ae){var Ee=J?B.value():B,re=ae?H.value():H;return se||(se=new E),ne(Ee,re,K,V,se)}}return!!$&&(se||(se=new E),w(B,H,K,V,ne,se))}},7021:(L,D,p)=>{var E=p(8794),S=p(2671);L.exports=function w(R){return S(R)&&"[object Map]"==E(R)}},431:(L,D,p)=>{var E=p(2858),S=p(5740);L.exports=function R(f,y,m,T){var g=m.length,C=g,v=!T;if(null==f)return!C;for(f=Object(f);g--;){var P=m[g];if(v&&P[2]?P[1]!==f[P[0]]:!(P[0]in f))return!1}for(;++g<C;){var _=(P=m[g])[0],x=f[_],B=P[1];if(v&&P[2]){if(void 0===x&&!(_ in f))return!1}else{var H=new E;if(T)var K=T(x,B,_,f,y,H);if(!(void 0===K?S(B,x,3,T,H):K))return!1}}return!0}},968:L=>{L.exports=function D(p){return p!=p}},7304:(L,D,p)=>{var E=p(5946),S=p(1943),O=p(5940),w=p(2827),f=/^\[object .+?Constructor\]$/,C=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");L.exports=function v(P){return!(!O(P)||S(P))&&(E(P)?C:f).test(w(P))}},771:(L,D,p)=>{var E=p(8794),S=p(2671);L.exports=function w(R){return S(R)&&"[object Set]"==E(R)}},1083:(L,D,p)=>{var E=p(3337),S=p(6231),O=p(2671),$={};$["[object Float32Array]"]=$["[object Float64Array]"]=$["[object Int8Array]"]=$["[object Int16Array]"]=$["[object Int32Array]"]=$["[object Uint8Array]"]=$["[object Uint8ClampedArray]"]=$["[object Uint16Array]"]=$["[object Uint32Array]"]=!0,$["[object Arguments]"]=$["[object Array]"]=$["[object ArrayBuffer]"]=$["[object Boolean]"]=$["[object DataView]"]=$["[object Date]"]=$["[object Error]"]=$["[object Function]"]=$["[object Map]"]=$["[object Number]"]=$["[object Object]"]=$["[object RegExp]"]=$["[object Set]"]=$["[object String]"]=$["[object WeakMap]"]=!1,L.exports=function J(ae){return O(ae)&&S(ae.length)&&!!$[E(ae)]}},6517:(L,D,p)=>{var E=p(8133),S=p(9458),O=p(2608),w=p(1503),R=p(7495);L.exports=function f(y){return"function"==typeof y?y:null==y?O:"object"==typeof y?w(y)?S(y[0],y[1]):E(y):R(y)}},1172:(L,D,p)=>{var E=p(5488),S=p(5491),w=Object.prototype.hasOwnProperty;L.exports=function R(f){if(!E(f))return S(f);var y=[];for(var m in Object(f))w.call(f,m)&&"constructor"!=m&&y.push(m);return y}},2809:(L,D,p)=>{var E=p(5940),S=p(5488),O=p(2158),R=Object.prototype.hasOwnProperty;L.exports=function f(y){if(!E(y))return O(y);var m=S(y),T=[];for(var g in y)"constructor"==g&&(m||!R.call(y,g))||T.push(g);return T}},9069:L=>{L.exports=function D(p,E){return p<E}},2046:(L,D,p)=>{var E=p(3132),S=p(6507);L.exports=function O(w,R){var f=-1,y=S(w)?Array(w.length):[];return E(w,function(m,T,g){y[++f]=R(m,T,g)}),y}},8133:(L,D,p)=>{var E=p(431),S=p(2379),O=p(642);L.exports=function w(R){var f=S(R);return 1==f.length&&f[0][2]?O(f[0][0],f[0][1]):function(y){return y===R||E(y,R,f)}}},9458:(L,D,p)=>{var E=p(5740),S=p(8817),O=p(8492),w=p(5352),R=p(2442),f=p(642),y=p(8533);L.exports=function g(C,v){return w(C)&&R(v)?f(y(C),v):function(P){var _=S(P,C);return void 0===_&&_===v?O(P,C):E(v,_,3)}}},3842:(L,D,p)=>{var E=p(2858),S=p(9276),O=p(755),w=p(3675),R=p(5940),f=p(6555),y=p(9351);L.exports=function m(T,g,C,v,P){T!==g&&O(g,function(_,x){if(P||(P=new E),R(_))w(T,g,x,C,m,v,P);else{var B=v?v(y(T,x),_,x+"",T,g,P):void 0;void 0===B&&(B=_),S(T,x,B)}},f)}},3675:(L,D,p)=>{var E=p(9276),S=p(9292),O=p(5208),w=p(9454),R=p(4264),f=p(7151),y=p(1503),m=p(1330),T=p(891),g=p(5946),C=p(5940),v=p(7614),P=p(8159),_=p(9351),x=p(8067);L.exports=function B(H,K,V,ne,se,ge,ce){var me=_(H,V),Q=_(K,V),te=ce.get(Q);if(te)E(H,V,te);else{var j=ge?ge(me,Q,V+"",H,K,ce):void 0,$=void 0===j;if($){var J=y(Q),ae=!J&&T(Q),Ee=!J&&!ae&&P(Q);j=Q,J||ae||Ee?y(me)?j=me:m(me)?j=w(me):ae?($=!1,j=S(Q,!0)):Ee?($=!1,j=O(Q,!0)):j=[]:v(Q)||f(Q)?(j=me,f(me)?j=x(me):(!C(me)||g(me))&&(j=R(Q))):$=!1}$&&(ce.set(Q,j),se(j,Q,ne,ge,ce),ce.delete(Q)),E(H,V,j)}}},6119:(L,D,p)=>{var E=p(4633),S=p(5456),O=p(6517),w=p(2046),R=p(8750),f=p(5647),y=p(1215),m=p(2608),T=p(1503);L.exports=function g(C,v,P){v=v.length?E(v,function(B){return T(B)?function(H){return S(H,1===B.length?B[0]:B)}:B}):[m];var _=-1;v=E(v,f(O));var x=w(C,function(B,H,K){return{criteria:E(v,function(ne){return ne(B)}),index:++_,value:B}});return R(x,function(B,H){return y(B,H,P)})}},3021:(L,D,p)=>{var E=p(5495),S=p(8492);L.exports=function O(w,R){return E(w,R,function(f,y){return S(w,y)})}},5495:(L,D,p)=>{var E=p(5456),S=p(5963),O=p(6884);L.exports=function w(R,f,y){for(var m=-1,T=f.length,g={};++m<T;){var C=f[m],v=E(R,C);y(v,C)&&S(g,O(C,R),v)}return g}},1847:L=>{L.exports=function D(p){return function(E){return null==E?void 0:E[p]}}},9222:(L,D,p)=>{var E=p(5456);L.exports=function S(O){return function(w){return E(w,O)}}},6307:L=>{var D=Math.ceil,p=Math.max;L.exports=function E(S,O,w,R){for(var f=-1,y=p(D((O-S)/(w||1)),0),m=Array(y);y--;)m[R?y:++f]=S,S+=w;return m}},3570:L=>{L.exports=function D(p,E,S,O,w){return w(p,function(R,f,y){S=O?(O=!1,R):E(S,R,f,y)}),S}},3269:(L,D,p)=>{var E=p(2608),S=p(3983),O=p(2185);L.exports=function w(R,f){return O(S(R,f,E),R+"")}},5963:(L,D,p)=>{var E=p(9719),S=p(6884),O=p(8442),w=p(5940),R=p(8533);L.exports=function f(y,m,T,g){if(!w(y))return y;for(var C=-1,v=(m=S(m,y)).length,P=v-1,_=y;null!=_&&++C<v;){var x=R(m[C]),B=T;if("__proto__"===x||"constructor"===x||"prototype"===x)return y;if(C!=P){var H=_[x];void 0===(B=g?g(H,x,_):void 0)&&(B=w(H)?H:O(m[C+1])?[]:{})}E(_,x,B),_=_[x]}return y}},9510:(L,D,p)=>{var E=p(6684),S=p(6713),O=p(2608);L.exports=S?function(R,f){return S(R,"toString",{configurable:!0,enumerable:!1,value:E(f),writable:!0})}:O},8750:L=>{L.exports=function D(p,E){var S=p.length;for(p.sort(E);S--;)p[S]=p[S].value;return p}},5334:L=>{L.exports=function D(p,E){for(var S=-1,O=Array(p);++S<p;)O[S]=E(S);return O}},3935:(L,D,p)=>{var E=p(443),S=p(4633),O=p(1503),w=p(4129),f=E?E.prototype:void 0,y=f?f.toString:void 0;L.exports=function m(T){if("string"==typeof T)return T;if(O(T))return S(T,m)+"";if(w(T))return y?y.call(T):"";var g=T+"";return"0"==g&&1/T==-1/0?"-0":g}},3348:(L,D,p)=>{var E=p(2760),S=/^\s+/;L.exports=function O(w){return w&&w.slice(0,E(w)+1).replace(S,"")}},5647:L=>{L.exports=function D(p){return function(E){return p(E)}}},707:(L,D,p)=>{var E=p(8849),S=p(1253),O=p(177),w=p(5972),R=p(4575),f=p(4174);L.exports=function m(T,g,C){var v=-1,P=S,_=T.length,x=!0,B=[],H=B;if(C)x=!1,P=O;else if(_>=200){var K=g?null:R(T);if(K)return f(K);x=!1,P=w,H=new E}else H=g?[]:B;e:for(;++v<_;){var V=T[v],ne=g?g(V):V;if(V=C||0!==V?V:0,x&&ne==ne){for(var se=H.length;se--;)if(H[se]===ne)continue e;g&&H.push(ne),B.push(V)}else P(H,ne,C)||(H!==B&&H.push(ne),B.push(V))}return B}},9179:(L,D,p)=>{var E=p(4633);L.exports=function S(O,w){return E(w,function(R){return O[R]})}},8645:L=>{L.exports=function D(p,E,S){for(var O=-1,w=p.length,R=E.length,f={};++O<w;)S(f,p[O],O<R?E[O]:void 0);return f}},5972:L=>{L.exports=function D(p,E){return p.has(E)}},1481:(L,D,p)=>{var E=p(2608);L.exports=function S(O){return"function"==typeof O?O:E}},6884:(L,D,p)=>{var E=p(1503),S=p(5352),O=p(2855),w=p(3943);L.exports=function R(f,y){return E(f)?f:S(f,y)?[f]:O(w(f))}},3362:(L,D,p)=>{var E=p(3457);L.exports=function S(O){var w=new O.constructor(O.byteLength);return new E(w).set(new E(O)),w}},9292:(L,D,p)=>{L=p.nmd(L);var E=p(2119),S=D&&!D.nodeType&&D,O=S&&L&&!L.nodeType&&L,R=O&&O.exports===S?E.Buffer:void 0,f=R?R.allocUnsafe:void 0;L.exports=function y(m,T){if(T)return m.slice();var g=m.length,C=f?f(g):new m.constructor(g);return m.copy(C),C}},7e3:(L,D,p)=>{var E=p(3362);L.exports=function S(O,w){var R=w?E(O.buffer):O.buffer;return new O.constructor(R,O.byteOffset,O.byteLength)}},4098:L=>{var D=/\w*$/;L.exports=function p(E){var S=new E.constructor(E.source,D.exec(E));return S.lastIndex=E.lastIndex,S}},2533:(L,D,p)=>{var E=p(443),S=E?E.prototype:void 0,O=S?S.valueOf:void 0;L.exports=function w(R){return O?Object(O.call(R)):{}}},5208:(L,D,p)=>{var E=p(3362);L.exports=function S(O,w){var R=w?E(O.buffer):O.buffer;return new O.constructor(R,O.byteOffset,O.length)}},3443:(L,D,p)=>{var E=p(4129);L.exports=function S(O,w){if(O!==w){var R=void 0!==O,f=null===O,y=O==O,m=E(O),T=void 0!==w,g=null===w,C=w==w,v=E(w);if(!g&&!v&&!m&&O>w||m&&T&&C&&!g&&!v||f&&T&&C||!R&&C||!y)return 1;if(!f&&!m&&!v&&O<w||v&&R&&y&&!f&&!m||g&&R&&y||!T&&y||!C)return-1}return 0}},1215:(L,D,p)=>{var E=p(3443);L.exports=function S(O,w,R){for(var f=-1,y=O.criteria,m=w.criteria,T=y.length,g=R.length;++f<T;){var C=E(y[f],m[f]);if(C)return f>=g?C:C*("desc"==R[f]?-1:1)}return O.index-w.index}},9454:L=>{L.exports=function D(p,E){var S=-1,O=p.length;for(E||(E=Array(O));++S<O;)E[S]=p[S];return E}},1989:(L,D,p)=>{var E=p(9719),S=p(5683);L.exports=function O(w,R,f,y){var m=!f;f||(f={});for(var T=-1,g=R.length;++T<g;){var C=R[T],v=y?y(f[C],w[C],C,f,w):void 0;void 0===v&&(v=w[C]),m?S(f,C,v):E(f,C,v)}return f}},4444:(L,D,p)=>{var E=p(1989),S=p(9383);L.exports=function O(w,R){return E(w,S(w),R)}},9905:(L,D,p)=>{var E=p(1989),S=p(3051);L.exports=function O(w,R){return E(w,S(w),R)}},4610:(L,D,p)=>{var E=p(2119);L.exports=E["__core-js_shared__"]},4944:(L,D,p)=>{var E=p(3269),S=p(3342);L.exports=function O(w){return E(function(R,f){var y=-1,m=f.length,T=m>1?f[m-1]:void 0,g=m>2?f[2]:void 0;for(T=w.length>3&&"function"==typeof T?(m--,T):void 0,g&&S(f[0],f[1],g)&&(T=m<3?void 0:T,m=1),R=Object(R);++y<m;){var C=f[y];C&&w(R,C,y,T)}return R})}},6539:(L,D,p)=>{var E=p(6507);L.exports=function S(O,w){return function(R,f){if(null==R)return R;if(!E(R))return O(R,f);for(var y=R.length,m=w?y:-1,T=Object(R);(w?m--:++m<y)&&!1!==f(T[m],m,T););return R}}},456:L=>{L.exports=function D(p){return function(E,S,O){for(var w=-1,R=Object(E),f=O(E),y=f.length;y--;){var m=f[p?y:++w];if(!1===S(R[m],m,R))break}return E}}},4653:(L,D,p)=>{var E=p(6517),S=p(6507),O=p(118);L.exports=function w(R){return function(f,y,m){var T=Object(f);if(!S(f)){var g=E(y,3);f=O(f),y=function(v){return g(T[v],v,T)}}var C=R(f,y,m);return C>-1?T[g?f[C]:C]:void 0}}},7509:(L,D,p)=>{var E=p(6307),S=p(3342),O=p(2232);L.exports=function w(R){return function(f,y,m){return m&&"number"!=typeof m&&S(f,y,m)&&(y=m=void 0),f=O(f),void 0===y?(y=f,f=0):y=O(y),m=void 0===m?f<y?1:-1:O(m),E(f,y,m,R)}}},4575:(L,D,p)=>{var E=p(6323),S=p(2552),O=p(4174),R=E&&1/O(new E([,-0]))[1]==1/0?function(f){return new E(f)}:S;L.exports=R},6713:(L,D,p)=>{var E=p(3436),S=function(){try{var O=E(Object,"defineProperty");return O({},"",{}),O}catch(w){}}();L.exports=S},3914:(L,D,p)=>{var E=p(8849),S=p(9503),O=p(5972);L.exports=function f(y,m,T,g,C,v){var P=1&T,_=y.length,x=m.length;if(_!=x&&!(P&&x>_))return!1;var B=v.get(y),H=v.get(m);if(B&&H)return B==m&&H==y;var K=-1,V=!0,ne=2&T?new E:void 0;for(v.set(y,m),v.set(m,y);++K<_;){var se=y[K],ge=m[K];if(g)var ce=P?g(ge,se,K,m,y,v):g(se,ge,K,y,m,v);if(void 0!==ce){if(ce)continue;V=!1;break}if(ne){if(!S(m,function(me,Q){if(!O(ne,Q)&&(se===me||C(se,me,T,g,v)))return ne.push(Q)})){V=!1;break}}else if(se!==ge&&!C(se,ge,T,g,v)){V=!1;break}}return v.delete(y),v.delete(m),V}},8583:(L,D,p)=>{var E=p(443),S=p(3457),O=p(217),w=p(3914),R=p(3205),f=p(4174),ne=E?E.prototype:void 0,se=ne?ne.valueOf:void 0;L.exports=function ge(ce,me,Q,te,j,$,J){switch(Q){case"[object DataView]":if(ce.byteLength!=me.byteLength||ce.byteOffset!=me.byteOffset)return!1;ce=ce.buffer,me=me.buffer;case"[object ArrayBuffer]":return!(ce.byteLength!=me.byteLength||!$(new S(ce),new S(me)));case"[object Boolean]":case"[object Date]":case"[object Number]":return O(+ce,+me);case"[object Error]":return ce.name==me.name&&ce.message==me.message;case"[object RegExp]":case"[object String]":return ce==me+"";case"[object Map]":var ae=R;case"[object Set]":if(ae||(ae=f),ce.size!=me.size&&!(1&te))return!1;var re=J.get(ce);if(re)return re==me;te|=2,J.set(ce,me);var ee=w(ae(ce),ae(me),te,j,$,J);return J.delete(ce),ee;case"[object Symbol]":if(se)return se.call(ce)==se.call(me)}return!1}},2286:(L,D,p)=>{var E=p(7597),w=Object.prototype.hasOwnProperty;L.exports=function R(f,y,m,T,g,C){var v=1&m,P=E(f),_=P.length;if(_!=E(y).length&&!v)return!1;for(var H=_;H--;){var K=P[H];if(!(v?K in y:w.call(y,K)))return!1}var V=C.get(f),ne=C.get(y);if(V&&ne)return V==y&&ne==f;var se=!0;C.set(f,y),C.set(y,f);for(var ge=v;++H<_;){var ce=f[K=P[H]],me=y[K];if(T)var Q=v?T(me,ce,K,y,f,C):T(ce,me,K,f,y,C);if(!(void 0===Q?ce===me||g(ce,me,m,T,C):Q)){se=!1;break}ge||(ge="constructor"==K)}if(se&&!ge){var te=f.constructor,j=y.constructor;te!=j&&"constructor"in f&&"constructor"in y&&!("function"==typeof te&&te instanceof te&&"function"==typeof j&&j instanceof j)&&(se=!1)}return C.delete(f),C.delete(y),se}},3975:(L,D,p)=>{var E=p(2274),S=p(3983),O=p(2185);L.exports=function w(R){return O(S(R,void 0,E),R+"")}},9122:L=>{var D="object"==typeof global&&global&&global.Object===Object&&global;L.exports=D},7597:(L,D,p)=>{var E=p(8247),S=p(9383),O=p(118);L.exports=function w(R){return E(R,O,S)}},6967:(L,D,p)=>{var E=p(8247),S=p(3051),O=p(6555);L.exports=function w(R){return E(R,O,S)}},4537:(L,D,p)=>{var E=p(3819);L.exports=function S(O,w){var R=O.__data__;return E(w)?R["string"==typeof w?"string":"hash"]:R.map}},2379:(L,D,p)=>{var E=p(2442),S=p(118);L.exports=function O(w){for(var R=S(w),f=R.length;f--;){var y=R[f],m=w[y];R[f]=[y,m,E(m)]}return R}},3436:(L,D,p)=>{var E=p(7304),S=p(1990);L.exports=function O(w,R){var f=S(w,R);return E(f)?f:void 0}},9519:(L,D,p)=>{var S=p(9385)(Object.getPrototypeOf,Object);L.exports=S},1318:(L,D,p)=>{var E=p(443),S=Object.prototype,O=S.hasOwnProperty,w=S.toString,R=E?E.toStringTag:void 0;L.exports=function f(y){var m=O.call(y,R),T=y[R];try{y[R]=void 0;var g=!0}catch(v){}var C=w.call(y);return g&&(m?y[R]=T:delete y[R]),C}},9383:(L,D,p)=>{var E=p(9779),S=p(9975),w=Object.prototype.propertyIsEnumerable,R=Object.getOwnPropertySymbols;L.exports=R?function(y){return null==y?[]:(y=Object(y),E(R(y),function(m){return w.call(y,m)}))}:S},3051:(L,D,p)=>{var E=p(5059),S=p(9519),O=p(9383),w=p(9975);L.exports=Object.getOwnPropertySymbols?function(y){for(var m=[];y;)E(m,O(y)),y=S(y);return m}:w},8794:(L,D,p)=>{var E=p(7244),S=p(1501),O=p(4267),w=p(6323),R=p(4243),f=p(3337),y=p(2827),m="[object Map]",g="[object Promise]",C="[object Set]",v="[object WeakMap]",P="[object DataView]",_=y(E),x=y(S),B=y(O),H=y(w),K=y(R),V=f;(E&&V(new E(new ArrayBuffer(1)))!=P||S&&V(new S)!=m||O&&V(O.resolve())!=g||w&&V(new w)!=C||R&&V(new R)!=v)&&(V=function(ne){var se=f(ne),ge="[object Object]"==se?ne.constructor:void 0,ce=ge?y(ge):"";if(ce)switch(ce){case _:return P;case x:return m;case B:return g;case H:return C;case K:return v}return se}),L.exports=V},1990:L=>{L.exports=function D(p,E){return null==p?void 0:p[E]}},7283:(L,D,p)=>{var E=p(6884),S=p(7151),O=p(1503),w=p(8442),R=p(6231),f=p(8533);L.exports=function y(m,T,g){for(var C=-1,v=(T=E(T,m)).length,P=!1;++C<v;){var _=f(T[C]);if(!(P=null!=m&&g(m,_)))break;m=m[_]}return P||++C!=v?P:!!(v=null==m?0:m.length)&&R(v)&&w(_,v)&&(O(m)||S(m))}},7609:L=>{var f=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");L.exports=function y(m){return f.test(m)}},4312:(L,D,p)=>{var E=p(862);L.exports=function S(){this.__data__=E?E(null):{},this.size=0}},6421:L=>{L.exports=function D(p){var E=this.has(p)&&delete this.__data__[p];return this.size-=E?1:0,E}},5764:(L,D,p)=>{var E=p(862),w=Object.prototype.hasOwnProperty;L.exports=function R(f){var y=this.__data__;if(E){var m=y[f];return"__lodash_hash_undefined__"===m?void 0:m}return w.call(y,f)?y[f]:void 0}},8685:(L,D,p)=>{var E=p(862),O=Object.prototype.hasOwnProperty;L.exports=function w(R){var f=this.__data__;return E?void 0!==f[R]:O.call(f,R)}},6676:(L,D,p)=>{var E=p(862);L.exports=function O(w,R){var f=this.__data__;return this.size+=this.has(w)?0:1,f[w]=E&&void 0===R?"__lodash_hash_undefined__":R,this}},6782:L=>{var p=Object.prototype.hasOwnProperty;L.exports=function E(S){var O=S.length,w=new S.constructor(O);return O&&"string"==typeof S[0]&&p.call(S,"index")&&(w.index=S.index,w.input=S.input),w}},7878:(L,D,p)=>{var E=p(3362),S=p(7e3),O=p(4098),w=p(2533),R=p(5208);L.exports=function Q(te,j,$){var J=te.constructor;switch(j){case"[object ArrayBuffer]":return E(te);case"[object Boolean]":case"[object Date]":return new J(+te);case"[object DataView]":return S(te,$);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return R(te,$);case"[object Map]":case"[object Set]":return new J;case"[object Number]":case"[object String]":return new J(te);case"[object RegExp]":return O(te);case"[object Symbol]":return w(te)}}},4264:(L,D,p)=>{var E=p(8858),S=p(9519),O=p(5488);L.exports=function w(R){return"function"!=typeof R.constructor||O(R)?{}:E(S(R))}},5039:(L,D,p)=>{var E=p(443),S=p(7151),O=p(1503),w=E?E.isConcatSpreadable:void 0;L.exports=function R(f){return O(f)||S(f)||!!(w&&f&&f[w])}},8442:L=>{var p=/^(?:0|[1-9]\d*)$/;L.exports=function E(S,O){var w=typeof S;return!!(O=null==O?9007199254740991:O)&&("number"==w||"symbol"!=w&&p.test(S))&&S>-1&&S%1==0&&S<O}},3342:(L,D,p)=>{var E=p(217),S=p(6507),O=p(8442),w=p(5940);L.exports=function R(f,y,m){if(!w(m))return!1;var T=typeof y;return!!("number"==T?S(m)&&O(y,m.length):"string"==T&&y in m)&&E(m[y],f)}},5352:(L,D,p)=>{var E=p(1503),S=p(4129),O=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,w=/^\w*$/;L.exports=function R(f,y){if(E(f))return!1;var m=typeof f;return!("number"!=m&&"symbol"!=m&&"boolean"!=m&&null!=f&&!S(f))||w.test(f)||!O.test(f)||null!=y&&f in Object(y)}},3819:L=>{L.exports=function D(p){var E=typeof p;return"string"==E||"number"==E||"symbol"==E||"boolean"==E?"__proto__"!==p:null===p}},1943:(L,D,p)=>{var w,E=p(4610),S=(w=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"";L.exports=function O(w){return!!S&&S in w}},5488:L=>{var D=Object.prototype;L.exports=function p(E){var S=E&&E.constructor;return E===("function"==typeof S&&S.prototype||D)}},2442:(L,D,p)=>{var E=p(5940);L.exports=function S(O){return O==O&&!E(O)}},1840:L=>{L.exports=function D(){this.__data__=[],this.size=0}},4378:(L,D,p)=>{var E=p(3503),O=Array.prototype.splice;L.exports=function w(R){var f=this.__data__,y=E(f,R);return!(y<0||(y==f.length-1?f.pop():O.call(f,y,1),--this.size,0))}},4981:(L,D,p)=>{var E=p(3503);L.exports=function S(O){var w=this.__data__,R=E(w,O);return R<0?void 0:w[R][1]}},7343:(L,D,p)=>{var E=p(3503);L.exports=function S(O){return E(this.__data__,O)>-1}},8895:(L,D,p)=>{var E=p(3503);L.exports=function S(O,w){var R=this.__data__,f=E(R,O);return f<0?(++this.size,R.push([O,w])):R[f][1]=w,this}},638:(L,D,p)=>{var E=p(4994),S=p(9215),O=p(1501);L.exports=function w(){this.size=0,this.__data__={hash:new E,map:new(O||S),string:new E}}},1184:(L,D,p)=>{var E=p(4537);L.exports=function S(O){var w=E(this,O).delete(O);return this.size-=w?1:0,w}},866:(L,D,p)=>{var E=p(4537);L.exports=function S(O){return E(this,O).get(O)}},3771:(L,D,p)=>{var E=p(4537);L.exports=function S(O){return E(this,O).has(O)}},1772:(L,D,p)=>{var E=p(4537);L.exports=function S(O,w){var R=E(this,O),f=R.size;return R.set(O,w),this.size+=R.size==f?0:1,this}},3205:L=>{L.exports=function D(p){var E=-1,S=Array(p.size);return p.forEach(function(O,w){S[++E]=[w,O]}),S}},642:L=>{L.exports=function D(p,E){return function(S){return null!=S&&S[p]===E&&(void 0!==E||p in Object(S))}}},719:(L,D,p)=>{var E=p(535);L.exports=function O(w){var R=E(w,function(y){return 500===f.size&&f.clear(),y}),f=R.cache;return R}},862:(L,D,p)=>{var S=p(3436)(Object,"create");L.exports=S},5491:(L,D,p)=>{var S=p(9385)(Object.keys,Object);L.exports=S},2158:L=>{L.exports=function D(p){var E=[];if(null!=p)for(var S in Object(p))E.push(S);return E}},3597:(L,D,p)=>{L=p.nmd(L);var E=p(9122),S=D&&!D.nodeType&&D,O=S&&L&&!L.nodeType&&L,R=O&&O.exports===S&&E.process,f=function(){try{return O&&O.require&&O.require("util").types||R&&R.binding&&R.binding("util")}catch(m){}}();L.exports=f},2902:L=>{var p=Object.prototype.toString;L.exports=function E(S){return p.call(S)}},9385:L=>{L.exports=function D(p,E){return function(S){return p(E(S))}}},3983:(L,D,p)=>{var E=p(6999),S=Math.max;L.exports=function O(w,R,f){return R=S(void 0===R?w.length-1:R,0),function(){for(var y=arguments,m=-1,T=S(y.length-R,0),g=Array(T);++m<T;)g[m]=y[R+m];m=-1;for(var C=Array(R+1);++m<R;)C[m]=y[m];return C[R]=f(g),E(w,this,C)}}},2119:(L,D,p)=>{var E=p(9122),S="object"==typeof self&&self&&self.Object===Object&&self,O=E||S||Function("return this")();L.exports=O},9351:L=>{L.exports=function D(p,E){if(("constructor"!==E||"function"!=typeof p[E])&&"__proto__"!=E)return p[E]}},4600:L=>{L.exports=function p(E){return this.__data__.set(E,"__lodash_hash_undefined__"),this}},1387:L=>{L.exports=function D(p){return this.__data__.has(p)}},4174:L=>{L.exports=function D(p){var E=-1,S=Array(p.size);return p.forEach(function(O){S[++E]=O}),S}},2185:(L,D,p)=>{var E=p(9510),O=p(29)(E);L.exports=O},29:L=>{var E=Date.now;L.exports=function S(O){var w=0,R=0;return function(){var f=E(),y=16-(f-R);if(R=f,y>0){if(++w>=800)return arguments[0]}else w=0;return O.apply(void 0,arguments)}}},3720:(L,D,p)=>{var E=p(9215);L.exports=function S(){this.__data__=new E,this.size=0}},4410:L=>{L.exports=function D(p){var E=this.__data__,S=E.delete(p);return this.size=E.size,S}},5576:L=>{L.exports=function D(p){return this.__data__.get(p)}},2247:L=>{L.exports=function D(p){return this.__data__.has(p)}},1585:(L,D,p)=>{var E=p(9215),S=p(1501),O=p(9850);L.exports=function R(f,y){var m=this.__data__;if(m instanceof E){var T=m.__data__;if(!S||T.length<199)return T.push([f,y]),this.size=++m.size,this;m=this.__data__=new O(T)}return m.set(f,y),this.size=m.size,this}},4977:L=>{L.exports=function D(p,E,S){for(var O=S-1,w=p.length;++O<w;)if(p[O]===E)return O;return-1}},2315:(L,D,p)=>{var E=p(5481),S=p(7609),O=p(1149);L.exports=function w(R){return S(R)?O(R):E(R)}},2855:(L,D,p)=>{var E=p(719),S=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,O=/\\(\\)?/g,w=E(function(R){var f=[];return 46===R.charCodeAt(0)&&f.push(""),R.replace(S,function(y,m,T,g){f.push(T?g.replace(O,"$1"):m||y)}),f});L.exports=w},8533:(L,D,p)=>{var E=p(4129);L.exports=function O(w){if("string"==typeof w||E(w))return w;var R=w+"";return"0"==R&&1/w==-1/0?"-0":R}},2827:L=>{var p=Function.prototype.toString;L.exports=function E(S){if(null!=S){try{return p.call(S)}catch(O){}try{return S+""}catch(O){}}return""}},2760:L=>{var D=/\s/;L.exports=function p(E){for(var S=E.length;S--&&D.test(E.charAt(S)););return S}},1149:L=>{var D="\\ud800-\\udfff",R="["+D+"]",f="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",y="\\ud83c[\\udffb-\\udfff]",T="[^"+D+"]",g="(?:\\ud83c[\\udde6-\\uddff]){2}",C="[\\ud800-\\udbff][\\udc00-\\udfff]",P="(?:"+f+"|"+y+")?",_="[\\ufe0e\\ufe0f]?",B=_+P+"(?:\\u200d(?:"+[T,g,C].join("|")+")"+_+P+")*",H="(?:"+[T+f+"?",f,g,C,R].join("|")+")",K=RegExp(y+"(?="+y+")|"+H+B,"g");L.exports=function V(ne){for(var se=K.lastIndex=0;K.test(ne);)++se;return se}},1094:(L,D,p)=>{var E=p(4462);L.exports=function O(w){return E(w,4)}},733:(L,D,p)=>{var E=p(4462);L.exports=function w(R){return E(R,5)}},6684:L=>{L.exports=function D(p){return function(){return p}}},8800:(L,D,p)=>{var E=p(3269),S=p(217),O=p(3342),w=p(6555),R=Object.prototype,f=R.hasOwnProperty,y=E(function(m,T){m=Object(m);var g=-1,C=T.length,v=C>2?T[2]:void 0;for(v&&O(T[0],T[1],v)&&(C=1);++g<C;)for(var P=T[g],_=w(P),x=-1,B=_.length;++x<B;){var H=_[x],K=m[H];(void 0===K||S(K,R[H])&&!f.call(m,H))&&(m[H]=P[H])}return m});L.exports=y},5474:(L,D,p)=>{L.exports=p(9851)},217:L=>{L.exports=function D(p,E){return p===E||p!=p&&E!=E}},5281:(L,D,p)=>{var E=p(9779),S=p(3609),O=p(6517),w=p(1503);L.exports=function R(f,y){return(w(f)?E:S)(f,O(y,3))}},2516:(L,D,p)=>{var O=p(4653)(p(6397));L.exports=O},6397:(L,D,p)=>{var E=p(5317),S=p(6517),O=p(4401),w=Math.max;L.exports=function R(f,y,m){var T=null==f?0:f.length;if(!T)return-1;var g=null==m?0:O(m);return g<0&&(g=w(T+g,0)),E(f,S(y,3),g)}},2274:(L,D,p)=>{var E=p(686);L.exports=function S(O){return null!=O&&O.length?E(O,1):[]}},9851:(L,D,p)=>{var E=p(6837),S=p(3132),O=p(1481),w=p(1503);L.exports=function R(f,y){return(w(f)?E:S)(f,O(y))}},1176:(L,D,p)=>{var E=p(755),S=p(1481),O=p(6555);L.exports=function w(R,f){return null==R?R:E(R,S(f),O)}},8817:(L,D,p)=>{var E=p(5456);L.exports=function S(O,w,R){var f=null==O?void 0:E(O,w);return void 0===f?R:f}},4842:(L,D,p)=>{var E=p(4781),S=p(7283);L.exports=function O(w,R){return null!=w&&S(w,R,E)}},8492:(L,D,p)=>{var E=p(9989),S=p(7283);L.exports=function O(w,R){return null!=w&&S(w,R,E)}},2608:L=>{L.exports=function D(p){return p}},7151:(L,D,p)=>{var E=p(186),S=p(2671),O=Object.prototype,w=O.hasOwnProperty,R=O.propertyIsEnumerable,f=E(function(){return arguments}())?E:function(y){return S(y)&&w.call(y,"callee")&&!R.call(y,"callee")};L.exports=f},1503:L=>{L.exports=Array.isArray},6507:(L,D,p)=>{var E=p(5946),S=p(6231);L.exports=function O(w){return null!=w&&S(w.length)&&!E(w)}},1330:(L,D,p)=>{var E=p(6507),S=p(2671);L.exports=function O(w){return S(w)&&E(w)}},891:(L,D,p)=>{L=p.nmd(L);var E=p(2119),S=p(3580),O=D&&!D.nodeType&&D,w=O&&L&&!L.nodeType&&L,f=w&&w.exports===O?E.Buffer:void 0;L.exports=(f?f.isBuffer:void 0)||S},1973:(L,D,p)=>{var E=p(1172),S=p(8794),O=p(7151),w=p(1503),R=p(6507),f=p(891),y=p(5488),m=p(8159),v=Object.prototype.hasOwnProperty;L.exports=function P(_){if(null==_)return!0;if(R(_)&&(w(_)||"string"==typeof _||"function"==typeof _.splice||f(_)||m(_)||O(_)))return!_.length;var x=S(_);if("[object Map]"==x||"[object Set]"==x)return!_.size;if(y(_))return!E(_).length;for(var B in _)if(v.call(_,B))return!1;return!0}},5946:(L,D,p)=>{var E=p(3337),S=p(5940);L.exports=function y(m){if(!S(m))return!1;var T=E(m);return"[object Function]"==T||"[object GeneratorFunction]"==T||"[object AsyncFunction]"==T||"[object Proxy]"==T}},6231:L=>{L.exports=function p(E){return"number"==typeof E&&E>-1&&E%1==0&&E<=9007199254740991}},3222:(L,D,p)=>{var E=p(7021),S=p(5647),O=p(3597),w=O&&O.isMap,R=w?S(w):E;L.exports=R},5940:L=>{L.exports=function D(p){var E=typeof p;return null!=p&&("object"==E||"function"==E)}},2671:L=>{L.exports=function D(p){return null!=p&&"object"==typeof p}},7614:(L,D,p)=>{var E=p(3337),S=p(9519),O=p(2671),y=Function.prototype.toString,m=Object.prototype.hasOwnProperty,T=y.call(Object);L.exports=function g(C){if(!O(C)||"[object Object]"!=E(C))return!1;var v=S(C);if(null===v)return!0;var P=m.call(v,"constructor")&&v.constructor;return"function"==typeof P&&P instanceof P&&y.call(P)==T}},799:(L,D,p)=>{var E=p(771),S=p(5647),O=p(3597),w=O&&O.isSet,R=w?S(w):E;L.exports=R},248:(L,D,p)=>{var E=p(3337),S=p(1503),O=p(2671);L.exports=function R(f){return"string"==typeof f||!S(f)&&O(f)&&"[object String]"==E(f)}},4129:(L,D,p)=>{var E=p(3337),S=p(2671);L.exports=function w(R){return"symbol"==typeof R||S(R)&&"[object Symbol]"==E(R)}},8159:(L,D,p)=>{var E=p(1083),S=p(5647),O=p(3597),w=O&&O.isTypedArray,R=w?S(w):E;L.exports=R},4235:L=>{L.exports=function D(p){return void 0===p}},118:(L,D,p)=>{var E=p(2271),S=p(1172),O=p(6507);L.exports=function w(R){return O(R)?E(R):S(R)}},6555:(L,D,p)=>{var E=p(2271),S=p(2809),O=p(6507);L.exports=function w(R){return O(R)?E(R,!0):S(R)}},5809:L=>{L.exports=function D(p){var E=null==p?0:p.length;return E?p[E-1]:void 0}},7489:function(L,D,p){var E;L=p.nmd(L),function(){var S,f="Expected a function",m="__lodash_hash_undefined__",g="__lodash_placeholder__",ee=1/0,Ae=9007199254740991,Le=4294967295,ft=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Se="[object Arguments]",Ie="[object Array]",Oe="[object Boolean]",Ye="[object Date]",mt="[object Error]",kt="[object Function]",Br="[object GeneratorFunction]",dn="[object Map]",Hn="[object Number]",fr="[object Object]",Xt="[object Promise]",xi="[object RegExp]",Li="[object Set]",zs="[object String]",Mi="[object Symbol]",vs="[object WeakMap]",ta="[object ArrayBuffer]",Co="[object DataView]",Ss="[object Float32Array]",Il="[object Float64Array]",Pl="[object Int8Array]",bc="[object Int16Array]",Nl="[object Int32Array]",Xr="[object Uint8Array]",vi="[object Uint8ClampedArray]",_l="[object Uint16Array]",Cc="[object Uint32Array]",Vu=/\b__p \+= '';/g,vd=/\b(__p \+=) '' \+/g,Hu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Rc=/&(?:amp|lt|gt|quot|#39);/g,Ro=/[&<>"']/g,na=RegExp(Rc.source),Si=RegExp(Ro.source),Mg=/<%-([\s\S]+?)%>/g,Sd=/<%([\s\S]+?)%>/g,Yu=/<%=([\s\S]+?)%>/g,Tc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Uu=/^\w*$/,Ad=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Oc=/[\\^$.*+?()[\]{}|]/g,As=RegExp(Oc.source),Ua=/^\s+/,Bn=/\s/,Wa=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,$s=/\{\n\/\* \[wrapped with (.+)\] \*/,yE=/,? & /,Fg=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ra=/[()=,{}\[\]\/\s]/,Wu=/\\(\\)?/g,bd=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ja=/\w*$/,Bg=/^[-+]0x[0-9a-f]+$/i,Cd=/^0b[01]+$/i,Rd=/^\[object .+?Constructor\]$/,kg=/^0o[0-7]+$/i,Gg=/^(?:0|[1-9]\d*)$/,Vg=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ic=/($^)/,Td=/['\n\r\u2028\u2029\\]/g,Pc="\\ud800-\\udfff",Ai="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ju="\\u2700-\\u27bf",Dl="a-z\\xdf-\\xf6\\xf8-\\xff",_c="A-Z\\xc0-\\xd6\\xd8-\\xde",ia="\\ufe0e\\ufe0f",z="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Dc="["+Pc+"]",ot="["+z+"]",Ks="["+Ai+"]",bt="\\d+",ze="["+ju+"]",xl="["+Dl+"]",EE="[^"+Pc+z+bt+ju+Dl+_c+"]",Hg="\\ud83c[\\udffb-\\udfff]",bi="[^"+Pc+"]",Yg="(?:\\ud83c[\\udde6-\\uddff]){2}",Pd="[\\ud800-\\udbff][\\udc00-\\udfff]",sa="["+_c+"]",$u="(?:"+xl+"|"+EE+")",Ug="(?:"+sa+"|"+EE+")",Ku="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Nd="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",xc="(?:"+Ks+"|"+Hg+")?",Wg="["+ia+"]?",Rn=Wg+xc+"(?:\\u200d(?:"+[bi,Yg,Pd].join("|")+")"+Wg+xc+")*",_d="(?:"+[ze,Yg,Pd].join("|")+")"+Rn,Dd="(?:"+[bi+Ks+"?",Ks,Yg,Pd,Dc].join("|")+")",vE=RegExp("['\u2019]","g"),gt=RegExp(Ks,"g"),Lc=RegExp(Hg+"(?="+Hg+")|"+Dd+Rn,"g"),Un=RegExp([sa+"?"+xl+"+"+Ku+"(?="+[ot,sa,"$"].join("|")+")",Ug+"+"+Nd+"(?="+[ot,sa+$u,"$"].join("|")+")",sa+"?"+$u+"+"+Ku,sa+"+"+Nd,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",bt,_d].join("|"),"g"),Mc=RegExp("[\\u200d"+Pc+Ai+ia+"]"),xd=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,zg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Oo=-1,Pn={};Pn[Ss]=Pn[Il]=Pn[Pl]=Pn[bc]=Pn[Nl]=Pn[Xr]=Pn[vi]=Pn[_l]=Pn[Cc]=!0,Pn[Se]=Pn[Ie]=Pn[ta]=Pn[Oe]=Pn[Co]=Pn[Ye]=Pn[mt]=Pn[kt]=Pn[dn]=Pn[Hn]=Pn[fr]=Pn[xi]=Pn[Li]=Pn[zs]=Pn[vs]=!1;var mn={};mn[Se]=mn[Ie]=mn[ta]=mn[Co]=mn[Oe]=mn[Ye]=mn[Ss]=mn[Il]=mn[Pl]=mn[bc]=mn[Nl]=mn[dn]=mn[Hn]=mn[fr]=mn[xi]=mn[Li]=mn[zs]=mn[Mi]=mn[Xr]=mn[vi]=mn[_l]=mn[Cc]=!0,mn[mt]=mn[kt]=mn[vs]=!1;var It={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ju=parseFloat,Kg=parseInt,Js="object"==typeof global&&global&&global.Object===Object&&global,Ze="object"==typeof self&&self&&self.Object===Object&&self,vr=Js||Ze||Function("return this")(),bs=D&&!D.nodeType&&D,Y=bs&&L&&!L.nodeType&&L,ue=Y&&Y.exports===bs,Re=ue&&Js.process,oe=function(){try{return Y&&Y.require&&Y.require("util").types||Re&&Re.binding&&Re.binding("util")}catch(Ge){}}(),Pe=oe&&oe.isArrayBuffer,Ce=oe&&oe.isDate,it=oe&&oe.isMap,ut=oe&&oe.isRegExp,dt=oe&&oe.isSet,Zt=oe&&oe.isTypedArray;function Wn(we,Ge,Fe){switch(Fe.length){case 0:return we.call(Ge);case 1:return we.call(Ge,Fe[0]);case 2:return we.call(Ge,Fe[0],Fe[1]);case 3:return we.call(Ge,Fe[0],Fe[1],Fe[2])}return we.apply(Ge,Fe)}function kr(we,Ge,Fe,at){for(var Mt=-1,bn=null==we?0:we.length;++Mt<bn;){var Nr=we[Mt];Ge(at,Nr,Fe(Nr),we)}return at}function Dt(we,Ge){for(var Fe=-1,at=null==we?0:we.length;++Fe<at&&!1!==Ge(we[Fe],Fe,we););return we}function Ri(we,Ge){for(var Fe=null==we?0:we.length;Fe--&&!1!==Ge(we[Fe],Fe,we););return we}function Bc(we,Ge){for(var Fe=-1,at=null==we?0:we.length;++Fe<at;)if(!Ge(we[Fe],Fe,we))return!1;return!0}function Zr(we,Ge){for(var Fe=-1,at=null==we?0:we.length,Mt=0,bn=[];++Fe<at;){var Nr=we[Fe];Ge(Nr,Fe,we)&&(bn[Mt++]=Nr)}return bn}function Ti(we,Ge){return!(null==we||!we.length)&&Mn(we,Ge,0)>-1}function qs(we,Ge,Fe){for(var at=-1,Mt=null==we?0:we.length;++at<Mt;)if(Fe(Ge,we[at]))return!0;return!1}function Nn(we,Ge){for(var Fe=-1,at=null==we?0:we.length,Mt=Array(at);++Fe<at;)Mt[Fe]=Ge(we[Fe],Fe,we);return Mt}function za(we,Ge){for(var Fe=-1,at=Ge.length,Mt=we.length;++Fe<at;)we[Mt+Fe]=Ge[Fe];return we}function Zn(we,Ge,Fe,at){var Mt=-1,bn=null==we?0:we.length;for(at&&bn&&(Fe=we[++Mt]);++Mt<bn;)Fe=Ge(Fe,we[Mt],Mt,we);return Fe}function XA(we,Ge,Fe,at){var Mt=null==we?0:we.length;for(at&&Mt&&(Fe=we[--Mt]);Mt--;)Fe=Ge(Fe,we[Mt],Mt,we);return Fe}function Md(we,Ge){for(var Fe=-1,at=null==we?0:we.length;++Fe<at;)if(Ge(we[Fe],Fe,we))return!0;return!1}var SE=aa("length");function bE(we,Ge,Fe){var at;return Fe(we,function(Mt,bn,Nr){if(Ge(Mt,bn,Nr))return at=bn,!1}),at}function qu(we,Ge,Fe,at){for(var Mt=we.length,bn=Fe+(at?1:-1);at?bn--:++bn<Mt;)if(Ge(we[bn],bn,we))return bn;return-1}function Mn(we,Ge,Fe){return Ge==Ge?function Xu(we,Ge,Fe){for(var at=Fe-1,Mt=we.length;++at<Mt;)if(we[at]===Ge)return at;return-1}(we,Ge,Fe):qu(we,Gr,Fe)}function Fi(we,Ge,Fe,at){for(var Mt=Fe-1,bn=we.length;++Mt<bn;)if(at(we[Mt],Ge))return Mt;return-1}function Gr(we){return we!=we}function oa(we,Ge){var Fe=null==we?0:we.length;return Fe?Ll(we,Ge)/Fe:NaN}function aa(we){return function(Ge){return null==Ge?S:Ge[we]}}function Bi(we){return function(Ge){return null==we?S:we[Ge]}}function Qu(we,Ge,Fe,at,Mt){return Mt(we,function(bn,Nr,Fn){Fe=at?(at=!1,bn):Ge(Fe,bn,Nr,Fn)}),Fe}function Ll(we,Ge){for(var Fe,at=-1,Mt=we.length;++at<Mt;){var bn=Ge(we[at]);bn!==S&&(Fe=Fe===S?bn:Fe+bn)}return Fe}function kc(we,Ge){for(var Fe=-1,at=Array(we);++Fe<we;)at[Fe]=Ge(Fe);return at}function Vr(we){return we&&we.slice(0,CE(we)+1).replace(Ua,"")}function rs(we){return function(Ge){return we(Ge)}}function ki(we,Ge){return Nn(Ge,function(Fe){return we[Fe]})}function tt(we,Ge){return we.has(Ge)}function Kt(we,Ge){for(var Fe=-1,at=we.length;++Fe<at&&Mn(Ge,we[Fe],0)>-1;);return Fe}function kn(we,Ge){for(var Fe=we.length;Fe--&&Mn(Ge,we[Fe],0)>-1;);return Fe}function is(we,Ge){for(var Fe=we.length,at=0;Fe--;)we[Fe]===Ge&&++at;return at}var Fl=Bi({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Pr=Bi({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Bl(we){return"\\"+It[we]}function Io(we){return Mc.test(we)}function Vc(we){var Ge=-1,Fe=Array(we.size);return we.forEach(function(at,Mt){Fe[++Ge]=[Mt,at]}),Fe}function kl(we,Ge){return function(Fe){return we(Ge(Fe))}}function Po(we,Ge){for(var Fe=-1,at=we.length,Mt=0,bn=[];++Fe<at;){var Nr=we[Fe];(Nr===Ge||Nr===g)&&(we[Fe]=g,bn[Mt++]=Fe)}return bn}function la(we){var Ge=-1,Fe=Array(we.size);return we.forEach(function(at){Fe[++Ge]=at}),Fe}function ei(we){return Io(we)?function No(we){for(var Ge=Lc.lastIndex=0;Lc.test(we);)++Ge;return Ge}(we):SE(we)}function rn(we){return Io(we)?function Qs(we){return we.match(Lc)||[]}(we):function AE(we){return we.split("")}(we)}function CE(we){for(var Ge=we.length;Ge--&&Bn.test(we.charAt(Ge)););return Ge}var ZA=Bi({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Gl=function we(Ge){var u,Fe=(Ge=null==Ge?vr:Gl.defaults(vr.Object(),Ge,Gl.pick(vr,zg))).Array,at=Ge.Date,Mt=Ge.Error,bn=Ge.Function,Nr=Ge.Math,Fn=Ge.Object,RE=Ge.RegExp,aI=Ge.String,Xs=Ge.TypeError,Qg=Fe.prototype,Zu=Fn.prototype,Xg=Ge["__core-js_shared__"],Zg=bn.prototype.toString,_n=Zu.hasOwnProperty,cI=0,eb=(u=/[^.]+$/.exec(Xg&&Xg.keys&&Xg.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",eh=Zu.toString,ep=Zg.call(Fn),uI=vr._,hI=RE("^"+Zg.call(_n).replace(Oc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tp=ue?Ge.Buffer:S,Vi=Ge.Symbol,Bd=Ge.Uint8Array,ca=tp?tp.allocUnsafe:S,th=kl(Fn.getPrototypeOf,Fn),TE=Fn.create,OE=Zu.propertyIsEnumerable,nh=Qg.splice,np=Vi?Vi.isConcatSpreadable:S,rh=Vi?Vi.iterator:S,ua=Vi?Vi.toStringTag:S,kd=function(){try{var u=ql(Fn,"defineProperty");return u({},"",{}),u}catch(h){}}(),Cs=Ge.clearTimeout!==vr.clearTimeout&&Ge.clearTimeout,rp=at&&at.now!==vr.Date.now&&at.now,tb=Ge.setTimeout!==vr.setTimeout&&Ge.setTimeout,Yc=Nr.ceil,Gd=Nr.floor,ip=Fn.getOwnPropertySymbols,sp=tp?tp.isBuffer:S,IE=Ge.isFinite,op=Qg.join,dI=kl(Fn.keys,Fn),jt=Nr.max,Hr=Nr.min,nb=at.now,mr=Ge.parseInt,PE=Nr.random,fI=Qg.reverse,Uc=ql(Ge,"DataView"),ti=ql(Ge,"Map"),ap=ql(Ge,"Promise"),$a=ql(Ge,"Set"),_o=ql(Ge,"WeakMap"),Yr=ql(Fn,"create"),ih=_o&&new _o,Ka={},rb=ii(Uc),Ja=ii(ti),NE=ii(ap),lp=ii($a),Nt=ii(_o),cp=Vi?Vi.prototype:S,sh=cp?cp.valueOf:S,_E=cp?cp.toString:S;function q(u){if(Qn(u)&&!Ft(u)&&!(u instanceof Be)){if(u instanceof Rs)return u;if(_n.call(u,"__wrapped__"))return Hp(u)}return new Rs(u)}var Vl=function(){function u(){}return function(h){if(!jn(h))return{};if(TE)return TE(h);u.prototype=h;var I=new u;return u.prototype=S,I}}();function Vd(){}function Rs(u,h){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=S}function Be(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Le,this.__views__=[]}function qa(u){var h=-1,I=null==u?0:u.length;for(this.clear();++h<I;){var M=u[h];this.set(M[0],M[1])}}function ha(u){var h=-1,I=null==u?0:u.length;for(this.clear();++h<I;){var M=u[h];this.set(M[0],M[1])}}function Hi(u){var h=-1,I=null==u?0:u.length;for(this.clear();++h<I;){var M=u[h];this.set(M[0],M[1])}}function ga(u){var h=-1,I=null==u?0:u.length;for(this.__data__=new Hi;++h<I;)this.add(u[h])}function ss(u){var h=this.__data__=new ha(u);this.size=h.size}function fp(u,h){var I=Ft(u),M=!I&&Zl(u),U=!I&&!M&&Sa(u),X=!I&&!M&&!U&&il(u),pe=I||M||U||X,ye=pe?kc(u.length,aI):[],be=ye.length;for(var Ve in u)(h||_n.call(u,Ve))&&(!pe||!("length"==Ve||U&&("offset"==Ve||"parent"==Ve)||X&&("buffer"==Ve||"byteLength"==Ve||"byteOffset"==Ve)||Bo(Ve,be)))&&ye.push(Ve);return ye}function gp(u){var h=u.length;return h?u[Za(0,h-1)]:S}function Wd(u,h){return hf(Yi(u),Hl(h,0,u.length))}function lb(u){return hf(Yi(u))}function pp(u,h,I){(I!==S&&!Ds(u[h],I)||I===S&&!(h in u))&&pa(u,h,I)}function Ar(u,h,I){var M=u[h];(!_n.call(u,h)||!Ds(M,I)||I===S&&!(h in u))&&pa(u,h,I)}function Zs(u,h){for(var I=u.length;I--;)if(Ds(u[I][0],h))return I;return-1}function er(u,h,I,M){return ma(u,function(U,X,pe){h(M,U,I(U),pe)}),M}function tr(u,h){return u&&Mo(h,_r(h),u)}function pa(u,h,I){"__proto__"==h&&kd?kd(u,h,{configurable:!0,enumerable:!0,value:I,writable:!0}):u[h]=I}function mp(u,h){for(var I=-1,M=h.length,U=Fe(M),X=null==u;++I<M;)U[I]=X?S:Dh(u,h[I]);return U}function Hl(u,h,I){return u==u&&(I!==S&&(u=u<=I?u:I),h!==S&&(u=u>=h?u:h)),u}function Os(u,h,I,M,U,X){var pe,ye=1&h,be=2&h,Ve=4&h;if(I&&(pe=U?I(u,M,U,X):I(u)),pe!==S)return pe;if(!jn(u))return u;var He=Ft(u);if(He){if(pe=function Ab(u){var h=u.length,I=new u.constructor(h);return h&&"string"==typeof u[0]&&_n.call(u,"index")&&(I.index=u.index,I.input=u.input),I}(u),!ye)return Yi(u,pe)}else{var We=ni(u),rt=We==kt||We==Br;if(Sa(u))return ew(u,ye);if(We==fr||We==Se||rt&&!U){if(pe=be||rt?{}:uw(u),!ye)return be?function Eb(u,h){return Mo(u,cw(u),h)}(u,function cb(u,h){return u&&Mo(h,ai(h),u)}(pe,u)):function yb(u,h){return Mo(u,Fp(u),h)}(u,tr(pe,u))}else{if(!mn[We])return U?u:{};pe=function vI(u,h,I){var M=u.constructor;switch(h){case ta:return tw(u);case Oe:case Ye:return new M(+u);case Co:return function yI(u,h){var I=h?tw(u.buffer):u.buffer;return new u.constructor(I,u.byteOffset,u.byteLength)}(u,I);case Ss:case Il:case Pl:case bc:case Nl:case Xr:case vi:case _l:case Cc:return ef(u,I);case dn:return new M;case Hn:case zs:return new M(u);case xi:return function nw(u){var h=new u.constructor(u.source,ja.exec(u));return h.lastIndex=u.lastIndex,h}(u);case Li:return new M;case Mi:return function as(u){return sh?Fn(sh.call(u)):{}}(u)}}(u,We,ye)}}X||(X=new ss);var ht=X.get(u);if(ht)return ht;X.set(u,pe),bC(u)?u.forEach(function(St){pe.add(Os(St,h,I,St,u,X))}):_h(u)&&u.forEach(function(St,en){pe.set(en,Os(St,h,I,en,u,X))});var Ut=He?S:(Ve?be?xp:rf:be?ai:_r)(u);return Dt(Ut||u,function(St,en){Ut&&(St=u[en=St]),Ar(pe,en,Os(St,h,I,en,u,X))}),pe}function ah(u,h,I){var M=I.length;if(null==u)return!M;for(u=Fn(u);M--;){var U=I[M],pe=u[U];if(pe===S&&!(U in u)||!(0,h[U])(pe))return!1}return!0}function lh(u,h,I){if("function"!=typeof u)throw new Xs(f);return Sh(function(){u.apply(S,I)},h)}function Yl(u,h,I,M){var U=-1,X=Ti,pe=!0,ye=u.length,be=[],Ve=h.length;if(!ye)return be;I&&(h=Nn(h,rs(I))),M?(X=qs,pe=!1):h.length>=200&&(X=tt,pe=!1,h=new ga(h));e:for(;++U<ye;){var He=u[U],We=null==I?He:I(He);if(He=M||0!==He?He:0,pe&&We==We){for(var rt=Ve;rt--;)if(h[rt]===We)continue e;be.push(He)}else X(h,We,M)||be.push(He)}return be}q.templateSettings={escape:Mg,evaluate:Sd,interpolate:Yu,variable:"",imports:{_:q}},(q.prototype=Vd.prototype).constructor=q,(Rs.prototype=Vl(Vd.prototype)).constructor=Rs,(Be.prototype=Vl(Vd.prototype)).constructor=Be,qa.prototype.clear=function oh(){this.__data__=Yr?Yr(null):{},this.size=0},qa.prototype.delete=function Do(u){var h=this.has(u)&&delete this.__data__[u];return this.size-=h?1:0,h},qa.prototype.get=function up(u){var h=this.__data__;if(Yr){var I=h[u];return I===m?S:I}return _n.call(h,u)?h[u]:S},qa.prototype.has=function hp(u){var h=this.__data__;return Yr?h[u]!==S:_n.call(h,u)},qa.prototype.set=function gI(u,h){var I=this.__data__;return this.size+=this.has(u)?0:1,I[u]=Yr&&h===S?m:h,this},ha.prototype.clear=function Hd(){this.__data__=[],this.size=0},ha.prototype.delete=function Yd(u){var h=this.__data__,I=Zs(h,u);return!(I<0||(I==h.length-1?h.pop():nh.call(h,I,1),--this.size,0))},ha.prototype.get=function Oi(u){var h=this.__data__,I=Zs(h,u);return I<0?S:h[I][1]},ha.prototype.has=function da(u){return Zs(this.__data__,u)>-1},ha.prototype.set=function DE(u,h){var I=this.__data__,M=Zs(I,u);return M<0?(++this.size,I.push([u,h])):I[M][1]=h,this},Hi.prototype.clear=function fa(){this.size=0,this.__data__={hash:new qa,map:new(ti||ha),string:new qa}},Hi.prototype.delete=function ib(u){var h=Mp(this,u).delete(u);return this.size-=h?1:0,h},Hi.prototype.get=function xE(u){return Mp(this,u).get(u)},Hi.prototype.has=function sb(u){return Mp(this,u).has(u)},Hi.prototype.set=function ob(u,h){var I=Mp(this,u),M=I.size;return I.set(u,h),this.size+=I.size==M?0:1,this},ga.prototype.add=ga.prototype.push=function dp(u){return this.__data__.set(u,m),this},ga.prototype.has=function LE(u){return this.__data__.has(u)},ss.prototype.clear=function ab(){this.__data__=new ha,this.size=0},ss.prototype.delete=function ME(u){var h=this.__data__,I=h.delete(u);return this.size=h.size,I},ss.prototype.get=function Ud(u){return this.__data__.get(u)},ss.prototype.has=function FE(u){return this.__data__.has(u)},ss.prototype.set=function BE(u,h){var I=this.__data__;if(I instanceof ha){var M=I.__data__;if(!ti||M.length<199)return M.push([u,h]),this.size=++I.size,this;I=this.__data__=new Hi(M)}return I.set(u,h),this.size=I.size,this};var ma=ph(xo),kE=ph(HE,!0);function Qa(u,h){var I=!0;return ma(u,function(M,U,X){return I=!!h(M,U,X)}),I}function Xa(u,h,I){for(var M=-1,U=u.length;++M<U;){var X=u[M],pe=h(X);if(null!=pe&&(ye===S?pe==pe&&!oi(pe):I(pe,ye)))var ye=pe,be=X}return be}function GE(u,h){var I=[];return ma(u,function(M,U,X){h(M,U,X)&&I.push(M)}),I}function sr(u,h,I,M,U){var X=-1,pe=u.length;for(I||(I=kp),U||(U=[]);++X<pe;){var ye=u[X];h>0&&I(ye)?h>1?sr(ye,h-1,I,M,U):za(U,ye):M||(U[U.length]=ye)}return U}var ch=wb(),VE=wb(!0);function xo(u,h){return u&&ch(u,h,_r)}function HE(u,h){return u&&VE(u,h,_r)}function yp(u,h){return Zr(h,function(I){return Aa(u[I])})}function Lo(u,h){for(var I=0,M=(h=to(h,u)).length;null!=u&&I<M;)u=u[no(h[I++])];return I&&I==M?u:S}function Ep(u,h,I){var M=h(u);return Ft(u)?M:za(M,I(u))}function Ur(u){return null==u?u===S?"[object Undefined]":"[object Null]":ua&&ua in Fn(u)?function wI(u){var h=_n.call(u,ua),I=u[ua];try{u[ua]=S;var M=!0}catch(X){}var U=eh.call(u);return M&&(h?u[ua]=I:delete u[ua]),U}(u):function Tb(u){return eh.call(u)}(u)}function Wc(u,h){return u>h}function YE(u,h){return null!=u&&_n.call(u,h)}function UE(u,h){return null!=u&&h in Fn(u)}function wp(u,h,I){for(var M=I?qs:Ti,U=u[0].length,X=u.length,pe=X,ye=Fe(X),be=1/0,Ve=[];pe--;){var He=u[pe];pe&&h&&(He=Nn(He,rs(h))),be=Hr(He.length,be),ye[pe]=!I&&(h||U>=120&&He.length>=120)?new ga(pe&&He):S}He=u[0];var We=-1,rt=ye[0];e:for(;++We<U&&Ve.length<be;){var ht=He[We],Ct=h?h(ht):ht;if(ht=I||0!==ht?ht:0,!(rt?tt(rt,Ct):M(Ve,Ct,I))){for(pe=X;--pe;){var Ut=ye[pe];if(!(Ut?tt(Ut,Ct):M(u[pe],Ct,I)))continue e}rt&&rt.push(Ct),Ve.push(ht)}}return Ve}function Ul(u,h,I){var M=null==(u=gw(u,h=to(h,u)))?u:u[no(ls(h))];return null==M?S:Wn(M,u,I)}function uh(u){return Qn(u)&&Ur(u)==Se}function $c(u,h,I,M,U){return u===h||(null==u||null==h||!Qn(u)&&!Qn(h)?u!=u&&h!=h:function hb(u,h,I,M,U,X){var pe=Ft(u),ye=Ft(h),be=pe?Ie:ni(u),Ve=ye?Ie:ni(h),He=(be=be==Se?fr:be)==fr,We=(Ve=Ve==Se?fr:Ve)==fr,rt=be==Ve;if(rt&&Sa(u)){if(!Sa(h))return!1;pe=!0,He=!1}if(rt&&!He)return X||(X=new ss),pe||il(u)?aw(u,h,I,M,U,X):function lw(u,h,I,M,U,X,pe){switch(I){case Co:if(u.byteLength!=h.byteLength||u.byteOffset!=h.byteOffset)return!1;u=u.buffer,h=h.buffer;case ta:return!(u.byteLength!=h.byteLength||!X(new Bd(u),new Bd(h)));case Oe:case Ye:case Hn:return Ds(+u,+h);case mt:return u.name==h.name&&u.message==h.message;case xi:case zs:return u==h+"";case dn:var ye=Vc;case Li:if(ye||(ye=la),u.size!=h.size&&!(1&M))return!1;var Ve=pe.get(u);if(Ve)return Ve==h;M|=2,pe.set(u,h);var He=aw(ye(u),ye(h),M,U,X,pe);return pe.delete(u),He;case Mi:if(sh)return sh.call(u)==sh.call(h)}return!1}(u,h,be,I,M,U,X);if(!(1&I)){var ht=He&&_n.call(u,"__wrapped__"),Ct=We&&_n.call(h,"__wrapped__");if(ht||Ct){var Ut=ht?u.value():u,St=Ct?h.value():h;return X||(X=new ss),U(Ut,St,I,M,X)}}return!!rt&&(X||(X=new ss),function Dp(u,h,I,M,U,X){var pe=1&I,ye=rf(u),be=ye.length;if(be!=rf(h).length&&!pe)return!1;for(var We=be;We--;){var rt=ye[We];if(!(pe?rt in h:_n.call(h,rt)))return!1}var ht=X.get(u),Ct=X.get(h);if(ht&&Ct)return ht==h&&Ct==u;var Ut=!0;X.set(u,h),X.set(h,u);for(var St=pe;++We<be;){var en=u[rt=ye[We]],cn=h[rt];if(M)var Ls=pe?M(cn,en,rt,h,u,X):M(en,cn,rt,u,h,X);if(!(Ls===S?en===cn||U(en,cn,I,M,X):Ls)){Ut=!1;break}St||(St="constructor"==rt)}if(Ut&&!St){var zr=u.constructor,hs=h.constructor;zr!=hs&&"constructor"in u&&"constructor"in h&&!("function"==typeof zr&&zr instanceof zr&&"function"==typeof hs&&hs instanceof hs)&&(Ut=!1)}return X.delete(u),X.delete(h),Ut}(u,h,I,M,U,X))}(u,h,I,M,$c,U))}function Wl(u,h,I,M){var U=I.length,X=U,pe=!M;if(null==u)return!X;for(u=Fn(u);U--;){var ye=I[U];if(pe&&ye[2]?ye[1]!==u[ye[0]]:!(ye[0]in u))return!1}for(;++U<X;){var be=(ye=I[U])[0],Ve=u[be],He=ye[1];if(pe&&ye[2]){if(Ve===S&&!(be in u))return!1}else{var We=new ss;if(M)var rt=M(Ve,He,be,u,h,We);if(!(rt===S?$c(He,Ve,3,M,We):rt))return!1}}return!0}function zd(u){return!(!jn(u)||function bb(u){return!!eb&&eb in u}(u))&&(Aa(u)?hI:Rd).test(ii(u))}function jE(u){return"function"==typeof u?u:null==u?li:"object"==typeof u?Ft(u)?KE(u[0],u[1]):$E(u):Fm(u)}function Jd(u){if(!vh(u))return dI(u);var h=[];for(var I in Fn(u))_n.call(u,I)&&"constructor"!=I&&h.push(I);return h}function qd(u,h){return u<h}function Sp(u,h){var I=-1,M=Wi(u)?Fe(u.length):[];return ma(u,function(U,X,pe){M[++I]=h(U,X,pe)}),M}function $E(u){var h=sf(u);return 1==h.length&&h[0][2]?Ui(h[0][0],h[0][1]):function(I){return I===u||Wl(I,u,h)}}function KE(u,h){return cf(u)&&hw(h)?Ui(no(u),h):function(I){var M=Dh(I,u);return M===S&&M===h?xh(I,u):$c(h,M,3)}}function jl(u,h,I,M,U){u!==h&&ch(h,function(X,pe){if(U||(U=new ss),jn(X))!function hh(u,h,I,M,U,X,pe){var ye=uf(u,I),be=uf(h,I),Ve=pe.get(be);if(Ve)pp(u,I,Ve);else{var He=X?X(ye,be,I+"",u,h,pe):S,We=He===S;if(We){var rt=Ft(be),ht=!rt&&Sa(be),Ct=!rt&&!ht&&il(be);He=be,rt||ht||Ct?Ft(ye)?He=ye:En(ye)?He=Yi(ye):ht?(We=!1,He=ew(be,!0)):Ct?(We=!1,He=ef(be,!0)):He=[]:ec(be)||Zl(be)?(He=ye,Zl(ye)?He=OC(ye):(!jn(ye)||Aa(ye))&&(He=uw(be))):We=!1}We&&(pe.set(be,He),U(He,be,M,X,pe),pe.delete(be)),pp(u,I,He)}}(u,h,pe,I,jl,M,U);else{var ye=M?M(uf(u,pe),X,pe+"",u,h,U):S;ye===S&&(ye=X),pp(u,pe,ye)}},ai)}function JE(u,h){var I=u.length;if(I)return Bo(h+=h<0?I:0,I)?u[h]:S}function Ap(u,h,I){h=h.length?Nn(h,function(X){return Ft(X)?function(pe){return Lo(pe,1===X.length?X[0]:X)}:X}):[li];var M=-1;return h=Nn(h,rs(yt())),function Jg(we,Ge){var Fe=we.length;for(we.sort(Ge);Fe--;)we[Fe]=we[Fe].value;return we}(Sp(u,function(X,pe,ye){return{criteria:Nn(h,function(Ve){return Ve(X)}),index:++M,value:X}}),function(X,pe){return function EI(u,h,I){for(var M=-1,U=u.criteria,X=h.criteria,pe=U.length,ye=I.length;++M<pe;){var be=Jl(U[M],X[M]);if(be)return M>=ye?be:be*("desc"==I[M]?-1:1)}return u.index-h.index}(X,pe,I)})}function zl(u,h,I){for(var M=-1,U=h.length,X={};++M<U;){var pe=h[M],ye=Lo(u,pe);I(ye,pe)&&Qd(X,to(pe,u),ye)}return X}function dh(u,h,I,M){var U=M?Fi:Mn,X=-1,pe=h.length,ye=u;for(u===h&&(h=Yi(h)),I&&(ye=Nn(u,rs(I)));++X<pe;)for(var be=0,Ve=h[X],He=I?I(Ve):Ve;(be=U(ye,He,be,M))>-1;)ye!==u&&nh.call(ye,be,1),nh.call(u,be,1);return u}function $l(u,h){for(var I=u?h.length:0,M=I-1;I--;){var U=h[I];if(I==M||U!==X){var X=U;Bo(U)?nh.call(u,U,1):or(u,U)}}return u}function Za(u,h){return u+Gd(PE()*(h-u+1))}function el(u,h){var I="";if(!u||h<1||h>Ae)return I;do{h%2&&(I+=u),(h=Gd(h/2))&&(u+=u)}while(h);return I}function zt(u,h){return Vp(fw(u,h,li),u+"")}function Cp(u){return gp(au(u))}function Jc(u,h){var I=au(u);return hf(I,Hl(h,0,I.length))}function Qd(u,h,I,M){if(!jn(u))return u;for(var U=-1,X=(h=to(h,u)).length,pe=X-1,ye=u;null!=ye&&++U<X;){var be=no(h[U]),Ve=I;if("__proto__"===be||"constructor"===be||"prototype"===be)return u;if(U!=pe){var He=ye[be];(Ve=M?M(He,be,ye):S)===S&&(Ve=jn(He)?He:Bo(h[U+1])?[]:{})}Ar(ye,be,Ve),ye=ye[be]}return u}var QE=ih?function(u,h){return ih.set(u,h),u}:li,pt=kd?function(u,h){return kd(u,"toString",{configurable:!0,enumerable:!1,value:Fh(h),writable:!0})}:li;function fb(u){return hf(au(u))}function eo(u,h,I){var M=-1,U=u.length;h<0&&(h=-h>U?0:U+h),(I=I>U?U:I)<0&&(I+=U),U=h>I?0:I-h>>>0,h>>>=0;for(var X=Fe(U);++M<U;)X[M]=u[M+h];return X}function mI(u,h){var I;return ma(u,function(M,U,X){return!(I=h(M,U,X))}),!!I}function Rp(u,h,I){var M=0,U=null==u?M:u.length;if("number"==typeof h&&h==h&&U<=2147483647){for(;M<U;){var X=M+U>>>1,pe=u[X];null!==pe&&!oi(pe)&&(I?pe<=h:pe<h)?M=X+1:U=X}return U}return XE(u,h,li,I)}function XE(u,h,I,M){var U=0,X=null==u?0:u.length;if(0===X)return 0;for(var pe=(h=I(h))!=h,ye=null===h,be=oi(h),Ve=h===S;U<X;){var He=Gd((U+X)/2),We=I(u[He]),rt=We!==S,ht=null===We,Ct=We==We,Ut=oi(We);if(pe)var St=M||Ct;else St=Ve?Ct&&(M||rt):ye?Ct&&rt&&(M||!ht):be?Ct&&rt&&!ht&&(M||!Ut):!ht&&!Ut&&(M?We<=h:We<h);St?U=He+1:X=He}return Hr(X,4294967294)}function gb(u,h){for(var I=-1,M=u.length,U=0,X=[];++I<M;){var pe=u[I],ye=h?h(pe):pe;if(!I||!Ds(ye,be)){var be=ye;X[U++]=0===pe?0:pe}}return X}function pb(u){return"number"==typeof u?u:oi(u)?NaN:+u}function Wr(u){if("string"==typeof u)return u;if(Ft(u))return Nn(u,Wr)+"";if(oi(u))return _E?_E.call(u):"";var h=u+"";return"0"==h&&1/u==-ee?"-0":h}function Kl(u,h,I){var M=-1,U=Ti,X=u.length,pe=!0,ye=[],be=ye;if(I)pe=!1,U=qs;else if(X>=200){var Ve=h?null:Sb(u);if(Ve)return la(Ve);pe=!1,U=tt,be=new ga}else be=h?[]:ye;e:for(;++M<X;){var He=u[M],We=h?h(He):He;if(He=I||0!==He?He:0,pe&&We==We){for(var rt=be.length;rt--;)if(be[rt]===We)continue e;h&&be.push(We),ye.push(He)}else U(be,We,I)||(be!==ye&&be.push(We),ye.push(He))}return ye}function or(u,h){return null==(u=gw(u,h=to(h,u)))||delete u[no(ls(h))]}function Xd(u,h,I,M){return Qd(u,h,I(Lo(u,h)),M)}function tl(u,h,I,M){for(var U=u.length,X=M?U:-1;(M?X--:++X<U)&&h(u[X],X,u););return I?eo(u,M?0:X,M?X+1:U):eo(u,M?X+1:0,M?U:X)}function mb(u,h){var I=u;return I instanceof Be&&(I=I.value()),Zn(h,function(M,U){return U.func.apply(U.thisArg,za([M],U.args))},I)}function Tp(u,h,I){var M=u.length;if(M<2)return M?Kl(u[0]):[];for(var U=-1,X=Fe(M);++U<M;)for(var pe=u[U],ye=-1;++ye<M;)ye!=U&&(X[U]=Yl(X[U]||pe,u[ye],h,I));return Kl(sr(X,1),h,I)}function os(u,h,I){for(var M=-1,U=u.length,X=h.length,pe={};++M<U;)I(pe,u[M],M<X?h[M]:S);return pe}function Is(u){return En(u)?u:[]}function Zd(u){return"function"==typeof u?u:li}function to(u,h){return Ft(u)?u:cf(u,h)?[u]:eu(wn(u))}var fh=zt;function ya(u,h,I){var M=u.length;return I=I===S?M:I,!h&&I>=M?u:eo(u,h,I)}var ZE=Cs||function(u){return vr.clearTimeout(u)};function ew(u,h){if(h)return u.slice();var I=u.length,M=ca?ca(I):new u.constructor(I);return u.copy(M),M}function tw(u){var h=new u.constructor(u.byteLength);return new Bd(h).set(new Bd(u)),h}function ef(u,h){var I=h?tw(u.buffer):u.buffer;return new u.constructor(I,u.byteOffset,u.length)}function Jl(u,h){if(u!==h){var I=u!==S,M=null===u,U=u==u,X=oi(u),pe=h!==S,ye=null===h,be=h==h,Ve=oi(h);if(!ye&&!Ve&&!X&&u>h||X&&pe&&be&&!ye&&!Ve||M&&pe&&be||!I&&be||!U)return 1;if(!M&&!X&&!Ve&&u<h||Ve&&I&&U&&!M&&!X||ye&&I&&U||!pe&&U||!be)return-1}return 0}function Op(u,h,I,M){for(var U=-1,X=u.length,pe=I.length,ye=-1,be=h.length,Ve=jt(X-pe,0),He=Fe(be+Ve),We=!M;++ye<be;)He[ye]=h[ye];for(;++U<pe;)(We||U<X)&&(He[I[U]]=u[U]);for(;Ve--;)He[ye++]=u[U++];return He}function rw(u,h,I,M){for(var U=-1,X=u.length,pe=-1,ye=I.length,be=-1,Ve=h.length,He=jt(X-ye,0),We=Fe(He+Ve),rt=!M;++U<He;)We[U]=u[U];for(var ht=U;++be<Ve;)We[ht+be]=h[be];for(;++pe<ye;)(rt||U<X)&&(We[ht+I[pe]]=u[U++]);return We}function Yi(u,h){var I=-1,M=u.length;for(h||(h=Fe(M));++I<M;)h[I]=u[I];return h}function Mo(u,h,I,M){var U=!I;I||(I={});for(var X=-1,pe=h.length;++X<pe;){var ye=h[X],be=M?M(I[ye],u[ye],ye,I,u):S;be===S&&(be=u[ye]),U?pa(I,ye,be):Ar(I,ye,be)}return I}function gh(u,h){return function(I,M){var U=Ft(I)?kr:er,X=h?h():{};return U(I,u,yt(M,2),X)}}function nl(u){return zt(function(h,I){var M=-1,U=I.length,X=U>1?I[U-1]:S,pe=U>2?I[2]:S;for(X=u.length>3&&"function"==typeof X?(U--,X):S,pe&&ri(I[0],I[1],pe)&&(X=U<3?S:X,U=1),h=Fn(h);++M<U;){var ye=I[M];ye&&u(h,ye,M,X)}return h})}function ph(u,h){return function(I,M){if(null==I)return I;if(!Wi(I))return u(I,M);for(var U=I.length,X=h?U:-1,pe=Fn(I);(h?X--:++X<U)&&!1!==M(pe[X],X,pe););return I}}function wb(u){return function(h,I,M){for(var U=-1,X=Fn(h),pe=M(h),ye=pe.length;ye--;){var be=pe[u?ye:++U];if(!1===I(X[be],be,X))break}return h}}function tf(u){return function(h){var I=Io(h=wn(h))?rn(h):S,M=I?I[0]:h.charAt(0),U=I?ya(I,1).join(""):h.slice(1);return M[u]()+U}}function Ea(u){return function(h){return Zn($C(av(h).replace(vE,"")),u,"")}}function yh(u){return function(){var h=arguments;switch(h.length){case 0:return new u;case 1:return new u(h[0]);case 2:return new u(h[0],h[1]);case 3:return new u(h[0],h[1],h[2]);case 4:return new u(h[0],h[1],h[2],h[3]);case 5:return new u(h[0],h[1],h[2],h[3],h[4]);case 6:return new u(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new u(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var I=Vl(u.prototype),M=u.apply(I,h);return jn(M)?M:I}}function iw(u){return function(h,I,M){var U=Fn(h);if(!Wi(h)){var X=yt(I,3);h=_r(h),I=function(ye){return X(U[ye],ye,U)}}var pe=u(h,I,M);return pe>-1?U[X?h[pe]:pe]:S}}function Ip(u){return _s(function(h){var I=h.length,M=I,U=Rs.prototype.thru;for(u&&h.reverse();M--;){var X=h[M];if("function"!=typeof X)throw new Xs(f);if(U&&!pe&&"wrapper"==wa(X))var pe=new Rs([],!0)}for(M=pe?M:I;++M<I;){var ye=wa(X=h[M]),be="wrapper"==ye?Lp(X):S;pe=be&&Gp(be[0])&&424==be[1]&&!be[4].length&&1==be[9]?pe[wa(be[0])].apply(pe,be[3]):1==X.length&&Gp(X)?pe[ye]():pe.thru(X)}return function(){var Ve=arguments,He=Ve[0];if(pe&&1==Ve.length&&Ft(He))return pe.plant(He).value();for(var We=0,rt=I?h[We].apply(this,Ve):He;++We<I;)rt=h[We].call(this,rt);return rt}})}function nf(u,h,I,M,U,X,pe,ye,be,Ve){var He=128&h,We=1&h,rt=2&h,ht=24&h,Ct=512&h,Ut=rt?S:yh(u);return function St(){for(var en=arguments.length,cn=Fe(en),Ls=en;Ls--;)cn[Ls]=arguments[Ls];if(ht)var zr=Fo(St),hs=is(cn,zr);if(M&&(cn=Op(cn,M,U,ht)),X&&(cn=rw(cn,X,pe,ht)),en-=hs,ht&&en<Ve){var nr=Po(cn,zr);return Xc(u,h,nf,St.placeholder,I,cn,nr,ye,be,Ve-en)}var Ms=We?I:this,al=rt?Ms[u]:u;return en=cn.length,ye?cn=Ob(cn,ye):Ct&&en>1&&cn.reverse(),He&&be<en&&(cn.length=be),this&&this!==vr&&this instanceof St&&(al=Ut||yh(al)),al.apply(Ms,cn)}}function qc(u,h){return function(I,M){return function zc(u,h,I,M){return xo(u,function(U,X,pe){h(M,I(U),X,pe)}),M}(I,u,h(M),{})}}function Eh(u,h){return function(I,M){var U;if(I===S&&M===S)return h;if(I!==S&&(U=I),M!==S){if(U===S)return M;"string"==typeof I||"string"==typeof M?(I=Wr(I),M=Wr(M)):(I=pb(I),M=pb(M)),U=u(I,M)}return U}}function Pp(u){return _s(function(h){return h=Nn(h,rs(yt())),zt(function(I){var M=this;return u(h,function(U){return Wn(U,M,I)})})})}function $e(u,h){var I=(h=h===S?" ":Wr(h)).length;if(I<2)return I?el(h,u):h;var M=el(h,Yc(u/ei(h)));return Io(h)?ya(rn(M),0,u).join(""):M.slice(0,u)}function wh(u){return function(h,I,M){return M&&"number"!=typeof M&&ri(h,I,M)&&(I=M=S),h=Ca(h),I===S?(I=h,h=0):I=Ca(I),function Kc(u,h,I,M){for(var U=-1,X=jt(Yc((h-u)/(I||1)),0),pe=Fe(X);X--;)pe[M?X:++U]=u,u+=I;return pe}(h,I,M=M===S?h<I?1:-1:Ca(M),u)}}function Qc(u){return function(h,I){return"string"==typeof h&&"string"==typeof I||(h=xs(h),I=xs(I)),u(h,I)}}function Xc(u,h,I,M,U,X,pe,ye,be,Ve){var He=8&h;h|=He?32:64,4&(h&=~(He?64:32))||(h&=-4);var Ut=[u,h,U,He?X:S,He?pe:S,He?S:X,He?S:pe,ye,be,Ve],St=I.apply(S,Ut);return Gp(u)&&pw(St,Ut),St.placeholder=M,mw(St,u,h)}function Np(u){var h=Nr[u];return function(I,M){if(I=xs(I),(M=null==M?0:Hr(Vt(M),292))&&IE(I)){var U=(wn(I)+"e").split("e");return+((U=(wn(h(U[0]+"e"+(+U[1]+M)))+"e").split("e"))[0]+"e"+(+U[1]-M))}return h(I)}}var Sb=$a&&1/la(new $a([,-0]))[1]==ee?function(u){return new $a(u)}:pv;function ow(u){return function(h){var I=ni(h);return I==dn?Vc(h):I==Li?function Gi(we){var Ge=-1,Fe=Array(we.size);return we.forEach(function(at){Fe[++Ge]=[at,at]}),Fe}(h):function Ml(we,Ge){return Nn(Ge,function(Fe){return[Fe,we[Fe]]})}(h,u(h))}}function Ps(u,h,I,M,U,X,pe,ye){var be=2&h;if(!be&&"function"!=typeof u)throw new Xs(f);var Ve=M?M.length:0;if(Ve||(h&=-97,M=U=S),pe=pe===S?pe:jt(Vt(pe),0),ye=ye===S?ye:Vt(ye),Ve-=U?U.length:0,64&h){var He=M,We=U;M=U=S}var rt=be?S:Lp(u),ht=[u,h,I,M,U,He,We,X,pe,ye];if(rt&&function dw(u,h){var I=u[1],M=h[1],U=I|M;if(!(U<131||(128==M&&8==I||128==M&&256==I&&u[7].length<=h[8]||384==M&&h[7].length<=h[8]&&8==I)))return u;1&M&&(u[2]=h[2],U|=1&I?0:4);var ye=h[3];if(ye){var be=u[3];u[3]=be?Op(be,ye,h[4]):ye,u[4]=be?Po(u[3],g):h[4]}(ye=h[5])&&(u[5]=(be=u[5])?rw(be,ye,h[6]):ye,u[6]=be?Po(u[5],g):h[6]),(ye=h[7])&&(u[7]=ye),128&M&&(u[8]=null==u[8]?h[8]:Hr(u[8],h[8])),null==u[9]&&(u[9]=h[9]),u[0]=h[0],u[1]=U}(ht,rt),u=ht[0],h=ht[1],I=ht[2],M=ht[3],U=ht[4],!(ye=ht[9]=ht[9]===S?be?0:u.length:jt(ht[9]-Ve,0))&&24&h&&(h&=-25),h&&1!=h)Ct=8==h||16==h?function vb(u,h,I){var M=yh(u);return function U(){for(var X=arguments.length,pe=Fe(X),ye=X,be=Fo(U);ye--;)pe[ye]=arguments[ye];var Ve=X<3&&pe[0]!==be&&pe[X-1]!==be?[]:Po(pe,be);return(X-=Ve.length)<I?Xc(u,h,nf,U.placeholder,S,pe,Ve,S,S,I-X):Wn(this&&this!==vr&&this instanceof U?M:u,this,pe)}}(u,h,ye):32!=h&&33!=h||U.length?nf.apply(S,ht):function sw(u,h,I,M){var U=1&h,X=yh(u);return function pe(){for(var ye=-1,be=arguments.length,Ve=-1,He=M.length,We=Fe(He+be),rt=this&&this!==vr&&this instanceof pe?X:u;++Ve<He;)We[Ve]=M[Ve];for(;be--;)We[Ve++]=arguments[++ye];return Wn(rt,U?I:this,We)}}(u,h,I,M);else var Ct=function mh(u,h,I){var M=1&h,U=yh(u);return function X(){return(this&&this!==vr&&this instanceof X?U:u).apply(M?I:this,arguments)}}(u,h,I);return mw((rt?QE:pw)(Ct,ht),u,h)}function Ns(u,h,I,M){return u===S||Ds(u,Zu[I])&&!_n.call(M,I)?h:u}function _p(u,h,I,M,U,X){return jn(u)&&jn(h)&&(X.set(h,u),jl(u,h,S,_p,X),X.delete(h)),u}function Zc(u){return ec(u)?S:u}function aw(u,h,I,M,U,X){var pe=1&I,ye=u.length,be=h.length;if(ye!=be&&!(pe&&be>ye))return!1;var Ve=X.get(u),He=X.get(h);if(Ve&&He)return Ve==h&&He==u;var We=-1,rt=!0,ht=2&I?new ga:S;for(X.set(u,h),X.set(h,u);++We<ye;){var Ct=u[We],Ut=h[We];if(M)var St=pe?M(Ut,Ct,We,h,u,X):M(Ct,Ut,We,u,h,X);if(St!==S){if(St)continue;rt=!1;break}if(ht){if(!Md(h,function(en,cn){if(!tt(ht,cn)&&(Ct===en||U(Ct,en,I,M,X)))return ht.push(cn)})){rt=!1;break}}else if(Ct!==Ut&&!U(Ct,Ut,I,M,X)){rt=!1;break}}return X.delete(u),X.delete(h),rt}function _s(u){return Vp(fw(u,S,Aw),u+"")}function rf(u){return Ep(u,_r,Fp)}function xp(u){return Ep(u,ai,cw)}var Lp=ih?function(u){return ih.get(u)}:pv;function wa(u){for(var h=u.name+"",I=Ka[h],M=_n.call(Ka,h)?I.length:0;M--;){var U=I[M],X=U.func;if(null==X||X==u)return U.name}return h}function Fo(u){return(_n.call(q,"placeholder")?q:u).placeholder}function yt(){var u=q.iteratee||_m;return u=u===_m?jE:u,arguments.length?u(arguments[0],arguments[1]):u}function Mp(u,h){var I=u.__data__;return function Xl(u){var h=typeof u;return"string"==h||"number"==h||"symbol"==h||"boolean"==h?"__proto__"!==u:null===u}(h)?I["string"==typeof h?"string":"hash"]:I.map}function sf(u){for(var h=_r(u),I=h.length;I--;){var M=h[I],U=u[M];h[I]=[M,U,hw(U)]}return h}function ql(u,h){var I=function ir(we,Ge){return null==we?S:we[Ge]}(u,h);return zd(I)?I:S}var Fp=ip?function(u){return null==u?[]:(u=Fn(u),Zr(ip(u),function(h){return OE.call(u,h)}))}:Bm,cw=ip?function(u){for(var h=[];u;)za(h,Fp(u)),u=th(u);return h}:Bm,ni=Ur;function Ql(u,h,I){for(var M=-1,U=(h=to(h,u)).length,X=!1;++M<U;){var pe=no(h[M]);if(!(X=null!=u&&I(u,pe)))break;u=u[pe]}return X||++M!=U?X:!!(U=null==u?0:u.length)&&Qt(U)&&Bo(pe,U)&&(Ft(u)||Zl(u))}function uw(u){return"function"!=typeof u.constructor||vh(u)?{}:Vl(th(u))}function kp(u){return Ft(u)||Zl(u)||!!(np&&u&&u[np])}function Bo(u,h){var I=typeof u;return!!(h=null==h?Ae:h)&&("number"==I||"symbol"!=I&&Gg.test(u))&&u>-1&&u%1==0&&u<h}function ri(u,h,I){if(!jn(I))return!1;var M=typeof h;return!!("number"==M?Wi(I)&&Bo(h,I.length):"string"==M&&h in I)&&Ds(I[h],u)}function cf(u,h){if(Ft(u))return!1;var I=typeof u;return!("number"!=I&&"symbol"!=I&&"boolean"!=I&&null!=u&&!oi(u))||Uu.test(u)||!Tc.test(u)||null!=h&&u in Fn(h)}function Gp(u){var h=wa(u),I=q[h];if("function"!=typeof I||!(h in Be.prototype))return!1;if(u===I)return!0;var M=Lp(I);return!!M&&u===M[0]}(Uc&&ni(new Uc(new ArrayBuffer(1)))!=Co||ti&&ni(new ti)!=dn||ap&&ni(ap.resolve())!=Xt||$a&&ni(new $a)!=Li||_o&&ni(new _o)!=vs)&&(ni=function(u){var h=Ur(u),I=h==fr?u.constructor:S,M=I?ii(I):"";if(M)switch(M){case rb:return Co;case Ja:return dn;case NE:return Xt;case lp:return Li;case Nt:return vs}return h});var Cb=Xg?Aa:km;function vh(u){var h=u&&u.constructor;return u===("function"==typeof h&&h.prototype||Zu)}function hw(u){return u==u&&!jn(u)}function Ui(u,h){return function(I){return null!=I&&I[u]===h&&(h!==S||u in Fn(I))}}function fw(u,h,I){return h=jt(h===S?u.length-1:h,0),function(){for(var M=arguments,U=-1,X=jt(M.length-h,0),pe=Fe(X);++U<X;)pe[U]=M[h+U];U=-1;for(var ye=Fe(h+1);++U<h;)ye[U]=M[U];return ye[h]=I(pe),Wn(u,this,ye)}}function gw(u,h){return h.length<2?u:Lo(u,eo(h,0,-1))}function Ob(u,h){for(var I=u.length,M=Hr(h.length,I),U=Yi(u);M--;){var X=h[M];u[M]=Bo(X,I)?U[X]:S}return u}function uf(u,h){if(("constructor"!==h||"function"!=typeof u[h])&&"__proto__"!=h)return u[h]}var pw=Ib(QE),Sh=tb||function(u,h){return vr.setTimeout(u,h)},Vp=Ib(pt);function mw(u,h,I){var M=h+"";return Vp(u,function lf(u,h){var I=h.length;if(!I)return u;var M=I-1;return h[M]=(I>1?"& ":"")+h[M],h=h.join(I>2?", ":" "),u.replace(Wa,"{\n/* [wrapped with "+h+"] */\n")}(M,function Ah(u,h){return Dt(ft,function(I){var M="_."+I[0];h&I[1]&&!Ti(u,M)&&u.push(M)}),u.sort()}(function Bp(u){var h=u.match($s);return h?h[1].split(yE):[]}(M),I)))}function Ib(u){var h=0,I=0;return function(){var M=nb(),U=16-(M-I);if(I=M,U>0){if(++h>=800)return arguments[0]}else h=0;return u.apply(S,arguments)}}function hf(u,h){var I=-1,M=u.length,U=M-1;for(h=h===S?M:h;++I<h;){var X=Za(I,U),pe=u[X];u[X]=u[I],u[I]=pe}return u.length=h,u}var eu=function ko(u){var h=Oh(u,function(M){return 500===I.size&&I.clear(),M}),I=h.cache;return h}(function(u){var h=[];return 46===u.charCodeAt(0)&&h.push(""),u.replace(Ad,function(I,M,U,X){h.push(U?X.replace(Wu,"$1"):M||I)}),h});function no(u){if("string"==typeof u||oi(u))return u;var h=u+"";return"0"==h&&1/u==-ee?"-0":h}function ii(u){if(null!=u){try{return Zg.call(u)}catch(h){}try{return u+""}catch(h){}}return""}function Hp(u){if(u instanceof Be)return u.clone();var h=new Rs(u.__wrapped__,u.__chain__);return h.__actions__=Yi(u.__actions__),h.__index__=u.__index__,h.__values__=u.__values__,h}var AI=zt(function(u,h){return En(u)?Yl(u,sr(h,1,En,!0)):[]}),bI=zt(function(u,h){var I=ls(h);return En(I)&&(I=S),En(u)?Yl(u,sr(h,1,En,!0),yt(I,2)):[]}),Yp=zt(function(u,h){var I=ls(h);return En(I)&&(I=S),En(u)?Yl(u,sr(h,1,En,!0),S,I):[]});function vw(u,h,I){var M=null==u?0:u.length;if(!M)return-1;var U=null==I?0:Vt(I);return U<0&&(U=jt(M+U,0)),qu(u,yt(h,3),U)}function Sw(u,h,I){var M=null==u?0:u.length;if(!M)return-1;var U=M-1;return I!==S&&(U=Vt(I),U=I<0?jt(M+U,0):Hr(U,M-1)),qu(u,yt(h,3),U,!0)}function Aw(u){return null!=u&&u.length?sr(u,1):[]}function jp(u){return u&&u.length?u[0]:S}var yn=zt(function(u){var h=Nn(u,Is);return h.length&&h[0]===u[0]?wp(h):[]}),_b=zt(function(u){var h=ls(u),I=Nn(u,Is);return h===ls(I)?h=S:I.pop(),I.length&&I[0]===u[0]?wp(I,yt(h,2)):[]}),Db=zt(function(u){var h=ls(u),I=Nn(u,Is);return(h="function"==typeof h?h:S)&&I.pop(),I.length&&I[0]===u[0]?wp(I,S,h):[]});function ls(u){var h=null==u?0:u.length;return h?u[h-1]:S}var Mb=zt(Cw);function Cw(u,h){return u&&u.length&&h&&h.length?dh(u,h):u}var OI=_s(function(u,h){var I=null==u?0:u.length,M=mp(u,h);return $l(u,Nn(h,function(U){return Bo(U,I)?+U:U}).sort(Jl)),M});function jr(u){return null==u?u:fI.call(u)}var Yb=zt(function(u){return Kl(sr(u,1,En,!0))}),qp=zt(function(u){var h=ls(u);return En(h)&&(h=S),Kl(sr(u,1,En,!0),yt(h,2))}),Ub=zt(function(u){var h=ls(u);return h="function"==typeof h?h:S,Kl(sr(u,1,En,!0),S,h)});function Xp(u){if(!u||!u.length)return[];var h=0;return u=Zr(u,function(I){if(En(I))return h=jt(I.length,h),!0}),kc(h,function(I){return Nn(u,aa(I))})}function va(u,h){if(!u||!u.length)return[];var I=Xp(u);return null==h?I:Nn(I,function(M){return Wn(h,S,M)})}var zb=zt(function(u,h){return En(u)?Yl(u,h):[]}),$b=zt(function(u){return Tp(Zr(u,En))}),Kb=zt(function(u){var h=ls(u);return En(h)&&(h=S),Tp(Zr(u,En),yt(h,2))}),Jb=zt(function(u){var h=ls(u);return h="function"==typeof h?h:S,Tp(Zr(u,En),S,h)}),qb=zt(Xp),Xb=zt(function(u){var h=u.length,I=h>1?u[h-1]:S;return I="function"==typeof I?(u.pop(),I):S,va(u,I)});function _w(u){var h=q(u);return h.__chain__=!0,h}function ff(u,h){return h(u)}var eC=_s(function(u){var h=u.length,I=h?u[0]:0,M=this.__wrapped__,U=function(X){return mp(X,u)};return!(h>1||this.__actions__.length)&&M instanceof Be&&Bo(I)?((M=M.slice(I,+I+(h?1:0))).__actions__.push({func:ff,args:[U],thisArg:S}),new Rs(M,this.__chain__).thru(function(X){return h&&!X.length&&X.push(S),X})):this.thru(U)}),NI=gh(function(u,h,I){_n.call(u,I)?++u[I]:pa(u,I,1)}),em=iw(vw),nC=iw(Sw);function tm(u,h){return(Ft(u)?Dt:ma)(u,yt(h,3))}function gf(u,h){return(Ft(u)?Ri:kE)(u,yt(h,3))}var nm=gh(function(u,h,I){_n.call(u,I)?u[I].push(h):pa(u,I,[h])}),_I=zt(function(u,h,I){var M=-1,U="function"==typeof h,X=Wi(u)?Fe(u.length):[];return ma(u,function(pe){X[++M]=U?Wn(h,pe,I):Ul(pe,h,I)}),X}),ru=gh(function(u,h,I){pa(u,I,h)});function iu(u,h){return(Ft(u)?Nn:Sp)(u,yt(h,3))}var rC=gh(function(u,h,I){u[I?0:1].push(h)},function(){return[[],[]]}),im=zt(function(u,h){if(null==u)return[];var I=h.length;return I>1&&ri(u,h[0],h[1])?h=[]:I>2&&ri(h[0],h[1],h[2])&&(h=[h[0]]),Ap(u,sr(h,1),[])}),Th=rp||function(){return vr.Date.now()};function kw(u,h,I){return h=I?S:h,Ps(u,128,S,S,S,S,h=u&&null==h?u.length:h)}function Gw(u,h){var I;if("function"!=typeof h)throw new Xs(f);return u=Vt(u),function(){return--u>0&&(I=h.apply(this,arguments)),u<=1&&(h=S),I}}var pf=zt(function(u,h,I){var M=1;if(I.length){var U=Po(I,Fo(pf));M|=32}return Ps(u,M,h,I,U)}),om=zt(function(u,h,I){var M=3;if(I.length){var U=Po(I,Fo(om));M|=32}return Ps(h,M,u,I,U)});function lm(u,h,I){var M,U,X,pe,ye,be,Ve=0,He=!1,We=!1,rt=!0;if("function"!=typeof u)throw new Xs(f);function ht(nr){var Ms=M,al=U;return M=U=S,Ve=nr,pe=u.apply(al,Ms)}function Ct(nr){return Ve=nr,ye=Sh(en,h),He?ht(nr):pe}function St(nr){var Ms=nr-be;return be===S||Ms>=h||Ms<0||We&&nr-Ve>=X}function en(){var nr=Th();if(St(nr))return cn(nr);ye=Sh(en,function Ut(nr){var Fs=h-(nr-be);return We?Hr(Fs,X-(nr-Ve)):Fs}(nr))}function cn(nr){return ye=S,rt&&M?ht(nr):(M=U=S,pe)}function hs(){var nr=Th(),Ms=St(nr);if(M=arguments,U=this,be=nr,Ms){if(ye===S)return Ct(be);if(We)return ZE(ye),ye=Sh(en,h),ht(be)}return ye===S&&(ye=Sh(en,h)),pe}return h=xs(h)||0,jn(I)&&(He=!!I.leading,X=(We="maxWait"in I)?jt(xs(I.maxWait)||0,h):X,rt="trailing"in I?!!I.trailing:rt),hs.cancel=function Ls(){ye!==S&&ZE(ye),Ve=0,M=be=U=ye=S},hs.flush=function zr(){return ye===S?pe:cn(Th())},hs}var uC=zt(function(u,h){return lh(u,1,h)}),mf=zt(function(u,h,I){return lh(u,xs(h)||0,I)});function Oh(u,h){if("function"!=typeof u||null!=h&&"function"!=typeof h)throw new Xs(f);var I=function(){var M=arguments,U=h?h.apply(this,M):M[0],X=I.cache;if(X.has(U))return X.get(U);var pe=u.apply(this,M);return I.cache=X.set(U,pe)||X,pe};return I.cache=new(Oh.Cache||Hi),I}function Ih(u){if("function"!=typeof u)throw new Xs(f);return function(){var h=arguments;switch(h.length){case 0:return!u.call(this);case 1:return!u.call(this,h[0]);case 2:return!u.call(this,h[0],h[1]);case 3:return!u.call(this,h[0],h[1],h[2])}return!u.apply(this,h)}}Oh.Cache=Hi;var cm=fh(function(u,h){var I=(h=1==h.length&&Ft(h[0])?Nn(h[0],rs(yt())):Nn(sr(h,1),rs(yt()))).length;return zt(function(M){for(var U=-1,X=Hr(M.length,I);++U<X;)M[U]=h[U].call(this,M[U]);return Wn(u,this,M)})}),yf=zt(function(u,h){var I=Po(h,Fo(yf));return Ps(u,32,S,h,I)}),Ph=zt(function(u,h){var I=Po(h,Fo(Ph));return Ps(u,64,S,h,I)}),Ef=_s(function(u,h){return Ps(u,256,S,S,S,h)});function Ds(u,h){return u===h||u!=u&&h!=h}var DI=Qc(Wc),jw=Qc(function(u,h){return u>=h}),Zl=uh(function(){return arguments}())?uh:function(u){return Qn(u)&&_n.call(u,"callee")&&!OE.call(u,"callee")},Ft=Fe.isArray,pC=Pe?rs(Pe):function pI(u){return Qn(u)&&Ur(u)==ta};function Wi(u){return null!=u&&Qt(u.length)&&!Aa(u)}function En(u){return Qn(u)&&Wi(u)}var Sa=sp||km,yC=Ce?rs(Ce):function WE(u){return Qn(u)&&Ur(u)==Ye};function fm(u){if(!Qn(u))return!1;var h=Ur(u);return h==mt||"[object DOMException]"==h||"string"==typeof u.message&&"string"==typeof u.name&&!ec(u)}function Aa(u){if(!jn(u))return!1;var h=Ur(u);return h==kt||h==Br||"[object AsyncFunction]"==h||"[object Proxy]"==h}function xt(u){return"number"==typeof u&&u==Vt(u)}function Qt(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=Ae}function jn(u){var h=typeof u;return null!=u&&("object"==h||"function"==h)}function Qn(u){return null!=u&&"object"==typeof u}var _h=it?rs(it):function db(u){return Qn(u)&&ni(u)==dn};function mm(u){return"number"==typeof u||Qn(u)&&Ur(u)==Hn}function ec(u){if(!Qn(u)||Ur(u)!=fr)return!1;var h=th(u);if(null===h)return!0;var I=_n.call(h,"constructor")&&h.constructor;return"function"==typeof I&&I instanceof I&&Zg.call(I)==ep}var Kw=ut?rs(ut):function vp(u){return Qn(u)&&Ur(u)==xi},bC=dt?rs(dt):function $d(u){return Qn(u)&&ni(u)==Li};function tc(u){return"string"==typeof u||!Ft(u)&&Qn(u)&&Ur(u)==zs}function oi(u){return"symbol"==typeof u||Qn(u)&&Ur(u)==Mi}var il=Zt?rs(Zt):function Kd(u){return Qn(u)&&Qt(u.length)&&!!Pn[Ur(u)]},CC=Qc(qd),RC=Qc(function(u,h){return u<=h});function qw(u){if(!u)return[];if(Wi(u))return tc(u)?rn(u):Yi(u);if(rh&&u[rh])return function Yt(we){for(var Ge,Fe=[];!(Ge=we.next()).done;)Fe.push(Ge.value);return Fe}(u[rh]());var h=ni(u);return(h==dn?Vc:h==Li?la:au)(u)}function Ca(u){return u?(u=xs(u))===ee||u===-ee?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Vt(u){var h=Ca(u),I=h%1;return h==h?I?h-I:h:0}function TC(u){return u?Hl(Vt(u),0,Le):0}function xs(u){if("number"==typeof u)return u;if(oi(u))return NaN;if(jn(u)){var h="function"==typeof u.valueOf?u.valueOf():u;u=jn(h)?h+"":h}if("string"!=typeof u)return 0===u?u:+u;u=Vr(u);var I=Cd.test(u);return I||kg.test(u)?Kg(u.slice(2),I?2:8):Bg.test(u)?NaN:+u}function OC(u){return Mo(u,ai(u))}function wn(u){return null==u?"":Wr(u)}var IC=nl(function(u,h){if(vh(h)||Wi(h))Mo(h,_r(h),u);else for(var I in h)_n.call(h,I)&&Ar(u,I,h[I])}),wf=nl(function(u,h){Mo(h,ai(h),u)}),wm=nl(function(u,h,I,M){Mo(h,ai(h),u,M)}),LI=nl(function(u,h,I,M){Mo(h,_r(h),u,M)}),MI=_s(mp),BI=zt(function(u,h){u=Fn(u);var I=-1,M=h.length,U=M>2?h[2]:S;for(U&&ri(h[0],h[1],U)&&(M=1);++I<M;)for(var X=h[I],pe=ai(X),ye=-1,be=pe.length;++ye<be;){var Ve=pe[ye],He=u[Ve];(He===S||Ds(He,Zu[Ve])&&!_n.call(u,Ve))&&(u[Ve]=X[Ve])}return u}),kI=zt(function(u){return u.push(S,_p),Wn(nv,S,u)});function Dh(u,h,I){var M=null==u?S:Lo(u,h);return M===S?I:M}function xh(u,h){return null!=u&&Ql(u,h,UE)}var NC=qc(function(u,h,I){null!=h&&"function"!=typeof h.toString&&(h=eh.call(h)),u[h]=I},Fh(li)),ol=qc(function(u,h,I){null!=h&&"function"!=typeof h.toString&&(h=eh.call(h)),_n.call(u,h)?u[h].push(I):u[h]=[I]},yt),ev=zt(Ul);function _r(u){return Wi(u)?fp(u):Jd(u)}function ai(u){return Wi(u)?fp(u,!0):function zE(u){if(!jn(u))return function Rb(u){var h=[];if(null!=u)for(var I in Fn(u))h.push(I);return h}(u);var h=vh(u),I=[];for(var M in u)"constructor"==M&&(h||!_n.call(u,M))||I.push(M);return I}(u)}var DC=nl(function(u,h,I){jl(u,h,I)}),nv=nl(function(u,h,I,M){jl(u,h,I,M)}),Lh=_s(function(u,h){var I={};if(null==u)return I;var M=!1;h=Nn(h,function(X){return X=to(X,u),M||(M=X.length>1),X}),Mo(u,xp(u),I),M&&(I=Os(I,7,Zc));for(var U=h.length;U--;)or(I,h[U]);return I}),Sm=_s(function(u,h){return null==u?{}:function qE(u,h){return zl(u,h,function(I,M){return xh(u,M)})}(u,h)});function nc(u,h){if(null==u)return{};var I=Nn(xp(u),function(M){return[M]});return h=yt(h),zl(u,I,function(M,U){return h(M,U[0])})}var Am=ow(_r),bm=ow(ai);function au(u){return null==u?[]:ki(u,_r(u))}var LC=Ea(function(u,h,I){return h=h.toLowerCase(),u+(I?Tm(h):h)});function Tm(u){return Pm(wn(u).toLowerCase())}function av(u){return(u=wn(u))&&u.replace(Vg,Fl).replace(gt,"")}var BC=Ea(function(u,h,I){return u+(I?"-":"")+h.toLowerCase()}),WI=Ea(function(u,h,I){return u+(I?" ":"")+h.toLowerCase()}),jI=tf("toLowerCase"),VC=Ea(function(u,h,I){return u+(I?"_":"")+h.toLowerCase()}),uv=Ea(function(u,h,I){return u+(I?" ":"")+Pm(h)}),zC=Ea(function(u,h,I){return u+(I?" ":"")+h.toUpperCase()}),Pm=tf("toUpperCase");function $C(u,h,I){return u=wn(u),(h=I?S:h)===S?function Gc(we){return xd.test(we)}(u)?function qg(we){return we.match(Un)||[]}(u):function pr(we){return we.match(Fg)||[]}(u):u.match(h)||[]}var Nm=zt(function(u,h){try{return Wn(u,S,h)}catch(I){return fm(I)?I:new Mt(I)}}),KC=_s(function(u,h){return Dt(h,function(I){I=no(I),pa(u,I,pf(u[I],u))}),u});function Fh(u){return function(){return u}}var XC=Ip(),Sf=Ip(!0);function li(u){return u}function _m(u){return jE("function"==typeof u?u:Os(u,1))}var gv=zt(function(u,h){return function(I){return Ul(I,u,h)}}),ZC=zt(function(u,h){return function(I){return Ul(u,I,h)}});function Lm(u,h,I){var M=_r(h),U=yp(h,M);null==I&&(!jn(h)||!U.length&&M.length)&&(I=h,h=u,u=this,U=yp(h,_r(h)));var X=!(jn(I)&&"chain"in I&&!I.chain),pe=Aa(u);return Dt(U,function(ye){var be=h[ye];u[ye]=be,pe&&(u.prototype[ye]=function(){var Ve=this.__chain__;if(X||Ve){var He=u(this.__wrapped__),We=He.__actions__=Yi(this.__actions__);return We.push({func:be,args:arguments,thisArg:u}),He.__chain__=Ve,He}return be.apply(u,za([this.value()],arguments))})}),u}function pv(){}var mv=Pp(Nn),yv=Pp(Bc),Ev=Pp(Md);function Fm(u){return cf(u)?aa(no(u)):function bp(u){return function(h){return Lo(h,u)}}(u)}var Ra=wh(),Af=wh(!0);function Bm(){return[]}function km(){return!1}var Hm=Eh(function(u,h){return u+h},0),Sv=Np("ceil"),Av=Eh(function(u,h){return u/h},1),bv=Np("floor"),Rv=Eh(function(u,h){return u*h},1),sR=Np("round"),oR=Eh(function(u,h){return u-h},0);return q.after=function sm(u,h){if("function"!=typeof h)throw new Xs(f);return u=Vt(u),function(){if(--u<1)return h.apply(this,arguments)}},q.ary=kw,q.assign=IC,q.assignIn=wf,q.assignInWith=wm,q.assignWith=LI,q.at=MI,q.before=Gw,q.bind=pf,q.bindAll=KC,q.bindKey=om,q.castArray=function dC(){if(!arguments.length)return[];var u=arguments[0];return Ft(u)?u:[u]},q.chain=_w,q.chunk=function yw(u,h,I){h=(I?ri(u,h,I):h===S)?1:jt(Vt(h),0);var M=null==u?0:u.length;if(!M||h<1)return[];for(var U=0,X=0,pe=Fe(Yc(M/h));U<M;)pe[X++]=eo(u,U,U+=h);return pe},q.compact=function Ew(u){for(var h=-1,I=null==u?0:u.length,M=0,U=[];++h<I;){var X=u[h];X&&(U[M++]=X)}return U},q.concat=function SI(){var u=arguments.length;if(!u)return[];for(var h=Fe(u-1),I=arguments[0],M=u;M--;)h[M-1]=arguments[M];return za(Ft(I)?Yi(I):[I],sr(h,1))},q.cond=function JC(u){var h=null==u?0:u.length,I=yt();return u=h?Nn(u,function(M){if("function"!=typeof M[1])throw new Xs(f);return[I(M[0]),M[1]]}):[],zt(function(M){for(var U=-1;++U<h;){var X=u[U];if(Wn(X[0],this,M))return Wn(X[1],this,M)}})},q.conforms=function qC(u){return function jd(u){var h=_r(u);return function(I){return ah(I,u,h)}}(Os(u,1))},q.constant=Fh,q.countBy=NI,q.create=function FI(u,h){var I=Vl(u);return null==h?I:tr(I,h)},q.curry=function rl(u,h,I){var M=Ps(u,8,S,S,S,S,S,h=I?S:h);return M.placeholder=rl.placeholder,M},q.curryRight=function am(u,h,I){var M=Ps(u,16,S,S,S,S,S,h=I?S:h);return M.placeholder=am.placeholder,M},q.debounce=lm,q.defaults=BI,q.defaultsDeep=kI,q.defer=uC,q.delay=mf,q.difference=AI,q.differenceBy=bI,q.differenceWith=Yp,q.drop=function Up(u,h,I){var M=null==u?0:u.length;return M?eo(u,(h=I||h===S?1:Vt(h))<0?0:h,M):[]},q.dropRight=function Wp(u,h,I){var M=null==u?0:u.length;return M?eo(u,0,(h=M-(h=I||h===S?1:Vt(h)))<0?0:h):[]},q.dropRightWhile=function CI(u,h){return u&&u.length?tl(u,yt(h,3),!0,!0):[]},q.dropWhile=function RI(u,h){return u&&u.length?tl(u,yt(h,3),!0):[]},q.fill=function ww(u,h,I,M){var U=null==u?0:u.length;return U?(I&&"number"!=typeof I&&ri(u,h,I)&&(I=0,M=U),function ub(u,h,I,M){var U=u.length;for((I=Vt(I))<0&&(I=-I>U?0:U+I),(M=M===S||M>U?U:Vt(M))<0&&(M+=U),M=I>M?0:TC(M);I<M;)u[I++]=h;return u}(u,h,I,M)):[]},q.filter=function Zp(u,h){return(Ft(u)?Zr:GE)(u,yt(h,3))},q.flatMap=function xw(u,h){return sr(iu(u,h),1)},q.flatMapDeep=function Rh(u,h){return sr(iu(u,h),ee)},q.flatMapDepth=function Lw(u,h,I){return I=I===S?1:Vt(I),sr(iu(u,h),I)},q.flatten=Aw,q.flattenDeep=function Pb(u){return null!=u&&u.length?sr(u,ee):[]},q.flattenDepth=function bw(u,h){return null!=u&&u.length?sr(u,h=h===S?1:Vt(h)):[]},q.flip=function hC(u){return Ps(u,512)},q.flow=XC,q.flowRight=Sf,q.fromPairs=function df(u){for(var h=-1,I=null==u?0:u.length,M={};++h<I;){var U=u[h];M[U[0]]=U[1]}return M},q.functions=function PC(u){return null==u?[]:yp(u,_r(u))},q.functionsIn=function Xw(u){return null==u?[]:yp(u,ai(u))},q.groupBy=nm,q.initial=function Nb(u){return null!=u&&u.length?eo(u,0,-1):[]},q.intersection=yn,q.intersectionBy=_b,q.intersectionWith=Db,q.invert=NC,q.invertBy=ol,q.invokeMap=_I,q.iteratee=_m,q.keyBy=ru,q.keys=_r,q.keysIn=ai,q.map=iu,q.mapKeys=function _C(u,h){var I={};return h=yt(h,3),xo(u,function(M,U,X){pa(I,h(M,U,X),M)}),I},q.mapValues=function tv(u,h){var I={};return h=yt(h,3),xo(u,function(M,U,X){pa(I,U,h(M,U,X))}),I},q.matches=function Dm(u){return $E(Os(u,1))},q.matchesProperty=function xm(u,h){return KE(u,Os(h,1))},q.memoize=Oh,q.merge=DC,q.mergeWith=nv,q.method=gv,q.methodOf=ZC,q.mixin=Lm,q.negate=Ih,q.nthArg=function eR(u){return u=Vt(u),zt(function(h){return JE(h,u)})},q.omit=Lh,q.omitBy=function su(u,h){return nc(u,Ih(yt(h)))},q.once=function Vw(u){return Gw(2,u)},q.orderBy=function Fw(u,h,I,M){return null==u?[]:(Ft(h)||(h=null==h?[]:[h]),Ft(I=M?S:I)||(I=null==I?[]:[I]),Ap(u,h,I))},q.over=mv,q.overArgs=cm,q.overEvery=yv,q.overSome=Ev,q.partial=yf,q.partialRight=Ph,q.partition=rC,q.pick=Sm,q.pickBy=nc,q.property=Fm,q.propertyOf=function wv(u){return function(h){return null==u?S:Lo(u,h)}},q.pull=Mb,q.pullAll=Cw,q.pullAllBy=function Fb(u,h,I){return u&&u.length&&h&&h.length?dh(u,h,yt(I,2)):u},q.pullAllWith=function TI(u,h,I){return u&&u.length&&h&&h.length?dh(u,h,S,I):u},q.pullAt=OI,q.range=Ra,q.rangeRight=Af,q.rearg=Ef,q.reject=function sC(u,h){return(Ft(u)?Zr:GE)(u,Ih(yt(h,3)))},q.remove=function bh(u,h){var I=[];if(!u||!u.length)return I;var M=-1,U=[],X=u.length;for(h=yt(h,3);++M<X;){var pe=u[M];h(pe,M,u)&&(I.push(pe),U.push(M))}return $l(u,U),I},q.rest=function Hw(u,h){if("function"!=typeof u)throw new Xs(f);return zt(u,h=h===S?h:Vt(h))},q.reverse=jr,q.sampleSize=function aC(u,h,I){return h=(I?ri(u,h,I):h===S)?1:Vt(h),(Ft(u)?Wd:Jc)(u,h)},q.set=function ou(u,h,I){return null==u?u:Qd(u,h,I)},q.setWith=function xC(u,h,I,M){return M="function"==typeof M?M:S,null==u?u:Qd(u,h,I,M)},q.shuffle=function lC(u){return(Ft(u)?lb:fb)(u)},q.slice=function Kp(u,h,I){var M=null==u?0:u.length;return M?(I&&"number"!=typeof I&&ri(u,h,I)?(h=0,I=M):(h=null==h?0:Vt(h),I=I===S?M:Vt(I)),eo(u,h,I)):[]},q.sortBy=im,q.sortedUniq=function kb(u){return u&&u.length?gb(u):[]},q.sortedUniqBy=function Ow(u,h){return u&&u.length?gb(u,yt(h,2)):[]},q.split=function HC(u,h,I){return I&&"number"!=typeof I&&ri(u,h,I)&&(h=I=S),(I=I===S?Le:I>>>0)?(u=wn(u))&&("string"==typeof h||null!=h&&!Kw(h))&&!(h=Wr(h))&&Io(u)?ya(rn(u),0,I):u.split(h,I):[]},q.spread=function um(u,h){if("function"!=typeof u)throw new Xs(f);return h=null==h?0:jt(Vt(h),0),zt(function(I){var M=I[h],U=ya(I,0,h);return M&&za(U,M),Wn(u,this,U)})},q.tail=function Gb(u){var h=null==u?0:u.length;return h?eo(u,1,h):[]},q.take=function Iw(u,h,I){return u&&u.length?eo(u,0,(h=I||h===S?1:Vt(h))<0?0:h):[]},q.takeRight=function Vb(u,h,I){var M=null==u?0:u.length;return M?eo(u,(h=M-(h=I||h===S?1:Vt(h)))<0?0:h,M):[]},q.takeRightWhile=function Pw(u,h){return u&&u.length?tl(u,yt(h,3),!1,!0):[]},q.takeWhile=function Hb(u,h){return u&&u.length?tl(u,yt(h,3)):[]},q.tap=function Zb(u,h){return h(u),u},q.throttle=function Yw(u,h,I){var M=!0,U=!0;if("function"!=typeof u)throw new Xs(f);return jn(I)&&(M="leading"in I?!!I.leading:M,U="trailing"in I?!!I.trailing:U),lm(u,h,{leading:M,maxWait:h,trailing:U})},q.thru=ff,q.toArray=qw,q.toPairs=Am,q.toPairsIn=bm,q.toPath=function Bh(u){return Ft(u)?Nn(u,no):oi(u)?[u]:Yi(eu(wn(u)))},q.toPlainObject=OC,q.transform=function Cm(u,h,I){var M=Ft(u),U=M||Sa(u)||il(u);if(h=yt(h,4),null==I){var X=u&&u.constructor;I=U?M?new X:[]:jn(u)&&Aa(X)?Vl(th(u)):{}}return(U?Dt:xo)(u,function(pe,ye,be){return h(I,pe,ye,be)}),I},q.unary=function hm(u){return kw(u,1)},q.union=Yb,q.unionBy=qp,q.unionWith=Ub,q.uniq=function Wb(u){return u&&u.length?Kl(u):[]},q.uniqBy=function Qp(u,h){return u&&u.length?Kl(u,yt(h,2)):[]},q.uniqWith=function jb(u,h){return h="function"==typeof h?h:S,u&&u.length?Kl(u,S,h):[]},q.unset=function Rm(u,h){return null==u||or(u,h)},q.unzip=Xp,q.unzipWith=va,q.update=function rv(u,h,I){return null==u?u:Xd(u,h,Zd(I))},q.updateWith=function vf(u,h,I,M){return M="function"==typeof M?M:S,null==u?u:Xd(u,h,Zd(I),M)},q.values=au,q.valuesIn=function iv(u){return null==u?[]:ki(u,ai(u))},q.without=zb,q.words=$C,q.wrap=function Nh(u,h){return yf(Zd(h),u)},q.xor=$b,q.xorBy=Kb,q.xorWith=Jb,q.zip=qb,q.zipObject=function Nw(u,h){return os(u||[],h||[],Ar)},q.zipObjectDeep=function Qb(u,h){return os(u||[],h||[],Qd)},q.zipWith=Xb,q.entries=Am,q.entriesIn=bm,q.extend=wf,q.extendWith=wm,Lm(q,q),q.add=Hm,q.attempt=Nm,q.camelCase=LC,q.capitalize=Tm,q.ceil=Sv,q.clamp=function UI(u,h,I){return I===S&&(I=h,h=S),I!==S&&(I=(I=xs(I))==I?I:0),h!==S&&(h=(h=xs(h))==h?h:0),Hl(xs(u),h,I)},q.clone=function Uw(u){return Os(u,4)},q.cloneDeep=function gC(u){return Os(u,5)},q.cloneDeepWith=function Ww(u,h){return Os(u,5,h="function"==typeof h?h:S)},q.cloneWith=function fC(u,h){return Os(u,4,h="function"==typeof h?h:S)},q.conformsTo=function dm(u,h){return null==h||ah(u,h,_r(h))},q.deburr=av,q.defaultTo=function QC(u,h){return null==u||u!=u?h:u},q.divide=Av,q.endsWith=function MC(u,h,I){u=wn(u),h=Wr(h);var M=u.length,U=I=I===S?M:Hl(Vt(I),0,M);return(I-=h.length)>=0&&u.slice(I,U)==h},q.eq=Ds,q.escape=function us(u){return(u=wn(u))&&Si.test(u)?u.replace(Ro,Pr):u},q.escapeRegExp=function FC(u){return(u=wn(u))&&As.test(u)?u.replace(Oc,"\\$&"):u},q.every=function cs(u,h,I){var M=Ft(u)?Bc:Qa;return I&&ri(u,h,I)&&(h=S),M(u,yt(h,3))},q.find=em,q.findIndex=vw,q.findKey=function GI(u,h){return bE(u,yt(h,3),xo)},q.findLast=nC,q.findLastIndex=Sw,q.findLastKey=function VI(u,h){return bE(u,yt(h,3),HE)},q.floor=bv,q.forEach=tm,q.forEachRight=gf,q.forIn=function HI(u,h){return null==u?u:ch(u,yt(h,3),ai)},q.forInRight=function YI(u,h){return null==u?u:VE(u,yt(h,3),ai)},q.forOwn=function sl(u,h){return u&&xo(u,yt(h,3))},q.forOwnRight=function vm(u,h){return u&&HE(u,yt(h,3))},q.get=Dh,q.gt=DI,q.gte=jw,q.has=function Zw(u,h){return null!=u&&Ql(u,h,YE)},q.hasIn=xh,q.head=jp,q.identity=li,q.includes=function Mw(u,h,I,M){u=Wi(u)?u:au(u),I=I&&!M?Vt(I):0;var U=u.length;return I<0&&(I=jt(U+I,0)),tc(u)?I<=U&&u.indexOf(h,I)>-1:!!U&&Mn(u,h,I)>-1},q.indexOf=function zp(u,h,I){var M=null==u?0:u.length;if(!M)return-1;var U=null==I?0:Vt(I);return U<0&&(U=jt(M+U,0)),Mn(u,h,U)},q.inRange=function sv(u,h,I){return h=Ca(h),I===S?(I=h,h=0):I=Ca(I),function jc(u,h,I){return u>=Hr(h,I)&&u<jt(h,I)}(u=xs(u),h,I)},q.invoke=ev,q.isArguments=Zl,q.isArray=Ft,q.isArrayBuffer=pC,q.isArrayLike=Wi,q.isArrayLikeObject=En,q.isBoolean=function mC(u){return!0===u||!1===u||Qn(u)&&Ur(u)==Oe},q.isBuffer=Sa,q.isDate=yC,q.isElement=function EC(u){return Qn(u)&&1===u.nodeType&&!ec(u)},q.isEmpty=function wC(u){if(null==u)return!0;if(Wi(u)&&(Ft(u)||"string"==typeof u||"function"==typeof u.splice||Sa(u)||il(u)||Zl(u)))return!u.length;var h=ni(u);if(h==dn||h==Li)return!u.size;if(vh(u))return!Jd(u).length;for(var I in u)if(_n.call(u,I))return!1;return!0},q.isEqual=function vC(u,h){return $c(u,h)},q.isEqualWith=function zw(u,h,I){var M=(I="function"==typeof I?I:S)?I(u,h):S;return M===S?$c(u,h,S,I):!!M},q.isError=fm,q.isFinite=function SC(u){return"number"==typeof u&&IE(u)},q.isFunction=Aa,q.isInteger=xt,q.isLength=Qt,q.isMap=_h,q.isMatch=function ro(u,h){return u===h||Wl(u,h,sf(h))},q.isMatchWith=function $w(u,h,I){return I="function"==typeof I?I:S,Wl(u,h,sf(h),I)},q.isNaN=function AC(u){return mm(u)&&u!=+u},q.isNative=function gm(u){if(Cb(u))throw new Mt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return zd(u)},q.isNil=function pm(u){return null==u},q.isNull=function ba(u){return null===u},q.isNumber=mm,q.isObject=jn,q.isObjectLike=Qn,q.isPlainObject=ec,q.isRegExp=Kw,q.isSafeInteger=function Jw(u){return xt(u)&&u>=-Ae&&u<=Ae},q.isSet=bC,q.isString=tc,q.isSymbol=oi,q.isTypedArray=il,q.isUndefined=function ym(u){return u===S},q.isWeakMap=function Em(u){return Qn(u)&&ni(u)==vs},q.isWeakSet=function xI(u){return Qn(u)&&"[object WeakSet]"==Ur(u)},q.join=function $p(u,h){return null==u?"":op.call(u,h)},q.kebabCase=BC,q.last=ls,q.lastIndexOf=function xb(u,h,I){var M=null==u?0:u.length;if(!M)return-1;var U=M;return I!==S&&(U=(U=Vt(I))<0?jt(M+U,0):Hr(U,M-1)),h==h?function Hc(we,Ge,Fe){for(var at=Fe+1;at--;)if(we[at]===Ge)return at;return at}(u,h,U):qu(u,Gr,U,!0)},q.lowerCase=WI,q.lowerFirst=jI,q.lt=CC,q.lte=RC,q.max=function nR(u){return u&&u.length?Xa(u,li,Wc):S},q.maxBy=function Ym(u,h){return u&&u.length?Xa(u,yt(h,2),Wc):S},q.mean=function rR(u){return oa(u,li)},q.meanBy=function iR(u,h){return oa(u,yt(h,2))},q.min=function Cv(u){return u&&u.length?Xa(u,li,qd):S},q.minBy=function lu(u,h){return u&&u.length?Xa(u,yt(h,2),qd):S},q.stubArray=Bm,q.stubFalse=km,q.stubObject=function $I(){return{}},q.stubString=function Gm(){return""},q.stubTrue=function vv(){return!0},q.multiply=Rv,q.nth=function Lb(u,h){return u&&u.length?JE(u,Vt(h)):S},q.noConflict=function Mm(){return vr._===this&&(vr._=uI),this},q.noop=pv,q.now=Th,q.pad=function lv(u,h,I){u=wn(u);var M=(h=Vt(h))?ei(u):0;if(!h||M>=h)return u;var U=(h-M)/2;return $e(Gd(U),I)+u+$e(Yc(U),I)},q.padEnd=function zI(u,h,I){u=wn(u);var M=(h=Vt(h))?ei(u):0;return h&&M<h?u+$e(h-M,I):u},q.padStart=function kC(u,h,I){u=wn(u);var M=(h=Vt(h))?ei(u):0;return h&&M<h?$e(h-M,I)+u:u},q.parseInt=function Om(u,h,I){return I||null==h?h=0:h&&(h=+h),mr(wn(u).replace(Ua,""),h||0)},q.random=function ov(u,h,I){if(I&&"boolean"!=typeof I&&ri(u,h,I)&&(h=I=S),I===S&&("boolean"==typeof h?(I=h,h=S):"boolean"==typeof u&&(I=u,u=S)),u===S&&h===S?(u=0,h=1):(u=Ca(u),h===S?(h=u,u=0):h=Ca(h)),u>h){var M=u;u=h,h=M}if(I||u%1||h%1){var U=PE();return Hr(u+U*(h-u+Ju("1e-"+((U+"").length-1))),h)}return Za(u,h)},q.reduce=function rm(u,h,I){var M=Ft(u)?Zn:Qu,U=arguments.length<3;return M(u,yt(h,4),I,U,ma)},q.reduceRight=function iC(u,h,I){var M=Ft(u)?XA:Qu,U=arguments.length<3;return M(u,yt(h,4),I,U,kE)},q.repeat=function cv(u,h,I){return h=(I?ri(u,h,I):h===S)?1:Vt(h),el(wn(u),h)},q.replace=function GC(){var u=arguments,h=wn(u[0]);return u.length<3?h:h.replace(u[1],u[2])},q.result=function Mh(u,h,I){var M=-1,U=(h=to(h,u)).length;for(U||(U=1,u=S);++M<U;){var X=null==u?S:u[no(h[M])];X===S&&(M=U,X=I),u=Aa(X)?X.call(u):X}return u},q.round=sR,q.runInContext=we,q.sample=function oC(u){return(Ft(u)?gp:Cp)(u)},q.size=function cC(u){if(null==u)return 0;if(Wi(u))return tc(u)?ei(u):u.length;var h=ni(u);return h==dn||h==Li?u.size:Jd(u).length},q.snakeCase=VC,q.some=function Bw(u,h,I){var M=Ft(u)?Md:mI;return I&&ri(u,h,I)&&(h=S),M(u,yt(h,3))},q.sortedIndex=function Rw(u,h){return Rp(u,h)},q.sortedIndexBy=function Tw(u,h,I){return XE(u,h,yt(I,2))},q.sortedIndexOf=function si(u,h){var I=null==u?0:u.length;if(I){var M=Rp(u,h);if(M<I&&Ds(u[M],h))return M}return-1},q.sortedLastIndex=function Ch(u,h){return Rp(u,h,!0)},q.sortedLastIndexBy=function Jp(u,h,I){return XE(u,h,yt(I,2),!0)},q.sortedLastIndexOf=function Bb(u,h){if(null!=u&&u.length){var M=Rp(u,h,!0)-1;if(Ds(u[M],h))return M}return-1},q.startCase=uv,q.startsWith=function YC(u,h,I){return u=wn(u),I=null==I?0:Hl(Vt(I),0,u.length),h=Wr(h),u.slice(I,I+h.length)==h},q.subtract=oR,q.sum=function cu(u){return u&&u.length?Ll(u,li):0},q.sumBy=function aR(u,h){return u&&u.length?Ll(u,yt(h,2)):0},q.template=function hv(u,h,I){var M=q.templateSettings;I&&ri(u,h,I)&&(h=S),u=wn(u),h=wm({},h,M,Ns);var ye,be,U=wm({},h.imports,M.imports,Ns),X=_r(U),pe=ki(U,X),Ve=0,He=h.interpolate||Ic,We="__p += '",rt=RE((h.escape||Ic).source+"|"+He.source+"|"+(He===Yu?bd:Ic).source+"|"+(h.evaluate||Ic).source+"|$","g"),ht="//# sourceURL="+(_n.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Oo+"]")+"\n";u.replace(rt,function(St,en,cn,Ls,zr,hs){return cn||(cn=Ls),We+=u.slice(Ve,hs).replace(Td,Bl),en&&(ye=!0,We+="' +\n__e("+en+") +\n'"),zr&&(be=!0,We+="';\n"+zr+";\n__p += '"),cn&&(We+="' +\n((__t = ("+cn+")) == null ? '' : __t) +\n'"),Ve=hs+St.length,St}),We+="';\n";var Ct=_n.call(h,"variable")&&h.variable;if(Ct){if(ra.test(Ct))throw new Mt("Invalid `variable` option passed into `_.template`")}else We="with (obj) {\n"+We+"\n}\n";We=(be?We.replace(Vu,""):We).replace(vd,"$1").replace(Hu,"$1;"),We="function("+(Ct||"obj")+") {\n"+(Ct?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(ye?", __e = _.escape":"")+(be?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+We+"return __p\n}";var Ut=Nm(function(){return bn(X,ht+"return "+We).apply(S,pe)});if(Ut.source=We,fm(Ut))throw Ut;return Ut},q.times=function Vm(u,h){if((u=Vt(u))<1||u>Ae)return[];var I=Le,M=Hr(u,Le);h=yt(h),u-=Le;for(var U=kc(M,h);++I<u;)h(I);return U},q.toFinite=Ca,q.toInteger=Vt,q.toLength=TC,q.toLower=function UC(u){return wn(u).toLowerCase()},q.toNumber=xs,q.toSafeInteger=function Qw(u){return u?Hl(Vt(u),-Ae,Ae):0===u?u:0},q.toString=wn,q.toUpper=function WC(u){return wn(u).toUpperCase()},q.trim=function dv(u,h,I){if((u=wn(u))&&(I||h===S))return Vr(u);if(!u||!(h=Wr(h)))return u;var M=rn(u),U=rn(h);return ya(M,Kt(M,U),kn(M,U)+1).join("")},q.trimEnd=function fv(u,h,I){if((u=wn(u))&&(I||h===S))return u.slice(0,CE(u)+1);if(!u||!(h=Wr(h)))return u;var M=rn(u);return ya(M,0,kn(M,rn(h))+1).join("")},q.trimStart=function jC(u,h,I){if((u=wn(u))&&(I||h===S))return u.replace(Ua,"");if(!u||!(h=Wr(h)))return u;var M=rn(u);return ya(M,Kt(M,rn(h))).join("")},q.truncate=function Vo(u,h){var I=30,M="...";if(jn(h)){var U="separator"in h?h.separator:U;I="length"in h?Vt(h.length):I,M="omission"in h?Wr(h.omission):M}var X=(u=wn(u)).length;if(Io(u)){var pe=rn(u);X=pe.length}if(I>=X)return u;var ye=I-ei(M);if(ye<1)return M;var be=pe?ya(pe,0,ye).join(""):u.slice(0,ye);if(U===S)return be+M;if(pe&&(ye+=be.length-ye),Kw(U)){if(u.slice(ye).search(U)){var Ve,He=be;for(U.global||(U=RE(U.source,wn(ja.exec(U))+"g")),U.lastIndex=0;Ve=U.exec(He);)var We=Ve.index;be=be.slice(0,We===S?ye:We)}}else if(u.indexOf(Wr(U),ye)!=ye){var rt=be.lastIndexOf(U);rt>-1&&(be=be.slice(0,rt))}return be+M},q.unescape=function Im(u){return(u=wn(u))&&na.test(u)?u.replace(Rc,ZA):u},q.uniqueId=function tR(u){var h=++cI;return wn(u)+h},q.upperCase=zC,q.upperFirst=Pm,q.each=tm,q.eachRight=gf,q.first=jp,Lm(q,function(){var u={};return xo(q,function(h,I){_n.call(q.prototype,I)||(u[I]=h)}),u}(),{chain:!1}),q.VERSION="4.17.21",Dt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){q[u].placeholder=q}),Dt(["drop","take"],function(u,h){Be.prototype[u]=function(I){I=I===S?1:jt(Vt(I),0);var M=this.__filtered__&&!h?new Be(this):this.clone();return M.__filtered__?M.__takeCount__=Hr(I,M.__takeCount__):M.__views__.push({size:Hr(I,Le),type:u+(M.__dir__<0?"Right":"")}),M},Be.prototype[u+"Right"]=function(I){return this.reverse()[u](I).reverse()}}),Dt(["filter","map","takeWhile"],function(u,h){var I=h+1,M=1==I||3==I;Be.prototype[u]=function(U){var X=this.clone();return X.__iteratees__.push({iteratee:yt(U,3),type:I}),X.__filtered__=X.__filtered__||M,X}}),Dt(["head","last"],function(u,h){var I="take"+(h?"Right":"");Be.prototype[u]=function(){return this[I](1).value()[0]}}),Dt(["initial","tail"],function(u,h){var I="drop"+(h?"":"Right");Be.prototype[u]=function(){return this.__filtered__?new Be(this):this[I](1)}}),Be.prototype.compact=function(){return this.filter(li)},Be.prototype.find=function(u){return this.filter(u).head()},Be.prototype.findLast=function(u){return this.reverse().find(u)},Be.prototype.invokeMap=zt(function(u,h){return"function"==typeof u?new Be(this):this.map(function(I){return Ul(I,u,h)})}),Be.prototype.reject=function(u){return this.filter(Ih(yt(u)))},Be.prototype.slice=function(u,h){u=Vt(u);var I=this;return I.__filtered__&&(u>0||h<0)?new Be(I):(u<0?I=I.takeRight(-u):u&&(I=I.drop(u)),h!==S&&(I=(h=Vt(h))<0?I.dropRight(-h):I.take(h-u)),I)},Be.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Be.prototype.toArray=function(){return this.take(Le)},xo(Be.prototype,function(u,h){var I=/^(?:filter|find|map|reject)|While$/.test(h),M=/^(?:head|last)$/.test(h),U=q[M?"take"+("last"==h?"Right":""):h],X=M||/^find/.test(h);!U||(q.prototype[h]=function(){var pe=this.__wrapped__,ye=M?[1]:arguments,be=pe instanceof Be,Ve=ye[0],He=be||Ft(pe),We=function(en){var cn=U.apply(q,za([en],ye));return M&&rt?cn[0]:cn};He&&I&&"function"==typeof Ve&&1!=Ve.length&&(be=He=!1);var rt=this.__chain__,ht=!!this.__actions__.length,Ct=X&&!rt,Ut=be&&!ht;if(!X&&He){pe=Ut?pe:new Be(this);var St=u.apply(pe,ye);return St.__actions__.push({func:ff,args:[We],thisArg:S}),new Rs(St,rt)}return Ct&&Ut?u.apply(this,ye):(St=this.thru(We),Ct?M?St.value()[0]:St.value():St)})}),Dt(["pop","push","shift","sort","splice","unshift"],function(u){var h=Qg[u],I=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",M=/^(?:pop|shift)$/.test(u);q.prototype[u]=function(){var U=arguments;if(M&&!this.__chain__){var X=this.value();return h.apply(Ft(X)?X:[],U)}return this[I](function(pe){return h.apply(Ft(pe)?pe:[],U)})}}),xo(Be.prototype,function(u,h){var I=q[h];if(I){var M=I.name+"";_n.call(Ka,M)||(Ka[M]=[]),Ka[M].push({name:h,func:I})}}),Ka[nf(S,2).name]=[{name:"wrapper",func:S}],Be.prototype.clone=function ln(){var u=new Be(this.__wrapped__);return u.__actions__=Yi(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Yi(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Yi(this.__views__),u},Be.prototype.reverse=function Ts(){if(this.__filtered__){var u=new Be(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},Be.prototype.value=function Sr(){var u=this.__wrapped__.value(),h=this.__dir__,I=Ft(u),M=h<0,U=I?u.length:0,X=function af(u,h,I){for(var M=-1,U=I.length;++M<U;){var X=I[M],pe=X.size;switch(X.type){case"drop":u+=pe;break;case"dropRight":h-=pe;break;case"take":h=Hr(h,u+pe);break;case"takeRight":u=jt(u,h-pe)}}return{start:u,end:h}}(0,U,this.__views__),pe=X.start,ye=X.end,be=ye-pe,Ve=M?ye:pe-1,He=this.__iteratees__,We=He.length,rt=0,ht=Hr(be,this.__takeCount__);if(!I||!M&&U==be&&ht==be)return mb(u,this.__actions__);var Ct=[];e:for(;be--&&rt<ht;){for(var Ut=-1,St=u[Ve+=h];++Ut<We;){var en=He[Ut],Ls=en.type,zr=(0,en.iteratee)(St);if(2==Ls)St=zr;else if(!zr){if(1==Ls)continue e;break e}}Ct[rt++]=St}return Ct},q.prototype.at=eC,q.prototype.chain=function tu(){return _w(this)},q.prototype.commit=function tC(){return new Rs(this.value(),this.__chain__)},q.prototype.next=function nu(){this.__values__===S&&(this.__values__=qw(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?S:this.__values__[this.__index__++]}},q.prototype.plant=function II(u){for(var h,I=this;I instanceof Vd;){var M=Hp(I);M.__index__=0,M.__values__=S,h?U.__wrapped__=M:h=M;var U=M;I=I.__wrapped__}return U.__wrapped__=u,h},q.prototype.reverse=function PI(){var u=this.__wrapped__;if(u instanceof Be){var h=u;return this.__actions__.length&&(h=new Be(this)),(h=h.reverse()).__actions__.push({func:ff,args:[jr],thisArg:S}),new Rs(h,this.__chain__)}return this.thru(jr)},q.prototype.toJSON=q.prototype.valueOf=q.prototype.value=function Dw(){return mb(this.__wrapped__,this.__actions__)},q.prototype.first=q.prototype.head,rh&&(q.prototype[rh]=function Go(){return this}),q}();vr._=Gl,(E=function(){return Gl}.call(D,p,D,L))!==S&&(L.exports=E)}.call(this)},9984:(L,D,p)=>{var E=p(4633),S=p(6517),O=p(2046),w=p(1503);L.exports=function R(f,y){return(w(f)?E:O)(f,S(y,3))}},203:(L,D,p)=>{var E=p(5683),S=p(5184),O=p(6517);L.exports=function w(R,f){var y={};return f=O(f,3),S(R,function(m,T,g){E(y,T,f(m,T,g))}),y}},8176:(L,D,p)=>{var E=p(7308),S=p(1100),O=p(2608);L.exports=function w(R){return R&&R.length?E(R,O,S):void 0}},535:(L,D,p)=>{var E=p(9850);function O(w,R){if("function"!=typeof w||null!=R&&"function"!=typeof R)throw new TypeError("Expected a function");var f=function(){var y=arguments,m=R?R.apply(this,y):y[0],T=f.cache;if(T.has(m))return T.get(m);var g=w.apply(this,y);return f.cache=T.set(m,g)||T,g};return f.cache=new(O.Cache||E),f}O.Cache=E,L.exports=O},567:(L,D,p)=>{var E=p(3842),O=p(4944)(function(w,R,f){E(w,R,f)});L.exports=O},9439:(L,D,p)=>{var E=p(7308),S=p(9069),O=p(2608);L.exports=function w(R){return R&&R.length?E(R,O,S):void 0}},9525:(L,D,p)=>{var E=p(7308),S=p(6517),O=p(9069);L.exports=function w(R,f){return R&&R.length?E(R,S(f,2),O):void 0}},2552:L=>{L.exports=function D(){}},1710:(L,D,p)=>{var E=p(2119);L.exports=function(){return E.Date.now()}},6372:(L,D,p)=>{var E=p(3021),O=p(3975)(function(w,R){return null==w?{}:E(w,R)});L.exports=O},7495:(L,D,p)=>{var E=p(1847),S=p(9222),O=p(5352),w=p(8533);L.exports=function R(f){return O(f)?E(w(f)):S(f)}},361:(L,D,p)=>{var S=p(7509)();L.exports=S},1337:(L,D,p)=>{var E=p(8745),S=p(3132),O=p(6517),w=p(3570),R=p(1503);L.exports=function f(y,m,T){var g=R(y)?E:w,C=arguments.length<3;return g(y,O(m,4),T,C,S)}},5637:(L,D,p)=>{var E=p(1172),S=p(8794),O=p(6507),w=p(248),R=p(2315);L.exports=function m(T){if(null==T)return 0;if(O(T))return w(T)?R(T):T.length;var g=S(T);return"[object Map]"==g||"[object Set]"==g?T.size:E(T).length}},2906:(L,D,p)=>{var E=p(686),S=p(6119),O=p(3269),w=p(3342),R=O(function(f,y){if(null==f)return[];var m=y.length;return m>1&&w(f,y[0],y[1])?y=[]:m>2&&w(y[0],y[1],y[2])&&(y=[y[0]]),S(f,E(y,1),[])});L.exports=R},9975:L=>{L.exports=function D(){return[]}},3580:L=>{L.exports=function D(){return!1}},2232:(L,D,p)=>{var E=p(1467),S=1/0;L.exports=function w(R){return R?(R=E(R))===S||R===-S?17976931348623157e292*(R<0?-1:1):R==R?R:0:0===R?R:0}},4401:(L,D,p)=>{var E=p(2232);L.exports=function S(O){var w=E(O),R=w%1;return w==w?R?w-R:w:0}},1467:(L,D,p)=>{var E=p(3348),S=p(5940),O=p(4129),R=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,y=/^0o[0-7]+$/i,m=parseInt;L.exports=function T(g){if("number"==typeof g)return g;if(O(g))return NaN;if(S(g)){var C="function"==typeof g.valueOf?g.valueOf():g;g=S(C)?C+"":C}if("string"!=typeof g)return 0===g?g:+g;g=E(g);var v=f.test(g);return v||y.test(g)?m(g.slice(2),v?2:8):R.test(g)?NaN:+g}},8067:(L,D,p)=>{var E=p(1989),S=p(6555);L.exports=function O(w){return E(w,S(w))}},3943:(L,D,p)=>{var E=p(3935);L.exports=function S(O){return null==O?"":E(O)}},9416:(L,D,p)=>{var E=p(6837),S=p(8858),O=p(5184),w=p(6517),R=p(9519),f=p(1503),y=p(891),m=p(5946),T=p(5940),g=p(8159);L.exports=function C(v,P,_){var x=f(v),B=x||y(v)||g(v);if(P=w(P,4),null==_){var H=v&&v.constructor;_=B?x?new H:[]:T(v)&&m(H)?S(R(v)):{}}return(B?E:O)(v,function(K,V,ne){return P(_,K,V,ne)}),_}},8921:(L,D,p)=>{var E=p(686),S=p(3269),O=p(707),w=p(1330),R=S(function(f){return O(E(f,1,w,!0))});L.exports=R},1541:(L,D,p)=>{var E=p(3943),S=0;L.exports=function O(w){var R=++S;return E(w)+R}},377:(L,D,p)=>{var E=p(9179),S=p(118);L.exports=function O(w){return null==w?[]:E(w,S(w))}},1617:(L,D,p)=>{var E=p(9719),S=p(8645);L.exports=function O(w,R){return S(w||[],R||[],E)}},5114:(L,D,p)=>{"use strict";const S=p(2186);D.c=class O extends S.LinkedList{constructor(...R){super(...R)}get front(){return this.head}enqueue(R){this.append(R)}dequeue(){return this.removeHead()}}},5341:(L,D,p)=>{"use strict";const S=p(2186);D.K=class O extends S.LinkedList{constructor(...R){super(...R)}get top(){return this.head}get size(){return this.length}push(R){this.prepend(R)}pop(){return this.removeHead()}}},9737:function(L,D){"use strict";var p=this&&this.__spreadArrays||function(){for(var O=0,w=0,R=arguments.length;w<R;w++)O+=arguments[w].length;var f=Array(O),y=0;for(w=0;w<R;w++)for(var m=arguments[w],T=0,g=m.length;T<g;T++,y++)f[y]=m[T];return f};Object.defineProperty(D,"__esModule",{value:!0}),D.StringBuilder=D.String=void 0;var E=function(){function O(){}return O.IsNullOrWhiteSpace=function(w){try{return null==w||"undefined"==w||w.toString().replace(/\s/g,"").length<1}catch(R){return console.log(R),!1}},O.Join=function(w){for(var R=[],f=1;f<arguments.length;f++)R[f-1]=arguments[f];try{var y=R[0];if(Array.isArray(y)||y instanceof Array){for(var m=O.Empty,g=0;g<y.length;g++){var C=y[g];m+=g<y.length-1?C+w:C}return m}if("object"==typeof y){var v=O.Empty,P=y,_=Object.keys(y);return _.forEach(function(B){v+=P[B]+w}),v=v.slice(0,v.length-w.length)}var x=R;return O.join.apply(O,p([w],x))}catch(B){return console.log(B),O.Empty}},O.Format=function(w){for(var R=[],f=1;f<arguments.length;f++)R[f-1]=arguments[f];try{return w.match(O.regexNumber)?O.format(O.regexNumber,w,R):w.match(O.regexObject)?O.format(O.regexObject,w,R,!0):w}catch(y){return console.log(y),O.Empty}},O.format=function(w,R,f,y){return void 0===y&&(y=!1),R.replace(w,function(m,T){var C,g=m.split(":");return g.length>1&&(T=g[0].replace("{",""),m=g[1].replace("}","")),null==(C=y?f[0][T]:f[T])||null==C||m.match(/{\d+}/)||void 0!==(C=O.parsePattern(m,C))&&null!=C?C:O.Empty})},O.parsePattern=function(w,R){switch(w){case"L":return R.toLocaleLowerCase();case"U":return R.toLocaleUpperCase();case"d":if("string"==typeof R)return O.getDisplayDateFromString(R);if(R instanceof Date)return O.Format("{0:00}.{1:00}.{2:0000}",R.getDate(),R.getMonth(),R.getFullYear());break;case"s":if("string"==typeof R)return O.getSortableDateFromString(R);if(R instanceof Date)return O.Format("{0:0000}-{1:00}-{2:00}",R.getFullYear(),R.getMonth(),R.getDate());break;case"n":"string"!=typeof R&&(R=R.toString());var f=R.replace(/,/g,".");if(isNaN(parseFloat(f))||f.length<=3)break;var y=f.split(/[^0-9]+/g),m=y;y.length>1&&(m=[O.join.apply(O,p([""],y.splice(0,y.length-1))),y[y.length-1]]);var T=m[0],g=T.length%3,C=g>0?T.substring(0,g):O.Empty,P=T.substring(g).match(/.{3}/g);return(C=C+"."+O.Join(".",P))+(m.length>1?","+m[1]:"");case"x":return this.decimalToHexString(R);case"X":return this.decimalToHexString(R,!0)}return"number"!=typeof R&&isNaN(R)||isNaN(+w)||O.IsNullOrWhiteSpace(R)?R:O.formatNumber(R,w)},O.decimalToHexString=function(w,R){void 0===R&&(R=!1);var y=parseFloat(w).toString(16);return R?y.toLocaleUpperCase():y},O.getDisplayDateFromString=function(w){var R;if((R=w.split("-")).length<=1)return w;var f=R[R.length-1],y=R[R.length-2],m=R[R.length-3];return(f=(f=f.split("T")[0]).split(" ")[0])+"."+y+"."+m},O.getSortableDateFromString=function(w){var R=w.replace(",","").split(".");if(R.length<=1)return w;var f=R[R.length-1].split(" "),y=O.Empty;f.length>1&&(y=f[f.length-1]);var C=R[R.length-1].split(" ")[0]+"-"+R[R.length-2]+"-"+R[R.length-3];return!O.IsNullOrWhiteSpace(y)&&y.length>1?C+="T"+y:C+="T00:00:00",C},O.formatNumber=function(w,R){var f=R.length,y=w.toString();if(f<=y.length)return y;var m=f-y.length;return new Array(m+=1).join("0")+y},O.join=function(w){for(var R=[],f=1;f<arguments.length;f++)R[f-1]=arguments[f];for(var y=O.Empty,m=0;m<R.length;m++)if(!("string"==typeof R[m]&&O.IsNullOrWhiteSpace(R[m])||"number"!=typeof R[m]&&"string"!=typeof R[m])){var T=""+R[m];y+=T;for(var g=m+1;g<R.length;g++)if(!O.IsNullOrWhiteSpace(R[g])){y+=w,m=g-1;break}}return y},O.regexNumber=/{(\d+(:\w*)?)}/g,O.regexObject=/{(\w+(:\w*)?)}/g,O.Empty="",O}();D.String=E;var S=function(){function O(w){this.Values=[],E.IsNullOrWhiteSpace(w)||(this.Values=new Array(w))}return O.prototype.ToString=function(){return this.Values.join("")},O.prototype.Append=function(w){this.Values.push(w)},O.prototype.AppendLine=function(w){this.Values.push("\r\n"+w)},O.prototype.AppendFormat=function(w){for(var R=[],f=1;f<arguments.length;f++)R[f-1]=arguments[f];this.Values.push(E.Format.apply(E,p([w],R)))},O.prototype.AppendLineFormat=function(w){for(var R=[],f=1;f<arguments.length;f++)R[f-1]=arguments[f];this.Values.push("\r\n"+E.Format.apply(E,p([w],R)))},O.prototype.Clear=function(){this.Values=[]},O}();D.StringBuilder=S},7824:(L,D,p)=>{"use strict";function E(S){for(var O in S)D.hasOwnProperty(O)||(D[O]=S[O])}Object.defineProperty(D,"__esModule",{value:!0}),E(p(5085)),E(p(6243)),E(p(1786)),E(p(225)),E(p(6767)),E(p(345)),E(p(5675)),E(p(6461)),E(p(8802)),E(p(3900)),E(p(8866)),E(p(4655)),E(p(4068)),E(p(3858)),E(p(8237)),E(p(3292))},5085:function(L,D,p){"use strict";var R,E=this&&this.__extends||(R=function(f,y){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,T){m.__proto__=T}||function(m,T){for(var g in T)T.hasOwnProperty(g)&&(m[g]=T[g])})(f,y)},function(f,y){function m(){this.constructor=f}R(f,y),f.prototype=null===y?Object.create(y):(m.prototype=y.prototype,new m)});Object.defineProperty(D,"__esModule",{value:!0});var S=p(5675),O=function(R){function f(y){var m=R.call(this)||this,g=y;return g.trigger&&(m.trigger=g.trigger),g.kick&&(m.kick=g.kick),g.drag&&(m.drag=g.drag),g.on&&(m.on=g.on),m.dragstart=m.dragStart=S.Layout.dragStart,m.dragend=m.dragEnd=S.Layout.dragEnd,m}return E(f,R),f.prototype.trigger=function(y){},f.prototype.kick=function(){},f.prototype.drag=function(){},f.prototype.on=function(y,m){return this},f}(S.Layout);D.LayoutAdaptor=O,D.adaptor=function w(R){return new O(R)}},3292:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var E=p(5675),S=p(6767);D.gridify=function O(f,y,m,T){f.cola.start(0,0,0,10,!1);var g=function w(f,y,m,T){f.forEach(function(C){C.routerNode={name:C.name,bounds:C.bounds.inflate(-m)}}),y.forEach(function(C){C.routerNode={bounds:C.bounds.inflate(-T),children:(void 0!==C.groups?C.groups.map(function(v){return f.length+v.id}):[]).concat(void 0!==C.leaves?C.leaves.map(function(v){return v.index}):[])}});var g=f.concat(y).map(function(C,v){return C.routerNode.id=v,C.routerNode});return new S.GridRouter(g,{getChildren:function(C){return C.children},getBounds:function(C){return C.bounds}},m-T)}(f.cola.nodes(),f.cola.groups(),m,T);return g.routeEdges(f.powerGraph.powerEdges,y,function(C){return C.source.routerNode.id},function(C){return C.target.routerNode.id})},D.powerGraphGridLayout=function R(f,y,m){var T;f.nodes.forEach(function(P,_){return P.index=_}),(new E.Layout).avoidOverlaps(!1).nodes(f.nodes).links(f.links).powerGraphGroups(function(P){(T=P).groups.forEach(function(_){return _.padding=m})});var g=f.nodes.length,C=[],v=f.nodes.slice(0);return v.forEach(function(P,_){return P.index=_}),T.groups.forEach(function(P){var _=P.index=P.id+g;v.push(P),void 0!==P.leaves&&P.leaves.forEach(function(x){return C.push({source:_,target:x.index})}),void 0!==P.groups&&P.groups.forEach(function(x){return C.push({source:_,target:x.id+g})})}),T.powerEdges.forEach(function(P){C.push({source:P.source.index,target:P.target.index})}),(new E.Layout).size(y).nodes(v).links(C).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:(new E.Layout).convergenceThreshold(.001).size(y).avoidOverlaps(!0).nodes(f.nodes).links(f.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups(function(P){(T=P).groups.forEach(function(_){_.padding=m})}).start(50,0,100,0,!1),powerGraph:T}}},6243:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var E=p(9346),S=p(2487);D.d3adaptor=function O(R){return!R||function w(R){return R.version&&null!==R.version.match(/^3\./)}(R)?new E.D3StyleLayoutAdaptor:new S.D3StyleLayoutAdaptor(R)}},9346:function(L,D,p){"use strict";var R,E=this&&this.__extends||(R=function(f,y){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,T){m.__proto__=T}||function(m,T){for(var g in T)T.hasOwnProperty(g)&&(m[g]=T[g])})(f,y)},function(f,y){function m(){this.constructor=f}R(f,y),f.prototype=null===y?Object.create(y):(m.prototype=y.prototype,new m)});Object.defineProperty(D,"__esModule",{value:!0});var S=p(5675),O=function(R){function f(){var y=R.call(this)||this;y.event=d3.dispatch(S.EventType[S.EventType.start],S.EventType[S.EventType.tick],S.EventType[S.EventType.end]);var m=y;return y.drag=function(){if(!g)var g=d3.behavior.drag().origin(S.Layout.dragOrigin).on("dragstart.d3adaptor",S.Layout.dragStart).on("drag.d3adaptor",function(C){S.Layout.drag(C,d3.event),m.resume()}).on("dragend.d3adaptor",S.Layout.dragEnd);if(!arguments.length)return g;this.call(g)},y}return E(f,R),f.prototype.trigger=function(y){var m={type:S.EventType[y.type],alpha:y.alpha,stress:y.stress};this.event[m.type](m)},f.prototype.kick=function(){var y=this;d3.timer(function(){return R.prototype.tick.call(y)})},f.prototype.on=function(y,m){return this.event.on("string"==typeof y?y:S.EventType[y],m),this},f}(S.Layout);D.D3StyleLayoutAdaptor=O,D.d3adaptor=function w(){return new O}},2487:function(L,D,p){"use strict";var w,E=this&&this.__extends||(w=function(R,f){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,m){y.__proto__=m}||function(y,m){for(var T in m)m.hasOwnProperty(T)&&(y[T]=m[T])})(R,f)},function(R,f){function y(){this.constructor=R}w(R,f),R.prototype=null===f?Object.create(f):(y.prototype=f.prototype,new y)});Object.defineProperty(D,"__esModule",{value:!0});var S=p(5675),O=function(w){function R(f){var y=w.call(this)||this;y.d3Context=f,y.event=f.dispatch(S.EventType[S.EventType.start],S.EventType[S.EventType.tick],S.EventType[S.EventType.end]);var m=y;return y.drag=function(){if(!g)var g=f.drag().subject(S.Layout.dragOrigin).on("start.d3adaptor",S.Layout.dragStart).on("drag.d3adaptor",function(C){S.Layout.drag(C,f.event),m.resume()}).on("end.d3adaptor",S.Layout.dragEnd);if(!arguments.length)return g;arguments[0].call(g)},y}return E(R,w),R.prototype.trigger=function(f){var y={type:S.EventType[f.type],alpha:f.alpha,stress:f.stress};this.event.call(y.type,y)},R.prototype.kick=function(){var f=this,y=this.d3Context.timer(function(){return w.prototype.tick.call(f)&&y.stop()})},R.prototype.on=function(f,y){return this.event.on("string"==typeof f?f:S.EventType[f],y),this},R}(S.Layout);D.D3StyleLayoutAdaptor=O},1786:(L,D)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var p=function(){function O(){this.locks={}}return O.prototype.add=function(w,R){this.locks[w]=R},O.prototype.clear=function(){this.locks={}},O.prototype.isEmpty=function(){for(var w in this.locks)return!1;return!0},O.prototype.apply=function(w){for(var R in this.locks)w(Number(R),this.locks[R])},O}();D.Locks=p;var E=function(){function O(w,R,f){void 0===f&&(f=null),this.D=R,this.G=f,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new S,this.project=null,this.x=w,this.k=w.length;var y=this.n=w[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new p,this.minD=Number.MAX_VALUE;for(var T,m=y;m--;)for(T=y;--T>m;){var g=R[m][T];g>0&&g<this.minD&&(this.minD=g)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),m=this.k;m--;){for(this.g[m]=new Array(y),this.H[m]=new Array(y),T=y;T--;)this.H[m][T]=new Array(y);this.Hd[m]=new Array(y),this.a[m]=new Array(y),this.b[m]=new Array(y),this.c[m]=new Array(y),this.d[m]=new Array(y),this.e[m]=new Array(y),this.ia[m]=new Array(y),this.ib[m]=new Array(y),this.xtmp[m]=new Array(y)}}return O.createSquareMatrix=function(w,R){for(var f=new Array(w),y=0;y<w;++y){f[y]=new Array(w);for(var m=0;m<w;++m)f[y][m]=R(y,m)}return f},O.prototype.offsetDir=function(){for(var w=this,R=new Array(this.k),f=0,y=0;y<this.k;++y){var m=R[y]=this.random.getNextBetween(.01,1)-.5;f+=m*m}return f=Math.sqrt(f),R.map(function(T){return T*(w.minD/f)})},O.prototype.computeDerivatives=function(w){var R=this,f=this.n;if(!(f<1)){for(var y,m=new Array(this.k),T=new Array(this.k),g=new Array(this.k),C=0,v=0;v<f;++v){for(y=0;y<this.k;++y)g[y]=this.g[y][v]=0;for(var P=0;P<f;++P)if(v!==P){for(var _=f;_--;){var x=0;for(y=0;y<this.k;++y){var B=m[y]=w[y][v]-w[y][P];x+=T[y]=B*B}if(x>1e-9)break;var H=this.offsetDir();for(y=0;y<this.k;++y)w[y][P]+=H[y]}var K=Math.sqrt(x),V=this.D[v][P],ne=null!=this.G?this.G[v][P]:1;if(ne>1&&K>V||!isFinite(V)){for(y=0;y<this.k;++y)this.H[y][v][P]=0;continue}ne>1&&(ne=1);var se=V*V,ge=2*ne*(K-V)/(se*K),ce=K*K*K,me=2*-ne/(se*ce);for(isFinite(ge)||console.log(ge),y=0;y<this.k;++y)this.g[y][v]+=m[y]*ge,g[y]-=this.H[y][v][P]=me*(ce+V*(T[y]-x)+K*x)}for(y=0;y<this.k;++y)C=Math.max(C,this.H[y][v][v]=g[y])}var Q=this.snapGridSize/2,te=this.snapGridSize,$=this.snapStrength/(Q*Q),J=this.numGridSnapNodes;for(v=0;v<J;++v)for(y=0;y<this.k;++y){var ae=this.x[y][v],Ee=ae/te,re=Ee%1,ee=Ee-re;-Q<(B=Math.abs(re)<=.5?ae-ee*te:ae>0?ae-(ee+1)*te:ae-(ee-1)*te)&&B<=Q&&(this.scaleSnapByMaxH?(this.g[y][v]+=C*$*B,this.H[y][v][v]+=C*$):(this.g[y][v]+=$*B,this.H[y][v][v]+=$))}this.locks.isEmpty()||this.locks.apply(function(De,Ne){for(y=0;y<R.k;++y)R.H[y][De][De]+=C,R.g[y][De]-=C*(Ne[y]-w[y][De])})}},O.dotProd=function(w,R){for(var f=0,y=w.length;y--;)f+=w[y]*R[y];return f},O.rightMultiply=function(w,R,f){for(var y=w.length;y--;)f[y]=O.dotProd(w[y],R)},O.prototype.computeStepSize=function(w){for(var R=0,f=0,y=0;y<this.k;++y)R+=O.dotProd(this.g[y],w[y]),O.rightMultiply(this.H[y],w[y],this.Hd[y]),f+=O.dotProd(w[y],this.Hd[y]);return 0!==f&&isFinite(f)?1*R/f:0},O.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var w=this.computeStepSize(this.g),R=0;R<this.k;++R)this.takeDescentStep(this.x[R],this.g[R],w);return this.computeStress()},O.copy=function(w,R){for(var f=w.length,y=R[0].length,m=0;m<f;++m)for(var T=0;T<y;++T)R[m][T]=w[m][T]},O.prototype.stepAndProject=function(w,R,f,y){O.copy(w,R),this.takeDescentStep(R[0],f[0],y),this.project&&this.project[0](w[0],w[1],R[0]),this.takeDescentStep(R[1],f[1],y),this.project&&this.project[1](R[0],w[1],R[1]);for(var m=2;m<this.k;m++)this.takeDescentStep(R[m],f[m],y)},O.mApply=function(w,R,f){for(var y=w;y-- >0;)for(var m=R;m-- >0;)f(y,m)},O.prototype.matrixApply=function(w){O.mApply(this.k,this.n,w)},O.prototype.computeNextPosition=function(w,R){var f=this;this.computeDerivatives(w);var y=this.computeStepSize(this.g);if(this.stepAndProject(w,R,this.g,y),this.project){this.matrixApply(function(T,g){return f.e[T][g]=w[T][g]-R[T][g]});var m=this.computeStepSize(this.e);m=Math.max(.2,Math.min(m,1)),this.stepAndProject(w,R,this.e,m)}},O.prototype.run=function(w){for(var R=Number.MAX_VALUE,f=!1;!f&&w-- >0;){var y=this.rungeKutta();f=Math.abs(R/y-1)<this.threshold,R=y}return R},O.prototype.rungeKutta=function(){var w=this;this.computeNextPosition(this.x,this.a),O.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),O.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var R=0;return this.matrixApply(function(f,y){var m=(w.a[f][y]+2*w.b[f][y]+2*w.c[f][y]+w.d[f][y])/6,T=w.x[f][y]-m;R+=T*T,w.x[f][y]=m}),R},O.mid=function(w,R,f){O.mApply(w.length,w[0].length,function(y,m){return f[y][m]=w[y][m]+(R[y][m]-w[y][m])/2})},O.prototype.takeDescentStep=function(w,R,f){for(var y=0;y<this.n;++y)w[y]=w[y]-f*R[y]},O.prototype.computeStress=function(){for(var w=0,R=0,f=this.n-1;R<f;++R)for(var y=R+1,m=this.n;y<m;++y){for(var T=0,g=0;g<this.k;++g){var C=this.x[g][R]-this.x[g][y];T+=C*C}T=Math.sqrt(T);var v=this.D[R][y];if(isFinite(v)){var P=v-T;w+=P*P/(v*v)}}return w},O.zeroDistance=1e-10,O}();D.Descent=E;var S=function(){function O(w){void 0===w&&(w=1),this.seed=w,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return O.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},O.prototype.getNextBetween=function(w,R){return w+this.getNext()*(R-w)},O}();D.PseudoRandom=S},225:function(L,D,p){"use strict";var re,E=this&&this.__extends||(re=function(ee,Ae){return(re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(De,Ne){De.__proto__=Ne}||function(De,Ne){for(var Le in Ne)Ne.hasOwnProperty(Le)&&(De[Le]=Ne[Le])})(ee,Ae)},function(ee,Ae){function De(){this.constructor=ee}re(ee,Ae),ee.prototype=null===Ae?Object.create(Ae):(De.prototype=Ae.prototype,new De)});Object.defineProperty(D,"__esModule",{value:!0});var S=p(4068),O=function re(){};D.Point=O;var w=function re(ee,Ae,De,Ne){this.x1=ee,this.y1=Ae,this.x2=De,this.y2=Ne};D.LineSegment=w;var R=function(re){function ee(){return null!==re&&re.apply(this,arguments)||this}return E(ee,re),ee}(O);function f(re,ee,Ae){return(ee.x-re.x)*(Ae.y-re.y)-(Ae.x-re.x)*(ee.y-re.y)}function y(re,ee,Ae){return f(re,ee,Ae)>0}function m(re,ee,Ae){return f(re,ee,Ae)<0}function P(re,ee){var Ae=ee.slice(0);return Ae.push(ee[0]),{rtan:_(re,Ae),ltan:x(re,Ae)}}function _(re,ee){var De,Ne,Le,je,Ae=ee.length-1;if(m(re,ee[1],ee[0])&&!y(re,ee[Ae-1],ee[0]))return 0;for(De=0,Ne=Ae;;){if(Ne-De==1)return y(re,ee[De],ee[Ne])?De:Ne;if((je=m(re,ee[(Le=Math.floor((De+Ne)/2))+1],ee[Le]))&&!y(re,ee[Le-1],ee[Le]))return Le;y(re,ee[De+1],ee[De])?je||y(re,ee[De],ee[Le])?Ne=Le:De=Le:je&&m(re,ee[De],ee[Le])?Ne=Le:De=Le}}function x(re,ee){var De,Ne,Le,je,Ae=ee.length-1;if(y(re,ee[Ae-1],ee[0])&&!m(re,ee[1],ee[0]))return 0;for(De=0,Ne=Ae;;){if(Ne-De==1)return m(re,ee[De],ee[Ne])?De:Ne;if(je=m(re,ee[(Le=Math.floor((De+Ne)/2))+1],ee[Le]),y(re,ee[Le-1],ee[Le])&&!je)return Le;m(re,ee[De+1],ee[De])?je?m(re,ee[De],ee[Le])?Ne=Le:De=Le:Ne=Le:je?De=Le:y(re,ee[De],ee[Le])?Ne=Le:De=Le}}function B(re,ee,Ae,De,Ne,Le){var ke,je;je=De(re[ke=Ae(ee[0],re)],ee);for(var ft=!1;!ft;){for(ft=!0;ke===re.length-1&&(ke=0),!Ne(ee[je],re[ke],re[ke+1]);)++ke;for(;0===je&&(je=ee.length-1),!Le(re[ke],ee[je],ee[je-1]);)--je,ft=!1}return{t1:ke,t2:je}}function K(re,ee){return B(re,ee,_,x,y,m)}D.PolyPoint=R,D.isLeft=f,D.ConvexHull=function T(re){var De,ee=re.slice(0).sort(function(Oe,Ye){return Oe.x!==Ye.x?Ye.x-Oe.x:Ye.y-Oe.y}),Ae=re.length,Le=ee[0].x;for(De=1;De<Ae&&ee[De].x===Le;++De);var ke=De-1,je=[];if(je.push(ee[0]),ke===Ae-1)ee[ke].y!==ee[0].y&&je.push(ee[ke]);else{var ft,Se=Ae-1,Ie=ee[Ae-1].x;for(De=Ae-2;De>=0&&ee[De].x===Ie;De--);for(ft=De+1,De=ke;++De<=ft;)if(!(f(ee[0],ee[ft],ee[De])>=0&&De<ft)){for(;je.length>1&&!(f(je[je.length-2],je[je.length-1],ee[De])>0);)je.length-=1;0!=De&&je.push(ee[De])}Se!=ft&&je.push(ee[Se]);var _e=je.length;for(De=ft;--De>=ke;)if(!(f(ee[Se],ee[ke],ee[De])>=0&&De>ke)){for(;je.length>_e&&!(f(je[je.length-2],je[je.length-1],ee[De])>0);)je.length-=1;0!=De&&je.push(ee[De])}}return je},D.clockwiseRadialSweep=function g(re,ee,Ae){ee.slice(0).sort(function(De,Ne){return Math.atan2(De.y-re.y,De.x-re.x)-Math.atan2(Ne.y-re.y,Ne.x-re.x)}).forEach(Ae)},D.tangent_PolyPolyC=B,D.LRtangent_PolyPolyC=function H(re,ee){var Ae=K(ee,re);return{t1:Ae.t2,t2:Ae.t1}},D.RLtangent_PolyPolyC=K,D.LLtangent_PolyPolyC=function V(re,ee){return B(re,ee,x,x,m,m)},D.RRtangent_PolyPolyC=function ne(re,ee){return B(re,ee,_,_,y,y)};var se=function re(ee,Ae){this.t1=ee,this.t2=Ae};D.BiTangent=se;var ge=function re(){};D.BiTangents=ge;var ce=function(re){function ee(){return null!==re&&re.apply(this,arguments)||this}return E(ee,re),ee}(O);D.TVGPoint=ce;var me=function re(ee,Ae,De,Ne){this.id=ee,this.polyid=Ae,this.polyvertid=De,this.p=Ne,Ne.vv=this};D.VisibilityVertex=me;var Q=function(){function re(ee,Ae){this.source=ee,this.target=Ae}return re.prototype.length=function(){var ee=this.source.p.x-this.target.p.x,Ae=this.source.p.y-this.target.p.y;return Math.sqrt(ee*ee+Ae*Ae)},re}();D.VisibilityEdge=Q;var te=function(){function re(ee,Ae){if(this.P=ee,this.V=[],this.E=[],Ae)this.V=Ae.V.slice(0),this.E=Ae.E.slice(0);else{for(var De=ee.length,Ne=0;Ne<De;Ne++){for(var Le=ee[Ne],ke=0;ke<Le.length;++ke){var ft=new me(this.V.length,Ne,ke,Le[ke]);this.V.push(ft),ke>0&&this.E.push(new Q(Le[ke-1].vv,ft))}Le.length>1&&this.E.push(new Q(Le[0].vv,Le[Le.length-1].vv))}for(Ne=0;Ne<De-1;Ne++){var Se=ee[Ne];for(ke=Ne+1;ke<De;ke++){var Ie=ee[ke],_e=$(Se,Ie);for(var Oe in _e){var Ye=_e[Oe];this.addEdgeIfVisible(Se[Ye.t1],Ie[Ye.t2],Ne,ke)}}}}}return re.prototype.addEdgeIfVisible=function(ee,Ae,De,Ne){this.intersectsPolys(new w(ee.x,ee.y,Ae.x,Ae.y),De,Ne)||this.E.push(new Q(ee.vv,Ae.vv))},re.prototype.addPoint=function(ee,Ae){var De=this.P.length;this.V.push(new me(this.V.length,De,0,ee));for(var Ne=0;Ne<De;++Ne)if(Ne!==Ae){var Le=this.P[Ne],ke=P(ee,Le);this.addEdgeIfVisible(ee,Le[ke.ltan],Ae,Ne),this.addEdgeIfVisible(ee,Le[ke.rtan],Ae,Ne)}return ee.vv},re.prototype.intersectsPolys=function(ee,Ae,De){for(var Ne=0,Le=this.P.length;Ne<Le;++Ne)if(Ne!=Ae&&Ne!=De&&j(ee,this.P[Ne]).length>0)return!0;return!1},re}();function j(re,ee){for(var Ae=[],De=1,Ne=ee.length;De<Ne;++De){var Le=S.Rectangle.lineIntersection(re.x1,re.y1,re.x2,re.y2,ee[De-1].x,ee[De-1].y,ee[De].x,ee[De].y);Le&&Ae.push(Le)}return Ae}function $(re,ee){for(var Ae=re.length-1,De=ee.length-1,Ne=new ge,Le=0;Le<Ae;++Le)for(var ke=0;ke<De;++ke){var je=re[0==Le?Ae-1:Le-1],ft=re[Le],Se=re[Le+1],Ie=ee[0==ke?De-1:ke-1],_e=ee[ke],Oe=ee[ke+1],Ye=f(je,ft,_e),et=f(ft,Ie,_e),mt=f(ft,_e,Oe),kt=f(Ie,_e,ft),Br=f(_e,je,ft),dn=f(_e,ft,Se);Ye>=0&&et>=0&&mt<0&&kt>=0&&Br>=0&&dn<0?Ne.ll=new se(Le,ke):Ye<=0&&et<=0&&mt>0&&kt<=0&&Br<=0&&dn>0?Ne.rr=new se(Le,ke):Ye<=0&&et>0&&mt<=0&&kt>=0&&Br<0&&dn>=0?Ne.rl=new se(Le,ke):Ye>=0&&et<0&&mt>=0&&kt<=0&&Br>0&&dn<=0&&(Ne.lr=new se(Le,ke))}return Ne}function ae(re,ee){return!re.every(function(Ae){return!function J(re,ee){for(var Ae=1,De=ee.length;Ae<De;++Ae)if(m(ee[Ae-1],ee[Ae],re))return!1;return!0}(Ae,ee)})}D.TangentVisibilityGraph=te,D.tangents=$,D.polysOverlap=function Ee(re,ee){if(ae(re,ee)||ae(ee,re))return!0;for(var Ae=1,De=re.length;Ae<De;++Ae){var Ne=re[Ae],Le=re[Ae-1];if(j(new w(Le.x,Le.y,Ne.x,Ne.y),ee).length>0)return!0}return!1}},6767:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var E=p(4068),S=p(8237),O=p(3858),w=function m(T,g,C){this.id=T,this.rect=g,this.children=C,this.leaf=void 0===C||0===C.length};D.NodeWrapper=w;var R=function m(T,g,C,v,P){void 0===v&&(v=null),void 0===P&&(P=null),this.id=T,this.x=g,this.y=C,this.node=v,this.line=P};D.Vert=R;var f=function(){function m(T,g){this.s=T,this.t=g;var C=m.findMatch(T,g),v=g.slice(0).reverse(),P=m.findMatch(T,v);C.length>=P.length?(this.length=C.length,this.si=C.si,this.ti=C.ti,this.reversed=!1):(this.length=P.length,this.si=P.si,this.ti=g.length-P.ti-P.length,this.reversed=!0)}return m.findMatch=function(T,g){for(var C=T.length,v=g.length,P={length:0,si:-1,ti:-1},_=new Array(C),x=0;x<C;x++){_[x]=new Array(v);for(var B=0;B<v;B++)if(T[x]===g[B]){var H=_[x][B]=0===x||0===B?1:_[x-1][B-1]+1;H>P.length&&(P.length=H,P.si=x-H+1,P.ti=B-H+1)}else _[x][B]=0}return P},m.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},m}();D.LongestCommonSubsequence=f;var y=function(){function m(T,g,C){var v=this;void 0===C&&(C=12),this.originalnodes=T,this.groupPadding=C,this.leaves=null,this.nodes=T.map(function(ce,me){return new w(me,g.getBounds(ce),g.getChildren(ce))}),this.leaves=this.nodes.filter(function(ce){return ce.leaf}),this.groups=this.nodes.filter(function(ce){return!ce.leaf}),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach(function(ce){return ce.children.forEach(function(me){return v.nodes[me].parent=ce})}),this.root={children:[]},this.nodes.forEach(function(ce){void 0===ce.parent&&(ce.parent=v.root,v.root.children.push(ce.id)),ce.ports=[]}),this.backToFront=this.nodes.slice(0),this.backToFront.sort(function(ce,me){return v.getDepth(ce)-v.getDepth(me)}),this.backToFront.slice(0).reverse().filter(function(ce){return!ce.leaf}).forEach(function(ce){var me=E.Rectangle.empty();ce.children.forEach(function(Q){return me=me.union(v.nodes[Q].rect)}),ce.rect=me.inflate(v.groupPadding)});var _=this.midPoints(this.cols.map(function(ce){return ce.pos})),x=this.midPoints(this.rows.map(function(ce){return ce.pos})),B=_[0],H=_[_.length-1],K=x[0],V=x[x.length-1],ne=this.rows.map(function(ce){return{x1:B,x2:H,y1:ce.pos,y2:ce.pos}}).concat(x.map(function(ce){return{x1:B,x2:H,y1:ce,y2:ce}})),se=this.cols.map(function(ce){return{x1:ce.pos,x2:ce.pos,y1:K,y2:V}}).concat(_.map(function(ce){return{x1:ce,x2:ce,y1:K,y2:V}})),ge=ne.concat(se);ge.forEach(function(ce){return ce.verts=[]}),this.verts=[],this.edges=[],ne.forEach(function(ce){return se.forEach(function(me){var Q=new R(v.verts.length,me.x1,ce.y1);ce.verts.push(Q),me.verts.push(Q),v.verts.push(Q);for(var te=v.backToFront.length;te-- >0;){var j=v.backToFront[te],$=j.rect,J=Math.abs(Q.x-$.cx()),ae=Math.abs(Q.y-$.cy());if(J<$.width()/2&&ae<$.height()/2){Q.node=j;break}}})}),ge.forEach(function(ce,me){v.nodes.forEach(function(ae,Ee){ae.rect.lineIntersections(ce.x1,ce.y1,ce.x2,ce.y2).forEach(function(re,ee){var Ae=new R(v.verts.length,re.x,re.y,ae,ce);v.verts.push(Ae),ce.verts.push(Ae),ae.ports.push(Ae)})});var Q=Math.abs(ce.y1-ce.y2)<.1,te=function(ae,Ee){return Q?Ee.x-ae.x:Ee.y-ae.y};ce.verts.sort(te);for(var j=1;j<ce.verts.length;j++){var $=ce.verts[j-1],J=ce.verts[j];$.node&&$.node===J.node&&$.node.leaf||v.edges.push({source:$.id,target:J.id,length:Math.abs(te($,J))})}})}return m.prototype.avg=function(T){return T.reduce(function(g,C){return g+C})/T.length},m.prototype.getGridLines=function(T){for(var g=[],C=this.leaves.slice(0,this.leaves.length);C.length>0;){var v=C.filter(function(_){return _.rect["overlap"+T.toUpperCase()](C[0].rect)}),P={nodes:v,pos:this.avg(v.map(function(_){return _.rect["c"+T]()}))};g.push(P),P.nodes.forEach(function(_){return C.splice(C.indexOf(_),1)})}return g.sort(function(_,x){return _.pos-x.pos}),g},m.prototype.getDepth=function(T){for(var g=0;T.parent!==this.root;)g++,T=T.parent;return g},m.prototype.midPoints=function(T){for(var g=T[1]-T[0],C=[T[0]-g/2],v=1;v<T.length;v++)C.push((T[v]+T[v-1])/2);return C.push(T[T.length-1]+g/2),C},m.prototype.findLineage=function(T){var g=[T];do{g.push(T=T.parent)}while(T!==this.root);return g.reverse()},m.prototype.findAncestorPathBetween=function(T,g){for(var C=this.findLineage(T),v=this.findLineage(g),P=0;C[P]===v[P];)P++;return{commonAncestor:C[P-1],lineages:C.slice(P).concat(v.slice(P))}},m.prototype.siblingObstacles=function(T,g){var C=this,v=this.findAncestorPathBetween(T,g),P={};v.lineages.forEach(function(x){return P[x.id]={}});var _=v.commonAncestor.children.filter(function(x){return!(x in P)});return v.lineages.filter(function(x){return x.parent!==v.commonAncestor}).forEach(function(x){return _=_.concat(x.parent.children.filter(function(B){return B!==x.id}))}),_.map(function(x){return C.nodes[x]})},m.getSegmentSets=function(T,g,C){for(var v=[],P=0;P<T.length;P++)for(var _=T[P],x=0;x<_.length;x++)(B=_[x]).edgeid=P,B.i=x,Math.abs(B[1][g]-B[0][g])<.1&&v.push(B);v.sort(function(se,ge){return se[0][g]-ge[0][g]});for(var K=[],V=null,ne=0;ne<v.length;ne++){var B=v[ne];(!V||Math.abs(B[0][g]-V.pos)>.1)&&K.push(V={pos:B[0][g],segments:[]}),V.segments.push(B)}return K},m.nudgeSegs=function(T,g,C,v,P,_){var x=v.length;if(!(x<=1)){for(var B=v.map(function(j){return new S.Variable(j[0][T])}),H=[],K=0;K<x;K++)for(var V=0;V<x;V++)if(K!==V){var ne=v[K],ge=ne.edgeid,ce=v[V].edgeid,me=-1,Q=-1;"x"==T?P(ge,ce)&&(ne[0][g]<ne[1][g]?(me=V,Q=K):(me=K,Q=V)):P(ge,ce)&&(ne[0][g]<ne[1][g]?(me=K,Q=V):(me=V,Q=K)),me>=0&&H.push(new S.Constraint(B[me],B[Q],_))}new S.Solver(B,H).solve(),B.forEach(function(j,$){var J=v[$],ae=j.position();J[0][T]=J[1][T]=ae;var Ee=C[J.edgeid];J.i>0&&(Ee[J.i-1][1][T]=ae),J.i<Ee.length-1&&(Ee[J.i+1][0][T]=ae)})}},m.nudgeSegments=function(T,g,C,v,P){for(var _=m.getSegmentSets(T,g,C),x=0;x<_.length;x++){for(var B=_[x],H=[],K=0;K<B.segments.length;K++){var V=B.segments[K];H.push({type:0,s:V,pos:Math.min(V[0][C],V[1][C])}),H.push({type:1,s:V,pos:Math.max(V[0][C],V[1][C])})}H.sort(function(ge,ce){return ge.pos-ce.pos+ge.type-ce.type});var ne=[],se=0;H.forEach(function(ge){0===ge.type?(ne.push(ge.s),se++):se--,0==se&&(m.nudgeSegs(g,C,T,ne,v,P),ne=[])})}},m.prototype.routeEdges=function(T,g,C,v){var P=this,_=T.map(function(H){return P.route(C(H),v(H))}),x=m.orderEdges(_),B=_.map(function(H){return m.makeSegments(H)});return m.nudgeSegments(B,"x","y",x,g),m.nudgeSegments(B,"y","x",x,g),m.unreverseEdges(B,_),B},m.unreverseEdges=function(T,g){T.forEach(function(C,v){g[v].reversed&&(C.reverse(),C.forEach(function(_){_.reverse()}))})},m.angleBetween2Lines=function(T,g){var C=Math.atan2(T[0].y-T[1].y,T[0].x-T[1].x),v=Math.atan2(g[0].y-g[1].y,g[0].x-g[1].x),P=C-v;return(P>Math.PI||P<-Math.PI)&&(P=v-C),P},m.isLeft=function(T,g,C){return(g.x-T.x)*(C.y-T.y)-(g.y-T.y)*(C.x-T.x)<=0},m.getOrder=function(T){for(var g={},C=0;C<T.length;C++){var v=T[C];void 0===g[v.l]&&(g[v.l]={}),g[v.l][v.r]=!0}return function(P,_){return void 0!==g[P]&&g[P][_]}},m.orderEdges=function(T){for(var g=[],C=0;C<T.length-1;C++)for(var v=C+1;v<T.length;v++){var B,H,K,P=T[C],_=T[v],x=new f(P,_);if(0!==x.length){if(x.reversed&&(_.reverse(),_.reversed=!0,x=new f(P,_)),(x.si<=0||x.ti<=0)&&(x.si+x.length>=P.length||x.ti+x.length>=_.length)){g.push({l:C,r:v});continue}x.si+x.length>=P.length||x.ti+x.length>=_.length?(B=P[x.si+1],K=P[x.si-1],H=_[x.ti-1]):(B=P[x.si+x.length-2],H=P[x.si+x.length],K=_[x.ti+x.length]),m.isLeft(B,H,K)?g.push({l:v,r:C}):g.push({l:C,r:v})}}return m.getOrder(g)},m.makeSegments=function(T){function g(H){return{x:H.x,y:H.y}}for(var v=[],P=g(T[0]),_=1;_<T.length;_++){var x=g(T[_]),B=_<T.length-1?T[_+1]:null;(!B||(H=P,K=x,V=B,!(Math.abs((K.x-H.x)*(V.y-H.y)-(K.y-H.y)*(V.x-H.x))<.001)))&&(v.push([P,x]),P=x)}var H,K,V;return v},m.prototype.route=function(T,g){var C=this,v=this.nodes[T],P=this.nodes[g];this.obstacles=this.siblingObstacles(v,P);var _={};this.obstacles.forEach(function(Q){return _[Q.id]=Q}),this.passableEdges=this.edges.filter(function(Q){var te=C.verts[Q.source],j=C.verts[Q.target];return!(te.node&&te.node.id in _||j.node&&j.node.id in _)});for(var x=1;x<v.ports.length;x++)this.passableEdges.push({source:v.ports[0].id,target:v.ports[x].id,length:0});for(x=1;x<P.ports.length;x++)this.passableEdges.push({source:P.ports[0].id,target:P.ports[x].id,length:0});var me=new O.Calculator(this.verts.length,this.passableEdges,function(Q){return Q.source},function(Q){return Q.target},function(Q){return Q.length}).PathFromNodeToNodeWithPrevCost(v.ports[0].id,P.ports[0].id,function(Q,te,j){var $=C.verts[Q],J=C.verts[te],ae=C.verts[j],Ee=Math.abs(ae.x-$.x),re=Math.abs(ae.y-$.y);return $.node===v&&$.node===J.node||J.node===P&&J.node===ae.node?0:Ee>1&&re>1?1e3:0}).reverse().map(function(Q){return C.verts[Q]});return me.push(this.nodes[P.id].ports[0]),me.filter(function(Q,te){return!(te<me.length-1&&me[te+1].node===v&&Q.node===v||te>0&&Q.node===P&&me[te-1].node===P)})},m.getRoutePath=function(T,g,C,v){var x,B,H,Ee,re,P={routepath:"M "+T[0][0].x+" "+T[0][0].y+" ",arrowpath:""};if(T.length>1)for(var _=0;_<T.length;_++){var K=(B=(x=T[_])[1].x)-x[0].x,V=(H=x[1].y)-x[0].y;if(_<T.length-1){Math.abs(K)>0?B-=K/Math.abs(K)*g:H-=V/Math.abs(V)*g,P.routepath+="L "+B+" "+H+" ";var ne=T[_+1],se=ne[0].x,ge=ne[0].y;K=ne[1].x-se,V=ne[1].y-ge;var te,j,Q=m.angleBetween2Lines(x,ne)<0?1:0;Math.abs(K)>0?(te=se+K/Math.abs(K)*g,j=ge):(te=se,j=ge+V/Math.abs(V)*g);var $=Math.abs(te-B),J=Math.abs(j-H);P.routepath+="A "+$+" "+J+" 0 0 "+Q+" "+te+" "+j+" "}else{var ae=[B,H];Math.abs(K)>0?(Ee=[B-=K/Math.abs(K)*v,H+C],re=[B,H-C]):(Ee=[B+C,H-=V/Math.abs(V)*v],re=[B-C,H]),P.routepath+="L "+B+" "+H+" ",v>0&&(P.arrowpath="M "+ae[0]+" "+ae[1]+" L "+Ee[0]+" "+Ee[1]+" L "+re[0]+" "+re[1])}}else K=(B=(x=T[0])[1].x)-x[0].x,V=(H=x[1].y)-x[0].y,ae=[B,H],Math.abs(K)>0?(Ee=[B-=K/Math.abs(K)*v,H+C],re=[B,H-C]):(Ee=[B+C,H-=V/Math.abs(V)*v],re=[B-C,H]),P.routepath+="L "+B+" "+H+" ",v>0&&(P.arrowpath="M "+ae[0]+" "+ae[1]+" L "+Ee[0]+" "+Ee[1]+" L "+re[0]+" "+re[1]);return P},m}();D.GridRouter=y},345:(L,D)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var p_GOLDEN_SECTION=(1+Math.sqrt(5))/2;D.applyPacking=function E(O,w,R,_,P,m){void 0===P&&(P=1),void 0===m&&(m=!0);var C=w,v=R,x=(P=void 0!==P?P:1,_=void 0!==_?_:0,0),B=0,H=0,K=0,V=[];function ce(j,$){V=[],x=0,B=0,K=0;for(var J=0;J<j.length;J++)me(j[J],$);return Math.abs(function te(){return x/B}()-P)}function me(j,$){for(var J=void 0,ae=0;ae<V.length;ae++)if(V[ae].space_left>=j.height&&V[ae].x+V[ae].width+j.width+10-$<=1e-4){J=V[ae];break}V.push(j),void 0!==J?(j.x=J.x+J.width+10,j.y=J.bottom,j.space_left=j.height,j.bottom=j.y,J.space_left-=j.height+10,J.bottom+=j.height+10):(j.y=K,K+=j.height+10,j.x=0,j.bottom=j.y,j.space_left=j.height),j.y+j.height-B>-1e-4&&(B=j.y+j.height-0),j.x+j.width-x>-1e-4&&(x=j.x+j.width-0)}0!=O.length&&(function ne(j){j.forEach(function(J){!function $(J){var ae=Number.MAX_VALUE,Ee=Number.MAX_VALUE,re=0,ee=0;J.array.forEach(function(Ae){var De=void 0!==Ae.width?Ae.width:_,Ne=void 0!==Ae.height?Ae.height:_;De/=2,Ne/=2,re=Math.max(Ae.x+De,re),ae=Math.min(Ae.x-De,ae),ee=Math.max(Ae.y+Ne,ee),Ee=Math.min(Ae.y-Ne,Ee)}),J.width=re-ae,J.height=ee-Ee}(J)})}(O),function ge(j,$){var J=Number.POSITIVE_INFINITY,ae=0;j.sort(function(Se,Ie){return Ie.height-Se.height});for(var Ee=je=H=j.reduce(function(Se,Ie){return Se.width<Ie.width?Se.width:Ie.width}),re=ft=function Q(j){var $=0;return j.forEach(function(J){return $+=J.width+10}),$}(j),ee=0,Ae=Number.MAX_VALUE,De=Number.MAX_VALUE,Ne=-1,Le=Number.MAX_VALUE,ke=Number.MAX_VALUE;Le>H||ke>1e-4;){if(1!=Ne){var je=re-(re-Ee)/p_GOLDEN_SECTION;Ae=ce(j,je)}if(0!=Ne){var ft=Ee+(re-Ee)/p_GOLDEN_SECTION;De=ce(j,ft)}if(Le=Math.abs(je-ft),ke=Math.abs(Ae-De),Ae<J&&(J=Ae,ae=je),De<J&&(J=De,ae=ft),Ae>De?(Ee=je,je=ft,Ae=De,Ne=1):(re=ft,ft=je,De=Ae,Ne=0),ee++>100)break}ce(j,ae)}(O),m&&function se(j){j.forEach(function($){var J={x:0,y:0};$.array.forEach(function(re){J.x+=re.x,J.y+=re.y}),J.x/=$.array.length,J.y/=$.array.length;var Ee_x=$.x-(J.x-$.width/2)+C/2-x/2,Ee_y=$.y-(J.y-$.height/2)+v/2-B/2;$.array.forEach(function(re){re.x+=Ee_x,re.y+=Ee_y})})}(O))},D.separateGraphs=function S(O,w){for(var R={},f={},y=[],m=0,T=0;T<w.length;T++){var g=w[T],C=g.source,v=g.target;f[C.index]?f[C.index].push(v):f[C.index]=[v],f[v.index]?f[v.index].push(C):f[v.index]=[C]}for(T=0;T<O.length;T++){var P=O[T];R[P.index]||_(P,!0)}function _(x,B){if(void 0===R[x.index]){B&&(m++,y.push({array:[]})),R[x.index]=m,y[m-1].array.push(x);var H=f[x.index];if(H)for(var K=0;K<H.length;K++)_(H[K],!1)}}return y}},5675:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var m,C,E=p(3900),S=p(8802),O=p(1786),w=p(4068),R=p(3858),f=p(225),y=p(345);function T(C){return void 0!==C.leaves||void 0!==C.groups}(C=m=D.EventType||(D.EventType={}))[C.start=0]="start",C[C.tick=1]="tick",C[C.end=2]="end";var g=function(){function C(){var v=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:C.getSourceIndex,getTargetIndex:C.getTargetIndex,setLength:C.setLinkLength,getType:function(P){return"function"==typeof v._linkType?v._linkType(P):0}}}return C.prototype.on=function(v,P){return this.event||(this.event={}),"string"==typeof v?this.event[m[v]]=P:this.event[v]=P,this},C.prototype.trigger=function(v){this.event&&void 0!==this.event[v.type]&&this.event[v.type](v)},C.prototype.kick=function(){for(;!this.tick(););},C.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:m.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var _,x,v=this._nodes.length;for(this._descent.locks.clear(),x=0;x<v;++x)(_=this._nodes[x]).fixed&&((void 0===_.px||void 0===_.py)&&(_.px=_.x,_.py=_.y),this._descent.locks.add(x,[_.px,_.py]));var H=this._descent.rungeKutta();return 0===H?this._alpha=0:void 0!==this._lastStress&&(this._alpha=H),this._lastStress=H,this.updateNodePositions(),this.trigger({type:m.tick,alpha:this._alpha,stress:this._lastStress}),!1},C.prototype.updateNodePositions=function(){for(var _,v=this._descent.x[0],P=this._descent.x[1],x=this._nodes.length;x--;)(_=this._nodes[x]).x=v[x],_.y=P[x]},C.prototype.nodes=function(v){if(!v){if(0===this._nodes.length&&this._links.length>0){var P=0;this._links.forEach(function(x){P=Math.max(P,x.source,x.target)}),this._nodes=new Array(++P);for(var _=0;_<P;++_)this._nodes[_]={}}return this._nodes}return this._nodes=v,this},C.prototype.groups=function(v){var P=this;return v?(this._groups=v,this._rootGroup={},this._groups.forEach(function(_){void 0===_.padding&&(_.padding=1),void 0!==_.leaves&&_.leaves.forEach(function(x,B){"number"==typeof x&&((_.leaves[B]=P._nodes[x]).parent=_)}),void 0!==_.groups&&_.groups.forEach(function(x,B){"number"==typeof x&&((_.groups[B]=P._groups[x]).parent=_)})}),this._rootGroup.leaves=this._nodes.filter(function(_){return void 0===_.parent}),this._rootGroup.groups=this._groups.filter(function(_){return void 0===_.parent}),this):this._groups},C.prototype.powerGraphGroups=function(v){var P=E.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(P.groups),v(P),this},C.prototype.avoidOverlaps=function(v){return arguments.length?(this._avoidOverlaps=v,this):this._avoidOverlaps},C.prototype.handleDisconnected=function(v){return arguments.length?(this._handleDisconnected=v,this):this._handleDisconnected},C.prototype.flowLayout=function(v,P){return arguments.length||(v="y"),this._directedLinkConstraints={axis:v,getMinSeparation:"number"==typeof P?function(){return P}:P},this},C.prototype.links=function(v){return arguments.length?(this._links=v,this):this._links},C.prototype.constraints=function(v){return arguments.length?(this._constraints=v,this):this._constraints},C.prototype.distanceMatrix=function(v){return arguments.length?(this._distanceMatrix=v,this):this._distanceMatrix},C.prototype.size=function(v){return v?(this._canvasSize=v,this):this._canvasSize},C.prototype.defaultNodeSize=function(v){return v?(this._defaultNodeSize=v,this):this._defaultNodeSize},C.prototype.groupCompactness=function(v){return v?(this._groupCompactness=v,this):this._groupCompactness},C.prototype.linkDistance=function(v){return v?(this._linkDistance="function"==typeof v?v:+v,this._linkLengthCalculator=null,this):this._linkDistance},C.prototype.linkType=function(v){return this._linkType=v,this},C.prototype.convergenceThreshold=function(v){return v?(this._threshold="function"==typeof v?v:+v,this):this._threshold},C.prototype.alpha=function(v){return arguments.length?(v=+v,this._alpha?this._alpha=v>0?v:0:v>0&&(this._running||(this._running=!0,this.trigger({type:m.start,alpha:this._alpha=v}),this.kick())),this):this._alpha},C.prototype.getLinkLength=function(v){return"function"==typeof this._linkDistance?+this._linkDistance(v):this._linkDistance},C.setLinkLength=function(v,P){v.length=P},C.prototype.getLinkType=function(v){return"function"==typeof this._linkType?this._linkType(v):0},C.prototype.symmetricDiffLinkLengths=function(v,P){var _=this;return void 0===P&&(P=1),this.linkDistance(function(x){return v*x.length}),this._linkLengthCalculator=function(){return S.symmetricDiffLinkLengths(_._links,_.linkAccessor,P)},this},C.prototype.jaccardLinkLengths=function(v,P){var _=this;return void 0===P&&(P=1),this.linkDistance(function(x){return v*x.length}),this._linkLengthCalculator=function(){return S.jaccardLinkLengths(_._links,_.linkAccessor,P)},this},C.prototype.start=function(v,P,_,x,B,H){var K=this;void 0===v&&(v=0),void 0===P&&(P=0),void 0===_&&(_=0),void 0===x&&(x=0),void 0===B&&(B=!0),void 0===H&&(H=!0);var ae,se=this.nodes().length,ge=se+2*this._groups.length,me=this._canvasSize[0],Q=this._canvasSize[1],te=new Array(ge),j=new Array(ge),$=null,J=this._avoidOverlaps;this._nodes.forEach(function(Le,ke){Le.index=ke,void 0===Le.x&&(Le.x=me/2,Le.y=Q/2),te[ke]=Le.x,j[ke]=Le.y}),this._linkLengthCalculator&&this._linkLengthCalculator(),this._distanceMatrix?ae=this._distanceMatrix:(ae=new R.Calculator(ge,this._links,C.getSourceIndex,C.getTargetIndex,function(Le){return K.getLinkLength(Le)}).DistanceMatrix(),$=O.Descent.createSquareMatrix(ge,function(){return 2}),this._links.forEach(function(Le){"number"==typeof Le.source&&(Le.source=K._nodes[Le.source]),"number"==typeof Le.target&&(Le.target=K._nodes[Le.target])}),this._links.forEach(function(Le){var ke=C.getSourceIndex(Le),je=C.getTargetIndex(Le);$[ke][je]=$[je][ke]=Le.weight||1}));var Ee=O.Descent.createSquareMatrix(ge,function(Le,ke){return ae[Le][ke]});if(this._rootGroup&&void 0!==this._rootGroup.groups){var V=se;this._groups.forEach(function(ke){(function(ke,je,ft,Se){$[ke][je]=$[je][ke]=ft,Ee[ke][je]=Ee[je][ke]=.1})(V,V+1,K._groupCompactness),te[V]=0,j[V++]=0,te[V]=0,j[V++]=0})}else this._rootGroup={leaves:this._nodes,groups:[]};var ee=this._constraints||[];for(this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,ee=ee.concat(S.generateDirectedEdgeConstraints(se,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new O.Descent([te,j],Ee),this._descent.locks.clear(),V=0;V<se;++V){var Ae=this._nodes[V];Ae.fixed&&(Ae.px=Ae.x,Ae.py=Ae.y,this._descent.locks.add(V,[Ae.x,Ae.y]))}if(this._descent.threshold=this._threshold,this.initialLayout(v,te,j),ee.length>0&&(this._descent.project=new w.Projection(this._nodes,this._groups,this._rootGroup,ee).projectFunctions()),this._descent.run(P),this.separateOverlappingComponents(me,Q,H),this.avoidOverlaps(J),J&&(this._nodes.forEach(function(Le,ke){Le.x=te[ke],Le.y=j[ke]}),this._descent.project=new w.Projection(this._nodes,this._groups,this._rootGroup,ee,!0).projectFunctions(),this._nodes.forEach(function(Le,ke){te[ke]=Le.x,j[ke]=Le.y})),this._descent.G=$,this._descent.run(_),x){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=se,this._descent.scaleSnapByMaxH=se!=ge;var Ne=O.Descent.createSquareMatrix(ge,function(Le,ke){return Le>=se||ke>=se?$[Le][ke]:0});this._descent.G=Ne,this._descent.run(x)}return this.updateNodePositions(),this.separateOverlappingComponents(me,Q,H),B?this.resume():this},C.prototype.initialLayout=function(v,P,_){if(this._groups.length>0&&v>0){var x=this._nodes.length,B=this._links.map(function(K){return{source:K.source.index,target:K.target.index}}),H=this._nodes.map(function(K){return{index:K.index}});this._groups.forEach(function(K,V){H.push({index:K.index=x+V})}),this._groups.forEach(function(K,V){void 0!==K.leaves&&K.leaves.forEach(function(ne){return B.push({source:K.index,target:ne.index})}),void 0!==K.groups&&K.groups.forEach(function(ne){return B.push({source:K.index,target:ne.index})})}),(new C).size(this.size()).nodes(H).links(B).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(v,0,0,0,!1),this._nodes.forEach(function(K){P[K.index]=H[K.index].x,_[K.index]=H[K.index].y})}else this._descent.run(v)},C.prototype.separateOverlappingComponents=function(v,P,_){var x=this;if(void 0===_&&(_=!0),!this._distanceMatrix&&this._handleDisconnected){var B=this._descent.x[0],H=this._descent.x[1];this._nodes.forEach(function(V,ne){V.x=B[ne],V.y=H[ne]});var K=y.separateGraphs(this._nodes,this._links);y.applyPacking(K,v,P,this._defaultNodeSize,1,_),this._nodes.forEach(function(V,ne){x._descent.x[0][ne]=V.x,x._descent.x[1][ne]=V.y,V.bounds&&(V.bounds.setXCentre(V.x),V.bounds.setYCentre(V.y))})}},C.prototype.resume=function(){return this.alpha(.1)},C.prototype.stop=function(){return this.alpha(0)},C.prototype.prepareEdgeRouting=function(v){void 0===v&&(v=0),this._visibilityGraph=new f.TangentVisibilityGraph(this._nodes.map(function(P){return P.bounds.inflate(-v).vertices()}))},C.prototype.routeEdge=function(v,P,_){void 0===P&&(P=5);var x=[],B=new f.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),H={x:v.source.x,y:v.source.y},K={x:v.target.x,y:v.target.y},V=B.addPoint(H,v.source.index),ne=B.addPoint(K,v.target.index);B.addEdgeIfVisible(H,K,v.source.index,v.target.index),void 0!==_&&_(B);var Q=new R.Calculator(B.V.length,B.E,function(Ee){return Ee.source.id},function(Ee){return Ee.target.id},function(Ee){return Ee.length()}).PathFromNodeToNode(V.id,ne.id);if(1===Q.length||Q.length===B.V.length){var te=w.makeEdgeBetween(v.source.innerBounds,v.target.innerBounds,P);x=[te.sourceIntersection,te.arrowStart]}else{for(var j=Q.length-2,$=B.V[Q[j]].p,J=B.V[Q[0]].p,ae=(x=[v.source.innerBounds.rayIntersection($.x,$.y)],j);ae>=0;--ae)x.push(B.V[Q[ae]].p);x.push(w.makeEdgeTo(J,v.target.innerBounds,P))}return x},C.getSourceIndex=function(v){return"number"==typeof v.source?v.source:v.source.index},C.getTargetIndex=function(v){return"number"==typeof v.target?v.target:v.target.index},C.linkId=function(v){return C.getSourceIndex(v)+"-"+C.getTargetIndex(v)},C.dragStart=function(v){T(v)?C.storeOffset(v,C.dragOrigin(v)):(C.stopNode(v),v.fixed|=2)},C.stopNode=function(v){v.px=v.x,v.py=v.y},C.storeOffset=function(v,P){void 0!==v.leaves&&v.leaves.forEach(function(_){_.fixed|=2,C.stopNode(_),_._dragGroupOffsetX=_.x-P.x,_._dragGroupOffsetY=_.y-P.y}),void 0!==v.groups&&v.groups.forEach(function(_){return C.storeOffset(_,P)})},C.dragOrigin=function(v){return T(v)?{x:v.bounds.cx(),y:v.bounds.cy()}:v},C.drag=function(v,P){T(v)?(void 0!==v.leaves&&v.leaves.forEach(function(_){v.bounds.setXCentre(P.x),v.bounds.setYCentre(P.y),_.px=_._dragGroupOffsetX+P.x,_.py=_._dragGroupOffsetY+P.y}),void 0!==v.groups&&v.groups.forEach(function(_){return C.drag(_,P)})):(v.px=P.x,v.py=P.y)},C.dragEnd=function(v){T(v)?(void 0!==v.leaves&&v.leaves.forEach(function(P){C.dragEnd(P),delete P._dragGroupOffsetX,delete P._dragGroupOffsetY}),void 0!==v.groups&&v.groups.forEach(C.dragEnd)):v.fixed&=-7},C.mouseOver=function(v){v.fixed|=4,v.px=v.x,v.py=v.y},C.mouseOut=function(v){v.fixed&=-5},C}();D.Layout=g},6461:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var E=p(3858),S=p(1786),O=p(4068),w=p(8802),R=function(){function T(g,C){this.source=g,this.target=C}return T.prototype.actualLength=function(g){var C=this;return Math.sqrt(g.reduce(function(v,P){var _=P[C.target]-P[C.source];return v+_*_},0))},T}();D.Link3D=R,D.Node3D=function T(g,C,v){void 0===g&&(g=0),void 0===C&&(C=0),void 0===v&&(v=0),this.x=g,this.y=C,this.z=v};var y=function(){function T(g,C,v){var P=this;void 0===v&&(v=1),this.nodes=g,this.links=C,this.idealLinkLength=v,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(T.k);for(var _=0;_<T.k;++_)this.result[_]=new Array(g.length);g.forEach(function(x,B){for(var H=0,K=T.dims;H<K.length;H++){var V=K[H];void 0===x[V]&&(x[V]=Math.random())}P.result[0][B]=x.x,P.result[1][B]=x.y,P.result[2][B]=x.z})}return T.prototype.linkLength=function(g){return g.actualLength(this.result)},T.prototype.start=function(g){var C=this;void 0===g&&(g=100);var v=this.nodes.length,P=new m;this.useJaccardLinkLengths&&w.jaccardLinkLengths(this.links,P,1.5),this.links.forEach(function(V){return V.length*=C.idealLinkLength});var _=new E.Calculator(v,this.links,function(V){return V.source},function(V){return V.target},function(V){return V.length}).DistanceMatrix(),x=S.Descent.createSquareMatrix(v,function(V,ne){return _[V][ne]}),B=S.Descent.createSquareMatrix(v,function(){return 2});this.links.forEach(function(V){var ne=V.source,se=V.target;return B[ne][se]=B[se][ne]=1}),this.descent=new S.Descent(this.result,x),this.descent.threshold=.001,this.descent.G=B,this.constraints&&(this.descent.project=new O.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var H=0;H<this.nodes.length;H++){var K=this.nodes[H];K.fixed&&this.descent.locks.add(H,[K.x,K.y,K.z])}return this.descent.run(g),this},T.prototype.tick=function(){this.descent.locks.clear();for(var g=0;g<this.nodes.length;g++){var C=this.nodes[g];C.fixed&&this.descent.locks.add(g,[C.x,C.y,C.z])}return this.descent.rungeKutta()},T.k=(T.dims=["x","y","z"]).length,T}();D.Layout3D=y;var m=function(){function T(){}return T.prototype.getSourceIndex=function(g){return g.source},T.prototype.getTargetIndex=function(g){return g.target},T.prototype.getLength=function(g){return g.length},T.prototype.setLength=function(g,C){g.length=C},T}()},8802:(L,D)=>{"use strict";function p(m,T){var g={};for(var C in m)g[C]={};for(var C in T)g[C]={};return Object.keys(g).length}function E(m,T){var g=0;for(var C in m)void 0!==T[C]&&++g;return g}function O(m,T,g,C){var v=function S(m,T){var g={},C=function(v,P){void 0===g[v]&&(g[v]={}),g[v][P]={}};return m.forEach(function(v){var P=T.getSourceIndex(v),_=T.getTargetIndex(v);C(P,_),C(_,P)}),g}(m,C);m.forEach(function(P){var _=v[C.getSourceIndex(P)],x=v[C.getTargetIndex(P)];C.setLength(P,1+T*g(_,x))})}function y(m,T,g){var C=[],v=0,P=[],_=[];function x(Q){Q.index=Q.lowlink=v++,P.push(Q),Q.onStack=!0;for(var te=0,j=Q.out;te<j.length;te++){var $=j[te];void 0===$.index?(x($),Q.lowlink=Math.min(Q.lowlink,$.lowlink)):$.onStack&&(Q.lowlink=Math.min(Q.lowlink,$.index))}if(Q.lowlink===Q.index){for(var J=[];P.length&&(($=P.pop()).onStack=!1,J.push($),$!==Q););_.push(J.map(function(ae){return ae.id}))}}for(var B=0;B<m;B++)C.push({id:B,out:[]});for(var H=0,K=T;H<K.length;H++){var V=K[H],ne=C[g.getSourceIndex(V)],se=C[g.getTargetIndex(V)];ne.out.push(se)}for(var ge=0,ce=C;ge<ce.length;ge++){var me=ce[ge];void 0===me.index&&x(me)}return _}Object.defineProperty(D,"__esModule",{value:!0}),D.symmetricDiffLinkLengths=function w(m,T,g){void 0===g&&(g=1),O(m,g,function(C,v){return Math.sqrt(p(C,v)-E(C,v))},T)},D.jaccardLinkLengths=function R(m,T,g){void 0===g&&(g=1),O(m,g,function(C,v){return Math.min(Object.keys(C).length,Object.keys(v).length)<1.1?0:E(C,v)/p(C,v)},T)},D.generateDirectedEdgeConstraints=function f(m,T,g,C){var v=y(m,T,C),P={};v.forEach(function(x,B){return x.forEach(function(H){return P[H]=B})});var _=[];return T.forEach(function(x){var B=C.getSourceIndex(x),H=C.getTargetIndex(x);P[B]!==P[H]&&_.push({axis:g,left:B,right:H,gap:C.getMinSeparation(x)})}),_},D.stronglyConnectedComponents=y},3900:(L,D)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var p=function T(g,C,v){this.source=g,this.target=C,this.type=v};D.PowerEdge=p;var E=function(){function T(g,C,v,P){var _=this;if(this.linkAccessor=v,this.modules=new Array(g),this.roots=[],P)this.initModulesFromGroup(P);else{this.roots.push(new R);for(var x=0;x<g;++x)this.roots[0].add(this.modules[x]=new O(x))}this.R=C.length,C.forEach(function(B){var H=_.modules[v.getSourceIndex(B)],K=_.modules[v.getTargetIndex(B)],V=v.getType(B);H.outgoing.add(V,K),K.incoming.add(V,H)})}return T.prototype.initModulesFromGroup=function(g){var C=new R;this.roots.push(C);for(var v=0;v<g.leaves.length;++v){var P=g.leaves[v],_=new O(P.id);this.modules[P.id]=_,C.add(_)}if(g.groups)for(var x=0;x<g.groups.length;++x){var B=g.groups[x],H={};for(var K in B)"leaves"!==K&&"groups"!==K&&B.hasOwnProperty(K)&&(H[K]=B[K]);C.add(new O(-1-x,new f,new f,this.initModulesFromGroup(B),H))}return C},T.prototype.merge=function(g,C,v){void 0===v&&(v=0);var P=g.incoming.intersection(C.incoming),_=g.outgoing.intersection(C.outgoing),x=new R;x.add(g),x.add(C);var B=new O(this.modules.length,_,P,x);this.modules.push(B);var H=function(K,V,ne){K.forAll(function(se,ge){se.forAll(function(ce){var me=ce[V];me.add(ge,B),me.remove(ge,g),me.remove(ge,C),g[ne].remove(ge,ce),C[ne].remove(ge,ce)})})};return H(_,"incoming","outgoing"),H(P,"outgoing","incoming"),this.R-=P.count()+_.count(),this.roots[v].remove(g),this.roots[v].remove(C),this.roots[v].add(B),B},T.prototype.rootMerges=function(g){void 0===g&&(g=0);for(var C=this.roots[g].modules(),v=C.length,P=new Array(v*(v-1)),_=0,x=0,B=v-1;x<B;++x)for(var H=x+1;H<v;++H){var K=C[x],V=C[H];P[_]={id:_,nEdges:this.nEdges(K,V),a:K,b:V},_++}return P},T.prototype.greedyMerge=function(){for(var g=0;g<this.roots.length;++g)if(!(this.roots[g].modules().length<2)){var v=this.rootMerges(g).sort(function(P,_){return P.nEdges==_.nEdges?P.id-_.id:P.nEdges-_.nEdges})[0];if(!(v.nEdges>=this.R))return this.merge(v.a,v.b,g),!0}},T.prototype.nEdges=function(g,C){var v=g.incoming.intersection(C.incoming),P=g.outgoing.intersection(C.outgoing);return this.R-v.count()-P.count()},T.prototype.getGroupHierarchy=function(g){var C=this,v=[];return S(this.roots[0],{},v),this.allEdges().forEach(function(x){var B=C.modules[x.source],H=C.modules[x.target];g.push(new p(void 0===B.gid?x.source:v[B.gid],void 0===H.gid?x.target:v[H.gid],x.type))}),v},T.prototype.allEdges=function(){var g=[];return T.getEdges(this.roots[0],g),g},T.getEdges=function(g,C){g.forAll(function(v){v.getEdges(C),T.getEdges(v.children,C)})},T}();function S(T,g,C){T.forAll(function(v){if(v.isLeaf())g.leaves||(g.leaves=[]),g.leaves.push(v.id);else{var P=g;if(v.gid=C.length,!v.isIsland()||v.isPredefined()){if(P={id:v.gid},v.isPredefined())for(var _ in v.definition)P[_]=v.definition[_];g.groups||(g.groups=[]),g.groups.push(v.gid),C.push(P)}S(v.children,P,C)}})}D.Configuration=E;var O=function(){function T(g,C,v,P,_){void 0===C&&(C=new f),void 0===v&&(v=new f),void 0===P&&(P=new R),this.id=g,this.outgoing=C,this.incoming=v,this.children=P,this.definition=_}return T.prototype.getEdges=function(g){var C=this;this.outgoing.forAll(function(v,P){v.forAll(function(_){g.push(new p(C.id,_.id,P))})})},T.prototype.isLeaf=function(){return 0===this.children.count()},T.prototype.isIsland=function(){return 0===this.outgoing.count()&&0===this.incoming.count()},T.prototype.isPredefined=function(){return void 0!==this.definition},T}();D.Module=O;var R=function(){function T(){this.table={}}return T.prototype.count=function(){return Object.keys(this.table).length},T.prototype.intersection=function(g){var C=new T;return C.table=function w(T,g){var C={};for(var v in T)v in g&&(C[v]=T[v]);return C}(this.table,g.table),C},T.prototype.intersectionCount=function(g){return this.intersection(g).count()},T.prototype.contains=function(g){return g in this.table},T.prototype.add=function(g){this.table[g.id]=g},T.prototype.remove=function(g){delete this.table[g.id]},T.prototype.forAll=function(g){for(var C in this.table)g(this.table[C])},T.prototype.modules=function(){var g=[];return this.forAll(function(C){C.isPredefined()||g.push(C)}),g},T}();D.ModuleSet=R;var f=function(){function T(){this.sets={},this.n=0}return T.prototype.count=function(){return this.n},T.prototype.contains=function(g){var C=!1;return this.forAllModules(function(v){!C&&v.id==g&&(C=!0)}),C},T.prototype.add=function(g,C){(g in this.sets?this.sets[g]:this.sets[g]=new R).add(C),++this.n},T.prototype.remove=function(g,C){var v=this.sets[g];v.remove(C),0===v.count()&&delete this.sets[g],--this.n},T.prototype.forAll=function(g){for(var C in this.sets)g(this.sets[C],Number(C))},T.prototype.forAllModules=function(g){this.forAll(function(C,v){return C.forAll(g)})},T.prototype.intersection=function(g){var C=new T;return this.forAll(function(v,P){if(P in g.sets){var _=v.intersection(g.sets[P]),x=_.count();x>0&&(C.sets[P]=_,C.n+=x)}}),C},T}();D.LinkSets=f,D.getGroups=function m(T,g,C,v){for(var _=new E(T.length,g,C,v);_.greedyMerge(););var x=[],B=_.getGroupHierarchy(x);return x.forEach(function(H){var K=function(V){var ne=H[V];"number"==typeof ne&&(H[V]=T[ne])};K("source"),K("target")}),{groups:B,powerEdges:x}}},8866:(L,D)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var p=function(){function S(O){this.elem=O,this.subheaps=[]}return S.prototype.toString=function(O){for(var w="",R=!1,f=0;f<this.subheaps.length;++f){var y=this.subheaps[f];y.elem?(R&&(w+=","),w+=y.toString(O),R=!0):R=!1}return""!==w&&(w="("+w+")"),(this.elem?O(this.elem):"")+w},S.prototype.forEach=function(O){this.empty()||(O(this.elem,this),this.subheaps.forEach(function(w){return w.forEach(O)}))},S.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce(function(O,w){return O+w.count()},0)},S.prototype.min=function(){return this.elem},S.prototype.empty=function(){return null==this.elem},S.prototype.contains=function(O){if(this===O)return!0;for(var w=0;w<this.subheaps.length;w++)if(this.subheaps[w].contains(O))return!0;return!1},S.prototype.isHeap=function(O){var w=this;return this.subheaps.every(function(R){return O(w.elem,R.elem)&&R.isHeap(O)})},S.prototype.insert=function(O,w){return this.merge(new S(O),w)},S.prototype.merge=function(O,w){return this.empty()?O:O.empty()?this:w(this.elem,O.elem)?(this.subheaps.push(O),this):(O.subheaps.push(this),O)},S.prototype.removeMin=function(O){return this.empty()?null:this.mergePairs(O)},S.prototype.mergePairs=function(O){if(0==this.subheaps.length)return new S(null);if(1==this.subheaps.length)return this.subheaps[0];var w=this.subheaps.pop().merge(this.subheaps.pop(),O),R=this.mergePairs(O);return w.merge(R,O)},S.prototype.decreaseKey=function(O,w,R,f){var y=O.removeMin(f);O.elem=y.elem,O.subheaps=y.subheaps,null!==R&&null!==y.elem&&R(O.elem,O);var m=new S(w);return null!==R&&R(w,m),this.merge(m,f)},S}();D.PairingHeap=p;var E=function(){function S(O){this.lessThan=O}return S.prototype.top=function(){return this.empty()?null:this.root.elem},S.prototype.push=function(){for(var O=[],w=0;w<arguments.length;w++)O[w]=arguments[w];for(var R,y,f=0;y=O[f];++f)R=new p(y),this.root=this.empty()?R:this.root.merge(R,this.lessThan);return R},S.prototype.empty=function(){return!this.root||!this.root.elem},S.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},S.prototype.forEach=function(O){this.root.forEach(O)},S.prototype.pop=function(){if(this.empty())return null;var O=this.root.min();return this.root=this.root.removeMin(this.lessThan),O},S.prototype.reduceKey=function(O,w,R){void 0===R&&(R=null),this.root=this.root.decreaseKey(O,w,R,this.lessThan)},S.prototype.toString=function(O){return this.root.toString(O)},S.prototype.count=function(){return this.root.count()},S}();D.PriorityQueue=E},4655:function(L,D){"use strict";var R,p=this&&this.__extends||(R=function(f,y){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,T){m.__proto__=T}||function(m,T){for(var g in T)T.hasOwnProperty(g)&&(m[g]=T[g])})(f,y)},function(f,y){function m(){this.constructor=f}R(f,y),f.prototype=null===y?Object.create(y):(m.prototype=y.prototype,new m)});Object.defineProperty(D,"__esModule",{value:!0});var E=function(){function R(){this.findIter=function(f){for(var y=this._root,m=this.iterator();null!==y;){var T=this._comparator(f,y.data);if(0===T)return m._cursor=y,m;m._ancestors.push(y),y=y.get_child(T>0)}return null}}return R.prototype.clear=function(){this._root=null,this.size=0},R.prototype.find=function(f){for(var y=this._root;null!==y;){var m=this._comparator(f,y.data);if(0===m)return y.data;y=y.get_child(m>0)}return null},R.prototype.lowerBound=function(f){return this._bound(f,this._comparator)},R.prototype.upperBound=function(f){var y=this._comparator;return this._bound(f,function m(T,g){return y(g,T)})},R.prototype.min=function(){var f=this._root;if(null===f)return null;for(;null!==f.left;)f=f.left;return f.data},R.prototype.max=function(){var f=this._root;if(null===f)return null;for(;null!==f.right;)f=f.right;return f.data},R.prototype.iterator=function(){return new S(this)},R.prototype.each=function(f){for(var m,y=this.iterator();null!==(m=y.next());)f(m)},R.prototype.reach=function(f){for(var m,y=this.iterator();null!==(m=y.prev());)f(m)},R.prototype._bound=function(f,y){for(var m=this._root,T=this.iterator();null!==m;){var g=this._comparator(f,m.data);if(0===g)return T._cursor=m,T;T._ancestors.push(m),m=m.get_child(g>0)}for(var C=T._ancestors.length-1;C>=0;--C)if(y(f,(m=T._ancestors[C]).data)>0)return T._cursor=m,T._ancestors.length=C,T;return T._ancestors.length=0,T},R}();D.TreeBase=E;var S=function(){function R(f){this._tree=f,this._ancestors=[],this._cursor=null}return R.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},R.prototype.next=function(){if(null===this._cursor){var f=this._tree._root;null!==f&&this._minNode(f)}else if(null===this._cursor.right){var y;do{if(y=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===y)}else this._ancestors.push(this._cursor),this._minNode(this._cursor.right);return null!==this._cursor?this._cursor.data:null},R.prototype.prev=function(){if(null===this._cursor){var f=this._tree._root;null!==f&&this._maxNode(f)}else if(null===this._cursor.left){var y;do{if(y=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===y)}else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left);return null!==this._cursor?this._cursor.data:null},R.prototype._minNode=function(f){for(;null!==f.left;)this._ancestors.push(f),f=f.left;this._cursor=f},R.prototype._maxNode=function(f){for(;null!==f.right;)this._ancestors.push(f),f=f.right;this._cursor=f},R}();D.Iterator=S;var O=function(){function R(f){this.data=f,this.left=null,this.right=null,this.red=!0}return R.prototype.get_child=function(f){return f?this.right:this.left},R.prototype.set_child=function(f,y){f?this.right=y:this.left=y},R}(),w=function(R){function f(y){var m=R.call(this)||this;return m._root=null,m._comparator=y,m.size=0,m}return p(f,R),f.prototype.insert=function(y){var m=!1;if(null===this._root)this._root=new O(y),m=!0,this.size++;else{var T=new O(void 0),g=!1,C=!1,v=null,P=T,_=null,x=this._root;for(P.right=this._root;;){if(null===x?(x=new O(y),_.set_child(g,x),m=!0,this.size++):f.is_red(x.left)&&f.is_red(x.right)&&(x.red=!0,x.left.red=!1,x.right.red=!1),f.is_red(x)&&f.is_red(_)){var B=P.right===v;x===_.get_child(C)?P.set_child(B,f.single_rotate(v,!C)):P.set_child(B,f.double_rotate(v,!C))}var H=this._comparator(x.data,y);if(0===H)break;C=g,null!==v&&(P=v),v=_,_=x,x=x.get_child(g=H<0)}this._root=T.right}return this._root.red=!1,m},f.prototype.remove=function(y){if(null===this._root)return!1;var m=new O(void 0),T=m;T.right=this._root;for(var g=null,C=null,v=null,P=!0;null!==T.get_child(P);){var _=P;C=g,g=T,T=T.get_child(P);var x=this._comparator(y,T.data);if(P=x>0,0===x&&(v=T),!f.is_red(T)&&!f.is_red(T.get_child(P)))if(f.is_red(T.get_child(!P))){var B=f.single_rotate(T,P);g.set_child(_,B),g=B}else if(!f.is_red(T.get_child(!P))){var H=g.get_child(!_);if(null!==H)if(f.is_red(H.get_child(!_))||f.is_red(H.get_child(_))){var K=C.right===g;f.is_red(H.get_child(_))?C.set_child(K,f.double_rotate(g,_)):f.is_red(H.get_child(!_))&&C.set_child(K,f.single_rotate(g,_));var V=C.get_child(K);V.red=!0,T.red=!0,V.left.red=!1,V.right.red=!1}else g.red=!1,H.red=!0,T.red=!0}}return null!==v&&(v.data=T.data,g.set_child(g.right===T,T.get_child(null===T.left)),this.size--),this._root=m.right,null!==this._root&&(this._root.red=!1),null!==v},f.is_red=function(y){return null!==y&&y.red},f.single_rotate=function(y,m){var T=y.get_child(!m);return y.set_child(!m,T.get_child(m)),T.set_child(m,y),y.red=!0,T.red=!1,T},f.double_rotate=function(y,m){return y.set_child(!m,f.single_rotate(y.get_child(!m),!m)),f.single_rotate(y,m)},f}(E);D.RBTree=w},4068:function(L,D,p){"use strict";var Q,E=this&&this.__extends||(Q=function(te,j){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($,J){$.__proto__=J}||function($,J){for(var ae in J)J.hasOwnProperty(ae)&&($[ae]=J[ae])})(te,j)},function(te,j){function $(){this.constructor=te}Q(te,j),te.prototype=null===j?Object.create(j):($.prototype=j.prototype,new $)});Object.defineProperty(D,"__esModule",{value:!0});var S=p(8237),O=p(4655);function w(Q){return Q.bounds=void 0!==Q.leaves?Q.leaves.reduce(function(te,j){return j.bounds.union(te)},R.empty()):R.empty(),void 0!==Q.groups&&(Q.bounds=Q.groups.reduce(function(te,j){return w(j).union(te)},Q.bounds)),Q.bounds=Q.bounds.inflate(Q.padding),Q.bounds}D.computeGroupBounds=w;var R=function(){function Q(te,j,$,J){this.x=te,this.X=j,this.y=$,this.Y=J}return Q.empty=function(){return new Q(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},Q.prototype.cx=function(){return(this.x+this.X)/2},Q.prototype.cy=function(){return(this.y+this.Y)/2},Q.prototype.overlapX=function(te){var j=this.cx(),$=te.cx();return j<=$&&te.x<this.X?this.X-te.x:$<=j&&this.x<te.X?te.X-this.x:0},Q.prototype.overlapY=function(te){var j=this.cy(),$=te.cy();return j<=$&&te.y<this.Y?this.Y-te.y:$<=j&&this.y<te.Y?te.Y-this.y:0},Q.prototype.setXCentre=function(te){var j=te-this.cx();this.x+=j,this.X+=j},Q.prototype.setYCentre=function(te){var j=te-this.cy();this.y+=j,this.Y+=j},Q.prototype.width=function(){return this.X-this.x},Q.prototype.height=function(){return this.Y-this.y},Q.prototype.union=function(te){return new Q(Math.min(this.x,te.x),Math.max(this.X,te.X),Math.min(this.y,te.y),Math.max(this.Y,te.Y))},Q.prototype.lineIntersections=function(te,j,$,J){for(var ae=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],Ee=[],re=0;re<4;++re){var ee=Q.lineIntersection(te,j,$,J,ae[re][0],ae[re][1],ae[re][2],ae[re][3]);null!==ee&&Ee.push({x:ee.x,y:ee.y})}return Ee},Q.prototype.rayIntersection=function(te,j){var $=this.lineIntersections(this.cx(),this.cy(),te,j);return $.length>0?$[0]:null},Q.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},Q.lineIntersection=function(te,j,$,J,ae,Ee,re,ee){var Ae=$-te,De=re-ae,Ne=J-j,Le=ee-Ee,ke=Le*Ae-De*Ne;if(0==ke)return null;var je=te-ae,ft=j-Ee,Ie=(De*ft-Le*je)/ke,Oe=(Ae*ft-Ne*je)/ke;return Ie>=0&&Ie<=1&&Oe>=0&&Oe<=1?{x:te+Ie*Ae,y:j+Ie*Ne}:null},Q.prototype.inflate=function(te){return new Q(this.x-te,this.X+te,this.y-te,this.Y+te)},Q}();D.Rectangle=R,D.makeEdgeBetween=function f(Q,te,j){var $=Q.rayIntersection(te.cx(),te.cy())||{x:Q.cx(),y:Q.cy()},J=te.rayIntersection(Q.cx(),Q.cy())||{x:te.cx(),y:te.cy()},ae=J.x-$.x,Ee=J.y-$.y,re=Math.sqrt(ae*ae+Ee*Ee),ee=re-j;return{sourceIntersection:$,targetIntersection:J,arrowStart:{x:$.x+ee*ae/re,y:$.y+ee*Ee/re}}},D.makeEdgeTo=function y(Q,te,j){var $=te.rayIntersection(Q.x,Q.y);$||($={x:te.cx(),y:te.cy()});var J=$.x-Q.x,ae=$.y-Q.y,Ee=Math.sqrt(J*J+ae*ae);return{x:$.x-j*J/Ee,y:$.y-j*ae/Ee}};var m=function Q(te,j,$){this.v=te,this.r=j,this.pos=$,this.prev=C(),this.next=C()},T=function Q(te,j,$){this.isOpen=te,this.v=j,this.pos=$};function g(Q,te){return Q.pos>te.pos?1:Q.pos<te.pos||Q.isOpen?-1:te.isOpen?1:0}function C(){return new O.RBTree(function(Q,te){return Q.pos-te.pos})}var v={getCentre:function(Q){return Q.cx()},getOpen:function(Q){return Q.y},getClose:function(Q){return Q.Y},getSize:function(Q){return Q.width()},makeRect:function(Q,te,j,$){return new R(j-$/2,j+$/2,Q,te)},findNeighbours:function B(Q,te){var j=function($,J){for(var Ee,ae=te.findIter(Q);null!==(Ee=ae[$]());){var re=Ee.r.overlapX(Q.r);if((re<=0||re<=Ee.r.overlapY(Q.r))&&(Q[$].insert(Ee),Ee[J].insert(Q)),re<=0)break}};j("next","prev"),j("prev","next")}},P={getCentre:function(Q){return Q.cy()},getOpen:function(Q){return Q.x},getClose:function(Q){return Q.X},getSize:function(Q){return Q.height()},makeRect:function(Q,te,j,$){return new R(Q,te,j-$/2,j+$/2)},findNeighbours:function H(Q,te){var j=function($,J){var ae=te.findIter(Q)[$]();null!==ae&&ae.r.overlapX(Q.r)>0&&(Q[$].insert(ae),ae[J].insert(Q))};j("next","prev"),j("prev","next")}};function _(Q,te,j,$){void 0===$&&($=!1);var J=Q.padding,ae=void 0!==Q.groups?Q.groups.length:0,Ee=void 0!==Q.leaves?Q.leaves.length:0,re=ae?Q.groups.reduce(function(et,mt){return et.concat(_(mt,te,j,!0))},[]):[],ee=($?2:0)+Ee+ae,Ae=new Array(ee),De=new Array(ee),Ne=0,Le=function(et,mt){De[Ne]=et,Ae[Ne++]=mt};if($){var ke=Q.bounds,je=te.getCentre(ke),ft=te.getSize(ke)/2,Se=te.getOpen(ke),Ie=te.getClose(ke),_e=je-ft+J/2,Oe=je+ft-J/2;Q.minVar.desiredPosition=_e,Le(te.makeRect(Se,Ie,_e,J),Q.minVar),Q.maxVar.desiredPosition=Oe,Le(te.makeRect(Se,Ie,Oe,J),Q.maxVar)}Ee&&Q.leaves.forEach(function(et){return Le(et.bounds,et.variable)}),ae&&Q.groups.forEach(function(et){var mt=et.bounds;Le(te.makeRect(te.getOpen(mt),te.getClose(mt),te.getCentre(mt),te.getSize(mt)),et.minVar)});var Ye=x(De,Ae,te,j);return ae&&(Ae.forEach(function(et){et.cOut=[],et.cIn=[]}),Ye.forEach(function(et){et.left.cOut.push(et),et.right.cIn.push(et)}),Q.groups.forEach(function(et){var mt=(et.padding-te.getSize(et.bounds))/2;et.minVar.cIn.forEach(function(kt){return kt.gap+=mt}),et.minVar.cOut.forEach(function(kt){kt.left=et.maxVar,kt.gap+=mt})})),re.concat(Ye)}function x(Q,te,j,$){var J,ae=Q.length,Ee=2*ae;console.assert(te.length>=ae);var re=new Array(Ee);for(J=0;J<ae;++J){var ee=Q[J],Ae=new m(te[J],ee,j.getCentre(ee));re[J]=new T(!0,Ae,j.getOpen(ee)),re[J+ae]=new T(!1,Ae,j.getClose(ee))}re.sort(g);var De=new Array,Ne=C();for(J=0;J<Ee;++J){var Le=re[J];if(Ae=Le.v,Le.isOpen)Ne.insert(Ae),j.findNeighbours(Ae,Ne);else{Ne.remove(Ae);var ke=function(Se,Ie){var _e=(j.getSize(Se.r)+j.getSize(Ie.r))/2+$;De.push(new S.Constraint(Se.v,Ie.v,_e))},je=function(Se,Ie,_e){for(var Oe,Ye=Ae[Se].iterator();null!==(Oe=Ye[Se]());)_e(Oe,Ae),Oe[Ie].remove(Ae)};je("prev","next",function(Se,Ie){return ke(Se,Ie)}),je("next","prev",function(Se,Ie){return ke(Ie,Se)})}}return console.assert(0===Ne.size),De}function K(Q,te){return x(Q,te,v,1e-6)}function V(Q,te){return x(Q,te,P,1e-6)}function ne(Q){return _(Q,v,1e-6)}function se(Q){return _(Q,P,1e-6)}D.generateXConstraints=K,D.generateYConstraints=V,D.generateXGroupConstraints=ne,D.generateYGroupConstraints=se,D.removeOverlaps=function ge(Q){var te=Q.map(function(J){return new S.Variable(J.cx())}),j=K(Q,te),$=new S.Solver(te,j);$.solve(),te.forEach(function(J,ae){return Q[ae].setXCentre(J.position())}),te=Q.map(function(J){return new S.Variable(J.cy())}),j=V(Q,te),($=new S.Solver(te,j)).solve(),te.forEach(function(J,ae){return Q[ae].setYCentre(J.position())})};var ce=function(Q){function te(j,$){var J=Q.call(this,0,$)||this;return J.index=j,J}return E(te,Q),te}(S.Variable);D.IndexedVariable=ce;var me=function(){function Q(te,j,$,J,ae){var Ee=this;if(void 0===$&&($=null),void 0===J&&(J=null),void 0===ae&&(ae=!1),this.nodes=te,this.groups=j,this.rootGroup=$,this.avoidOverlaps=ae,this.variables=te.map(function(ee,Ae){return ee.variable=new ce(Ae,1)}),J&&this.createConstraints(J),ae&&$&&void 0!==$.groups){te.forEach(function(ee){if(ee.width&&ee.height){var Ae=ee.width/2,De=ee.height/2;ee.bounds=new R(ee.x-Ae,ee.x+Ae,ee.y-De,ee.y+De)}else ee.bounds=new R(ee.x,ee.x,ee.y,ee.y)}),w($);var re=te.length;j.forEach(function(ee){Ee.variables[re]=ee.minVar=new ce(re++,void 0!==ee.stiffness?ee.stiffness:.01),Ee.variables[re]=ee.maxVar=new ce(re++,void 0!==ee.stiffness?ee.stiffness:.01)})}}return Q.prototype.createSeparation=function(te){return new S.Constraint(this.nodes[te.left].variable,this.nodes[te.right].variable,te.gap,void 0!==te.equality&&te.equality)},Q.prototype.makeFeasible=function(te){var j=this;if(this.avoidOverlaps){var $="x",J="width";"x"===te.axis&&($="y",J="height");var ae=te.offsets.map(function(re){return j.nodes[re.node]}).sort(function(re,ee){return re[$]-ee[$]}),Ee=null;ae.forEach(function(re){if(Ee){var ee=Ee[$]+Ee[J];ee>re[$]&&(re[$]=ee)}Ee=re})}},Q.prototype.createAlignment=function(te){var j=this,$=this.nodes[te.offsets[0].node].variable;this.makeFeasible(te);var J="x"===te.axis?this.xConstraints:this.yConstraints;te.offsets.slice(1).forEach(function(ae){J.push(new S.Constraint($,j.nodes[ae.node].variable,ae.offset,!0))})},Q.prototype.createConstraints=function(te){var j=this,$=function(J){return void 0===J.type||"separation"===J.type};this.xConstraints=te.filter(function(J){return"x"===J.axis&&$(J)}).map(function(J){return j.createSeparation(J)}),this.yConstraints=te.filter(function(J){return"y"===J.axis&&$(J)}).map(function(J){return j.createSeparation(J)}),te.filter(function(J){return"alignment"===J.type}).forEach(function(J){return j.createAlignment(J)})},Q.prototype.setupVariablesAndBounds=function(te,j,$,J){this.nodes.forEach(function(ae,Ee){ae.fixed?(ae.variable.weight=ae.fixedWeight?ae.fixedWeight:1e3,$[Ee]=J(ae)):ae.variable.weight=1;var re=(ae.width||0)/2,ee=(ae.height||0)/2,Ae=te[Ee],De=j[Ee];ae.bounds=new R(Ae-re,Ae+re,De-ee,De+ee)})},Q.prototype.xProject=function(te,j,$){!this.rootGroup&&!this.avoidOverlaps&&!this.xConstraints||this.project(te,j,te,$,function(J){return J.px},this.xConstraints,ne,function(J){return J.bounds.setXCentre($[J.variable.index]=J.variable.position())},function(J){var ae=$[J.minVar.index]=J.minVar.position(),Ee=$[J.maxVar.index]=J.maxVar.position(),re=J.padding/2;J.bounds.x=ae-re,J.bounds.X=Ee+re})},Q.prototype.yProject=function(te,j,$){!this.rootGroup&&!this.yConstraints||this.project(te,j,j,$,function(J){return J.py},this.yConstraints,se,function(J){return J.bounds.setYCentre($[J.variable.index]=J.variable.position())},function(J){var ae=$[J.minVar.index]=J.minVar.position(),Ee=$[J.maxVar.index]=J.maxVar.position(),re=J.padding/2;J.bounds.y=ae-re,J.bounds.Y=Ee+re})},Q.prototype.projectFunctions=function(){var te=this;return[function(j,$,J){return te.xProject(j,$,J)},function(j,$,J){return te.yProject(j,$,J)}]},Q.prototype.project=function(te,j,$,J,ae,Ee,re,ee,Ae){this.setupVariablesAndBounds(te,j,J,ae),this.rootGroup&&this.avoidOverlaps&&(w(this.rootGroup),Ee=Ee.concat(re(this.rootGroup))),this.solve(this.variables,Ee,$,J),this.nodes.forEach(ee),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(Ae),w(this.rootGroup))},Q.prototype.solve=function(te,j,$,J){var ae=new S.Solver(te,j);ae.setStartingPositions($),ae.setDesiredPositions(J),ae.solve()},Q}();D.Projection=me},3858:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var E=p(8866),S=function f(y,m){this.id=y,this.distance=m},O=function f(y){this.id=y,this.neighbours=[]},w=function f(y,m,T){this.node=y,this.prev=m,this.d=T},R=function(){function f(y,m,T,g,C){this.n=y,this.es=m,this.neighbours=new Array(this.n);for(var v=this.n;v--;)this.neighbours[v]=new O(v);for(v=this.es.length;v--;){var P=this.es[v],_=T(P),x=g(P),B=C(P);this.neighbours[_].neighbours.push(new S(x,B)),this.neighbours[x].neighbours.push(new S(_,B))}}return f.prototype.DistanceMatrix=function(){for(var y=new Array(this.n),m=0;m<this.n;++m)y[m]=this.dijkstraNeighbours(m);return y},f.prototype.DistancesFromNode=function(y){return this.dijkstraNeighbours(y)},f.prototype.PathFromNodeToNode=function(y,m){return this.dijkstraNeighbours(y,m)},f.prototype.PathFromNodeToNodeWithPrevCost=function(y,m,T){var g=new E.PriorityQueue(function(se,ge){return se.d<=ge.d}),C=this.neighbours[y],v=new w(C,null,0),P={};for(g.push(v);!g.empty()&&(C=(v=g.pop()).node).id!==m;)for(var _=C.neighbours.length;_--;){var x=C.neighbours[_],B=this.neighbours[x.id];if(!v.prev||B.id!==v.prev.node.id){var H=B.id+","+C.id;if(!(H in P&&P[H]<=v.d)){var K=v.prev?T(v.prev.node.id,C.id,B.id):0,V=v.d+x.distance+K;P[H]=V,g.push(new w(B,v,V))}}}for(var ne=[];v.prev;)ne.push((v=v.prev).node.id);return ne},f.prototype.dijkstraNeighbours=function(y,m){void 0===m&&(m=-1);for(var T=new E.PriorityQueue(function(K,V){return K.d<=V.d}),g=this.neighbours.length,C=new Array(g);g--;){var v=this.neighbours[g];v.d=g===y?0:Number.POSITIVE_INFINITY,v.q=T.push(v)}for(;!T.empty();){var P=T.pop();if(C[P.id]=P.d,P.id===m){for(var _=[],x=P;void 0!==x.prev;)_.push(x.prev.id),x=x.prev;return _}for(g=P.neighbours.length;g--;){var B=P.neighbours[g],H=(x=this.neighbours[B.id],P.d+B.distance);P.d!==Number.MAX_VALUE&&x.d>H&&(x.d=H,x.prev=P,T.reduceKey(x.q,x,function(V,ne){return V.q=ne}))}}return C},f}();D.Calculator=R},8237:(L,D)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var p=function(){function y(m){this.scale=m,this.AB=0,this.AD=0,this.A2=0}return y.prototype.addVariable=function(m){var T=this.scale/m.scale,C=m.weight;this.AB+=C*T*(m.offset/m.scale),this.AD+=C*T*m.desiredPosition,this.A2+=C*T*T},y.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},y}();D.PositionStats=p;var E=function(){function y(m,T,g,C){void 0===C&&(C=!1),this.left=m,this.right=T,this.gap=g,this.equality=C,this.active=!1,this.unsatisfiable=!1,this.left=m,this.right=T,this.gap=g,this.equality=C}return y.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},y}();D.Constraint=E;var S=function(){function y(m,T,g){void 0===T&&(T=1),void 0===g&&(g=1),this.desiredPosition=m,this.weight=T,this.scale=g,this.offset=0}return y.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},y.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},y.prototype.visitNeighbours=function(m,T){var g=function(C,v){return C.active&&m!==v&&T(C,v)};this.cOut.forEach(function(C){return g(C,C.right)}),this.cIn.forEach(function(C){return g(C,C.left)})},y}();D.Variable=S;var O=function(){function y(m){this.vars=[],m.offset=0,this.ps=new p(m.scale),this.addVariable(m)}return y.prototype.addVariable=function(m){m.block=this,this.vars.push(m),this.ps.addVariable(m),this.posn=this.ps.getPosn()},y.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var m=0,T=this.vars.length;m<T;++m)this.ps.addVariable(this.vars[m]);this.posn=this.ps.getPosn()},y.prototype.compute_lm=function(m,T,g){var C=this,v=m.dfdv();return m.visitNeighbours(T,function(P,_){var x=C.compute_lm(_,m,g);_===P.right?(v+=x*P.left.scale,P.lm=x):(v+=x*P.right.scale,P.lm=-x),g(P)}),v/m.scale},y.prototype.populateSplitBlock=function(m,T){var g=this;m.visitNeighbours(T,function(C,v){v.offset=m.offset+(v===C.right?C.gap:-C.gap),g.addVariable(v),g.populateSplitBlock(v,m)})},y.prototype.traverse=function(m,T,g,C){var v=this;void 0===g&&(g=this.vars[0]),void 0===C&&(C=null),g.visitNeighbours(C,function(P,_){T.push(m(P)),v.traverse(m,T,_,g)})},y.prototype.findMinLM=function(){var m=null;return this.compute_lm(this.vars[0],null,function(T){!T.equality&&(null===m||T.lm<m.lm)&&(m=T)}),m},y.prototype.findMinLMBetween=function(m,T){this.compute_lm(m,null,function(){});var g=null;return this.findPath(m,null,T,function(C,v){!C.equality&&C.right===v&&(null===g||C.lm<g.lm)&&(g=C)}),g},y.prototype.findPath=function(m,T,g,C){var v=this,P=!1;return m.visitNeighbours(T,function(_,x){!P&&(x===g||v.findPath(x,m,g,C))&&(P=!0,C(_,x))}),P},y.prototype.isActiveDirectedPathBetween=function(m,T){if(m===T)return!0;for(var g=m.cOut.length;g--;){var C=m.cOut[g];if(C.active&&this.isActiveDirectedPathBetween(C.right,T))return!0}return!1},y.split=function(m){return m.active=!1,[y.createSplitBlock(m.left),y.createSplitBlock(m.right)]},y.createSplitBlock=function(m){var T=new y(m);return T.populateSplitBlock(m,null),T},y.prototype.splitBetween=function(m,T){var g=this.findMinLMBetween(m,T);if(null!==g){var C=y.split(g);return{constraint:g,lb:C[0],rb:C[1]}}return null},y.prototype.mergeAcross=function(m,T,g){T.active=!0;for(var C=0,v=m.vars.length;C<v;++C){var P=m.vars[C];P.offset+=g,this.addVariable(P)}this.posn=this.ps.getPosn()},y.prototype.cost=function(){for(var m=0,T=this.vars.length;T--;){var g=this.vars[T],C=g.position()-g.desiredPosition;m+=C*C*g.weight}return m},y}();D.Block=O;var w=function(){function y(m){this.vs=m;var T=m.length;for(this.list=new Array(T);T--;){var g=new O(m[T]);this.list[T]=g,g.blockInd=T}}return y.prototype.cost=function(){for(var m=0,T=this.list.length;T--;)m+=this.list[T].cost();return m},y.prototype.insert=function(m){m.blockInd=this.list.length,this.list.push(m)},y.prototype.remove=function(m){var T=this.list.length-1,g=this.list[T];this.list.length=T,m!==g&&(this.list[m.blockInd]=g,g.blockInd=m.blockInd)},y.prototype.merge=function(m){var T=m.left.block,g=m.right.block,C=m.right.offset-m.left.offset-m.gap;T.vars.length<g.vars.length?(g.mergeAcross(T,m,C),this.remove(T)):(T.mergeAcross(g,m,-C),this.remove(g))},y.prototype.forEach=function(m){this.list.forEach(m)},y.prototype.updateBlockPositions=function(){this.list.forEach(function(m){return m.updateWeightedPosition()})},y.prototype.split=function(m){var T=this;this.updateBlockPositions(),this.list.forEach(function(g){var C=g.findMinLM();null!==C&&C.lm<R.LAGRANGIAN_TOLERANCE&&(g=C.left.block,O.split(C).forEach(function(v){return T.insert(v)}),T.remove(g),m.push(C))})},y}();D.Blocks=w;var R=function(){function y(m,T){this.vs=m,this.cs=T,this.vs=m,m.forEach(function(g){g.cIn=[],g.cOut=[]}),this.cs=T,T.forEach(function(g){g.left.cOut.push(g),g.right.cIn.push(g)}),this.inactive=T.map(function(g){return g.active=!1,g}),this.bs=null}return y.prototype.cost=function(){return this.bs.cost()},y.prototype.setStartingPositions=function(m){this.inactive=this.cs.map(function(T){return T.active=!1,T}),this.bs=new w(this.vs),this.bs.forEach(function(T,g){return T.posn=m[g]})},y.prototype.setDesiredPositions=function(m){this.vs.forEach(function(T,g){return T.desiredPosition=m[g]})},y.prototype.mostViolated=function(){for(var m=Number.MAX_VALUE,T=null,g=this.inactive,C=g.length,v=C,P=0;P<C;++P){var _=g[P];if(!_.unsatisfiable){var x=_.slack();if((_.equality||x<m)&&(m=x,T=_,v=P,_.equality))break}}return v!==C&&(m<y.ZERO_UPPERBOUND&&!T.active||T.equality)&&(g[v]=g[C-1],g.length=C-1),T},y.prototype.satisfy=function(){null==this.bs&&(this.bs=new w(this.vs)),this.bs.split(this.inactive);for(var m=null;(m=this.mostViolated())&&(m.equality||m.slack()<y.ZERO_UPPERBOUND&&!m.active);){var T=m.left.block;if(T!==m.right.block)this.bs.merge(m);else{if(T.isActiveDirectedPathBetween(m.right,m.left)){m.unsatisfiable=!0;continue}var C=T.splitBetween(m.left,m.right);if(null===C){m.unsatisfiable=!0;continue}this.bs.insert(C.lb),this.bs.insert(C.rb),this.bs.remove(T),this.inactive.push(C.constraint),m.slack()>=0?this.inactive.push(m):this.bs.merge(m)}}},y.prototype.solve=function(){this.satisfy();for(var m=Number.MAX_VALUE,T=this.bs.cost();Math.abs(m-T)>1e-4;)this.satisfy(),m=T,T=this.bs.cost();return T},y.LAGRANGIAN_TOLERANCE=-1e-4,y.ZERO_UPPERBOUND=-1e-10,y}();D.Solver=R,D.removeOverlapInOneDimension=function f(y,m,T){for(var g=y.map(function(ce){return new S(ce.desiredCenter)}),C=[],v=y.length,P=0;P<v-1;P++)C.push(new E(g[P],g[P+1],(y[P].size+y[P+1].size)/2));var B=g[0],H=g[v-1],K=y[0].size/2,V=y[v-1].size/2,ne=null,se=null;return m&&(ne=new S(m,1e3*B.weight),g.push(ne),C.push(new E(ne,B,K))),T&&(se=new S(T,1e3*H.weight),g.push(se),C.push(new E(H,se,V))),new R(g,C).solve(),{newCenters:g.slice(0,y.length).map(function(ce){return ce.position()}),lowerBound:ne?ne.position():B.position()-K,upperBound:se?se.position():H.position()+V}}},655:(L,D,p)=>{"use strict";p.r(D),p.d(D,{__assign:()=>O,__asyncDelegator:()=>V,__asyncGenerator:()=>K,__asyncValues:()=>ne,__await:()=>H,__awaiter:()=>m,__classPrivateFieldGet:()=>Q,__classPrivateFieldSet:()=>te,__createBinding:()=>g,__decorate:()=>R,__exportStar:()=>C,__extends:()=>S,__generator:()=>T,__importDefault:()=>me,__importStar:()=>ce,__makeTemplateObject:()=>se,__metadata:()=>y,__param:()=>f,__read:()=>P,__rest:()=>w,__spread:()=>_,__spreadArray:()=>B,__spreadArrays:()=>x,__values:()=>v});var E=function(j,$){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(J,ae){J.__proto__=ae}||function(J,ae){for(var Ee in ae)Object.prototype.hasOwnProperty.call(ae,Ee)&&(J[Ee]=ae[Ee])})(j,$)};function S(j,$){if("function"!=typeof $&&null!==$)throw new TypeError("Class extends value "+String($)+" is not a constructor or null");function J(){this.constructor=j}E(j,$),j.prototype=null===$?Object.create($):(J.prototype=$.prototype,new J)}var O=function(){return O=Object.assign||function($){for(var J,ae=1,Ee=arguments.length;ae<Ee;ae++)for(var re in J=arguments[ae])Object.prototype.hasOwnProperty.call(J,re)&&($[re]=J[re]);return $},O.apply(this,arguments)};function w(j,$){var J={};for(var ae in j)Object.prototype.hasOwnProperty.call(j,ae)&&$.indexOf(ae)<0&&(J[ae]=j[ae]);if(null!=j&&"function"==typeof Object.getOwnPropertySymbols){var Ee=0;for(ae=Object.getOwnPropertySymbols(j);Ee<ae.length;Ee++)$.indexOf(ae[Ee])<0&&Object.prototype.propertyIsEnumerable.call(j,ae[Ee])&&(J[ae[Ee]]=j[ae[Ee]])}return J}function R(j,$,J,ae){var ee,Ee=arguments.length,re=Ee<3?$:null===ae?ae=Object.getOwnPropertyDescriptor($,J):ae;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)re=Reflect.decorate(j,$,J,ae);else for(var Ae=j.length-1;Ae>=0;Ae--)(ee=j[Ae])&&(re=(Ee<3?ee(re):Ee>3?ee($,J,re):ee($,J))||re);return Ee>3&&re&&Object.defineProperty($,J,re),re}function f(j,$){return function(J,ae){$(J,ae,j)}}function y(j,$){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(j,$)}function m(j,$,J,ae){return new(J||(J=Promise))(function(re,ee){function Ae(Le){try{Ne(ae.next(Le))}catch(ke){ee(ke)}}function De(Le){try{Ne(ae.throw(Le))}catch(ke){ee(ke)}}function Ne(Le){Le.done?re(Le.value):function Ee(re){return re instanceof J?re:new J(function(ee){ee(re)})}(Le.value).then(Ae,De)}Ne((ae=ae.apply(j,$||[])).next())})}function T(j,$){var ae,Ee,re,ee,J={label:0,sent:function(){if(1&re[0])throw re[1];return re[1]},trys:[],ops:[]};return ee={next:Ae(0),throw:Ae(1),return:Ae(2)},"function"==typeof Symbol&&(ee[Symbol.iterator]=function(){return this}),ee;function Ae(Ne){return function(Le){return function De(Ne){if(ae)throw new TypeError("Generator is already executing.");for(;J;)try{if(ae=1,Ee&&(re=2&Ne[0]?Ee.return:Ne[0]?Ee.throw||((re=Ee.return)&&re.call(Ee),0):Ee.next)&&!(re=re.call(Ee,Ne[1])).done)return re;switch(Ee=0,re&&(Ne=[2&Ne[0],re.value]),Ne[0]){case 0:case 1:re=Ne;break;case 4:return J.label++,{value:Ne[1],done:!1};case 5:J.label++,Ee=Ne[1],Ne=[0];continue;case 7:Ne=J.ops.pop(),J.trys.pop();continue;default:if(!(re=(re=J.trys).length>0&&re[re.length-1])&&(6===Ne[0]||2===Ne[0])){J=0;continue}if(3===Ne[0]&&(!re||Ne[1]>re[0]&&Ne[1]<re[3])){J.label=Ne[1];break}if(6===Ne[0]&&J.label<re[1]){J.label=re[1],re=Ne;break}if(re&&J.label<re[2]){J.label=re[2],J.ops.push(Ne);break}re[2]&&J.ops.pop(),J.trys.pop();continue}Ne=$.call(j,J)}catch(Le){Ne=[6,Le],Ee=0}finally{ae=re=0}if(5&Ne[0])throw Ne[1];return{value:Ne[0]?Ne[1]:void 0,done:!0}}([Ne,Le])}}}var g=Object.create?function(j,$,J,ae){void 0===ae&&(ae=J),Object.defineProperty(j,ae,{enumerable:!0,get:function(){return $[J]}})}:function(j,$,J,ae){void 0===ae&&(ae=J),j[ae]=$[J]};function C(j,$){for(var J in j)"default"!==J&&!Object.prototype.hasOwnProperty.call($,J)&&g($,j,J)}function v(j){var $="function"==typeof Symbol&&Symbol.iterator,J=$&&j[$],ae=0;if(J)return J.call(j);if(j&&"number"==typeof j.length)return{next:function(){return j&&ae>=j.length&&(j=void 0),{value:j&&j[ae++],done:!j}}};throw new TypeError($?"Object is not iterable.":"Symbol.iterator is not defined.")}function P(j,$){var J="function"==typeof Symbol&&j[Symbol.iterator];if(!J)return j;var Ee,ee,ae=J.call(j),re=[];try{for(;(void 0===$||$-- >0)&&!(Ee=ae.next()).done;)re.push(Ee.value)}catch(Ae){ee={error:Ae}}finally{try{Ee&&!Ee.done&&(J=ae.return)&&J.call(ae)}finally{if(ee)throw ee.error}}return re}function _(){for(var j=[],$=0;$<arguments.length;$++)j=j.concat(P(arguments[$]));return j}function x(){for(var j=0,$=0,J=arguments.length;$<J;$++)j+=arguments[$].length;var ae=Array(j),Ee=0;for($=0;$<J;$++)for(var re=arguments[$],ee=0,Ae=re.length;ee<Ae;ee++,Ee++)ae[Ee]=re[ee];return ae}function B(j,$,J){if(J||2===arguments.length)for(var re,ae=0,Ee=$.length;ae<Ee;ae++)(re||!(ae in $))&&(re||(re=Array.prototype.slice.call($,0,ae)),re[ae]=$[ae]);return j.concat(re||$)}function H(j){return this instanceof H?(this.v=j,this):new H(j)}function K(j,$,J){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ee,ae=J.apply(j,$||[]),re=[];return Ee={},ee("next"),ee("throw"),ee("return"),Ee[Symbol.asyncIterator]=function(){return this},Ee;function ee(je){ae[je]&&(Ee[je]=function(ft){return new Promise(function(Se,Ie){re.push([je,ft,Se,Ie])>1||Ae(je,ft)})})}function Ae(je,ft){try{!function De(je){je.value instanceof H?Promise.resolve(je.value.v).then(Ne,Le):ke(re[0][2],je)}(ae[je](ft))}catch(Se){ke(re[0][3],Se)}}function Ne(je){Ae("next",je)}function Le(je){Ae("throw",je)}function ke(je,ft){je(ft),re.shift(),re.length&&Ae(re[0][0],re[0][1])}}function V(j){var $,J;return $={},ae("next"),ae("throw",function(Ee){throw Ee}),ae("return"),$[Symbol.iterator]=function(){return this},$;function ae(Ee,re){$[Ee]=j[Ee]?function(ee){return(J=!J)?{value:H(j[Ee](ee)),done:"return"===Ee}:re?re(ee):ee}:re}}function ne(j){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var J,$=j[Symbol.asyncIterator];return $?$.call(j):(j=v(j),J={},ae("next"),ae("throw"),ae("return"),J[Symbol.asyncIterator]=function(){return this},J);function ae(re){J[re]=j[re]&&function(ee){return new Promise(function(Ae,De){!function Ee(re,ee,Ae,De){Promise.resolve(De).then(function(Ne){re({value:Ne,done:Ae})},ee)}(Ae,De,(ee=j[re](ee)).done,ee.value)})}}}function se(j,$){return Object.defineProperty?Object.defineProperty(j,"raw",{value:$}):j.raw=$,j}var ge=Object.create?function(j,$){Object.defineProperty(j,"default",{enumerable:!0,value:$})}:function(j,$){j.default=$};function ce(j){if(j&&j.__esModule)return j;var $={};if(null!=j)for(var J in j)"default"!==J&&Object.prototype.hasOwnProperty.call(j,J)&&g($,j,J);return ge($,j),$}function me(j){return j&&j.__esModule?j:{default:j}}function Q(j,$,J,ae){if("a"===J&&!ae)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof $?j!==$||!ae:!$.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===J?ae:"a"===J?ae.call(j):ae?ae.value:$.get(j)}function te(j,$,J,ae,Ee){if("m"===ae)throw new TypeError("Private method is not writable");if("a"===ae&&!Ee)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof $?j!==$||!Ee:!$.has(j))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===ae?Ee.call(j,J):Ee?Ee.value=J:$.set(j,J),J}},8270:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.KeyedMultiCollection=D.ReadonlyKeyedMultiCollection=D.KeyedCollection=D.ReadonlyKeyedCollection=D.IndexedCollection=D.FixedSizeIndexedCollection=D.ReadonlyIndexedCollection=D.Collection=D.ReadonlyCollection=void 0;const E=p(1344),S=p(9440);var O,v,w,R,f,y,m,T,g,C;(v=O=D.ReadonlyCollection||(D.ReadonlyCollection={})).size=Symbol.for("@esfx/collection-core!ReadonlyCollection.size"),v.has=Symbol.for("@esfx/collection-core!ReadonlyCollection.has"),v.isReadonlyCollection=function P(x){return E.isIterable(x)&&v.size in x&&v.has in x},v.name="ReadonlyCollection",v.hasInstance=function _(x){return E.isIterable(x)&&v.size in x&&v.has in x},function(v){v.size=O.size,v.has=O.has,v.isReadonlyCollection=O.isReadonlyCollection,v.add=Symbol.for("@esfx/collection-core!Collection.add"),v.delete=Symbol.for("@esfx/collection-core!Collection.delete"),v.clear=Symbol.for("@esfx/collection-core!Collection.clear"),v.isCollection=function P(x){return v.hasInstance(x)},v.name="Collection",v.hasInstance=function _(x){return O.hasInstance(x)&&v.add in x&&v.delete in x&&v.clear in x}}(w=D.Collection||(D.Collection={})),function(v){v.size=O.size,v.has=O.has,v.isReadonlyCollection=O.isReadonlyCollection,v.indexOf=Symbol.for("@esfx/collection-core!ReadonlyIndexedCollection.indexOf"),v.getAt=Symbol.for("@esfx/collection-core!ReadonlyIndexedCollection.getAt"),v.isReadonlyIndexedCollection=function P(x){return v.hasInstance(x)},v.name="ReadonlyIndexedCollection",v.hasInstance=function _(x){return O.hasInstance(x)&&v.indexOf in x&&v.getAt in x}}(R=D.ReadonlyIndexedCollection||(D.ReadonlyIndexedCollection={})),function(v){v.size=O.size,v.has=O.has,v.isReadonlyCollection=O.isReadonlyCollection,v.indexOf=R.indexOf,v.getAt=R.getAt,v.isReadonlyIndexedCollection=R.isReadonlyIndexedCollection,v.setAt=Symbol.for("@esfx/collection-core!FixedSizeIndexedCollection.setAt"),v.isFixedSizeIndexedCollection=function P(x){return v.hasInstance(x)},v.name="FixedSizeIndexedCollection",v.hasInstance=function _(x){return R.hasInstance(x)&&v.setAt in x}}(f=D.FixedSizeIndexedCollection||(D.FixedSizeIndexedCollection={})),function(v){v.size=O.size,v.has=O.has,v.isReadonlyCollection=O.isReadonlyCollection,v.indexOf=R.indexOf,v.getAt=R.getAt,v.isReadonlyIndexedCollection=R.isReadonlyIndexedCollection,v.setAt=f.setAt,v.isFixedSizeIndexedCollection=f.isFixedSizeIndexedCollection,v.add=w.add,v.delete=w.delete,v.clear=w.clear,v.isCollection=w.isCollection,v.insertAt=Symbol.for("@esfx/collection-core!IndexedCollection.insertAt"),v.removeAt=Symbol.for("@esfx/collection-core!IndexedCollection.removeAt"),v.isIndexedCollection=function P(x){return v.hasInstance(x)},v.name="IndexedCollection",v.hasInstance=function _(x){return f.hasInstance(x)&&v.insertAt in x&&v.removeAt in x}}(y=D.IndexedCollection||(D.IndexedCollection={})),function(v){v.size=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.size"),v.has=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.has"),v.get=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.get"),v.keys=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.keys"),v.values=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.values"),v.isReadonlyKeyedCollection=function P(x){return v.hasInstance(x)},v.name="ReadonlyKeyedCollection",v.hasInstance=function _(x){return E.isIterable(x)&&v.size in x&&v.has in x&&v.get in x&&v.keys in x&&v.values in x}}(m=D.ReadonlyKeyedCollection||(D.ReadonlyKeyedCollection={})),function(v){v.size=m.size,v.has=m.has,v.get=m.get,v.keys=m.keys,v.values=m.values,v.isReadonlyKeyedCollection=m.isReadonlyKeyedCollection,v.set=Symbol.for("@esfx/collection-core!KeyedCollection.set"),v.delete=Symbol.for("@esfx/collection-core!KeyedCollection.delete"),v.clear=Symbol.for("@esfx/collection-core!KeyedCollection.clear"),v.isKeyedCollection=function P(x){return v.hasInstance(x)},v.name="KeyedCollection",v.hasInstance=function _(x){return m.hasInstance(x)&&v.set in x&&v.delete in x&&v.clear in x}}(T=D.KeyedCollection||(D.KeyedCollection={})),function(v){v.size=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.size"),v.has=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.has"),v.hasValue=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.hasValue"),v.get=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.get"),v.keys=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.keys"),v.values=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.values"),v.isReadonlyKeyedMultiCollection=function P(x){return v.hasInstance(x)},v.name="ReadonlyKeyedMultiCollection",v.hasInstance=function _(x){return E.isIterable(x)&&v.size in x&&v.has in x&&v.hasValue in x&&v.get in x&&v.keys in x&&v.values in x}}(g=D.ReadonlyKeyedMultiCollection||(D.ReadonlyKeyedMultiCollection={})),function(v){v.size=g.size,v.has=g.has,v.hasValue=g.hasValue,v.get=g.get,v.keys=g.keys,v.values=g.values,v.isReadonlyKeyedMultiCollection=g.isReadonlyKeyedMultiCollection,v.add=Symbol.for("@esfx/collection-core!KeyedMultiCollection.add"),v.delete=Symbol.for("@esfx/collection-core!KeyedMultiCollection.delete"),v.deleteValue=Symbol.for("@esfx/collection-core!KeyedMultiCollection.deleteValue"),v.clear=Symbol.for("@esfx/collection-core!KeyedMultiCollection.clear"),v.isKeyedMultiCollection=function P(x){return v.hasInstance(x)},v.name="KeyedMultiCollection",v.hasInstance=function _(x){return g.hasInstance(x)&&v.add in x&&v.delete in x&&v.deleteValue in x&&v.clear in x}}(C=D.KeyedMultiCollection||(D.KeyedMultiCollection={})),S.deprecateProperty(O,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),S.deprecateProperty(w,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),S.deprecateProperty(w,"isCollection","Use 'Collection.hasInstance' instead."),S.deprecateProperty(R,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),S.deprecateProperty(R,"isReadonlyIndexedCollection","Use 'ReadonlyIndexedCollection.hasInstance' instead."),S.deprecateProperty(f,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),S.deprecateProperty(f,"isReadonlyIndexedCollection","Use 'ReadonlyIndexedCollection.hasInstance' instead."),S.deprecateProperty(f,"isFixedSizeIndexedCollection","Use 'FixedSizeIndexedCollection.hasInstance' instead."),S.deprecateProperty(y,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),S.deprecateProperty(y,"isReadonlyIndexedCollection","Use 'ReadonlyIndexedCollection.hasInstance' instead."),S.deprecateProperty(y,"isFixedSizeIndexedCollection","Use 'FixedSizeIndexedCollection.hasInstance' instead."),S.deprecateProperty(y,"isCollection","Use 'Collection.hasInstance' instead."),S.deprecateProperty(y,"isIndexedCollection","Use 'IndexedCollection.hasInstance' instead."),S.deprecateProperty(m,"isReadonlyKeyedCollection","Use 'ReadonlyKeyedCollection.hasInstance' instead."),S.deprecateProperty(T,"isReadonlyKeyedCollection","Use 'ReadonlyKeyedCollection.hasInstance' instead."),S.deprecateProperty(T,"isKeyedCollection","Use 'KeyedCollection.hasInstance' instead."),S.deprecateProperty(g,"isReadonlyKeyedMultiCollection","Use 'ReadonlyKeyedMultiCollection.hasInstance' instead."),S.deprecateProperty(C,"isReadonlyKeyedMultiCollection","Use 'ReadonlyKeyedMultiCollection.hasInstance' instead."),S.deprecateProperty(C,"isKeyedMultiCollection","Use 'KeyedMultiCollection.hasInstance' instead.")},8090:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.HashMap=void 0;const E=p(8270),S=p(839),O=p(1344),w=p(1301);class R{constructor(...y){let m,T,g;if(y.length>0){const C=y[0];"number"==typeof C?(m=C,y.length>1&&(g=y[1])):O.isIterable(C)||void 0===C?(T=C,y.length>1&&(g=y[1])):g=C}if(void 0===m&&(m=0),void 0===g&&(g=S.Equaler.defaultEqualer),m<0)throw new RangeError;if(this._hashData=w.createHashData(g,m),T)for(const[C,v]of T)this.set(C,v)}get equaler(){return this._hashData.equaler}get size(){return this._hashData.size-this._hashData.freeSize}has(y){return w.findEntryIndex(this._hashData,y)>=0}get(y){return w.findEntryValue(this._hashData,y)}set(y,m){return w.insertEntry(this._hashData,y,m),this}delete(y){return w.deleteEntry(this._hashData,y)}clear(){w.clearEntries(this._hashData)}ensureCapacity(y){return w.ensureCapacity(this._hashData,y)}trimExcess(y){w.trimExcessEntries(this._hashData,y)}keys(){return w.iterateEntries(this._hashData.head,w.selectEntryKey)}values(){return w.iterateEntries(this._hashData.head,w.selectEntryValue)}entries(){return w.iterateEntries(this._hashData.head,w.selectEntryEntry)}[Symbol.iterator](){return this.entries()}forEach(y,m){w.forEachEntry(this,this._hashData.head,y,m)}get[E.ReadonlyKeyedCollection.size](){return this.size}[E.ReadonlyKeyedCollection.has](y){return this.has(y)}[E.ReadonlyKeyedCollection.get](y){return this.get(y)}[E.ReadonlyKeyedCollection.keys](){return this.keys()}[E.ReadonlyKeyedCollection.values](){return this.values()}[E.KeyedCollection.set](y,m){this.set(y,m)}[E.KeyedCollection.delete](y){return this.delete(y)}[E.KeyedCollection.clear](){this.clear()}}D.HashMap=R,Object.defineProperty(R,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"HashMap"})},6471:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.HashSet=void 0;const E=p(8270),S=p(839),O=p(1344),w=p(1301);class R{constructor(...y){let m,T,g;if(y.length>0){const C=y[0];"number"==typeof C?(m=C,y.length>1&&(g=y[1])):O.isIterable(C)?(T=C,y.length>1&&(g=y[1])):g=C}if(void 0===m&&(m=0),void 0===g&&(g=S.Equaler.defaultEqualer),m<0)throw new RangeError;if(this._hashData=w.createHashData(g,m),T)for(const C of T)this.add(C)}get equaler(){return this._hashData.equaler}get size(){return this._hashData.size-this._hashData.freeSize}has(y){return w.findEntryIndex(this._hashData,y)>=0}add(y){return w.insertEntry(this._hashData,y,y),this}tryAdd(y){const m=this.size;return w.insertEntry(this._hashData,y,y),this.size>m}delete(y){return w.deleteEntry(this._hashData,y)}clear(){w.clearEntries(this._hashData)}ensureCapacity(y){return w.ensureCapacity(this._hashData,y)}trimExcess(y){w.trimExcessEntries(this._hashData,y)}keys(){return w.iterateEntries(this._hashData.head,w.selectEntryKey)}values(){return w.iterateEntries(this._hashData.head,w.selectEntryValue)}entries(){return w.iterateEntries(this._hashData.head,w.selectEntryEntry)}[Symbol.iterator](){return this.values()}forEach(y,m){w.forEachEntry(this,this._hashData.head,y,m)}get[E.Collection.size](){return this.size}[E.Collection.has](y){return this.has(y)}[E.Collection.add](y){this.add(y)}[E.Collection.delete](y){return this.delete(y)}[E.Collection.clear](){this.clear()}}D.HashSet=R,Object.defineProperty(R,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"HashSet"})},6289:(L,D,p)=>{"use strict";var E,S,O;Object.defineProperty(D,"__esModule",{value:!0}),D.LinkedList=D.LinkedListNode=void 0;const w=p(1344),R=p(8270),f=p(839),y=Symbol("LinkedListNode.list"),m=Symbol("LinkedListNode.previous"),T=Symbol("LinkedListNode.next");class g{constructor(P){this[E]=void 0,this[S]=void 0,this[O]=void 0,this.value=P}get list(){return this[y]}get previous(){if(this[m]&&this.list&&this!==this.list.first)return this[m]}get next(){if(this[T]&&this.list&&this[T]!==this.list.first)return this[T]}detachSelf(){return!!this.list&&this.list.deleteNode(this)}}D.LinkedListNode=g,E=y,S=m,O=T,Object.defineProperty(g.prototype,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"LinkedListNode"});class C{constructor(...P){let _,x;if(this._size=0,this._head=void 0,P.length>0&&(w.isIterable(P[0])||w.isMissing(P[0])?(_=P[0],P.length>1&&(x=P[1])):x=P[0]),w.isMissing(x)&&(x=f.Equaler.defaultEqualer),this._equaler="function"==typeof x?f.Equaler.create(x):x,_)for(const B of _)this.push(B)}get equaler(){return this._equaler}get first(){return this._head}get last(){if(this._head)return this._head[m]}get size(){return this._size}[Symbol.iterator](){return this.values()}*values(){for(const P of this.nodes())yield P.value}*nodes(){let P,_=this.first;for(;void 0!==_;)P=_,_=P.next,yield P}*drain(){for(const P of this.nodes())this.deleteNode(P),yield P.value}nodeOf(P,_){if(!w.isMissing(_)&&!w.isInstance(_,g))throw new TypeError("LinkedListNode expected: fromNode");if(!w.isMissing(_)&&_.list!==this)throw new TypeError("Wrong list.");for(let x=_||this.first;x;x=x.next)if(this._equaler.equals(x.value,P))return x}lastNodeOf(P,_){if(!w.isMissing(_)&&!w.isInstance(_,g))throw new TypeError("LinkedListNode expected: fromNode");if(!w.isMissing(_)&&_.list!==this)throw new TypeError("Wrong list.");for(let x=_||this.last;x;x=x.previous)if(this._equaler.equals(x.value,P))return x}find(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");let x,B=this.first;for(;void 0!==B;){x=B,B=x.next;const H=x.value;if(P.call(_,H,x,this))return H}}findLast(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");let x,B=this.last;for(;void 0!==B;){x=B,B=x.previous;const H=x.value;if(P.call(_,H,x,this))return H}}findNode(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");let x,B=this.first;for(;void 0!==B;)if(x=B,B=x.next,P.call(_,x.value,x,this))return x}findLastNode(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");let x,B=this.last;for(;void 0!==B;)if(x=B,B=x.previous,P.call(_,x.value,x,this))return x}has(P){return void 0!==this.nodeOf(P)}insertBefore(P,_){if(!w.isMissing(P)&&!w.isInstance(P,g))throw new TypeError("LinkedListNode expected: node");if(!w.isMissing(P)&&P.list!==this)throw new Error("Wrong list.");return this._insertNode(P||void 0,new g(_),0)}insertNodeBefore(P,_){if(!w.isMissing(P)&&!w.isInstance(P,g))throw new TypeError("LinkedListNode expected: node");if(!w.isInstance(_,g))throw new TypeError("LinkedListNode expected: newNode");if(!w.isMissing(P)&&P.list!==this)throw new Error("Wrong list.");if(!w.isMissing(_.list))throw new Error("Node is already attached to a list.");this._insertNode(P||void 0,_,0)}insertAfter(P,_){if(!w.isMissing(P)&&!w.isInstance(P,g))throw new TypeError("LinkedListNode expected: node");if(!w.isMissing(P)&&P.list!==this)throw new Error("Wrong list.");return this._insertNode(P||void 0,new g(_),1)}insertNodeAfter(P,_){if(!w.isMissing(P)&&!w.isInstance(P,g))throw new TypeError("LinkedListNode expected: node");if(!w.isInstance(_,g))throw new TypeError("LinkedListNode expected: newNode");if(!w.isMissing(P)&&P.list!==this)throw new Error("Wrong list.");if(!w.isMissing(_.list))throw new Error("Node is already attached to a list.");this._insertNode(P||void 0,_,1)}push(P){return this._insertNode(void 0,new g(P),1)}pushNode(P){if(!w.isInstance(P,g))throw new TypeError("LinkedListNode expected: newNode");if(!w.isMissing(P.list))throw new Error("Node is already attached to a list.");this._insertNode(void 0,P,1)}pop(){const P=this.popNode();return P?P.value:void 0}popNode(){const P=this.last;if(this.deleteNode(P))return P}shift(){const P=this.shiftNode();return P?P.value:void 0}shiftNode(){const P=this.first;if(this.deleteNode(P))return P}unshift(P){return this._insertNode(void 0,new g(P),0)}unshiftNode(P){if(!w.isInstance(P,g))throw new TypeError("LinkedListNode expected: newNode");if(!w.isMissing(P.list))throw new Error("Node is already attached to a list.");this._insertNode(void 0,P,0)}delete(P){const _=this.nodeOf(P);if(_&&this.deleteNode(_))return _}deleteNode(P){if(!w.isMissing(P)&&!w.isInstance(P,g))throw new TypeError("LinkedListNode expected: node");if(!w.isMissing(P)&&!w.isMissing(P.list)&&P.list!==this)throw new TypeError("Wrong list.");return!w.isMissing(P)&&!w.isMissing(P.list)&&this._deleteNode(P)}deleteAll(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: predicate");let x=0,B=this.first;for(;B;){const H=B.next;P.call(_,B.value,B,this)&&B.list===this&&(this._deleteNode(B),++x),B=H}return x}clear(){for(;this.size>0;)this.deleteNode(this.last)}forEach(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");let x,B=this.first;for(;void 0!==B;)x=B,B=x.next,P.call(_,x.value,x,this)}map(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");const x=new C;let B,H=this.first;for(;void 0!==H;){B=H,H=B.next;const K=P.call(_,B.value,B,this);x.push(K)}return x}filter(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");const x=new C(this.equaler);let B,H=this.first;for(;void 0!==H;){B=H,H=B.next;const K=B.value;P.call(_,K,B,this)&&x.push(K)}return x}reduce(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");let H,x=arguments.length>1,B=_,K=this.first;for(;void 0!==K;){H=K,K=H.next;const V=H.value;x?B=P(B,V,H,this):(B=V,x=!0)}return B}reduceRight(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");let H,x=arguments.length>1,B=_,K=this.last;for(;void 0!==K;){H=K;const V=H.value;x?B=P(B,V,H,this):(B=V,x=!0),K=H.previous}return B}some(P,_){if(!w.isMissing(P)&&!w.isFunction(P))throw new TypeError("Function expected: callback");let x,B=this.first;for(;void 0!==B;)if(x=B,B=x.next,!P||P.call(_,x.value,x,this))return!0;return!1}every(P,_){if(!w.isFunction(P))throw new TypeError("Function expected: callback");let B,x=!1,H=this.first;for(;void 0!==H;){if(B=H,H=B.next,!P.call(_,B.value,B,this))return!1;x=!0}return x}_deleteNode(P){return P[T]===P?this._head=void 0:(P[T][m]=P[m],P[m][T]=P[T],this._head===P&&(this._head=P[T])),P[y]=void 0,P[T]=void 0,P[m]=void 0,this._size--,!0}_insertNode(P,_,x){if(_[y]=this,void 0===this._head)_[T]=_,_[m]=_,this._head=_;else switch(x){case 0:void 0===P?(P=this._head,this._head=_):P===this._head&&(this._head=_),_[T]=P,_[m]=P[m],P[m][T]=_,P[m]=_;break;case 1:void 0===P&&(P=this._head[m]),_[m]=P,_[T]=P[T],P[T][m]=_,P[T]=_}return this._size++,_}get[R.ReadonlyCollection.size](){return this.size}[R.ReadonlyCollection.has](P){return this.has(P)}[R.Collection.add](P){this.push(P)}[R.Collection.delete](P){return!!this.delete(P)}[R.Collection.clear](){this.clear()}}D.LinkedList=C,Object.defineProperty(C.prototype,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"LinkedList"})},6207:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.MultiMap=void 0;const E=p(1344),S=p(839),O=p(8270),w=p(8090),R=p(6471);class f{constructor(...g){let C,v,P;this._size=0,function m(T){return(T.length<1||E.isNumber(T[0]))&&(T.length<2||!E.isDefined(T[1])||E.isObject(T[1]))}(g)?[C,P={}]=g:(C=0,function y(T){return(T.length<1||!E.isDefined(T[0])||E.isIterable(T[0]))&&(T.length<2||!E.isDefined(T[1])||E.isObject(T[1]))}(g)?[v,P={}]=g:P={});const{keyEqualer:_=S.Equaler.defaultEqualer,valueEqualer:x=S.Equaler.defaultEqualer}=P;if(this._map=new w.HashMap(C,_),this._keyEqualer=_,this._valueEqualer=x,v)for(const[B,H]of v)this.add(B,H)}get keyEqualer(){return this._keyEqualer}get valueEqualer(){return this._valueEqualer}get size(){return this._size}has(g){return this._map.has(g)}hasValue(g,C){const v=this._map.get(g);return!!v&&v.has(C)}get(g){return this._map.get(g)}add(g,C){let v=this._map.get(g);v||(v=new R.HashSet(this._valueEqualer),this._map.set(g,v));const P=v.size;return v.add(C),this._size+=v.size-P,this}delete(g){const C=this._map.get(g);return C?(this._size-=C.size,this._map.delete(g),C.size):0}deleteValue(g,C){const v=this._map.get(g);if(v){const P=v.size;if(v.delete(C))return this._size+=v.size-P,v.size<=0&&this._map.delete(g),!0}return!1}clear(){this._map.clear(),this._size=0}ensureCapacity(g){return this._map.ensureCapacity(g)}trimExcess(g){this._map.trimExcess(g)}keys(){return this._map.keys()}*values(){for(const g of this._map.values())yield*g}*entries(){for(const[g,C]of this._map)for(const v of C)yield[g,v]}[Symbol.iterator](){return this.entries()}forEach(g,C){for(const[v,P]of this._map)for(const _ of P)g.call(C,_,v,this)}get[O.ReadonlyKeyedMultiCollection.size](){return this.size}[O.ReadonlyKeyedMultiCollection.has](g){return this.has(g)}[O.ReadonlyKeyedMultiCollection.hasValue](g,C){return this.hasValue(g,C)}[O.ReadonlyKeyedMultiCollection.get](g){return this.get(g)}[O.ReadonlyKeyedMultiCollection.keys](){return this.keys()}[O.ReadonlyKeyedMultiCollection.values](){return this.values()}[O.KeyedMultiCollection.add](g,C){this.add(g,C)}[O.KeyedMultiCollection.delete](g){return this.delete(g)}[O.KeyedMultiCollection.deleteValue](g,C){return this.deleteValue(g,C)}[O.KeyedMultiCollection.clear](){this.clear()}}D.MultiMap=f,Object.defineProperty(f,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"MultiMap"})},5027:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.SortedMap=void 0;const E=p(1344),S=p(4045),O=p(8270),w=p(839);class R{constructor(...y){let m,T;if(this._keys=[],this._values=[],y.length>0){const g=y[0];E.isIterable(g)||void 0===g?(m=g,y.length>1&&(T=y[1])):T=g}if(void 0===T&&(T=w.Comparer.defaultComparer),this._comparer="function"==typeof T?w.Comparer.create(T):T,m)for(const[g,C]of m)this.set(g,C)}get comparer(){return this._comparer}get size(){return this._keys.length}has(y){return S.binarySearch(this._keys,y,this._comparer)>=0}get(y){const m=S.binarySearch(this._keys,y,this._comparer);return m>=0?this._values[m]:void 0}set(y,m){const T=S.binarySearch(this._keys,y,this._comparer);return T>=0?this._values[T]=m:(this._keys.splice(~T,0,y),this._values.splice(~T,0,m)),this}delete(y){const m=S.binarySearch(this._keys,y,this._comparer);return m>=0&&(this._keys.splice(m,1),this._values.splice(m,1),!0)}clear(){this._keys.length=0,this._values.length=0}keys(){return this._keys.values()}values(){return this._values.values()}*entries(){for(let y=0;y<this._keys.length;y++)yield[this._keys[y],this._values[y]]}[Symbol.iterator](){return this.entries()}forEach(y,m){for(const[T,g]of this)y.call(m,g,T,this)}get[O.KeyedCollection.size](){return this.size}[O.KeyedCollection.has](y){return this.has(y)}[O.KeyedCollection.get](y){return this.get(y)}[O.KeyedCollection.set](y,m){this.set(y,m)}[O.KeyedCollection.delete](y){return this.delete(y)}[O.KeyedCollection.clear](){this.clear()}[O.KeyedCollection.keys](){return this.keys()}[O.KeyedCollection.values](){return this.values()}}D.SortedMap=R,Object.defineProperty(R,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"SortedMap"})},4027:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.SortedSet=void 0;const E=p(4045),S=p(1344),O=p(8270),w=p(839);class R{constructor(...y){let m,T;if(this._values=[],y.length>0){const g=y[0];S.isIterable(g)||void 0===g?(m=g,y.length>1&&(T=y[1])):T=g}if(void 0===T&&(T=w.Comparer.defaultComparer),this._comparer="function"==typeof T?w.Comparer.create(T):T,m)for(const g of m)this.add(g)}get comparer(){return this._comparer}get size(){return this._values.length}has(y){return E.binarySearch(this._values,y,this._comparer)>=0}add(y){const m=E.binarySearch(this._values,y,this._comparer);return m>=0?this._values[m]=y:this._values.splice(~m,0,y),this}delete(y){const m=E.binarySearch(this._values,y,this._comparer);return m>=0&&(this._values.splice(m,1),!0)}clear(){this._values.length=0}keys(){return this._values.values()}values(){return this._values.values()}*entries(){for(let y=0;y<this._values.length;y++)yield[this._values[y],this._values[y]]}[Symbol.iterator](){return this.values()}forEach(y,m){for(const T of this)y.call(m,T,T,this)}get[O.Collection.size](){return this.size}[O.Collection.has](y){return this.has(y)}[O.Collection.add](y){this.add(y)}[O.Collection.delete](y){return this.delete(y)}[O.Collection.clear](){this.clear()}}D.SortedSet=R,Object.defineProperty(R,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"SortedSet"})},2243:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});const E=p(655);E.__exportStar(p(5027),D),E.__exportStar(p(4027),D),E.__exportStar(p(8090),D),E.__exportStar(p(6471),D),E.__exportStar(p(6207),D),E.__exportStar(p(6289),D)},839:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.rawHash=D.tupleStructuralComparer=D.tupleComparer=D.structuralComparer=D.defaultComparer=D.Comparer=D.combineHashes=D.tupleStructuralEqualer=D.tupleEqualer=D.structuralEqualer=D.defaultEqualer=D.Equaler=D.StructuralComparable=D.StructuralEquatable=D.Comparable=D.Equatable=void 0;const E=p(7354);var S,O,w,R,f,y;function T(g){let C=!1;return()=>{C||(C=!0,"object"==typeof process&&process.emitWarning?process.emitWarning(g,"Deprecation"):"object"==typeof console&&console.warn(`Deprecation: ${g}`))}}(function(g){function C(v){let P;return null!=v&&g.equals in(P=Object(v))&&g.hash in P}g.equals=Symbol.for("@esfx/equatable:Equatable.equals"),g.hash=Symbol.for("@esfx/equatable:Equatable.hash"),g.name="Equatable",g.hasInstance=C,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:C})})(S=D.Equatable||(D.Equatable={})),function(g){const C=T("Use 'Equatable.hasInstance' instead.");g.isEquatable=function v(P){return C(),g.hasInstance(P)}}(S=D.Equatable||(D.Equatable={})),function(g){function C(v){return null!=v&&g.compareTo in Object(v)}g.compareTo=Symbol.for("@esfx/equatable:Comparable.compareTo"),g.name="Comparable",g.hasInstance=C,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:C})}(O=D.Comparable||(D.Comparable={})),function(g){const C=T("Use 'Comparable.hasInstance' instead.");g.isComparable=function v(P){return C(),g.hasInstance(P)}}(O=D.Comparable||(D.Comparable={})),function(g){function C(v){let P;return null!=v&&g.structuralEquals in(P=Object(v))&&g.structuralHash in P}g.structuralEquals=Symbol.for("@esfx/equatable:StructualEquatable.structuralEquals"),g.structuralHash=Symbol.for("@esfx/equatable:StructuralEquatable.structuralHash"),g.name="StructuralEquatable",g.hasInstance=C,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:C})}(w=D.StructuralEquatable||(D.StructuralEquatable={})),function(g){const C=T("Use 'StructuralEquatable.hasInstance' instead.");g.isStructuralEquatable=function v(P){return C(),g.hasInstance(P)}}(w=D.StructuralEquatable||(D.StructuralEquatable={})),function(g){function C(v){return null!=v&&g.structuralCompareTo in Object(v)}g.structuralCompareTo=Symbol.for("@esfx/equatable:StructuralComparable.structuralCompareTo"),g.name="StructuralComparable",g.hasInstance=C,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:C})}(R=D.StructuralComparable||(D.StructuralComparable={})),function(g){const C=T("Use 'StructuralComparable.hasInstance' instead.");g.isStructuralComparable=function v(P){return C(),g.hasInstance(P)}}(R=D.StructuralComparable||(D.StructuralComparable={})),function(g){const C=Object.defineProperty({},Symbol.toStringTag,{configurable:!0,value:"Equaler"});function v(x,B=g.defaultEqualer.hash){return Object.setPrototypeOf({equals:x,hash:B},C)}function P(x,B,H=7){if("number"!=typeof x)throw new TypeError("Integer expected: x");if("number"!=typeof B)throw new TypeError("Integer expected: y");if("number"!=typeof H)throw new TypeError("Integer expected: rotate");if(isNaN(x)||!isFinite(x))throw new RangeError("Argument must be a finite number value: x");if(isNaN(B)||!isFinite(B))throw new RangeError("Argument must be a finite number value: y");if(isNaN(H)||!isFinite(H))throw new RangeError("Argument must be a finite number value: rotate");for(;H<0;)H+=32;for(;H>=32;)H-=32;return(x<<H|x>>>32-H)^B}function _(x){return"object"==typeof x&&null!==x&&"function"==typeof x.equals&&"function"==typeof x.hash}g.defaultEqualer=v((x,B)=>S.hasInstance(x)?x[S.equals](B):S.hasInstance(B)?B[S.equals](x):Object.is(x,B),x=>S.hasInstance(x)?x[S.hash]():E.hashUnknown(x)),g.structuralEqualer=v((x,B)=>w.hasInstance(x)?x[w.structuralEquals](B,g.structuralEqualer):w.hasInstance(B)?B[w.structuralEquals](x,g.structuralEqualer):g.defaultEqualer.equals(x,B),x=>w.hasInstance(x)?x[w.structuralHash](g.structuralEqualer):g.defaultEqualer.hash(x)),g.tupleEqualer=v((x,B)=>{if(!Array.isArray(x)&&null!=x||!Array.isArray(B)&&null!=B)throw new TypeError("Array expected");if(x===B)return!0;if(!x||!B||x.length!==B.length)return!1;for(let H=0;H<x.length;H++)if(!g.defaultEqualer.equals(x[H],B[H]))return!1;return!0},x=>{if(null==x)return 0;if(!Array.isArray(x))throw new TypeError("Array expected");let B=0;for(const H of x)B=P(B,g.defaultEqualer.hash(H));return B}),g.tupleStructuralEqualer=v((x,B)=>{if(!Array.isArray(x)&&null!=x||!Array.isArray(B)&&null!=B)throw new TypeError("Array expected");if(x===B)return!0;if(!x||!B||x.length!==B.length)return!1;for(let H=0;H<x.length;H++)if(!g.structuralEqualer.equals(x[H],B[H]))return!1;return!0},x=>{if(null==x)return 0;if(!Array.isArray(x))throw new TypeError("Array expected");let B=0;for(const H of x)B=P(B,g.structuralEqualer.hash(H));return B}),g.create=v,g.combineHashes=P,g.hasInstance=_,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:_})}(f=D.Equaler||(D.Equaler={})),D.defaultEqualer=f.defaultEqualer,D.structuralEqualer=f.structuralEqualer,D.tupleEqualer=f.tupleEqualer,D.tupleStructuralEqualer=f.tupleEqualer,D.combineHashes=f.combineHashes,function(g){const C=Object.defineProperty({},Symbol.toStringTag,{configurable:!0,value:"Comparer"});function v(_){return Object.setPrototypeOf({compare:_},C)}function P(_){return"object"==typeof _&&null!==_&&"function"==typeof _.compare}g.defaultComparer=v((_,x)=>O.hasInstance(_)?_[O.compareTo](x):O.hasInstance(x)?-x[O.compareTo](_):_<x?-1:_>x?1:0),g.structuralComparer=v((_,x)=>R.hasInstance(_)?_[R.structuralCompareTo](x,g.structuralComparer):R.hasInstance(x)?-x[R.structuralCompareTo](_,g.structuralComparer):g.defaultComparer.compare(_,x)),g.tupleComparer=v((_,x)=>{if(!Array.isArray(_)&&null!=_||!Array.isArray(x)&&null!=x)throw new TypeError("Array expected");let B;if(B=g.defaultComparer.compare(_.length,x.length))return B;for(let H=0;H<_.length;H++)if(B=g.defaultComparer.compare(_[H],x[H]))return B;return 0}),g.tupleStructuralComparer=v((_,x)=>{if(!Array.isArray(_)&&null!=_||!Array.isArray(x)&&null!=x)throw new TypeError("Array expected");let B;if(B=g.defaultComparer.compare(_.length,x.length))return B;for(let H=0;H<_.length;H++)if(B=g.structuralComparer.compare(_[H],x[H]))return B;return 0}),g.create=v,g.hasInstance=P,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:P})}(y=D.Comparer||(D.Comparer={})),D.defaultComparer=y.defaultComparer,D.structuralComparer=y.structuralComparer,D.tupleComparer=y.tupleComparer,D.tupleStructuralComparer=y.tupleStructuralComparer,D.rawHash=function m(g){return E.hashUnknown(g)}},7354:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.hashUnknown=void 0;const E=p(7155);let S,O,w,R,f,y;const v=new DataView(new ArrayBuffer(8)),P=E.createSeed(),_=E.createSeed(),x=E.createSeed(),B=E.createSeed(),H=E.createSeed();let K=P,V=_,ne=H,se=x,ge=B;function Ee(Oe,Ye,et){if(!Buffer.isEncoding(Ye))throw new RangeError(`Invalid encoding: ${Ye}`);return function ae(Oe,Ye){const et=Oe.buffer.slice(Oe.byteOffset,Oe.byteOffset+Oe.byteLength);return E.hash(et,Ye)}(Buffer.from(Oe,Ye),et)}function re(Oe,Ye){return(Oe<<7|Oe>>>25)^Ye}const De="function"==typeof BigInt?function ee(){const Oe=BigInt(0),Ye=BigInt(4294967295),et=BigInt(32);return function mt(kt){if(kt===Oe)return 0;let Br=kt<Oe?-1:kt>Oe?1:0;for(kt<Oe&&(kt=-kt);kt!==Oe;)Br=re(Br,Number(kt&Ye)),kt>>=et;return Br}}():function Ae(){return function Oe(Ye){return Ee(Ye.toString(),"ascii",ne)}}(),ke="description"in Symbol.prototype?Oe=>Oe.description:Oe=>{const Ye=Oe.toString();return Ye.startsWith("Symbol(")&&Ye.endsWith(")")?Ye.slice(7,-1):Ye};function Ie(Oe){let Ye=R&&R.get(Oe);return void 0===Ye&&(R||(R=new WeakMap),Ye=function Se(Oe){let Ye;return null===Oe?Ye=O||(O={next:1}):(Ye=S&&S.get(Oe),Ye||(S||(S=new WeakMap),S.set(Oe,Ye={next:1}))),Ye}(Object.getPrototypeOf(Oe)).next++,Ye=re(K,Ye),R.set(Oe,Ye)),Ye}function _e(Oe){switch(typeof Oe){case"boolean":return function ce(Oe){return Oe?1:0}(Oe);case"number":return function J(Oe){return function me(Oe){return Number.isInteger(Oe)&&Oe>=-2147483648&&Oe<=2147483647}(Oe)?Oe:function te(Oe){return Number.isInteger(Oe)&&Oe>=0&&Oe<=4294967295}(Oe)?function j(Oe){return Oe>>0}(Oe):function $(Oe){return v.setFloat64(0,Oe),v.getInt32(0,!0)^v.getInt32(4,!0)}(Oe)}(Oe);case"bigint":return De(Oe);case"string":return function Ne(Oe){return Ee(Oe,"utf8",V)}(Oe);case"symbol":return function ft(Oe){const Ye=Symbol.keyFor(Oe);return void 0!==Ye?function Le(Oe,Ye){let et=f&&f.get(Oe);return void 0===et&&(et=Ee(Ye,"utf8",ge),f||(f=new Map),f.set(Oe,et)),et}(Oe,Ye):function je(Oe){let Ye=y&&y.get(Oe);if(void 0===Ye){w||(w={next:1}),Ye=re(se,w.next++);const et=ke(Oe);et&&(Ye=Ee(et,"utf8",Ye)),y||(y=new Map),y.set(Oe,Ye)}return Ye}(Oe)}(Oe);case"function":return Ie(Oe);case"object":if(null!==Oe)return Ie(Oe);default:return 0}}var Oe;D.hashUnknown=_e,(Oe=_e=D.hashUnknown||(D.hashUnknown={})).getState=function Ye(){return{weakPrototypeCounters:S,nullPrototypeCounter:O,localSymbolCounter:w,weakObjectHashes:R,globalSymbolHashes:f,localSymbolHashes:y,objectSeed:K,stringSeed:V,bigIntSeed:ne,localSymbolSeed:se,globalSymbolSeed:ge}},Oe.setState=function et(mt){({weakPrototypeCounters:S,nullPrototypeCounter:O,localSymbolCounter:w,weakObjectHashes:R,globalSymbolHashes:f,localSymbolHashes:y,objectSeed:K=P,stringSeed:V=_,bigIntSeed:ne=H,localSymbolSeed:se=x,globalSymbolSeed:ge=B}=mt)}},7155:(L,D)=>{"use strict";function p(){return 4294967295*Math.random()>>>0}Object.defineProperty(D,"__esModule",{value:!0}),D.hash=D.defaultSeed=D.createSeed=void 0,D.createSeed=p,D.defaultSeed=p();const E=3432918353,S=461845907;D.hash=function w(R,f){const y=new DataView(R);let g,m=f>>>0,T=0;for(;T<y.byteLength-4;)g=y.getUint32(T,!0),g*=E,g=g<<15|g>>>17,g*=S,m^=g,m=m<<13|m>>>19,m=5*m+3864292196,T+=4;if(T<y.byteLength){switch(g=0,y.byteLength-T){case 3:g|=y.getUint8(T+2)<<16;case 2:g|=y.getUint8(T+1)<<8;case 1:g|=y.getUint8(T+0)<<0}g*=E,g=g<<15|g>>>17,g*=S,m^=g}return m^=y.byteLength,m^=m>>>16,m*=2246822507,m^=m>>>13,m*=3266489909,m^=m>>>16,m}},4045:(L,D)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.binarySearch=void 0,D.binarySearch=function p(E,S,O){if(0===E.length)return-1;let w=0,R=E.length-1;for(;w<=R;){const f=w+(R-w>>1);switch(Math.sign(O.compare(E[f],S))){case-1:w=f+1;break;case 0:return f;case 1:R=f-1}}return~w}},1301:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.forEachEntry=D.iterateEntries=D.selectEntryEntry=D.selectEntryValue=D.selectEntryKey=D.trimExcessEntries=D.ensureCapacity=D.clearEntries=D.deleteEntry=D.insertEntry=D.findEntryValue=D.findEntryIndex=D.resizeHashData=D.initializeHashData=D.createHashData=D.createHashEntry=void 0;const E=p(502),S=2**31-1;function R(V,ne){const se=E.getPrime(ne);return V.freeList=-1,V.buckets=new Int32Array(se),V.entries=new Array(se),se}function f(V,ne){const se=V.size,ge=new Int32Array(ne),ce=V.entries?V.entries.slice():[];ce.length=ne;for(let me=0;me<se;me++){const Q=ce[me];if(Q&&Q.hashCode>=0){const te=Q.hashCode%ne;Q.next=ge[te]-1,ge[te]=me+1}}V.buckets=ge,V.entries=ce}function y(V,ne){let se=-1;const{buckets:ge,entries:ce,equaler:me}=V;if(ge&&ce){let Q=me.hash(ne)&S;for(se=ge[Q%ge.length]-1;se>>>0<ce.length&&(ce[se].hashCode!==Q||!me.equals(ce[se].key,ne));)se=ce[se].next}return se}D.createHashEntry=function O(){return{prevEntry:void 0,nextEntry:void 0,skipNextEntry:!1,next:0,hashCode:0,key:void 0,value:void 0}},D.createHashData=function w(V,ne){const se={prevEntry:void 0,nextEntry:void 0,skipNextEntry:!1,next:0,hashCode:0,key:void 0,value:void 0},ge={buckets:void 0,entries:void 0,freeSize:0,freeList:0,size:0,equaler:V,head:se,tail:se};return R(ge,ne),ge},D.initializeHashData=R,D.resizeHashData=f,D.findEntryIndex=y,D.findEntryValue=function m(V,ne){const se=y(V,ne);return se>=0?V.entries[se].value:void 0},D.insertEntry=function T(V,ne,se){if(V.buckets||R(V,0),!V.buckets||!V.entries)throw new Error;const ge=V.equaler.hash(ne)&S;let ce=ge%V.buckets.length,me=V.buckets[ce]-1;for(;me>>>0<V.entries.length;){const J=V.entries[me];if(J.hashCode===ge&&V.equaler.equals(J.key,ne))return void(J.value=se);me=J.next}let te,Q=!1;if(V.freeSize>0)te=V.freeList,Q=!0,V.freeSize--;else{const J=V.size;if(J===V.entries.length){if(f(V,E.expandPrime(V.size)),!V.buckets||!V.entries)throw new Error;ce=ge%V.buckets.length}te=J,V.size=J+1}const j=V.entries[te]||(V.entries[te]={prevEntry:void 0,nextEntry:void 0,skipNextEntry:!1,next:0,hashCode:0,key:void 0,value:void 0});Q&&(V.freeList=j.next),j.hashCode=ge,j.next=V.buckets[ce]-1,j.key=ne,j.value=se,j.skipNextEntry=!1;const $=V.tail;$.nextEntry=j,j.prevEntry=$,V.tail=j,V.buckets[ce]=te+1},D.deleteEntry=function g(V,ne){if(V.buckets&&V.entries){const se=V.equaler.hash(ne)&S,ge=se%V.buckets.length;let me,ce=-1;for(let Q=V.buckets[ge]-1;Q>=0;Q=me.next){if(me=V.entries[Q],me.hashCode===se&&V.equaler.equals(me.key,ne)){ce<0?V.buckets[ge]=me.next+1:V.entries[ce].next=me.next;const te=me.prevEntry;return te.nextEntry=me.nextEntry,te.nextEntry&&(te.nextEntry.prevEntry=te),V.tail===me&&(V.tail=te),me.hashCode=-1,me.next=V.freeList,me.key=void 0,me.value=void 0,me.prevEntry=void 0,me.nextEntry=te,me.skipNextEntry=!0,V.freeList=Q,V.freeSize++,!0}ce=Q}}return!1},D.clearEntries=function C(V){if(V.size>0){V.buckets&&V.buckets.fill(0),V.entries&&V.entries.fill(void 0);let se=V.head.nextEntry;for(;se;){const ge=se.nextEntry;se.prevEntry=void 0,se.nextEntry=V.head,se.skipNextEntry=!0,se=ge}V.head.nextEntry=void 0,V.tail=V.head,V.size=0,V.freeList=-1,V.freeSize=0}},D.ensureCapacity=function v(V,ne){if(ne<0)throw new RangeError;const se=V.entries?V.entries.length:0;if(se>=ne)return se;if(!V.buckets)return R(V,ne);const ge=E.getPrime(ne);return f(V,E.getPrime(ne)),ge},D.trimExcessEntries=function P(V,ne=V.size-V.freeSize){if(ne<V.size)throw new RangeError;if(!V.buckets||!V.entries)return;const se=E.getPrime(ne),ge=V.entries;if(se>=(ge?ge.length:0))return;const ce=V.size;if(R(V,se),!V.buckets||!V.entries)throw new Error;let me=0;for(let Q=0;Q<ce;Q++){const te=ge[Q].hashCode;if(te>=0){const j=te%se;V.entries[me]=ge[Q],V.entries[me].next=V.buckets[j]-1,V.buckets[j]=me+1,me++}}V.size=me,V.freeSize=0},D.selectEntryKey=function _(V){return V.key},D.selectEntryValue=function x(V){return V.value},D.selectEntryEntry=function B(V){return[V.key,V.value]},D.iterateEntries=function*H(V,ne){let se=V;for(;se;){const ge=se.skipNextEntry;se=se.nextEntry,!ge&&se&&(yield ne(se))}},D.forEachEntry=function K(V,ne,se,ge){let ce=ne;for(;ce;){const me=ce.skipNextEntry;ce=ce.nextEntry,!me&&ce&&se.call(ge,ce.value,ce.key,V)}}},502:(L,D)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.expandPrime=D.getPrime=D.isPrime=void 0;const E=2146435069,O=[3,7,11,17,23,29,37,47,59,71,89,107,131,163,197,239,293,353,431,521,631,761,919,1103,1327,1597,1931,2333,2801,3371,4049,4861,5839,7013,8419,10103,12143,14591,17519,21023,25229,30293,36353,43627,52361,62851,75431,90523,108631,130363,156437,187751,225307,270371,324449,389357,467237,560689,672827,807403,968897,1162687,1395263,1674319,2009191,2411033,2893249,3471899,4166287,4999559,5999471,7199369];function w(y){if(1&y){const m=0|Math.sqrt(y);for(let T=3;T<=m;T+=2)if(!(y%T))return!1;return!0}return 2===y}function R(y){if(y<0)throw new RangeError;for(let m=0;m<O.length;m++){const T=O[m];if(T>=y)return T}for(let m=1|y;m<2147483647;m+=2)if(w(m)&&(m-1)%101)return m;return y}D.isPrime=w,D.getPrime=R,D.expandPrime=function f(y){const m=2*y;return m>E&&E>y?E:R(m)}},9440:(L,D,p)=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0}),D.deprecateProperty=D.deprecate=void 0;const O=function E(){try{return p(Object(function(){var m=new Error("Cannot find module 'util'");throw m.code="MODULE_NOT_FOUND",m}())).deprecate}catch(f){}}()||function S(){const f="object"==typeof process&&"function"==typeof process.emitWarning?function y(m,T="Warning",g=y){process.emitWarning(m,T,g)}:"function"==typeof Error.captureStackTrace?function y(m,T="Warning",g=y){"string"==typeof m&&((m=new Error(m)).name=T),Error.captureStackTrace(m,g),console.warn(m)}:function(m,T="Warning"){"string"==typeof m?console.warn(`${T}:`,m):console.warn(m)};return(y,m)=>{let T=!1;function g(...C){return T||(T=!0,f(m,"DeprecationWarning",y)),new.target?Reflect.construct(y,C,new.target):y.apply(this,C)}return Object.setPrototypeOf(g,y),y.prototype&&(g.prototype=y.prototype),g}}();function w(f,y){return O(f,y)}D.deprecate=w,D.deprecateProperty=function R(f,y,m){let T=Object.getOwnPropertyDescriptor(f,y);if(T&&T.configurable){let g=!1;T.get&&(T.get=w(T.get,m),g=!0),T.set&&(T.set=w(T.set,m),g=!0),"function"==typeof T.value&&(T.value=w(T.value,m),g=!0),g&&Object.defineProperty(f,y,T)}return f}},1344:(L,D)=>{"use strict";function p(_){return"function"==typeof _}function E(_){return"function"==typeof _||void 0===_}function S(_){return"object"==typeof _&&null!==_||"function"==typeof _}function w(_){return null==_}Object.defineProperty(D,"__esModule",{value:!0}),D.isPrimitive=D.isPropertyKey=D.isString=D.isBoolean=D.isNumber=D.isIterator=D.isAsyncIterable=D.isIterable=D.isDefined=D.isMissing=D.isInstance=D.isObject=D.isFunctionOrUndefined=D.isFunction=void 0,D.isFunction=p,D.isFunctionOrUndefined=E,D.isObject=S,D.isInstance=function O(_,x){return!w(_)&&_ instanceof x},D.isMissing=w,D.isDefined=function R(_){return null!=_},D.isIterable=function f(_){return null!=_&&Symbol.iterator in Object(_)},D.isAsyncIterable=function y(_){return null!=_&&Symbol.asyncIterator in Object(_)},D.isIterator=function m(_){return S(_)&&p(_.next)&&E(_.throw)&&E(_.return)&&E(_[Symbol.iterator])},D.isNumber=function T(_){return"number"==typeof _},D.isBoolean=function g(_){return"boolean"==typeof _},D.isString=function C(_){return"string"==typeof _},D.isPropertyKey=function v(_){return"string"==typeof _||"symbol"==typeof _||"number"==typeof _},D.isPrimitive=function P(_){return"function"!=typeof _&&("object"!=typeof _||null===_)}}},L=>{L(L.s=6965)}]);