(self.webpackChunkmsagl=self.webpackChunkmsagl||[]).push([[179],{6070:(_,I,h)=>{"use strict";var p={};h.r(p),h.d(p,{forceCenter:()=>h8,forceCollide:()=>q0,forceLink:()=>tN,forceManyBody:()=>iN,forceRadial:()=>k8,forceSimulation:()=>nN,forceX:()=>V8,forceY:()=>G8});var T={};h.r(T),h.d(T,{dispatch:()=>bw});var C={};function v(i){return"function"==typeof i}function E(i){const t=i(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}h.r(C),h.d(C,{interval:()=>Y8,now:()=>cc,timeout:()=>Rw,timer:()=>og,timerFlush:()=>c0});const b=E(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function d(i,e){if(i){const t=i.indexOf(e);0<=t&&i.splice(t,1)}}class f{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(v(n))try{n()}catch(s){e=s instanceof b?s.errors:[s]}const{_teardowns:r}=this;if(r){this._teardowns=null;for(const s of r)try{w(s)}catch(o){e=null!=e?e:[],o instanceof b?e=[...e,...o.errors]:e.push(o)}}if(e)throw new b(e)}}add(e){var t;if(e&&e!==this)if(this.closed)w(e);else{if(e instanceof f){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(t=this._teardowns)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&d(t,e)}remove(e){const{_teardowns:t}=this;t&&d(t,e),e instanceof f&&e._removeParent(this)}}f.EMPTY=(()=>{const i=new f;return i.closed=!0,i})();const S=f.EMPTY;function g(i){return i instanceof f||i&&"closed"in i&&v(i.remove)&&v(i.add)&&v(i.unsubscribe)}function w(i){v(i)?i():i.unsubscribe()}const m={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},O={setTimeout(...i){const{delegate:e}=O;return((null==e?void 0:e.setTimeout)||setTimeout)(...i)},clearTimeout(i){const{delegate:e}=O;return((null==e?void 0:e.clearTimeout)||clearTimeout)(i)},delegate:void 0};function P(i){O.setTimeout(()=>{const{onUnhandledError:e}=m;if(!e)throw i;e(i)})}function N(){}const M=F("C",void 0,void 0);function F(i,e,t){return{kind:i,value:e,error:t}}let $=null;function Q(i){if(m.useDeprecatedSynchronousErrorHandling){const e=!$;if(e&&($={errorThrown:!1,error:null}),i(),e){const{errorThrown:t,error:n}=$;if($=null,t)throw n}}else i()}class ee extends f{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,g(e)&&e.add(this)):this.destination=G}static create(e,t,n){return new re(e,t,n)}next(e){this.isStopped?V(function Y(i){return F("N",i,void 0)}(e),this):this._next(e)}error(e){this.isStopped?V(function B(i){return F("E",void 0,i)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?V(M,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class re extends ee{constructor(e,t,n){let r;if(super(),v(e))r=e;else if(e){let s;({next:r,error:t,complete:n}=e),this&&m.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe()):s=e,r=null==r?void 0:r.bind(s),t=null==t?void 0:t.bind(s),n=null==n?void 0:n.bind(s)}this.destination={next:r?U(r):N,error:U(null!=t?t:j),complete:n?U(n):N}}}function U(i,e){return(...t)=>{try{i(...t)}catch(n){m.useDeprecatedSynchronousErrorHandling?function ie(i){m.useDeprecatedSynchronousErrorHandling&&$&&($.errorThrown=!0,$.error=i)}(n):P(n)}}}function j(i){throw i}function V(i,e){const{onStoppedNotification:t}=m;t&&O.setTimeout(()=>t(i,e))}const G={closed:!0,next:N,error:j,complete:N},H="function"==typeof Symbol&&Symbol.observable||"@@observable";function J(i){return i}let K=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){const s=function pe(i){return i&&i instanceof ee||function ge(i){return i&&v(i.next)&&v(i.error)&&v(i.complete)}(i)&&g(i)}(t)?t:new re(t,n,r);return Q(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=le(n))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),null==o||o.unsubscribe()}},s,r)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[H](){return this}pipe(...t){return function z(i){return 0===i.length?J:1===i.length?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}(t)(this)}toPromise(t){return new(t=le(t))((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function le(i){var e;return null!==(e=null!=i?i:m.Promise)&&void 0!==e?e:Promise}const ye=E(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ee=(()=>{class i extends K{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new be(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new ye}next(t){Q(()=>{if(this._throwIfClosed(),!this.isStopped){const n=this.observers.slice();for(const r of n)r.next(t)}})}error(t){Q(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){Q(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:r,observers:s}=this;return n||r?S:(s.push(t),new f(()=>d(s,t)))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){const t=new K;return t.source=this,t}}return i.create=(e,t)=>new be(e,t),i})();class be extends Ee{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:S}}function Me(i){return v(null==i?void 0:i.lift)}function ae(i){return e=>{if(Me(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}class he extends ee{constructor(e,t,n,r,s){super(e),this.onFinalize=s,this._next=t?function(o){try{t(o)}catch(a){e.error(a)}}:super._next,this._error=r?function(o){try{r(o)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(o){e.error(o)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function de(i,e){return ae((t,n)=>{let r=0;t.subscribe(new he(n,s=>{n.next(i.call(e,s,r++))}))})}function Zt(i){return this instanceof Zt?(this.v=i,this):new Zt(i)}function Ga(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=t.apply(i,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(R){n[R]&&(r[R]=function(D){return new Promise(function(L,k){s.push([R,D,L,k])>1||a(R,D)})})}function a(R,D){try{!function l(R){R.value instanceof Zt?Promise.resolve(R.value.v).then(c,u):y(s[0][2],R)}(n[R](D))}catch(L){y(s[0][3],L)}}function c(R){a("next",R)}function u(R){a("throw",R)}function y(R,D){R(D),s.shift(),s.length&&a(s[0][0],s[0][1])}}function zg(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=i[Symbol.asyncIterator];return e?e.call(i):(i=function xs(i){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=i[s](o)).done,o.value)})}}}const hr=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function os(i){return v(null==i?void 0:i.then)}function xv(i){return v(i[H])}function Lv(i){return Symbol.asyncIterator&&v(null==i?void 0:i[Symbol.asyncIterator])}function Mv(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Fv=function J_(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Bv(i){return v(null==i?void 0:i[Fv])}function kv(i){return Ga(this,arguments,function*(){const t=i.getReader();try{for(;;){const{value:n,done:r}=yield Zt(t.read());if(r)return yield Zt(void 0);yield yield Zt(n)}}finally{t.releaseLock()}})}function Vv(i){return v(null==i?void 0:i.getReader)}function Bi(i){if(i instanceof K)return i;if(null!=i){if(xv(i))return function q_(i){return new K(e=>{const t=i[H]();if(v(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(hr(i))return function Q_(i){return new K(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}(i);if(os(i))return function X_(i){return new K(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,P)})}(i);if(Lv(i))return Gv(i);if(Bv(i))return function Z_(i){return new K(e=>{for(const t of i)if(e.next(t),e.closed)return;e.complete()})}(i);if(Vv(i))return function eD(i){return Gv(kv(i))}(i)}throw Mv(i)}function Gv(i){return new K(e=>{(function tD(i,e){var t,n,r,s;return function xn(i,e,t,n){return new(t||(t=Promise))(function(s,o){function a(u){try{c(n.next(u))}catch(y){o(y)}}function l(u){try{c(n.throw(u))}catch(y){o(y)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((n=n.apply(i,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=zg(i);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(i,e).catch(t=>e.error(t))})}function Ms(i,e,t,n=0,r=!1){const s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function yn(i,e,t=1/0){return v(e)?yn((n,r)=>de((s,o)=>e(n,s,r,o))(Bi(i(n,r))),t):("number"==typeof e&&(t=e),ae((n,r)=>function nD(i,e,t,n,r,s,o,a){const l=[];let c=0,u=0,y=!1;const R=()=>{y&&!l.length&&!c&&e.complete()},D=k=>c<n?L(k):l.push(k),L=k=>{s&&e.next(k),c++;let W=!1;Bi(t(k,u++)).subscribe(new he(e,X=>{null==r||r(X),s?D(X):e.next(X)},()=>{W=!0},void 0,()=>{if(W)try{for(c--;l.length&&c<n;){const X=l.shift();o?Ms(e,o,()=>L(X)):L(X)}R()}catch(X){e.error(X)}}))};return i.subscribe(new he(e,D,()=>{y=!0,R()})),()=>{null==a||a()}}(n,r,i,t)))}function Pc(i=1/0){return yn(J,i)}const Fs=new K(i=>i.complete());function Hv(i){return i&&v(i.schedule)}function Qg(i){return i[i.length-1]}function Yv(i){return v(Qg(i))?i.pop():void 0}function Nc(i){return Hv(Qg(i))?i.pop():void 0}function Uv(i,e=0){return ae((t,n)=>{t.subscribe(new he(n,r=>Ms(n,i,()=>n.next(r),e),()=>Ms(n,i,()=>n.complete(),e),r=>Ms(n,i,()=>n.error(r),e)))})}function Wv(i,e=0){return ae((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function jv(i,e){if(!i)throw new Error("Iterable cannot be null");return new K(t=>{Ms(t,e,()=>{const n=i[Symbol.asyncIterator]();Ms(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function zn(i,e){return e?function uD(i,e){if(null!=i){if(xv(i))return function sD(i,e){return Bi(i).pipe(Wv(e),Uv(e))}(i,e);if(hr(i))return function aD(i,e){return new K(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}(i,e);if(os(i))return function oD(i,e){return Bi(i).pipe(Wv(e),Uv(e))}(i,e);if(Lv(i))return jv(i,e);if(Bv(i))return function lD(i,e){return new K(t=>{let n;return Ms(t,e,()=>{n=i[Fv](),Ms(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>v(null==n?void 0:n.return)&&n.return()})}(i,e);if(Vv(i))return function cD(i,e){return jv(kv(i),e)}(i,e)}throw Mv(i)}(i,e):Bi(i)}function zv(...i){const e=Nc(i),t=function rD(i,e){return"number"==typeof Qg(i)?i.pop():e}(i,1/0),n=i;return n.length?1===n.length?Bi(n[0]):Pc(t)(zn(n,e)):Fs}function Dr(i){return i<=0?()=>Fs:ae((e,t)=>{let n=0;e.subscribe(new he(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function Kv(i={}){const{connector:e=(()=>new Ee),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o=null,a=null,l=null,c=0,u=!1,y=!1;const R=()=>{null==a||a.unsubscribe(),a=null},D=()=>{R(),o=l=null,u=y=!1},L=()=>{const k=o;D(),null==k||k.unsubscribe()};return ae((k,W)=>{c++,!y&&!u&&R();const X=l=null!=l?l:e();W.add(()=>{c--,0===c&&!y&&!u&&(a=Xg(L,r))}),X.subscribe(W),o||(o=new re({next:ne=>X.next(ne),error:ne=>{y=!0,R(),a=Xg(D,t,ne),X.error(ne)},complete:()=>{u=!0,R(),a=Xg(D,n),X.complete()}}),zn(k).subscribe(o))})(s)}}function Xg(i,e,...t){return!0===e?(i(),null):!1===e?null:e(...t).pipe(Dr(1)).subscribe(()=>i())}function xt(i){for(let e in i)if(i[e]===xt)return e;throw Error("Could not find renamed property on target object.")}function Zg(i,e){for(const t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function Pt(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Pt).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const e=i.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function ep(i,e){return null==i||""===i?null===e?"":e:null==e||""===e?i:i+" "+e}const hD=xt({__forward_ref__:xt});function _c(i){return i.__forward_ref__=_c,i.toString=function(){return Pt(this())},i}function nt(i){return $v(i)?i():i}function $v(i){return"function"==typeof i&&i.hasOwnProperty(hD)&&i.__forward_ref__===_c}class Le extends Error{constructor(e,t){super(function tp(i,e){return`NG0${Math.abs(i)}${e?": "+e:""}`}(e,t)),this.code=e}}function Xe(i){return"string"==typeof i?i:null==i?"":String(i)}function gi(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Xe(i)}function _h(i,e){const t=e?` in ${e}`:"";throw new Le(-201,`No provider for ${gi(i)} found${t}`)}function Vi(i,e){null==i&&function Ut(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,i,null,"!=")}function Fe(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function on(i){return{providers:i.providers||[],imports:i.imports||[]}}function np(i){return Jv(i,Dh)||Jv(i,Qv)}function Jv(i,e){return i.hasOwnProperty(e)?i[e]:null}function qv(i){return i&&(i.hasOwnProperty(ip)||i.hasOwnProperty(ED))?i[ip]:null}const Dh=xt({\u0275prov:xt}),ip=xt({\u0275inj:xt}),Qv=xt({ngInjectableDef:xt}),ED=xt({ngInjectorDef:xt});var Qe=(()=>((Qe=Qe||{})[Qe.Default=0]="Default",Qe[Qe.Host=1]="Host",Qe[Qe.Self=2]="Self",Qe[Qe.SkipSelf=4]="SkipSelf",Qe[Qe.Optional=8]="Optional",Qe))();let rp;function ho(i){const e=rp;return rp=i,e}function Xv(i,e,t){const n=np(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&Qe.Optional?null:void 0!==e?e:void _h(Pt(i),"Injector")}function fo(i){return{toString:i}.toString()}var xr=(()=>((xr=xr||{})[xr.OnPush=0]="OnPush",xr[xr.Default=1]="Default",xr))(),Lr=(()=>{return(i=Lr||(Lr={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Lr;var i})();const vD="undefined"!=typeof globalThis&&globalThis,SD="undefined"!=typeof window&&window,AD="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,_t=vD||"undefined"!=typeof global&&global||SD||AD,Ha={},Lt=[],xh=xt({\u0275cmp:xt}),sp=xt({\u0275dir:xt}),Lh=xt({\u0275pipe:xt}),Zv=xt({\u0275mod:xt}),ks=xt({\u0275fac:xt}),Dc=xt({__NG_ELEMENT_ID__:xt});let bD=0;function En(i){return fo(()=>{const t={},n={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===xr.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||Lt,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Lr.Emulated,id:"c",styles:i.styles||Lt,_:null,setInput:null,schemas:i.schemas||null,tView:null},r=i.directives,s=i.features,o=i.pipes;return n.id+=bD++,n.inputs=iS(i.inputs,t),n.outputs=iS(i.outputs),s&&s.forEach(a=>a(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(eS):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map(tS):null,n})}function eS(i){return Qn(i)||function go(i){return i[sp]||null}(i)}function tS(i){return function Qo(i){return i[Lh]||null}(i)}const nS={};function wn(i){return fo(()=>{const e={type:i.type,bootstrap:i.bootstrap||Lt,declarations:i.declarations||Lt,imports:i.imports||Lt,exports:i.exports||Lt,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(nS[i.id]=i.type),e})}function iS(i,e){if(null==i)return Ha;const t={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=n,e&&(e[r]=s)}return t}const an=En;function Qn(i){return i[xh]||null}function dr(i,e){const t=i[Zv]||null;if(!t&&!0===e)throw new Error(`Type ${Pt(i)} does not have '\u0275mod' property.`);return t}function as(i){return Array.isArray(i)&&"object"==typeof i[1]}function Fr(i){return Array.isArray(i)&&!0===i[1]}function lp(i){return 0!=(8&i.flags)}function kh(i){return 2==(2&i.flags)}function Vh(i){return 1==(1&i.flags)}function Br(i){return null!==i.template}function PD(i){return 0!=(512&i[2])}function ta(i,e){return i.hasOwnProperty(ks)?i[ks]:null}class DD{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function po(){return sS}function sS(i){return i.type.prototype.ngOnChanges&&(i.setInput=LD),xD}function xD(){const i=aS(this),e=null==i?void 0:i.current;if(e){const t=i.previous;if(t===Ha)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function LD(i,e,t,n){const r=aS(i)||function MD(i,e){return i[oS]=e}(i,{previous:Ha,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new DD(l&&l.currentValue,e,o===Ha),i[n]=e}po.ngInherit=!0;const oS="__ngSimpleChanges__";function aS(i){return i[oS]||null}let fp;function en(i){return!!i.listen}const lS={createRenderer:(i,e)=>function gp(){return void 0!==fp?fp:"undefined"!=typeof document?document:void 0}()};function vn(i){for(;Array.isArray(i);)i=i[0];return i}function Gh(i,e){return vn(e[i])}function pr(i,e){return vn(e[i.index])}function pp(i,e){return i.data[e]}function Hi(i,e){const t=e[i];return as(t)?t:t[0]}function cS(i){return 4==(4&i[2])}function mp(i){return 128==(128&i[2])}function mo(i,e){return null==e?null:i[e]}function uS(i){i[18]=0}function yp(i,e){i[5]+=e;let t=i,n=i[3];for(;null!==n&&(1===e&&1===t[5]||-1===e&&0===t[5]);)n[5]+=e,t=n,n=n[3]}const $e={lFrame:ES(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function hS(){return $e.bindingsEnabled}function ve(){return $e.lFrame.lView}function yt(){return $e.lFrame.tView}function mr(i){return $e.lFrame.contextLView=i,i[8]}function Tn(){let i=dS();for(;null!==i&&64===i.type;)i=i.parent;return i}function dS(){return $e.lFrame.currentTNode}function ls(i,e){const t=$e.lFrame;t.currentTNode=i,t.isParent=e}function Ep(){return $e.lFrame.isParent}function wp(){$e.lFrame.isParent=!1}function Hh(){return $e.isInCheckNoChangesMode}function Yh(i){$e.isInCheckNoChangesMode=i}function Ka(){return $e.lFrame.bindingIndex++}function XD(i,e){const t=$e.lFrame;t.bindingIndex=t.bindingRootIndex=i,vp(e)}function vp(i){$e.lFrame.currentDirectiveIndex=i}function Sp(i){const e=$e.lFrame.currentDirectiveIndex;return-1===e?null:i[e]}function pS(){return $e.lFrame.currentQueryIndex}function Ap(i){$e.lFrame.currentQueryIndex=i}function ex(i){const e=i[1];return 2===e.type?e.declTNode:1===e.type?i[6]:null}function mS(i,e,t){if(t&Qe.SkipSelf){let r=e,s=i;for(;!(r=r.parent,null!==r||t&Qe.Host||(r=ex(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,i=s}const n=$e.lFrame=yS();return n.currentTNode=e,n.lView=i,!0}function Uh(i){const e=yS(),t=i[1];$e.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function yS(){const i=$e.lFrame,e=null===i?null:i.child;return null===e?ES(i):e}function ES(i){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=e),e}function wS(){const i=$e.lFrame;return $e.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const vS=wS;function Wh(){const i=wS();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function mi(){return $e.lFrame.selectedIndex}function yo(i){$e.lFrame.selectedIndex=i}function tn(){const i=$e.lFrame;return pp(i.tView,i.selectedIndex)}function cn(){$e.lFrame.currentNamespace="svg"}function jh(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(i.contentHooks||(i.contentHooks=[])).push(-t,o),a&&((i.contentHooks||(i.contentHooks=[])).push(t,a),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(t,a)),l&&(i.viewHooks||(i.viewHooks=[])).push(-t,l),c&&((i.viewHooks||(i.viewHooks=[])).push(t,c),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(t,c)),null!=u&&(i.destroyHooks||(i.destroyHooks=[])).push(t,u)}}function zh(i,e,t){SS(i,e,3,t)}function Kh(i,e,t,n){(3&i[2])===t&&SS(i,e,t,n)}function bp(i,e){let t=i[2];(3&t)===e&&(t&=2047,t+=1,i[2]=t)}function SS(i,e,t,n){const s=null!=n?n:-1,o=e.length-1;let a=0;for(let l=void 0!==n?65535&i[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=n&&a>=n)break}else e[l]<0&&(i[18]+=65536),(a<s||-1==s)&&(lx(i,t,e,l),i[18]=(4294901760&i[18])+l+2),l++}function lx(i,e,t,n){const r=t[n]<0,s=t[n+1],a=i[r?-t[n]:t[n]];if(r){if(i[2]>>11<i[18]>>16&&(3&i[2])===e){i[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Bc{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function $h(i,e,t){const n=en(i);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];n?i.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];Rp(o)?n&&i.setProperty(e,o,a):n?i.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function AS(i){return 3===i||4===i||6===i}function Rp(i){return 64===i.charCodeAt(0)}function Jh(i,e){if(null!==e&&0!==e.length)if(null===i||0===i.length)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const r=e[n];"number"==typeof r?t=r:0===t||bS(i,t,r,null,-1===t||2===t?e[++n]:null)}}return i}function bS(i,e,t,n,r){let s=0,o=i.length;if(-1===e)o=-1;else for(;s<i.length;){const a=i[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<i.length;){const a=i[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==r&&(i[s+1]=r));if(n===i[s+1])return void(i[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),null!==n&&i.splice(s++,0,n),null!==r&&i.splice(s++,0,r)}function CS(i){return-1!==i}function $a(i){return 32767&i}function Ja(i,e){let t=function fx(i){return i>>16}(i),n=e;for(;t>0;)n=n[15],t--;return n}let Tp=!0;function qh(i){const e=Tp;return Tp=i,e}let gx=0;function Vc(i,e){const t=Ip(i,e);if(-1!==t)return t;const n=e[1];n.firstCreatePass&&(i.injectorIndex=e.length,Op(n.data,i),Op(e,null),Op(n.blueprint,null));const r=Qh(i,e),s=i.injectorIndex;if(CS(r)){const o=$a(r),a=Ja(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Op(i,e){i.push(0,0,0,0,0,0,0,0,e)}function Ip(i,e){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===e[i.injectorIndex+8]?-1:i.injectorIndex}function Qh(i,e){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(n=2===o?s.declTNode:1===o?r[6]:null,null===n)return-1;if(t++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return-1}function Xh(i,e,t){!function px(i,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Dc)&&(n=t[Dc]),null==n&&(n=t[Dc]=gx++);const r=255&n;e.data[i+(r>>5)]|=1<<r}(i,e,t)}function OS(i,e,t){if(t&Qe.Optional)return i;_h(e,"NodeInjector")}function IS(i,e,t,n){if(t&Qe.Optional&&void 0===n&&(n=null),0==(t&(Qe.Self|Qe.Host))){const r=i[9],s=ho(void 0);try{return r?r.get(e,n,t&Qe.Optional):Xv(e,n,t&Qe.Optional)}finally{ho(s)}}return OS(n,e,t)}function PS(i,e,t,n=Qe.Default,r){if(null!==i){const s=function wx(i){if("string"==typeof i)return i.charCodeAt(0)||0;const e=i.hasOwnProperty(Dc)?i[Dc]:void 0;return"number"==typeof e?e>=0?255&e:yx:e}(t);if("function"==typeof s){if(!mS(e,i,n))return n&Qe.Host?OS(r,t,n):IS(e,t,n,r);try{const o=s(n);if(null!=o||n&Qe.Optional)return o;_h(t)}finally{vS()}}else if("number"==typeof s){let o=null,a=Ip(i,e),l=-1,c=n&Qe.Host?e[16][6]:null;for((-1===a||n&Qe.SkipSelf)&&(l=-1===a?Qh(i,e):e[a+8],-1!==l&&DS(n,!1)?(o=e[1],a=$a(l),e=Ja(l,e)):a=-1);-1!==a;){const u=e[1];if(_S(s,a,u.data)){const y=Ex(a,e,t,o,n,c);if(y!==NS)return y}l=e[a+8],-1!==l&&DS(n,e[1].data[a+8]===c)&&_S(s,a,e)?(o=u,a=$a(l),e=Ja(l,e)):a=-1}}}return IS(e,t,n,r)}const NS={};function yx(){return new qa(Tn(),ve())}function Ex(i,e,t,n,r,s){const o=e[1],a=o.data[i+8],u=Zh(a,o,t,null==n?kh(a)&&Tp:n!=o&&0!=(3&a.type),r&Qe.Host&&s===a);return null!==u?Gc(e,o,u,a):NS}function Zh(i,e,t,n,r){const s=i.providerIndexes,o=e.data,a=1048575&s,l=i.directiveStart,u=s>>20,R=r?a+u:i.directiveEnd;for(let D=n?a:a+u;D<R;D++){const L=o[D];if(D<l&&t===L||D>=l&&L.type===t)return D}if(r){const D=o[l];if(D&&Br(D)&&D.type===t)return l}return null}function Gc(i,e,t,n){let r=i[t];const s=e.data;if(function cx(i){return i instanceof Bc}(r)){const o=r;o.resolving&&function dD(i,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new Le(-200,`Circular dependency in DI detected for ${i}${t}`)}(gi(s[t]));const a=qh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ho(o.injectImpl):null;mS(i,n,Qe.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&function ax(i,e,t){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){const o=sS(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(i,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-i,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,s))}(t,s[t],e)}finally{null!==l&&ho(l),qh(a),o.resolving=!1,vS()}}return r}function _S(i,e,t){return!!(t[e+(i>>5)]&1<<i)}function DS(i,e){return!(i&Qe.Self||i&Qe.Host&&e)}class qa{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return PS(this._tNode,this._lView,e,n,t)}}function Pp(i){return fo(()=>{const e=i.prototype.constructor,t=e[ks]||Np(e),n=Object.prototype;let r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){const s=r[ks]||Np(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Np(i){return $v(i)?()=>{const e=Np(nt(i));return e&&e()}:ta(i)}function Qa(i){return function mx(i,e){if("class"===e)return i.classes;if("style"===e)return i.styles;const t=i.attrs;if(t){const n=t.length;let r=0;for(;r<n;){const s=t[r];if(AS(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<n&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Tn(),i)}const Za="__parameters__";function tl(i,e,t){return fo(()=>{const n=function _p(i){return function(...t){if(i){const n=i(...t);for(const r in n)this[r]=n[r]}}}(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const y=l.hasOwnProperty(Za)?l[Za]:Object.defineProperty(l,Za,{value:[]})[Za];for(;y.length<=u;)y.push(null);return(y[u]=y[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}class Ge{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Fe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Sx=new Ge("AnalyzeForEntryComponents");function yr(i,e){void 0===e&&(e=i);for(let t=0;t<i.length;t++){let n=i[t];Array.isArray(n)?(e===i&&(e=i.slice(0,t)),yr(n,e)):e!==i&&e.push(n)}return e}function cs(i,e){i.forEach(t=>Array.isArray(t)?cs(t,e):e(t))}function LS(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function ed(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function Uc(i,e){const t=[];for(let n=0;n<i;n++)t.push(e);return t}function Yi(i,e,t){let n=nl(i,e);return n>=0?i[1|n]=t:(n=~n,function Cx(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(1===r)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;)i[r]=i[r-2],r--;i[e]=t,i[e+1]=n}}(i,n,e,t)),n}function xp(i,e){const t=nl(i,e);if(t>=0)return i[1|t]}function nl(i,e){return function BS(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){const s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}(i,e,1)}const Wc={},Mp="__NG_DI_FLAG__",nd="ngTempTokenPath",_x=/\n/gm,VS="__source",xx=xt({provide:String,useValue:xt});let jc;function GS(i){const e=jc;return jc=i,e}function Lx(i,e=Qe.Default){if(void 0===jc)throw new Le(203,"");return null===jc?Xv(i,void 0,e):jc.get(i,e&Qe.Optional?null:void 0,e)}function Re(i,e=Qe.Default){return(function wD(){return rp}()||Lx)(nt(i),e)}const id=Re;function Fp(i){const e=[];for(let t=0;t<i.length;t++){const n=nt(i[t]);if(Array.isArray(n)){if(0===n.length)throw new Le(900,"");let r,s=Qe.Default;for(let o=0;o<n.length;o++){const a=n[o],l=Mx(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Re(r,s))}else e.push(Re(n))}return e}function zc(i,e){return i[Mp]=e,i.prototype[Mp]=e,i}function Mx(i){return i[Mp]}const rd=zc(tl("Inject",i=>({token:i})),-1),kr=zc(tl("Optional"),8),il=zc(tl("SkipSelf"),4);let od;function sl(i){var e;return(null===(e=function kp(){if(void 0===od&&(od=null,_t.trustedTypes))try{od=_t.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch(i){}return od}())||void 0===e?void 0:e.createHTML(i))||i}class na{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class $x extends na{getTypeName(){return"HTML"}}class Jx extends na{getTypeName(){return"Style"}}class qx extends na{getTypeName(){return"Script"}}class Qx extends na{getTypeName(){return"URL"}}class Xx extends na{getTypeName(){return"ResourceURL"}}function Ui(i){return i instanceof na?i.changingThisBreaksApplicationSecurity:i}function us(i,e){const t=JS(i);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}function JS(i){return i instanceof na&&i.getTypeName()||null}class rL{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(sl(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class sL{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const n=this.inertDocument.createElement("body");t.appendChild(n)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=sl(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=sl(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const aL=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,lL=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function $c(i){return(i=String(i)).match(aL)||i.match(lL)?i:"unsafe:"+i}function hs(i){const e={};for(const t of i.split(","))e[t]=!0;return e}function Jc(...i){const e={};for(const t of i)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const XS=hs("area,br,col,hr,img,wbr"),ZS=hs("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),eA=hs("rp,rt"),Gp=Jc(XS,Jc(ZS,hs("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Jc(eA,hs("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Jc(eA,ZS)),Hp=hs("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Yp=hs("srcset"),tA=Jc(Hp,Yp,hs("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),hs("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),cL=hs("script,style,template");class uL{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!Gp.hasOwnProperty(t))return this.sanitizedSomething=!0,!cL.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let r=0;r<n.length;r++){const s=n.item(r),o=s.name,a=o.toLowerCase();if(!tA.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;Hp[a]&&(l=$c(l)),Yp[a]&&(i=l,l=(i=String(i)).split(",").map(e=>$c(e.trim())).join(", ")),this.buf.push(" ",o,'="',nA(l),'"')}var i;return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();Gp.hasOwnProperty(t)&&!XS.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(nA(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const hL=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,dL=/([^\#-~ |!])/g;function nA(i){return i.replace(/&/g,"&amp;").replace(hL,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(dL,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let ld;function iA(i,e){let t=null;try{ld=ld||function qS(i){const e=new sL(i);return function oL(){try{return!!(new window.DOMParser).parseFromString(sl(""),"text/html")}catch(i){return!1}}()?new rL(e):e}(i);let n=e?String(e):"";t=ld.getInertBodyElement(n);let r=5,s=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=t.innerHTML,t=ld.getInertBodyElement(n)}while(n!==s);return sl((new uL).sanitizeChildren(Up(t)||t))}finally{if(t){const n=Up(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function Up(i){return"content"in i&&function fL(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var Ct=(()=>((Ct=Ct||{})[Ct.NONE=0]="NONE",Ct[Ct.HTML=1]="HTML",Ct[Ct.STYLE=2]="STYLE",Ct[Ct.SCRIPT=3]="SCRIPT",Ct[Ct.URL=4]="URL",Ct[Ct.RESOURCE_URL=5]="RESOURCE_URL",Ct))();const oA="__ngContext__";function Zn(i,e){i[oA]=e}function zp(i){const e=function Qc(i){return i[oA]||null}(i);return e?Array.isArray(e)?e:e.lView:null}function $p(i){return i.ngOriginalError}function NL(i,...e){i.error(...e)}class wo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=function PL(i){return i&&i.ngErrorLogger||NL}(e);n(this._console,"ERROR",e),t&&n(this._console,"ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&$p(e);for(;t&&$p(t);)t=$p(t);return t||null}}const GL=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(_t))();function ol(i){return i.ownerDocument}function ds(i){return i instanceof Function?i():i}var Wi=(()=>((Wi=Wi||{})[Wi.Important=1]="Important",Wi[Wi.DashCase=2]="DashCase",Wi))();function qp(i,e){return undefined(i,e)}function Xc(i){const e=i[3];return Fr(e)?e[3]:e}function Qp(i){return pA(i[13])}function Xp(i){return pA(i[4])}function pA(i){for(;null!==i&&!Fr(i);)i=i[4];return i}function ll(i,e,t,n,r){if(null!=n){let s,o=!1;Fr(n)?s=n:as(n)&&(o=!0,n=n[0]);const a=vn(n);0===i&&null!==t?null==r?SA(e,t,a):ia(e,t,a,r||null,!0):1===i&&null!==t?ia(e,t,a,r||null,!0):2===i?function IA(i,e,t){const n=cd(i,e);n&&function ZL(i,e,t,n){en(i)?i.removeChild(e,t,n):e.removeChild(t)}(i,n,e,t)}(e,a,o):3===i&&e.destroyNode(a),null!=s&&function nM(i,e,t,n,r){const s=t[7];s!==vn(t)&&ll(e,i,n,s,r);for(let a=10;a<t.length;a++){const l=t[a];Zc(l[1],l,i,e,n,s)}}(e,i,s,t,r)}}function em(i,e,t){if(en(i))return i.createElement(e,t);{const n=null!==t?function VD(i){const e=i.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(t):null;return null===n?i.createElement(e):i.createElementNS(n,e)}}function yA(i,e){const t=i[9],n=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,yp(r,-1)),t.splice(n,1)}function tm(i,e){if(i.length<=10)return;const t=10+e,n=i[t];if(n){const r=n[17];null!==r&&r!==i&&yA(r,n),e>0&&(i[t-1][4]=n[4]);const s=ed(i,10+e);!function jL(i,e){Zc(i,e,e[11],2,null,null),e[0]=null,e[6]=null}(n[1],n);const o=s[19];null!==o&&o.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-129}return n}function EA(i,e){if(!(256&e[2])){const t=e[11];en(t)&&t.destroyNode&&Zc(i,e,t,3,null,null),function $L(i){let e=i[13];if(!e)return nm(i[1],i);for(;e;){let t=null;if(as(e))t=e[13];else{const n=e[10];n&&(t=n)}if(!t){for(;e&&!e[4]&&e!==i;)as(e)&&nm(e[1],e),e=e[3];null===e&&(e=i),as(e)&&nm(e[1],e),t=e&&e[4]}e=t}}(e)}}function nm(i,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function XL(i,e){let t;if(null!=i&&null!=(t=i.destroyHooks))for(let n=0;n<t.length;n+=2){const r=e[t[n]];if(!(r instanceof Bc)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(i,e),function QL(i,e){const t=i.cleanup,n=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):vn(e[o]),l=n[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?n[r=c]():n[r=-c].unsubscribe(),s+=2}else{const o=n[r=t[s+1]];t[s].call(o)}if(null!==n){for(let s=r+1;s<n.length;s++)n[s]();e[7]=null}}(i,e),1===e[1].type&&en(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Fr(e[3])){t!==e[3]&&yA(t,e);const n=e[19];null!==n&&n.detachView(i)}}}function wA(i,e,t){return function vA(i,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[0];if(2&n.flags){const r=i.data[n.directiveStart].encapsulation;if(r===Lr.None||r===Lr.Emulated)return null}return pr(n,t)}(i,e.parent,t)}function ia(i,e,t,n,r){en(i)?i.insertBefore(e,t,n,r):e.insertBefore(t,n,r)}function SA(i,e,t){en(i)?i.appendChild(e,t):e.appendChild(t)}function AA(i,e,t,n,r){null!==n?ia(i,e,t,n,r):SA(i,e,t)}function cd(i,e){return en(i)?i.parentNode(e):e.parentNode}function bA(i,e,t){return RA(i,e,t)}let RA=function CA(i,e,t){return 40&i.type?pr(i,t):null};function ud(i,e,t,n){const r=wA(i,n,e),s=e[11],a=bA(n.parent||e[6],n,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)AA(s,r,t[l],a,!1);else AA(s,r,t,a,!1)}function hd(i,e){if(null!==e){const t=e.type;if(3&t)return pr(e,i);if(4&t)return rm(-1,i[e.index]);if(8&t){const n=e.child;if(null!==n)return hd(i,n);{const r=i[e.index];return Fr(r)?rm(-1,r):vn(r)}}if(32&t)return qp(e,i)()||vn(i[e.index]);{const n=OA(i,e);return null!==n?Array.isArray(n)?n[0]:hd(Xc(i[16]),n):hd(i,e.next)}}return null}function OA(i,e){return null!==e?i[16][6].projection[e.projection]:null}function rm(i,e){const t=10+i+1;if(t<e.length){const n=e[t],r=n[1].firstChild;if(null!==r)return hd(n,r)}return e[7]}function sm(i,e,t,n,r,s,o){for(;null!=t;){const a=n[t.index],l=t.type;if(o&&0===e&&(a&&Zn(vn(a),n),t.flags|=4),64!=(64&t.flags))if(8&l)sm(i,e,t.child,n,r,s,!1),ll(e,i,r,a,s);else if(32&l){const c=qp(t,n);let u;for(;u=c();)ll(e,i,r,u,s);ll(e,i,r,a,s)}else 16&l?PA(i,e,n,t,r,s):ll(e,i,r,a,s);t=o?t.projectionNext:t.next}}function Zc(i,e,t,n,r,s){sm(t,n,i.firstChild,e,r,s,!1)}function PA(i,e,t,n,r,s){const o=t[16],l=o[6].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)ll(e,i,r,l[c],s);else sm(i,e,l,o[3],r,s,!0)}function NA(i,e,t){en(i)?i.setAttribute(e,"style",t):e.style.cssText=t}function om(i,e,t){en(i)?""===t?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t):e.className=t}function _A(i,e,t){let n=i.length;for(;;){const r=i.indexOf(e,t);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}const DA="ng-template";function rM(i,e,t){let n=0;for(;n<i.length;){let r=i[n++];if(t&&"class"===r){if(r=i[n],-1!==_A(r.toLowerCase(),e,0))return!0}else if(1===r){for(;n<i.length&&"string"==typeof(r=i[n++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function xA(i){return 4===i.type&&i.value!==DA}function sM(i,e,t){return e===(4!==i.type||t?i.value:DA)}function oM(i,e,t){let n=4;const r=i.attrs||[],s=function cM(i){for(let e=0;e<i.length;e++)if(AS(i[e]))return e;return i.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!sM(i,l,t)||""===l&&1===e.length){if(Vr(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==i.attrs){if(!rM(i.attrs,c,t)){if(Vr(n))return!1;o=!0}continue}const y=aM(8&n?"class":l,r,xA(i),t);if(-1===y){if(Vr(n))return!1;o=!0;continue}if(""!==c){let R;R=y>s?"":r[y+1].toLowerCase();const D=8&n?R:null;if(D&&-1!==_A(D,c,0)||2&n&&c!==R){if(Vr(n))return!1;o=!0}}}}else{if(!o&&!Vr(n)&&!Vr(l))return!1;if(o&&Vr(l))continue;o=!1,n=l|1&n}}return Vr(n)||o}function Vr(i){return 0==(1&i)}function aM(i,e,t,n){if(null===e)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===i)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function uM(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){const n=i[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,i)}function LA(i,e,t=!1){for(let n=0;n<e.length;n++)if(oM(i,e[n],t))return!0;return!1}function hM(i,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function MA(i,e){return i?":not("+e.trim()+")":e}function dM(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if("string"==typeof o)if(2&n){const a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""!==r&&!Vr(o)&&(e+=MA(s,r),r=""),n=o,s=s||!Vr(n);t++}return""!==r&&(e+=MA(s,r)),e}const Ze={};function ft(i){FA(yt(),ve(),mi()+i,Hh())}function FA(i,e,t,n){if(!n)if(3==(3&e[2])){const s=i.preOrderCheckHooks;null!==s&&zh(e,s,t)}else{const s=i.preOrderHooks;null!==s&&Kh(e,s,0,t)}yo(t)}function dd(i,e){return i<<17|e<<2}function Gr(i){return i>>17&32767}function am(i){return 2|i}function Hs(i){return(131068&i)>>2}function lm(i,e){return-131069&i|e<<2}function cm(i){return 1|i}function KA(i,e){const t=i.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const r=t[n],s=t[n+1];if(-1!==s){const o=i.data[s];Ap(r),o.contentQueries(2,e[s],s)}}}function eu(i,e,t,n,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|n,uS(u),u[3]=u[15]=i,u[8]=t,u[10]=o||i&&i[10],u[11]=a||i&&i[11],u[12]=l||i&&i[12]||null,u[9]=c||i&&i[9]||null,u[6]=s,u[16]=2==e.type?i[16]:u,u}function cl(i,e,t,n,r){let s=i.data[e];if(null===s)s=function Em(i,e,t,n,r){const s=dS(),o=Ep(),l=i.data[e]=function NM(i,e,t,n,r,s){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,r);return null===i.firstChild&&(i.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(i,e,t,n,r),function QD(){return $e.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=n,s.attrs=r;const o=function Fc(){const i=$e.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return ls(s,!0),s}function ul(i,e,t,n){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function tu(i,e,t){Uh(e);try{const n=i.viewQuery;null!==n&&Om(1,n,t);const r=i.template;null!==r&&$A(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&KA(i,e),i.staticViewQueries&&Om(2,i.viewQuery,t);const s=i.components;null!==s&&function OM(i,e){for(let t=0;t<e.length;t++)$M(i,e[t])}(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[2]&=-5,Wh()}}function hl(i,e,t,n){const r=e[2];if(256==(256&r))return;Uh(e);const s=Hh();try{uS(e),function fS(i){return $e.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==t&&$A(i,e,t,2,n);const o=3==(3&r);if(!s)if(o){const c=i.preOrderCheckHooks;null!==c&&zh(e,c,null)}else{const c=i.preOrderHooks;null!==c&&Kh(e,c,0,null),bp(e,0)}if(function zM(i){for(let e=Qp(i);null!==e;e=Xp(e)){if(!e[2])continue;const t=e[9];for(let n=0;n<t.length;n++){const r=t[n],s=r[3];0==(1024&r[2])&&yp(s,1),r[2]|=1024}}}(e),function jM(i){for(let e=Qp(i);null!==e;e=Xp(e))for(let t=10;t<e.length;t++){const n=e[t],r=n[1];mp(n)&&hl(r,n,r.template,n[8])}}(e),null!==i.contentQueries&&KA(i,e),!s)if(o){const c=i.contentCheckHooks;null!==c&&zh(e,c)}else{const c=i.contentHooks;null!==c&&Kh(e,c,1),bp(e,1)}!function RM(i,e){const t=i.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const r=t[n];if(r<0)yo(~r);else{const s=r,o=t[++n],a=t[++n];XD(o,s),a(2,e[s])}}}finally{yo(-1)}}(i,e);const a=i.components;null!==a&&function TM(i,e){for(let t=0;t<e.length;t++)KM(i,e[t])}(e,a);const l=i.viewQuery;if(null!==l&&Om(2,l,n),!s)if(o){const c=i.viewCheckHooks;null!==c&&zh(e,c)}else{const c=i.viewHooks;null!==c&&Kh(e,c,2),bp(e,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,yp(e[3],-1))}finally{Wh()}}function IM(i,e,t,n){const r=e[10],s=!Hh(),o=cS(e);try{s&&!o&&r.begin&&r.begin(),o&&tu(i,e,n),hl(i,e,t,n)}finally{s&&!o&&r.end&&r.end()}}function $A(i,e,t,n,r){const s=mi(),o=2&n;try{yo(-1),o&&e.length>20&&FA(i,e,20,Hh()),t(n,r)}finally{yo(s)}}function JA(i,e,t){if(lp(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=i.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function wm(i,e,t){!hS()||(function BM(i,e,t,n){const r=t.directiveStart,s=t.directiveEnd;i.firstCreatePass||Vc(t,e),Zn(n,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=i.data[a],c=Br(l);c&&YM(e,t,l);const u=Gc(e,i,a,t);Zn(u,e),null!==o&&UM(0,a-r,u,l,0,o),c&&(Hi(t.index,e)[8]=u)}}(i,e,t,pr(t,e)),128==(128&t.flags)&&function kM(i,e,t){const n=t.directiveStart,r=t.directiveEnd,o=t.index,a=function ZD(){return $e.lFrame.currentDirectiveIndex}();try{yo(o);for(let l=n;l<r;l++){const c=i.data[l],u=e[l];vp(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&ib(c,u)}}finally{yo(-1),vp(a)}}(i,e,t))}function vm(i,e,t=pr){const n=e.localNames;if(null!==n){let r=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,i):i[o];i[r++]=a}}}function qA(i){const e=i.tView;return null===e||e.incompleteFirstPass?i.tView=pd(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):e}function pd(i,e,t,n,r,s,o,a,l,c){const u=20+n,y=u+r,R=function PM(i,e){const t=[];for(let n=0;n<e;n++)t.push(n<i?null:Ze);return t}(u,y),D="function"==typeof c?c():c;return R[1]={type:i,blueprint:R,template:t,queries:null,viewQuery:a,declTNode:e,data:R.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:D,incompleteFirstPass:!1}}function ZA(i,e,t,n){const r=cb(e);null===t?r.push(n):(r.push(t),i.firstCreatePass&&ub(i).push(n,r.length-1))}function eb(i,e,t){for(let n in i)if(i.hasOwnProperty(n)){const r=i[n];(t=null===t?{}:t).hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}return t}function ji(i,e,t,n,r,s,o,a){const l=pr(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[n])?(fb(i,t,u,n,r),kh(e)&&function xM(i,e){const t=Hi(e,i);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(n=function DM(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),r=null!=o?o(r,e.value||"",n):r,en(s)?s.setProperty(l,n,r):Rp(n)||(l.setProperty?l.setProperty(n,r):l[n]=r))}function Sm(i,e,t,n){let r=!1;if(hS()){const s=function VM(i,e,t){const n=i.directiveRegistry;let r=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];LA(t,o.selectors,!1)&&(r||(r=[]),Xh(Vc(t,e),i,o.type),Br(o)?(rb(i,t),r.unshift(o)):r.push(o))}return r}(i,e,t),o=null===n?null:{"":-1};if(null!==s){r=!0,sb(t,i.data.length,s.length);for(let u=0;u<s.length;u++){const y=s[u];y.providersResolver&&y.providersResolver(y)}let a=!1,l=!1,c=ul(i,e,s.length,null);for(let u=0;u<s.length;u++){const y=s[u];t.mergedAttrs=Jh(t.mergedAttrs,y.hostAttrs),ob(i,t,e,c,y),HM(c,y,o),null!==y.contentQueries&&(t.flags|=8),(null!==y.hostBindings||null!==y.hostAttrs||0!==y.hostVars)&&(t.flags|=128);const R=y.type.prototype;!a&&(R.ngOnChanges||R.ngOnInit||R.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t.index),a=!0),!l&&(R.ngOnChanges||R.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function _M(i,e){const n=e.directiveEnd,r=i.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<n;c++){const u=r[c],y=u.inputs,R=null===s||xA(e)?null:WM(y,s);o.push(R),a=eb(y,c,a),l=eb(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(i,t)}o&&function GM(i,e,t){if(e){const n=i.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Le(-301,!1);n.push(e[r],s)}}}(t,n,o)}return t.mergedAttrs=Jh(t.mergedAttrs,t.attrs),r}function nb(i,e,t,n,r,s){const o=s.hostBindings;if(o){let a=i.hostBindingOpCodes;null===a&&(a=i.hostBindingOpCodes=[]);const l=~e.index;(function FM(i){let e=i.length;for(;e>0;){const t=i[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(n,r,o)}}function ib(i,e){null!==i.hostBindings&&i.hostBindings(1,e)}function rb(i,e){e.flags|=2,(i.components||(i.components=[])).push(e.index)}function HM(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;Br(e)&&(t[""]=i)}}function sb(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function ob(i,e,t,n,r){i.data[n]=r;const s=r.factory||(r.factory=ta(r.type)),o=new Bc(s,Br(r),null);i.blueprint[n]=o,t[n]=o,nb(i,e,0,n,ul(i,t,r.hostVars,Ze),r)}function YM(i,e,t){const n=pr(e,i),r=qA(t),s=i[10],o=md(i,eu(i,r,null,t.onPush?64:16,n,e,s,s.createRenderer(n,t),null,null));i[e.index]=o}function fs(i,e,t,n,r,s){const o=pr(i,e);!function Am(i,e,t,n,r,s,o){if(null==s)en(i)?i.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Xe(s):o(s,n||"",r);en(i)?i.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,i.value,t,n,r)}function UM(i,e,t,n,r,s){const o=s[e];if(null!==o){const a=n.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],y=o[l++];null!==a?n.setInput(t,y,c,u):t[u]=y}}}function WM(i,e){let t=null,n=0;for(;n<e.length;){const r=e[n];if(0!==r)if(5!==r){if("number"==typeof r)break;i.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,i[r],e[n+1])),n+=2}else n+=2;else n+=4}return t}function ab(i,e,t,n){return new Array(i,!0,!1,e,null,0,n,t,null,null)}function KM(i,e){const t=Hi(e,i);if(mp(t)){const n=t[1];80&t[2]?hl(n,t,n.template,t[8]):t[5]>0&&bm(t)}}function bm(i){for(let n=Qp(i);null!==n;n=Xp(n))for(let r=10;r<n.length;r++){const s=n[r];if(1024&s[2]){const o=s[1];hl(o,s,o.template,s[8])}else s[5]>0&&bm(s)}const t=i[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=Hi(t[n],i);mp(r)&&r[5]>0&&bm(r)}}function $M(i,e){const t=Hi(e,i),n=t[1];(function JM(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])})(n,t),tu(n,t,t[8])}function md(i,e){return i[13]?i[14][4]=e:i[13]=e,i[14]=e,e}function Cm(i){for(;i;){i[2]|=64;const e=Xc(i);if(PD(i)&&!e)return i;i=e}return null}function Tm(i,e,t){const n=e[10];n.begin&&n.begin();try{hl(i,e,i.template,t)}catch(r){throw db(e,r),r}finally{n.end&&n.end()}}function lb(i){!function Rm(i){for(let e=0;e<i.components.length;e++){const t=i.components[e],n=zp(t),r=n[1];IM(r,n,r.template,t)}}(i[8])}function Om(i,e,t){Ap(0),e(i,t)}const ZM=(()=>Promise.resolve(null))();function cb(i){return i[7]||(i[7]=[])}function ub(i){return i.cleanup||(i.cleanup=[])}function hb(i,e,t){return(null===i||Br(i))&&(t=function YD(i){for(;Array.isArray(i);){if("object"==typeof i[1])return i;i=i[0]}return null}(t[e.index])),t[11]}function db(i,e){const t=i[9],n=t?t.get(wo,null):null;n&&n.handleError(e)}function fb(i,e,t,n,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=i.data[o];null!==c.setInput?c.setInput(l,r,n,a):l[a]=r}}function Ys(i,e,t){const n=Gh(e,i);!function mA(i,e,t){en(i)?i.setValue(e,t):e.textContent=t}(i[11],n,t)}function yd(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=ep(r,a):2==s&&(n=ep(n,a+": "+e[++o]+";"))}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}const Im=new Ge("INJECTOR",-1);class gb{get(e,t=Wc){if(t===Wc){const n=new Error(`NullInjectorError: No provider for ${Pt(e)}!`);throw n.name="NullInjectorError",n}return t}}const Pm=new Ge("Set Injector scope."),nu={},n1={};let Nm;function pb(){return void 0===Nm&&(Nm=new gb),Nm}function mb(i,e=null,t=null,n){const r=yb(i,e,t,n);return r._resolveInjectorDefTypes(),r}function yb(i,e=null,t=null,n){return new r1(i,t,e||pb(),n)}class r1{constructor(e,t,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&cs(t,a=>this.processProvider(a,e,t)),cs([e],a=>this.processInjectorType(a,[],s)),this.records.set(Im,dl(void 0,this));const o=this.records.get(Pm);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:Pt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Wc,n=Qe.Default){this.assertNotDestroyed();const r=GS(this),s=ho(void 0);try{if(!(n&Qe.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function d1(i){return"function"==typeof i||"object"==typeof i&&i instanceof Ge}(e)&&np(e);a=l&&this.injectableDefInScope(l)?dl(_m(e),nu):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&Qe.Self?pb():this.parent).get(e,t=n&Qe.Optional&&t===Wc?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[nd]=o[nd]||[]).unshift(Pt(e)),r)throw o;return function Fx(i,e,t,n){const r=i[nd];throw e[VS]&&r.unshift(e[VS]),i.message=function Bx(i,e,t,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let r=Pt(e);if(Array.isArray(e))r=e.map(Pt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Pt(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(_x,"\n  ")}`}("\n"+i.message,r,t,n),i.ngTokenPath=r,i[nd]=null,i}(o,e,"R3InjectorError",this.source)}throw o}finally{ho(s),GS(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((n,r)=>e.push(Pt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Le(205,!1)}processInjectorType(e,t,n){if(!(e=nt(e)))return!1;let r=qv(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==n.indexOf(o);if(void 0!==s&&(r=qv(s)),null==r)return!1;if(null!=r.imports&&!a){let u;n.push(o);try{cs(r.imports,y=>{this.processInjectorType(y,t,n)&&(void 0===u&&(u=[]),u.push(y))})}finally{}if(void 0!==u)for(let y=0;y<u.length;y++){const{ngModule:R,providers:D}=u[y];cs(D,L=>this.processProvider(L,R,D||Lt))}}this.injectorDefTypes.add(o);const l=ta(o)||(()=>new o);this.records.set(o,dl(l,nu));const c=r.providers;if(null!=c&&!a){const u=e;cs(c,y=>this.processProvider(y,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,n){let r=fl(e=nt(e))?e:nt(e&&e.provide);const s=function o1(i,e,t){return wb(i)?dl(void 0,i.useValue):dl(Eb(i),nu)}(e);if(fl(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=dl(void 0,nu,!0),o.factory=()=>Fp(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===nu&&(t.value=n1,t.value=t.factory()),"object"==typeof t.value&&t.value&&function h1(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=nt(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function _m(i){const e=np(i),t=null!==e?e.factory:ta(i);if(null!==t)return t;if(i instanceof Ge)throw new Le(204,!1);if(i instanceof Function)return function s1(i){const e=i.length;if(e>0)throw Uc(e,"?"),new Le(204,!1);const t=function mD(i){const e=i&&(i[Dh]||i[Qv]);if(e){const t=function yD(i){if(i.hasOwnProperty("name"))return i.name;const e=(""+i).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(i);return null!==t?()=>t.factory(i):()=>new i}(i);throw new Le(204,!1)}function Eb(i,e,t){let n;if(fl(i)){const r=nt(i);return ta(r)||_m(r)}if(wb(i))n=()=>nt(i.useValue);else if(function l1(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...Fp(i.deps||[]));else if(function a1(i){return!(!i||!i.useExisting)}(i))n=()=>Re(nt(i.useExisting));else{const r=nt(i&&(i.useClass||i.provide));if(!function u1(i){return!!i.deps}(i))return ta(r)||_m(r);n=()=>new r(...Fp(i.deps))}return n}function dl(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function wb(i){return null!==i&&"object"==typeof i&&xx in i}function fl(i){return"function"==typeof i}let Pi=(()=>{class i{static create(t,n){var r;if(Array.isArray(t))return mb({name:""},n,t,"");{const s=null!==(r=t.name)&&void 0!==r?r:"";return mb({name:s},t.parent,t.providers,s)}}}return i.THROW_IF_NOT_FOUND=Wc,i.NULL=new gb,i.\u0275prov=Fe({token:i,providedIn:"any",factory:()=>Re(Im)}),i.__NG_ELEMENT_ID__=-1,i})();function v1(i,e){jh(zp(i)[1],Tn())}function Us(i){let e=function _b(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),t=!0;const n=[i];for(;e;){let r;if(Br(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Le(903,"");r=e.\u0275dir}if(r){if(t){n.push(r);const o=i;o.inputs=Lm(i.inputs),o.declaredInputs=Lm(i.declaredInputs),o.outputs=Lm(i.outputs);const a=r.hostBindings;a&&C1(i,a);const l=r.viewQuery,c=r.contentQueries;if(l&&A1(i,l),c&&b1(i,c),Zg(i.inputs,r.inputs),Zg(i.declaredInputs,r.declaredInputs),Zg(i.outputs,r.outputs),Br(r)&&r.data.animation){const u=i.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(i),a===Us&&(t=!1)}}e=Object.getPrototypeOf(e)}!function S1(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){const r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=Jh(r.hostAttrs,t=Jh(t,r.hostAttrs))}}(n)}function Lm(i){return i===Ha?{}:i===Lt?[]:i}function A1(i,e){const t=i.viewQuery;i.viewQuery=t?(n,r)=>{e(n,r),t(n,r)}:e}function b1(i,e){const t=i.contentQueries;i.contentQueries=t?(n,r,s)=>{e(n,r,s),t(n,r,s)}:e}function C1(i,e){const t=i.hostBindings;i.hostBindings=t?(n,r)=>{e(n,r),t(n,r)}:e}let Ed=null;function gl(){if(!Ed){const i=_t.Symbol;if(i&&i.iterator)Ed=i.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Ed=n)}}}return Ed}function iu(i){return!!function Mm(i){return null!==i&&("function"==typeof i||"object"==typeof i)}(i)&&(Array.isArray(i)||!(i instanceof Map)&&gl()in i)}function ei(i,e,t){return!Object.is(i[e],t)&&(i[e]=t,!0)}function Wt(i,e,t,n){const r=ve();return ei(r,Ka(),e)&&(yt(),fs(tn(),r,i,e,t,n)),Wt}function Dt(i,e,t,n,r,s,o,a){const l=ve(),c=yt(),u=i+20,y=c.firstCreatePass?function _1(i,e,t,n,r,s,o,a,l){const c=e.consts,u=cl(e,i,4,o||null,mo(c,a));Sm(e,t,u,mo(c,l)),jh(e,u);const y=u.tViews=pd(2,u,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),y.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,n,r,s,o):c.data[u];ls(y,!1);const R=l[11].createComment("");ud(c,l,R,y),Zn(R,l),md(l,l[u]=ab(R,l,R,y)),Vh(y)&&wm(c,l,y),null!=o&&vm(l,y,a)}function vd(i){return function za(i,e){return i[e]}(function qD(){return $e.lFrame.contextLView}(),20+i)}function we(i,e=Qe.Default){const t=ve();return null===t?Re(i,e):PS(Tn(),t,nt(i),e)}function Gm(){throw new Error("invalid")}function rt(i,e,t){const n=ve();return ei(n,Ka(),e)&&ji(yt(),tn(),n,i,e,n[11],t,!1),rt}function Hm(i,e,t,n,r){const o=r?"class":"style";fb(i,t,e.inputs[o],o,n)}function je(i,e,t,n){const r=ve(),s=yt(),o=20+i,a=r[11],l=r[o]=em(a,e,function ox(){return $e.lFrame.currentNamespace}()),c=s.firstCreatePass?function X1(i,e,t,n,r,s,o){const a=e.consts,c=cl(e,i,2,r,mo(a,s));return Sm(e,t,c,mo(a,o)),null!==c.attrs&&yd(c,c.attrs,!1),null!==c.mergedAttrs&&yd(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,n):s.data[o];ls(c,!0);const u=c.mergedAttrs;null!==u&&$h(a,l,u);const y=c.classes;null!==y&&om(a,l,y);const R=c.styles;return null!==R&&NA(a,l,R),64!=(64&c.flags)&&ud(s,r,l,c),0===function jD(){return $e.lFrame.elementDepthCount}()&&Zn(l,r),function zD(){$e.lFrame.elementDepthCount++}(),Vh(c)&&(wm(s,r,c),JA(s,c,r)),null!==n&&vm(r,c),je}function et(){let i=Tn();Ep()?wp():(i=i.parent,ls(i,!1));const e=i;!function KD(){$e.lFrame.elementDepthCount--}();const t=yt();return t.firstCreatePass&&(jh(t,i),lp(i)&&t.queries.elementEnd(i)),null!=e.classesWithoutHost&&function hx(i){return 0!=(16&i.flags)}(e)&&Hm(t,e,ve(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function dx(i){return 0!=(32&i.flags)}(e)&&Hm(t,e,ve(),e.stylesWithoutHost,!1),et}function ti(i,e,t,n){return je(i,e,t,n),et(),ti}function Ym(i,e,t){const n=ve(),r=yt(),s=i+20,o=r.firstCreatePass?function Z1(i,e,t,n,r){const s=e.consts,o=mo(s,n),a=cl(e,i,8,"ng-container",o);return null!==o&&yd(a,o,!0),Sm(e,t,a,mo(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,n,e,t):r.data[s];ls(o,!0);const a=n[s]=n[11].createComment("");return ud(r,n,a,o),Zn(a,n),Vh(o)&&(wm(r,n,o),JA(r,o,n)),null!=t&&vm(n,o),Ym}function Um(){let i=Tn();const e=yt();return Ep()?wp():(i=i.parent,ls(i,!1)),e.firstCreatePass&&(jh(e,i),lp(i)&&e.queries.elementEnd(i)),Um}function Ao(i,e,t){return Ym(i,e,t),Um(),Ao}function bo(){return ve()}function Ad(i){return!!i&&"function"==typeof i.then}const Xb=function Qb(i){return!!i&&"function"==typeof i.subscribe};function ni(i,e,t,n){const r=ve(),s=yt(),o=Tn();return Zb(s,r,r[11],o,i,e,!!t,n),ni}function Wm(i,e){const t=Tn(),n=ve(),r=yt();return Zb(r,n,hb(Sp(r.data),t,n),t,i,e,!1),Wm}function Zb(i,e,t,n,r,s,o,a){const l=Vh(n),u=i.firstCreatePass&&ub(i),y=e[8],R=cb(e);let D=!0;if(3&n.type||a){const W=pr(n,e),X=a?a(W):W,ne=R.length,ce=a?Ae=>a(vn(Ae[n.index])):n.index;if(en(t)){let Ae=null;if(!a&&l&&(Ae=function eF(i,e,t,n){const r=i.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===n){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(i,e,r,n.index)),null!==Ae)(Ae.__ngLastListenerFn__||Ae).__ngNextListenerFn__=s,Ae.__ngLastListenerFn__=s,D=!1;else{s=jm(n,e,y,s,!1);const Oe=t.listen(X,r,s);R.push(s,Oe),u&&u.push(r,ce,ne,ne+1)}}else s=jm(n,e,y,s,!0),X.addEventListener(r,s,o),R.push(s),u&&u.push(r,ce,ne,o)}else s=jm(n,e,y,s,!1);const L=n.outputs;let k;if(D&&null!==L&&(k=L[r])){const W=k.length;if(W)for(let X=0;X<W;X+=2){const Be=e[k[X]][k[X+1]].subscribe(s),ke=R.length;R.push(s,Be),u&&u.push(r,n.index,ke,-(ke+1))}}}function eC(i,e,t,n){try{return!1!==t(n)}catch(r){return db(i,r),!1}}function jm(i,e,t,n,r){return function s(o){if(o===Function)return n;const a=2&i.flags?Hi(i.index,e):e;0==(32&e[2])&&Cm(a);let l=eC(e,0,n,o),c=s.__ngNextListenerFn__;for(;c;)l=eC(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function lt(i=1){return function tx(i){return($e.lFrame.contextLView=function nx(i,e){for(;i>0;)e=e[15],i--;return e}(i,$e.lFrame.contextLView))[8]}(i)}function tF(i,e){let t=null;const n=function lM(i){const e=i.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(i);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===n?LA(i,s,!0):hM(n,s))return r}else t=r}return t}function Yr(i){const e=ve()[16][6];if(!e.projection){const n=e.projection=Uc(i?i.length:1,null),r=n.slice();let s=e.child;for(;null!==s;){const o=i?tF(s,i):0;null!==o&&(r[o]?r[o].projectionNext=s:n[o]=s,r[o]=s),s=s.next}}}function ii(i,e=0,t){const n=ve(),r=yt(),s=cl(r,20+i,16,null,t||null);null===s.projection&&(s.projection=e),wp(),64!=(64&s.flags)&&function tM(i,e,t){PA(e[11],0,e,t,wA(i,t,e),bA(t.parent||e[6],t,e))}(r,n,s)}function uC(i,e,t,n,r){const s=i[t+1],o=null===e;let a=n?Gr(s):Hs(s),l=!1;for(;0!==a&&(!1===l||o);){const u=i[a+1];rF(i[a],e)&&(l=!0,i[a+1]=n?cm(u):am(u)),a=n?Gr(u):Hs(u)}l&&(i[t+1]=n?am(s):cm(s))}function rF(i,e){return null===i||null==e||(Array.isArray(i)?i[1]:i)===e||!(!Array.isArray(i)||"string"!=typeof e)&&nl(i,e)>=0}function Co(i,e,t){return Ur(i,e,t,!1),Co}function Mn(i,e){return Ur(i,e,null,!0),Mn}function Ur(i,e,t,n){const r=ve(),s=yt(),o=function Gs(i){const e=$e.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}(2);s.firstUpdatePass&&function EC(i,e,t,n){const r=i.data;if(null===r[t+1]){const s=r[mi()],o=function yC(i,e){return e>=i.expandoStartIndex}(i,t);(function AC(i,e){return 0!=(i.flags&(e?16:32))})(s,n)&&null===e&&!o&&(e=!1),e=function fF(i,e,t,n){const r=Sp(i);let s=n?e.residualClasses:e.residualStyles;if(null===r)0===(n?e.classBindings:e.styleBindings)&&(t=su(t=Km(null,i,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||i[o]!==r)if(t=Km(r,i,e,t,n),null===s){let l=function gF(i,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==Hs(n))return i[Gr(n)]}(i,e,n);void 0!==l&&Array.isArray(l)&&(l=Km(null,i,e,l[1],n),l=su(l,e.attrs,n),function pF(i,e,t,n){i[Gr(t?e.classBindings:e.styleBindings)]=n}(i,e,n,l))}else s=function mF(i,e,t){let n;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)n=su(n,i[s].hostAttrs,t);return su(n,e.attrs,t)}(i,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,n),function nF(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=Gr(o),l=Hs(o);i[n]=t;let u,c=!1;if(Array.isArray(t)){const y=t;u=y[1],(null===u||nl(y,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const R=Gr(i[a+1]);i[n+1]=dd(R,a),0!==R&&(i[R+1]=lm(i[R+1],n)),i[a+1]=function pM(i,e){return 131071&i|e<<17}(i[a+1],n)}else i[n+1]=dd(a,0),0!==a&&(i[a+1]=lm(i[a+1],n)),a=n;else i[n+1]=dd(l,0),0===a?a=n:i[l+1]=lm(i[l+1],n),l=n;c&&(i[n+1]=am(i[n+1])),uC(i,u,n,!0),uC(i,u,n,!1),function iF(i,e,t,n,r){const s=r?i.residualClasses:i.residualStyles;null!=s&&"string"==typeof e&&nl(s,e)>=0&&(t[n+1]=cm(t[n+1]))}(e,u,i,n,s),o=dd(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,n)}}(s,i,o,n),e!==Ze&&ei(r,o,e)&&function vC(i,e,t,n,r,s,o,a){if(!(3&e.type))return;const l=i.data,c=l[a+1];bd(function VA(i){return 1==(1&i)}(c)?SC(l,e,t,r,Hs(c),o):void 0)||(bd(s)||function kA(i){return 2==(2&i)}(c)&&(s=SC(l,null,t,r,a,o)),function iM(i,e,t,n,r){const s=en(i);if(e)r?s?i.addClass(t,n):t.classList.add(n):s?i.removeClass(t,n):t.classList.remove(n);else{let o=-1===n.indexOf("-")?void 0:Wi.DashCase;if(null==r)s?i.removeStyle(t,n,o):t.style.removeProperty(n);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Wi.Important),s?i.setStyle(t,n,r,o):t.style.setProperty(n,r,a?"important":"")}}}(n,o,Gh(mi(),t),r,s))}(s,s.data[mi()],r,r[11],i,r[o+1]=function wF(i,e){return null==i||("string"==typeof e?i+=e:"object"==typeof i&&(i=Pt(Ui(i)))),i}(e,t),n,o)}function Km(i,e,t,n,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=su(n,s.hostAttrs,r),s!==i);)a++;return null!==i&&(t.directiveStylingLast=a),n}function su(i,e,t){const n=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),Yi(i,o,!!t||e[++s]))}return void 0===i?null:i}function SC(i,e,t,n,r,s){const o=null===e;let a;for(;r>0;){const l=i[r],c=Array.isArray(l),u=c?l[1]:l,y=null===u;let R=t[r+1];R===Ze&&(R=y?Lt:void 0);let D=y?xp(R,n):u===n?R:void 0;if(c&&!bd(D)&&(D=xp(l,n)),bd(D)&&(a=D,o))return a;const L=i[r+1];r=o?Gr(L):Hs(L)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=xp(l,n))}return a}function bd(i){return void 0!==i}function ri(i,e=""){const t=ve(),n=yt(),r=i+20,s=n.firstCreatePass?cl(n,r,1,e,null):n.data[r],o=t[r]=function Zp(i,e){return en(i)?i.createText(e):i.createTextNode(e)}(t[11],e);ud(n,t,o,s),ls(s,!1)}function Cd(i,e,t){const n=ve(),r=function ml(i,e,t,n){return ei(i,Ka(),t)?e+Xe(t)+n:Ze}(n,i,e,t);return r!==Ze&&Ys(n,mi(),r),Cd}function $m(i,e,t){const n=ve();if(ei(n,Ka(),e)){const s=yt(),o=tn();ji(s,o,n,i,e,hb(Sp(s.data),o,n),t,!0)}return $m}const Rd="en-US";let WC=Rd;function Qm(i,e,t,n,r){if(i=nt(i),Array.isArray(i))for(let s=0;s<i.length;s++)Qm(i[s],e,t,n,r);else{const s=yt(),o=ve();let a=fl(i)?i:nt(i.provide),l=Eb(i);const c=Tn(),u=1048575&c.providerIndexes,y=c.directiveStart,R=c.providerIndexes>>20;if(fl(i)||!i.multi){const D=new Bc(l,r,we),L=Zm(a,e,r?u:u+R,y);-1===L?(Xh(Vc(c,o),s,a),Xm(s,i,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(D),o.push(D)):(t[L]=D,o[L]=D)}else{const D=Zm(a,e,u+R,y),L=Zm(a,e,u,u+R),k=D>=0&&t[D],W=L>=0&&t[L];if(r&&!W||!r&&!k){Xh(Vc(c,o),s,a);const X=function kB(i,e,t,n,r){const s=new Bc(i,t,we);return s.multi=[],s.index=e,s.componentProviders=0,gR(s,r,n&&!t),s}(r?BB:FB,t.length,r,n,l);!r&&W&&(t[L].providerFactory=X),Xm(s,i,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(X),o.push(X)}else Xm(s,i,D>-1?D:L,gR(t[r?L:D],l,!r&&n));!r&&n&&W&&t[L].componentProviders++}}}function Xm(i,e,t,n){const r=fl(e),s=function c1(i){return!!i.useClass}(e);if(r||s){const l=(s?nt(e.useClass):e).prototype.ngOnDestroy;if(l){const c=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[n,l]):c[u+1].push(n,l)}else c.push(t,l)}}}function gR(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function Zm(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function FB(i,e,t,n){return ey(this.multi,[])}function BB(i,e,t,n){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Gc(t,t[1],this.providerFactory.index,n);s=a.slice(0,o),ey(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],ey(r,s);return s}function ey(i,e){for(let t=0;t<i.length;t++)e.push((0,i[t])());return e}function ty(i,e=[]){return t=>{t.providersResolver=(n,r)=>function MB(i,e,t){const n=yt();if(n.firstCreatePass){const r=Br(i);Qm(t,n.data,n.blueprint,r,!0),Qm(e,n.data,n.blueprint,r,!1)}}(n,r?r(i):i,e)}}class pR{}class HB{resolveComponentFactory(e){throw function GB(i){const e=Error(`No component factory found for ${Pt(i)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=i,e}(e)}}let uu=(()=>{class i{}return i.NULL=new HB,i})();function YB(){return Il(Tn(),ve())}function Il(i,e){return new Sn(pr(i,e))}let Sn=(()=>{class i{constructor(t){this.nativeElement=t}}return i.__NG_ELEMENT_ID__=YB,i})();function UB(i){return i instanceof Sn?i.nativeElement:i}class hu{}let Nd=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function jB(){const i=ve(),t=Hi(Tn().index,i);return function WB(i){return i[11]}(as(t)?t:i)}(),i})(),zB=(()=>{class i{}return i.\u0275prov=Fe({token:i,providedIn:"root",factory:()=>null}),i})();class oa{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const KB=new oa("13.3.3"),ny={};function _d(i,e,t,n,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(vn(s)),Fr(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&_d(l[1],l,c,n)}const o=t.type;if(8&o)_d(i,e,t.child,n);else if(32&o){const a=qp(t,e);let l;for(;l=a();)n.push(l)}else if(16&o){const a=OA(e,t);if(Array.isArray(a))n.push(...a);else{const l=Xc(e[16]);_d(l[1],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}class du{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return _d(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Fr(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(tm(e,n),ed(t,n))}this._attachedToViewContainer=!1}EA(this._lView[1],this._lView)}onDestroy(e){ZA(this._lView[1],this._lView,null,e)}markForCheck(){Cm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Tm(this._lView[1],this._lView,this.context)}checkNoChanges(){!function QM(i,e,t){Yh(!0);try{Tm(i,e,t)}finally{Yh(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Le(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function KL(i,e){Zc(i,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Le(902,"");this._appRef=e}}class $B extends du{constructor(e){super(e),this._view=e}detectChanges(){lb(this._view)}checkNoChanges(){!function XM(i){Yh(!0);try{lb(i)}finally{Yh(!1)}}(this._view)}get context(){return null}}class yR extends uu{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Qn(e);return new iy(t,this.ngModule)}}function ER(i){const e=[];for(let t in i)i.hasOwnProperty(t)&&e.push({propName:i[t],templateName:t});return e}class iy extends pR{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function fM(i){return i.map(dM).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return ER(this.componentDef.inputs)}get outputs(){return ER(this.componentDef.outputs)}create(e,t,n,r){const s=(r=r||this.ngModule)?function qB(i,e){return{get:(t,n,r)=>{const s=i.get(t,ny,r);return s!==ny||n===ny?s:e.get(t,n,r)}}}(e,r.injector):e,o=s.get(hu,lS),a=s.get(zB,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=n?function XA(i,e,t){if(en(i))return i.selectRootElement(e,t===Lr.ShadowDom);let n="string"==typeof e?i.querySelector(e):e;return n.textContent="",n}(l,n,this.componentDef.encapsulation):em(o.createRenderer(null,this.componentDef),c,function JB(i){const e=i.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(c)),y=this.componentDef.onPush?576:528,R=function Nb(i,e){return{components:[],scheduler:i||GL,clean:ZM,playerHandler:e||null,flags:0}}(),D=pd(0,null,null,1,0,null,null,null,null,null),L=eu(null,D,R,y,null,null,o,l,a,s);let k,W;Uh(L);try{const X=function Ib(i,e,t,n,r,s){const o=t[1];t[20]=i;const l=cl(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(yd(l,c,!0),null!==i&&($h(r,i,c),null!==l.classes&&om(r,i,l.classes),null!==l.styles&&NA(r,i,l.styles)));const u=n.createRenderer(i,e),y=eu(t,qA(e),null,e.onPush?64:16,t[20],l,n,u,s||null,null);return o.firstCreatePass&&(Xh(Vc(l,t),o,e.type),rb(o,l),sb(l,t.length,1)),md(t,y),t[20]=y}(u,this.componentDef,L,o,l);if(u)if(n)$h(l,u,["ng-version",KB.full]);else{const{attrs:ne,classes:ce}=function gM(i){const e=[],t=[];let n=1,r=2;for(;n<i.length;){let s=i[n];if("string"==typeof s)2===r?""!==s&&e.push(s,i[++n]):8===r&&t.push(s);else{if(!Vr(r))break;r=s}n++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);ne&&$h(l,u,ne),ce&&ce.length>0&&om(l,u,ce.join(" "))}if(W=pp(D,20),void 0!==t){const ne=W.projection=[];for(let ce=0;ce<this.ngContentSelectors.length;ce++){const Ae=t[ce];ne.push(null!=Ae?Array.from(Ae):null)}}k=function Pb(i,e,t,n,r){const s=t[1],o=function MM(i,e,t){const n=Tn();i.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),ob(i,n,e,ul(i,e,1,null),t));const r=Gc(e,i,n.directiveStart,n);Zn(r,e);const s=pr(n,e);return s&&Zn(s,e),r}(s,t,e);if(n.components.push(o),i[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=Tn();e.contentQueries(1,o,l.directiveStart)}const a=Tn();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(yo(a.index),nb(t[1],a,0,a.directiveStart,a.directiveEnd,e),ib(e,o)),o}(X,this.componentDef,L,R,[v1]),tu(D,L,null)}finally{Wh()}return new XB(this.componentType,k,Il(W,L),L,W)}}class XB extends class VB{}{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new $B(r),this.componentType=e}get injector(){return new qa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class Ws{}class wR{}const Pl=new Map;class AR extends Ws{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new yR(this);const n=dr(e);this._bootstrapComponents=ds(n.bootstrap),this._r3Injector=yb(e,t,[{provide:Ws,useValue:this},{provide:uu,useValue:this.componentFactoryResolver}],Pt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Pi.THROW_IF_NOT_FOUND,n=Qe.Default){return e===Pi||e===Ws||e===Im?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class ry extends wR{constructor(e){super(),this.moduleType=e,null!==dr(e)&&function ek(i){const e=new Set;!function t(n){const r=dr(n,!0),s=r.id;null!==s&&(function vR(i,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${i} - ${Pt(e)} vs ${Pt(e.name)}`)}(s,Pl.get(s),n),Pl.set(s,n));const o=ds(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(i)}(e)}create(e){return new AR(this.moduleType,e)}}function Nl(i,e,t,n){return function bR(i,e,t,n,r,s){const o=e+t;return ei(i,o,r)?function gs(i,e,t){return i[e]=t}(i,o+1,s?n.call(s,r):n(r)):function fu(i,e){const t=i[e];return t===Ze?void 0:t}(i,o+1)}(ve(),function pi(){const i=$e.lFrame;let e=i.bindingRootIndex;return-1===e&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}(),i,e,t,n)}function sy(i){return e=>{setTimeout(i,void 0,e)}}const Mt=class yk extends Ee{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){var r,s,o;let a=e,l=t||(()=>null),c=n;if(e&&"object"==typeof e){const y=e;a=null===(r=y.next)||void 0===r?void 0:r.bind(y),l=null===(s=y.error)||void 0===s?void 0:s.bind(y),c=null===(o=y.complete)||void 0===o?void 0:o.bind(y)}this.__isAsync&&(l=sy(l),a&&(a=sy(a)),c&&(c=sy(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof f&&e.add(u),u}};function Ek(){return this._results[gl()]()}class Dd{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=gl(),n=Dd.prototype;n[t]||(n[t]=Ek)}get changes(){return this._changes||(this._changes=new Mt)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=yr(e);(this._changesDetected=!function Ax(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let js=(()=>{class i{}return i.__NG_ELEMENT_ID__=Sk,i})();const wk=js,vk=class extends wk{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e){const t=this._declarationTContainer.tViews,n=eu(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(n[19]=s.createEmbeddedView(t)),tu(t,n,e),new du(n)}};function Sk(){return xd(Tn(),ve())}function xd(i,e){return 4&i.type?new vk(e,i,Il(i,e)):null}let jr=(()=>{class i{}return i.__NG_ELEMENT_ID__=Ak,i})();function Ak(){return NR(Tn(),ve())}const bk=jr,IR=class extends bk{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Il(this._hostTNode,this._hostLView)}get injector(){return new qa(this._hostTNode,this._hostLView)}get parentInjector(){const e=Qh(this._hostTNode,this._hostLView);if(CS(e)){const t=Ja(e,this._hostLView),n=$a(e);return new qa(t[1].data[n+8],t)}return new qa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=PR(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){const r=e.createEmbeddedView(t||{});return this.insert(r,n),r}createComponent(e,t,n,r,s){const o=e&&!function Yc(i){return"function"==typeof i}(e);let a;if(o)a=t;else{const y=t||{};a=y.index,n=y.injector,r=y.projectableNodes,s=y.ngModuleRef}const l=o?e:new iy(Qn(e)),c=n||this.parentInjector;if(!s&&null==l.ngModule){const R=(o?c:this.parentInjector).get(Ws,null);R&&(s=R)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const n=e._lView,r=n[1];if(function WD(i){return Fr(i[3])}(n)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const y=n[3],R=new IR(y,y[6],y[3]);R.detach(R.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function JL(i,e,t,n){const r=10+n,s=t.length;n>0&&(t[r-1][4]=e),n<s-10?(e[4]=t[r],LS(t,10+n,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function qL(i,e){const t=i[9];e[16]!==e[3][3][16]&&(i[2]=!0),null===t?i[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(i),e[2]|=128}(r,n,o,s);const a=rm(s,o),l=n[11],c=cd(l,o[7]);return null!==c&&function zL(i,e,t,n,r,s){n[0]=r,n[6]=e,Zc(i,n,t,1,r,s)}(r,o[6],l,n,c,a),e.attachToViewContainerRef(),LS(oy(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=PR(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=tm(this._lContainer,t);n&&(ed(oy(this._lContainer),t),EA(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=tm(this._lContainer,t);return n&&null!=ed(oy(this._lContainer),t)?new du(n):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function PR(i){return i[8]}function oy(i){return i[8]||(i[8]=[])}function NR(i,e){let t;const n=e[i.index];if(Fr(n))t=n;else{let r;if(8&i.type)r=vn(n);else{const s=e[11];r=s.createComment("");const o=pr(i,e);ia(s,cd(s,o),r,function eM(i,e){return en(i)?i.nextSibling(e):e.nextSibling}(s,o),!1)}e[i.index]=t=ab(n,e,r,i),md(e,t)}return new IR(t,i,e)}class ay{constructor(e){this.queryList=e,this.matches=null}clone(){return new ay(this.queryList)}setDirty(){this.queryList.setDirty()}}class ly{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new ly(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==MR(e,t).matches&&this.queries[t].setDirty()}}class _R{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class cy{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new cy(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class uy{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new uy(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];this.matchTNodeWithReadOption(e,t,Tk(t,s)),this.matchTNodeWithReadOption(e,t,Zh(t,e,s,!1,!1))}else n===js?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Zh(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Sn||r===jr||r===js&&4&t.type)this.addMatch(t.index,-2);else{const s=Zh(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Tk(i,e){const t=i.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function Ik(i,e,t,n){return-1===t?function Ok(i,e){return 11&i.type?Il(i,e):4&i.type?xd(i,e):null}(e,i):-2===t?function Pk(i,e,t){return t===Sn?Il(e,i):t===js?xd(e,i):t===jr?NR(e,i):void 0}(i,e,n):Gc(i,i[1],t,e)}function DR(i,e,t,n){const r=e[19].queries[n];if(null===r.matches){const s=i.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:Ik(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function hy(i,e,t,n){const r=i.queries.getByIndex(t),s=r.matches;if(null!==s){const o=DR(i,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)n.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let y=10;y<u.length;y++){const R=u[y];R[17]===R[3]&&hy(R[1],R,c,n)}if(null!==u[9]){const y=u[9];for(let R=0;R<y.length;R++){const D=y[R];hy(D[1],D,c,n)}}}}}return n}function Fn(i){const e=ve(),t=yt(),n=pS();Ap(n+1);const r=MR(t,n);if(i.dirty&&cS(e)===(2==(2&r.metadata.flags))){if(null===r.matches)i.reset([]);else{const s=r.crossesNgTemplate?hy(t,e,n,[]):DR(t,e,r,n);i.reset(s,UB),i.notifyOnChanges()}return!0}return!1}function _l(i,e,t){const n=yt();n.firstCreatePass&&(LR(n,new _R(i,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),xR(n,ve(),e)}function zi(i,e,t,n){const r=yt();if(r.firstCreatePass){const s=Tn();LR(r,new _R(e,t,n),s.index),function _k(i,e){const t=i.contentQueries||(i.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(i.queries.length-1,e)}(r,i),2==(2&t)&&(r.staticContentQueries=!0)}xR(r,ve(),t)}function Bn(){return function Nk(i,e){return i[19].queries[e].queryList}(ve(),pS())}function xR(i,e,t){const n=new Dd(4==(4&t));ZA(i,e,n,n.destroy),null===e[19]&&(e[19]=new ly),e[19].queries.push(new ay(n))}function LR(i,e,t){null===i.queries&&(i.queries=new cy),i.queries.track(new uy(e,t))}function MR(i,e){return i.queries.getByIndex(e)}function dy(i,e){return xd(i,e)}function Fd(...i){}const Ey=new Ge("Application Initializer");let wy=(()=>{class i{constructor(t){this.appInits=t,this.resolve=Fd,this.reject=Fd,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Ad(s))t.push(s);else if(Xb(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),0===t.length&&n(),this.initialized=!0}}return i.\u0275fac=function(t){return new(t||i)(Re(Ey,8))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const mu=new Ge("AppId",{providedIn:"root",factory:function XR(){return`${vy()}${vy()}${vy()}`}});function vy(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ZR=new Ge("Platform Initializer"),Sy=new Ge("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),eT=new Ge("appBootstrapListener");let $k=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const zs=new Ge("LocaleId",{providedIn:"root",factory:()=>id(zs,Qe.Optional|Qe.SkipSelf)||function Jk(){return"undefined"!=typeof $localize&&$localize.locale||Rd}()});class Qk{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let tT=(()=>{class i{compileModuleSync(t){return new ry(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),s=ds(dr(t).declarations).reduce((o,a)=>{const l=Qn(a);return l&&o.push(new iy(l)),o},[]);return new Qk(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Zk=(()=>Promise.resolve(0))();function Ay(i){"undefined"==typeof Zone?Zk.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class St{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Mt(!1),this.onMicrotaskEmpty=new Mt(!1),this.onStable=new Mt(!1),this.onError=new Mt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function e2(){let i=_t.requestAnimationFrame,e=_t.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&e){const t=i[Zone.__symbol__("OriginalDelegate")];t&&(i=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function r2(i){const e=()=>{!function n2(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(_t,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,Cy(i),i.isCheckStableRunning=!0,by(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),Cy(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{try{return nT(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||i.shouldCoalesceRunChangeDetection)&&e(),iT(i)}},onInvoke:(t,n,r,s,o,a,l)=>{try{return nT(i),t.invoke(r,s,o,a,l)}finally{i.shouldCoalesceRunChangeDetection&&e(),iT(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&("microTask"==s.change?(i._hasPendingMicrotasks=s.microTask,Cy(i),by(i)):"macroTask"==s.change&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!St.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(St.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,t2,Fd,Fd);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const t2={};function by(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function Cy(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function nT(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function iT(i){i._nesting--,by(i)}class s2{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Mt,this.onMicrotaskEmpty=new Mt,this.onStable=new Mt,this.onError=new Mt}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}let Ry=(()=>{class i{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{St.assertNotInAngularZone(),Ay(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ay(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,r){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,n,r){return[]}}return i.\u0275fac=function(t){return new(t||i)(Re(St))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})(),o2=(()=>{class i{constructor(){this._applications=new Map,Ty.addToWindow(this)}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return Ty.findTestabilityInTree(this,t,n)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();class a2{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}let zr,Ty=new a2;const rT=new Ge("AllowMultipleToken");class sT{constructor(e,t){this.name=e,this.token=t}}function oT(i,e,t=[]){const n=`Platform: ${e}`,r=new Ge(n);return(s=[])=>{let o=aT();if(!o||o.injector.get(rT,!1))if(i)i(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:Pm,useValue:"platform"});!function h2(i){if(zr&&!zr.destroyed&&!zr.injector.get(rT,!1))throw new Le(400,"");zr=i.get(f2);const e=i.get(ZR,null);e&&e.forEach(t=>t())}(Pi.create({providers:a,name:n}))}return function d2(i){const e=aT();if(!e)throw new Le(401,"");return e}()}}function aT(){return zr&&!zr.destroyed?zr:null}let f2=(()=>{class i{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const a=function g2(i,e){let t;return t="noop"===i?new s2:("zone.js"===i?void 0:i)||new St({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(n?n.ngZone:void 0,{ngZoneEventCoalescing:n&&n.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:n&&n.ngZoneRunCoalescing||!1}),l=[{provide:St,useValue:a}];return a.run(()=>{const c=Pi.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),y=u.injector.get(wo,null);if(!y)throw new Le(402,"");return a.runOutsideAngular(()=>{const R=a.onError.subscribe({next:D=>{y.handleError(D)}});u.onDestroy(()=>{Iy(this._modules,u),R.unsubscribe()})}),function p2(i,e,t){try{const n=t();return Ad(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}(y,a,()=>{const R=u.injector.get(wy);return R.runInitializers(),R.donePromise.then(()=>(function WF(i){Vi(i,"Expected localeId to be defined"),"string"==typeof i&&(WC=i.toLowerCase().replace(/_/g,"-"))}(u.injector.get(zs,Rd)||Rd),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,n=[]){const r=lT({},n);return function c2(i,e,t){const n=new ry(t);return Promise.resolve(n)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const n=t.injector.get(Oy);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Le(403,"");t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Le(404,"");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(t){return new(t||i)(Re(Pi))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function lT(i,e){return Array.isArray(e)?e.reduce(lT,i):Object.assign(Object.assign({},i),e)}let Oy=(()=>{class i{constructor(t,n,r,s){this._zone=t,this._injector=n,this._exceptionHandler=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new K(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),a=new K(l=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{St.assertNotInAngularZone(),Ay(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const u=this._zone.onUnstable.subscribe(()=>{St.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{c.unsubscribe(),u.unsubscribe()}});this.isStable=zv(o,a.pipe(Kv()))}bootstrap(t,n){if(!this._initStatus.done)throw new Le(405,"");let r;r=t instanceof pR?t:this._injector.get(uu).resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function u2(i){return i.isBoundToModule}(r)?void 0:this._injector.get(Ws),a=r.create(Pi.NULL,[],n||r.selector,s),l=a.location.nativeElement,c=a.injector.get(Ry,null),u=c&&a.injector.get(o2);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),Iy(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Le(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;Iy(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(eT,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(t){return new(t||i)(Re(St),Re(Pi),Re(wo),Re(wy))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Iy(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}let uT=!0,hT=!1,aa=(()=>{class i{}return i.__NG_ELEMENT_ID__=w2,i})();function w2(i){return function v2(i,e,t){if(kh(i)&&!t){const n=Hi(i.index,e);return new du(n,n)}return 47&i.type?new du(e[16],e):null}(Tn(),ve(),16==(16&i))}class pT{constructor(){}supports(e){return iu(e)}create(e){return new T2(e)}}const R2=(i,e)=>e;class T2{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||R2}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<yT(n,r,s)?t:n,a=yT(o,r,s),l=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let R=0;R<c;R++){const D=R<s.length?s[R]:s[R]=0,L=D+R;u<=L&&L<c&&(s[R]=D+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!iu(e))throw new Le(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else r=0,function N1(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{const t=i[gl()]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),n=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new O2(t,n),s,r),e}_verifyReinsertion(e,t,n,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new mT),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new mT),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class O2{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class I2{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class mT{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new I2,this.map.set(t,n)),n.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function yT(i,e,t){const n=i.previousIndex;if(null===n)return n;let r=0;return t&&n<t.length&&(r=t[n]),n+e+r}function wT(){return new Vd([new pT])}let Vd=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(null!=n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||wT()),deps:[[i,new il,new kr]]}}find(t){const n=this.factories.find(r=>r.supports(t));if(null!=n)return n;throw new Le(901,"")}}return i.\u0275prov=Fe({token:i,providedIn:"root",factory:wT}),i})();const x2=oT(null,"core",[]);let L2=(()=>{class i{constructor(t){}}return i.\u0275fac=function(t){return new(t||i)(Re(Oy))},i.\u0275mod=wn({type:i}),i.\u0275inj=on({}),i})(),Gd=null;function Ro(){return Gd}const Nt=new Ge("DocumentToken");let ca=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:function(){return function k2(){return Re(ST)}()},providedIn:"platform"}),i})();const V2=new Ge("Location Initialized");let ST=(()=>{class i extends ca{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ro().getBaseHref(this._doc)}onPopState(t){const n=Ro().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=Ro().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,n,r){AT()?this._history.pushState(t,n,r):this.location.hash=r}replaceState(t,n,r){AT()?this._history.replaceState(t,n,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(Re(Nt))},i.\u0275prov=Fe({token:i,factory:function(){return function G2(){return new ST(Re(Nt))}()},providedIn:"platform"}),i})();function AT(){return!!window.history.pushState}function xy(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function bT(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function Ks(i){return i&&"?"!==i[0]?"?"+i:i}let xl=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:function(){return function H2(i){const e=Re(Nt).location;return new CT(Re(ca),e&&e.origin||"")}()},providedIn:"root"}),i})();const Ly=new Ge("appBaseHref");let CT=(()=>{class i extends xl{constructor(t,n){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==n&&(n=this._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=n}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return xy(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+Ks(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const o=this.prepareExternalUrl(r+Ks(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){const o=this.prepareExternalUrl(r+Ks(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,t)}}return i.\u0275fac=function(t){return new(t||i)(Re(ca),Re(Ly,8))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})(),Y2=(()=>{class i extends xl{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=xy(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+Ks(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+Ks(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,t)}}return i.\u0275fac=function(t){return new(t||i)(Re(ca),Re(Ly,8))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})(),My=(()=>{class i{constructor(t,n){this._subject=new Mt,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=bT(RT(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+Ks(n))}normalize(t){return i.stripTrailingSlash(function W2(i,e){return i&&e.startsWith(i)?e.substring(i.length):e}(this._baseHref,RT(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._platformStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ks(n)),r)}replaceState(t,n="",r=null){this._platformStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ks(n)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformStrategy).historyGo)||void 0===r||r.call(n,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}))}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=Ks,i.joinWithSlash=xy,i.stripTrailingSlash=bT,i.\u0275fac=function(t){return new(t||i)(Re(xl),Re(ca))},i.\u0275prov=Fe({token:i,factory:function(){return function U2(){return new My(Re(xl),Re(ca))}()},providedIn:"root"}),i})();function RT(i){return i.replace(/\/index.html$/,"")}class NV{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let LT=(()=>{class i{constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new NV(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)n.remove(null===s?void 0:s);else if(null!==s){const a=n.get(s);n.move(a,o),MT(a,r)}});for(let r=0,s=n.length;r<s;r++){const a=n.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{MT(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(we(jr),we(js),we(Vd))},i.\u0275dir=an({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),i})();function MT(i,e){i.context.$implicit=e.item}let Ll=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new _V,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){FT("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){FT("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(we(jr),we(js))},i.\u0275dir=an({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),i})();class _V{constructor(){this.$implicit=null,this.ngIf=null}}function FT(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${Pt(e)}'.`)}let kT=(()=>{class i{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(t.ngTemplateOutlet){const n=this._viewContainerRef;this._viewRef&&n.remove(n.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?n.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return i.\u0275fac=function(t){return new(t||i)(we(jr))},i.\u0275dir=an({type:i,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[po]}),i})(),qd=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({}),i})();const GT="browser";let aG=(()=>{class i{}return i.\u0275prov=Fe({token:i,providedIn:"root",factory:()=>new lG(Re(Nt),window)}),i})();class lG{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function cG(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=HT(this.window.history)||HT(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function HT(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class Jy extends class hG extends class B2{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function F2(i){Gd||(Gd=i)}(new Jy)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function dG(){return vu=vu||document.querySelector("base"),vu?vu.getAttribute("href"):null}();return null==t?null:function fG(i){Qd=Qd||document.createElement("a"),Qd.setAttribute("href",i);const e=Qd.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){vu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function OV(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Qd,vu=null;const YT=new Ge("TRANSITION_ID"),pG=[{provide:Ey,useFactory:function gG(i,e,t){return()=>{t.get(wy).donePromise.then(()=>{const n=Ro(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[YT,Nt,Pi],multi:!0}];class qy{static init(){!function l2(i){Ty=i}(new qy)}addToWindow(e){_t.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},_t.getAllAngularTestabilities=()=>e.getAllTestabilities(),_t.getAllAngularRootElements=()=>e.getAllRootElements(),_t.frameworkStabilizers||(_t.frameworkStabilizers=[]),_t.frameworkStabilizers.push(n=>{const r=_t.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&n(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:n?Ro().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let mG=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();const Xd=new Ge("EventManagerPlugins");let Zd=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(Re(Xd),Re(St))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();class UT{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Ro().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let WT=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})(),Su=(()=>{class i extends WT{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(n.appendChild(o))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(jT),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(t,r,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(jT))}}return i.\u0275fac=function(t){return new(t||i)(Re(Nt))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();function jT(i){Ro().remove(i)}const Qy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Xy=/%COMP%/g;function ef(i,e,t){for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?ef(i,r,t):(r=r.replace(Xy,i),t.push(r))}return t}function $T(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let tf=(()=>{class i{constructor(t,n,r){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Zy(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case Lr.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new AG(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(t),r}case 1:case Lr.ShadowDom:return new bG(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const r=ef(n.id,n.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(Re(Zd),Re(Su),Re(mu))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();class Zy{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Qy[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=Qy[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Qy[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Wi.DashCase|Wi.Important)?e.style.setProperty(t,n,r&Wi.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Wi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,$T(n)):this.eventManager.addEventListener(e,t,$T(n))}}class AG extends Zy{constructor(e,t,n,r){super(e),this.component=n;const s=ef(r+"-"+n.id,n.styles,[]);t.addStyles(s),this.contentAttr=function wG(i){return"_ngcontent-%COMP%".replace(Xy,i)}(r+"-"+n.id),this.hostAttr=function vG(i){return"_nghost-%COMP%".replace(Xy,i)}(r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class bG extends Zy{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=ef(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let CG=(()=>{class i extends UT{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(Re(Nt))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();const qT=["alt","control","meta","shift"],TG={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},QT={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},OG={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let IG=(()=>{class i extends UT{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ro().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="";if(qT.forEach(l=>{const c=n.indexOf(l);c>-1&&(n.splice(c,1),o+=l+".")}),o+=s,0!=n.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let n="",r=function PG(i){let e=i.key;if(null==e){if(e=i.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===i.location&&QT.hasOwnProperty(e)&&(e=QT[e]))}return TG[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),qT.forEach(s=>{s!=r&&OG[s](t)&&(n+=s+".")}),n+=r,n}static eventCallback(t,n,r){return s=>{i.getEventFullKey(s)===t&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(Re(Nt))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();const xG=oT(x2,"browser",[{provide:Sy,useValue:GT},{provide:ZR,useValue:function NG(){Jy.makeCurrent(),qy.init()},multi:!0},{provide:Nt,useFactory:function DG(){return function GD(i){fp=i}(document),document},deps:[]}]),LG=[{provide:Pm,useValue:"root"},{provide:wo,useFactory:function _G(){return new wo},deps:[]},{provide:Xd,useClass:CG,multi:!0,deps:[Nt,St,Sy]},{provide:Xd,useClass:IG,multi:!0,deps:[Nt]},{provide:tf,useClass:tf,deps:[Zd,Su,mu]},{provide:hu,useExisting:tf},{provide:WT,useExisting:Su},{provide:Su,useClass:Su,deps:[Nt]},{provide:Ry,useClass:Ry,deps:[St]},{provide:Zd,useClass:Zd,deps:[Xd,St]},{provide:class uG{},useClass:mG,deps:[]}];let XT=(()=>{class i{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:i,providers:[{provide:mu,useValue:t.appId},{provide:YT,useExisting:mu},pG]}}}return i.\u0275fac=function(t){return new(t||i)(Re(i,12))},i.\u0275mod=wn({type:i}),i.\u0275inj=on({providers:LG,imports:[qd,L2]}),i})();"undefined"!=typeof window&&window;let tE=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:function(t){let n=null;return n=t?new(t||i):Re(tO),n},providedIn:"root"}),i})(),tO=(()=>{class i extends tE{constructor(t){super(),this._doc=t}sanitize(t,n){if(null==n)return null;switch(t){case Ct.NONE:return n;case Ct.HTML:return us(n,"HTML")?Ui(n):iA(this._doc,String(n)).toString();case Ct.STYLE:return us(n,"Style")?Ui(n):n;case Ct.SCRIPT:if(us(n,"Script"))return Ui(n);throw new Error("unsafe value used in a script context");case Ct.URL:return JS(n),us(n,"URL")?Ui(n):$c(String(n));case Ct.RESOURCE_URL:if(us(n,"ResourceURL"))return Ui(n);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function Zx(i){return new $x(i)}(t)}bypassSecurityTrustStyle(t){return function eL(i){return new Jx(i)}(t)}bypassSecurityTrustScript(t){return function tL(i){return new qx(i)}(t)}bypassSecurityTrustUrl(t){return function nL(i){return new Qx(i)}(t)}bypassSecurityTrustResourceUrl(t){return function iL(i){return new Xx(i)}(t)}}return i.\u0275fac=function(t){return new(t||i)(Re(Nt))},i.\u0275prov=Fe({token:i,factory:function(t){let n=null;return n=t?new t:function WG(i){return new tO(i.get(Nt))}(Re(Pi)),n},providedIn:"root"}),i})();function Ue(...i){return zn(i,Nc(i))}class Sr extends Ee{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const{isArray:jG}=Array,{getPrototypeOf:zG,prototype:KG,keys:$G}=Object;function nO(i){if(1===i.length){const e=i[0];if(jG(e))return{args:e,keys:null};if(function JG(i){return i&&"object"==typeof i&&zG(i)===KG}(e)){const t=$G(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}const{isArray:qG}=Array;function nE(i){return de(e=>function QG(i,e){return qG(e)?i(...e):i(e)}(i,e))}function iO(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function rO(...i){const e=Nc(i),t=Yv(i),{args:n,keys:r}=nO(i);if(0===n.length)return zn([],e);const s=new K(function XG(i,e,t=J){return n=>{sO(e,()=>{const{length:r}=i,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)sO(e,()=>{const c=zn(i[l],e);let u=!1;c.subscribe(new he(n,y=>{s[l]=y,u||(u=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>iO(r,o):J));return t?s.pipe(nE(t)):s}function sO(i,e,t){i?Ms(t,i,e):e()}function Au(i,e){const t=v(i)?i:()=>i,n=r=>r.error(t());return new K(e?r=>e.schedule(n,0,r):n)}const nf=E(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function bu(...i){return function ZG(){return Pc(1)}()(zn(i,Nc(i)))}function oO(i){return new K(e=>{Bi(i()).subscribe(e)})}function aO(){return ae((i,e)=>{let t=null;i._refCount++;const n=new he(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class eH extends K{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Me(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new f;const t=this.getSubject();e.add(this.source.subscribe(new he(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=f.EMPTY)}return e}refCount(){return aO()(this)}}function ua(i,e){return ae((t,n)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&n.complete();t.subscribe(new he(n,l=>{null==r||r.unsubscribe();let c=0;const u=s++;Bi(i(l,u)).subscribe(r=new he(n,y=>n.next(e?e(l,y,u,c++):y),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function rf(...i){const e=Nc(i);return ae((t,n)=>{(e?bu(i,t,e):bu(i,t)).subscribe(n)})}function tH(i,e,t,n,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(new he(o,u=>{const y=c++;l=a?i(l,u,y):(a=!0,u),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function lO(i,e){return ae(tH(i,e,arguments.length>=2,!0))}function si(i,e){return ae((t,n)=>{let r=0;t.subscribe(new he(n,s=>i.call(e,s,r++)&&n.next(s)))})}function Js(i){return ae((e,t)=>{let s,n=null,r=!1;n=e.subscribe(new he(t,void 0,void 0,o=>{s=Bi(i(o,Js(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function Ml(i,e){return v(e)?yn(i,e,1):yn(i,1)}function iE(i){return i<=0?()=>Fs:ae((e,t)=>{let n=[];e.subscribe(new he(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function cO(i=nH){return ae((e,t)=>{let n=!1;e.subscribe(new he(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function nH(){return new nf}function uO(i){return ae((e,t)=>{let n=!1;e.subscribe(new he(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function ha(i,e){const t=arguments.length>=2;return n=>n.pipe(i?si((r,s)=>i(r,s,n)):J,Dr(1),t?uO(e):cO(()=>new nf))}function oi(i,e,t){const n=v(i)||e||t?{next:i,error:e,complete:t}:i;return n?ae((r,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;r.subscribe(new he(s,l=>{var c;null===(c=n.next)||void 0===c||c.call(n,l),s.next(l)},()=>{var l;a=!1,null===(l=n.complete)||void 0===l||l.call(n),s.complete()},l=>{var c;a=!1,null===(c=n.error)||void 0===c||c.call(n,l),s.error(l)},()=>{var l,c;a&&(null===(l=n.unsubscribe)||void 0===l||l.call(n)),null===(c=n.finalize)||void 0===c||c.call(n)}))}):J}function hO(i){return ae((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}class qs{constructor(e,t){this.id=e,this.url=t}}class rE extends qs{constructor(e,t,n="imperative",r=null){super(e,t),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Fl extends qs{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class dO extends qs{constructor(e,t,n){super(e,t),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class rH extends qs{constructor(e,t,n){super(e,t),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class sH extends qs{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class oH extends qs{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class aH extends qs{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class lH extends qs{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cH extends qs{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fO{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class gO{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class uH{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hH{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dH{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class fH{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pO{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const ct="primary";class gH{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Bl(i){return new gH(i)}const mO="ngNavigationCancelingError";function sE(i){const e=Error("NavigationCancelingError: "+i);return e[mO]=!0,e}function mH(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function ys(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!yO(i[r],e[r]))return!1;return!0}function yO(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function EO(i){return Array.prototype.concat.apply([],i)}function wO(i){return i.length>0?i[i.length-1]:null}function Kn(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function Es(i){return Xb(i)?i:Ad(i)?zn(Promise.resolve(i)):Ue(i)}const wH={exact:function AO(i,e,t){if(!fa(i.segments,e.segments)||!sf(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!AO(i.children[n],e.children[n],t))return!1;return!0},subset:bO},vO={exact:function vH(i,e){return ys(i,e)},subset:function SH(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>yO(i[t],e[t]))},ignored:()=>!0};function SO(i,e,t){return wH[t.paths](i.root,e.root,t.matrixParams)&&vO[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function bO(i,e,t){return CO(i,e,e.segments,t)}function CO(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!fa(r,t)||e.hasChildren()||!sf(r,t,n))}if(i.segments.length===t.length){if(!fa(i.segments,t)||!sf(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!bO(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(fa(i.segments,r)&&sf(i.segments,r,n)&&i.children[ct])&&CO(i.children[ct],e,s,n)}}function sf(i,e,t){return e.every((n,r)=>vO[t](i[r].parameters,n.parameters))}class da{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Bl(this.queryParams)),this._queryParamMap}toString(){return CH.serialize(this)}}class gt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Kn(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return af(this)}}class Cu{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Bl(this.parameters)),this._parameterMap}toString(){return PO(this)}}function fa(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}class RO{}class TO{parse(e){const t=new xH(e);return new da(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Ru(e.root,!0)}`,n=function OH(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${lf(t)}=${lf(r)}`).join("&"):`${lf(t)}=${lf(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function RH(i){return encodeURI(i)}(e.fragment)}`:""}`}}const CH=new TO;function af(i){return i.segments.map(e=>PO(e)).join("/")}function Ru(i,e){if(!i.hasChildren())return af(i);if(e){const t=i.children[ct]?Ru(i.children[ct],!1):"",n=[];return Kn(i.children,(r,s)=>{s!==ct&&n.push(`${s}:${Ru(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function bH(i,e){let t=[];return Kn(i.children,(n,r)=>{r===ct&&(t=t.concat(e(n,r)))}),Kn(i.children,(n,r)=>{r!==ct&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===ct?[Ru(i.children[ct],!1)]:[`${r}:${Ru(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[ct]?`${af(i)}/${t[0]}`:`${af(i)}/(${t.join("//")})`}}function OO(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function lf(i){return OO(i).replace(/%3B/gi,";")}function oE(i){return OO(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function cf(i){return decodeURIComponent(i)}function IO(i){return cf(i.replace(/\+/g,"%20"))}function PO(i){return`${oE(i.path)}${function TH(i){return Object.keys(i).map(e=>`;${oE(e)}=${oE(i[e])}`).join("")}(i.parameters)}`}const IH=/^[^\/()?;=#]+/;function uf(i){const e=i.match(IH);return e?e[0]:""}const PH=/^[^=?&#]+/,_H=/^[^&#]+/;class xH{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new gt([],{}):new gt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[ct]=new gt(e,t)),n}parseSegment(){const e=uf(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Cu(cf(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=uf(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=uf(this.remaining);r&&(n=r,this.capture(n))}e[cf(t)]=cf(n)}parseQueryParam(e){const t=function NH(i){const e=i.match(PH);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function DH(i){const e=i.match(_H);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const r=IO(t),s=IO(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=uf(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;n.indexOf(":")>-1?(s=n.substr(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ct);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[ct]:new gt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class NO{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=aE(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=aE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=lE(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return lE(e,this._root).map(t=>t.value)}}function aE(i,e){if(i===e.value)return e;for(const t of e.children){const n=aE(i,t);if(n)return n}return null}function lE(i,e){if(i===e.value)return[e];for(const t of e.children){const n=lE(i,t);if(n.length)return n.unshift(e),n}return[]}class Qs{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function kl(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class _O extends NO{constructor(e,t){super(e),this.snapshot=t,cE(this,e)}toString(){return this.snapshot.toString()}}function DO(i,e){const t=function LH(i,e){const o=new hf([],{},{},"",{},ct,e,null,i.root,-1,{});return new LO("",new Qs(o,[]))}(i,e),n=new Sr([new Cu("",{})]),r=new Sr({}),s=new Sr({}),o=new Sr({}),a=new Sr(""),l=new Vl(n,r,o,a,s,ct,e,t.root);return l.snapshot=t.root,new _O(new Qs(l,[]),t)}class Vl{constructor(e,t,n,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(de(e=>Bl(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(de(e=>Bl(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function xO(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function MH(i){return i.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(n))}class hf{constructor(e,t,n,r,s,o,a,l,c,u,y){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=y}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Bl(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Bl(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class LO extends NO{constructor(e,t){super(t),this.url=e,cE(this,t)}toString(){return MO(this._root)}}function cE(i,e){e.value._routerState=i,e.children.forEach(t=>cE(i,t))}function MO(i){const e=i.children.length>0?` { ${i.children.map(MO).join(", ")} } `:"";return`${i.value}${e}`}function uE(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,ys(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),ys(e.params,t.params)||i.params.next(t.params),function yH(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!ys(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),ys(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function hE(i,e){const t=ys(i.params,e.params)&&function AH(i,e){return fa(i,e)&&i.every((t,n)=>ys(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||hE(i.parent,e.parent))}function Tu(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function BH(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return Tu(i,n,r);return Tu(i,n)})}(i,e,t);return new Qs(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Tu(i,a)),o}}const n=function kH(i){return new Vl(new Sr(i.url),new Sr(i.params),new Sr(i.queryParams),new Sr(i.fragment),new Sr(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>Tu(i,s));return new Qs(n,r)}}function df(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Ou(i){return"object"==typeof i&&null!=i&&i.outlets}function dE(i,e,t,n,r){let s={};if(n&&Kn(n,(a,l)=>{s[l]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),i===e)return new da(t,s,r);const o=FO(i,e,t);return new da(o,s,r)}function FO(i,e,t){const n={};return Kn(i.children,(r,s)=>{n[s]=r===e?t:FO(r,e,t)}),new gt(i.segments,n)}class BO{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&df(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(Ou);if(r&&r!==wO(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class fE{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function kO(i,e,t){if(i||(i=new gt([],{})),0===i.segments.length&&i.hasChildren())return ff(i,e,t);const n=function WH(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const o=i.segments[r],a=t[n];if(Ou(a))break;const l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!GO(l,c,o))return s;n+=2}else{if(!GO(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new gt(i.segments.slice(0,n.pathIndex),{});return s.children[ct]=new gt(i.segments.slice(n.pathIndex),i.children),ff(s,0,r)}return n.match&&0===r.length?new gt(i.segments,{}):n.match&&!i.hasChildren()?gE(i,e,t):n.match?ff(i,0,r):gE(i,e,t)}function ff(i,e,t){if(0===t.length)return new gt(i.segments,{});{const n=function UH(i){return Ou(i[0])?i[0].outlets:{[ct]:i}}(t),r={};return Kn(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=kO(i.children[o],e,s))}),Kn(i.children,(s,o)=>{void 0===n[o]&&(r[o]=s)}),new gt(i.segments,r)}}function gE(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Ou(s)){const l=jH(s.outlets);return new gt(n,l)}if(0===r&&df(t[0])){n.push(new Cu(i.segments[e].path,VO(t[0]))),r++;continue}const o=Ou(s)?s.outlets[ct]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&df(a)?(n.push(new Cu(o,VO(a))),r+=2):(n.push(new Cu(o,{})),r++)}return new gt(n,{})}function jH(i){const e={};return Kn(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=gE(new gt([],{}),0,t))}),e}function VO(i){const e={};return Kn(i,(t,n)=>e[n]=`${t}`),e}function GO(i,e,t){return i==t.path&&ys(e,t.parameters)}class KH{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),uE(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=kl(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),Kn(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=kl(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=kl(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=kl(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new fH(s.value.snapshot))}),e.children.length&&this.forwardEvent(new hH(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(uE(r),r===s)if(r.component){const o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),uE(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=function $H(i){for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class pE{constructor(e,t){this.routes=e,this.module=t}}function Oo(i){return"function"==typeof i}function ga(i){return i instanceof da}const Iu=Symbol("INITIAL_VALUE");function Pu(){return ua(i=>rO(i.map(e=>e.pipe(Dr(1),rf(Iu)))).pipe(lO((e,t)=>{let n=!1;return t.reduce((r,s,o)=>r!==Iu?r:(s===Iu&&(n=!0),n||!1!==s&&o!==t.length-1&&!ga(s)?r:s),e)},Iu),si(e=>e!==Iu),de(e=>ga(e)?e:!0===e),Dr(1)))}class eY{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Nu,this.attachRef=null}}class Nu{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new eY,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let mE=(()=>{class i{constructor(t,n,r,s,o){this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new Mt,this.deactivateEvents=new Mt,this.attachEvents=new Mt,this.detachEvents=new Mt,this.name=s||ct,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const o=(n=n||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new tY(t,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)(we(Nu),we(jr),we(uu),Qa("name"),we(aa))},i.\u0275dir=an({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),i})();class tY{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Vl?this.route:e===Nu?this.childContexts:this.parent.get(e,t)}}let HO=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=En({type:i,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,n){1&t&&ti(0,"router-outlet")},directives:[mE],encapsulation:2}),i})();function YO(i,e=""){for(let t=0;t<i.length;t++){const n=i[t];nY(n,iY(e,n))}}function nY(i,e){i.children&&YO(i.children,e)}function iY(i,e){return e?i||e.path?i&&!e.path?`${i}/`:!i&&e.path?e.path:`${i}/${e.path}`:"":i}function yE(i){const e=i.children&&i.children.map(yE),t=e?Object.assign(Object.assign({},i),{children:e}):Object.assign({},i);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ct&&(t.component=HO),t}function Ar(i){return i.outlet||ct}function UO(i,e){const t=i.filter(n=>Ar(n)===e);return t.push(...i.filter(n=>Ar(n)!==e)),t}const WO={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function gf(i,e,t){var n;if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?Object.assign({},WO):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const s=(e.matcher||mH)(t,i,e);if(!s)return Object.assign({},WO);const o={};Kn(s.posParams,(l,c)=>{o[c]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:a,positionalParamSegments:null!==(n=s.posParams)&&void 0!==n?n:{}}}function pf(i,e,t,n,r="corrected"){if(t.length>0&&function oY(i,e,t){return t.some(n=>mf(i,e,n)&&Ar(n)!==ct)}(i,t,n)){const o=new gt(e,function sY(i,e,t,n){const r={};r[ct]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Ar(s)!==ct){const o=new gt([],{});o._sourceSegment=i,o._segmentIndexShift=e.length,r[Ar(s)]=o}return r}(i,e,n,new gt(t,i.children)));return o._sourceSegment=i,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function aY(i,e,t){return t.some(n=>mf(i,e,n))}(i,t,n)){const o=new gt(i.segments,function rY(i,e,t,n,r,s){const o={};for(const a of n)if(mf(i,t,a)&&!r[Ar(a)]){const l=new gt([],{});l._sourceSegment=i,l._segmentIndexShift="legacy"===s?i.segments.length:e.length,o[Ar(a)]=l}return Object.assign(Object.assign({},r),o)}(i,e,t,n,i.children,r));return o._sourceSegment=i,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new gt(i.segments,i.children);return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function mf(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function jO(i,e,t,n){return!!(Ar(i)===n||n!==ct&&mf(e,t,i))&&("**"===i.path||gf(e,i,t).matched)}function zO(i,e,t){return 0===e.length&&!i.children[t]}class yf{constructor(e){this.segmentGroup=e||null}}class KO{constructor(e){this.urlTree=e}}function _u(i){return Au(new yf(i))}function $O(i){return Au(new KO(i))}class hY{constructor(e,t,n,r,s){this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(Ws)}apply(){const e=pf(this.urlTree.root,[],[],this.config).segmentGroup,t=new gt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,ct).pipe(de(s=>this.createUrlTree(EE(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Js(s=>{if(s instanceof KO)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof yf?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,ct).pipe(de(r=>this.createUrlTree(EE(r),e.queryParams,e.fragment))).pipe(Js(r=>{throw r instanceof yf?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,n){const r=e.segments.length>0?new gt([],{[ct]:e}):e;return new da(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(de(s=>new gt([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return zn(r).pipe(Ml(s=>{const o=n.children[s],a=UO(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(de(l=>({segment:l,outlet:s})))}),lO((s,o)=>(s[o.outlet]=o.segment,s),{}),function iH(i,e){const t=arguments.length>=2;return n=>n.pipe(i?si((r,s)=>i(r,s,n)):J,iE(1),t?uO(e):cO(()=>new nf))}())}expandSegment(e,t,n,r,s,o){return zn(n).pipe(Ml(a=>this.expandSegmentAgainstRoute(e,t,n,a,r,s,o).pipe(Js(c=>{if(c instanceof yf)return Ue(null);throw c}))),ha(a=>!!a),Js((a,l)=>{if(a instanceof nf||"EmptyError"===a.name)return zO(t,r,s)?Ue(new gt([],{})):_u(t);throw a}))}expandSegmentAgainstRoute(e,t,n,r,s,o,a){return jO(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o):_u(t):_u(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?$O(s):this.lineralizeSegments(n,s).pipe(yn(o=>{const a=new gt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=gf(t,r,s);if(!a)return _u(t);const y=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?$O(y):this.lineralizeSegments(r,y).pipe(yn(R=>this.expandSegment(e,t,n,R.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){if("**"===n.path)return n.loadChildren?(n._loadedConfig?Ue(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(de(y=>(n._loadedConfig=y,new gt(r,{})))):Ue(new gt(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=gf(t,n,r);return o?this.getChildConfig(e,n,r).pipe(yn(u=>{const y=u.module,R=u.routes,{segmentGroup:D,slicedSegments:L}=pf(t,a,l,R),k=new gt(D.segments,D.children);if(0===L.length&&k.hasChildren())return this.expandChildren(y,R,k).pipe(de(ce=>new gt(a,ce)));if(0===R.length&&0===L.length)return Ue(new gt(a,{}));const W=Ar(n)===s;return this.expandSegment(y,k,R,L,W?ct:s,!0).pipe(de(ne=>new gt(a.concat(ne.segments),ne.children)))})):_u(t)}getChildConfig(e,t,n){return t.children?Ue(new pE(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Ue(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(yn(r=>r?this.configLoader.load(e.injector,t).pipe(de(s=>(t._loadedConfig=s,s))):function cY(i){return Au(sE(`Cannot load children because the guard of the route "path: '${i.path}'" returned false`))}(t))):Ue(new pE([],e))}runCanLoadGuards(e,t,n){const r=t.canLoad;return r&&0!==r.length?Ue(r.map(o=>{const a=e.get(o);let l;if(function qH(i){return i&&Oo(i.canLoad)}(a))l=a.canLoad(t,n);else{if(!Oo(a))throw new Error("Invalid CanLoad guard");l=a(t,n)}return Es(l)})).pipe(Pu(),oi(o=>{if(!ga(o))return;const a=sE(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),de(o=>!0===o)):Ue(!0)}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Ue(n);if(r.numberOfChildren>1||!r.children[ct])return Au(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));r=r.children[ct]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreatreUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new da(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Kn(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);n[s]=t[a]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let o={};return Kn(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,n,r)}),new gt(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}function EE(i){const e={};for(const n of Object.keys(i.children)){const s=EE(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function dY(i){if(1===i.numberOfChildren&&i.children[ct]){const e=i.children[ct];return new gt(i.segments.concat(e.segments),e.children)}return i}(new gt(i.segments,e))}class JO{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Ef{constructor(e,t){this.component=e,this.route=t}}function gY(i,e,t){const n=i._root;return Du(n,e?e._root:null,t,[n.value])}function wf(i,e,t){const n=function mY(i){if(!i)return null;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(n?n.module.injector:t).get(i)}function Du(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=kl(e);return i.children.forEach(o=>{(function yY(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function EY(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!fa(i.url,e.url);case"pathParamsOrQueryParamsChange":return!fa(i.url,e.url)||!ys(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hE(i,e)||!ys(i.queryParams,e.queryParams);default:return!hE(i,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new JO(n)):(s.data=o.data,s._resolvedData=o._resolvedData),Du(i,e,s.component?a?a.children:null:t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Ef(a.outlet.component,o))}else o&&xu(e,a,r),r.canActivateChecks.push(new JO(n)),Du(i,null,s.component?a?a.children:null:t,n,r)})(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),Kn(s,(o,a)=>xu(o,t.getContext(a),r)),r}function xu(i,e,t){const n=kl(i),r=i.value;Kn(n,(s,o)=>{xu(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Ef(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class OY{}function qO(i){return new K(e=>e.error(i))}class PY{constructor(e,t,n,r,s,o){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=pf(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,ct);if(null===t)return null;const n=new hf([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},ct,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Qs(n,t),s=new LO(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,n=xO(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}processChildren(e,t){const n=[];for(const s of Object.keys(t.children)){const o=t.children[s],a=UO(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;n.push(...l)}const r=QO(n);return function NY(i){i.sort((e,t)=>e.value.outlet===ct?-1:t.value.outlet===ct?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,n,r){for(const s of e){const o=this.processSegmentAgainstRoute(s,t,n,r);if(null!==o)return o}return zO(t,n,r)?[]:null}processSegmentAgainstRoute(e,t,n,r){if(e.redirectTo||!jO(e,t,n,r))return null;let s,o=[],a=[];if("**"===e.path){const D=n.length>0?wO(n).parameters:{};s=new hf(n,D,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,eI(e),Ar(e),e.component,e,XO(t),ZO(t)+n.length,tI(e))}else{const D=gf(t,e,n);if(!D.matched)return null;o=D.consumedSegments,a=D.remainingSegments,s=new hf(o,D.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,eI(e),Ar(e),e.component,e,XO(t),ZO(t)+o.length,tI(e))}const l=function _Y(i){return i.children?i.children:i.loadChildren?i._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:u}=pf(t,o,a,l.filter(D=>void 0===D.redirectTo),this.relativeLinkResolution);if(0===u.length&&c.hasChildren()){const D=this.processChildren(l,c);return null===D?null:[new Qs(s,D)]}if(0===l.length&&0===u.length)return[new Qs(s,[])];const y=Ar(e)===r,R=this.processSegment(l,c,u,y?ct:r);return null===R?null:[new Qs(s,R)]}}function DY(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function QO(i){const e=[],t=new Set;for(const n of i){if(!DY(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=QO(n.children);e.push(new Qs(n.value,r))}return e.filter(n=>!t.has(n))}function XO(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function ZO(i){let e=i,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function eI(i){return i.data||{}}function tI(i){return i.resolve||{}}function nI(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function wE(i){return ua(e=>{const t=i(e);return t?zn(t).pipe(de(()=>e)):Ue(e)})}class GY extends class VY{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const vE=new Ge("ROUTES");class iI{constructor(e,t,n,r){this.injector=e,this.compiler=t,this.onLoadStartListener=n,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const r=this.loadModuleFactory(t.loadChildren).pipe(de(s=>{this.onLoadEndListener&&this.onLoadEndListener(t);const o=s.create(e);return new pE(EO(o.injector.get(vE,void 0,Qe.Self|Qe.Optional)).map(yE),o)}),Js(s=>{throw t._loader$=void 0,s}));return t._loader$=new eH(r,()=>new Ee).pipe(aO()),t._loader$}loadModuleFactory(e){return Es(e()).pipe(yn(t=>t instanceof wR?Ue(t):zn(this.compiler.compileModuleAsync(t))))}}class YY{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function UY(i){throw i}function WY(i,e,t){return e.parse("/")}function rI(i,e){return Ue(null)}const jY={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},zY={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let _i=(()=>{class i{constructor(t,n,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Ee,this.errorHandler=UY,this.malformedUriErrorHandler=WY,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:rI,afterPreactivation:rI},this.urlHandlingStrategy=new YY,this.routeReuseStrategy=new GY,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(Ws),this.console=o.get($k);const y=o.get(St);this.isNgZoneEnabled=y instanceof St&&St.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function EH(){return new da(new gt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new iI(o,a,R=>this.triggerEvent(new fO(R)),R=>this.triggerEvent(new gO(R))),this.routerState=DO(this.currentUrlTree,this.rootComponentType),this.transitions=new Sr({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const n=this.events;return t.pipe(si(r=>0!==r.id),de(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),ua(r=>{let s=!1,o=!1;return Ue(r).pipe(oi(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),ua(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return sI(a.source)&&(this.browserUrlTree=a.extractedUrl),Ue(a).pipe(ua(y=>{const R=this.transitions.getValue();return n.next(new rE(y.id,this.serializeUrl(y.extractedUrl),y.source,y.restoredState)),R!==this.transitions.getValue()?Fs:Promise.resolve(y)}),function fY(i,e,t,n){return ua(r=>function uY(i,e,t,n,r){return new hY(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe(de(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),oi(y=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:y.urlAfterRedirects})}),function xY(i,e,t,n,r){return yn(s=>function IY(i,e,t,n,r="emptyOnly",s="legacy"){try{const o=new PY(i,e,t,n,r,s).recognize();return null===o?qO(new OY):Ue(o)}catch(o){return qO(o)}}(i,e,s.urlAfterRedirects,t(s.urlAfterRedirects),n,r).pipe(de(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,y=>this.serializeUrl(y),this.paramsInheritanceStrategy,this.relativeLinkResolution),oi(y=>{if("eager"===this.urlUpdateStrategy){if(!y.extras.skipLocationChange){const D=this.urlHandlingStrategy.merge(y.urlAfterRedirects,y.rawUrl);this.setBrowserUrl(D,y)}this.browserUrlTree=y.urlAfterRedirects}const R=new sH(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot);n.next(R)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:R,extractedUrl:D,source:L,restoredState:k,extras:W}=a,X=new rE(R,this.serializeUrl(D),L,k);n.next(X);const ne=DO(D,this.rootComponentType).snapshot;return Ue(Object.assign(Object.assign({},a),{targetSnapshot:ne,urlAfterRedirects:D,extras:Object.assign(Object.assign({},W),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),Fs}),wE(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:y,extras:{skipLocationChange:R,replaceUrl:D}}=a;return this.hooks.beforePreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:y,skipLocationChange:!!R,replaceUrl:!!D})}),oi(a=>{const l=new oH(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),de(a=>Object.assign(Object.assign({},a),{guards:gY(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function wY(i,e){return yn(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Ue(Object.assign(Object.assign({},t),{guardsResult:!0})):function vY(i,e,t,n){return zn(i).pipe(yn(r=>function TY(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Ue(s.map(a=>{const l=wf(a,e,r);let c;if(function ZH(i){return i&&Oo(i.canDeactivate)}(l))c=Es(l.canDeactivate(i,e,t,n));else{if(!Oo(l))throw new Error("Invalid CanDeactivate guard");c=Es(l(i,e,t,n))}return c.pipe(ha())})).pipe(Pu()):Ue(!0)}(r.component,r.route,t,e,n)),ha(r=>!0!==r,!0))}(o,n,r,i).pipe(yn(a=>a&&function JH(i){return"boolean"==typeof i}(a)?function SY(i,e,t,n){return zn(e).pipe(Ml(r=>bu(function bY(i,e){return null!==i&&e&&e(new uH(i)),Ue(!0)}(r.route.parent,n),function AY(i,e){return null!==i&&e&&e(new dH(i)),Ue(!0)}(r.route,n),function RY(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function pY(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(o)).filter(o=>null!==o).map(o=>oO(()=>Ue(o.guards.map(l=>{const c=wf(l,o.node,t);let u;if(function XH(i){return i&&Oo(i.canActivateChild)}(c))u=Es(c.canActivateChild(n,i));else{if(!Oo(c))throw new Error("Invalid CanActivateChild guard");u=Es(c(n,i))}return u.pipe(ha())})).pipe(Pu())));return Ue(s).pipe(Pu())}(i,r.path,t),function CY(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Ue(!0);const r=n.map(s=>oO(()=>{const o=wf(s,e,t);let a;if(function QH(i){return i&&Oo(i.canActivate)}(o))a=Es(o.canActivate(e,i));else{if(!Oo(o))throw new Error("Invalid CanActivate guard");a=Es(o(e,i))}return a.pipe(ha())}));return Ue(r).pipe(Pu())}(i,r.route,t))),ha(r=>!0!==r,!0))}(n,s,i,e):Ue(a)),de(a=>Object.assign(Object.assign({},t),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),oi(a=>{if(ga(a.guardsResult)){const c=sE(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new aH(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),si(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),wE(a=>{if(a.guards.canActivateChecks.length)return Ue(a).pipe(oi(l=>{const c=new lH(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),ua(l=>{let c=!1;return Ue(l).pipe(function LY(i,e){return yn(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return Ue(t);let s=0;return zn(r).pipe(Ml(o=>function MY(i,e,t,n){return function FY(i,e,t,n){const r=nI(i);if(0===r.length)return Ue({});const s={};return zn(r).pipe(yn(o=>function BY(i,e,t,n){const r=wf(i,e,n);return Es(r.resolve?r.resolve(e,t):r(e,t))}(i[o],e,t,n).pipe(oi(a=>{s[o]=a}))),iE(1),yn(()=>nI(s).length===r.length?Ue(s):Fs))}(i._resolve,i,e,n).pipe(de(s=>(i._resolvedData=s,i.data=Object.assign(Object.assign({},i.data),xO(i,t).resolve),null)))}(o.route,n,i,e)),oi(()=>s++),iE(1),yn(o=>s===r.length?Ue(t):Fs))})}(this.paramsInheritanceStrategy,this.ngModule.injector),oi({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),oi(l=>{const c=new cH(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),wE(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:y,extras:{skipLocationChange:R,replaceUrl:D}}=a;return this.hooks.afterPreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:y,skipLocationChange:!!R,replaceUrl:!!D})}),de(a=>{const l=function FH(i,e,t){const n=Tu(i,e._root,t?t._root:void 0);return new _O(n,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),oi(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((i,e,t)=>de(n=>(new KH(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),oi({next(){s=!0},complete(){s=!0}}),hO(()=>{var a;s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),Js(a=>{if(o=!0,function pH(i){return i&&i[mO]}(a)){const l=ga(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const c=new dO(r.id,this.serializeUrl(r.extractedUrl),a.message);n.next(c),l?setTimeout(()=>{const u=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),y={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||sI(r.source)};this.scheduleNavigation(u,"imperative",null,y,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new rH(r.id,this.serializeUrl(r.extractedUrl),a);n.next(l);try{r.resolve(this.errorHandler(a))}catch(c){r.reject(c)}}return Fs}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{var r;const s={replaceUrl:!0},o=(null===(r=t.state)||void 0===r?void 0:r.navigationId)?t.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t.url);this.scheduleNavigation(a,n,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){YO(t),this.config=t.map(yE),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let y=null;switch(a){case"merge":y=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":y=this.currentUrlTree.queryParams;break;default:y=s||null}return null!==y&&(y=this.removeEmptyProps(y)),function VH(i,e,t,n,r){if(0===t.length)return dE(e.root,e.root,e.root,n,r);const s=function GH(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new BO(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Kn(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new BO(t,e,n)}(t);if(s.toRoot())return dE(e.root,e.root,new gt([],{}),n,r);const o=function HH(i,e,t){if(i.isAbsolute)return new fE(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const s=t.snapshot._urlSegment;return new fE(s,s===e.root,0)}const n=df(i.commands[0])?0:1;return function YH(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new fE(n,!1,r-s)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+n,i.numberOfDoubleDots)}(s,e,i),a=o.processChildren?ff(o.segmentGroup,o.index,s.commands):kO(o.segmentGroup,o.index,s.commands);return dE(e.root,o.segmentGroup,a,n,r)}(c,this.currentUrlTree,t,y,null!=u?u:null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=ga(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,n)}navigate(t,n={skipLocationChange:!1}){return function KY(i){for(let e=0;e<i.length;e++){const t=i[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?Object.assign({},jY):!1===n?Object.assign({},zY):n,ga(t))return SO(this.currentUrlTree,t,r);const s=this.parseUrl(t);return SO(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Fl(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,n,r,s,o){var a,l;if(this.disposed)return Promise.resolve(!1);let c,u,y;o?(c=o.resolve,u=o.reject,y=o.promise):y=new Promise((L,k)=>{c=L,u=k});const R=++this.navigationId;let D;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),D=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):D=0,this.setTransition({id:R,targetPageId:D,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:c,reject:u,promise:y,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),y.catch(L=>Promise.reject(L))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t),s=Object.assign(Object.assign({},n.extras.state),this.generateNgRouterState(n.id,n.targetPageId));this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,n=!1){var r,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,n){const r=new dO(t.id,this.serializeUrl(t.extractedUrl),n);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){Gm()},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();function sI(i){return"imperative"!==i}let vf=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.route=n,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.commands=null,this.onChanges=new Ee,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){if(null!=this.tabIndexAttribute)return;const n=this.renderer,r=this.el.nativeElement;null!==t?n.setAttribute(r,"tabindex",t):n.removeAttribute(r,"tabindex")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const t={skipLocationChange:Gl(this.skipLocationChange),replaceUrl:Gl(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Gl(this.preserveFragment)})}}return i.\u0275fac=function(t){return new(t||i)(we(_i),we(Vl),Qa("tabindex"),we(Nd),we(Sn))},i.\u0275dir=an({type:i,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,n){1&t&&ni("click",function(){return n.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[po]}),i})();function Gl(i){return""===i||!!i}class oI{}class aI{preload(e,t){return Ue(null)}}let lI=(()=>{class i{constructor(t,n,r,s){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=new iI(r,n,l=>t.triggerEvent(new fO(l)),l=>t.triggerEvent(new gO(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(si(t=>t instanceof Fl),Ml(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Ws);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(t,s)):s.children&&r.push(this.processRoutes(t,s.children));return zn(r).pipe(Pc(),de(s=>{}))}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>(n._loadedConfig?Ue(n._loadedConfig):this.loader.load(t.injector,n)).pipe(yn(s=>(n._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return i.\u0275fac=function(t){return new(t||i)(Re(_i),Re(tT),Re(Pi),Re(oI))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})(),AE=(()=>{class i{constructor(t,n,r={}){this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof rE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Fl&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof pO&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.router.triggerEvent(new pO(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(t){Gm()},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();const pa=new Ge("ROUTER_CONFIGURATION"),cI=new Ge("ROUTER_FORROOT_GUARD"),QY=[My,{provide:RO,useClass:TO},{provide:_i,useFactory:function n3(i,e,t,n,r,s,o={},a,l){const c=new _i(null,i,e,t,n,r,EO(s));return a&&(c.urlHandlingStrategy=a),l&&(c.routeReuseStrategy=l),function r3(i,e){i.errorHandler&&(e.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(e.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(e.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(e.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(e.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(e.canceledNavigationResolution=i.canceledNavigationResolution)}(o,c),o.enableTracing&&c.events.subscribe(u=>{var y,R;null===(y=console.group)||void 0===y||y.call(console,`Router Event: ${u.constructor.name}`),console.log(u.toString()),console.log(u),null===(R=console.groupEnd)||void 0===R||R.call(console)}),c},deps:[RO,Nu,My,Pi,tT,vE,pa,[class HY{},new kr],[class kY{},new kr]]},Nu,{provide:Vl,useFactory:function s3(i){return i.routerState.root},deps:[_i]},lI,aI,class qY{preload(e,t){return t().pipe(Js(()=>Ue(null)))}},{provide:pa,useValue:{enableTracing:!1}}];function XY(){return new sT("Router",_i)}let uI=(()=>{class i{constructor(t,n){}static forRoot(t,n){return{ngModule:i,providers:[QY,hI(t),{provide:cI,useFactory:t3,deps:[[_i,new kr,new il]]},{provide:pa,useValue:n||{}},{provide:xl,useFactory:e3,deps:[ca,[new rd(Ly),new kr],pa]},{provide:AE,useFactory:ZY,deps:[_i,aG,pa]},{provide:oI,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:aI},{provide:sT,multi:!0,useFactory:XY},[bE,{provide:Ey,multi:!0,useFactory:o3,deps:[bE]},{provide:dI,useFactory:a3,deps:[bE]},{provide:eT,multi:!0,useExisting:dI}]]}}static forChild(t){return{ngModule:i,providers:[hI(t)]}}}return i.\u0275fac=function(t){return new(t||i)(Re(cI,8),Re(_i,8))},i.\u0275mod=wn({type:i}),i.\u0275inj=on({}),i})();function ZY(i,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new AE(i,e,t)}function e3(i,e,t={}){return t.useHash?new Y2(i,e):new CT(i,e)}function t3(i){return"guarded"}function hI(i){return[{provide:Sx,multi:!0,useValue:i},{provide:vE,multi:!0,useValue:i}]}let bE=(()=>{class i{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Ee}appInitializer(){return this.injector.get(V2,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let n=null;const r=new Promise(a=>n=a),s=this.injector.get(_i),o=this.injector.get(pa);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),n(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?Ue(null):(this.initNavigation=!0,n(!0),this.resultOfPreactivationDone),s.initialNavigation()):n(!0),r})}bootstrapListener(t){const n=this.injector.get(pa),r=this.injector.get(lI),s=this.injector.get(AE),o=this.injector.get(_i),a=this.injector.get(Oy);t===a.components[0]&&(("enabledNonBlocking"===n.initialNavigation||void 0===n.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return i.\u0275fac=function(t){return new(t||i)(Re(Pi))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();function o3(i){return i.appInitializer.bind(i)}function a3(i){return i.bootstrapListener.bind(i)}const dI=new Ge("Router Initializer");let c3=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=En({type:i,selectors:[["app-help"]],decls:2,vars:0,template:function(t,n){1&t&&(je(0,"span"),ri(1,"Help page"),et())},styles:[""]}),i})(),u3=(()=>{class i{ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=En({type:i,selectors:[["app-home"]],decls:2,vars:0,template:function(t,n){1&t&&(je(0,"span"),ri(1,"Welcome to ngx-msagl"),et())},styles:["[_nghost-%COMP%]{display:block;height:calc(100% - 36px)}"]}),i})(),h3=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=En({type:i,selectors:[["app-not-found"]],decls:4,vars:0,template:function(t,n){1&t&&(je(0,"h2"),ri(1,"Sorry!"),et(),je(2,"p"),ri(3,"Page was not found. Please select a valid page"),et())},styles:[""]}),i})();const fI=JSON.parse('{"t":[{"id":"ADDAM_MARBRAND","label":"Addam","weight":8},{"id":"AEGON","label":"Aegon","weight":20},{"id":"AERYS","label":"Aerys","weight":122},{"id":"ALLISER_THORNE","label":"Allister","weight":403},{"id":"ARYA","label":"Arya","weight":2791},{"id":"ASSASSIN","label":"Assassin","weight":7},{"id":"BAELOR","label":"Baelor","weight":39},{"id":"BALON","label":"Balon","weight":181},{"id":"BARRISTAN","label":"Barristan","weight":379},{"id":"BENJEN","label":"Benjen","weight":162},{"id":"BERIC","label":"Beric","weight":574},{"id":"BORCAS","label":"Borcas","weight":4},{"id":"BOWEN_MARSH","label":"Bowen","weight":42},{"id":"BRAN","label":"Bran","weight":1864},{"id":"BRANDON_STARK","label":"Brandon","weight":17},{"id":"BRONN","label":"Bronn","weight":1195},{"id":"CATELYN","label":"Catelyn","weight":1246},{"id":"CERSEI","label":"Cersei","weight":3727},{"id":"COHOLLO","label":"Cohollo","weight":3},{"id":"DAENERYS","label":"Daenerys","weight":3839},{"id":"DAREON","label":"Dareon","weight":34},{"id":"DOREAH","label":"Doreah","weight":129},{"id":"DROGO","label":"Drogo","weight":226},{"id":"GALBART_GLOVER","label":"Galbart","weight":6},{"id":"GARED","label":"Gared","weight":9},{"id":"GENDRY","label":"Gendry","weight":826},{"id":"GREATJON_UMBER","label":"Greatjon","weight":78},{"id":"GRENN","label":"Grenn","weight":419},{"id":"HIGH_SEPTON","label":"High Septon","weight":97},{"id":"HODOR","label":"Hodor","weight":448},{"id":"HOSTER","label":"Hoster","weight":35},{"id":"HOT_PIE","label":"Hot Pie","weight":213},{"id":"HOUND","label":"Sandor","weight":1454},{"id":"HUGH_OF_THE_VALE","label":"Hugh of the Vale","weight":23},{"id":"ILLYRIO","label":"Illyrio","weight":54},{"id":"ILYN_PAYNE","label":"Ilyn","weight":60},{"id":"IROGENIA","label":"Irogenia","weight":2},{"id":"IRRI","label":"Irri","weight":92},{"id":"JAIME","label":"Jaime","weight":3316},{"id":"JANOS","label":"Janos","weight":266},{"id":"JAREMY_RYKKER","label":"Jaremy","weight":6},{"id":"JEOR","label":"Jeor","weight":340},{"id":"JHIQUI","label":"Jhiqui","weight":7},{"id":"JOANNA","label":"Joanna","weight":13},{"id":"JOFFREY","label":"Joffrey","weight":1579},{"id":"JON","label":"Jon","weight":4753},{"id":"JON_ARRYN","label":"Jon Arryn","weight":75},{"id":"JONOS_BRACKEN","label":"Jonos","weight":7},{"id":"JORAH","label":"Jorah","weight":1756},{"id":"JORY_CASSEL","label":"Jory","weight":100},{"id":"JOYEUSE","label":"Joyeuse","weight":26},{"id":"KEVAN","label":"Kevan","weight":154},{"id":"LANCEL","label":"Lancel","weight":221},{"id":"LEO_LEFFORD","label":"Leo","weight":7},{"id":"LITTLE_BIRD","label":"Little Bird","weight":2},{"id":"LITTLEFINGER","label":"Petyr","weight":1661},{"id":"LOMMY_GREENHANDS","label":"Lommy","weight":14},{"id":"LORAS","label":"Loras","weight":611},{"id":"LUKE","label":"Luke","weight":4},{"id":"LYANNA","label":"Lyanna","weight":113},{"id":"LYSA","label":"Lysa","weight":333},{"id":"MACE","label":"Mac","weight":277},{"id":"MAESTER_AEMON","label":"Aemon","weight":200},{"id":"MAESTER_LUWIN","label":"Luwin","weight":263},{"id":"MAGO","label":"Mago","weight":18},{"id":"MARILLION","label":"Marillion","weight":34},{"id":"MASHA_HEDDLE","label":"Masha","weight":8},{"id":"MELESSA","label":"Melessa","weight":70},{"id":"MERYN_TRANT","label":"Meryn","weight":248},{"id":"MHAEGEN","label":"Mhaegen","weight":23},{"id":"MIRRI_MAZ_DUUR","label":"Mirri Maz Dur","weight":81},{"id":"MORD","label":"Mord","weight":52},{"id":"MOUNTAIN","label":"Gregor","weight":369},{"id":"MYCAH","label":"Mycah","weight":24},{"id":"MYRCELLA","label":"Myrcella","weight":224},{"id":"NED","label":"Ned","weight":1755},{"id":"OLD_NAN","label":"Old Nan","weight":26},{"id":"OSHA","label":"Osha","weight":426},{"id":"OTHELL_YARWYCK","label":"Othell","weight":60},{"id":"OTHOR","label":"Othor","weight":15},{"id":"PYCELLE","label":"Pycelle","weight":544},{"id":"PYP","label":"Pyp","weight":268},{"id":"QOTHO","label":"Qotho","weight":57},{"id":"RAKHARO","label":"Rakharo","weight":88},{"id":"RANDYLL","label":"Randyll","weight":168},{"id":"RAST","label":"Rast","weight":145},{"id":"RENLY","label":"Renly","weight":448},{"id":"RHAEGAR","label":"Rhaegar","weight":46},{"id":"RHAEGO","label":"Rhaego","weight":31},{"id":"RICKARD_KARSTARK","label":"Rickard Karstark","weight":145},{"id":"RICKARD_STARK","label":"Rickard Stark","weight":17},{"id":"RICKON","label":"Rickon","weight":258},{"id":"ROBB","label":"Robb","weight":1288},{"id":"ROBERT","label":"Robert","weight":754},{"id":"ROBIN","label":"Robin","weight":232},{"id":"RODRIK","label":"Rodrik","weight":164},{"id":"ROOSE_BOLTON","label":"Roose","weight":442},{"id":"ROS","label":"Ros","weight":207},{"id":"ROYCE","label":"Royce","weight":23},{"id":"RYGER_RIVERS","label":"Ryger","weight":4},{"id":"SAM","label":"Sam","weight":2062},{"id":"SANSA","label":"Sansa","weight":3607},{"id":"SEPTA_MORDANE","label":"Septa Mordane","weight":95},{"id":"SHAE","label":"Shae","weight":624},{"id":"SHAGGA","label":"Shagga","weight":35},{"id":"STABLE_BOY","label":"Stable Boy","weight":7},{"id":"STANNIS","label":"Stannis","weight":1142},{"id":"STEFFON","label":"Steffon","weight":4},{"id":"STEVRON_FREY","label":"Stevron","weight":6},{"id":"SYRIO_FOREL","label":"Syrio","weight":70},{"id":"THEON","label":"Theon","weight":1706},{"id":"TOBHO_MOTT","label":"Tobho Mott","weight":15},{"id":"TOMARD","label":"Tomard","weight":10},{"id":"TOMMEN","label":"Tommen","weight":637},{"id":"TYRION","label":"Tyrion","weight":5875},{"id":"TYSHA","label":"Tysha","weight":4},{"id":"TYWIN","label":"Tywin","weight":1499},{"id":"VARDIS_EGEN","label":"Vardis","weight":39},{"id":"VARLY","label":"Varly","weight":2},{"id":"VARYS","label":"Varys","weight":1756},{"id":"VISERYS","label":"Viserys","weight":215},{"id":"WALDER","label":"Walder","weight":262},{"id":"WAYMAR_ROYCE","label":"Waymar","weight":6},{"id":"WILL","label":"Will","weight":25},{"id":"WINE_MERCHANT","label":"Wine Merchant","weight":35},{"id":"YOREN","label":"Yoren","weight":135},{"id":"ALTON","label":"Alton","weight":93},{"id":"AMORY","label":"Amory","weight":46},{"id":"BARRA","label":"Barra","weight":6},{"id":"BILLY","label":"Billy","weight":2},{"id":"BITER","label":"Biter","weight":27},{"id":"BLACK_LORREN","label":"Black Lorren","weight":35},{"id":"BOROS","label":"Boros","weight":6},{"id":"BRIENNE","label":"Brienne","weight":1627},{"id":"CAPTAINS_DAUGHTER","label":"Captain\'s Daughter","weight":17},{"id":"COLEN","label":"Colen","weight":12},{"id":"CRASTER","label":"Craster","weight":177},{"id":"CRESSEN","label":"Cressen","weight":33},{"id":"DAGMER","label":"Dagmer","weight":82},{"id":"DAISY","label":"Daisy","weight":24},{"id":"DAVOS","label":"Davos","weight":1987},{"id":"DONTOS","label":"Dontos","weight":77},{"id":"DROWNED_PRIEST","label":"Drowned Priest","weight":5},{"id":"EDDISON_TOLLETT","label":"Eddison","weight":546},{"id":"FARLEN","label":"Farlen","weight":13},{"id":"FATHER_SEAWORTH","label":"Father Seaworth","weight":2},{"id":"FREY_DAUGHTER","label":"Frey Daughter","weight":2},{"id":"GERARD","label":"Gerard","weight":5},{"id":"GILLY","label":"Gilly","weight":717},{"id":"HARREN","label":"Harren","weight":2},{"id":"HAYLENE","label":"Haylene","weight":35},{"id":"JACKS","label":"Jacks","weight":17},{"id":"JAQEN","label":"Jaqen","weight":446},{"id":"KOVARRO","label":"Kovarro","weight":71},{"id":"LOMMY","label":"Lommy","weight":30},{"id":"MALAKKO","label":"Malakko","weight":11},{"id":"MANCE","label":"Mance","weight":238},{"id":"MANDON","label":"Mandon","weight":21},{"id":"MARGAERY","label":"Margaery","weight":1019},{"id":"MARYA","label":"Marya","weight":2},{"id":"MATTHOS","label":"Matthos","weight":109},{"id":"MELISANDRE","label":"Melisandre","weight":823},{"id":"PODRICK","label":"Podrick","weight":831},{"id":"POLLIVER","label":"Polliver","weight":83},{"id":"PORTAN","label":"Portan","weight":3},{"id":"PROTESTER","label":"Protester","weight":2},{"id":"PYATT_PREE","label":"Pyatt Pree","weight":43},{"id":"QHORIN","label":"Quorin","weight":141},{"id":"QUAITHE","label":"Quaithe","weight":24},{"id":"QUENT","label":"Quent","weight":3},{"id":"RAMSAY","label":"Ramsay","weight":774},{"id":"LORD_OF_BONES","label":"Lord of Bones","weight":73},{"id":"REGINALD","label":"Reginald","weight":10},{"id":"RENNICK","label":"Rennick","weight":2},{"id":"RHAENYS","label":"Rhaenys","weight":4},{"id":"RORGE","label":"Rorge","weight":51},{"id":"SALLADHOR","label":"Salladhor","weight":92},{"id":"SEPTON","label":"Septon","weight":5},{"id":"SILK_KING","label":"Silk King","weight":6},{"id":"SPICE_KING","label":"Spice King","weight":88},{"id":"TALISA","label":"Talisa","weight":320},{"id":"TICKLER","label":"Tickler","weight":13},{"id":"TIMETT","label":"Timett","weight":12},{"id":"TORRHEN","label":"Torrhen","weight":16},{"id":"TRYSTANE","label":"Trystane","weight":84},{"id":"VISENYA","label":"Visenya","weight":5},{"id":"WINTERFELL_SHEPHERD","label":"Shepherd","weight":13},{"id":"XARO","label":"Xaro","weight":152},{"id":"YARA","label":"Yara","weight":489},{"id":"YGRITTE","label":"Ygritte","weight":518},{"id":"ANGUY","label":"Anguy","weight":93},{"id":"LITTLE_SAM","label":"Little Sam","weight":184},{"id":"BALERION","label":"Balerion","weight":7},{"id":"BERT","label":"Bert","weight":2},{"id":"BLACK_WALDER","label":"Black Walder","weight":89},{"id":"BRYNDEN","label":"Brynden","weight":213},{"id":"DAARIO","label":"Daario","weight":518},{"id":"DESMOND","label":"Desmond","weight":6},{"id":"EDMURE","label":"Edmure","weight":262},{"id":"ELDRICK","label":"Eldrick","weight":2},{"id":"FARMER","label":"Farmer","weight":38},{"id":"FREY_SEPTON","label":"Frey Septon","weight":8},{"id":"GREIZHEN","label":"Greizhen","weight":11},{"id":"GREY_WORM","label":"Grey Worm","weight":968},{"id":"HOBB","label":"Hobb","weight":2},{"id":"JOJEN","label":"Jojen","weight":324},{"id":"KARL_TANNER","label":"Karl","weight":110},{"id":"KRAZNYS_MO_NAKLOZ","label":"Kraznys","weight":86},{"id":"LOCKE","label":"Locke","weight":183},{"id":"LOTHAR","label":"Lothar","weight":79},{"id":"MAREI","label":"Marei","weight":43},{"id":"MARTYN","label":"Martyn","weight":19},{"id":"MEERA","label":"Meera","weight":458},{"id":"MERO","label":"Mero","weight":60},{"id":"MERRY","label":"Merry","weight":3},{"id":"MISSANDEI","label":"Missandei","weight":999},{"id":"MYRANDA","label":"Myranda","weight":190},{"id":"OLENNA","label":"Olenna","weight":650},{"id":"OLYVAR","label":"Olyvar","weight":119},{"id":"ORELL","label":"Orell","weight":132},{"id":"PRENDAHL","label":"Prendahl","weight":33},{"id":"QHORIN_HALFHAND","label":"Qhorin","weight":4},{"id":"QYBURN","label":"Qyburn","weight":488},{"id":"RADZAI_MO_ERAZ","label":"Radzai","weight":24},{"id":"ROSLIN","label":"Roslin","weight":44},{"id":"RYLENE","label":"Rylene","weight":4},{"id":"SELWYN","label":"Selwyn","weight":13},{"id":"SELYSE","label":"Selyse","weight":184},{"id":"SHIREEN","label":"Shireen","weight":273},{"id":"SORCERER","label":"Sorcerer","weight":7},{"id":"STEELSHANKS_WALTON","label":"Steelshanks Walton","weight":21},{"id":"TARYN_MANT","label":"Taryn","weight":18},{"id":"THOROS","label":"Thoros","weight":356},{"id":"TORMUND","label":"Tormund","weight":1241},{"id":"TORTURER","label":"Torturer","weight":19},{"id":"VIOLET","label":"Violet","weight":36},{"id":"WILLEM_LANNISTER","label":"Willem","weight":8},{"id":"ADRACK_HUMBLE","label":"Adrack Humble","weight":6},{"id":"ANYA_WAYNWOOD","label":"Anya Waynwood","weight":49},{"id":"AXELL_FLORENT","label":"Axell Florent","weight":12},{"id":"BALON_DWARF","label":"Balon Dwarf","weight":21},{"id":"BLACK_JACK","label":"Black Jack","weight":8},{"id":"BOLTON_GUARD","label":"Bolton Guard","weight":10},{"id":"COOPER","label":"Cooper","weight":7},{"id":"CRASTERS_BABY","label":"Baby","weight":26},{"id":"DONGO_THE_GIANT","label":"Dongo the Giant","weight":9},{"id":"DONNEL_HILL","label":"Donnel Hill","weight":13},{"id":"DONNEL_WAYNWOOD","label":"Donnel Waynwood","weight":5},{"id":"DORAN","label":"Doran","weight":148},{"id":"DORNISH_LORD","label":"Dornish Lord","weight":9},{"id":"DYING_MAN","label":"Dying Man","weight":22},{"id":"ELDER_MEEREEN_SLAVE","label":"Meereen Statesman","weight":14},{"id":"ELIA","label":"Elia","weight":24},{"id":"ELLARIA","label":"Ellaria","weight":412},{"id":"ENDREW","label":"Endrew","weight":12},{"id":"FALYSE","label":"Falyse","weight":4},{"id":"FARMER_HAMLET","label":"Hamlet Farmer","weight":44},{"id":"FENNESZ","label":"Fennesz","weight":22},{"id":"FIRST_MATE","label":"First Mate","weight":14},{"id":"FOOL","label":"Fool","weight":6},{"id":"GOATHERD","label":"Goatherd","weight":19},{"id":"GOATHERDS_SON","label":"Goatherd\'s Son","weight":2},{"id":"GUYMON","label":"Guymon","weight":14},{"id":"HIZDAHR","label":"Hizdahr","weight":171},{"id":"HIZDAHRS_FATHER","label":"Hizdahr\'s Father","weight":11},{"id":"INNKEEPER","label":"Innkeeper","weight":10},{"id":"INNKEEPERS_DAUGHTER","label":"Innkeeper\'s Daughter","weight":4},{"id":"JOFFREY_DWARF","label":"Joffrey Dwarf","weight":28},{"id":"KEGS","label":"Kegs","weight":8},{"id":"LEAF","label":"Leaf","weight":74},{"id":"LHARA","label":"Lhara","weight":5},{"id":"LOLLYS","label":"Lollys","weight":24},{"id":"LUTHOR","label":"Luthor","weight":7},{"id":"MAG_THE_MIGHTY","label":"Mag the Mighty","weight":26},{"id":"MANSERVANT","label":"Manservant","weight":8},{"id":"MASTER_MIGHDAL","label":"Master Mighdal","weight":7},{"id":"MEEREEN_CHAMPION","label":"Meereen Champion","weight":13},{"id":"MEEREEN_SLAVE","label":"Meereen Slave","weight":7},{"id":"MOLES_TOWN_MADAM","label":"Mole\'s Town Madam","weight":14},{"id":"MOLES_TOWN_WHORE","label":"Mole\'s Town Whore","weight":33},{"id":"MORAG","label":"Morag","weight":28},{"id":"MORGAN","label":"Morgan","weight":58},{"id":"MORGANS_FRIEND","label":"Morgan\'s Friend","weight":24},{"id":"MOSSADOR","label":"Mossador","weight":63},{"id":"MULLY","label":"Mully","weight":8},{"id":"MUSICIAN","label":"Musician","weight":2},{"id":"NIGHT_KING","label":"Night King","weight":160},{"id":"OBERYN","label":"Oberyn","weight":501},{"id":"OLLY","label":"Olly","weight":228},{"id":"OLLYS_MOTHER","label":"Olly\'s Mother","weight":13},{"id":"ORSON","label":"Orson","weight":6},{"id":"ORYS","label":"Orys","weight":4},{"id":"ORYS_BROTHER","label":"Orys\'s Brother","weight":4},{"id":"RALF","label":"Ralf","weight":22},{"id":"RENLY_DWARF","label":"Renly Dwarf","weight":18},{"id":"ROBB_DWARF","label":"Robb Dwarf","weight":27},{"id":"SALLY","label":"Sally","weight":23},{"id":"SISSY","label":"Sissy","weight":39},{"id":"STANNIS_DWARF","label":"Stannis Dwarf","weight":18},{"id":"STYR","label":"Styr","weight":84},{"id":"TANSY","label":"Tansy","weight":27},{"id":"TERNESIO_TERYS","label":"Ternesio Terys","weight":17},{"id":"THENN_WARG","label":"Thenn Warg","weight":10},{"id":"THREE_EYED_RAVEN","label":"Three Eyed Raven","weight":166},{"id":"TOMMY","label":"Tommy","weight":8},{"id":"TYCHO","label":"Tycho","weight":107},{"id":"VANCE_CORBRAY","label":"Vance Corbray","weight":9},{"id":"VIOLA","label":"Viola","weight":4},{"id":"WALDA","label":"Walda","weight":78},{"id":"WHITE_WALKER","label":"White Walker","weight":12},{"id":"YOHN_ROYCE","label":"Yohn Royce","weight":293},{"id":"ZALA","label":"Zala","weight":2},{"id":"AREO","label":"Areo","weight":128},{"id":"BLACK_HAIRED_PROSTITUTE","label":"Strumpet","weight":17},{"id":"BRAND","label":"Brand","weight":17},{"id":"BRIAN","label":"Brian","weight":2},{"id":"CERWYN","label":"Cerwyn","weight":2},{"id":"DENYS","label":"Denys","weight":2},{"id":"DERRYK","label":"Derryk","weight":23},{"id":"DORNISH_RIDER","label":"Dornish Rider","weight":16},{"id":"HIGH_SPARROW","label":"High Sparrow","weight":423},{"id":"KARSI","label":"Karsi","weight":57},{"id":"LOBODA","label":"Loboda","weight":28},{"id":"LORD_WEEBLY","label":"Lord Weebly","weight":5},{"id":"LYANNA_MORMONT","label":"Lyanna Mormont","weight":264},{"id":"MADAME","label":"Madame","weight":8},{"id":"MAGGY","label":"Maggy","weight":24},{"id":"MAGNAR","label":"Magnar","weight":2},{"id":"MALKO","label":"Malko","weight":29},{"id":"MELARA","label":"Melara","weight":14},{"id":"NYMERIA","label":"Nymeria","weight":85},{"id":"OBARA","label":"Obara","weight":107},{"id":"OWNER","label":"Owner","weight":18},{"id":"QUICK","label":"Quick","weight":12},{"id":"RHAENYRA","label":"Rhaenyra","weight":2},{"id":"SEPTA_UNELLA","label":"Septa Unella","weight":68},{"id":"STRONG","label":"Strong","weight":12},{"id":"TANDA","label":"Tanda","weight":2},{"id":"THIN_MAN","label":"Thin Man","weight":32},{"id":"TYENE","label":"Tyene","weight":169},{"id":"WAIF","label":"Waif","weight":152},{"id":"WOLKAN","label":"Wolkan","weight":0},{"id":"AERON","label":"Aeron","weight":25},{"id":"ARTHUR","label":"Arthur","weight":22},{"id":"ARTHUR_CHILD","label":"Arthur (child)","weight":6},{"id":"BELICHO","label":"Belicho","weight":32},{"id":"BIANCA","label":"Bianca","weight":80},{"id":"BOBONO","label":"Bobono","weight":82},{"id":"CAMELLO","label":"Camello","weight":55},{"id":"CLARENZO","label":"Clarenzo","weight":73},{"id":"DICKON","label":"Dickon","weight":106},{"id":"DIM_DALBA","label":"Dim Dalba","weight":16},{"id":"DOM","label":"Dom","weight":8},{"id":"DOSH_KHALEEN_LEADER","label":"Dosh Khaleen Leader","weight":20},{"id":"EURON","label":"Euron","weight":323},{"id":"FLYNN","label":"Flynn","weight":6},{"id":"GATINS","label":"Gatins","weight":9},{"id":"GLOVER","label":"Glover","weight":21},{"id":"GUARD_CAPTAIN","label":"Guard Captain","weight":13},{"id":"HARALD","label":"Harald","weight":21},{"id":"HOWLAND","label":"Howland","weight":15},{"id":"IZEMBARO","label":"Izembaro","weight":80},{"id":"KHAL_MORO","label":"Khal Moro","weight":43},{"id":"KINVARA","label":"Kinvara","weight":28},{"id":"LADY_CRANE","label":"Lady Crane","weight":180},{"id":"LEM","label":"Lem","weight":27},{"id":"LHAZAREEN_WOMAN","label":"Lhazareen Woman","weight":30},{"id":"MAESTER_CITADEL","label":"Citadel Maester","weight":17},{"id":"MAESTER_DORNE","label":"Dorne Maester","weight":11},{"id":"MAESTER_MORMONT","label":"Mormont Maester","weight":21},{"id":"MAESTER_WOLKAN","label":"Wolkan","weight":180},{"id":"MANDERLY","label":"Manderly","weight":13},{"id":"MINISA","label":"Minisa","weight":2},{"id":"RAY","label":"Ray","weight":56},{"id":"RAZDAL","label":"Razdal","weight":46},{"id":"RED_PRIEST","label":"Red Priest","weight":10},{"id":"ROBETT","label":"Robett","weight":89},{"id":"SMALLJON","label":"Smalljon","weight":84},{"id":"SON_OF_EDMURE","label":"Edmure\'s Son","weight":8},{"id":"SON_OFWALDA","label":"Roose\'s Son","weight":21},{"id":"TALLA","label":"Talla","weight":38},{"id":"VALA","label":"Vala","weight":19},{"id":"WUN_WUN","label":"Wun Wun","weight":60},{"id":"YEZZAN","label":"Yezzan","weight":51},{"id":"ALYS","label":"Alys","weight":100},{"id":"HARRAG","label":"Harrag","weight":27},{"id":"MARWYN","label":"Marwin","weight":100},{"id":"NED_UMBER","label":"Ned Umber","weight":21},{"id":"QHONO","label":"Qhono","weight":88},{"id":"ALANNA","label":"Alanna","weight":2},{"id":"CERSEIS_BABY","label":"Cersei\'s Baby","weight":6},{"id":"CRAYAH","label":"Crayah","weight":27},{"id":"DIRAH","label":"Dirah","weight":20},{"id":"DORNISH_PRINCE","label":"Dornish Prince","weight":37},{"id":"HARRY","label":"Harry","weight":21},{"id":"IRONBORN_LORD","label":"Ironborn Lord","weight":36},{"id":"MARTHA","label":"Martha","weight":11},{"id":"NORA","label":"Nora","weight":48},{"id":"OWEN","label":"Owen","weight":6},{"id":"RIVERLANDS_LORD","label":"Riverlands Lord","weight":36},{"id":"SARRA","label":"Sarra","weight":9},{"id":"TEELA","label":"Teela","weight":16},{"id":"UNSULLIED_CAPTAIN","label":"Unsullied Captain","weight":5},{"id":"VALE_LORD","label":"Vale Lord","weight":36},{"id":"VICKY","label":"Vicky","weight":39},{"id":"WILLA","label":"Willa","weight":11},{"id":"WILLIAM","label":"William","weight":2}],"$":[{"directed":false,"source":"NED","target":"ROBERT","weight":211},{"directed":false,"source":"DAENERYS","target":"JORAH","weight":594},{"directed":false,"source":"JON","target":"SAM","weight":415},{"directed":false,"source":"LITTLEFINGER","target":"NED","weight":118},{"directed":false,"source":"NED","target":"VARYS","weight":104},{"directed":false,"source":"DAENERYS","target":"DROGO","weight":113},{"directed":false,"source":"ARYA","target":"NED","weight":110},{"directed":false,"source":"CATELYN","target":"ROBB","weight":232},{"directed":false,"source":"BRONN","target":"TYRION","weight":389},{"directed":false,"source":"CERSEI","target":"NED","weight":100},{"directed":false,"source":"CERSEI","target":"ROBERT","weight":98},{"directed":false,"source":"LITTLEFINGER","target":"VARYS","weight":98},{"directed":false,"source":"SHAE","target":"TYRION","weight":324},{"directed":false,"source":"CATELYN","target":"NED","weight":86},{"directed":false,"source":"JOFFREY","target":"SANSA","weight":187},{"directed":false,"source":"NED","target":"PYCELLE","weight":68},{"directed":false,"source":"DAENERYS","target":"VISERYS","weight":75},{"directed":false,"source":"SANSA","target":"SEPTA_MORDANE","weight":64},{"directed":false,"source":"TYRION","target":"TYWIN","weight":306},{"directed":false,"source":"JEOR","target":"JON","weight":111},{"directed":false,"source":"ROBB","target":"THEON","weight":89},{"directed":false,"source":"CERSEI","target":"JOFFREY","weight":217},{"directed":false,"source":"ARYA","target":"SANSA","weight":280},{"directed":false,"source":"BRAN","target":"MAESTER_LUWIN","weight":84},{"directed":false,"source":"JAIME","target":"NED","weight":62},{"directed":false,"source":"NED","target":"SANSA","weight":96},{"directed":false,"source":"BRAN","target":"ROBB","weight":59},{"directed":false,"source":"LORAS","target":"RENLY","weight":73},{"directed":false,"source":"CERSEI","target":"JAIME","weight":509},{"directed":false,"source":"DAENERYS","target":"MIRRI_MAZ_DUUR","weight":45},{"directed":false,"source":"JON","target":"TYRION","weight":268},{"directed":false,"source":"ARYA","target":"SYRIO_FOREL","weight":48},{"directed":false,"source":"JORY_CASSEL","target":"NED","weight":44},{"directed":false,"source":"JORAH","target":"VISERYS","weight":43},{"directed":false,"source":"JON","target":"PYP","weight":54},{"directed":false,"source":"CATELYN","target":"TYRION","weight":54},{"directed":false,"source":"ROS","target":"THEON","weight":40},{"directed":false,"source":"JOFFREY","target":"NED","weight":56},{"directed":false,"source":"CERSEI","target":"SANSA","weight":144},{"directed":false,"source":"GRENN","target":"PYP","weight":44},{"directed":false,"source":"CATELYN","target":"WALDER","weight":53},{"directed":false,"source":"DAENERYS","target":"DOREAH","weight":54},{"directed":false,"source":"JAIME","target":"TYRION","weight":358},{"directed":false,"source":"JAIME","target":"TYWIN","weight":148},{"directed":false,"source":"BENJEN","target":"JON","weight":40},{"directed":false,"source":"DAENERYS","target":"IRRI","weight":47},{"directed":false,"source":"GREATJON_UMBER","target":"ROBB","weight":31},{"directed":false,"source":"MORD","target":"TYRION","weight":31},{"directed":false,"source":"CATELYN","target":"LYSA","weight":41},{"directed":false,"source":"DOREAH","target":"VISERYS","weight":30},{"directed":false,"source":"JORAH","target":"RAKHARO","weight":30},{"directed":false,"source":"LYSA","target":"ROBIN","weight":47},{"directed":false,"source":"LYSA","target":"TYRION","weight":37},{"directed":false,"source":"NED","target":"RENLY","weight":30},{"directed":false,"source":"PYP","target":"SAM","weight":69},{"directed":false,"source":"RENLY","target":"ROBERT","weight":35},{"directed":false,"source":"BRAN","target":"NED","weight":61},{"directed":false,"source":"BRAN","target":"OSHA","weight":153},{"directed":false,"source":"JON","target":"NED","weight":79},{"directed":false,"source":"BRAN","target":"CATELYN","weight":44},{"directed":false,"source":"CATELYN","target":"JAIME","weight":70},{"directed":false,"source":"CATELYN","target":"RODRIK","weight":28},{"directed":false,"source":"DAENERYS","target":"QOTHO","weight":28},{"directed":false,"source":"JOFFREY","target":"ROBERT","weight":37},{"directed":false,"source":"JON","target":"MAESTER_AEMON","weight":55},{"directed":false,"source":"DROGO","target":"VISERYS","weight":27},{"directed":false,"source":"JAIME","target":"JORY_CASSEL","weight":27},{"directed":false,"source":"BRAN","target":"THEON","weight":107},{"directed":false,"source":"CATELYN","target":"LITTLEFINGER","weight":64},{"directed":false,"source":"CATELYN","target":"MAESTER_LUWIN","weight":26},{"directed":false,"source":"BARRISTAN","target":"NED","weight":25},{"directed":false,"source":"ILLYRIO","target":"VISERYS","weight":25},{"directed":false,"source":"JON","target":"ROBB","weight":35},{"directed":false,"source":"OSHA","target":"THEON","weight":61},{"directed":false,"source":"ARYA","target":"JOFFREY","weight":47},{"directed":false,"source":"GRENN","target":"JON","weight":82},{"directed":false,"source":"NED","target":"ROBB","weight":45},{"directed":false,"source":"BARRISTAN","target":"ROBERT","weight":27},{"directed":false,"source":"CATELYN","target":"CERSEI","weight":26},{"directed":false,"source":"LITTLEFINGER","target":"SANSA","weight":416},{"directed":false,"source":"SHAGGA","target":"TYRION","weight":22},{"directed":false,"source":"TYRION","target":"YOREN","weight":22},{"directed":false,"source":"ALLISER_THORNE","target":"JON","weight":133},{"directed":false,"source":"ARYA","target":"JON","weight":99},{"directed":false,"source":"DROGO","target":"JORAH","weight":22},{"directed":false,"source":"JAIME","target":"ROBERT","weight":23},{"directed":false,"source":"BRAN","target":"JON","weight":82},{"directed":false,"source":"DAENERYS","target":"WINE_MERCHANT","weight":19},{"directed":false,"source":"HOUND","target":"SANSA","weight":73},{"directed":false,"source":"LITTLEFINGER","target":"PYCELLE","weight":27},{"directed":false,"source":"LITTLEFINGER","target":"ROS","weight":35},{"directed":false,"source":"THEON","target":"TYRION","weight":49},{"directed":false,"source":"ALLISER_THORNE","target":"SAM","weight":41},{"directed":false,"source":"ARYA","target":"YOREN","weight":38},{"directed":false,"source":"CERSEI","target":"TYRION","weight":442},{"directed":false,"source":"BENJEN","target":"TYRION","weight":17},{"directed":false,"source":"DAENERYS","target":"RAKHARO","weight":29},{"directed":false,"source":"JEOR","target":"SAM","weight":43},{"directed":false,"source":"LITTLEFINGER","target":"RENLY","weight":39},{"directed":false,"source":"MAESTER_LUWIN","target":"ROBB","weight":17},{"directed":false,"source":"ROBERT","target":"SANSA","weight":19},{"directed":false,"source":"ROS","target":"TYRION","weight":20},{"directed":false,"source":"CATELYN","target":"THEON","weight":16},{"directed":false,"source":"GRENN","target":"SAM","weight":75},{"directed":false,"source":"HOUND","target":"JOFFREY","weight":73},{"directed":false,"source":"ROBB","target":"TYRION","weight":21},{"directed":false,"source":"BRAN","target":"TYRION","weight":72},{"directed":false,"source":"CATELYN","target":"ROBERT","weight":15},{"directed":false,"source":"JEOR","target":"TYRION","weight":19},{"directed":false,"source":"JOFFREY","target":"TYRION","weight":200},{"directed":false,"source":"JOFFREY","target":"VARYS","weight":28},{"directed":false,"source":"LANCEL","target":"ROBERT","weight":15},{"directed":false,"source":"MIRRI_MAZ_DUUR","target":"QOTHO","weight":15},{"directed":false,"source":"NED","target":"YOREN","weight":15},{"directed":false,"source":"PYCELLE","target":"VARYS","weight":37},{"directed":false,"source":"BENJEN","target":"NED","weight":24},{"directed":false,"source":"BRAN","target":"RICKON","weight":82},{"directed":false,"source":"CATELYN","target":"JON","weight":16},{"directed":false,"source":"CATELYN","target":"SANSA","weight":39},{"directed":false,"source":"JOFFREY","target":"MARILLION","weight":14},{"directed":false,"source":"KEVAN","target":"TYRION","weight":14},{"directed":false,"source":"LITTLEFINGER","target":"ROBERT","weight":14},{"directed":false,"source":"BARRISTAN","target":"CERSEI","weight":15},{"directed":false,"source":"CATELYN","target":"VARDIS_EGEN","weight":13},{"directed":false,"source":"CERSEI","target":"VARYS","weight":56},{"directed":false,"source":"DAENERYS","target":"RHAEGO","weight":17},{"directed":false,"source":"JANOS","target":"NED","weight":13},{"directed":false,"source":"JOFFREY","target":"PYCELLE","weight":26},{"directed":false,"source":"MAESTER_LUWIN","target":"THEON","weight":61},{"directed":false,"source":"NED","target":"THEON","weight":20},{"directed":false,"source":"PYCELLE","target":"SANSA","weight":18},{"directed":false,"source":"GENDRY","target":"NED","weight":14},{"directed":false,"source":"HOT_PIE","target":"LOMMY_GREENHANDS","weight":12},{"directed":false,"source":"JOFFREY","target":"LITTLEFINGER","weight":26},{"directed":false,"source":"JOFFREY","target":"MERYN_TRANT","weight":31},{"directed":false,"source":"JOFFREY","target":"ROBB","weight":31},{"directed":false,"source":"JON_ARRYN","target":"NED","weight":15},{"directed":false,"source":"KEVAN","target":"TYWIN","weight":23},{"directed":false,"source":"MAESTER_LUWIN","target":"OSHA","weight":26},{"directed":false,"source":"ARYA","target":"SEPTA_MORDANE","weight":11},{"directed":false,"source":"BRAN","target":"HODOR","weight":160},{"directed":false,"source":"BRONN","target":"SHAE","weight":18},{"directed":false,"source":"CATELYN","target":"GREATJON_UMBER","weight":11},{"directed":false,"source":"CATELYN","target":"VARYS","weight":11},{"directed":false,"source":"GREATJON_UMBER","target":"THEON","weight":11},{"directed":false,"source":"IRRI","target":"RAKHARO","weight":11},{"directed":false,"source":"MERYN_TRANT","target":"SYRIO_FOREL","weight":13},{"directed":false,"source":"NED","target":"TYRION","weight":30},{"directed":false,"source":"NED","target":"TYWIN","weight":13},{"directed":false,"source":"PYCELLE","target":"ROBERT","weight":14},{"directed":false,"source":"RENLY","target":"STANNIS","weight":54},{"directed":false,"source":"ROBB","target":"RODRIK","weight":16},{"directed":false,"source":"ROBERT","target":"VARYS","weight":16},{"directed":false,"source":"ALLISER_THORNE","target":"PYP","weight":18},{"directed":false,"source":"ARYA","target":"ROBERT","weight":15},{"directed":false,"source":"CATELYN","target":"ROBIN","weight":10},{"directed":false,"source":"DAENERYS","target":"ILLYRIO","weight":10},{"directed":false,"source":"DROGO","target":"MAGO","weight":10},{"directed":false,"source":"HOUND","target":"NED","weight":14},{"directed":false,"source":"HOUND","target":"TYRION","weight":50},{"directed":false,"source":"JAIME","target":"JON","weight":29},{"directed":false,"source":"JAIME","target":"ROBB","weight":46},{"directed":false,"source":"JEOR","target":"PYP","weight":10},{"directed":false,"source":"JOFFREY","target":"MYCAH","weight":10},{"directed":false,"source":"JORAH","target":"WINE_MERCHANT","weight":10},{"directed":false,"source":"MERYN_TRANT","target":"SANSA","weight":20},{"directed":false,"source":"NED","target":"RODRIK","weight":14},{"directed":false,"source":"NED","target":"STANNIS","weight":21},{"directed":false,"source":"NED","target":"TOBHO_MOTT","weight":10},{"directed":false,"source":"PYP","target":"RAST","weight":10},{"directed":false,"source":"ALLISER_THORNE","target":"JEOR","weight":9},{"directed":false,"source":"ARYA","target":"CERSEI","weight":34},{"directed":false,"source":"BRAN","target":"JAIME","weight":33},{"directed":false,"source":"BRAN","target":"OLD_NAN","weight":11},{"directed":false,"source":"CERSEI","target":"PYCELLE","weight":95},{"directed":false,"source":"DROGO","target":"MIRRI_MAZ_DUUR","weight":9},{"directed":false,"source":"ILLYRIO","target":"VARYS","weight":9},{"directed":false,"source":"IRRI","target":"JORAH","weight":11},{"directed":false,"source":"JEOR","target":"MAESTER_AEMON","weight":9},{"directed":false,"source":"MHAEGEN","target":"NED","weight":9},{"directed":false,"source":"NED","target":"SEPTA_MORDANE","weight":9},{"directed":false,"source":"PYCELLE","target":"ROS","weight":9},{"directed":false,"source":"RENLY","target":"VARYS","weight":9},{"directed":false,"source":"ROBB","target":"SANSA","weight":28},{"directed":false,"source":"ROBIN","target":"TYRION","weight":16},{"directed":false,"source":"RODRIK","target":"TYRION","weight":9},{"directed":false,"source":"VARDIS_EGEN","target":"TYRION","weight":9},{"directed":false,"source":"AERYS","target":"NED","weight":12},{"directed":false,"source":"BAELOR","target":"NED","weight":8},{"directed":false,"source":"CERSEI","target":"LITTLEFINGER","weight":103},{"directed":false,"source":"CERSEI","target":"ROBB","weight":14},{"directed":false,"source":"DAENERYS","target":"MAGO","weight":8},{"directed":false,"source":"DAREON","target":"PYP","weight":8},{"directed":false,"source":"HOUND","target":"MERYN_TRANT","weight":17},{"directed":false,"source":"JORAH","target":"MIRRI_MAZ_DUUR","weight":8},{"directed":false,"source":"OSHA","target":"ROBB","weight":10},{"directed":false,"source":"PYCELLE","target":"RENLY","weight":8},{"directed":false,"source":"ROBERT","target":"TYWIN","weight":15},{"directed":false,"source":"RODRIK","target":"THEON","weight":31},{"directed":false,"source":"SANSA","target":"VARYS","weight":39},{"directed":false,"source":"AERYS","target":"ROBERT","weight":16},{"directed":false,"source":"ALLISER_THORNE","target":"GRENN","weight":20},{"directed":false,"source":"ARYA","target":"CATELYN","weight":22},{"directed":false,"source":"ARYA","target":"GENDRY","weight":200},{"directed":false,"source":"ARYA","target":"HOUND","weight":314},{"directed":false,"source":"ARYA","target":"JORY_CASSEL","weight":7},{"directed":false,"source":"ARYA","target":"STABLE_BOY","weight":7},{"directed":false,"source":"ARYA","target":"VARYS","weight":14},{"directed":false,"source":"BRAN","target":"ROBERT","weight":7},{"directed":false,"source":"BRONN","target":"CATELYN","weight":7},{"directed":false,"source":"GREATJON_UMBER","target":"RODRIK","weight":7},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"JORY_CASSEL","weight":7},{"directed":false,"source":"JON","target":"RAST","weight":7},{"directed":false,"source":"JON","target":"THEON","weight":48},{"directed":false,"source":"JON_ARRYN","target":"ROBERT","weight":9},{"directed":false,"source":"JORY_CASSEL","target":"LITTLEFINGER","weight":7},{"directed":false,"source":"LYSA","target":"VARDIS_EGEN","weight":7},{"directed":false,"source":"MAESTER_AEMON","target":"TYRION","weight":7},{"directed":false,"source":"MAESTER_LUWIN","target":"TYRION","weight":7},{"directed":false,"source":"ROBERT","target":"TYRION","weight":10},{"directed":false,"source":"ROBERT","target":"VISERYS","weight":7},{"directed":false,"source":"ARYA","target":"ROBB","weight":18},{"directed":false,"source":"BARRISTAN","target":"VARYS","weight":8},{"directed":false,"source":"BRONN","target":"RODRIK","weight":6},{"directed":false,"source":"DROGO","target":"ILLYRIO","weight":6},{"directed":false,"source":"DROGO","target":"QOTHO","weight":6},{"directed":false,"source":"DROGO","target":"RHAEGO","weight":9},{"directed":false,"source":"GRENN","target":"RAST","weight":23},{"directed":false,"source":"GRENN","target":"TYRION","weight":6},{"directed":false,"source":"HOUND","target":"ROBERT","weight":6},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"NED","weight":6},{"directed":false,"source":"JAIME","target":"JOFFREY","weight":47},{"directed":false,"source":"JEOR","target":"OTHELL_YARWYCK","weight":6},{"directed":false,"source":"JEOR","target":"OTHOR","weight":6},{"directed":false,"source":"LITTLEFINGER","target":"MOUNTAIN","weight":6},{"directed":false,"source":"LITTLEFINGER","target":"TYRION","weight":70},{"directed":false,"source":"MAESTER_AEMON","target":"PYP","weight":8},{"directed":false,"source":"MAESTER_AEMON","target":"SAM","weight":61},{"directed":false,"source":"NED","target":"SYRIO_FOREL","weight":6},{"directed":false,"source":"NED","target":"TOMARD","weight":6},{"directed":false,"source":"OTHELL_YARWYCK","target":"SAM","weight":6},{"directed":false,"source":"PYP","target":"TYRION","weight":6},{"directed":false,"source":"RAST","target":"SAM","weight":19},{"directed":false,"source":"SHAGGA","target":"TYWIN","weight":6},{"directed":false,"source":"ARYA","target":"BAELOR","weight":5},{"directed":false,"source":"ARYA","target":"BRAN","weight":50},{"directed":false,"source":"ARYA","target":"HOT_PIE","weight":99},{"directed":false,"source":"ARYA","target":"LITTLEFINGER","weight":37},{"directed":false,"source":"ARYA","target":"MERYN_TRANT","weight":25},{"directed":false,"source":"ARYA","target":"MYCAH","weight":7},{"directed":false,"source":"BARRISTAN","target":"JOFFREY","weight":7},{"directed":false,"source":"BENJEN","target":"ROBB","weight":5},{"directed":false,"source":"BENJEN","target":"YOREN","weight":5},{"directed":false,"source":"BRAN","target":"RODRIK","weight":25},{"directed":false,"source":"BRONN","target":"LYSA","weight":5},{"directed":false,"source":"BRONN","target":"SHAGGA","weight":5},{"directed":false,"source":"BRONN","target":"TYWIN","weight":12},{"directed":false,"source":"CATELYN","target":"MORD","weight":5},{"directed":false,"source":"DAENERYS","target":"ROBERT","weight":13},{"directed":false,"source":"DOREAH","target":"IRRI","weight":9},{"directed":false,"source":"DROGO","target":"RAKHARO","weight":5},{"directed":false,"source":"GARED","target":"ROYCE","weight":5},{"directed":false,"source":"GENDRY","target":"TOBHO_MOTT","weight":5},{"directed":false,"source":"HOUND","target":"LITTLEFINGER","weight":5},{"directed":false,"source":"HOUND","target":"MOUNTAIN","weight":39},{"directed":false,"source":"JAIME","target":"KEVAN","weight":17},{"directed":false,"source":"JAIME","target":"LITTLEFINGER","weight":9},{"directed":false,"source":"JANOS","target":"VARYS","weight":8},{"directed":false,"source":"JOFFREY","target":"SEPTA_MORDANE","weight":5},{"directed":false,"source":"JON","target":"OTHELL_YARWYCK","weight":14},{"directed":false,"source":"JON","target":"OTHOR","weight":5},{"directed":false,"source":"JON_ARRYN","target":"LITTLEFINGER","weight":9},{"directed":false,"source":"JON_ARRYN","target":"LYSA","weight":13},{"directed":false,"source":"JONOS_BRACKEN","target":"ROBB","weight":5},{"directed":false,"source":"JORAH","target":"QOTHO","weight":5},{"directed":false,"source":"LYSA","target":"MORD","weight":5},{"directed":false,"source":"MAESTER_LUWIN","target":"NED","weight":5},{"directed":false,"source":"MARILLION","target":"RODRIK","weight":5},{"directed":false,"source":"MARILLION","target":"TYRION","weight":5},{"directed":false,"source":"MASHA_HEDDLE","target":"TYRION","weight":5},{"directed":false,"source":"MOUNTAIN","target":"NED","weight":5},{"directed":false,"source":"RENLY","target":"SANSA","weight":7},{"directed":false,"source":"ROBB","target":"ROBERT","weight":7},{"directed":false,"source":"ROBB","target":"TYWIN","weight":22},{"directed":false,"source":"ROBB","target":"WALDER","weight":35},{"directed":false,"source":"ROBERT","target":"STANNIS","weight":18},{"directed":false,"source":"AERYS","target":"RICKARD_STARK","weight":4},{"directed":false,"source":"ALLISER_THORNE","target":"RAST","weight":4},{"directed":false,"source":"ARYA","target":"ILYN_PAYNE","weight":6},{"directed":false,"source":"BAELOR","target":"YOREN","weight":4},{"directed":false,"source":"BARRISTAN","target":"JAIME","weight":4},{"directed":false,"source":"BARRISTAN","target":"LITTLEFINGER","weight":4},{"directed":false,"source":"BARRISTAN","target":"PYCELLE","weight":4},{"directed":false,"source":"BRAN","target":"CERSEI","weight":4},{"directed":false,"source":"BRONN","target":"VARDIS_EGEN","weight":4},{"directed":false,"source":"CATELYN","target":"JON_ARRYN","weight":6},{"directed":false,"source":"CATELYN","target":"MARILLION","weight":4},{"directed":false,"source":"CATELYN","target":"TYWIN","weight":6},{"directed":false,"source":"CERSEI","target":"HOUND","weight":22},{"directed":false,"source":"DAENERYS","target":"VARYS","weight":132},{"directed":false,"source":"DAREON","target":"JON","weight":4},{"directed":false,"source":"DAREON","target":"SAM","weight":6},{"directed":false,"source":"GARED","target":"WILL","weight":4},{"directed":false,"source":"GRENN","target":"JEOR","weight":11},{"directed":false,"source":"HOUND","target":"LORAS","weight":4},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"LITTLEFINGER","weight":4},{"directed":false,"source":"ILYN_PAYNE","target":"JOFFREY","weight":6},{"directed":false,"source":"ILYN_PAYNE","target":"NED","weight":6},{"directed":false,"source":"ILYN_PAYNE","target":"SANSA","weight":8},{"directed":false,"source":"ILYN_PAYNE","target":"YOREN","weight":4},{"directed":false,"source":"JAIME","target":"ROS","weight":4},{"directed":false,"source":"JAIME","target":"THEON","weight":8},{"directed":false,"source":"JORY_CASSEL","target":"ROBERT","weight":4},{"directed":false,"source":"LANCEL","target":"NED","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"SEPTA_MORDANE","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"TYWIN","weight":38},{"directed":false,"source":"LORAS","target":"MOUNTAIN","weight":4},{"directed":false,"source":"LORAS","target":"NED","weight":4},{"directed":false,"source":"LORAS","target":"SANSA","weight":37},{"directed":false,"source":"LYANNA","target":"NED","weight":41},{"directed":false,"source":"MIRRI_MAZ_DUUR","target":"RAKHARO","weight":4},{"directed":false,"source":"MOUNTAIN","target":"ROBERT","weight":4},{"directed":false,"source":"MOUNTAIN","target":"SANSA","weight":4},{"directed":false,"source":"MYCAH","target":"SANSA","weight":4},{"directed":false,"source":"NED","target":"RICKARD_STARK","weight":9},{"directed":false,"source":"OLD_NAN","target":"ROBB","weight":4},{"directed":false,"source":"ROYCE","target":"WILL","weight":4},{"directed":false,"source":"RYGER_RIVERS","target":"WALDER","weight":4},{"directed":false,"source":"SANSA","target":"YOREN","weight":4},{"directed":false,"source":"SHAE","target":"TYWIN","weight":29},{"directed":false,"source":"STEVRON_FREY","target":"WALDER","weight":4},{"directed":false,"source":"WAYMAR_ROYCE","target":"WILL","weight":4},{"directed":false,"source":"ADDAM_MARBRAND","target":"KEVAN","weight":3},{"directed":false,"source":"ADDAM_MARBRAND","target":"LEO_LEFFORD","weight":3},{"directed":false,"source":"AERYS","target":"JAIME","weight":13},{"directed":false,"source":"AERYS","target":"RHAEGAR","weight":3},{"directed":false,"source":"ALLISER_THORNE","target":"OTHELL_YARWYCK","weight":12},{"directed":false,"source":"ARYA","target":"JAIME","weight":8},{"directed":false,"source":"ARYA","target":"PYCELLE","weight":3},{"directed":false,"source":"ASSASSIN","target":"CATELYN","weight":3},{"directed":false,"source":"BAELOR","target":"ILYN_PAYNE","weight":3},{"directed":false,"source":"BALON","target":"THEON","weight":84},{"directed":false,"source":"BARRISTAN","target":"LANCEL","weight":3},{"directed":false,"source":"BARRISTAN","target":"RENLY","weight":3},{"directed":false,"source":"BERIC","target":"NED","weight":8},{"directed":false,"source":"BRAN","target":"WILL","weight":3},{"directed":false,"source":"BRANDON_STARK","target":"NED","weight":3},{"directed":false,"source":"BRONN","target":"MORD","weight":3},{"directed":false,"source":"BRONN","target":"ROBIN","weight":3},{"directed":false,"source":"CATELYN","target":"HOSTER","weight":13},{"directed":false,"source":"CATELYN","target":"JOFFREY","weight":8},{"directed":false,"source":"CATELYN","target":"MASHA_HEDDLE","weight":3},{"directed":false,"source":"CATELYN","target":"YOREN","weight":3},{"directed":false,"source":"CERSEI","target":"ILYN_PAYNE","weight":8},{"directed":false,"source":"CERSEI","target":"JON","weight":30},{"directed":false,"source":"CERSEI","target":"JON_ARRYN","weight":3},{"directed":false,"source":"CERSEI","target":"LANCEL","weight":60},{"directed":false,"source":"CERSEI","target":"RENLY","weight":3},{"directed":false,"source":"CERSEI","target":"TYWIN","weight":214},{"directed":false,"source":"COHOLLO","target":"DROGO","weight":3},{"directed":false,"source":"DAENERYS","target":"NED","weight":6},{"directed":false,"source":"DOREAH","target":"DROGO","weight":3},{"directed":false,"source":"DOREAH","target":"WINE_MERCHANT","weight":3},{"directed":false,"source":"GENDRY","target":"HOT_PIE","weight":40},{"directed":false,"source":"GREATJON_UMBER","target":"JAIME","weight":3},{"directed":false,"source":"GREATJON_UMBER","target":"TYWIN","weight":3},{"directed":false,"source":"HODOR","target":"ROBB","weight":3},{"directed":false,"source":"HODOR","target":"THEON","weight":8},{"directed":false,"source":"HODOR","target":"TYRION","weight":3},{"directed":false,"source":"HOSTER","target":"WALDER","weight":6},{"directed":false,"source":"HOUND","target":"ILYN_PAYNE","weight":5},{"directed":false,"source":"IRRI","target":"JHIQUI","weight":3},{"directed":false,"source":"IRRI","target":"VISERYS","weight":3},{"directed":false,"source":"JANOS","target":"RENLY","weight":3},{"directed":false,"source":"JEOR","target":"NED","weight":3},{"directed":false,"source":"JEOR","target":"ROBERT","weight":3},{"directed":false,"source":"JOFFREY","target":"RENLY","weight":13},{"directed":false,"source":"JOFFREY","target":"TYWIN","weight":98},{"directed":false,"source":"JOFFREY","target":"YOREN","weight":3},{"directed":false,"source":"JON","target":"ROBERT","weight":6},{"directed":false,"source":"JON","target":"WILL","weight":3},{"directed":false,"source":"JON_ARRYN","target":"PYCELLE","weight":5},{"directed":false,"source":"JON_ARRYN","target":"ROBIN","weight":5},{"directed":false,"source":"JORAH","target":"RHAEGO","weight":3},{"directed":false,"source":"LITTLEFINGER","target":"STANNIS","weight":16},{"directed":false,"source":"LORAS","target":"ROBERT","weight":3},{"directed":false,"source":"LYANNA","target":"ROBERT","weight":5},{"directed":false,"source":"MERYN_TRANT","target":"NED","weight":3},{"directed":false,"source":"MORD","target":"ROBIN","weight":3},{"directed":false,"source":"MORD","target":"VARDIS_EGEN","weight":3},{"directed":false,"source":"MYCAH","target":"NED","weight":3},{"directed":false,"source":"MYRCELLA","target":"TYRION","weight":16},{"directed":false,"source":"NED","target":"PYP","weight":3},{"directed":false,"source":"NED","target":"WILL","weight":3},{"directed":false,"source":"OSHA","target":"RICKON","weight":34},{"directed":false,"source":"QOTHO","target":"RAKHARO","weight":3},{"directed":false,"source":"RAKHARO","target":"VISERYS","weight":3},{"directed":false,"source":"RAKHARO","target":"WINE_MERCHANT","weight":3},{"directed":false,"source":"RAST","target":"TYRION","weight":3},{"directed":false,"source":"RENLY","target":"ROBB","weight":11},{"directed":false,"source":"RICKON","target":"ROBB","weight":5},{"directed":false,"source":"ROBIN","target":"VARDIS_EGEN","weight":3},{"directed":false,"source":"THEON","target":"WALDER","weight":3},{"directed":false,"source":"VARYS","target":"YOREN","weight":3},{"directed":false,"source":"ADDAM_MARBRAND","target":"TYWIN","weight":2},{"directed":false,"source":"AEGON","target":"AERYS","weight":2},{"directed":false,"source":"AEGON","target":"MAESTER_AEMON","weight":5},{"directed":false,"source":"AERYS","target":"BARRISTAN","weight":7},{"directed":false,"source":"AERYS","target":"CATELYN","weight":2},{"directed":false,"source":"AERYS","target":"JORAH","weight":2},{"directed":false,"source":"AERYS","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"AERYS","target":"RENLY","weight":2},{"directed":false,"source":"AERYS","target":"SANSA","weight":4},{"directed":false,"source":"AERYS","target":"SEPTA_MORDANE","weight":2},{"directed":false,"source":"ALLISER_THORNE","target":"MAESTER_AEMON","weight":17},{"directed":false,"source":"ARYA","target":"ILLYRIO","weight":2},{"directed":false,"source":"ARYA","target":"LOMMY_GREENHANDS","weight":2},{"directed":false,"source":"ARYA","target":"TYRION","weight":18},{"directed":false,"source":"ASSASSIN","target":"BRAN","weight":2},{"directed":false,"source":"ASSASSIN","target":"ROBB","weight":2},{"directed":false,"source":"BAELOR","target":"CERSEI","weight":2},{"directed":false,"source":"BAELOR","target":"HOUND","weight":2},{"directed":false,"source":"BAELOR","target":"JOFFREY","weight":4},{"directed":false,"source":"BAELOR","target":"PYCELLE","weight":2},{"directed":false,"source":"BAELOR","target":"SANSA","weight":2},{"directed":false,"source":"BALON","target":"TYRION","weight":2},{"directed":false,"source":"BENJEN","target":"CATELYN","weight":2},{"directed":false,"source":"BENJEN","target":"CERSEI","weight":2},{"directed":false,"source":"BENJEN","target":"JEOR","weight":2},{"directed":false,"source":"BENJEN","target":"ROBERT","weight":2},{"directed":false,"source":"BERIC","target":"ROBERT","weight":2},{"directed":false,"source":"BORCAS","target":"DAREON","weight":2},{"directed":false,"source":"BORCAS","target":"PYP","weight":2},{"directed":false,"source":"BOWEN_MARSH","target":"DAREON","weight":2},{"directed":false,"source":"BOWEN_MARSH","target":"PYP","weight":2},{"directed":false,"source":"BRAN","target":"BRANDON_STARK","weight":2},{"directed":false,"source":"BRAN","target":"HOUND","weight":2},{"directed":false,"source":"BRANDON_STARK","target":"CATELYN","weight":5},{"directed":false,"source":"BRANDON_STARK","target":"JON","weight":2},{"directed":false,"source":"BRANDON_STARK","target":"RICKARD_STARK","weight":2},{"directed":false,"source":"BRONN","target":"KEVAN","weight":2},{"directed":false,"source":"BRONN","target":"MARILLION","weight":2},{"directed":false,"source":"CATELYN","target":"DAENERYS","weight":2},{"directed":false,"source":"CATELYN","target":"HOUND","weight":4},{"directed":false,"source":"CATELYN","target":"STEVRON_FREY","weight":2},{"directed":false,"source":"CERSEI","target":"JEOR","weight":2},{"directed":false,"source":"CERSEI","target":"LYANNA","weight":2},{"directed":false,"source":"CERSEI","target":"MERYN_TRANT","weight":30},{"directed":false,"source":"CERSEI","target":"ROS","weight":2},{"directed":false,"source":"CERSEI","target":"STANNIS","weight":9},{"directed":false,"source":"CERSEI","target":"YOREN","weight":2},{"directed":false,"source":"DAENERYS","target":"JHIQUI","weight":2},{"directed":false,"source":"DAENERYS","target":"SANSA","weight":73},{"directed":false,"source":"DAREON","target":"GRENN","weight":2},{"directed":false,"source":"DAREON","target":"JEOR","weight":2},{"directed":false,"source":"DAREON","target":"LUKE","weight":2},{"directed":false,"source":"DAREON","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"DAREON","target":"RAST","weight":2},{"directed":false,"source":"DOREAH","target":"IROGENIA","weight":2},{"directed":false,"source":"DOREAH","target":"JHIQUI","weight":2},{"directed":false,"source":"DOREAH","target":"JORAH","weight":9},{"directed":false,"source":"DROGO","target":"IRRI","weight":2},{"directed":false,"source":"DROGO","target":"ROBERT","weight":2},{"directed":false,"source":"GALBART_GLOVER","target":"GREATJON_UMBER","weight":2},{"directed":false,"source":"GALBART_GLOVER","target":"JONOS_BRACKEN","weight":2},{"directed":false,"source":"GALBART_GLOVER","target":"ROBB","weight":2},{"directed":false,"source":"GENDRY","target":"VARYS","weight":2},{"directed":false,"source":"GENDRY","target":"YOREN","weight":9},{"directed":false,"source":"GREATJON_UMBER","target":"NED","weight":2},{"directed":false,"source":"GREATJON_UMBER","target":"RENLY","weight":2},{"directed":false,"source":"GREATJON_UMBER","target":"RICKARD_KARSTARK","weight":2},{"directed":false,"source":"GREATJON_UMBER","target":"STANNIS","weight":2},{"directed":false,"source":"GREATJON_UMBER","target":"WALDER","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"NED","weight":2},{"directed":false,"source":"HODOR","target":"OSHA","weight":38},{"directed":false,"source":"HOUND","target":"JAIME","weight":15},{"directed":false,"source":"HOUND","target":"ROBB","weight":4},{"directed":false,"source":"HOUND","target":"YOREN","weight":2},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"JON_ARRYN","weight":2},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"MOUNTAIN","weight":2},{"directed":false,"source":"HUGH_OF_THE_VALE","target":"SANSA","weight":2},{"directed":false,"source":"ILLYRIO","target":"JORAH","weight":2},{"directed":false,"source":"ILYN_PAYNE","target":"MERYN_TRANT","weight":4},{"directed":false,"source":"ILYN_PAYNE","target":"VARYS","weight":2},{"directed":false,"source":"JAIME","target":"JON_ARRYN","weight":2},{"directed":false,"source":"JAIME","target":"RICKARD_STARK","weight":2},{"directed":false,"source":"JAIME","target":"SANSA","weight":30},{"directed":false,"source":"JAIME","target":"TYSHA","weight":2},{"directed":false,"source":"JANOS","target":"LITTLEFINGER","weight":6},{"directed":false,"source":"JANOS","target":"PYCELLE","weight":4},{"directed":false,"source":"JAREMY_RYKKER","target":"JEOR","weight":2},{"directed":false,"source":"JAREMY_RYKKER","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"JAREMY_RYKKER","target":"PYP","weight":2},{"directed":false,"source":"JEOR","target":"JOFFREY","weight":2},{"directed":false,"source":"JOANNA","target":"TYRION","weight":2},{"directed":false,"source":"JOFFREY","target":"JON","weight":2},{"directed":false,"source":"JOFFREY","target":"TOMMEN","weight":26},{"directed":false,"source":"JOFFREY","target":"WILL","weight":2},{"directed":false,"source":"JON","target":"RODRIK","weight":2},{"directed":false,"source":"JON","target":"ROS","weight":2},{"directed":false,"source":"JON_ARRYN","target":"VARYS","weight":2},{"directed":false,"source":"JORAH","target":"LITTLE_BIRD","weight":2},{"directed":false,"source":"JORAH","target":"NED","weight":2},{"directed":false,"source":"JORAH","target":"VARYS","weight":25},{"directed":false,"source":"JORY_CASSEL","target":"MHAEGEN","weight":2},{"directed":false,"source":"JORY_CASSEL","target":"THEON","weight":2},{"directed":false,"source":"JOYEUSE","target":"WALDER","weight":6},{"directed":false,"source":"KEVAN","target":"LEO_LEFFORD","weight":2},{"directed":false,"source":"KEVAN","target":"SHAGGA","weight":2},{"directed":false,"source":"LANCEL","target":"RENLY","weight":2},{"directed":false,"source":"LEO_LEFFORD","target":"TYRION","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"LORAS","weight":19},{"directed":false,"source":"LITTLEFINGER","target":"MHAEGEN","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"YOREN","weight":2},{"directed":false,"source":"LORAS","target":"MACE","weight":8},{"directed":false,"source":"LUKE","target":"PYP","weight":2},{"directed":false,"source":"MAESTER_LUWIN","target":"ROBERT","weight":2},{"directed":false,"source":"MAESTER_LUWIN","target":"RODRIK","weight":7},{"directed":false,"source":"MAESTER_LUWIN","target":"SANSA","weight":2},{"directed":false,"source":"MARILLION","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"MARILLION","target":"YOREN","weight":2},{"directed":false,"source":"MELESSA","target":"SAM","weight":25},{"directed":false,"source":"MORD","target":"RODRIK","weight":2},{"directed":false,"source":"NED","target":"ROOSE_BOLTON","weight":2},{"directed":false,"source":"NED","target":"ROS","weight":2},{"directed":false,"source":"NED","target":"STEFFON","weight":2},{"directed":false,"source":"NED","target":"VARLY","weight":2},{"directed":false,"source":"OLD_NAN","target":"THEON","weight":2},{"directed":false,"source":"OTHELL_YARWYCK","target":"PYP","weight":2},{"directed":false,"source":"OTHOR","target":"PYP","weight":2},{"directed":false,"source":"OTHOR","target":"SAM","weight":2},{"directed":false,"source":"PYCELLE","target":"TYWIN","weight":28},{"directed":false,"source":"PYCELLE","target":"YOREN","weight":2},{"directed":false,"source":"RANDYLL","target":"SAM","weight":30},{"directed":false,"source":"RENLY","target":"TOMARD","weight":2},{"directed":false,"source":"RHAEGAR","target":"ROBERT","weight":6},{"directed":false,"source":"RHAEGO","target":"VISERYS","weight":2},{"directed":false,"source":"RICKARD_KARSTARK","target":"ROBB","weight":52},{"directed":false,"source":"RICKARD_KARSTARK","target":"THEON","weight":4},{"directed":false,"source":"ROBB","target":"STANNIS","weight":11},{"directed":false,"source":"ROBB","target":"VARYS","weight":4},{"directed":false,"source":"ROBERT","target":"ROS","weight":2},{"directed":false,"source":"ROBERT","target":"TOMMEN","weight":4},{"directed":false,"source":"RODRIK","target":"TYWIN","weight":2},{"directed":false,"source":"SANSA","target":"STANNIS","weight":8},{"directed":false,"source":"STANNIS","target":"TOMARD","weight":2},{"directed":false,"source":"THEON","target":"WILL","weight":2},{"directed":false,"source":"TYRION","target":"TYSHA","weight":2},{"directed":false,"source":"TYRION","target":"VARYS","weight":511},{"directed":false,"source":"ARYA","target":"JAQEN","weight":346},{"directed":false,"source":"DAVOS","target":"STANNIS","weight":316},{"directed":false,"source":"JON","target":"YGRITTE","weight":286},{"directed":false,"source":"ROBB","target":"TALISA","weight":197},{"directed":false,"source":"ARYA","target":"TYWIN","weight":103},{"directed":false,"source":"THEON","target":"YARA","weight":218},{"directed":false,"source":"DAENERYS","target":"XARO","weight":80},{"directed":false,"source":"JON","target":"QHORIN","weight":73},{"directed":false,"source":"SANSA","target":"SHAE","weight":122},{"directed":false,"source":"DAENERYS","target":"SPICE_KING","weight":58},{"directed":false,"source":"DAVOS","target":"MATTHOS","weight":59},{"directed":false,"source":"MELISANDRE","target":"STANNIS","weight":171},{"directed":false,"source":"BRIENNE","target":"CATELYN","weight":73},{"directed":false,"source":"BRIENNE","target":"JAIME","weight":397},{"directed":false,"source":"PYCELLE","target":"TYRION","weight":64},{"directed":false,"source":"DAGMER","target":"THEON","weight":48},{"directed":false,"source":"ALTON","target":"JAIME","weight":48},{"directed":false,"source":"DAVOS","target":"MELISANDRE","weight":183},{"directed":false,"source":"JANOS","target":"TYRION","weight":39},{"directed":false,"source":"LORAS","target":"TYRION","weight":51},{"directed":false,"source":"LANCEL","target":"TYRION","weight":37},{"directed":false,"source":"PODRICK","target":"TYRION","weight":186},{"directed":false,"source":"MARGAERY","target":"RENLY","weight":39},{"directed":false,"source":"EDDISON_TOLLETT","target":"SAM","weight":72},{"directed":false,"source":"ROBB","target":"ROOSE_BOLTON","weight":51},{"directed":false,"source":"BRIENNE","target":"RENLY","weight":39},{"directed":false,"source":"DAENERYS","target":"KOVARRO","weight":31},{"directed":false,"source":"CATELYN","target":"RENLY","weight":30},{"directed":false,"source":"CRASTER","target":"JEOR","weight":46},{"directed":false,"source":"LITTLEFINGER","target":"MARGAERY","weight":28},{"directed":false,"source":"QHORIN","target":"YGRITTE","weight":28},{"directed":false,"source":"DAVOS","target":"SALLADHOR","weight":69},{"directed":false,"source":"EDDISON_TOLLETT","target":"GRENN","weight":70},{"directed":false,"source":"CERSEI","target":"TOMMEN","weight":160},{"directed":false,"source":"SANSA","target":"TYRION","weight":249},{"directed":false,"source":"GILLY","target":"SAM","weight":392},{"directed":false,"source":"DAENERYS","target":"PYATT_PREE","weight":23},{"directed":false,"source":"LORAS","target":"MARGAERY","weight":115},{"directed":false,"source":"ALTON","target":"ROBB","weight":22},{"directed":false,"source":"ROS","target":"VARYS","weight":47},{"directed":false,"source":"BLACK_LORREN","target":"THEON","weight":21},{"directed":false,"source":"CERSEI","target":"SHAE","weight":28},{"directed":false,"source":"MATTHOS","target":"STANNIS","weight":21},{"directed":false,"source":"SPICE_KING","target":"XARO","weight":20},{"directed":false,"source":"STANNIS","target":"TYRION","weight":20},{"directed":false,"source":"JORAH","target":"QUAITHE","weight":18},{"directed":false,"source":"CAPTAINS_DAUGHTER","target":"THEON","weight":17},{"directed":false,"source":"CATELYN","target":"RICKARD_KARSTARK","weight":22},{"directed":false,"source":"CRASTER","target":"JON","weight":28},{"directed":false,"source":"DAISY","target":"ROS","weight":17},{"directed":false,"source":"AMORY","target":"ARYA","weight":16},{"directed":false,"source":"ARYA","target":"RORGE","weight":20},{"directed":false,"source":"CRESSEN","target":"DAVOS","weight":16},{"directed":false,"source":"HODOR","target":"RICKON","weight":25},{"directed":false,"source":"LORD_OF_BONES","target":"YGRITTE","weight":20},{"directed":false,"source":"BALON","target":"YARA","weight":49},{"directed":false,"source":"JORAH","target":"KOVARRO","weight":15},{"directed":false,"source":"AMORY","target":"TYWIN","weight":14},{"directed":false,"source":"MATTHOS","target":"SALLADHOR","weight":14},{"directed":false,"source":"BRONN","target":"HOUND","weight":16},{"directed":false,"source":"CATELYN","target":"STANNIS","weight":13},{"directed":false,"source":"DONTOS","target":"JOFFREY","weight":19},{"directed":false,"source":"DOREAH","target":"XARO","weight":13},{"directed":false,"source":"HAYLENE","target":"TYRION","weight":13},{"directed":false,"source":"JEOR","target":"QHORIN","weight":13},{"directed":false,"source":"MERYN_TRANT","target":"TYRION","weight":29},{"directed":false,"source":"CERSEI","target":"MYRCELLA","weight":34},{"directed":false,"source":"DAVOS","target":"RENLY","weight":12},{"directed":false,"source":"JOFFREY","target":"LANCEL","weight":12},{"directed":false,"source":"JON","target":"LORD_OF_BONES","weight":20},{"directed":false,"source":"JORAH","target":"XARO","weight":12},{"directed":false,"source":"MOUNTAIN","target":"TYWIN","weight":20},{"directed":false,"source":"BRONN","target":"VARYS","weight":16},{"directed":false,"source":"CATELYN","target":"TALISA","weight":44},{"directed":false,"source":"CERSEI","target":"JANOS","weight":11},{"directed":false,"source":"SHAE","target":"VARYS","weight":33},{"directed":false,"source":"BRONN","target":"HAYLENE","weight":10},{"directed":false,"source":"CRESSEN","target":"MELISANDRE","weight":10},{"directed":false,"source":"GILLY","target":"JON","weight":25},{"directed":false,"source":"HOT_PIE","target":"LOMMY","weight":10},{"directed":false,"source":"KOVARRO","target":"XARO","weight":10},{"directed":false,"source":"PODRICK","target":"VARYS","weight":17},{"directed":false,"source":"QHORIN","target":"LORD_OF_BONES","weight":10},{"directed":false,"source":"ALTON","target":"CERSEI","weight":9},{"directed":false,"source":"BRONN","target":"JOFFREY","weight":15},{"directed":false,"source":"CATELYN","target":"LORAS","weight":9},{"directed":false,"source":"HODOR","target":"MAESTER_LUWIN","weight":9},{"directed":false,"source":"HOUND","target":"LANCEL","weight":9},{"directed":false,"source":"JAQEN","target":"RORGE","weight":9},{"directed":false,"source":"JOFFREY","target":"ROS","weight":9},{"directed":false,"source":"JOFFREY","target":"STANNIS","weight":14},{"directed":false,"source":"MANCE","target":"QHORIN","weight":9},{"directed":false,"source":"PYATT_PREE","target":"XARO","weight":9},{"directed":false,"source":"SANSA","target":"TOMMEN","weight":13},{"directed":false,"source":"AMORY","target":"YOREN","weight":8},{"directed":false,"source":"ARYA","target":"BITER","weight":8},{"directed":false,"source":"BALON","target":"ROBB","weight":10},{"directed":false,"source":"BITER","target":"RORGE","weight":10},{"directed":false,"source":"CATELYN","target":"JACKS","weight":8},{"directed":false,"source":"EDDISON_TOLLETT","target":"JON","weight":117},{"directed":false,"source":"JOFFREY","target":"LORAS","weight":19},{"directed":false,"source":"JOFFREY","target":"MYRCELLA","weight":8},{"directed":false,"source":"MANDON","target":"TYRION","weight":8},{"directed":false,"source":"MELISANDRE","target":"RENLY","weight":8},{"directed":false,"source":"REGINALD","target":"TYWIN","weight":8},{"directed":false,"source":"ARYA","target":"POLLIVER","weight":26},{"directed":false,"source":"BLACK_LORREN","target":"DAGMER","weight":7},{"directed":false,"source":"BRIENNE","target":"JACKS","weight":7},{"directed":false,"source":"BRIENNE","target":"LORAS","weight":9},{"directed":false,"source":"DAISY","target":"JOFFREY","weight":7},{"directed":false,"source":"THEON","target":"WINTERFELL_SHEPHERD","weight":7},{"directed":false,"source":"ARYA","target":"LOMMY","weight":8},{"directed":false,"source":"ARYA","target":"MOUNTAIN","weight":10},{"directed":false,"source":"BRAN","target":"DAGMER","weight":6},{"directed":false,"source":"BRAN","target":"FARLEN","weight":6},{"directed":false,"source":"BRONN","target":"LANCEL","weight":6},{"directed":false,"source":"BRONN","target":"PYCELLE","weight":8},{"directed":false,"source":"CRASTER","target":"GILLY","weight":6},{"directed":false,"source":"GENDRY","target":"TICKLER","weight":6},{"directed":false,"source":"LOMMY","target":"POLLIVER","weight":6},{"directed":false,"source":"MANCE","target":"YGRITTE","weight":16},{"directed":false,"source":"MANDON","target":"PODRICK","weight":6},{"directed":false,"source":"RICKON","target":"THEON","weight":13},{"directed":false,"source":"ROOSE_BOLTON","target":"TALISA","weight":13},{"directed":false,"source":"ALTON","target":"TORRHEN","weight":5},{"directed":false,"source":"ARYA","target":"TICKLER","weight":5},{"directed":false,"source":"BALON","target":"NED","weight":5},{"directed":false,"source":"BITER","target":"JAQEN","weight":5},{"directed":false,"source":"BRIENNE","target":"MARGAERY","weight":17},{"directed":false,"source":"BRIENNE","target":"ROBB","weight":5},{"directed":false,"source":"BRIENNE","target":"STANNIS","weight":18},{"directed":false,"source":"BRONN","target":"MERYN_TRANT","weight":13},{"directed":false,"source":"CATELYN","target":"MARGAERY","weight":5},{"directed":false,"source":"CERSEI","target":"LORAS","weight":48},{"directed":false,"source":"CRASTER","target":"SAM","weight":13},{"directed":false,"source":"CRESSEN","target":"STANNIS","weight":5},{"directed":false,"source":"DAGMER","target":"MAESTER_LUWIN","weight":5},{"directed":false,"source":"DROWNED_PRIEST","target":"THEON","weight":5},{"directed":false,"source":"GERARD","target":"RENLY","weight":5},{"directed":false,"source":"JOFFREY","target":"PODRICK","weight":10},{"directed":false,"source":"JON","target":"MANCE","weight":124},{"directed":false,"source":"JORAH","target":"PYATT_PREE","weight":5},{"directed":false,"source":"LORAS","target":"STANNIS","weight":5},{"directed":false,"source":"MYRCELLA","target":"SANSA","weight":5},{"directed":false,"source":"MYRCELLA","target":"TOMMEN","weight":9},{"directed":false,"source":"PYCELLE","target":"TIMETT","weight":5},{"directed":false,"source":"QHORIN","target":"SAM","weight":5},{"directed":false,"source":"TYWIN","target":"VARYS","weight":33},{"directed":false,"source":"ALTON","target":"RICKARD_KARSTARK","weight":4},{"directed":false,"source":"BARRA","target":"MHAEGEN","weight":4},{"directed":false,"source":"BRONN","target":"SANSA","weight":7},{"directed":false,"source":"BRONN","target":"TIMETT","weight":4},{"directed":false,"source":"CATELYN","target":"COLEN","weight":4},{"directed":false,"source":"CATELYN","target":"ROOSE_BOLTON","weight":17},{"directed":false,"source":"CERSEI","target":"PODRICK","weight":9},{"directed":false,"source":"DAENERYS","target":"QUAITHE","weight":4},{"directed":false,"source":"DAENERYS","target":"SILK_KING","weight":4},{"directed":false,"source":"DAGMER","target":"RICKON","weight":4},{"directed":false,"source":"DONTOS","target":"MERYN_TRANT","weight":4},{"directed":false,"source":"DOREAH","target":"KOVARRO","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"GILLY","weight":8},{"directed":false,"source":"GENDRY","target":"JAQEN","weight":4},{"directed":false,"source":"GENDRY","target":"LOMMY","weight":4},{"directed":false,"source":"GENDRY","target":"TYWIN","weight":6},{"directed":false,"source":"HAYLENE","target":"HOUND","weight":4},{"directed":false,"source":"HAYLENE","target":"JOFFREY","weight":4},{"directed":false,"source":"HOUND","target":"PODRICK","weight":16},{"directed":false,"source":"ILYN_PAYNE","target":"SHAE","weight":4},{"directed":false,"source":"JAIME","target":"RICKARD_KARSTARK","weight":4},{"directed":false,"source":"JAIME","target":"STANNIS","weight":9},{"directed":false,"source":"JANOS","target":"JOFFREY","weight":4},{"directed":false,"source":"JANOS","target":"MHAEGEN","weight":4},{"directed":false,"source":"JANOS","target":"ROS","weight":4},{"directed":false,"source":"JOFFREY","target":"MANDON","weight":4},{"directed":false,"source":"JOFFREY","target":"MARGAERY","weight":110},{"directed":false,"source":"LANCEL","target":"SANSA","weight":4},{"directed":false,"source":"MAESTER_LUWIN","target":"RICKON","weight":4},{"directed":false,"source":"MATTHOS","target":"MELISANDRE","weight":4},{"directed":false,"source":"RICKARD_KARSTARK","target":"TORRHEN","weight":4},{"directed":false,"source":"ROBB","target":"YARA","weight":4},{"directed":false,"source":"STANNIS","target":"VARYS","weight":6},{"directed":false,"source":"ALTON","target":"TYRION","weight":3},{"directed":false,"source":"AMORY","target":"JAQEN","weight":3},{"directed":false,"source":"AMORY","target":"POLLIVER","weight":3},{"directed":false,"source":"ARYA","target":"VISENYA","weight":3},{"directed":false,"source":"BLACK_LORREN","target":"RODRIK","weight":3},{"directed":false,"source":"BRAN","target":"JOFFREY","weight":3},{"directed":false,"source":"BRAN","target":"WINTERFELL_SHEPHERD","weight":3},{"directed":false,"source":"BRONN","target":"JANOS","weight":3},{"directed":false,"source":"BRONN","target":"PODRICK","weight":61},{"directed":false,"source":"CERSEI","target":"MANDON","weight":3},{"directed":false,"source":"CRASTER","target":"EDDISON_TOLLETT","weight":12},{"directed":false,"source":"DAENERYS","target":"MALAKKO","weight":3},{"directed":false,"source":"DAGMER","target":"OSHA","weight":3},{"directed":false,"source":"DAGMER","target":"RODRIK","weight":3},{"directed":false,"source":"FARLEN","target":"THEON","weight":3},{"directed":false,"source":"GENDRY","target":"MOUNTAIN","weight":3},{"directed":false,"source":"GENDRY","target":"RORGE","weight":3},{"directed":false,"source":"HOT_PIE","target":"JAQEN","weight":3},{"directed":false,"source":"HOT_PIE","target":"MOUNTAIN","weight":3},{"directed":false,"source":"HOUND","target":"SHAE","weight":3},{"directed":false,"source":"IRRI","target":"KOVARRO","weight":3},{"directed":false,"source":"IRRI","target":"XARO","weight":3},{"directed":false,"source":"JAIME","target":"MATTHOS","weight":3},{"directed":false,"source":"JAIME","target":"TORRHEN","weight":3},{"directed":false,"source":"JANOS","target":"PODRICK","weight":3},{"directed":false,"source":"JAQEN","target":"TYWIN","weight":3},{"directed":false,"source":"JOFFREY","target":"TALISA","weight":3},{"directed":false,"source":"JORAH","target":"SPICE_KING","weight":3},{"directed":false,"source":"KOVARRO","target":"MALAKKO","weight":3},{"directed":false,"source":"KOVARRO","target":"PYATT_PREE","weight":3},{"directed":false,"source":"LANCEL","target":"STANNIS","weight":3},{"directed":false,"source":"LITTLEFINGER","target":"ROBB","weight":5},{"directed":false,"source":"LITTLEFINGER","target":"ROBIN","weight":43},{"directed":false,"source":"LORAS","target":"PYCELLE","weight":5},{"directed":false,"source":"LORAS","target":"TYWIN","weight":20},{"directed":false,"source":"MAESTER_LUWIN","target":"PORTAN","weight":3},{"directed":false,"source":"MAESTER_LUWIN","target":"WINTERFELL_SHEPHERD","weight":3},{"directed":false,"source":"MALAKKO","target":"XARO","weight":3},{"directed":false,"source":"MANCE","target":"LORD_OF_BONES","weight":3},{"directed":false,"source":"MOUNTAIN","target":"POLLIVER","weight":5},{"directed":false,"source":"MYRCELLA","target":"ROBIN","weight":3},{"directed":false,"source":"NED","target":"YARA","weight":3},{"directed":false,"source":"PODRICK","target":"PYCELLE","weight":3},{"directed":false,"source":"PODRICK","target":"SHAE","weight":8},{"directed":false,"source":"PYATT_PREE","target":"SPICE_KING","weight":3},{"directed":false,"source":"QUENT","target":"ROBB","weight":3},{"directed":false,"source":"ROBB","target":"SEPTON","weight":3},{"directed":false,"source":"RORGE","target":"YOREN","weight":3},{"directed":false,"source":"SANSA","target":"TYWIN","weight":24},{"directed":false,"source":"SHAE","target":"TOMMEN","weight":3},{"directed":false,"source":"STANNIS","target":"TYWIN","weight":8},{"directed":false,"source":"THEON","target":"VARYS","weight":14},{"directed":false,"source":"TIMETT","target":"TYRION","weight":3},{"directed":false,"source":"TOMMEN","target":"TYRION","weight":15},{"directed":false,"source":"AEGON","target":"ARYA","weight":2},{"directed":false,"source":"AERYS","target":"PYCELLE","weight":2},{"directed":false,"source":"AERYS","target":"TYWIN","weight":2},{"directed":false,"source":"ALTON","target":"TALISA","weight":2},{"directed":false,"source":"AMORY","target":"HOT_PIE","weight":2},{"directed":false,"source":"ARYA","target":"KEVAN","weight":2},{"directed":false,"source":"ARYA","target":"REGINALD","weight":2},{"directed":false,"source":"ARYA","target":"RHAENYS","weight":2},{"directed":false,"source":"BALON","target":"CATELYN","weight":2},{"directed":false,"source":"BARRA","target":"JANOS","weight":2},{"directed":false,"source":"BENJEN","target":"CRASTER","weight":2},{"directed":false,"source":"BILLY","target":"RICKON","weight":2},{"directed":false,"source":"BITER","target":"YOREN","weight":2},{"directed":false,"source":"BLACK_LORREN","target":"MAESTER_LUWIN","weight":2},{"directed":false,"source":"BLACK_LORREN","target":"OSHA","weight":2},{"directed":false,"source":"BOROS","target":"JOFFREY","weight":2},{"directed":false,"source":"BRAN","target":"SANSA","weight":79},{"directed":false,"source":"BRIENNE","target":"COLEN","weight":2},{"directed":false,"source":"BRIENNE","target":"DAVOS","weight":35},{"directed":false,"source":"BRIENNE","target":"LITTLEFINGER","weight":48},{"directed":false,"source":"BRIENNE","target":"MELISANDRE","weight":12},{"directed":false,"source":"BRIENNE","target":"RICKARD_KARSTARK","weight":2},{"directed":false,"source":"BRONN","target":"CERSEI","weight":18},{"directed":false,"source":"CATELYN","target":"DAVOS","weight":2},{"directed":false,"source":"CATELYN","target":"MELISANDRE","weight":2},{"directed":false,"source":"CATELYN","target":"RICKON","weight":4},{"directed":false,"source":"CERSEI","target":"DAVOS","weight":6},{"directed":false,"source":"CERSEI","target":"HAYLENE","weight":2},{"directed":false,"source":"CERSEI","target":"JOANNA","weight":4},{"directed":false,"source":"CERSEI","target":"MATTHOS","weight":2},{"directed":false,"source":"CERSEI","target":"SALLADHOR","weight":2},{"directed":false,"source":"COLEN","target":"LORAS","weight":2},{"directed":false,"source":"COLEN","target":"MARGAERY","weight":2},{"directed":false,"source":"COLEN","target":"RENLY","weight":2},{"directed":false,"source":"CRASTER","target":"MANCE","weight":4},{"directed":false,"source":"CRESSEN","target":"MATTHOS","weight":2},{"directed":false,"source":"DAGMER","target":"FARLEN","weight":2},{"directed":false,"source":"DAGMER","target":"HODOR","weight":2},{"directed":false,"source":"DAGMER","target":"YARA","weight":2},{"directed":false,"source":"DAVOS","target":"FATHER_SEAWORTH","weight":2},{"directed":false,"source":"DAVOS","target":"JOFFREY","weight":2},{"directed":false,"source":"DAVOS","target":"LORAS","weight":2},{"directed":false,"source":"DAVOS","target":"MARYA","weight":2},{"directed":false,"source":"DAVOS","target":"ROBB","weight":4},{"directed":false,"source":"DAVOS","target":"ROBERT","weight":5},{"directed":false,"source":"DONTOS","target":"SANSA","weight":32},{"directed":false,"source":"EDDISON_TOLLETT","target":"JEOR","weight":8},{"directed":false,"source":"FARLEN","target":"RICKON","weight":2},{"directed":false,"source":"FREY_DAUGHTER","target":"ROBB","weight":2},{"directed":false,"source":"GILLY","target":"GRENN","weight":2},{"directed":false,"source":"HARREN","target":"TYWIN","weight":2},{"directed":false,"source":"HAYLENE","target":"PODRICK","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"MYRCELLA","weight":2},{"directed":false,"source":"HOT_PIE","target":"POLLIVER","weight":2},{"directed":false,"source":"HOT_PIE","target":"TICKLER","weight":2},{"directed":false,"source":"HOUND","target":"STANNIS","weight":2},{"directed":false,"source":"HOUND","target":"TOMMEN","weight":2},{"directed":false,"source":"ILYN_PAYNE","target":"LANCEL","weight":2},{"directed":false,"source":"ILYN_PAYNE","target":"TOMMEN","weight":2},{"directed":false,"source":"JACKS","target":"JAIME","weight":2},{"directed":false,"source":"JAQEN","target":"YOREN","weight":2},{"directed":false,"source":"JOFFREY","target":"MATTHOS","weight":2},{"directed":false,"source":"JOFFREY","target":"SHAE","weight":12},{"directed":false,"source":"JORAH","target":"MALAKKO","weight":2},{"directed":false,"source":"KEVAN","target":"STANNIS","weight":2},{"directed":false,"source":"KOVARRO","target":"SPICE_KING","weight":2},{"directed":false,"source":"LANCEL","target":"SHAE","weight":2},{"directed":false,"source":"LANCEL","target":"TOMMEN","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"MYRCELLA","weight":2},{"directed":false,"source":"LORAS","target":"MELISANDRE","weight":2},{"directed":false,"source":"LORAS","target":"ROBB","weight":2},{"directed":false,"source":"LORAS","target":"TOMMEN","weight":25},{"directed":false,"source":"MARGAERY","target":"STANNIS","weight":2},{"directed":false,"source":"MARGAERY","target":"TYWIN","weight":12},{"directed":false,"source":"MATTHOS","target":"ROBERT","weight":2},{"directed":false,"source":"MERYN_TRANT","target":"TOMMEN","weight":2},{"directed":false,"source":"MHAEGEN","target":"ROS","weight":2},{"directed":false,"source":"MYRCELLA","target":"ROBERT","weight":2},{"directed":false,"source":"MYRCELLA","target":"TRYSTANE","weight":26},{"directed":false,"source":"POLLIVER","target":"TYWIN","weight":2},{"directed":false,"source":"PROTESTER","target":"TYRION","weight":2},{"directed":false,"source":"QUAITHE","target":"XARO","weight":2},{"directed":false,"source":"RAMSAY","target":"ROOSE_BOLTON","weight":122},{"directed":false,"source":"RENNICK","target":"ROBB","weight":2},{"directed":false,"source":"RHAENYS","target":"VISENYA","weight":2},{"directed":false,"source":"RICKARD_KARSTARK","target":"ROOSE_BOLTON","weight":11},{"directed":false,"source":"RICKARD_KARSTARK","target":"TALISA","weight":5},{"directed":false,"source":"RICKON","target":"RODRIK","weight":2},{"directed":false,"source":"ROBERT","target":"THEON","weight":2},{"directed":false,"source":"SEPTON","target":"TALISA","weight":2},{"directed":false,"source":"SILK_KING","target":"SPICE_KING","weight":2},{"directed":false,"source":"TALISA","target":"TORRHEN","weight":2},{"directed":false,"source":"THEON","target":"TORRHEN","weight":2},{"directed":false,"source":"TRYSTANE","target":"TYRION","weight":2},{"directed":false,"source":"RAMSAY","target":"THEON","weight":235},{"directed":false,"source":"DAENERYS","target":"MISSANDEI","weight":221},{"directed":false,"source":"BRAN","target":"JOJEN","weight":107},{"directed":false,"source":"ARYA","target":"THOROS","weight":63},{"directed":false,"source":"MARGAERY","target":"SANSA","weight":71},{"directed":false,"source":"JAIME","target":"LOCKE","weight":59},{"directed":false,"source":"BARRISTAN","target":"JORAH","weight":91},{"directed":false,"source":"KRAZNYS_MO_NAKLOZ","target":"MISSANDEI","weight":54},{"directed":false,"source":"JAIME","target":"QYBURN","weight":90},{"directed":false,"source":"DAVOS","target":"GENDRY","weight":111},{"directed":false,"source":"EDMURE","target":"ROBB","weight":46},{"directed":false,"source":"GENDRY","target":"MELISANDRE","weight":48},{"directed":false,"source":"DAVOS","target":"SHIREEN","weight":103},{"directed":false,"source":"OLENNA","target":"VARYS","weight":40},{"directed":false,"source":"BARRISTAN","target":"DAENERYS","weight":107},{"directed":false,"source":"JON","target":"ORELL","weight":37},{"directed":false,"source":"DAARIO","target":"DAENERYS","weight":225},{"directed":false,"source":"OLENNA","target":"TYWIN","weight":49},{"directed":false,"source":"JON","target":"TORMUND","weight":286},{"directed":false,"source":"MEERA","target":"OSHA","weight":34},{"directed":false,"source":"ARYA","target":"BERIC","weight":51},{"directed":false,"source":"CERSEI","target":"MARGAERY","weight":131},{"directed":false,"source":"ORELL","target":"YGRITTE","weight":32},{"directed":false,"source":"OLENNA","target":"TYRION","weight":40},{"directed":false,"source":"OLENNA","target":"SANSA","weight":33},{"directed":false,"source":"ORELL","target":"TORMUND","weight":30},{"directed":false,"source":"BRAN","target":"MEERA","weight":148},{"directed":false,"source":"JAIME","target":"ROOSE_BOLTON","weight":29},{"directed":false,"source":"TORMUND","target":"YGRITTE","weight":58},{"directed":false,"source":"BERIC","target":"THOROS","weight":66},{"directed":false,"source":"JOJEN","target":"OSHA","weight":28},{"directed":false,"source":"BRYNDEN","target":"CATELYN","weight":27},{"directed":false,"source":"ANGUY","target":"ARYA","weight":26},{"directed":false,"source":"BERIC","target":"HOUND","weight":148},{"directed":false,"source":"CERSEI","target":"OLENNA","weight":87},{"directed":false,"source":"JOJEN","target":"MEERA","weight":68},{"directed":false,"source":"DAENERYS","target":"KRAZNYS_MO_NAKLOZ","weight":23},{"directed":false,"source":"HODOR","target":"JOJEN","weight":44},{"directed":false,"source":"ROOSE_BOLTON","target":"WALDER","weight":23},{"directed":false,"source":"MYRANDA","target":"VIOLET","weight":22},{"directed":false,"source":"MARGAERY","target":"OLENNA","weight":123},{"directed":false,"source":"SELYSE","target":"STANNIS","weight":60},{"directed":false,"source":"ANGUY","target":"HOUND","weight":20},{"directed":false,"source":"ANGUY","target":"THOROS","weight":20},{"directed":false,"source":"GENDRY","target":"THOROS","weight":34},{"directed":false,"source":"DAENERYS","target":"RADZAI_MO_ERAZ","weight":19},{"directed":false,"source":"JEOR","target":"RAST","weight":19},{"directed":false,"source":"THEON","target":"TORTURER","weight":19},{"directed":false,"source":"BRYNDEN","target":"EDMURE","weight":29},{"directed":false,"source":"BRAN","target":"SAM","weight":63},{"directed":false,"source":"BRYNDEN","target":"ROBB","weight":17},{"directed":false,"source":"DAARIO","target":"JORAH","weight":104},{"directed":false,"source":"DAARIO","target":"MERO","weight":17},{"directed":false,"source":"HOUND","target":"THOROS","weight":99},{"directed":false,"source":"DAENERYS","target":"MERO","weight":16},{"directed":false,"source":"SHIREEN","target":"STANNIS","weight":70},{"directed":false,"source":"BRIENNE","target":"LOCKE","weight":15},{"directed":false,"source":"CATELYN","target":"EDMURE","weight":17},{"directed":false,"source":"HODOR","target":"MEERA","weight":73},{"directed":false,"source":"JAIME","target":"STEELSHANKS_WALTON","weight":14},{"directed":false,"source":"MANCE","target":"TORMUND","weight":26},{"directed":false,"source":"MELISANDRE","target":"THOROS","weight":16},{"directed":false,"source":"CRASTER","target":"KARL_TANNER","weight":18},{"directed":false,"source":"JORAH","target":"MISSANDEI","weight":44},{"directed":false,"source":"MEERA","target":"RICKON","weight":13},{"directed":false,"source":"MERO","target":"PRENDAHL","weight":13},{"directed":false,"source":"DAENERYS","target":"GREY_WORM","weight":110},{"directed":false,"source":"EDMURE","target":"ROSLIN","weight":12},{"directed":false,"source":"GREY_WORM","target":"JORAH","weight":41},{"directed":false,"source":"JOJEN","target":"SAM","weight":12},{"directed":false,"source":"MARTYN","target":"TALISA","weight":12},{"directed":false,"source":"MYRANDA","target":"THEON","weight":29},{"directed":false,"source":"ROS","target":"SHAE","weight":12},{"directed":false,"source":"THEON","target":"VIOLET","weight":12},{"directed":false,"source":"ANGUY","target":"BERIC","weight":11},{"directed":false,"source":"ANGUY","target":"GENDRY","weight":11},{"directed":false,"source":"EDDISON_TOLLETT","target":"RAST","weight":11},{"directed":false,"source":"LORAS","target":"OLYVAR","weight":26},{"directed":false,"source":"EDMURE","target":"WALDER","weight":15},{"directed":false,"source":"GILLY","target":"MAESTER_AEMON","weight":14},{"directed":false,"source":"LOCKE","target":"ROOSE_BOLTON","weight":12},{"directed":false,"source":"LORAS","target":"OLENNA","weight":25},{"directed":false,"source":"MANCE","target":"ORELL","weight":10},{"directed":false,"source":"TALISA","target":"WALDER","weight":10},{"directed":false,"source":"BRIENNE","target":"ROOSE_BOLTON","weight":9},{"directed":false,"source":"GENDRY","target":"STANNIS","weight":9},{"directed":false,"source":"JOJEN","target":"RICKON","weight":9},{"directed":false,"source":"LITTLE_SAM","target":"GILLY","weight":9},{"directed":false,"source":"LITTLE_SAM","target":"SAM","weight":61},{"directed":false,"source":"ROOSE_BOLTON","target":"TYWIN","weight":13},{"directed":false,"source":"BLACK_WALDER","target":"ROBB","weight":8},{"directed":false,"source":"BRYNDEN","target":"ROOSE_BOLTON","weight":8},{"directed":false,"source":"BRYNDEN","target":"TALISA","weight":8},{"directed":false,"source":"CRASTER","target":"RAST","weight":13},{"directed":false,"source":"DAENERYS","target":"PRENDAHL","weight":8},{"directed":false,"source":"EDMURE","target":"TALISA","weight":8},{"directed":false,"source":"FARMER","target":"JON","weight":8},{"directed":false,"source":"GILLY","target":"MEERA","weight":8},{"directed":false,"source":"HODOR","target":"SAM","weight":8},{"directed":false,"source":"JEOR","target":"KARL_TANNER","weight":10},{"directed":false,"source":"JOFFREY","target":"OLENNA","weight":20},{"directed":false,"source":"MEERA","target":"SAM","weight":8},{"directed":false,"source":"MERYN_TRANT","target":"TARYN_MANT","weight":8},{"directed":false,"source":"ROSLIN","target":"WALDER","weight":8},{"directed":false,"source":"BARRISTAN","target":"MISSANDEI","weight":20},{"directed":false,"source":"BERIC","target":"GENDRY","weight":24},{"directed":false,"source":"DAARIO","target":"MISSANDEI","weight":32},{"directed":false,"source":"DAARIO","target":"PRENDAHL","weight":7},{"directed":false,"source":"EDMURE","target":"LOTHAR","weight":13},{"directed":false,"source":"FARMER","target":"TORMUND","weight":7},{"directed":false,"source":"BARRISTAN","target":"DAARIO","weight":20},{"directed":false,"source":"BERIC","target":"MELISANDRE","weight":12},{"directed":false,"source":"BRYNDEN","target":"WALDER","weight":11},{"directed":false,"source":"CATELYN","target":"JOYEUSE","weight":6},{"directed":false,"source":"DAARIO","target":"GREY_WORM","weight":40},{"directed":false,"source":"FARMER","target":"YGRITTE","weight":6},{"directed":false,"source":"HOT_PIE","target":"THOROS","weight":6},{"directed":false,"source":"JAIME","target":"RENLY","weight":6},{"directed":false,"source":"JORAH","target":"MERO","weight":6},{"directed":false,"source":"MACE","target":"OLENNA","weight":20},{"directed":false,"source":"MERO","target":"MISSANDEI","weight":6},{"directed":false,"source":"ROBB","target":"ROSLIN","weight":6},{"directed":false,"source":"ARYA","target":"MELISANDRE","weight":18},{"directed":false,"source":"BARRISTAN","target":"GREY_WORM","weight":19},{"directed":false,"source":"BLACK_WALDER","target":"EDMURE","weight":14},{"directed":false,"source":"BLACK_WALDER","target":"LOTHAR","weight":20},{"directed":false,"source":"BRYNDEN","target":"RICKARD_KARSTARK","weight":5},{"directed":false,"source":"GENDRY","target":"HOUND","weight":49},{"directed":false,"source":"HOSTER","target":"ROBB","weight":5},{"directed":false,"source":"JOJEN","target":"JON","weight":7},{"directed":false,"source":"JORAH","target":"KRAZNYS_MO_NAKLOZ","weight":5},{"directed":false,"source":"JORAH","target":"ROBERT","weight":5},{"directed":false,"source":"MARGAERY","target":"TYRION","weight":16},{"directed":false,"source":"MARTYN","target":"WILLEM_LANNISTER","weight":5},{"directed":false,"source":"BALON","target":"RAMSAY","weight":4},{"directed":false,"source":"BRAN","target":"ORELL","weight":4},{"directed":false,"source":"CATELYN","target":"ROSLIN","weight":4},{"directed":false,"source":"CERSEI","target":"TARYN_MANT","weight":4},{"directed":false,"source":"EDMURE","target":"FREY_SEPTON","weight":4},{"directed":false,"source":"EDMURE","target":"RICKARD_KARSTARK","weight":4},{"directed":false,"source":"FARMER","target":"ORELL","weight":4},{"directed":false,"source":"GILLY","target":"JOJEN","weight":4},{"directed":false,"source":"GREIZHEN","target":"MISSANDEI","weight":4},{"directed":false,"source":"JOYEUSE","target":"ROBB","weight":4},{"directed":false,"source":"JOYEUSE","target":"TALISA","weight":4},{"directed":false,"source":"LOCKE","target":"TYWIN","weight":4},{"directed":false,"source":"LORD_OF_BONES","target":"MANCE","weight":4},{"directed":false,"source":"LORD_OF_BONES","target":"TORMUND","weight":16},{"directed":false,"source":"LOTHAR","target":"WALDER","weight":13},{"directed":false,"source":"MAREI","target":"TYRION","weight":6},{"directed":false,"source":"MELISANDRE","target":"ROBERT","weight":4},{"directed":false,"source":"QYBURN","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"QYBURN","target":"TALISA","weight":4},{"directed":false,"source":"RAMSAY","target":"YARA","weight":11},{"directed":false,"source":"ROSLIN","target":"TALISA","weight":4},{"directed":false,"source":"SORCERER","target":"VARYS","weight":4},{"directed":false,"source":"TARYN_MANT","target":"TYRION","weight":4},{"directed":false,"source":"ANGUY","target":"MELISANDRE","weight":3},{"directed":false,"source":"BERIC","target":"MOUNTAIN","weight":3},{"directed":false,"source":"BLACK_WALDER","target":"BRYNDEN","weight":8},{"directed":false,"source":"BLACK_WALDER","target":"CATELYN","weight":3},{"directed":false,"source":"BRAN","target":"GILLY","weight":3},{"directed":false,"source":"BRANDON_STARK","target":"JOJEN","weight":3},{"directed":false,"source":"BRIENNE","target":"SELWYN","weight":8},{"directed":false,"source":"BRYNDEN","target":"LOTHAR","weight":7},{"directed":false,"source":"CRASTER","target":"GRENN","weight":7},{"directed":false,"source":"DAENERYS","target":"GREIZHEN","weight":3},{"directed":false,"source":"EDMURE","target":"ROOSE_BOLTON","weight":3},{"directed":false,"source":"FARMER","target":"JOJEN","weight":3},{"directed":false,"source":"GENDRY","target":"ROBERT","weight":14},{"directed":false,"source":"GILLY","target":"HODOR","weight":3},{"directed":false,"source":"GILLY","target":"RANDYLL","weight":11},{"directed":false,"source":"HIGH_SEPTON","target":"JOFFREY","weight":8},{"directed":false,"source":"HIGH_SEPTON","target":"MARGAERY","weight":7},{"directed":false,"source":"HODOR","target":"ORELL","weight":3},{"directed":false,"source":"JAIME","target":"SELWYN","weight":3},{"directed":false,"source":"JOANNA","target":"TYWIN","weight":5},{"directed":false,"source":"JOJEN","target":"NED","weight":3},{"directed":false,"source":"JOJEN","target":"ORELL","weight":3},{"directed":false,"source":"JON","target":"OSHA","weight":3},{"directed":false,"source":"LITTLEFINGER","target":"OLYVAR","weight":5},{"directed":false,"source":"LITTLEFINGER","target":"SHAE","weight":3},{"directed":false,"source":"LOTHAR","target":"ROBB","weight":3},{"directed":false,"source":"MACE","target":"MARGAERY","weight":19},{"directed":false,"source":"MEERA","target":"ORELL","weight":3},{"directed":false,"source":"MERRY","target":"WALDER","weight":3},{"directed":false,"source":"MERYN_TRANT","target":"PODRICK","weight":3},{"directed":false,"source":"MISSANDEI","target":"PRENDAHL","weight":3},{"directed":false,"source":"MISSANDEI","target":"RADZAI_MO_ERAZ","weight":3},{"directed":false,"source":"MOUNTAIN","target":"ROBB","weight":3},{"directed":false,"source":"OLENNA","target":"PODRICK","weight":3},{"directed":false,"source":"OLENNA","target":"ROBERT","weight":3},{"directed":false,"source":"ORELL","target":"OSHA","weight":3},{"directed":false,"source":"ORELL","target":"RICKON","weight":3},{"directed":false,"source":"QYBURN","target":"ROBB","weight":3},{"directed":false,"source":"RAMSAY","target":"ROBB","weight":5},{"directed":false,"source":"RICKARD_KARSTARK","target":"WILLEM_LANNISTER","weight":3},{"directed":false,"source":"ROBERT","target":"THOROS","weight":3},{"directed":false,"source":"ROOSE_BOLTON","target":"STEELSHANKS_WALTON","weight":3},{"directed":false,"source":"ROOSE_BOLTON","target":"THEON","weight":25},{"directed":false,"source":"SORCERER","target":"TYRION","weight":3},{"directed":false,"source":"AEGON","target":"DAVOS","weight":2},{"directed":false,"source":"AEGON","target":"SHIREEN","weight":2},{"directed":false,"source":"AERYS","target":"JOFFREY","weight":2},{"directed":false,"source":"ANGUY","target":"HOT_PIE","weight":2},{"directed":false,"source":"ARYA","target":"ROOSE_BOLTON","weight":2},{"directed":false,"source":"BALERION","target":"DAVOS","weight":2},{"directed":false,"source":"BALON","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"BARRISTAN","target":"KRAZNYS_MO_NAKLOZ","weight":2},{"directed":false,"source":"BARRISTAN","target":"RADZAI_MO_ERAZ","weight":2},{"directed":false,"source":"BERT","target":"SHIREEN","weight":2},{"directed":false,"source":"BLACK_WALDER","target":"JOYEUSE","weight":2},{"directed":false,"source":"BOROS","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"BRAN","target":"FARMER","weight":2},{"directed":false,"source":"BRAN","target":"TORMUND","weight":6},{"directed":false,"source":"BRAN","target":"YGRITTE","weight":2},{"directed":false,"source":"BRONN","target":"HIGH_SEPTON","weight":2},{"directed":false,"source":"BRONN","target":"LORAS","weight":2},{"directed":false,"source":"BRONN","target":"MARGAERY","weight":2},{"directed":false,"source":"BRONN","target":"OLENNA","weight":4},{"directed":false,"source":"BRONN","target":"TARYN_MANT","weight":2},{"directed":false,"source":"BRYNDEN","target":"HOSTER","weight":2},{"directed":false,"source":"BRYNDEN","target":"ROSLIN","weight":2},{"directed":false,"source":"CATELYN","target":"LOTHAR","weight":2},{"directed":false,"source":"CERSEI","target":"HIGH_SEPTON","weight":15},{"directed":false,"source":"DAREON","target":"HOBB","weight":2},{"directed":false,"source":"DAVOS","target":"RYLENE","weight":2},{"directed":false,"source":"DESMOND","target":"ELDRICK","weight":2},{"directed":false,"source":"DESMOND","target":"SANSA","weight":2},{"directed":false,"source":"DESMOND","target":"TYRION","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"KARL_TANNER","weight":2},{"directed":false,"source":"EDMURE","target":"HOUND","weight":2},{"directed":false,"source":"EDMURE","target":"JOYEUSE","weight":2},{"directed":false,"source":"EDMURE","target":"MOUNTAIN","weight":2},{"directed":false,"source":"EDMURE","target":"TYWIN","weight":2},{"directed":false,"source":"FARMER","target":"HODOR","weight":2},{"directed":false,"source":"FARMER","target":"MEERA","weight":2},{"directed":false,"source":"FARMER","target":"OSHA","weight":2},{"directed":false,"source":"FARMER","target":"RICKON","weight":2},{"directed":false,"source":"FREY_SEPTON","target":"ROSLIN","weight":2},{"directed":false,"source":"FREY_SEPTON","target":"WALDER","weight":2},{"directed":false,"source":"GILLY","target":"RAST","weight":2},{"directed":false,"source":"GREIZHEN","target":"JORAH","weight":2},{"directed":false,"source":"GREIZHEN","target":"KRAZNYS_MO_NAKLOZ","weight":2},{"directed":false,"source":"GRENN","target":"KARL_TANNER","weight":2},{"directed":false,"source":"GREY_WORM","target":"MERO","weight":2},{"directed":false,"source":"GREY_WORM","target":"MISSANDEI","weight":183},{"directed":false,"source":"HIGH_SEPTON","target":"LORAS","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"OLENNA","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"PYCELLE","weight":4},{"directed":false,"source":"HIGH_SEPTON","target":"SANSA","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"TYRION","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"TYWIN","weight":2},{"directed":false,"source":"HODOR","target":"JON","weight":2},{"directed":false,"source":"HODOR","target":"TORMUND","weight":2},{"directed":false,"source":"HODOR","target":"YGRITTE","weight":2},{"directed":false,"source":"HOUND","target":"ROOSE_BOLTON","weight":2},{"directed":false,"source":"JAIME","target":"LORAS","weight":18},{"directed":false,"source":"JAIME","target":"PYCELLE","weight":7},{"directed":false,"source":"JOJEN","target":"TORMUND","weight":2},{"directed":false,"source":"JOJEN","target":"YGRITTE","weight":2},{"directed":false,"source":"JON","target":"MEERA","weight":2},{"directed":false,"source":"JON","target":"QHORIN_HALFHAND","weight":2},{"directed":false,"source":"JON","target":"RICKON","weight":11},{"directed":false,"source":"JORAH","target":"PRENDAHL","weight":2},{"directed":false,"source":"JOYEUSE","target":"ROSLIN","weight":2},{"directed":false,"source":"KARL_TANNER","target":"RAST","weight":15},{"directed":false,"source":"KARL_TANNER","target":"SAM","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"PODRICK","weight":10},{"directed":false,"source":"LOCKE","target":"QYBURN","weight":2},{"directed":false,"source":"LOCKE","target":"STEELSHANKS_WALTON","weight":2},{"directed":false,"source":"LORAS","target":"SHAE","weight":2},{"directed":false,"source":"LOTHAR","target":"ROSLIN","weight":2},{"directed":false,"source":"LOTHAR","target":"TALISA","weight":2},{"directed":false,"source":"LYSA","target":"TYWIN","weight":2},{"directed":false,"source":"LYSA","target":"VARYS","weight":2},{"directed":false,"source":"MARGAERY","target":"PYCELLE","weight":4},{"directed":false,"source":"MARTYN","target":"ROBB","weight":2},{"directed":false,"source":"MEERA","target":"TORMUND","weight":2},{"directed":false,"source":"MEERA","target":"YGRITTE","weight":2},{"directed":false,"source":"MELISANDRE","target":"SELYSE","weight":51},{"directed":false,"source":"MOUNTAIN","target":"THOROS","weight":2},{"directed":false,"source":"MYRANDA","target":"RAMSAY","weight":55},{"directed":false,"source":"NED","target":"RICKARD_KARSTARK","weight":2},{"directed":false,"source":"NED","target":"THOROS","weight":2},{"directed":false,"source":"OLENNA","target":"PYCELLE","weight":5},{"directed":false,"source":"OLENNA","target":"RENLY","weight":2},{"directed":false,"source":"OSHA","target":"TORMUND","weight":2},{"directed":false,"source":"OSHA","target":"YGRITTE","weight":2},{"directed":false,"source":"PODRICK","target":"SANSA","weight":35},{"directed":false,"source":"QHORIN_HALFHAND","target":"YGRITTE","weight":2},{"directed":false,"source":"QYBURN","target":"SELWYN","weight":2},{"directed":false,"source":"QYBURN","target":"TYWIN","weight":2},{"directed":false,"source":"RAMSAY","target":"VIOLET","weight":2},{"directed":false,"source":"RENLY","target":"TYWIN","weight":2},{"directed":false,"source":"RICKARD_KARSTARK","target":"ROSLIN","weight":2},{"directed":false,"source":"RICKARD_KARSTARK","target":"WALDER","weight":2},{"directed":false,"source":"RICKON","target":"TORMUND","weight":4},{"directed":false,"source":"RICKON","target":"YGRITTE","weight":2},{"directed":false,"source":"RYLENE","target":"STANNIS","weight":2},{"directed":false,"source":"SALLADHOR","target":"STANNIS","weight":2},{"directed":false,"source":"SELYSE","target":"SHIREEN","weight":27},{"directed":false,"source":"STEELSHANKS_WALTON","target":"TYWIN","weight":2},{"directed":false,"source":"TYRION","target":"WALDER","weight":2},{"directed":false,"source":"TYWIN","target":"WALDER","weight":2},{"directed":false,"source":"LYSA","target":"SANSA","weight":92},{"directed":false,"source":"OBERYN","target":"TYWIN","weight":79},{"directed":false,"source":"BRIENNE","target":"PODRICK","weight":251},{"directed":false,"source":"OBERYN","target":"TYRION","weight":78},{"directed":false,"source":"CERSEI","target":"OBERYN","weight":63},{"directed":false,"source":"LITTLEFINGER","target":"LYSA","weight":58},{"directed":false,"source":"ELLARIA","target":"OBERYN","weight":58},{"directed":false,"source":"ROBIN","target":"SANSA","weight":52},{"directed":false,"source":"TOMMEN","target":"TYWIN","weight":45},{"directed":false,"source":"JANOS","target":"JON","weight":59},{"directed":false,"source":"ARYA","target":"BRIENNE","weight":61},{"directed":false,"source":"OBERYN","target":"VARYS","weight":34},{"directed":false,"source":"STYR","target":"YGRITTE","weight":32},{"directed":false,"source":"LITTLEFINGER","target":"YOHN_ROYCE","weight":60},{"directed":false,"source":"BRONN","target":"JAIME","weight":284},{"directed":false,"source":"HOUND","target":"POLLIVER","weight":29},{"directed":false,"source":"MARGAERY","target":"TOMMEN","weight":144},{"directed":false,"source":"ALLISER_THORNE","target":"JANOS","weight":32},{"directed":false,"source":"DAENERYS","target":"HIZDAHR","weight":93},{"directed":false,"source":"GILLY","target":"MOLES_TOWN_WHORE","weight":24},{"directed":false,"source":"MELISANDRE","target":"SHIREEN","weight":33},{"directed":false,"source":"BRIENNE","target":"HOT_PIE","weight":25},{"directed":false,"source":"BRIENNE","target":"HOUND","weight":47},{"directed":false,"source":"ANYA_WAYNWOOD","target":"LITTLEFINGER","weight":21},{"directed":false,"source":"JON","target":"LOCKE","weight":21},{"directed":false,"source":"MACE","target":"TYWIN","weight":21},{"directed":false,"source":"OBERYN","target":"OLYVAR","weight":21},{"directed":false,"source":"FARMER_HAMLET","target":"HOUND","weight":20},{"directed":false,"source":"GILLY","target":"LITTLE_SAM","weight":61},{"directed":false,"source":"STYR","target":"TORMUND","weight":20},{"directed":false,"source":"CERSEI","target":"QYBURN","weight":173},{"directed":false,"source":"DAVOS","target":"TYCHO","weight":18},{"directed":false,"source":"ELLARIA","target":"OLYVAR","weight":18},{"directed":false,"source":"MORGAN","target":"OBERYN","weight":18},{"directed":false,"source":"MOUNTAIN","target":"OBERYN","weight":22},{"directed":false,"source":"RALF","target":"THEON","weight":18},{"directed":false,"source":"ARYA","target":"TERNESIO_TERYS","weight":17},{"directed":false,"source":"KARL_TANNER","target":"MEERA","weight":17},{"directed":false,"source":"STANNIS","target":"TYCHO","weight":17},{"directed":false,"source":"DAENERYS","target":"FENNESZ","weight":15},{"directed":false,"source":"RAMSAY","target":"TANSY","weight":15},{"directed":false,"source":"SANSA","target":"YOHN_ROYCE","weight":58},{"directed":false,"source":"BRIENNE","target":"CERSEI","weight":18},{"directed":false,"source":"ELIA","target":"OBERYN","weight":14},{"directed":false,"source":"GRENN","target":"LOCKE","weight":14},{"directed":false,"source":"JOJEN","target":"KARL_TANNER","weight":14},{"directed":false,"source":"JON","target":"OLLY","weight":61},{"directed":false,"source":"MACE","target":"OBERYN","weight":14},{"directed":false,"source":"MACE","target":"TYRION","weight":14},{"directed":false,"source":"ARYA","target":"FARMER_HAMLET","weight":13},{"directed":false,"source":"BRAN","target":"LOCKE","weight":13},{"directed":false,"source":"CERSEI","target":"MACE","weight":45},{"directed":false,"source":"CERSEI","target":"MOUNTAIN","weight":75},{"directed":false,"source":"GRENN","target":"JANOS","weight":13},{"directed":false,"source":"JAIME","target":"PODRICK","weight":44},{"directed":false,"source":"JAIME","target":"TOMMEN","weight":54},{"directed":false,"source":"DYING_MAN","target":"HOUND","weight":12},{"directed":false,"source":"JAIME","target":"OBERYN","weight":12},{"directed":false,"source":"JON","target":"STANNIS","weight":106},{"directed":false,"source":"MANCE","target":"STANNIS","weight":26},{"directed":false,"source":"PYCELLE","target":"QYBURN","weight":35},{"directed":false,"source":"ANYA_WAYNWOOD","target":"SANSA","weight":11},{"directed":false,"source":"DONTOS","target":"LITTLEFINGER","weight":11},{"directed":false,"source":"ELLARIA","target":"TYRION","weight":18},{"directed":false,"source":"FARMER_HAMLET","target":"SALLY","weight":11},{"directed":false,"source":"JAIME","target":"MARGAERY","weight":19},{"directed":false,"source":"JON","target":"KARL_TANNER","weight":11},{"directed":false,"source":"ANYA_WAYNWOOD","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"ARYA","target":"DYING_MAN","weight":10},{"directed":false,"source":"KARL_TANNER","target":"SISSY","weight":10},{"directed":false,"source":"MORGAN","target":"MORGANS_FRIEND","weight":10},{"directed":false,"source":"OLLY","target":"STYR","weight":10},{"directed":false,"source":"BRAN","target":"THREE_EYED_RAVEN","weight":85},{"directed":false,"source":"ELLARIA","target":"MAREI","weight":9},{"directed":false,"source":"ELLARIA","target":"TYWIN","weight":9},{"directed":false,"source":"JANOS","target":"SAM","weight":17},{"directed":false,"source":"JOFFREY","target":"MACE","weight":9},{"directed":false,"source":"BALON_DWARF","target":"ROBB_DWARF","weight":8},{"directed":false,"source":"BRONN","target":"OBERYN","weight":8},{"directed":false,"source":"DONNEL_HILL","target":"GRENN","weight":8},{"directed":false,"source":"EDDISON_TOLLETT","target":"JANOS","weight":11},{"directed":false,"source":"ELLARIA","target":"MORGAN","weight":8},{"directed":false,"source":"JAIME","target":"MACE","weight":16},{"directed":false,"source":"JOFFREY","target":"OBERYN","weight":8},{"directed":false,"source":"JON","target":"MORAG","weight":8},{"directed":false,"source":"MACE","target":"VARYS","weight":8},{"directed":false,"source":"MORGANS_FRIEND","target":"OBERYN","weight":8},{"directed":false,"source":"ALLISER_THORNE","target":"LOCKE","weight":7},{"directed":false,"source":"BOLTON_GUARD","target":"YARA","weight":7},{"directed":false,"source":"BRAN","target":"KARL_TANNER","weight":7},{"directed":false,"source":"BRAN","target":"LEAF","weight":26},{"directed":false,"source":"CERSEI","target":"ELLARIA","weight":30},{"directed":false,"source":"DAENERYS","target":"MEEREEN_CHAMPION","weight":7},{"directed":false,"source":"DAVOS","target":"JON","weight":261},{"directed":false,"source":"DONGO_THE_GIANT","target":"MAG_THE_MIGHTY","weight":7},{"directed":false,"source":"DORNISH_LORD","target":"TYRION","weight":7},{"directed":false,"source":"EDDISON_TOLLETT","target":"PYP","weight":9},{"directed":false,"source":"ENDREW","target":"JAIME","weight":7},{"directed":false,"source":"GILLY","target":"PYP","weight":7},{"directed":false,"source":"GRENN","target":"MAG_THE_MIGHTY","weight":7},{"directed":false,"source":"GUYMON","target":"OLLY","weight":7},{"directed":false,"source":"HIZDAHR","target":"HIZDAHRS_FATHER","weight":7},{"directed":false,"source":"HODOR","target":"LOCKE","weight":7},{"directed":false,"source":"JON","target":"SISSY","weight":7},{"directed":false,"source":"MACE","target":"TOMMEN","weight":9},{"directed":false,"source":"MAREI","target":"OBERYN","weight":7},{"directed":false,"source":"MOLES_TOWN_MADAM","target":"SAM","weight":7},{"directed":false,"source":"OBERYN","target":"PYCELLE","weight":7},{"directed":false,"source":"OBERYN","target":"SHAE","weight":7},{"directed":false,"source":"OLLY","target":"SAM","weight":37},{"directed":false,"source":"OLLY","target":"YGRITTE","weight":7},{"directed":false,"source":"RENLY_DWARF","target":"STANNIS_DWARF","weight":7},{"directed":false,"source":"ARYA","target":"SALLY","weight":6},{"directed":false,"source":"BRIENNE","target":"JOFFREY","weight":6},{"directed":false,"source":"BRIENNE","target":"SANSA","weight":120},{"directed":false,"source":"CERSEI","target":"DONTOS","weight":6},{"directed":false,"source":"DAVOS","target":"MANCE","weight":6},{"directed":false,"source":"DAVOS","target":"SELYSE","weight":15},{"directed":false,"source":"ELDER_MEEREEN_SLAVE","target":"MOSSADOR","weight":6},{"directed":false,"source":"FIRST_MATE","target":"YARA","weight":6},{"directed":false,"source":"GOATHERD","target":"MISSANDEI","weight":6},{"directed":false,"source":"GRENN","target":"OLLY","weight":6},{"directed":false,"source":"HOUND","target":"LYSA","weight":6},{"directed":false,"source":"HOUND","target":"RORGE","weight":6},{"directed":false,"source":"HOUND","target":"SALLY","weight":6},{"directed":false,"source":"JAIME","target":"VARYS","weight":16},{"directed":false,"source":"JOFFREY_DWARF","target":"ROBB_DWARF","weight":6},{"directed":false,"source":"JON","target":"STYR","weight":6},{"directed":false,"source":"MAREI","target":"OLYVAR","weight":6},{"directed":false,"source":"MEERA","target":"THREE_EYED_RAVEN","weight":17},{"directed":false,"source":"MORGAN","target":"OLYVAR","weight":6},{"directed":false,"source":"MOUNTAIN","target":"PYCELLE","weight":6},{"directed":false,"source":"MOUNTAIN","target":"QYBURN","weight":32},{"directed":false,"source":"MYRANDA","target":"TANSY","weight":6},{"directed":false,"source":"OBERYN","target":"TOMMEN","weight":6},{"directed":false,"source":"ORSON","target":"TYRION","weight":6},{"directed":false,"source":"SAM","target":"TORMUND","weight":36},{"directed":false,"source":"TANSY","target":"THEON","weight":6},{"directed":false,"source":"ALLISER_THORNE","target":"EDDISON_TOLLETT","weight":20},{"directed":false,"source":"ALLISER_THORNE","target":"TORMUND","weight":18},{"directed":false,"source":"BRIENNE","target":"OLENNA","weight":5},{"directed":false,"source":"BRIENNE","target":"TYRION","weight":55},{"directed":false,"source":"DAENERYS","target":"GOATHERD","weight":5},{"directed":false,"source":"DONTOS","target":"TYRION","weight":5},{"directed":false,"source":"EDDISON_TOLLETT","target":"LOCKE","weight":5},{"directed":false,"source":"EDDISON_TOLLETT","target":"MORAG","weight":5},{"directed":false,"source":"ENDREW","target":"JOFFREY","weight":5},{"directed":false,"source":"FENNESZ","target":"MASTER_MIGHDAL","weight":5},{"directed":false,"source":"FIRST_MATE","target":"THEON","weight":5},{"directed":false,"source":"GRENN","target":"MORAG","weight":5},{"directed":false,"source":"HIGH_SEPTON","target":"TOMMEN","weight":5},{"directed":false,"source":"HIZDAHR","target":"MANSERVANT","weight":5},{"directed":false,"source":"HOT_PIE","target":"PODRICK","weight":5},{"directed":false,"source":"JAIME","target":"SHAE","weight":5},{"directed":false,"source":"JANOS","target":"OLLY","weight":8},{"directed":false,"source":"JOFFREY","target":"POLLIVER","weight":5},{"directed":false,"source":"LHARA","target":"SALLADHOR","weight":5},{"directed":false,"source":"LUTHOR","target":"OLENNA","weight":5},{"directed":false,"source":"MACE","target":"PYCELLE","weight":15},{"directed":false,"source":"MACE","target":"SANSA","weight":5},{"directed":false,"source":"MACE","target":"SHAE","weight":5},{"directed":false,"source":"MARGAERY","target":"OBERYN","weight":5},{"directed":false,"source":"MOUNTAIN","target":"TYRION","weight":18},{"directed":false,"source":"OBERYN","target":"PODRICK","weight":5},{"directed":false,"source":"RAMSAY","target":"WALDA","weight":34},{"directed":false,"source":"ROOSE_BOLTON","target":"WALDA","weight":14},{"directed":false,"source":"ADRACK_HUMBLE","target":"THEON","weight":4},{"directed":false,"source":"AXELL_FLORENT","target":"MELISANDRE","weight":4},{"directed":false,"source":"AXELL_FLORENT","target":"SELYSE","weight":4},{"directed":false,"source":"BALON_DWARF","target":"JOFFREY_DWARF","weight":4},{"directed":false,"source":"BALON_DWARF","target":"STANNIS_DWARF","weight":4},{"directed":false,"source":"BLACK_JACK","target":"KEGS","weight":4},{"directed":false,"source":"BLACK_JACK","target":"MULLY","weight":4},{"directed":false,"source":"BRAN","target":"CRASTER","weight":4},{"directed":false,"source":"BRAN","target":"RAST","weight":4},{"directed":false,"source":"BRONN","target":"MORGAN","weight":4},{"directed":false,"source":"COOPER","target":"GRENN","weight":4},{"directed":false,"source":"CRASTER","target":"LOCKE","weight":4},{"directed":false,"source":"CRASTER","target":"MORAG","weight":4},{"directed":false,"source":"CRASTER","target":"SISSY","weight":4},{"directed":false,"source":"CRASTERS_BABY","target":"RAST","weight":4},{"directed":false,"source":"CRASTERS_BABY","target":"SISSY","weight":4},{"directed":false,"source":"DAARIO","target":"MEEREEN_CHAMPION","weight":4},{"directed":false,"source":"DAENERYS","target":"HIZDAHRS_FATHER","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"SISSY","weight":4},{"directed":false,"source":"ELDER_MEEREEN_SLAVE","target":"GREY_WORM","weight":4},{"directed":false,"source":"ELDER_MEEREEN_SLAVE","target":"MEEREEN_SLAVE","weight":4},{"directed":false,"source":"ELIA","target":"MOUNTAIN","weight":4},{"directed":false,"source":"ELIA","target":"TYWIN","weight":4},{"directed":false,"source":"ELLARIA","target":"JAIME","weight":25},{"directed":false,"source":"ELLARIA","target":"MOUNTAIN","weight":10},{"directed":false,"source":"ELLARIA","target":"PODRICK","weight":4},{"directed":false,"source":"GILLY","target":"JANOS","weight":7},{"directed":false,"source":"GILLY","target":"STYR","weight":4},{"directed":false,"source":"GILLY","target":"YGRITTE","weight":4},{"directed":false,"source":"GRENN","target":"SISSY","weight":4},{"directed":false,"source":"HIGH_SEPTON","target":"JAIME","weight":4},{"directed":false,"source":"JANOS","target":"MAESTER_AEMON","weight":4},{"directed":false,"source":"JOFFREY","target":"JOFFREY_DWARF","weight":4},{"directed":false,"source":"JON","target":"MAG_THE_MIGHTY","weight":4},{"directed":false,"source":"KEGS","target":"MULLY","weight":4},{"directed":false,"source":"LEAF","target":"MEERA","weight":17},{"directed":false,"source":"LITTLE_SAM","target":"MOLES_TOWN_WHORE","weight":4},{"directed":false,"source":"LOCKE","target":"RAMSAY","weight":4},{"directed":false,"source":"LORAS","target":"OBERYN","weight":4},{"directed":false,"source":"LYSA","target":"NED","weight":4},{"directed":false,"source":"LYSA","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"MERYN_TRANT","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"MERYN_TRANT","target":"TYWIN","weight":4},{"directed":false,"source":"MORAG","target":"SISSY","weight":4},{"directed":false,"source":"MORGAN","target":"TYRION","weight":4},{"directed":false,"source":"MYRANDA","target":"YARA","weight":4},{"directed":false,"source":"OBERYN","target":"SANSA","weight":4},{"directed":false,"source":"OLLY","target":"OLLYS_MOTHER","weight":4},{"directed":false,"source":"PYCELLE","target":"TOMMEN","weight":14},{"directed":false,"source":"SAM","target":"STYR","weight":4},{"directed":false,"source":"SAM","target":"YGRITTE","weight":4},{"directed":false,"source":"STYR","target":"THENN_WARG","weight":4},{"directed":false,"source":"AERYS","target":"TYRION","weight":10},{"directed":false,"source":"ALLISER_THORNE","target":"OLLY","weight":18},{"directed":false,"source":"ALLISER_THORNE","target":"QHORIN","weight":3},{"directed":false,"source":"ANYA_WAYNWOOD","target":"LYSA","weight":3},{"directed":false,"source":"ARYA","target":"PODRICK","weight":10},{"directed":false,"source":"BAELOR","target":"TYWIN","weight":3},{"directed":false,"source":"BALON_DWARF","target":"RENLY_DWARF","weight":3},{"directed":false,"source":"BOLTON_GUARD","target":"FIRST_MATE","weight":3},{"directed":false,"source":"BRAN","target":"CRASTERS_BABY","weight":3},{"directed":false,"source":"BRAN","target":"RAMSAY","weight":3},{"directed":false,"source":"BRONN","target":"ELLARIA","weight":3},{"directed":false,"source":"BRONN","target":"LOLLYS","weight":17},{"directed":false,"source":"BRONN","target":"MOUNTAIN","weight":3},{"directed":false,"source":"COOPER","target":"DONNEL_HILL","weight":3},{"directed":false,"source":"CRASTER","target":"JOJEN","weight":3},{"directed":false,"source":"CRASTER","target":"MEERA","weight":3},{"directed":false,"source":"CRASTERS_BABY","target":"MEERA","weight":3},{"directed":false,"source":"DAENERYS","target":"MANSERVANT","weight":3},{"directed":false,"source":"DONNEL_WAYNWOOD","target":"HOUND","weight":3},{"directed":false,"source":"DORAN","target":"TYRION","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"OLLY","weight":13},{"directed":false,"source":"ELLARIA","target":"JOFFREY","weight":3},{"directed":false,"source":"ELLARIA","target":"LORAS","weight":3},{"directed":false,"source":"GILLY","target":"TORMUND","weight":8},{"directed":false,"source":"GUYMON","target":"OLLYS_MOTHER","weight":3},{"directed":false,"source":"HODOR","target":"LEAF","weight":12},{"directed":false,"source":"HODOR","target":"RAST","weight":3},{"directed":false,"source":"HOSTER","target":"LYSA","weight":3},{"directed":false,"source":"HOUND","target":"INNKEEPER","weight":3},{"directed":false,"source":"HOUND","target":"SYRIO_FOREL","weight":3},{"directed":false,"source":"INNKEEPER","target":"POLLIVER","weight":3},{"directed":false,"source":"JAIME","target":"MERYN_TRANT","weight":3},{"directed":false,"source":"JAIME","target":"OLENNA","weight":50},{"directed":false,"source":"JOFFREY","target":"MOUNTAIN","weight":3},{"directed":false,"source":"JOFFREY","target":"ROBB_DWARF","weight":3},{"directed":false,"source":"JOFFREY_DWARF","target":"SANSA","weight":3},{"directed":false,"source":"JOFFREY_DWARF","target":"STANNIS_DWARF","weight":3},{"directed":false,"source":"JOJEN","target":"LEAF","weight":3},{"directed":false,"source":"JOJEN","target":"THREE_EYED_RAVEN","weight":3},{"directed":false,"source":"MAG_THE_MIGHTY","target":"MANCE","weight":3},{"directed":false,"source":"MAG_THE_MIGHTY","target":"SAM","weight":3},{"directed":false,"source":"MEEREEN_SLAVE","target":"MOSSADOR","weight":3},{"directed":false,"source":"MOLES_TOWN_MADAM","target":"MOLES_TOWN_WHORE","weight":3},{"directed":false,"source":"OLENNA","target":"TOMMEN","weight":6},{"directed":false,"source":"OLLY","target":"PYP","weight":3},{"directed":false,"source":"OLLY","target":"TORMUND","weight":8},{"directed":false,"source":"PODRICK","target":"TYWIN","weight":3},{"directed":false,"source":"PYP","target":"TORMUND","weight":3},{"directed":false,"source":"STANNIS","target":"TOMMEN","weight":3},{"directed":false,"source":"THENN_WARG","target":"TORMUND","weight":3},{"directed":false,"source":"THENN_WARG","target":"YGRITTE","weight":3},{"directed":false,"source":"VANCE_CORBRAY","target":"YOHN_ROYCE","weight":3},{"directed":false,"source":"ADRACK_HUMBLE","target":"RALF","weight":2},{"directed":false,"source":"AERYS","target":"CERSEI","weight":7},{"directed":false,"source":"ALLISER_THORNE","target":"CRASTER","weight":2},{"directed":false,"source":"ALLISER_THORNE","target":"YGRITTE","weight":2},{"directed":false,"source":"ANYA_WAYNWOOD","target":"ROBIN","weight":2},{"directed":false,"source":"ANYA_WAYNWOOD","target":"VANCE_CORBRAY","weight":2},{"directed":false,"source":"ARYA","target":"DONNEL_WAYNWOOD","weight":2},{"directed":false,"source":"ARYA","target":"INNKEEPER","weight":2},{"directed":false,"source":"ARYA","target":"INNKEEPERS_DAUGHTER","weight":2},{"directed":false,"source":"ARYA","target":"LYSA","weight":2},{"directed":false,"source":"ARYA","target":"TOMMY","weight":2},{"directed":false,"source":"AXELL_FLORENT","target":"DAVOS","weight":2},{"directed":false,"source":"AXELL_FLORENT","target":"STANNIS","weight":2},{"directed":false,"source":"BAELOR","target":"HIGH_SEPTON","weight":2},{"directed":false,"source":"BAELOR","target":"TYRION","weight":2},{"directed":false,"source":"BALON_DWARF","target":"JOFFREY","weight":2},{"directed":false,"source":"BARRISTAN","target":"GOATHERD","weight":2},{"directed":false,"source":"BITER","target":"HOUND","weight":2},{"directed":false,"source":"BOROS","target":"JAIME","weight":2},{"directed":false,"source":"BRIENNE","target":"BRONN","weight":12},{"directed":false,"source":"BRIENNE","target":"NED","weight":2},{"directed":false,"source":"BRONN","target":"FALYSE","weight":4},{"directed":false,"source":"BRONN","target":"MORGANS_FRIEND","weight":2},{"directed":false,"source":"CERSEI","target":"ELIA","weight":2},{"directed":false,"source":"CERSEI","target":"FOOL","weight":2},{"directed":false,"source":"CERSEI","target":"JOFFREY_DWARF","weight":2},{"directed":false,"source":"CERSEI","target":"ROBB_DWARF","weight":2},{"directed":false,"source":"CRASTER","target":"CRASTERS_BABY","weight":2},{"directed":false,"source":"CRASTER","target":"HODOR","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"HODOR","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"JOJEN","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"KARL_TANNER","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"NIGHT_KING","weight":2},{"directed":false,"source":"CRASTERS_BABY","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"DAENERYS","target":"MASTER_MIGHDAL","weight":2},{"directed":false,"source":"DAENERYS","target":"RHAEGAR","weight":2},{"directed":false,"source":"DAVOS","target":"EDDISON_TOLLETT","weight":34},{"directed":false,"source":"DAVOS","target":"GRENN","weight":2},{"directed":false,"source":"DAVOS","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"DAVOS","target":"SAM","weight":18},{"directed":false,"source":"DONGO_THE_GIANT","target":"JON","weight":2},{"directed":false,"source":"DONNEL_HILL","target":"MAG_THE_MIGHTY","weight":2},{"directed":false,"source":"DORAN","target":"OBERYN","weight":10},{"directed":false,"source":"DORNISH_LORD","target":"OBERYN","weight":2},{"directed":false,"source":"DROGO","target":"RHAEGAR","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"MELISANDRE","weight":13},{"directed":false,"source":"EDDISON_TOLLETT","target":"SELYSE","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"SHIREEN","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"STANNIS","weight":6},{"directed":false,"source":"ELLARIA","target":"MACE","weight":2},{"directed":false,"source":"ELLARIA","target":"MARGAERY","weight":2},{"directed":false,"source":"ELLARIA","target":"MORGANS_FRIEND","weight":2},{"directed":false,"source":"ELLARIA","target":"SANSA","weight":2},{"directed":false,"source":"ELLARIA","target":"VARYS","weight":5},{"directed":false,"source":"FENNESZ","target":"MISSANDEI","weight":2},{"directed":false,"source":"FOOL","target":"JOFFREY","weight":2},{"directed":false,"source":"FOOL","target":"TYWIN","weight":2},{"directed":false,"source":"GILLY","target":"MOLES_TOWN_MADAM","weight":2},{"directed":false,"source":"GOATHERD","target":"GOATHERDS_SON","weight":2},{"directed":false,"source":"GOATHERD","target":"GREY_WORM","weight":2},{"directed":false,"source":"GOATHERD","target":"JORAH","weight":2},{"directed":false,"source":"GRENN","target":"MAESTER_AEMON","weight":2},{"directed":false,"source":"GRENN","target":"MELISANDRE","weight":2},{"directed":false,"source":"GRENN","target":"SELYSE","weight":2},{"directed":false,"source":"GRENN","target":"SHIREEN","weight":2},{"directed":false,"source":"GRENN","target":"STANNIS","weight":2},{"directed":false,"source":"GRENN","target":"YGRITTE","weight":2},{"directed":false,"source":"GREY_WORM","target":"MOSSADOR","weight":5},{"directed":false,"source":"GUYMON","target":"STYR","weight":2},{"directed":false,"source":"GUYMON","target":"YGRITTE","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"MACE","weight":7},{"directed":false,"source":"HIZDAHR","target":"JORAH","weight":6},{"directed":false,"source":"HODOR","target":"NED","weight":5},{"directed":false,"source":"HODOR","target":"THREE_EYED_RAVEN","weight":17},{"directed":false,"source":"HOSTER","target":"JON_ARRYN","weight":2},{"directed":false,"source":"HOSTER","target":"LITTLEFINGER","weight":2},{"directed":false,"source":"HOUND","target":"INNKEEPERS_DAUGHTER","weight":2},{"directed":false,"source":"HOUND","target":"LOMMY","weight":2},{"directed":false,"source":"HOUND","target":"TOMMY","weight":2},{"directed":false,"source":"HOUND","target":"VARYS","weight":5},{"directed":false,"source":"INNKEEPER","target":"TOMMY","weight":2},{"directed":false,"source":"JAIME","target":"JOANNA","weight":2},{"directed":false,"source":"JANOS","target":"LITTLE_SAM","weight":2},{"directed":false,"source":"JANOS","target":"LOCKE","weight":2},{"directed":false,"source":"JANOS","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"JANOS","target":"PYP","weight":2},{"directed":false,"source":"JOFFREY","target":"LYSA","weight":2},{"directed":false,"source":"JOFFREY","target":"RENLY_DWARF","weight":2},{"directed":false,"source":"JOFFREY","target":"STANNIS_DWARF","weight":2},{"directed":false,"source":"JOFFREY_DWARF","target":"MARGAERY","weight":2},{"directed":false,"source":"JOFFREY_DWARF","target":"RENLY_DWARF","weight":2},{"directed":false,"source":"JOFFREY_DWARF","target":"TYRION","weight":2},{"directed":false,"source":"JOJEN","target":"LOCKE","weight":2},{"directed":false,"source":"JOJEN","target":"RAST","weight":2},{"directed":false,"source":"JON","target":"MELISANDRE","weight":99},{"directed":false,"source":"JON","target":"SELYSE","weight":8},{"directed":false,"source":"JON","target":"SHIREEN","weight":4},{"directed":false,"source":"JORAH","target":"MEEREEN_CHAMPION","weight":2},{"directed":false,"source":"LEAF","target":"THREE_EYED_RAVEN","weight":10},{"directed":false,"source":"LITTLE_SAM","target":"MOLES_TOWN_MADAM","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"PYP","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"VANCE_CORBRAY","weight":2},{"directed":false,"source":"LOCKE","target":"MEERA","weight":2},{"directed":false,"source":"LOCKE","target":"MORAG","weight":2},{"directed":false,"source":"LOCKE","target":"RAST","weight":2},{"directed":false,"source":"LOCKE","target":"SAM","weight":2},{"directed":false,"source":"LOCKE","target":"SISSY","weight":2},{"directed":false,"source":"LOLLYS","target":"TYRION","weight":2},{"directed":false,"source":"LORAS","target":"RENLY_DWARF","weight":2},{"directed":false,"source":"LORAS","target":"STANNIS_DWARF","weight":2},{"directed":false,"source":"LUTHOR","target":"VIOLA","weight":2},{"directed":false,"source":"MACE","target":"MOUNTAIN","weight":2},{"directed":false,"source":"MACE","target":"PODRICK","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"MELISANDRE","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"OLLY","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"SELYSE","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"SHIREEN","weight":2},{"directed":false,"source":"MAESTER_AEMON","target":"STANNIS","weight":2},{"directed":false,"source":"MAREI","target":"MORGAN","weight":2},{"directed":false,"source":"MAREI","target":"SHAE","weight":2},{"directed":false,"source":"MARGAERY","target":"ROBB_DWARF","weight":2},{"directed":false,"source":"MEERA","target":"NED","weight":4},{"directed":false,"source":"MEERA","target":"RAST","weight":2},{"directed":false,"source":"MELISANDRE","target":"SAM","weight":7},{"directed":false,"source":"MERYN_TRANT","target":"THEON","weight":2},{"directed":false,"source":"MISSANDEI","target":"ZALA","weight":2},{"directed":false,"source":"MOLES_TOWN_WHORE","target":"SAM","weight":2},{"directed":false,"source":"MORGANS_FRIEND","target":"TYRION","weight":2},{"directed":false,"source":"MOUNTAIN","target":"SHAE","weight":2},{"directed":false,"source":"MUSICIAN","target":"OLENNA","weight":2},{"directed":false,"source":"MYRCELLA","target":"OBERYN","weight":4},{"directed":false,"source":"NED","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"NIGHT_KING","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"OLENNA","target":"VIOLA","weight":2},{"directed":false,"source":"OLLYS_MOTHER","target":"STYR","weight":2},{"directed":false,"source":"OLLYS_MOTHER","target":"TORMUND","weight":2},{"directed":false,"source":"OLLYS_MOTHER","target":"YGRITTE","weight":2},{"directed":false,"source":"ORYS","target":"ORYS_BROTHER","weight":2},{"directed":false,"source":"ORYS","target":"TYWIN","weight":2},{"directed":false,"source":"ORYS_BROTHER","target":"TYWIN","weight":2},{"directed":false,"source":"POLLIVER","target":"TOMMY","weight":2},{"directed":false,"source":"RALF","target":"ROOSE_BOLTON","weight":2},{"directed":false,"source":"RAMSAY","target":"RICKON","weight":15},{"directed":false,"source":"RENLY_DWARF","target":"ROBB_DWARF","weight":2},{"directed":false,"source":"ROBB_DWARF","target":"SANSA","weight":2},{"directed":false,"source":"ROBB_DWARF","target":"TYRION","weight":2},{"directed":false,"source":"SAM","target":"SELYSE","weight":7},{"directed":false,"source":"SAM","target":"SHIREEN","weight":6},{"directed":false,"source":"SAM","target":"STANNIS","weight":28},{"directed":false,"source":"SANSA","target":"VANCE_CORBRAY","weight":2},{"directed":false,"source":"SANSA","target":"WAYMAR_ROYCE","weight":2},{"directed":false,"source":"TOMMEN","target":"TYCHO","weight":2},{"directed":false,"source":"TOMMEN","target":"VARYS","weight":2},{"directed":false,"source":"TYCHO","target":"TYWIN","weight":5},{"directed":false,"source":"JORAH","target":"TYRION","weight":168},{"directed":false,"source":"DAENERYS","target":"TYRION","weight":468},{"directed":false,"source":"CERSEI","target":"HIGH_SPARROW","weight":111},{"directed":false,"source":"SANSA","target":"THEON","weight":117},{"directed":false,"source":"JAIME","target":"MYRCELLA","weight":62},{"directed":false,"source":"MYRANDA","target":"SANSA","weight":58},{"directed":false,"source":"RAMSAY","target":"SANSA","weight":91},{"directed":false,"source":"ARYA","target":"WAIF","weight":96},{"directed":false,"source":"BRONN","target":"TYENE","weight":34},{"directed":false,"source":"DORAN","target":"ELLARIA","weight":41},{"directed":false,"source":"JAQEN","target":"WAIF","weight":52},{"directed":false,"source":"HIGH_SPARROW","target":"OLENNA","weight":34},{"directed":false,"source":"DAENERYS","target":"MOSSADOR","weight":28},{"directed":false,"source":"JON","target":"KARSI","weight":28},{"directed":false,"source":"AREO","target":"DORAN","weight":30},{"directed":false,"source":"DAARIO","target":"TYRION","weight":27},{"directed":false,"source":"DAARIO","target":"HIZDAHR","weight":24},{"directed":false,"source":"DORAN","target":"JAIME","weight":24},{"directed":false,"source":"LITTLEFINGER","target":"ROOSE_BOLTON","weight":22},{"directed":false,"source":"CERSEI","target":"KEVAN","weight":39},{"directed":false,"source":"HIGH_SPARROW","target":"LORAS","weight":43},{"directed":false,"source":"CERSEI","target":"MAGGY","weight":20},{"directed":false,"source":"AREO","target":"BRONN","weight":19},{"directed":false,"source":"KARSI","target":"TORMUND","weight":19},{"directed":false,"source":"TYCHO","target":"MACE","weight":19},{"directed":false,"source":"AREO","target":"JAIME","weight":18},{"directed":false,"source":"GILLY","target":"SHIREEN","weight":18},{"directed":false,"source":"BLACK_HAIRED_PROSTITUTE","target":"TYRION","weight":17},{"directed":false,"source":"HIGH_SPARROW","target":"MARGAERY","weight":93},{"directed":false,"source":"MALKO","target":"TYRION","weight":17},{"directed":false,"source":"JAIME","target":"TRYSTANE","weight":16},{"directed":false,"source":"JON","target":"LOBODA","weight":16},{"directed":false,"source":"LITTLEFINGER","target":"OLENNA","weight":16},{"directed":false,"source":"MISSANDEI","target":"TYRION","weight":156},{"directed":false,"source":"ROOSE_BOLTON","target":"SANSA","weight":23},{"directed":false,"source":"AREO","target":"ELLARIA","weight":18},{"directed":false,"source":"AREO","target":"MYRCELLA","weight":15},{"directed":false,"source":"CERSEI","target":"SEPTA_UNELLA","weight":26},{"directed":false,"source":"LANCEL","target":"LITTLEFINGER","weight":14},{"directed":false,"source":"LITTLEFINGER","target":"RAMSAY","weight":18},{"directed":false,"source":"NYMERIA","target":"TYENE","weight":20},{"directed":false,"source":"ARYA","target":"THIN_MAN","weight":13},{"directed":false,"source":"HIZDAHR","target":"TYRION","weight":13},{"directed":false,"source":"BRONN","target":"DORNISH_RIDER","weight":12},{"directed":false,"source":"CERSEI","target":"MELARA","weight":12},{"directed":false,"source":"JORAH","target":"MALKO","weight":12},{"directed":false,"source":"BRAND","target":"DERRYK","weight":11},{"directed":false,"source":"ELLARIA","target":"OBARA","weight":17},{"directed":false,"source":"ELLARIA","target":"TYENE","weight":37},{"directed":false,"source":"HIGH_SEPTON","target":"OLYVAR","weight":11},{"directed":false,"source":"JAQEN","target":"THIN_MAN","weight":11},{"directed":false,"source":"DAVOS","target":"OLLY","weight":14},{"directed":false,"source":"ELLARIA","target":"MYRCELLA","weight":10},{"directed":false,"source":"OLLY","target":"STANNIS","weight":10},{"directed":false,"source":"BRONN","target":"MYRCELLA","weight":9},{"directed":false,"source":"DORAN","target":"MYRCELLA","weight":9},{"directed":false,"source":"DORAN","target":"TRYSTANE","weight":9},{"directed":false,"source":"HIGH_SPARROW","target":"OLYVAR","weight":9},{"directed":false,"source":"LITTLEFINGER","target":"ROYCE","weight":9},{"directed":false,"source":"MACE","target":"QYBURN","weight":9},{"directed":false,"source":"AREO","target":"TRYSTANE","weight":8},{"directed":false,"source":"HIGH_SPARROW","target":"TOMMEN","weight":57},{"directed":false,"source":"HIZDAHR","target":"MISSANDEI","weight":8},{"directed":false,"source":"KARSI","target":"LOBODA","weight":8},{"directed":false,"source":"LANCEL","target":"LORAS","weight":13},{"directed":false,"source":"SANSA","target":"WALDA","weight":8},{"directed":false,"source":"AREO","target":"OBARA","weight":7},{"directed":false,"source":"BRONN","target":"OBARA","weight":7},{"directed":false,"source":"DERRYK","target":"SAM","weight":7},{"directed":false,"source":"GILLY","target":"OLLY","weight":7},{"directed":false,"source":"HIZDAHR","target":"MOSSADOR","weight":7},{"directed":false,"source":"MACE","target":"MERYN_TRANT","weight":9},{"directed":false,"source":"MARGAERY","target":"OLYVAR","weight":7},{"directed":false,"source":"OWNER","target":"TYRION","weight":7},{"directed":false,"source":"RAMSAY","target":"STANNIS","weight":7},{"directed":false,"source":"BRAND","target":"SAM","weight":6},{"directed":false,"source":"BRONN","target":"DORAN","weight":6},{"directed":false,"source":"BRONN","target":"TRYSTANE","weight":6},{"directed":false,"source":"DAARIO","target":"MOSSADOR","weight":6},{"directed":false,"source":"GILLY","target":"SELYSE","weight":6},{"directed":false,"source":"HIGH_SEPTON","target":"LANCEL","weight":6},{"directed":false,"source":"HIGH_SEPTON","target":"QYBURN","weight":6},{"directed":false,"source":"MADAME","target":"MERYN_TRANT","weight":6},{"directed":false,"source":"MYRANDA","target":"WALDA","weight":6},{"directed":false,"source":"MYRCELLA","target":"OBARA","weight":6},{"directed":false,"source":"NYMERIA","target":"OBARA","weight":24},{"directed":false,"source":"OBARA","target":"TYENE","weight":15},{"directed":false,"source":"ALLISER_THORNE","target":"STANNIS","weight":5},{"directed":false,"source":"BRONN","target":"NYMERIA","weight":5},{"directed":false,"source":"DAENERYS","target":"OWNER","weight":5},{"directed":false,"source":"DERRYK","target":"GILLY","weight":5},{"directed":false,"source":"ELLARIA","target":"NYMERIA","weight":9},{"directed":false,"source":"KEVAN","target":"TOMMEN","weight":12},{"directed":false,"source":"PODRICK","target":"STANNIS","weight":5},{"directed":false,"source":"ALLISER_THORNE","target":"DAVOS","weight":26},{"directed":false,"source":"AREO","target":"NYMERIA","weight":4},{"directed":false,"source":"AREO","target":"TYENE","weight":7},{"directed":false,"source":"ARYA","target":"MACE","weight":4},{"directed":false,"source":"BARRISTAN","target":"MOSSADOR","weight":4},{"directed":false,"source":"CERSEI","target":"OLYVAR","weight":4},{"directed":false,"source":"CERSEI","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"DORNISH_RIDER","target":"JAIME","weight":4},{"directed":false,"source":"ELLARIA","target":"TRYSTANE","weight":4},{"directed":false,"source":"GILLY","target":"STANNIS","weight":4},{"directed":false,"source":"HIGH_SEPTON","target":"HIGH_SPARROW","weight":4},{"directed":false,"source":"HIGH_SPARROW","target":"RENLY","weight":4},{"directed":false,"source":"HIGH_SPARROW","target":"ROBERT","weight":4},{"directed":false,"source":"JAIME","target":"TYENE","weight":6},{"directed":false,"source":"JON","target":"NIGHT_KING","weight":40},{"directed":false,"source":"JORAH","target":"OWNER","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"THEON","weight":4},{"directed":false,"source":"LOBODA","target":"TORMUND","weight":4},{"directed":false,"source":"MERYN_TRANT","target":"QYBURN","weight":4},{"directed":false,"source":"MYRANDA","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"QUICK","target":"STRONG","weight":4},{"directed":false,"source":"ROOSE_BOLTON","target":"STANNIS","weight":4},{"directed":false,"source":"THEON","target":"WALDA","weight":4},{"directed":false,"source":"AERYS","target":"DAENERYS","weight":16},{"directed":false,"source":"ARYA","target":"TYCHO","weight":3},{"directed":false,"source":"BARRISTAN","target":"RHAEGAR","weight":3},{"directed":false,"source":"DORAN","target":"TOMMEN","weight":3},{"directed":false,"source":"GREY_WORM","target":"TYRION","weight":142},{"directed":false,"source":"JAIME","target":"LOLLYS","weight":3},{"directed":false,"source":"JAIME","target":"OBARA","weight":3},{"directed":false,"source":"JANOS","target":"STANNIS","weight":3},{"directed":false,"source":"KEVAN","target":"LANCEL","weight":3},{"directed":false,"source":"KEVAN","target":"PYCELLE","weight":8},{"directed":false,"source":"KEVAN","target":"QYBURN","weight":5},{"directed":false,"source":"LITTLE_SAM","target":"OLLY","weight":3},{"directed":false,"source":"LITTLEFINGER","target":"LYANNA","weight":3},{"directed":false,"source":"LORD_WEEBLY","target":"SAM","weight":3},{"directed":false,"source":"LYANNA","target":"SANSA","weight":3},{"directed":false,"source":"MANCE","target":"MELISANDRE","weight":3},{"directed":false,"source":"OBARA","target":"OBERYN","weight":3},{"directed":false,"source":"PODRICK","target":"RENLY","weight":3},{"directed":false,"source":"RICKON","target":"SANSA","weight":10},{"directed":false,"source":"ROYCE","target":"SANSA","weight":3},{"directed":false,"source":"STANNIS","target":"TORMUND","weight":7},{"directed":false,"source":"AEGON","target":"RHAENYRA","weight":2},{"directed":false,"source":"ALLISER_THORNE","target":"DENYS","weight":2},{"directed":false,"source":"ALLISER_THORNE","target":"MANCE","weight":2},{"directed":false,"source":"ARYA","target":"MADAME","weight":2},{"directed":false,"source":"ARYA","target":"WALDER","weight":22},{"directed":false,"source":"BARRISTAN","target":"HIZDAHR","weight":2},{"directed":false,"source":"BRIAN","target":"JON","weight":2},{"directed":false,"source":"BRIENNE","target":"ROBERT","weight":2},{"directed":false,"source":"CERSEI","target":"JORAH","weight":2},{"directed":false,"source":"CERWYN","target":"RAMSAY","weight":2},{"directed":false,"source":"DAARIO","target":"QUICK","weight":2},{"directed":false,"source":"DAARIO","target":"STRONG","weight":2},{"directed":false,"source":"DAENERYS","target":"QUICK","weight":2},{"directed":false,"source":"DAENERYS","target":"STRONG","weight":2},{"directed":false,"source":"DORAN","target":"OBARA","weight":2},{"directed":false,"source":"DORAN","target":"TYENE","weight":6},{"directed":false,"source":"EDDISON_TOLLETT","target":"LITTLE_SAM","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"TORMUND","weight":36},{"directed":false,"source":"GILLY","target":"MELISANDRE","weight":2},{"directed":false,"source":"HIGH_SPARROW","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"HIGH_SPARROW","target":"SEPTA_UNELLA","weight":12},{"directed":false,"source":"HIZDAHR","target":"OWNER","weight":2},{"directed":false,"source":"HIZDAHR","target":"QUICK","weight":2},{"directed":false,"source":"HIZDAHR","target":"STRONG","weight":2},{"directed":false,"source":"JAIME","target":"NYMERIA","weight":2},{"directed":false,"source":"JAQEN","target":"MACE","weight":2},{"directed":false,"source":"JAQEN","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"JON","target":"LITTLE_SAM","weight":2},{"directed":false,"source":"JON","target":"LORD_WEEBLY","weight":2},{"directed":false,"source":"JON","target":"ROOSE_BOLTON","weight":5},{"directed":false,"source":"JORAH","target":"MOSSADOR","weight":2},{"directed":false,"source":"KARSI","target":"NIGHT_KING","weight":2},{"directed":false,"source":"LANCEL","target":"OLYVAR","weight":2},{"directed":false,"source":"LANCEL","target":"PYCELLE","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"MELISANDRE","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"STANNIS","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"MYRANDA","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"TOMMEN","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"WALDA","weight":2},{"directed":false,"source":"LOLLYS","target":"TANDA","weight":2},{"directed":false,"source":"LYANNA_MORMONT","target":"STANNIS","weight":2},{"directed":false,"source":"MACE","target":"THIN_MAN","weight":2},{"directed":false,"source":"MAESTER_WOLKAN","target":"ROOSE_BOLTON","weight":4},{"directed":false,"source":"MAGGY","target":"MELARA","weight":2},{"directed":false,"source":"MAGGY","target":"ROBERT","weight":2},{"directed":false,"source":"MAGNAR","target":"SAM","weight":2},{"directed":false,"source":"MANCE","target":"SAM","weight":2},{"directed":false,"source":"MARGAERY","target":"ROBERT","weight":2},{"directed":false,"source":"MELISANDRE","target":"OLLY","weight":4},{"directed":false,"source":"MERYN_TRANT","target":"MOUNTAIN","weight":2},{"directed":false,"source":"MERYN_TRANT","target":"THIN_MAN","weight":2},{"directed":false,"source":"MOSSADOR","target":"TYRION","weight":2},{"directed":false,"source":"OLENNA","target":"OLYVAR","weight":2},{"directed":false,"source":"OLYVAR","target":"TOMMEN","weight":2},{"directed":false,"source":"QUICK","target":"TYRION","weight":2},{"directed":false,"source":"ROBIN","target":"ROYCE","weight":2},{"directed":false,"source":"STANNIS","target":"STEFFON","weight":2},{"directed":false,"source":"STRONG","target":"TYRION","weight":2},{"directed":false,"source":"THIN_MAN","target":"WAIF","weight":2},{"directed":false,"source":"TYCHO","target":"JAQEN","weight":2},{"directed":false,"source":"TYCHO","target":"MERYN_TRANT","weight":2},{"directed":false,"source":"TYCHO","target":"THIN_MAN","weight":2},{"directed":false,"source":"JON","target":"SANSA","weight":300},{"directed":false,"source":"ARYA","target":"LADY_CRANE","weight":64},{"directed":false,"source":"DAVOS","target":"TORMUND","weight":76},{"directed":false,"source":"HOUND","target":"RAY","weight":41},{"directed":false,"source":"DAVOS","target":"SANSA","weight":64},{"directed":false,"source":"BRYNDEN","target":"JAIME","weight":35},{"directed":false,"source":"DAENERYS","target":"KHAL_MORO","weight":34},{"directed":false,"source":"RAMSAY","target":"SMALLJON","weight":34},{"directed":false,"source":"HIGH_SPARROW","target":"JAIME","weight":33},{"directed":false,"source":"BRIENNE","target":"BRYNDEN","weight":32},{"directed":false,"source":"EDMURE","target":"JAIME","weight":31},{"directed":false,"source":"JON","target":"RAMSAY","weight":30},{"directed":false,"source":"BENJEN","target":"BRAN","weight":29},{"directed":false,"source":"JON","target":"LYANNA_MORMONT","weight":41},{"directed":false,"source":"SANSA","target":"TORMUND","weight":37},{"directed":false,"source":"OSHA","target":"RAMSAY","weight":23},{"directed":false,"source":"CAMELLO","target":"LADY_CRANE","weight":21},{"directed":false,"source":"GREY_WORM","target":"VARYS","weight":53},{"directed":false,"source":"MARGAERY","target":"SEPTA_UNELLA","weight":21},{"directed":false,"source":"JAIME","target":"WALDER","weight":19},{"directed":false,"source":"JON","target":"ROBETT","weight":27},{"directed":false,"source":"DAENERYS","target":"YARA","weight":24},{"directed":false,"source":"BALON","target":"EURON","weight":17},{"directed":false,"source":"DAVOS","target":"LYANNA_MORMONT","weight":24},{"directed":false,"source":"EURON","target":"YARA","weight":44},{"directed":false,"source":"BIANCA","target":"LADY_CRANE","weight":16},{"directed":false,"source":"BOBONO","target":"LADY_CRANE","weight":16},{"directed":false,"source":"EURON","target":"THEON","weight":36},{"directed":false,"source":"IZEMBARO","target":"LADY_CRANE","weight":16},{"directed":false,"source":"MISSANDEI","target":"VARYS","weight":52},{"directed":false,"source":"TYRION","target":"YEZZAN","weight":16},{"directed":false,"source":"BLACK_WALDER","target":"WALDER","weight":15},{"directed":false,"source":"DAENERYS","target":"LHAZAREEN_WOMAN","weight":15},{"directed":false,"source":"DAENERYS","target":"THEON","weight":33},{"directed":false,"source":"GILLY","target":"MELESSA","weight":15},{"directed":false,"source":"KINVARA","target":"TYRION","weight":15},{"directed":false,"source":"BLACK_WALDER","target":"JAIME","weight":14},{"directed":false,"source":"VALA","target":"VARYS","weight":14},{"directed":false,"source":"BIANCA","target":"IZEMBARO","weight":13},{"directed":false,"source":"JAIME","target":"LOTHAR","weight":13},{"directed":false,"source":"JON","target":"WUN_WUN","weight":13},{"directed":false,"source":"MAESTER_CITADEL","target":"SAM","weight":13},{"directed":false,"source":"ARTHUR","target":"NED","weight":12},{"directed":false,"source":"BENJEN","target":"MEERA","weight":12},{"directed":false,"source":"BRAN","target":"NIGHT_KING","weight":29},{"directed":false,"source":"LYANNA_MORMONT","target":"SANSA","weight":26},{"directed":false,"source":"MAESTER_WOLKAN","target":"RAMSAY","weight":12},{"directed":false,"source":"MELESSA","target":"TALLA","weight":12},{"directed":false,"source":"MELISANDRE","target":"TORMUND","weight":17},{"directed":false,"source":"TORMUND","target":"WUN_WUN","weight":12},{"directed":false,"source":"CLARENZO","target":"LADY_CRANE","weight":11},{"directed":false,"source":"DICKON","target":"SAM","weight":15},{"directed":false,"source":"EDDISON_TOLLETT","target":"SANSA","weight":13},{"directed":false,"source":"JOFFREY","target":"LADY_CRANE","weight":11},{"directed":false,"source":"LEM","target":"RAY","weight":11},{"directed":false,"source":"MELESSA","target":"RANDYLL","weight":11},{"directed":false,"source":"NED","target":"THREE_EYED_RAVEN","weight":11},{"directed":false,"source":"RAMSAY","target":"SON_OFWALDA","weight":11},{"directed":false,"source":"ARYA","target":"BIANCA","weight":10},{"directed":false,"source":"BIANCA","target":"BOBONO","weight":10},{"directed":false,"source":"BOBONO","target":"CLARENZO","weight":10},{"directed":false,"source":"BRIENNE","target":"JON","weight":30},{"directed":false,"source":"GREY_WORM","target":"YEZZAN","weight":10},{"directed":false,"source":"MELISANDRE","target":"SANSA","weight":10},{"directed":false,"source":"RAZDAL","target":"TYRION","weight":10},{"directed":false,"source":"SON_OFWALDA","target":"WALDA","weight":10},{"directed":false,"source":"AERON","target":"YARA","weight":9},{"directed":false,"source":"ARYA","target":"IZEMBARO","weight":9},{"directed":false,"source":"BOBONO","target":"IZEMBARO","weight":9},{"directed":false,"source":"BRIENNE","target":"EDDISON_TOLLETT","weight":12},{"directed":false,"source":"BRIENNE","target":"TORMUND","weight":55},{"directed":false,"source":"CLARENZO","target":"IZEMBARO","weight":9},{"directed":false,"source":"DAVOS","target":"WUN_WUN","weight":9},{"directed":false,"source":"ELLARIA","target":"OLENNA","weight":12},{"directed":false,"source":"GATINS","target":"HOUND","weight":9},{"directed":false,"source":"AERON","target":"EURON","weight":8},{"directed":false,"source":"BENJEN","target":"LYANNA","weight":8},{"directed":false,"source":"BIANCA","target":"CLARENZO","weight":8},{"directed":false,"source":"DAENERYS","target":"DOSH_KHALEEN_LEADER","weight":8},{"directed":false,"source":"DAVOS","target":"RAMSAY","weight":8},{"directed":false,"source":"DOSH_KHALEEN_LEADER","target":"LHAZAREEN_WOMAN","weight":8},{"directed":false,"source":"GILLY","target":"TALLA","weight":8},{"directed":false,"source":"HIGH_SPARROW","target":"LANCEL","weight":8},{"directed":false,"source":"JON","target":"LITTLEFINGER","weight":28},{"directed":false,"source":"JON","target":"SMALLJON","weight":8},{"directed":false,"source":"KINVARA","target":"VARYS","weight":8},{"directed":false,"source":"QYBURN","target":"TOMMEN","weight":8},{"directed":false,"source":"RAMSAY","target":"RICKARD_KARSTARK","weight":8},{"directed":false,"source":"RAMSAY","target":"TORMUND","weight":8},{"directed":false,"source":"SAM","target":"TALLA","weight":8},{"directed":false,"source":"BELICHO","target":"TYRION","weight":7},{"directed":false,"source":"BENJEN","target":"THREE_EYED_RAVEN","weight":7},{"directed":false,"source":"BOBONO","target":"CAMELLO","weight":7},{"directed":false,"source":"EDMURE","target":"GUARD_CAPTAIN","weight":7},{"directed":false,"source":"GLOVER","target":"JON","weight":7},{"directed":false,"source":"GREY_WORM","target":"RAZDAL","weight":7},{"directed":false,"source":"KEVAN","target":"OLENNA","weight":7},{"directed":false,"source":"LYANNA_MORMONT","target":"MAESTER_MORMONT","weight":7},{"directed":false,"source":"MEERA","target":"NIGHT_KING","weight":7},{"directed":false,"source":"MISSANDEI","target":"RAZDAL","weight":7},{"directed":false,"source":"MISSANDEI","target":"YEZZAN","weight":7},{"directed":false,"source":"NYMERIA","target":"TRYSTANE","weight":7},{"directed":false,"source":"OBARA","target":"OLENNA","weight":7},{"directed":false,"source":"OLENNA","target":"SEPTA_UNELLA","weight":7},{"directed":false,"source":"RAZDAL","target":"YEZZAN","weight":7},{"directed":false,"source":"ROBETT","target":"SANSA","weight":14},{"directed":false,"source":"ROBIN","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"ALLISER_THORNE","target":"BOWEN_MARSH","weight":6},{"directed":false,"source":"ARTHUR_CHILD","target":"QYBURN","weight":6},{"directed":false,"source":"ARYA","target":"CLARENZO","weight":6},{"directed":false,"source":"BELICHO","target":"RAZDAL","weight":6},{"directed":false,"source":"BOWEN_MARSH","target":"JON","weight":6},{"directed":false,"source":"BRAN","target":"LYANNA","weight":13},{"directed":false,"source":"BRYNDEN","target":"GUARD_CAPTAIN","weight":6},{"directed":false,"source":"BRYNDEN","target":"PODRICK","weight":6},{"directed":false,"source":"BRYNDEN","target":"SANSA","weight":6},{"directed":false,"source":"CAMELLO","target":"CLARENZO","weight":6},{"directed":false,"source":"CAMELLO","target":"IZEMBARO","weight":6},{"directed":false,"source":"CERSEI","target":"LADY_CRANE","weight":6},{"directed":false,"source":"DAENERYS","target":"RAZDAL","weight":6},{"directed":false,"source":"DAVOS","target":"SMALLJON","weight":6},{"directed":false,"source":"HIGH_SPARROW","target":"MACE","weight":6},{"directed":false,"source":"HOUND","target":"LEM","weight":6},{"directed":false,"source":"LADY_CRANE","target":"SANSA","weight":6},{"directed":false,"source":"LANCEL","target":"MARGAERY","weight":6},{"directed":false,"source":"LEAF","target":"NIGHT_KING","weight":6},{"directed":false,"source":"OBARA","target":"TRYSTANE","weight":6},{"directed":false,"source":"RICKON","target":"SMALLJON","weight":6},{"directed":false,"source":"SMALLJON","target":"TORMUND","weight":6},{"directed":false,"source":"TYRION","target":"YARA","weight":11},{"directed":false,"source":"ARYA","target":"BOBONO","weight":5},{"directed":false,"source":"ARYA","target":"CAMELLO","weight":5},{"directed":false,"source":"BELICHO","target":"GREY_WORM","weight":5},{"directed":false,"source":"BELICHO","target":"MISSANDEI","weight":5},{"directed":false,"source":"BELICHO","target":"YEZZAN","weight":5},{"directed":false,"source":"BLACK_WALDER","target":"BRONN","weight":5},{"directed":false,"source":"BOBONO","target":"JOFFREY","weight":5},{"directed":false,"source":"BRIENNE","target":"THEON","weight":10},{"directed":false,"source":"CLARENZO","target":"JOFFREY","weight":5},{"directed":false,"source":"CLARENZO","target":"TYRION","weight":5},{"directed":false,"source":"DAENERYS","target":"KINVARA","weight":5},{"directed":false,"source":"DAVOS","target":"LITTLEFINGER","weight":9},{"directed":false,"source":"DIM_DALBA","target":"JON","weight":5},{"directed":false,"source":"DOM","target":"VARYS","weight":5},{"directed":false,"source":"DORAN","target":"MAESTER_DORNE","weight":5},{"directed":false,"source":"DROGO","target":"KHAL_MORO","weight":5},{"directed":false,"source":"JON","target":"MAESTER_MORMONT","weight":5},{"directed":false,"source":"LADY_CRANE","target":"TYRION","weight":5},{"directed":false,"source":"LITTLE_SAM","target":"MELESSA","weight":5},{"directed":false,"source":"MAESTER_MORMONT","target":"SANSA","weight":5},{"directed":false,"source":"NIGHT_KING","target":"THREE_EYED_RAVEN","weight":5},{"directed":false,"source":"PODRICK","target":"THEON","weight":9},{"directed":false,"source":"RAMSAY","target":"WUN_WUN","weight":5},{"directed":false,"source":"RANDYLL","target":"TALLA","weight":5},{"directed":false,"source":"RICKARD_KARSTARK","target":"SMALLJON","weight":5},{"directed":false,"source":"SANSA","target":"WUN_WUN","weight":5},{"directed":false,"source":"AERON","target":"BALON","weight":4},{"directed":false,"source":"AERON","target":"THEON","weight":4},{"directed":false,"source":"ARTHUR","target":"HOWLAND","weight":4},{"directed":false,"source":"BIANCA","target":"CAMELLO","weight":4},{"directed":false,"source":"BIANCA","target":"JOFFREY","weight":4},{"directed":false,"source":"BIANCA","target":"SANSA","weight":4},{"directed":false,"source":"BOBONO","target":"SANSA","weight":4},{"directed":false,"source":"BOBONO","target":"TYRION","weight":4},{"directed":false,"source":"BOBONO","target":"TYWIN","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"DAVOS","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"EDDISON_TOLLETT","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"MELISANDRE","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"OLLY","weight":4},{"directed":false,"source":"BOWEN_MARSH","target":"OTHELL_YARWYCK","weight":6},{"directed":false,"source":"BOWEN_MARSH","target":"TORMUND","weight":4},{"directed":false,"source":"BRONN","target":"LOTHAR","weight":4},{"directed":false,"source":"CERSEI","target":"CLARENZO","weight":4},{"directed":false,"source":"CLARENZO","target":"SANSA","weight":4},{"directed":false,"source":"DAARIO","target":"LHAZAREEN_WOMAN","weight":4},{"directed":false,"source":"DAENERYS","target":"YEZZAN","weight":4},{"directed":false,"source":"DAVOS","target":"MAESTER_MORMONT","weight":4},{"directed":false,"source":"DICKON","target":"GILLY","weight":4},{"directed":false,"source":"DIM_DALBA","target":"TORMUND","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"PODRICK","weight":4},{"directed":false,"source":"GILLY","target":"MAESTER_CITADEL","weight":4},{"directed":false,"source":"GLOVER","target":"MANDERLY","weight":4},{"directed":false,"source":"HARALD","target":"RAMSAY","weight":4},{"directed":false,"source":"HODOR","target":"LYANNA","weight":4},{"directed":false,"source":"HODOR","target":"NIGHT_KING","weight":4},{"directed":false,"source":"HOWLAND","target":"NED","weight":4},{"directed":false,"source":"JAIME","target":"SON_OF_EDMURE","weight":4},{"directed":false,"source":"JON","target":"MANDERLY","weight":4},{"directed":false,"source":"JON","target":"PODRICK","weight":11},{"directed":false,"source":"KEVAN","target":"MARGAERY","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"TORMUND","weight":7},{"directed":false,"source":"LYANNA_MORMONT","target":"ROBB","weight":4},{"directed":false,"source":"MAESTER_WOLKAN","target":"MYRANDA","weight":4},{"directed":false,"source":"MAESTER_WOLKAN","target":"RICKARD_KARSTARK","weight":4},{"directed":false,"source":"NYMERIA","target":"OLENNA","weight":4},{"directed":false,"source":"PODRICK","target":"TORMUND","weight":28},{"directed":false,"source":"RED_PRIEST","target":"TYRION","weight":4},{"directed":false,"source":"SANSA","target":"SMALLJON","weight":4},{"directed":false,"source":"ALLISER_THORNE","target":"MELISANDRE","weight":3},{"directed":false,"source":"ALLISER_THORNE","target":"WUN_WUN","weight":3},{"directed":false,"source":"ARTHUR","target":"BRAN","weight":3},{"directed":false,"source":"ARTHUR","target":"THREE_EYED_RAVEN","weight":3},{"directed":false,"source":"BENJEN","target":"HODOR","weight":3},{"directed":false,"source":"BERIC","target":"LEM","weight":3},{"directed":false,"source":"BIANCA","target":"CERSEI","weight":3},{"directed":false,"source":"BIANCA","target":"NED","weight":3},{"directed":false,"source":"BIANCA","target":"TYRION","weight":3},{"directed":false,"source":"BOBONO","target":"CERSEI","weight":3},{"directed":false,"source":"BOBONO","target":"NED","weight":3},{"directed":false,"source":"BRONN","target":"EDMURE","weight":3},{"directed":false,"source":"CERSEI","target":"IZEMBARO","weight":3},{"directed":false,"source":"CLARENZO","target":"MARGAERY","weight":3},{"directed":false,"source":"DAENERYS","target":"RED_PRIEST","weight":3},{"directed":false,"source":"DAVOS","target":"GLOVER","weight":3},{"directed":false,"source":"DAVOS","target":"HARALD","weight":3},{"directed":false,"source":"DICKON","target":"RANDYLL","weight":30},{"directed":false,"source":"DIM_DALBA","target":"WUN_WUN","weight":3},{"directed":false,"source":"DOM","target":"VALA","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"WUN_WUN","weight":3},{"directed":false,"source":"GLOVER","target":"SANSA","weight":3},{"directed":false,"source":"HARALD","target":"JON","weight":3},{"directed":false,"source":"HARALD","target":"SANSA","weight":3},{"directed":false,"source":"HARALD","target":"SMALLJON","weight":3},{"directed":false,"source":"HARALD","target":"TORMUND","weight":3},{"directed":false,"source":"HIGH_SPARROW","target":"KEVAN","weight":3},{"directed":false,"source":"HOWLAND","target":"THREE_EYED_RAVEN","weight":3},{"directed":false,"source":"IZEMBARO","target":"JOFFREY","weight":3},{"directed":false,"source":"IZEMBARO","target":"NED","weight":3},{"directed":false,"source":"IZEMBARO","target":"TYWIN","weight":3},{"directed":false,"source":"JORAH","target":"LHAZAREEN_WOMAN","weight":3},{"directed":false,"source":"KEVAN","target":"LORAS","weight":3},{"directed":false,"source":"KEVAN","target":"MACE","weight":3},{"directed":false,"source":"LEM","target":"THOROS","weight":3},{"directed":false,"source":"LITTLE_SAM","target":"TALLA","weight":3},{"directed":false,"source":"LYANNA","target":"THREE_EYED_RAVEN","weight":3},{"directed":false,"source":"LYANNA_MORMONT","target":"RAMSAY","weight":3},{"directed":false,"source":"LYANNA_MORMONT","target":"TORMUND","weight":11},{"directed":false,"source":"MANDERLY","target":"ROBB","weight":3},{"directed":false,"source":"NED","target":"OLD_NAN","weight":3},{"directed":false,"source":"NED","target":"RAMSAY","weight":3},{"directed":false,"source":"OLENNA","target":"TYENE","weight":3},{"directed":false,"source":"RAZDAL","target":"VARYS","weight":3},{"directed":false,"source":"RED_PRIEST","target":"VARYS","weight":3},{"directed":false,"source":"ROBB","target":"ROBETT","weight":3},{"directed":false,"source":"ROOSE_BOLTON","target":"SMALLJON","weight":3},{"directed":false,"source":"SMALLJON","target":"WUN_WUN","weight":3},{"directed":false,"source":"AREO","target":"MAESTER_DORNE","weight":2},{"directed":false,"source":"ARYA","target":"RICKON","weight":2},{"directed":false,"source":"BELICHO","target":"DAENERYS","weight":2},{"directed":false,"source":"BELICHO","target":"VARYS","weight":2},{"directed":false,"source":"BENJEN","target":"RODRIK","weight":2},{"directed":false,"source":"BIANCA","target":"MARGAERY","weight":2},{"directed":false,"source":"BOBONO","target":"MARGAERY","weight":2},{"directed":false,"source":"BRAN","target":"HOWLAND","weight":2},{"directed":false,"source":"BRAN","target":"JAQEN","weight":2},{"directed":false,"source":"BRONN","target":"BRYNDEN","weight":2},{"directed":false,"source":"BRONN","target":"WALDER","weight":2},{"directed":false,"source":"BRYNDEN","target":"MINISA","weight":2},{"directed":false,"source":"CAMELLO","target":"NED","weight":2},{"directed":false,"source":"CAMELLO","target":"SANSA","weight":2},{"directed":false,"source":"CAMELLO","target":"TYRION","weight":2},{"directed":false,"source":"CERSEI","target":"SON_OF_EDMURE","weight":2},{"directed":false,"source":"CLARENZO","target":"ROBERT","weight":2},{"directed":false,"source":"DAARIO","target":"DOSH_KHALEEN_LEADER","weight":2},{"directed":false,"source":"DAARIO","target":"KHAL_MORO","weight":2},{"directed":false,"source":"DAENERYS","target":"VALA","weight":2},{"directed":false,"source":"DAVOS","target":"DIM_DALBA","weight":2},{"directed":false,"source":"DAVOS","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"DAVOS","target":"RICKON","weight":2},{"directed":false,"source":"DAVOS","target":"ROBETT","weight":4},{"directed":false,"source":"DICKON","target":"MELESSA","weight":2},{"directed":false,"source":"DICKON","target":"TALLA","weight":2},{"directed":false,"source":"DIM_DALBA","target":"SANSA","weight":2},{"directed":false,"source":"DOSH_KHALEEN_LEADER","target":"JORAH","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"EDMURE","target":"HOSTER","weight":2},{"directed":false,"source":"EDMURE","target":"SON_OF_EDMURE","weight":2},{"directed":false,"source":"ELLARIA","target":"MAESTER_DORNE","weight":2},{"directed":false,"source":"FLYNN","target":"LEM","weight":2},{"directed":false,"source":"FLYNN","target":"MORGAN","weight":2},{"directed":false,"source":"FLYNN","target":"RAY","weight":2},{"directed":false,"source":"GLOVER","target":"ROBB","weight":2},{"directed":false,"source":"GLOVER","target":"ROBETT","weight":2},{"directed":false,"source":"GREY_WORM","target":"THEON","weight":9},{"directed":false,"source":"GREY_WORM","target":"YARA","weight":7},{"directed":false,"source":"HARALD","target":"LYANNA_MORMONT","weight":2},{"directed":false,"source":"HODOR","target":"OLD_NAN","weight":2},{"directed":false,"source":"IZEMBARO","target":"ROBERT","weight":2},{"directed":false,"source":"IZEMBARO","target":"SANSA","weight":2},{"directed":false,"source":"IZEMBARO","target":"TYRION","weight":2},{"directed":false,"source":"JORAH","target":"KHAL_MORO","weight":2},{"directed":false,"source":"LADY_CRANE","target":"MARGAERY","weight":2},{"directed":false,"source":"LADY_CRANE","target":"ROBERT","weight":2},{"directed":false,"source":"LADY_CRANE","target":"TYWIN","weight":2},{"directed":false,"source":"LADY_CRANE","target":"WAIF","weight":2},{"directed":false,"source":"LANCEL","target":"MACE","weight":2},{"directed":false,"source":"LANCEL","target":"QYBURN","weight":2},{"directed":false,"source":"LANCEL","target":"SEPTA_UNELLA","weight":2},{"directed":false,"source":"LEM","target":"MORGAN","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"RANDYLL","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"SMALLJON","weight":2},{"directed":false,"source":"LITTLEFINGER","target":"WUN_WUN","weight":2},{"directed":false,"source":"LYANNA_MORMONT","target":"MANDERLY","weight":2},{"directed":false,"source":"LYANNA_MORMONT","target":"SMALLJON","weight":2},{"directed":false,"source":"MAESTER_DORNE","target":"TYENE","weight":2},{"directed":false,"source":"MEERA","target":"OLD_NAN","weight":2},{"directed":false,"source":"MELISANDRE","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"MELISANDRE","target":"PODRICK","weight":2},{"directed":false,"source":"MELISANDRE","target":"RAMSAY","weight":2},{"directed":false,"source":"MISSANDEI","target":"THEON","weight":12},{"directed":false,"source":"MISSANDEI","target":"YARA","weight":4},{"directed":false,"source":"MORGAN","target":"RAY","weight":2},{"directed":false,"source":"NED","target":"ROBETT","weight":2},{"directed":false,"source":"OLD_NAN","target":"THREE_EYED_RAVEN","weight":2},{"directed":false,"source":"OLLY","target":"OTHELL_YARWYCK","weight":2},{"directed":false,"source":"OSHA","target":"SMALLJON","weight":2},{"directed":false,"source":"OTHELL_YARWYCK","target":"TORMUND","weight":2},{"directed":false,"source":"QYBURN","target":"VARYS","weight":2},{"directed":false,"source":"RICKON","target":"WUN_WUN","weight":2},{"directed":false,"source":"VARYS","target":"YARA","weight":4},{"directed":false,"source":"VARYS","target":"YEZZAN","weight":2},{"directed":false,"source":"DAENERYS","target":"JON","weight":372},{"directed":false,"source":"MARWYN","target":"SAM","weight":78},{"directed":false,"source":"JON","target":"JORAH","weight":70},{"directed":false,"source":"HOUND","target":"TORMUND","weight":79},{"directed":false,"source":"DAVOS","target":"TYRION","weight":118},{"directed":false,"source":"BERIC","target":"JON","weight":49},{"directed":false,"source":"CERSEI","target":"EURON","weight":78},{"directed":false,"source":"CERSEI","target":"TYCHO","weight":37},{"directed":false,"source":"JON","target":"MISSANDEI","weight":47},{"directed":false,"source":"CERSEI","target":"DAENERYS","weight":69},{"directed":false,"source":"DAENERYS","target":"DAVOS","weight":50},{"directed":false,"source":"JAIME","target":"RANDYLL","weight":33},{"directed":false,"source":"DAVOS","target":"MISSANDEI","weight":35},{"directed":false,"source":"GENDRY","target":"JON","weight":37},{"directed":false,"source":"BERIC","target":"TORMUND","weight":51},{"directed":false,"source":"HOUND","target":"JON","weight":31},{"directed":false,"source":"JORAH","target":"SAM","weight":53},{"directed":false,"source":"EURON","target":"JAIME","weight":43},{"directed":false,"source":"HOUND","target":"JORAH","weight":35},{"directed":false,"source":"ELLARIA","target":"YARA","weight":25},{"directed":false,"source":"DICKON","target":"JAIME","weight":24},{"directed":false,"source":"HARRAG","target":"THEON","weight":24},{"directed":false,"source":"JORAH","target":"TORMUND","weight":42},{"directed":false,"source":"JAIME","target":"MOUNTAIN","weight":23},{"directed":false,"source":"MELISANDRE","target":"VARYS","weight":21},{"directed":false,"source":"DAENERYS","target":"JAIME","weight":43},{"directed":false,"source":"BRAN","target":"LITTLEFINGER","weight":19},{"directed":false,"source":"JORAH","target":"THOROS","weight":19},{"directed":false,"source":"BERIC","target":"JORAH","weight":31},{"directed":false,"source":"JON","target":"VARYS","weight":67},{"directed":false,"source":"SANSA","target":"MAESTER_WOLKAN","weight":29},{"directed":false,"source":"DAENERYS","target":"OLENNA","weight":16},{"directed":false,"source":"JORAH","target":"MARWYN","weight":16},{"directed":false,"source":"CERSEI","target":"TYENE","weight":15},{"directed":false,"source":"GENDRY","target":"TORMUND","weight":34},{"directed":false,"source":"DAENERYS","target":"RANDYLL","weight":17},{"directed":false,"source":"DAVOS","target":"JORAH","weight":18},{"directed":false,"source":"DAENERYS","target":"MELISANDRE","weight":13},{"directed":false,"source":"GENDRY","target":"JORAH","weight":21},{"directed":false,"source":"DAVOS","target":"THEON","weight":15},{"directed":false,"source":"JON","target":"THOROS","weight":12},{"directed":false,"source":"BRONN","target":"DICKON","weight":11},{"directed":false,"source":"LITTLEFINGER","target":"MAESTER_WOLKAN","weight":11},{"directed":false,"source":"LYANNA_MORMONT","target":"ROBETT","weight":11},{"directed":false,"source":"THOROS","target":"TORMUND","weight":11},{"directed":false,"source":"DAENERYS","target":"DICKON","weight":12},{"directed":false,"source":"DAENERYS","target":"NIGHT_KING","weight":20},{"directed":false,"source":"DAVOS","target":"VARYS","weight":24},{"directed":false,"source":"EURON","target":"MOUNTAIN","weight":15},{"directed":false,"source":"BERIC","target":"NIGHT_KING","weight":10},{"directed":false,"source":"BRONN","target":"DAENERYS","weight":10},{"directed":false,"source":"BRONN","target":"RANDYLL","weight":8},{"directed":false,"source":"ELLARIA","target":"THEON","weight":8},{"directed":false,"source":"EURON","target":"TYRION","weight":12},{"directed":false,"source":"ROBETT","target":"YOHN_ROYCE","weight":8},{"directed":false,"source":"BRAN","target":"MAESTER_WOLKAN","weight":11},{"directed":false,"source":"DAENERYS","target":"EURON","weight":17},{"directed":false,"source":"JORAH","target":"THEON","weight":10},{"directed":false,"source":"LYANNA","target":"RHAEGAR","weight":11},{"directed":false,"source":"RANDYLL","target":"TYRION","weight":7},{"directed":false,"source":"ARYA","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"CERSEI","target":"RANDYLL","weight":6},{"directed":false,"source":"DAENERYS","target":"HOUND","weight":13},{"directed":false,"source":"ELLARIA","target":"QYBURN","weight":6},{"directed":false,"source":"EURON","target":"TYENE","weight":6},{"directed":false,"source":"LITTLEFINGER","target":"ROBETT","weight":6},{"directed":false,"source":"LYANNA_MORMONT","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"NIGHT_KING","target":"TORMUND","weight":6},{"directed":false,"source":"TYENE","target":"YARA","weight":6},{"directed":false,"source":"AERYS","target":"JON","weight":7},{"directed":false,"source":"ALYS","target":"NED_UMBER","weight":5},{"directed":false,"source":"ARYA","target":"MAESTER_WOLKAN","weight":9},{"directed":false,"source":"DAENERYS","target":"TORMUND","weight":21},{"directed":false,"source":"DAVOS","target":"HOUND","weight":8},{"directed":false,"source":"ELLARIA","target":"EURON","weight":5},{"directed":false,"source":"EURON","target":"JON","weight":5},{"directed":false,"source":"HOUND","target":"NIGHT_KING","weight":5},{"directed":false,"source":"JON","target":"MAESTER_WOLKAN","weight":11},{"directed":false,"source":"JON","target":"MOUNTAIN","weight":5},{"directed":false,"source":"JON","target":"YOHN_ROYCE","weight":9},{"directed":false,"source":"QYBURN","target":"TYENE","weight":5},{"directed":false,"source":"ARYA","target":"ROBETT","weight":4},{"directed":false,"source":"BERIC","target":"DAENERYS","weight":8},{"directed":false,"source":"BRAN","target":"EDDISON_TOLLETT","weight":4},{"directed":false,"source":"BRAN","target":"RHAEGAR","weight":4},{"directed":false,"source":"BRIENNE","target":"LYANNA_MORMONT","weight":11},{"directed":false,"source":"BRIENNE","target":"ROBETT","weight":4},{"directed":false,"source":"BRIENNE","target":"YOHN_ROYCE","weight":10},{"directed":false,"source":"CERSEI","target":"THEON","weight":4},{"directed":false,"source":"DAVOS","target":"PODRICK","weight":13},{"directed":false,"source":"DICKON","target":"TYRION","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"MEERA","weight":4},{"directed":false,"source":"EURON","target":"NYMERIA","weight":4},{"directed":false,"source":"EURON","target":"OBARA","weight":4},{"directed":false,"source":"EURON","target":"QYBURN","weight":10},{"directed":false,"source":"GENDRY","target":"TYRION","weight":10},{"directed":false,"source":"HOUND","target":"THEON","weight":4},{"directed":false,"source":"JEOR","target":"JORAH","weight":4},{"directed":false,"source":"JON","target":"LYANNA","weight":13},{"directed":false,"source":"JON","target":"NED_UMBER","weight":4},{"directed":false,"source":"JON","target":"QYBURN","weight":4},{"directed":false,"source":"JORAH","target":"NIGHT_KING","weight":4},{"directed":false,"source":"LITTLEFINGER","target":"LYANNA_MORMONT","weight":4},{"directed":false,"source":"MAESTER_WOLKAN","target":"YOHN_ROYCE","weight":8},{"directed":false,"source":"MELISANDRE","target":"TYRION","weight":4},{"directed":false,"source":"MOUNTAIN","target":"TYENE","weight":4},{"directed":false,"source":"NYMERIA","target":"YARA","weight":4},{"directed":false,"source":"OBARA","target":"YARA","weight":4},{"directed":false,"source":"OLENNA","target":"RANDYLL","weight":4},{"directed":false,"source":"QYBURN","target":"TYRION","weight":23},{"directed":false,"source":"AEGON","target":"DAENERYS","weight":5},{"directed":false,"source":"AERYS","target":"VARYS","weight":3},{"directed":false,"source":"ALYS","target":"JON","weight":8},{"directed":false,"source":"ARYA","target":"LYANNA_MORMONT","weight":7},{"directed":false,"source":"BALERION","target":"QYBURN","weight":3},{"directed":false,"source":"BERIC","target":"DAVOS","weight":7},{"directed":false,"source":"BRAN","target":"DAENERYS","weight":19},{"directed":false,"source":"BRAN","target":"YOHN_ROYCE","weight":9},{"directed":false,"source":"BRIENNE","target":"MOUNTAIN","weight":3},{"directed":false,"source":"BRIENNE","target":"QYBURN","weight":3},{"directed":false,"source":"BRONN","target":"DAVOS","weight":13},{"directed":false,"source":"BRONN","target":"JON","weight":3},{"directed":false,"source":"DAENERYS","target":"ELLARIA","weight":3},{"directed":false,"source":"DAVOS","target":"EURON","weight":3},{"directed":false,"source":"DAVOS","target":"JAIME","weight":13},{"directed":false,"source":"DAVOS","target":"NIGHT_KING","weight":3},{"directed":false,"source":"HARRAG","target":"YARA","weight":3},{"directed":false,"source":"HOUND","target":"QYBURN","weight":7},{"directed":false,"source":"LITTLEFINGER","target":"MEERA","weight":3},{"directed":false,"source":"MOUNTAIN","target":"THEON","weight":3},{"directed":false,"source":"THEON","target":"TYENE","weight":3},{"directed":false,"source":"AERYS","target":"OLENNA","weight":2},{"directed":false,"source":"BALERION","target":"CERSEI","weight":2},{"directed":false,"source":"BRAN","target":"BRIENNE","weight":13},{"directed":false,"source":"BRAN","target":"PODRICK","weight":5},{"directed":false,"source":"BRIENNE","target":"EURON","weight":2},{"directed":false,"source":"BRIENNE","target":"JORAH","weight":15},{"directed":false,"source":"BRIENNE","target":"QHONO","weight":6},{"directed":false,"source":"BRIENNE","target":"VARYS","weight":11},{"directed":false,"source":"BRONN","target":"GREY_WORM","weight":2},{"directed":false,"source":"BRONN","target":"JORAH","weight":2},{"directed":false,"source":"BRONN","target":"THEON","weight":2},{"directed":false,"source":"CERSEI","target":"NIGHT_KING","weight":2},{"directed":false,"source":"CERSEI","target":"YARA","weight":2},{"directed":false,"source":"DAENERYS","target":"GENDRY","weight":23},{"directed":false,"source":"DAENERYS","target":"LITTLEFINGER","weight":2},{"directed":false,"source":"DAENERYS","target":"MOUNTAIN","weight":6},{"directed":false,"source":"DAENERYS","target":"QYBURN","weight":6},{"directed":false,"source":"DAENERYS","target":"TYWIN","weight":4},{"directed":false,"source":"DAVOS","target":"GREY_WORM","weight":29},{"directed":false,"source":"DAVOS","target":"MOUNTAIN","weight":2},{"directed":false,"source":"DAVOS","target":"QYBURN","weight":2},{"directed":false,"source":"DAVOS","target":"YOHN_ROYCE","weight":8},{"directed":false,"source":"DICKON","target":"OLENNA","weight":2},{"directed":false,"source":"DROGO","target":"JON","weight":2},{"directed":false,"source":"ELLARIA","target":"GREY_WORM","weight":2},{"directed":false,"source":"ELLARIA","target":"MISSANDEI","weight":2},{"directed":false,"source":"EURON","target":"HOUND","weight":2},{"directed":false,"source":"GREY_WORM","target":"JAIME","weight":21},{"directed":false,"source":"GREY_WORM","target":"JON","weight":52},{"directed":false,"source":"GREY_WORM","target":"MELISANDRE","weight":7},{"directed":false,"source":"GREY_WORM","target":"OLENNA","weight":2},{"directed":false,"source":"HIGH_SEPTON","target":"SAM","weight":2},{"directed":false,"source":"HOT_PIE","target":"JON","weight":2},{"directed":false,"source":"HOUND","target":"MISSANDEI","weight":2},{"directed":false,"source":"HOUND","target":"QHONO","weight":2},{"directed":false,"source":"HOUND","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"HOWLAND","target":"MEERA","weight":2},{"directed":false,"source":"JON","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"JON_ARRYN","target":"SANSA","weight":2},{"directed":false,"source":"JORAH","target":"PODRICK","weight":6},{"directed":false,"source":"JORAH","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"LYANNA_MORMONT","target":"PODRICK","weight":2},{"directed":false,"source":"MARWYN","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"MARWYN","target":"ROBERT","weight":2},{"directed":false,"source":"MARWYN","target":"SHIREEN","weight":2},{"directed":false,"source":"MELISANDRE","target":"MISSANDEI","weight":2},{"directed":false,"source":"MISSANDEI","target":"OLENNA","weight":2},{"directed":false,"source":"MOUNTAIN","target":"MYRCELLA","weight":2},{"directed":false,"source":"MOUNTAIN","target":"RANDYLL","weight":2},{"directed":false,"source":"NIGHT_KING","target":"TYRION","weight":2},{"directed":false,"source":"NYMERIA","target":"THEON","weight":2},{"directed":false,"source":"OBARA","target":"THEON","weight":2},{"directed":false,"source":"OLENNA","target":"THEON","weight":2},{"directed":false,"source":"OLENNA","target":"YARA","weight":2},{"directed":false,"source":"PODRICK","target":"QHONO","weight":2},{"directed":false,"source":"PODRICK","target":"ROBETT","weight":2},{"directed":false,"source":"PODRICK","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"QHONO","target":"TYRION","weight":6},{"directed":false,"source":"QYBURN","target":"RANDYLL","weight":2},{"directed":false,"source":"QYBURN","target":"THEON","weight":2},{"directed":false,"source":"ROBERT","target":"SAM","weight":4},{"directed":false,"source":"ROBETT","target":"TORMUND","weight":2},{"directed":false,"source":"TORMUND","target":"WHITE_WALKER","weight":2},{"directed":false,"source":"TORMUND","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"JAIME","target":"TORMUND","weight":38},{"directed":false,"source":"DAENERYS","target":"SAM","weight":26},{"directed":false,"source":"SAM","target":"TYRION","weight":24},{"directed":false,"source":"BRIENNE","target":"GREY_WORM","weight":23},{"directed":false,"source":"BRIENNE","target":"SAM","weight":23},{"directed":false,"source":"GREY_WORM","target":"SAM","weight":23},{"directed":false,"source":"GREY_WORM","target":"TORMUND","weight":23},{"directed":false,"source":"ARYA","target":"DAVOS","weight":22},{"directed":false,"source":"ARYA","target":"NORA","weight":22},{"directed":false,"source":"NORA","target":"VICKY","weight":22},{"directed":false,"source":"ARYA","target":"DAENERYS","weight":21},{"directed":false,"source":"BRONN","target":"QYBURN","weight":20},{"directed":false,"source":"JAIME","target":"SAM","weight":19},{"directed":false,"source":"TORMUND","target":"TYRION","weight":19},{"directed":false,"source":"GREY_WORM","target":"SANSA","weight":18},{"directed":false,"source":"GENDRY","target":"SAM","weight":17},{"directed":false,"source":"JORAH","target":"LYANNA_MORMONT","weight":17},{"directed":false,"source":"GENDRY","target":"GREY_WORM","weight":16},{"directed":false,"source":"BERIC","target":"SAM","weight":15},{"directed":false,"source":"BRAN","target":"GREY_WORM","weight":15},{"directed":false,"source":"ARYA","target":"VICKY","weight":14},{"directed":false,"source":"JAIME","target":"JORAH","weight":14},{"directed":false,"source":"MISSANDEI","target":"SANSA","weight":14},{"directed":false,"source":"ARYA","target":"GREY_WORM","weight":13},{"directed":false,"source":"BRIENNE","target":"GENDRY","weight":13},{"directed":false,"source":"GENDRY","target":"JAIME","weight":13},{"directed":false,"source":"LYANNA_MORMONT","target":"SAM","weight":13},{"directed":false,"source":"BERIC","target":"GREY_WORM","weight":12},{"directed":false,"source":"CRAYAH","target":"DIRAH","weight":12},{"directed":false,"source":"SAM","target":"SANSA","weight":12},{"directed":false,"source":"BRIENNE","target":"DAENERYS","weight":11},{"directed":false,"source":"CERSEI","target":"HARRY","weight":11},{"directed":false,"source":"JORAH","target":"MELISANDRE","weight":11},{"directed":false,"source":"MARTHA","target":"VARYS","weight":11},{"directed":false,"source":"ARYA","target":"SAM","weight":10},{"directed":false,"source":"BERIC","target":"BRIENNE","weight":10},{"directed":false,"source":"DAENERYS","target":"MAESTER_WOLKAN","weight":10},{"directed":false,"source":"JAIME","target":"LYANNA_MORMONT","weight":10},{"directed":false,"source":"JORAH","target":"SANSA","weight":10},{"directed":false,"source":"BERIC","target":"EDDISON_TOLLETT","weight":9},{"directed":false,"source":"BERIC","target":"JAIME","weight":9},{"directed":false,"source":"BRAN","target":"DAVOS","weight":9},{"directed":false,"source":"CERSEI","target":"MISSANDEI","weight":9},{"directed":false,"source":"TYRION","target":"MAESTER_WOLKAN","weight":9},{"directed":false,"source":"TYRION","target":"YOHN_ROYCE","weight":9},{"directed":false,"source":"ALYS","target":"TYRION","weight":8},{"directed":false,"source":"BRAN","target":"VARYS","weight":8},{"directed":false,"source":"BRONN","target":"SAM","weight":8},{"directed":false,"source":"GENDRY","target":"PODRICK","weight":8},{"directed":false,"source":"GILLY","target":"SANSA","weight":8},{"directed":false,"source":"GILLY","target":"TYRION","weight":8},{"directed":false,"source":"GILLY","target":"VARYS","weight":8},{"directed":false,"source":"HOUND","target":"MELISANDRE","weight":8},{"directed":false,"source":"HOUND","target":"SAM","weight":8},{"directed":false,"source":"NIGHT_KING","target":"THEON","weight":8},{"directed":false,"source":"PODRICK","target":"SAM","weight":8},{"directed":false,"source":"ARYA","target":"TORMUND","weight":7},{"directed":false,"source":"BRONN","target":"CRAYAH","weight":7},{"directed":false,"source":"DAENERYS","target":"LYANNA_MORMONT","weight":7},{"directed":false,"source":"GREY_WORM","target":"LYANNA_MORMONT","weight":7},{"directed":false,"source":"GREY_WORM","target":"PODRICK","weight":7},{"directed":false,"source":"JON","target":"RHAEGAR","weight":7},{"directed":false,"source":"LYANNA_MORMONT","target":"TYRION","weight":7},{"directed":false,"source":"ALYS","target":"DAVOS","weight":6},{"directed":false,"source":"ALYS","target":"VARYS","weight":6},{"directed":false,"source":"BRAN","target":"JORAH","weight":6},{"directed":false,"source":"BRAN","target":"MISSANDEI","weight":6},{"directed":false,"source":"BRIENNE","target":"MAESTER_WOLKAN","weight":6},{"directed":false,"source":"BRIENNE","target":"MISSANDEI","weight":6},{"directed":false,"source":"DAENERYS","target":"YOHN_ROYCE","weight":6},{"directed":false,"source":"DAVOS","target":"GILLY","weight":6},{"directed":false,"source":"DAVOS","target":"MAESTER_WOLKAN","weight":6},{"directed":false,"source":"GREY_WORM","target":"HOUND","weight":6},{"directed":false,"source":"GREY_WORM","target":"QHONO","weight":6},{"directed":false,"source":"LITTLE_SAM","target":"SANSA","weight":6},{"directed":false,"source":"LITTLE_SAM","target":"TYRION","weight":6},{"directed":false,"source":"LITTLE_SAM","target":"VARYS","weight":6},{"directed":false,"source":"QHONO","target":"SAM","weight":6},{"directed":false,"source":"SAM","target":"VARYS","weight":6},{"directed":false,"source":"SAM","target":"YOHN_ROYCE","weight":6},{"directed":false,"source":"TORMUND","target":"VARYS","weight":6},{"directed":false,"source":"ALYS","target":"BRAN","weight":5},{"directed":false,"source":"ALYS","target":"DAENERYS","weight":5},{"directed":false,"source":"ALYS","target":"GREY_WORM","weight":5},{"directed":false,"source":"ALYS","target":"JORAH","weight":5},{"directed":false,"source":"ALYS","target":"LYANNA_MORMONT","weight":5},{"directed":false,"source":"ALYS","target":"SANSA","weight":5},{"directed":false,"source":"ARYA","target":"JORAH","weight":5},{"directed":false,"source":"ARYA","target":"MISSANDEI","weight":5},{"directed":false,"source":"BRAN","target":"LYANNA_MORMONT","weight":5},{"directed":false,"source":"BRONN","target":"DIRAH","weight":5},{"directed":false,"source":"BRONN","target":"MAREI","weight":5},{"directed":false,"source":"CERSEI","target":"GREY_WORM","weight":5},{"directed":false,"source":"EDMURE","target":"SANSA","weight":5},{"directed":false,"source":"GENDRY","target":"SANSA","weight":5},{"directed":false,"source":"GREY_WORM","target":"YOHN_ROYCE","weight":5},{"directed":false,"source":"LYANNA_MORMONT","target":"VARYS","weight":5},{"directed":false,"source":"MISSANDEI","target":"MOUNTAIN","weight":5},{"directed":false,"source":"SAM","target":"MAESTER_WOLKAN","weight":5},{"directed":false,"source":"TORMUND","target":"WILLA","weight":5},{"directed":false,"source":"VARYS","target":"MAESTER_WOLKAN","weight":5},{"directed":false,"source":"ALYS","target":"BRIENNE","weight":4},{"directed":false,"source":"ALYS","target":"JAIME","weight":4},{"directed":false,"source":"ALYS","target":"SAM","weight":4},{"directed":false,"source":"ALYS","target":"THEON","weight":4},{"directed":false,"source":"ALYS","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"ARYA","target":"OWEN","weight":4},{"directed":false,"source":"ARYA","target":"QHONO","weight":4},{"directed":false,"source":"ARYA","target":"THEON","weight":4},{"directed":false,"source":"BERIC","target":"LYANNA_MORMONT","weight":4},{"directed":false,"source":"BERIC","target":"SANSA","weight":4},{"directed":false,"source":"BRAN","target":"GENDRY","weight":4},{"directed":false,"source":"BRAN","target":"QHONO","weight":4},{"directed":false,"source":"DAENERYS","target":"PODRICK","weight":4},{"directed":false,"source":"DAENERYS","target":"QHONO","weight":4},{"directed":false,"source":"DAVOS","target":"QHONO","weight":4},{"directed":false,"source":"DAVOS","target":"TEELA","weight":4},{"directed":false,"source":"DORNISH_PRINCE","target":"YARA","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"GREY_WORM","weight":4},{"directed":false,"source":"EDDISON_TOLLETT","target":"JORAH","weight":4},{"directed":false,"source":"EDMURE","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"EURON","target":"HARRY","weight":4},{"directed":false,"source":"EURON","target":"MISSANDEI","weight":4},{"directed":false,"source":"GILLY","target":"MISSANDEI","weight":4},{"directed":false,"source":"GREY_WORM","target":"MAESTER_WOLKAN","weight":4},{"directed":false,"source":"HOUND","target":"NORA","weight":4},{"directed":false,"source":"JAIME","target":"QHONO","weight":4},{"directed":false,"source":"JAIME","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"JON","target":"QHONO","weight":4},{"directed":false,"source":"JORAH","target":"QHONO","weight":4},{"directed":false,"source":"JORAH","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"LYANNA_MORMONT","target":"QHONO","weight":4},{"directed":false,"source":"LYANNA_MORMONT","target":"THEON","weight":4},{"directed":false,"source":"MISSANDEI","target":"SAM","weight":4},{"directed":false,"source":"QHONO","target":"SANSA","weight":4},{"directed":false,"source":"QHONO","target":"TORMUND","weight":4},{"directed":false,"source":"QHONO","target":"VARYS","weight":4},{"directed":false,"source":"ROBIN","target":"MAESTER_WOLKAN","weight":4},{"directed":false,"source":"SAM","target":"THEON","weight":4},{"directed":false,"source":"SANSA","target":"YARA","weight":4},{"directed":false,"source":"VARYS","target":"YOHN_ROYCE","weight":4},{"directed":false,"source":"ALYS","target":"ARYA","weight":3},{"directed":false,"source":"ALYS","target":"MAESTER_WOLKAN","weight":3},{"directed":false,"source":"ALYS","target":"TORMUND","weight":3},{"directed":false,"source":"ARYA","target":"NIGHT_KING","weight":3},{"directed":false,"source":"ARYA","target":"YARA","weight":3},{"directed":false,"source":"BERIC","target":"BRAN","weight":3},{"directed":false,"source":"BERIC","target":"NED_UMBER","weight":3},{"directed":false,"source":"BERIC","target":"THEON","weight":3},{"directed":false,"source":"BERIC","target":"TYRION","weight":3},{"directed":false,"source":"BERIC","target":"VARYS","weight":3},{"directed":false,"source":"BRAN","target":"BRONN","weight":3},{"directed":false,"source":"CRAYAH","target":"MAREI","weight":3},{"directed":false,"source":"CRAYAH","target":"QYBURN","weight":3},{"directed":false,"source":"DIRAH","target":"MAREI","weight":3},{"directed":false,"source":"DORNISH_PRINCE","target":"ROBIN","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"GENDRY","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"HOUND","weight":3},{"directed":false,"source":"EDDISON_TOLLETT","target":"JAIME","weight":3},{"directed":false,"source":"EDMURE","target":"MAESTER_WOLKAN","weight":3},{"directed":false,"source":"EDMURE","target":"RIVERLANDS_LORD","weight":3},{"directed":false,"source":"EDMURE","target":"ROBIN","weight":3},{"directed":false,"source":"EDMURE","target":"SAM","weight":3},{"directed":false,"source":"EDMURE","target":"TYRION","weight":3},{"directed":false,"source":"GENDRY","target":"VALE_LORD","weight":3},{"directed":false,"source":"GENDRY","target":"YOHN_ROYCE","weight":3},{"directed":false,"source":"GREY_WORM","target":"MOUNTAIN","weight":3},{"directed":false,"source":"GREY_WORM","target":"UNSULLIED_CAPTAIN","weight":3},{"directed":false,"source":"HOUND","target":"SARRA","weight":3},{"directed":false,"source":"HOUND","target":"VICKY","weight":3},{"directed":false,"source":"IRONBORN_LORD","target":"VALE_LORD","weight":3},{"directed":false,"source":"IRONBORN_LORD","target":"YARA","weight":3},{"directed":false,"source":"JAIME","target":"MISSANDEI","weight":3},{"directed":false,"source":"LYANNA","target":"VARYS","weight":3},{"directed":false,"source":"LYANNA_MORMONT","target":"MISSANDEI","weight":3},{"directed":false,"source":"MISSANDEI","target":"QYBURN","weight":3},{"directed":false,"source":"NED","target":"RHAEGAR","weight":3},{"directed":false,"source":"NED_UMBER","target":"SANSA","weight":3},{"directed":false,"source":"RHAEGAR","target":"VARYS","weight":3},{"directed":false,"source":"RIVERLANDS_LORD","target":"YOHN_ROYCE","weight":3},{"directed":false,"source":"ROBIN","target":"SAM","weight":3},{"directed":false,"source":"THEON","target":"TORMUND","weight":3},{"directed":false,"source":"ALANNA","target":"OWEN","weight":2},{"directed":false,"source":"ALYS","target":"BERIC","weight":2},{"directed":false,"source":"ALYS","target":"GENDRY","weight":2},{"directed":false,"source":"ALYS","target":"MISSANDEI","weight":2},{"directed":false,"source":"ALYS","target":"QHONO","weight":2},{"directed":false,"source":"ARYA","target":"DORNISH_PRINCE","weight":2},{"directed":false,"source":"ARYA","target":"EDDISON_TOLLETT","weight":2},{"directed":false,"source":"ARYA","target":"EDMURE","weight":2},{"directed":false,"source":"ARYA","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"ARYA","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"ARYA","target":"ROBIN","weight":2},{"directed":false,"source":"ARYA","target":"VALE_LORD","weight":2},{"directed":false,"source":"BERIC","target":"GILLY","weight":2},{"directed":false,"source":"BERIC","target":"PODRICK","weight":2},{"directed":false,"source":"BERIC","target":"QHONO","weight":2},{"directed":false,"source":"BERIC","target":"TEELA","weight":2},{"directed":false,"source":"BERIC","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"BRAN","target":"DORNISH_PRINCE","weight":2},{"directed":false,"source":"BRAN","target":"EDMURE","weight":2},{"directed":false,"source":"BRAN","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"BRAN","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"BRAN","target":"ROBIN","weight":2},{"directed":false,"source":"BRAN","target":"VALE_LORD","weight":2},{"directed":false,"source":"BRAN","target":"YARA","weight":2},{"directed":false,"source":"BRIENNE","target":"DORNISH_PRINCE","weight":2},{"directed":false,"source":"BRIENNE","target":"EDMURE","weight":2},{"directed":false,"source":"BRIENNE","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"BRIENNE","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"BRIENNE","target":"ROBIN","weight":2},{"directed":false,"source":"BRIENNE","target":"VALE_LORD","weight":2},{"directed":false,"source":"BRIENNE","target":"YARA","weight":2},{"directed":false,"source":"CERSEI","target":"CERSEIS_BABY","weight":2},{"directed":false,"source":"CERSEIS_BABY","target":"JAIME","weight":2},{"directed":false,"source":"CERSEIS_BABY","target":"TYRION","weight":2},{"directed":false,"source":"CRAYAH","target":"WILLIAM","weight":2},{"directed":false,"source":"DAENERYS","target":"EDDISON_TOLLETT","weight":2},{"directed":false,"source":"DAENERYS","target":"LYANNA","weight":2},{"directed":false,"source":"DAENERYS","target":"NED_UMBER","weight":2},{"directed":false,"source":"DAVOS","target":"DORNISH_PRINCE","weight":2},{"directed":false,"source":"DAVOS","target":"EDMURE","weight":2},{"directed":false,"source":"DAVOS","target":"HARRY","weight":2},{"directed":false,"source":"DAVOS","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"DAVOS","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"DAVOS","target":"ROBIN","weight":2},{"directed":false,"source":"DAVOS","target":"VALE_LORD","weight":2},{"directed":false,"source":"DAVOS","target":"YARA","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"EDMURE","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"GENDRY","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"GREY_WORM","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"SAM","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"SANSA","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"TYRION","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"VALE_LORD","weight":2},{"directed":false,"source":"DORNISH_PRINCE","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"LYANNA_MORMONT","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"NED_UMBER","weight":2},{"directed":false,"source":"EDDISON_TOLLETT","target":"TEELA","weight":2},{"directed":false,"source":"EDMURE","target":"GENDRY","weight":2},{"directed":false,"source":"EDMURE","target":"GREY_WORM","weight":2},{"directed":false,"source":"EDMURE","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"EDMURE","target":"VALE_LORD","weight":2},{"directed":false,"source":"EDMURE","target":"YARA","weight":2},{"directed":false,"source":"EURON","target":"GREY_WORM","weight":2},{"directed":false,"source":"EURON","target":"VARYS","weight":2},{"directed":false,"source":"GENDRY","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"GENDRY","target":"LYANNA_MORMONT","weight":2},{"directed":false,"source":"GENDRY","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"GENDRY","target":"QHONO","weight":2},{"directed":false,"source":"GENDRY","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"GENDRY","target":"ROBIN","weight":2},{"directed":false,"source":"GENDRY","target":"YARA","weight":2},{"directed":false,"source":"GILLY","target":"PODRICK","weight":2},{"directed":false,"source":"GILLY","target":"TEELA","weight":2},{"directed":false,"source":"GREY_WORM","target":"HARRY","weight":2},{"directed":false,"source":"GREY_WORM","target":"IRONBORN_LORD","weight":2},{"directed":false,"source":"GREY_WORM","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"GREY_WORM","target":"ROBIN","weight":2},{"directed":false,"source":"GREY_WORM","target":"VALE_LORD","weight":2},{"directed":false,"source":"HARRY","target":"JON","weight":2},{"directed":false,"source":"HOUND","target":"WILLA","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"RIVERLANDS_LORD","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"ROBIN","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"SAM","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"SANSA","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"TYRION","weight":2},{"directed":false,"source":"IRONBORN_LORD","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"JAIME","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"JON","target":"TEELA","weight":2},{"directed":false,"source":"JON","target":"UNSULLIED_CAPTAIN","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"MISSANDEI","weight":2},{"directed":false,"source":"LITTLE_SAM","target":"PODRICK","weight":2},{"directed":false,"source":"LYANNA","target":"SAM","weight":2},{"directed":false,"source":"MAESTER_WOLKAN","target":"YARA","weight":2},{"directed":false,"source":"MELISANDRE","target":"QHONO","weight":2},{"directed":false,"source":"MISSANDEI","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"MISSANDEI","target":"PODRICK","weight":2},{"directed":false,"source":"MISSANDEI","target":"QHONO","weight":2},{"directed":false,"source":"MISSANDEI","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"MOUNTAIN","target":"VARYS","weight":2},{"directed":false,"source":"NED_UMBER","target":"TORMUND","weight":2},{"directed":false,"source":"QHONO","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"QHONO","target":"THEON","weight":2},{"directed":false,"source":"QHONO","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"RHAEGAR","target":"SAM","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"ROBIN","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"SAM","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"SANSA","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"TYRION","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"VALE_LORD","weight":2},{"directed":false,"source":"RIVERLANDS_LORD","target":"YARA","weight":2},{"directed":false,"source":"ROBIN","target":"VALE_LORD","weight":2},{"directed":false,"source":"ROBIN","target":"YARA","weight":2},{"directed":false,"source":"SAM","target":"TEELA","weight":2},{"directed":false,"source":"SAM","target":"VALE_LORD","weight":2},{"directed":false,"source":"SAM","target":"YARA","weight":2},{"directed":false,"source":"SANSA","target":"SARRA","weight":2},{"directed":false,"source":"SANSA","target":"VALE_LORD","weight":2},{"directed":false,"source":"SANSA","target":"WILLA","weight":2},{"directed":false,"source":"SARRA","target":"TORMUND","weight":2},{"directed":false,"source":"SARRA","target":"WILLA","weight":2},{"directed":false,"source":"TEELA","target":"TORMUND","weight":2},{"directed":false,"source":"THEON","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"THEON","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"TYRION","target":"VALE_LORD","weight":2},{"directed":false,"source":"VALE_LORD","target":"MAESTER_WOLKAN","weight":2},{"directed":false,"source":"VALE_LORD","target":"YARA","weight":2},{"directed":false,"source":"VALE_LORD","target":"YOHN_ROYCE","weight":2},{"directed":false,"source":"YARA","target":"YOHN_ROYCE","weight":2}]}');var Io=h(5114);class gI{constructor(){this.attrs=[],this._parent=null}clearAttr(){this.attrs=[]}setAttr(e,t){this.attrs[e]=t}getAttr(e){return this.attrs[e]}get parent(){return this._parent}set parent(e){this._parent=e}*getAncestors(){let e=this.parent;for(;null!=e;)yield e,e=e.parent}isDescendantOf(e){for(const t of this.getAncestors())if(t==e)return!0;return!1}}var Po=(()=>{return(i=Po||(Po={}))[i.None=0]="None",i[i.FromAncestor=1]="FromAncestor",i[i.ToAncestor=2]="ToAncestor",Po;var i})();class pI extends gI{constructor(e,t){super(),this.source=e,this.target=t,e!=t?(e.outEdges.add(this),t.inEdges.add(this)):e.selfEdges.add(this)}add(){this.source!=this.target?(this.source.outEdges.add(this),this.target.inEdges.add(this)):this.source.selfEdges.add(this)}remove(){this.source!=this.target?(this.source.outEdges.delete(this),this.target.inEdges.delete(this)):this.source.selfEdges.delete(this)}toString(){return"("+this.source.toString()+"->"+this.target.toString()+")"}isInterGraphEdge(){return this.source.parent!=this.target.parent}EdgeToAncestor(){return this.source instanceof Ki&&this.target.isDescendantOf(this.source)?Po.FromAncestor:this.target instanceof Ki&&this.source.isDescendantOf(this.target)?Po.ToAncestor:Po.None}}class Sf{static assert(e,t=null){if(!e)throw null!=t?(console.log(t),new Error(t)):new Error("condition does not hold")}}class mI extends gI{constructor(e){super(),this.inEdges=new Set,this.outEdges=new Set,this.selfEdges=new Set,this.id=e}get id(){return this._id}set id(e){this._id=e}toString(){return this.id}*_edges(){for(const e of this.inEdges)yield e;for(const e of this.outEdges)yield e;for(const e of this.selfEdges)yield e}addInEdge(e){Sf.assert(null!=e),Sf.assert(e.target==this),this.inEdges.add(e)}addOutEdge(e){this.outEdges.add(e)}addSelfEdge(e){this.selfEdges.add(e)}addEdde(e){if(this==e.source)e.target==this?this.addSelfEdge(e):this.addOutEdge(e);else{if(this!=e.target)throw new Error("attaching an edge to non adjacent node");this.addInEdge(e)}return e}get edges(){return this._edges()}get outDegree(){return this.outEdges.size}get inDegree(){return this.inEdges.size}get selfDegree(){return this.selfEdges.size}get degree(){return this.outDegree+this.inDegree+this.selfDegree}*getAncestors(){let e=this.parent;for(;null!=e;)yield e,e=e.parent}isUnderCollapsedGraph(){return null!=this.parent&&this.parent.isCollapsed}}class f3{constructor(){this.nodeMap=new Map}*nodes_(){for(const e of this.nodeMap.values())yield e}*graphs_(){for(const e of this.nodes_())e instanceof Ki&&(yield e)}find(e){return this.nodeMap.get(e)}get nodesShallow(){return this.nodes_()}*nodesDeep(){for(const e of this.nodes_())if(yield e,e instanceof Ki)for(const t of e.nodeCollection.nodesDeep())yield t}get graphs(){return this.graphs_()}*_edges(){for(const e of this.nodeMap.values()){for(const t of e.outEdges)yield t;for(const t of e.selfEdges)yield t}}interGraphEdges(){throw new Error("not implemented")}hasNode(e){if(this.nodeMap.has(e))return!0;for(const t of this.nodeMap)if(t[1]instanceof Ki&&t[1].nodeCollection.hasNode(e))return!0;return!1}getNode(e){let t=this.nodeMap.get(e);if(null!=t)return t;for(const n of this.nodeMap)if(n[1]instanceof Ki&&(t=n[1].nodeCollection.getNode(e),null!=t))return t}get nodeShallowCount(){return this.nodeMap.size}get nodeDeepCount(){let e=this.nodeMap.size;for(const t of this.nodeMap.values())t instanceof Ki&&(e+=t.nodeCollection.nodeDeepCount);return e}get edgeCount(){let e=0;for(const t of this.nodeMap.values())e+=t.outDegree+t.selfDegree;return e}get edges(){return this._edges()}addNode(e){null==this.getNode(e.id)&&this.nodeMap.set(e.id,e)}addEdge(e){this.addNode(e.source),this.addNode(e.target),e.source!=e.target?(e.source.outEdges.add(e),e.target.inEdges.add(e)):e.source.selfEdges.add(e)}removeNode(e){for(const t of e.outEdges)t.target.inEdges.delete(t);for(const t of e.inEdges)t.source.outEdges.delete(t);this.nodeMap.delete(e.id);for(const t of this.nodeMap.values())t instanceof Ki&&t.nodeCollection.nodeMap.delete(e.id)}nodeIsConsistent(e){for(const t of e.outEdges)if(t.source!=e||t.source==t.target||!this.nodeMap.has(t.target.id))return!1;for(const t of e.inEdges)return!(t.target!=e||t.source==t.target||!this.nodeMap.has(t.source.id));for(const t of e.selfEdges)if(t.target!=t.source||t.source==e)return!1;return!0}isConsistent(){for(const e of this.nodeMap)if(!this.nodeIsConsistent(e[1]))return!1;return!0}}class Ki extends mI{constructor(e="__graph__"){super(e),this.isCollapsed=!1,this.nodeCollection=new f3}*graphs(){for(const e of this.nodeCollection.graphs)yield e}noEmptySubgraphs(){for(const e of this.subgraphs())if(0==e.shallowNodeCount)return!1;return!0}hasSubgraphs(){for(const e of this.shallowNodes)if(e instanceof Ki)return!0;return!1}*subgraphs(){for(const e of this.deepNodes)e instanceof Ki&&(yield e)}isEmpty(){return 0==this.shallowNodeCount}setEdge(e,t){const n=this.nodeCollection.find(e);if(null==n)return;const r=this.nodeCollection.find(t);if(null==r)return;const s=new pI(n,r);return this.addEdge(s),s}get shallowNodes(){return this.nodeCollection.nodesShallow}get deepNodes(){return this.nodeCollection.nodesDeep()}findNode(e){return this.nodeCollection.find(e)}get edges(){return this.nodeCollection.edges}*deepEdges(){for(const e of this.deepNodes){for(const t of e.outEdges)yield t;for(const t of e.selfEdges)yield t}}isConsistent(){return this.nodeCollection.isConsistent()}nodeIsConsistent(e){return this.nodeCollection.nodeIsConsistent(e)}removeNode(e){this.nodeCollection.removeNode(e)}addNode(e){return e.parent=this,this.nodeCollection.addNode(e),e}addEdge(e){this.nodeCollection.addEdge(e)}get shallowNodeCount(){return this.nodeCollection.nodeShallowCount}get nodeCountDeep(){return this.nodeCollection.nodeDeepCount}get edgeCount(){return this.nodeCollection.edgeCount}liftNode(e){for(;null!=e&&e.parent!=this;)e=e.parent;return e}}let Lu=(()=>{class i{static solve(t,n,r,s,o,a){const l=t*o-s*n;if(!(Math.abs(l)<i.eps))return{x:(r*o-a*n)/l,y:(t*a-s*r)/l}}}return i.eps=1e-8,i})();class q{static RoundPoint(e){return new x(q.RoundDouble(e.x),q.RoundDouble(e.y))}static RoundDouble(e){return Math.round(e*q.mult)/q.mult}}function Vt(i,e){const t=i-e;return t<0?-1:0==t?0:1}function Af(i,e){return Vt(i.y,e.y)||Vt(i.x,e.x)}function ht(i,e){const t=i-e;return-q.distanceEpsilon<=t&&t<=q.distanceEpsilon}function CE(i,e){return Hl(i,e)>0}function Hl(i,e){const t=i-e;return t<=-q.distanceEpsilon?-1:t>=q.distanceEpsilon?1:0}q.distanceEpsilonPrecision=6,q.mult=Math.pow(10,6),q.defaultLeafBoxesOffset=.5,q.lineSegmentThreshold=.05,q.intersectionEpsilon=1e-4,q.distanceEpsilon=Math.pow(10,-q.distanceEpsilonPrecision),q.squareOfDistanceEpsilon=Math.pow(10,2*-q.distanceEpsilonPrecision),q.tolerance=1e-8;var Ie=(()=>{return(i=Ie||(Ie={}))[i.Clockwise=0]="Clockwise",i[i.Counterclockwise=1]="Counterclockwise",i[i.Collinear=2]="Collinear",Ie;var i})();function It(i,e){return i.sub(e).length}class x{constructor(e,t){this.x_=e,this.y_=t}static ProjectionToLine(e,t,n){let r=t.sub(e);const s=r.length;if(s<q.distanceEpsilon)return e;r=r.div(s);const o=n.sub(e).dot(r);return e.add(r.mul(o))}static RayIntersectsRayInteriors(e,t,n,r){const s=x.lineLineIntersection(e,e.add(t),n,n.add(r));if(s&&s.sub(e).dot(t.div(t.l1))>q.distanceEpsilon&&s.sub(n).dot(r.div(r.l1))>q.distanceEpsilon)return s}static IntervalIntersectsRay(e,t,n,r){const s=x.lineLineIntersection(e,t,n,n.add(r));if(!s)return;const o=e.sub(s),a=s.sub(t);return!(o.dot(a)<=0)&&!(s.sub(n).dot(r)<0)&&o.dot(o)>q.squareOfDistanceEpsilon&&a.dot(a)>=q.squareOfDistanceEpsilon?s:void 0}static PointToTheLeftOfLineOrOnLine(e,t,n){return x.signedDoubledTriangleArea(e,t,n)>=0}static PointToTheLeftOfLine(e,t,n){return x.signedDoubledTriangleArea(e,t,n)>0}static PointIsInsideCone(e,t,n,r){return x.PointToTheRightOfLineOrOnLine(e,t,n)&&x.PointToTheLeftOfLineOrOnLine(e,t,r)}static PointToTheRightOfLineOrOnLine(e,t,n){return x.signedDoubledTriangleArea(t,n,e)<=0}static PointToTheRightOfLine(e,t,n){return x.signedDoubledTriangleArea(t,n,e)<0}static closeIntersections(e,t){return x.close(e,t,q.intersectionEpsilon)}get l1(){return Math.abs(this.x_)+Math.abs(this.y_)}dot(e){return this.x*e.x+this.y*e.y}get x(){return this.x_}get y(){return this.y_}compareTo(e){const t=Vt(this.x,e.x);return 0!=t?t:Vt(this.y,e.y)}toString(){return"("+this.x+","+this.y+")"}static close(e,t,n){return e.sub(t).length<=n}static closeSquare(e,t,n){const r=t.sub(e);return r.dot(r)<=n}static closeDistEps(e,t,n=q.distanceEpsilon){return e.sub(t).length<=n}normalize(){const e=this.length;return new x(this.x/e,this.y/e)}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}get lengthSquared(){return this.x*this.x+this.y*this.y}static middle(e,t){return e.add(t).div(2)}scale(e,t){return new x(this.x*e,this.y*t)}add(e){return new x(this.x+e.x,this.y+e.y)}sub(e){return new x(this.x-e.x,this.y-e.y)}mul(e){return new x(this.x*e,this.y*e)}div(e){return new x(this.x/e,this.y/e)}equal(e){return e.x==this.x&&e.y==this.y}neg(){return new x(-this.x,-this.y)}static lineLineIntersection(e,t,n,r){const s=t.sub(e),o=n.sub(r),a=n.sub(e),l=Lu.solve(s.x,o.x,a.x,s.y,o.y,a.y);if(null!=l)return e.add(s.mul(l.x))}static segSegIntersection(e,t,n,r){const s=t.sub(e),o=n.sub(r),a=n.sub(e),l=q.tolerance,c=Lu.solve(s.x,o.x,a.x,s.y,o.y,a.y);if(null!=c&&c.x>-l&&c.x<1+l&&c.y>-l&&c.y<1+l)return e.add(s.mul(c.x))}static parallelWithinEpsilon(e,t,n){const r=e.length,s=t.length;return r<n||s<n||(e=e.div(r),t=t.div(s),Math.abs(-e.x*t.y+e.y*t.x)<n)}static crossProduct(e,t){return e.x*t.y-e.y*t.x}static dot(e,t){return e.x*t.x+e.y*t.y}static add(e,t){return e.add(t)}rotate90Ccw(){return new x(-this.y,this.x)}rotate90Cw(){return new x(this.y,-this.x)}clone(){return new x(this.x,this.y)}rotate(e){const t=Math.cos(e),n=Math.sin(e);return new x(t*this.x-n*this.y,n*this.x+t*this.y)}static mkPoint(e,t,n,r){return t.mul(e).add(r.mul(n))}static convSum(e,t,n){return t.add(n.sub(t).mul(e))}static anglePCP(e,t,n){return x.angle(e.sub(t),n.sub(t))}static angle(e,t){const n=e.x,r=e.y,s=t.x,o=t.y,a=n*o-r*s,l=n*s+r*o;if(Math.abs(l)<q.tolerance)return Math.abs(a)<q.tolerance?0:a<-q.tolerance?3*Math.PI/2:Math.PI/2;if(Math.abs(a)<q.tolerance)return l<-q.tolerance?Math.PI:0;const c=Math.atan2(a,l);return a>=-q.tolerance?c:2*Math.PI+c}static signedDoubledTriangleArea(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}static getTriangleOrientation(e,t,n){const r=x.signedDoubledTriangleArea(e,t,n);return r>q.distanceEpsilon?Ie.Counterclockwise:r<-q.distanceEpsilon?Ie.Clockwise:Ie.Collinear}static getTriangleOrientationWithIntersectionEpsilon(e,t,n){const r=x.signedDoubledTriangleArea(e,t,n);return r>q.intersectionEpsilon?Ie.Counterclockwise:r<-q.intersectionEpsilon?Ie.Clockwise:Ie.Collinear}static ClosestPointAtLineSegment(e,t,n){const r=n.sub(t),s=e.sub(t),o=r.dot(s),a=r.dot(r);return o<=0+q.tolerance?t:a<=o+q.tolerance?n:t.add(r.mul(o/a))}static pointToTheLeftOfLineOrOnLine(e,t,n){return x.signedDoubledTriangleArea(e,t,n)>=0}static pointToTheLeftOfLine(e,t,n){return x.signedDoubledTriangleArea(e,t,n)>0}static pointToTheRightOfLineOrOnLine(e,t,n){return x.signedDoubledTriangleArea(t,n,e)<=0}static pointToTheRightOfLine(e,t,n){return x.signedDoubledTriangleArea(t,n,e)<0}static canProject(e,t,n){const r=n.sub(t);return!(e.sub(t).dot(r)<0||e.sub(n).dot(r)>0)}static distToLineSegment(e,t,n){const r=n.sub(t),s=e.sub(t);let o,a;if((o=r.dot(s))<=q.tolerance)return{par:0,dist:s.length};if((a=r.dot(r))<=o+q.tolerance)return{par:1,dist:e.sub(n).length};const l=o/a;return{par:l,dist:t.add(r.mul(l)).length}}}class $i{constructor(){this._next=null,this.prev=null}get point(){return this._point}set point(e){this._point=e}get next(){return this._next}set next(e){this._next=e}get nextOnPolyline(){return this.polyline.next(this)}get prevOnPolyline(){return this.polyline.prev(this)}getNext(){return this.next}setNext(e){this.next=e,null!=this.polyline&&this.polyline.setInitIsRequired()}getPrev(){return this.prev}setPrev(e){this.prev=e,null!=this.polyline&&this.polyline.setInitIsRequired()}static mkFromPoint(e){const t=new $i;return t.point=e,t}}var ws=(()=>{return(i=ws||(ws={}))[i.Corner=0]="Corner",i[i.VertexA=1]="VertexA",i[i.otherCorner=2]="otherCorner",i[i.VertexB=3]="VertexB",ws;var i})();class Et{contains(e){const t=e.sub(this.corner),n=q.distanceEpsilon,r=t.dot(this.bRot);if(r>this.abRot+n||r<-n)return!1;const s=t.dot(this.aRot);return s<=this.baRot+n&&s>=-n}get area(){return Math.abs(this.a.x*this.b.y-this.a.y*this.b.x)}vertex(e){switch(e){case ws.Corner:return this.corner;case ws.VertexA:return this.aPlusCorner;case ws.otherCorner:return this.otherCorner;case ws.VertexB:return this.bPlusCorner;default:return}}static parallelogramOfTwo(e,t){const n=new Et,r=e.corner,s={minx:r.x,maxx:r.x,miny:r.y,maxy:r.y};return Et.pumpMinMax(s,e.aPlusCorner),Et.pumpMinMax(s,e.otherCorner),Et.pumpMinMax(s,e.bPlusCorner),Et.pumpMinMax(s,t.corner),Et.pumpMinMax(s,t.aPlusCorner),Et.pumpMinMax(s,t.otherCorner),Et.pumpMinMax(s,t.bPlusCorner),n.corner=new x(s.minx,s.miny),n.a=new x(0,s.maxy-s.miny),n.b=new x(s.maxx-s.minx,0),n.aPlusCorner=n.a.add(n.corner),n.otherCorner=n.b.add(n.aPlusCorner),n.bPlusCorner=n.b.add(n.corner),n.aRot=new x(-n.a.y,n.a.x),n.aRot.length>.5&&(n.aRot=n.aRot.normalize()),n.bRot=new x(-n.b.y,n.b.x),n.bRot.length>.5&&(n.bRot=n.bRot.normalize()),n.abRot=n.a.dot(n.bRot),n.baRot=n.b.dot(n.aRot),n.abRot<0&&(n.abRot=-n.abRot,n.bRot=n.bRot.neg()),n.baRot<0&&(n.baRot=-n.baRot,n.aRot=n.aRot.neg()),n.isSeg=n.a.sub(n.b).length<q.distanceEpsilon,n}static pumpMinMax(e,t){t.x<e.minx?e.minx=t.x:t.x>e.maxx&&(e.maxx=t.x),t.y<e.miny?e.miny=t.y:t.y>e.maxy&&(e.maxy=t.y)}static intersect(e,t){return 0!=!(Et.separByA(e,t)||Et.separByA(t,e)||Et.separByB(e,t)||Et.separByB(t,e))&&(!(e.isSeg&&t.isSeg&&x.parallelWithinEpsilon(e.otherCorner.sub(e.corner),t.otherCorner.sub(t.corner),1e-5))||Et.ParallelSegsIntersect(t,e))}static ParallelSegsIntersect(e,t){const n=e.corner,s=t.corner,o=t.otherCorner,a=e.otherCorner.sub(n),c=a.dot(a);let u=s.sub(n).dot(a),y=o.sub(n).dot(a);if(u>y){const R=u;u=y,y=R}return!(y<0-q.distanceEpsilon||u>c+q.distanceEpsilon)}static separByB(e,t){const n=q.distanceEpsilon,r=t.vertex(0).sub(e.corner).dot(e.bRot),s=[ws.VertexA,ws.otherCorner,ws.VertexB];if(r>e.abRot+n){for(const o of s)if(t.vertex(o).sub(e.corner).dot(e.bRot)<=e.abRot+n)return!1;return!0}if(r<-n){for(const o of s)if(t.vertex(o).sub(e.corner).dot(e.bRot)>=-n)return!1;return!0}return!1}static separByA(e,t){const n=q.distanceEpsilon;let r=t.corner.sub(e.corner);const s=x.dot(r,e.aRot);return s>e.baRot+n?(r=t.aPlusCorner.sub(e.corner),!(x.dot(r,e.aRot)<=e.baRot+n||(r=t.bPlusCorner.sub(e.corner),x.dot(r,e.aRot)<=e.baRot+n)||(r=t.otherCorner.sub(e.corner),x.dot(r,e.aRot)<=e.baRot+n))):s<-n&&(r=t.aPlusCorner.sub(e.corner),!(x.dot(r,e.aRot)>=-n||(r=t.bPlusCorner.sub(e.corner),x.dot(r,e.aRot)>=-n)||(r=t.otherCorner.sub(e.corner),x.dot(r,e.aRot)>=-n)))}static parallelogramByCornerSideSide(e,t,n){const r=new Et;return r.corner=e,r.a=t,r.b=n,r.aRot=new x(-t.y,t.x),r.aRot.length>.5&&(r.aRot=r.aRot.normalize()),r.bRot=new x(-n.y,n.x),r.bRot.length>.5&&(r.bRot=r.bRot.normalize()),r.abRot=r.bRot.dot(t),r.baRot=n.dot(r.aRot),r.abRot<0&&(r.abRot=-r.abRot,r.bRot=r.bRot.neg()),r.baRot<0&&(r.baRot=-r.baRot,r.aRot=r.aRot.neg()),r.isSeg=t.sub(n).length<q.distanceEpsilon,r.aPlusCorner=t.add(e),r.otherCorner=n.add(r.aPlusCorner),r.bPlusCorner=n.add(e),r}static getParallelogramOfAGroup(e){let t=0,n=0,r=0,s=0,o=!0;for(const a of e){const l=m3(a);for(const c of l){const u=c.x,y=c.y;o?(o=!1,t=n=u,r=s=y):(u<t?t=u:u>n&&(n=u),y<r?r=y:y>s&&(s=y))}}return Et.parallelogramByCornerSideSide(new x(t,r),new x(0,s-r),new x(n-t,0))}}function*m3(i){yield i.corner,yield i.aPlusCorner,yield i.otherCorner,yield i.bPlusCorner}class me{constructor(e,t,n,r){this.parStart=0,this.parEnd=1,this.start=new x(e,t),this.end=new x(n,r)}offsetCurve(e,t){return null}trim(e,t){if((e=Math.max(this.parStart,e))>(t=Math.min(this.parEnd,t)))throw"wrong params in trimming";const n=this.value(e),r=this.value(t);return x.close(n,r,q.distanceEpsilon)?null:me.mkPP(n,r)}value(e){return this.start.add(this.end.sub(this.start).mul(e))}trimWithWrap(e,t){return null}pNodeOverICurve(){const e=this.end.sub(this.start).mul(.5);return{parallelogram:Et.parallelogramByCornerSideSide(this.start,e,e),seg:this,leafBoxesOffset:0,node:{low:0,high:1,chord:this}}}normal(){let e=this.start.sub(this.end);return e=e.div(e.length),new x(-e.y,e.x)}static mkPP(e,t){return new me(e.x,e.y,t.x,t.y)}static mkLinePXY(e,t,n){return new me(e.x,e.y,t,n)}derivative(e){return this.end.sub(this.start)}secondDerivative(e){return new x(0,0)}thirdDerivative(e){return new x(0,0)}reverse(){return me.mkPP(this.end,this.start)}translate(e){this.start=this.start.add(e),this.end=this.end.add(e)}scaleFromOrigin(e,t){return me.mkPP(this.start.scale(e,t),this.end.scale(e,t))}getParameterAtLength(e){const t=this.end.sub(this.start).length;if(t<q.tolerance)return 0;const n=e/t;return n>1?1:n<0?0:n}transform(e){return me.mkPP(e.multiplyPoint(this.start),e.multiplyPoint(this.end))}closestParameterWithinBounds(e,t,n){let r=this.closestParameter(e);return r<t&&(r=t),r>n&&(r=n),r}lengthPartial(e,t){return this.value(t).sub(this.value(e)).length}get length(){return this.start.sub(this.end).length}get boundingBox(){return De.mkPP(this.start,this.end)}clone(){return me.mkPP(this.start.clone(),this.end.clone())}static closestParameterOnLineSegment(e,t,n){const r=n.sub(t),s=e.sub(t),o=r.dot(s);if(o<=0+q.tolerance)return 0;const a=r.dot(r);return a<=o+q.tolerance?1:o/a}closestParameter(e){return me.closestParameterOnLineSegment(e,this.start,this.end)}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}static IntersectPPPP(e,t,n,r){const s=x.lineLineIntersection(e,t,n,r);if(null!=s&&me.xIsBetweenPoints(e,t,s)&&me.xIsBetweenPoints(n,r,s))return s}static xIsBetweenPoints(e,t,n){return e.sub(n).dot(t.sub(n))<=q.distanceEpsilon}curvature(e){return 0}curvatureDerivative(e){return 0}curvatureSecondDerivative(e){return 0}static minDistBetweenLineSegments(e,t,n,r){const s=t.sub(e),o=r.sub(n),a=e.sub(n),l=x.crossProduct(s,o),c=s.dot(s),u=s.dot(o),y=o.dot(o),R=s.dot(a),D=o.dot(a);let L,k;const W=Math.abs(l);let X=W,ne=W;W<q.tolerance?(L=0,X=1,k=D,ne=y):(L=x.crossProduct(o,a),k=x.crossProduct(s,a),l<0&&(L=-L,k=-k),L<0?(L=0,k=D,ne=y):L>X&&(L=X=1,k=D+u,ne=y)),k<0?(k=0,-R<0?L=0:-R>c?L=X:(L=-R,X=c)):k>ne&&(k=ne=1,-R+u<0?L=0:-R+u>c?L=X:(L=-R+u,X=c));const ce=Math.abs(L)<q.tolerance?0:L/X,Ae=Math.abs(k)<q.tolerance?0:k/ne;return{parab:ce,parcd:Ae,dist:a.add(s.mul(ce).sub(o.mul(Ae))).length}}}class hn{static distToSegm(e,t,n){const r=n.sub(t);if(r.length<q.intersectionEpsilon)return e.sub(t.add(n).div(2)).length;let s=new x(-r.y,r.x);return s=s.mul(1/s.length),Math.abs(e.sub(t).dot(s))}static createParallelogramOnSubSeg(e,t,n){let r=n.derivative(e);const s=n.derivative(t),o=new x(-s.y,s.x),a=n.value(e),l=n.value(t),u=l.sub(a).dot(o),y=r.dot(o),R=Math.abs(u)<q.distanceEpsilon;if(R||!(Math.abs(y)<q.distanceEpsilon))return r=r.mul(R?0:u/y),Et.parallelogramByCornerSideSide(a,r,l.sub(a).sub(r))}static createParallelogramNodeForCurveSeg(e,t,n,r){if(e==n.parStart&&t==n.parEnd&&x.close(n.start,n.end,q.distanceEpsilon))return hn.createNodeWithSegmentSplit(e,t,n,r);const o=n.value(e),a=n.value(t),l=a.sub(o),c=n.value((e+t)/2);if(hn.distToSegm(c,o,a)<=q.intersectionEpsilon&&l.dot(l)<q.lineSegmentThreshold*q.lineSegmentThreshold&&t-e<q.lineSegmentThreshold){const u=me.mkPP(o,a),y=u.pNodeOverICurve();y.seg=n;const R=y.node;return R.low=e,R.high=t,R.chord=u,y}if(hn.WithinEpsilon(n,e,t,r)){const u=hn.createParallelogramOnSubSeg(e,t,n);if(null!=u)return function y3(i,e,t,n,r){return{parallelogram:t,seg:n,leafBoxesOffset:r,node:{low:i,high:e,chord:null}}}(e,t,u,n,r)}return hn.createNodeWithSegmentSplit(e,t,n,r)}static WithinEpsilon(e,t,n,r){const o=(n-t)/3,a=e.value(t),l=e.value(n);return!(hn.distToSegm(e.value(t+o),a,l)>r)&&hn.distToSegm(e.value(t+2*o),a,l)<=r}static createParallelogramNodeForCurveSegDefaultOffset(e){return hn.createParallelogramNodeForCurveSeg(e.parStart,e.parEnd,e,q.defaultLeafBoxesOffset)}static createNodeWithSegmentSplit(e,t,n,r){const s={parallelogram:null,seg:n,leafBoxesOffset:1,node:{children:[]}},o=s.node;return o.children.push(hn.createParallelogramNodeForCurveSeg(e,.5*(e+t),n,r)),o.children.push(hn.createParallelogramNodeForCurveSeg(.5*(e+t),t,n,r)),s.parallelogram=Et.parallelogramOfTwo(o.children[0].parallelogram,o.children[1].parallelogram),s}}class No{constructor(e,t,n,r,s){this.par0=e,this.par1=t,this.x=n,this.seg0=r,this.seg1=s}}class bf{static closestPoint(e,t,n,r,s){let y,l=n,c=0,u=0,R=!1;do{const D=e.value(l),L=e.derivative(l),k=e.secondDerivative(l),W=L.dot(L)+D.sub(t).dot(k);if(Math.abs(W)<q.tolerance)return l;y=D.sub(t).dot(L.div(W)),l-=y,l>s+q.tolerance?(l=s,u++):l<r-q.tolerance&&(l=r,u++),c++}while(Math.abs(y)>q.tolerance&&!(R=c>=5||u>=5));return R&&e.value(n).sub(t).length<q.distanceEpsilon&&(l=n),l}}class Rt{constructor(e,t,n,r,s){this.parStart=e,this.parEnd=t,this.aAxis=n,this.bAxis=r,this.center=s,this.pNode=null,this.setBoundingBox()}offsetCurve(e,t){const n=t.sub(this.center),r=x.angle(this.aAxis,n);if(this.aAxis.mul(Math.cos(r)).add(this.bAxis.mul(Math.sin(r))).length<n.length){const o=this.aAxis.length,a=this.bAxis.length;return Rt.mkEllipsePPP(this.aAxis.normalize().mul(o+e),this.bAxis.normalize().mul(a+e),this.center)}{const o=this.aAxis.length,a=this.bAxis.length;return Rt.mkEllipsePPP(this.aAxis.normalize().mul(o-e),this.bAxis.normalize().mul(a-e),this.center)}}reverse(){return null}static mkEllipsePPP(e,t,n){return new Rt(0,2*Math.PI,e,t,n)}get start(){return this.value(this.parStart)}get end(){return this.value(this.parEnd)}trim(e,t){return new Rt(Math.max(e,this.parStart),Math.min(t,this.parEnd),this.aAxis,this.bAxis,this.center)}trimWithWrap(e,t){return null}get boundingBox(){return this.box}value(e){return this.center.add(x.mkPoint(Math.cos(e),this.aAxis,Math.sin(e),this.bAxis))}derivative(e){return x.mkPoint(-Math.sin(e),this.aAxis,Math.cos(e),this.bAxis)}secondDerivative(e){return x.mkPoint(-Math.cos(e),this.aAxis,-Math.sin(e),this.bAxis)}thirdDerivative(e){return x.mkPoint(Math.sin(e),this.aAxis,-Math.cos(e),this.bAxis)}pNodeOverICurve(){return null!=this.pNode?this.pNode:this.pNode=hn.createParallelogramNodeForCurveSegDefaultOffset(this)}setBoundingBox(){if(ht(this.parStart,0)&&ht(this.parEnd,2*Math.PI))this.box=this.fullBox();else{let e;this.box=De.mkPP(this.start,this.end);for(let t=Math.ceil(this.parStart/(Math.PI/2));(e=t*Math.PI/2)<this.parEnd;t++)e>this.parStart&&this.box.add(this.value(e))}}static mkEllipse(e,t,n,r,s,o){return new Rt(e,t,n,r,new x(s,o))}static mkFullEllipsePPP(e,t,n){return new Rt(0,2*Math.PI,e,t,n)}static mkFullEllipseNNP(e,t,n){return new Rt(0,2*Math.PI,new x(e,0),new x(0,t),n)}static mkCircle(e,t){return Rt.mkFullEllipseNNP(e,e,t)}translate(e){this.center=this.center.add(e),this.box.center=this.box.center.add(e),this.pNode=null}scaleFromOrigin(e,t){return new Rt(this.parStart,this.parEnd,this.aAxis.mul(e),this.bAxis.mul(t),this.center.scale(e,t))}getParameterAtLength(e){let n=this.parStart,r=this.parEnd;const s=e+.001,o=e-.001;for(;r-n>q.distanceEpsilon;){const a=.5*(r+n),l=this.lengthPartial(this.parStart,a);if(l>s)r=a;else{if(!(l<o))return a;n=a}}return(r+n)/2}transform(e){if(null!=e){const t=e.multiplyPoint(this.aAxis).sub(e.offset()),n=e.multiplyPoint(this.bAxis).sub(e.offset());return new Rt(this.parStart,this.parEnd,t,n,e.multiplyPoint(this.center))}return this}closestParameterWithinBounds(e,t,n){const s=(n-t)/9;let o=t,a=Number.MAX_VALUE;for(let c=0;c<=8;c++){const u=t+c*s,y=e.sub(this.value(u)),R=y.dot(y);R<a&&(a=R,o=u)}0==o&&n==2*Math.PI&&(t=-Math.PI);let l=bf.closestPoint(this,e,o,t,n);return l<0&&(l+=2*Math.PI),l}lengthPartial(e,t){return te.lengthWithInterpolationAndThreshold(this.trim(e,t),q.lineSegmentThreshold/100)}get length(){return te.lengthWithInterpolation(this)}clone(){return new Rt(this.parStart,this.parEnd,this.aAxis.clone(),this.bAxis.clone(),this.center.clone())}closestParameter(e){let t=0;const r=(this.parEnd-this.parStart)/9;let s=this.parStart,o=Number.MAX_VALUE;for(let c=0;c<=8;c++){const u=this.parStart+c*r,y=e.sub(this.value(u)),R=y.dot(y);R<o&&(o=R,s=u)}let a=!1;0==s&&this.parEnd==2*Math.PI&&(a=!0,t=this.parStart,this.parStart=-Math.PI);let l=bf.closestPoint(this,e,s,this.parStart,this.parEnd);return l<0&&(l+=2*Math.PI),a&&(this.parStart=t),l}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}curvature(e){throw"NotImplementedException()"}curvatureDerivative(e){throw"NotImplementedException();"}curvatureSecondDerivative(e){throw"NotImplementedException()"}orientedCounterclockwise(){return x.crossProduct(this.aAxis,this.bAxis)>0}fullBox(){const e=this.aAxis.add(this.bAxis);return De.mkPP(this.center.add(e),this.center.sub(e))}isArc(){return Math.abs(this.aAxis.dot(this.bAxis))<q.tolerance&&Math.abs(this.aAxis.length-this.bAxis.length)<q.tolerance&&x.closeDistEps(this.aAxis.rotate90Ccw(),this.bAxis)}}class E3{constructor(e,t,n,r,s,o,a,l){this.curveA=e,this.curveB=t,this.aMin=n,this.bMin=s,this.aMax=r,this.bMax=o,this.aGuess=a,this.bGuess=l,this.si=a,this.ti=l}initValues(){this.a=this.curveA.value(this.si),this.b=this.curveB.value(this.ti),this.a_b=this.a.sub(this.b),this.ad=this.curveA.derivative(this.si),this.add=this.curveA.secondDerivative(this.si),this.bd=this.curveB.derivative(this.ti),this.bdd=this.curveB.secondDerivative(this.ti)}Fs(){return this.a_b.dot(this.ad)}Fss(){return this.a_b.dot(this.add)+this.ad.dot(this.ad)}Fst(){return-this.bd.dot(this.ad)}Ftt(){return-this.a_b.dot(this.bdd)+this.bd.dot(this.bd)}Ft(){return-this.a_b.dot(this.bd)}delta(e,t,n,r){return e*r-n*t}solve(){let o,e=0,n=0,s=!1;if(this.initValues(),this.curveA instanceof me&&this.curveB instanceof me){let a=this.curveB.derivative(0);a=a.div(a.length);const l=this.curveA.normal(),c=Math.abs(l.dot(a));if(Math.abs(c)<q.distanceEpsilon||this.delta(this.Fss(),this.Fst(),this.Fst(),this.Ftt())<q.tolerance)return this.success=!0,void this.parallelLineSegLineSegMinDist()}do{const a=this.delta(this.Fss(),this.Fst(),this.Fst(),this.Ftt());if(Math.abs(a)<q.tolerance){this.success=!1,s=!0;break}o={s:this.delta(-this.Fs(),this.Fst(),-this.Ft(),this.Ftt())/a,t:this.delta(this.Fss(),-this.Fs(),this.Fst(),-this.Ft())/a};const l=this.si+o.s,c=this.ti+o.t;let u;l>this.aMax+q.distanceEpsilon||l<this.aMin-q.distanceEpsilon||c>this.bMax+q.distanceEpsilon||c<this.bMin-q.distanceEpsilon?(e++,this.chopDsDt(o),this.si+=o.s,this.ti+=o.t,u=!0):(u=!1,this.si=l,this.ti=c,this.si>this.aMax?this.si=this.aMax:this.si<this.aMin&&(this.si=this.aMin),this.ti>this.bMax?this.ti=this.bMax:this.ti<this.bMin&&(this.ti=this.bMin)),this.initValues(),n++,s=e>=10||n>=100||0==o.s&&0==o.t&&u}while((Math.abs(o.s)>=q.tolerance||Math.abs(o.t)>=q.tolerance)&&!s);if(s){const a=this.curveA.value(this.aGuess).sub(this.curveB.value(this.bGuess));if(a.dot(a)<q.distanceEpsilon*q.distanceEpsilon)return this.aSolution=this.aGuess,this.bSolution=this.bGuess,this.aPoint=this.curveA.value(this.aGuess),this.bPoint=this.curveB.value(this.bGuess),void(this.success=!0)}this.aSolution=this.si,this.bSolution=this.ti,this.aPoint=this.a,this.bPoint=this.b,this.success=!s}chopDsDt(e){if(0!=e.s&&0!=e.t){let t=1;this.si+e.s>this.aMax?t=(this.aMax-this.si)/e.s:this.si+e.s<this.aMin&&(t=(this.aMin-this.si)/e.s);let n=1;this.ti+e.t>this.bMax?n=(this.bMax-this.ti)/e.t:this.ti+e.t<this.bMin&&(n=(this.bMin-this.ti)/e.t);const r=Math.min(t,n);e.s*=r,e.t*=r}else 0==e.s?this.ti+e.t>this.bMax?e.t=this.bMax-this.ti:this.ti+e.t<this.bMin&&(e.t=this.bMin-this.ti):this.si+e.s>this.aMax?e.s=this.aMax-this.si:this.si+e.s<this.aMin&&(e.s=this.aMin-this.si)}parallelLineSegLineSegMinDist(){const e=this.curveA,t=this.curveB,n=e.start,r=e.end,s=t.start,o=t.end;let a=r.sub(n);const l=a.length;let u,y,R,c=0;if(l>q.distanceEpsilon){a=a.div(l),u=a.dot(r.sub(n)),y=a.dot(s.sub(n)),R=a.dot(o.sub(n));let D=!1;if(y>R){D=!0;const L=y;y=R,R=L}if(R<c)this.aSolution=0,this.bSolution=D?0:1;else if(y>u)this.aSolution=1,this.bSolution=D?1:0;else{const L=Math.min(u,R);this.aSolution=L/(u-c),this.bSolution=(L-y)/(R-y),D&&(this.bSolution=1-this.bSolution)}}else{let D=o.sub(s);const L=D.length;if(L>q.distanceEpsilon)if(D=D.div(L),c=0,u=D.dot(o.sub(s)),y=D.dot(n.sub(s)),y<c)this.bSolution=0,this.aSolution=1;else if(y>u)this.bSolution=1,this.aSolution=0;else{const k=Math.min(u,y);this.bSolution=k/(u-c),this.aSolution=0}else this.aSolution=0,this.bSolution=0}this.aPoint=this.curveA.value(this.aSolution),this.bPoint=this.curveB.value(this.bSolution)}}class rn{constructor(e,t,n,r){this.b=new Array(4),this.parStart=0,this.parEnd=1,this.b[0]=e,this.b[1]=t,this.b[2]=n,this.b[3]=r,this.c=this.b[1].sub(this.b[0]).mul(3),this.e=this.b[2].sub(this.b[1]).mul(3).sub(this.c),this.l=this.b[3].sub(this.b[0]).sub(this.c).sub(this.e)}leftDerivative(e){return this.derivative(e)}rightDerivative(e){return this.derivative(e)}B(e){return this.b[e]}pNodeOverICurve(){return null!=this.pBoxNode?this.pBoxNode:this.pBoxNode=hn.createParallelogramNodeForCurveSegDefaultOffset(this)}value(e){const t=e*e;return this.l.mul(t*e).add(this.e.mul(t).add(this.c.mul(e)).add(this.b[0]))}static adjustParamTo01(e){return e>1?1:e<0?0:e}trim(e,t){if((e=rn.adjustParamTo01(e))>(t=rn.adjustParamTo01(t)))return this.trim(t,e);if(e>1-q.tolerance)return new rn(this.b[3],this.b[3],this.b[3],this.b[3]);const n=new Array(3),r=new Array(2),s=this.casteljau(e,n,r),o=new rn(s,r[1],n[2],this.b[3]),a=o.casteljau((t-e)/(1-e),n,r);return new rn(o.b[0],n[0],r[0],a)}trimWithWrap(e,t){throw"NotImplementedException()"}casteljau(e,t,n){const r=1-e;for(let s=0;s<3;s++)t[s]=x.mkPoint(r,this.b[s],e,this.b[s+1]);for(let s=0;s<2;s++)n[s]=x.mkPoint(r,t[s],e,t[s+1]);return x.mkPoint(r,n[0],e,n[1])}derivative(e){return this.l.mul(3*e*e).add(this.e.mul(2*e)).add(this.c)}secondDerivative(e){return x.mkPoint(6*e,this.l,2,this.e)}thirdDerivative(e){return this.l.mul(6)}get start(){return this.b[0]}get end(){return this.b[3]}reverse(){return new rn(this.b[3],this.b[2],this.b[1],this.b[0])}translate(e){this.b[0]=this.b[0].add(e),this.b[1]=this.b[1].add(e),this.b[2]=this.b[2].add(e),this.b[3]=this.b[3].add(e),this.c=this.b[1].sub(this.b[0]).mul(3),this.e=this.b[2].sub(this.b[1]).mul(3).sub(this.c),this.l=this.b[3].sub(this.b[0]).sub(this.c).sub(this.e),this.pBoxNode=null}scaleFromOrigin(e,t){return new rn(this.b[0].scale(e,t),this.b[1].scale(e,t),this.b[2].scale(e,t),this.b[3].scale(e,t))}offsetCurve(e,t){return null}lengthPartial(e,t){return this.trim(e,t).length}get length(){return rn.lengthOnControlPolygon(this.b[0],this.b[1],this.b[2],this.b[3])}static lengthOnControlPolygon(e,t,n,r){const s=r.sub(e).length,o=t.sub(e).length+n.sub(t).length+r.sub(n).length;if(o-s>q.lineSegmentThreshold){const a=x.middle(e,t),l=x.middle(t,n),c=x.middle(n,r),u=x.middle(a,l),y=x.middle(c,l),R=x.middle(u,y);return rn.lengthOnControlPolygon(e,a,u,R)+rn.lengthOnControlPolygon(R,y,c,r)}return(o+s)/2}get boundingBox(){const e=De.mkPP(this.b[0],this.b[1]);return e.add(this.b[2]),e.add(this.b[3]),e}transform(e){return new rn(e.multiplyPoint(this.b[0]),e.multiplyPoint(this.b[1]),e.multiplyPoint(this.b[2]),e.multiplyPoint(this.b[3]))}closestParameterWithinBounds(e,t,n){const r=(n-t)/8;let s=0,o=Number.MAX_VALUE;for(let a=0;a<9;a++){const l=e.sub(this.value(a*r+t)),c=l.dot(l);c<o&&(o=c,s=a*r+t)}return bf.closestPoint(this,e,s,t,n)}clone(){return new rn(this.b[0],this.b[1],this.b[2],this.b[3])}static mkBezier(e){return new rn(e[0],e[1],e[2],e[3])}curvature(e){const t=this.G(e);return this.F(e)/t}F(e){return this.Xp(e)*this.Ypp(e)-this.Yp(e)*this.Xpp(e)}G(e){const t=this.Xp(e),n=this.Yp(e),r=t*t+n*n;return Math.sqrt(r*r*r)}Xp(e){return 3*this.l.x*e*e+2*this.e.x*e+this.c.x}Ypp(e){return 6*this.l.y*e+2*this.e.y}Yp(e){return 3*this.l.y*e*e+2*this.e.y*e+this.c.y}Xpp(e){return 6*this.l.x*e+2*this.e.x}Xppp(e){return 6*this.l.x}Yppp(e){return 6*this.l.y}curvatureDerivative(e){const t=this.G(e);return(this.Fp(e)*t-this.Gp(e)*this.F(e))/(t*t)}Fp(e){return this.Xp(e)*this.Yppp(e)-this.Yp(e)*this.Xppp(e)}Fpp(e){return this.Xpp(e)*this.Yppp(e)-this.Ypp(e)*this.Xppp(e)}closestParameter(e){let n=0,r=Number.MAX_VALUE;for(let s=0;s<9;s++){const o=e.sub(this.value(.125*s)),a=o.dot(o);a<r&&(r=a,n=.125*s)}return bf.closestPoint(this,e,n,0,1)}curvatureSecondDerivative(e){const t=this.G(e);return(this.Qp(e)*t-2*this.Q(e)*this.Gp(e))/(t*t*t)}Q(e){return this.Fp(e)*this.G(e)-this.Gp(e)*this.F(e)}Qp(e){return this.Fpp(e)*this.G(e)-this.Gpp(e)*this.F(e)}Gpp(e){const t=this.Xp(e),n=this.Yp(e),r=this.Xpp(e),s=this.Ypp(e),o=this.Xppp(e),a=this.Yppp(e),l=Math.sqrt(t*t+n*n),c=t*r+n*s;return 3*(c*c/l+l*(r*r+t*o+s*s+n*a))}Gp(e){const t=this.Xp(e),n=this.Yp(e),r=this.Xpp(e),s=this.Ypp(e);return 3*Math.sqrt(t*t+n*n)*(t*r+n*s)}getParameterAtLength(e){let t=0,n=1;for(;n-t>q.tolerance;){const r=(n+t)/2,s=this.evaluateError(e,r);if(s>0)n=r;else{if(!(s<0))return r;t=r}}return(t+n)/2}evaluateError(e,t){const n=1-t,r=x.mkPoint(n,this.b[0],t,this.b[1]),s=x.mkPoint(n,this.b[1],t,this.b[2]),o=x.mkPoint(n,this.b[2],t,this.b[3]),a=x.mkPoint(n,r,t,s),l=x.mkPoint(n,s,t,o),c=x.mkPoint(n,a,t,l),u=rn.lengthOnControlPolygon(this.b[0],r,a,c);return u>e+q.distanceEpsilon?1:u<e-q.distanceEpsilon?-1:0}}var We=(()=>{return(i=We||(We={}))[i.Outside=0]="Outside",i[i.Boundary=1]="Boundary",i[i.Inside=2]="Inside",We;var i})();class te{constructor(){this.segs=[],this.parEnd_=0}static CurvesIntersect(e,t){return e==t||null!=te.intersectionOne(e,t,!1)}static lengthWithInterpolationAndThreshold(e,t){throw new Error("not implemented")}static lengthWithInterpolation(e){throw"not implemented"}get parStart(){return 0}get parEnd(){return this.parEnd_}lengthPartial(e,t){this.adjustStartEndEndParametersToDomain({start:e,end:t});const r=this.getSegIndexParam(e),s=this.getSegIndexParam(t);if(r.segIndex<s.segIndex){let o=this.segs[r.segIndex],a=o.lengthPartial(r.par,o.parEnd);for(let l=r.segIndex+1;l<s.segIndex;l++)a+=this.segs[l].length;return o=this.segs[s.segIndex],a+o.lengthPartial(o.parStart,s.par)}throw new Error("not implemented.")}reverse(){const e=new te;for(let t=this.segs.length-1;t>=0;t--)e.addSegment(this.segs[t].reverse());return e}mkCurveWithSegs(e){this.segs=e;for(const t of e)this.parEnd_+=te.paramSpan(t)}get start(){return this.segs[0].start}get end(){return this.segs[this.segs.length-1].end}scaleFromOrigin(e,t){const n=new te;for(const r of this.segs)n.addSegment(r.scaleFromOrigin(e,t));return n}trim(e,t){const n={start:e,end:t};this.adjustStartEndEndParametersToDomain(n);const r=this.getSegIndexParam(n.start),s=this.getSegIndexParam(n.end);if(r.segIndex==s.segIndex)return this.segs[r.segIndex].trim(r.par,s.par);let o=new te;r.par<this.segs[r.segIndex].parEnd&&(o=o.addSegment(this.segs[r.segIndex].trim(r.par,this.segs[r.segIndex].parEnd)));for(let a=r.segIndex+1;a<s.segIndex;a++)o=o.addSegment(this.segs[a]);return this.segs[s.segIndex].parStart<s.par&&(o=o.addSegment(this.segs[s.segIndex].trim(this.segs[s.segIndex].parStart,s.par))),o}translate(e){for(const t of this.segs)t.translate(e);this.pBNode=null}adjustStartEndEndParametersToDomain(e){if(e.start>e.end){const t=e.start;e.start=e.end,e.end=t}e.start<this.parStart&&(e.start=this.parStart),e.end>this.parEnd&&(e.end=this.parEnd)}trimWithWrap(e,t){if(e<t)return this.trim(e,t);const n=new te;return n.addSegment(this.trim(e,this.parEnd)),n.addSegment(this.trim(this.parStart,t)),n}addSegs(e){for(const t of e)this.addSegment(t);return this}addSegment(e){if(null==e)return this;if(e instanceof te)for(const t of e.segs)this.segs.push(t),this.parEnd_+=te.paramSpan(t);else this.segs.push(e),this.parEnd_+=te.paramSpan(e);return this}pNodeOverICurve(){if(null!=this.pBNode)return this.pBNode;const e=[],t=[];for(const n of this.segs){const r=n.pNodeOverICurve();e.push(r.parallelogram),t.push(r)}return this.pBNode={parallelogram:Et.getParallelogramOfAGroup(e),seg:this,leafBoxesOffset:q.defaultLeafBoxesOffset,node:{children:t}},this.pBNode}static intersectionOne(e,t,n){let r=te.curveCurveXWithParallelogramNodesOne(e.pNodeOverICurve(),t.pNodeOverICurve());return n&&null!=r&&(r=te.liftIntersectionToCurves(e,t,r)),r}static getAllIntersections(e,t,n){return e instanceof me?te.getAllIntersectionsOfLineAndICurve(e,t,n):te.getAllIntersectionsInternal(e,t,n)}static getAllIntersectionsInternal(e,t,n){const r=[];if(te.curveCurveXWithParallelogramNodes(e.pNodeOverICurve(),t.pNodeOverICurve(),r),n)for(let s=0;s<r.length;s++)r[s]=te.liftIntersectionToCurves(e,t,r[s]);return r}static getAllIntersectionsOfLineAndICurve(e,t,n){return t instanceof He?te.getAllIntersectionsOfLineAndPolyline(e,t):t instanceof te?te.getAllIntersectionsOfLineAndCurve(e,t,n):t instanceof Rt&&t.isArc()?te.getAllIntersectionsOfLineAndArc(e,t):te.getAllIntersectionsInternal(e,t,n)}static getAllIntersectionsOfLineAndCurve(e,t,n){const r=[],s=e.pNodeOverICurve(),o=t.pNodeOverICurve();if(0==Et.intersect(s.parallelogram,o.parallelogram))return r;let a=0;for(const l of t.segs){const c=te.getAllIntersections(e,l,!1);if(n){for(const u of c)u.par1+=a-l.parStart,u.seg1=t;a+=l.parEnd-l.parStart}for(const u of c)te.alreadyInside(r,u)||r.push(u)}return r}static closeIntersections(e,t){return x.close(e.x,t.x,q.intersectionEpsilon)}static closeIntersectionPoints(e,t){return x.close(e,t,q.intersectionEpsilon)}static alreadyInside(e,t){for(let n=0;n<e.length;n++)if(te.closeIntersections(e[n],t))return!0;return!1}static getAllIntersectionsOfLineAndArc(e,t){let n=e.end.sub(e.start);const r=[],s=n.length;if(s<q.distanceEpsilon){const y=e.start.sub(t.center);if(ht(y.length,t.aAxis.length)){let R=x.angle(t.aAxis,y);t.parStart-q.tolerance<=R&&(R=Math.max(R,t.parStart),R<=t.parEnd+q.tolerance&&(R=Math.min(t.parEnd,R),r.push(new No(0,R,e.start,e,t))))}return r}const o=n.rotate90Ccw().div(s),a=e.start.sub(t.center).dot(o),l=t.center.add(o.mul(a)),c=t.aAxis.length,u=Math.abs(a);if(c<u-q.distanceEpsilon)return r;if(n=o.rotate90Cw(),ht(c,u))te.tryToAddPointToLineCircleCrossing(e,t,r,l,s,n);else{const y=Math.sqrt(c*c-a*a),R=n.mul(y);te.tryToAddPointToLineCircleCrossing(e,t,r,l.add(R),s,n),te.tryToAddPointToLineCircleCrossing(e,t,r,l.sub(R),s,n)}return r}static tryToAddPointToLineCircleCrossing(e,t,n,r,s,o){let l=r.sub(e.start).dot(o);if(l<-q.distanceEpsilon||(l=Math.max(l,0),l>s+q.distanceEpsilon))return;l=Math.min(l,s),l/=s;let c=x.angle(t.aAxis,r.sub(t.center));t.parStart-q.tolerance<=c&&(c=Math.max(c,t.parStart),c<=t.parEnd+q.tolerance&&(c=Math.min(t.parEnd,c),n.push(new No(l,c,r,e,t))))}static getAllIntersectionsOfLineAndPolyline(e,t){const n=[];let r=0,s=t.startPoint;for(;null!=s&&null!=s.getNext();s=s.getNext()){const o=te.crossTwoLineSegs(e.start,e.end,s.point,s.getNext().point,0,1,0,1);null!=o&&(te.adjustSolution(e.start,e.end,s.point,s.getNext().point,o),te.oldIntersection(n,o.x)||n.push(new No(o.aSol,r+o.bSol,o.x,e,t))),r++}if(t.closed){const o=te.crossTwoLineSegs(e.start,e.end,s.point,t.start,0,1,0,1);null!=o&&(te.adjustSolution(e.start,e.end,s.point,t.start,o),te.oldIntersection(n,o.x)||n.push(new No(o.aSol,r+o.bSol,o.x,e,t)))}return n}static adjustSolution(e,t,n,r,s){te.closeIntersectionPoints(s.x,e)?(s.x=e,s.aSol=0):te.closeIntersectionPoints(s.x,t)&&(s.x=t,s.aSol=1),te.closeIntersectionPoints(s.x,n)?(s.x=n,s.bSol=Math.floor(s.bSol)):te.closeIntersectionPoints(s.x,r)&&(s.x=r,s.bSol=Math.ceil(s.bSol))}static curveCurveXWithParallelogramNodesOne(e,t){if(!Et.intersect(e.parallelogram,t.parallelogram))return null;const n=e.node,r=t.node,s=n.hasOwnProperty("children"),o=r.hasOwnProperty("children");if(s&&o)for(const a of n.children)for(const l of r.children){const c=te.curveCurveXWithParallelogramNodesOne(a,l);if(null!=c)return c}else if(o)for(const a of r.children){const l=te.curveCurveXWithParallelogramNodesOne(e,a);if(null!=l)return l}else{if(!s)return te.crossOverIntervalsOne(e,t);for(const a of n.children){const l=te.curveCurveXWithParallelogramNodesOne(a,t);if(null!=l)return l}}return null}static curveCurveXWithParallelogramNodes(e,t,n){if(!Et.intersect(e.parallelogram,t.parallelogram))return;const r=e.node.hasOwnProperty("children"),s=t.node.hasOwnProperty("children");if(r&&s)for(const o of e.node.children)for(const a of t.node.children)te.curveCurveXWithParallelogramNodes(o,a,n);else if(s)for(const o of t.node.children)te.curveCurveXWithParallelogramNodes(e,o,n);else if(r)for(const o of e.node.children)te.curveCurveXWithParallelogramNodes(o,t,n);else n=te.crossOverLeaves(e,t,n)}static crossOverIntervalsOne(e,t){const n=e.node,r=t.node,s=(n.high-n.low)/2,o=(r.high-r.low)/2;for(let a=1;a<2;a++){const l=a*s+n.low;for(let c=1;c<2;c++){const u=c*o+r.low;let y;if(null==n.chord&&null==r.chord?y=te.crossWithinIntervalsWithGuess(e.seg,t.seg,n.low,n.high,r.low,r.high,l,u):null!=n.chord&&null==r.chord?y=te.crossWithinIntervalsWithGuess(n.chord,t.seg,0,1,r.low,r.high,.5*a,u):null==n.chord?(y=te.crossWithinIntervalsWithGuess(e.seg,r.chord,n.low,n.high,0,1,l,.5*c),null!=y&&(y.bSol=r.low+y.bSol*(r.high-r.low))):(y=te.crossWithinIntervalsWithGuess(n.chord,r.chord,0,1,0,1,.5*a,.5*c),null!=y&&(y.aSol=n.low+y.aSol*(n.high-n.low),y.bSol=r.low+y.bSol*(r.high-r.low))),null!=y)return te.createIntersectionOne(e,t,y.aSol,y.bSol,y.x)}}return te.goDeeperOne(e,t)}static crossOverLeaves(e,t,n){const r=e.node,s=t.node;let o=!1;const a=(r.high-r.low)/2+r.low,l=(s.high-s.low)/2+s.low;let c;return null==r.chord&&null==s.chord?c=te.crossWithinIntervalsWithGuess(e.seg,t.seg,r.low,r.high,s.low,s.high,a,l):null!=r.chord&&null==s.chord?(c=te.crossWithinIntervalsWithGuess(r.chord,t.seg,0,1,s.low,s.high,.5,l),null!=c&&(c.aSol=r.low+c.aSol*(r.high-r.low))):null==r.chord?(c=te.crossWithinIntervalsWithGuess(e.seg,s.chord,r.low,r.high,0,1,a,.5),null!=c&&(c.bSol=s.low+c.bSol*(s.high-s.low))):(c=te.crossWithinIntervalsWithGuess(r.chord,s.chord,0,1,0,1,.5,.5),null!=c&&(c.bSol=s.low+c.bSol*(s.high-s.low),c.aSol=r.low+c.aSol*(r.high-r.low))),null!=c&&(te.addIntersection(e,t,n,c),o=!0),o||te.goDeeper(n,e,t),n}static addIntersection(e,t,n,r){const s=e.node;te.closeIntersectionPoints(r.x,e.seg.value(s.low))?(r.x=e.seg.value(s.low),r.aSol=s.low):te.closeIntersectionPoints(r.x,e.seg.value(s.high))&&(r.x=e.seg.value(s.high),r.aSol=s.high);const o=t.node;if(te.closeIntersectionPoints(r.x,t.seg.value(o.low))?(r.x=t.seg.value(o.low),r.bSol=o.low):te.closeIntersectionPoints(r.x,t.seg.value(o.high))&&(r.x=t.seg.value(o.high),r.bSol=o.high),!te.oldIntersection(n,r.x)){const l=new No(r.aSol,r.bSol,r.x,e.seg,t.seg);n.push(l)}}static oldIntersection(e,t){for(const n of e)if(t.sub(n.x).length<100*q.distanceEpsilon)return!0;return!1}static createIntersectionOne(e,t,n,r,s){const o=e.node,a=t.node;return te.closeIntersectionPoints(s,e.seg.value(o.low))?(s=e.seg.value(o.low),n=o.low):te.closeIntersectionPoints(s,e.seg.value(o.high))&&(s=e.seg.value(o.high),n=o.high),te.closeIntersectionPoints(s,t.seg.value(a.low))?(s=t.seg.value(a.low),r=a.low):te.closeIntersectionPoints(s,t.seg.value(a.high))&&(s=t.seg.value(a.high),r=a.high),new No(n,r,s,e.seg,t.seg)}static liftIntersectionToCurves_(e,t,n,r,s,o,a){const l=this.liftParameterToCurve(e,n-o.parStart,o),c=this.liftParameterToCurve(t,r-a.parStart,a);return new No(l,c,s,e,t)}static DropIntersectionToSegs(e){let t,n,r,s;if(e.seg0 instanceof te){const o=e.seg0.getSegParam(e.par0);t=o.seg,n=o.par}else n=e.par0,t=e.seg0;if(e.seg1 instanceof te){const o=e.seg1.getSegParam(e.par1);s=o.par,r=o.seg}else s=e.par1,r=e.seg1;return new No(n,s,e.x,t,r)}static liftIntersectionToCurves(e,t,n){return te.liftIntersectionToCurves_(e,t,n.par0,n.par1,n.x,n.seg0,n.seg1)}static liftParameterToCurve(e,t,n){if(e==n)return t;if(!e.hasOwnProperty("segs"))return;const r=e;let s=0;for(const o of r.segs){if(o==n)return t+s;s+=te.paramSpan(o)}throw"bug in liftParameterToCurve"}static paramSpan(e){return e.parEnd-e.parStart}static goDeeperOne(e,t){const n=e.node,r=t.node;if(e.leafBoxesOffset>q.distanceEpsilon&&t.leafBoxesOffset>q.distanceEpsilon){const a=hn.createParallelogramNodeForCurveSeg(n.low,n.high,e.seg,e.leafBoxesOffset/2),l=hn.createParallelogramNodeForCurveSeg(r.low,r.high,t.seg,t.leafBoxesOffset/2);return te.curveCurveXWithParallelogramNodesOne(a,l)}if(e.leafBoxesOffset>q.distanceEpsilon){const a=hn.createParallelogramNodeForCurveSeg(n.low,n.high,e.seg,e.leafBoxesOffset/2);return te.curveCurveXWithParallelogramNodesOne(a,t)}if(t.leafBoxesOffset>q.distanceEpsilon){const a=hn.createParallelogramNodeForCurveSeg(r.low,r.high,t.seg,t.leafBoxesOffset/2);return te.curveCurveXWithParallelogramNodesOne(e,a)}const s=e.seg.value(n.low),o=e.seg.value(n.high);if(!x.closeDistEps(s,o)){const a=t.seg.value(r.low),l=t.seg.value(r.high);if(!x.closeDistEps(a,l)){const c=e.seg instanceof me?e.seg:me.mkPP(s,o),u=t.seg instanceof me?t.seg:me.mkPP(a,l),y=te.crossWithinIntervalsWithGuess(c,u,0,1,0,1,.5,.5);if(null!=y)return te.adjustParameters(e,c,t,u,y),te.createIntersectionOne(e,t,y.aSol,y.bSol,y.x)}}return null}static goDeeper(e,t,n){const r=t.node,s=n.node;if(t.leafBoxesOffset>q.distanceEpsilon&&n.leafBoxesOffset>q.distanceEpsilon){const o=hn.createParallelogramNodeForCurveSeg(r.low,r.high,t.seg,t.leafBoxesOffset/2),a=hn.createParallelogramNodeForCurveSeg(s.low,s.high,n.seg,n.leafBoxesOffset/2);te.curveCurveXWithParallelogramNodes(o,a,e)}else if(t.leafBoxesOffset>q.distanceEpsilon){const o=hn.createParallelogramNodeForCurveSeg(r.low,r.high,t.seg,t.leafBoxesOffset/2);te.curveCurveXWithParallelogramNodes(o,n,e)}else if(n.leafBoxesOffset>q.distanceEpsilon){const o=hn.createParallelogramNodeForCurveSeg(s.low,s.high,n.seg,n.leafBoxesOffset/2);te.curveCurveXWithParallelogramNodes(t,o,e)}else{const o=t.seg.value(r.low),a=t.seg.value(r.high);if(!x.closeDistEps(o,a)){const l=n.seg.value(s.low),c=n.seg.value(s.high);if(!x.closeDistEps(l,c)){const u=t.seg instanceof me?t.seg:me.mkPP(o,a),y=n.seg instanceof me?n.seg:me.mkPP(l,c),R=te.crossWithinIntervalsWithGuess(u,y,0,1,0,1,.5,.5);null!=R&&(te.adjustParameters(t,u,n,y,R),te.addIntersection(t,n,e,R))}}}}static adjustParameters(e,t,n,r,s){if(t==e.seg||e.seg instanceof He){const o=e.node;s.aSol=o.low+s.aSol*(o.high-o.low)}else s.aSol=e.seg.closestParameter(s.x);if(r==n.seg||n.seg instanceof He){const o=n.node;s.bSol=o.low+s.bSol*(o.high-o.low)}else s.bSol=n.seg.closestParameter(s.x)}getSegParam(e){let t=this.parStart;for(const r of this.segs){const s=t+r.parEnd-r.parStart;if(e>=t&&e<=s)return{par:e-t+r.parStart,seg:r};t=s}const n=this.segs[this.segs.length-1];return{seg:n,par:n.parEnd}}getSegIndexParam(e){let t=0;const n=this.segs.length;for(let s=0;s<n;s++){const o=this.segs[s],a=t+o.parEnd-o.parStart;if(e>=t&&e<=a)return{segIndex:s,par:e-t+o.parStart};t=a}return{segIndex:n-1,par:this.segs[n-1].parEnd}}value(e){return function w3(i){return i.seg.value(i.par)}(this.getSegParam(e))}derivative(e){return function v3(i){return i.seg.derivative(i.par)}(this.getSegParam(e))}secondDerivative(e){return function S3(i){return i.seg.secondDerivative(i.par)}(this.getSegParam(e))}thirdDerivative(e){return function A3(i){return i.seg.thirdDerivative(i.par)}(this.getSegParam(e))}static crossWithinIntervalsWithGuess(e,t,n,r,s,o,a,l){if(e instanceof me&&t instanceof me){const y=te.crossTwoLineSegs(e.start,e.end,t.start,t.end,n,r,s,o);if(null!=y)return y}const c=te.minDistWithinIntervals(e,t,n,r,s,o,a,l);if(null==c)return;const u=c.aX.sub(c.bX);return u.dot(u)>=q.distanceEpsilon?void 0:{aSol:c.aSol,bSol:c.bSol,x:x.middle(c.aX,c.bX)}}static crossTwoLineSegs(e,t,n,r,s,o,a,l){const c=t.sub(e),u=n.sub(r),y=n.sub(e),R=Lu.solve(c.x,u.x,y.x,c.y,u.y,y.y);if(null==R)return;let D=R.x,L=R.y;const k=e.add(c.mul(D));return D<s-q.tolerance||(D=Math.max(D,s),D>o+q.tolerance||(D=Math.min(D,o),L<a-q.tolerance||(L=Math.max(L,a),L>l+q.tolerance)))?void 0:(L=Math.min(L,l),{aSol:D,bSol:L,x:k})}static PointRelativeToCurveLocation(e,t){if(!t.boundingBox.contains(e))return We.Outside;const n=2*t.boundingBox.diagonal,r=Math.PI/180;let s=0;for(let o=13;o<360;o+=13){const a=new x(Math.cos(o*r),Math.sin(o*r)),l=me.mkPP(e,e.add(a.mul(n))),c=this.getAllIntersectionsOfLineAndICurve(l,t,!0);if(te.AllIntersectionsAreGood(c,t)){for(const y of c)if(x.closeDistEps(y.x,e))return We.Boundary;if(c.length%2==1?s++:s--,s>=2)return We.Inside;if(s<=-2)return We.Outside}}return We.Boundary}static AllIntersectionsAreGood(e,t){let r=null;if(t.hasOwnProperty("segs")||t instanceof He&&(r=t.toCurve()),r)for(const s of e)if(!te.RealCut(te.DropIntersectionToSegs(s),r,!1))return!1;return!0}static RealCut(e,t,n){const s=e.seg1,a=e.par1,l=e.x,c=e.seg0.derivative(e.par0).normalize(),u=s.derivative(a).normalize().rotate(Math.PI/2);if(x.closeDistEps(l,s.end)){let R=null;for(let k=0;k<t.segs.length-1;k++)if(t.segs[k]==s){R=t.segs[k+1];break}if(null==R)return!1;const D=c.rotate(Math.PI/2);return!(D.dot(s.derivative(s.parEnd))*D.dot(R.derivative(R.parStart))<q.tolerance)}if(x.closeDistEps(l,s.start)){let R=null;for(let k=t.segs.length-1;k>0;k--)if(t.segs[k]==s){R=t.segs[k-1];break}if(null==R)return!1;const D=c.rotate(Math.PI/2);return!(D.dot(s.derivative(s.parStart))*D.dot(R.derivative(R.parEnd))<q.tolerance)}const y=c.dot(u);return n?y>q.distanceEpsilon:Math.abs(y)>q.distanceEpsilon}static realCutWithClosedCurve(e,t,n){const s=e.seg1,a=e.par1,l=e.x,c=e.seg0.derivative(e.par0).normalize(),u=s.derivative(a).normalize().rotate(Math.PI/2);if(x.closeDistEps(l,s.end)){let R=null;for(let k=0;k<t.segs.length;k++)if(t.segs[k]==s){R=t.segs[(k+1)%t.segs.length];break}if(null==R)throw new Error;const D=c.rotate(Math.PI/2);return!(D.dot(s.derivative(s.parEnd))*D.dot(R.derivative(R.parStart))<q.tolerance)}if(x.closeDistEps(l,s.start)){let R=null;for(let k=0;k<t.segs.length;k++)if(t.segs[k]==s){R=t.segs[k>0?k-1:t.segs.length-1];break}const D=c.rotate(Math.PI/2);return!(D.dot(s.derivative(s.parStart))*D.dot(R.derivative(R.parEnd))<q.tolerance)}const y=c.dot(u);return n?y>q.distanceEpsilon:Math.abs(y)>q.distanceEpsilon}static minDistWithinIntervals(e,t,n,r,s,o,a,l){const c=new E3(e,t,n,r,s,o,a,l);return c.solve(),c.success?{aSol:c.aSolution,bSol:c.bSolution,aX:c.aPoint,bX:c.bPoint}:void 0}offsetCurve(e,t){throw new Error("Method not implemented.")}get boundingBox(){if(0==this.segs.length)return De.mkEmpty();const e=this.segs[0].boundingBox.clone();for(let t=1;t<this.segs.length;t++)e.addRecSelf(this.segs[t].boundingBox);return e}clone(){const e=new te;for(const t of this.segs)e.addSegment(t.clone());return e}getParameterAtLength(e){let t=0;for(const n of this.segs){const r=n.length;if(r>=e)return t+n.getParameterAtLength(e);e-=r,t+=n.parEnd-n.parStart}return this.parEnd}get length(){let e=0;for(const t of this.segs)e+=t.length;return e}transform(e){const t=new te;for(const n of this.segs)t.addSegment(n.transform(e));return t}closestParameterWithinBounds(e,t,n){let r=0,s=Number.MAX_VALUE,o=0;for(const a of this.segs){if(o>n)break;const l=te.paramSpan(a);if(o+l>=t){const u=Math.max(a.parStart,a.parStart+(t-o)),y=Math.min(a.parEnd,a.parStart+(n-o)),R=a.closestParameterWithinBounds(e,u,y),D=e.sub(a.value(R)),L=D.dot(D);L<s&&(r=o+R-a.parStart,s=L)}o+=l}return r}closestParameter(e){let t=0,n=Number.MAX_VALUE,r=0;for(const s of this.segs){const o=s.closestParameter(e),a=e.sub(s.value(o)),l=a.dot(a);l<n&&(t=r+o-s.parStart,n=l),r+=te.paramSpan(s)}return t}static addLineSegment(e,t,n){return e.addSegment(me.mkPP(t,n))}static addLineSegmentCNNP(e,t,n,r){return te.addLineSegment(e,new x(t,n),r)}static addLineSegmentCNNNN(e,t,n,r,s){te.addLineSegment(e,new x(t,n),new x(r,s))}static continueWithLineSegmentNN(e,t,n){te.addLineSegment(e,e.end,new x(t,n))}static continueWithLineSegmentP(e,t){te.addLineSegment(e,e.end,t)}static closeCurve(e){return te.continueWithLineSegmentP(e,e.start),e}leftDerivative(e){const t=this.tryToGetLeftSegment(e);return null!=t?t.derivative(t.parEnd):this.derivative(e)}rightDerivative(e){const t=this.tryToGetRightSegment(e);return null!=t?t.derivative(t.parStart):this.derivative(e)}tryToGetLeftSegment(e){if(Math.abs(e-this.parStart)<q.tolerance)return this.start.equal(this.end)?this.segs[this.segs.length-1]:null;for(const t of this.segs)if(e-=te.paramSpan(t),Math.abs(e)<q.tolerance)return t;return null}tryToGetRightSegment(e){if(Math.abs(e-this.parEnd)<q.tolerance)return this.start==this.end?this.segs[0]:null;for(const t of this.segs){if(Math.abs(e)<q.tolerance)return t;e-=te.paramSpan(t)}return null}static ClosestPoint(e,t){return e.value(e.closestParameter(t))}static CurveIsInsideOther(e,t){if(!t.boundingBox.containsRect(e.boundingBox))return!1;const n=te.getAllIntersections(e,t,!0);if(0==n.length)return te.NonIntersectingCurveIsInsideOther(e,t);if(1==n.length)return e.start.equal(n[0].x)?te.PointRelativeToCurveLocation(e.value((e.parStart+e.parEnd)/2),t)==We.Inside:te.PointRelativeToCurveLocation(e.start,t)==We.Inside;for(const r of te.PointsBetweenIntersections(e,n))if(te.PointRelativeToCurveLocation(r,t)==We.Outside)return!1;return!0}static*PointsBetweenIntersections(e,t){t.sort((a,l)=>a.par0<l.par0?-1:a.par0>l.par0?1:0);for(let a=0;a<t.length-1;a++)yield e.value((t[a].par0+t[a+1].par0)/2);const n=t[t.length-1].par0;let o=n+(e.parEnd-n+(t[0].par0-e.parStart))/2;o>e.parEnd&&(o=e.parStart+(o-e.parEnd)),yield e.value(o)}static NonIntersectingCurveIsInsideOther(e,t){for(let n=e.parStart;n<e.parEnd;n+=.5){const r=te.PointRelativeToCurveLocation(e.value(n),t);if(We.Boundary!=r)return We.Inside==r}return We.Outside!=te.PointRelativeToCurveLocation(e.end,t)}static ClosedCurveInteriorsIntersect(e,t){if(!t.boundingBox.intersects(e.boundingBox))return!1;const n=te.getAllIntersections(e,t,!0);if(0==n.length)return te.NonIntersectingCurveIsInsideOther(e,t)||te.NonIntersectingCurveIsInsideOther(t,e);if(1==n.length)return e.start.equal(n[0].x)?te.PointRelativeToCurveLocation(e.value((e.parStart+e.parEnd)/2),t)!=We.Inside&&t.start.equal(n[0].x)?te.PointRelativeToCurveLocation(t.value((t.parStart+t.parEnd)/2),e)==We.Inside:te.PointRelativeToCurveLocation(t.start,e)==We.Inside:te.PointRelativeToCurveLocation(e.start,t)==We.Inside;for(const r of te.PointsBetweenIntersections(e,n))if(te.PointRelativeToCurveLocation(r,t)==We.Inside)return!0;return!0}curvature(e){const t=this.getSegParam(e);return t.seg.curvature(t.par)}curvatureDerivative(e){throw new Error("Not implemente")}curvatureSecondDerivative(e){throw new Error("Not implemented")}static createBezierSeg(e,t,n,r,s){const o=x.mkPoint(e,n.point,1-e,r.point),a=x.mkPoint(t,s.point,1-t,r.point),l=r.point.mul(2/3);return new rn(o,o.div(3).add(l),l.add(a.div(3)),a)}static createBezierSegN(e,t,n,r){const s=n.mul(r);return new rn(e,e.add(s),t.add(s),t)}static findCorner(e){const t=e.next;if(null==t.next)return;const n=t.next;return null!=n?{b:t,c:n}:void 0}static trimEdgeSplineWithNodeBoundaries(e,t,n,r){let s=n.parStart,o=n.parEnd;null!=e&&(s=te.findNewStart(n,s,e,r)),null!=t&&(o=te.findNewEnd(n,t,r,o));const a=Math.min(s,o),l=Math.max(s,o);return a<l?n.trim(a,l):n}static findNewEnd(e,t,n,r){const s=te.getAllIntersections(e,t,!0);if(0==s.length)return e.parEnd;if(n){r=e.parEnd;for(const o of s)o.par0<r&&(r=o.par0)}else{r=e.parStart;for(const o of s)o.par0>r&&(r=o.par0)}return r}static findNewStart(e,t,n,r){const s=te.getAllIntersections(e,n,!0);if(0!=s.length){if(r){t=e.parStart;for(const o of s)o.par0>t&&(t=o.par0)}else{t=e.parEnd;for(const o of s)o.par0<t&&(t=o.par0)}return t}t=e.parStart}static polylineAroundClosedCurve(e){if(e instanceof Rt)return te.refineEllipse(e);if(e instanceof He)return e;if(e instanceof te&&te.allSegsAreLines(e)){const t=new He;for(const n of e.segs)t.addPoint(n.start);if(t.closed=!0,!t.isClockwise())return t.reverse()}return e.boundingBox.perimeter()}static allSegsAreLines(e){for(const t of e.segs)if(!(t instanceof me))return!1;return!0}static refineEllipse(e){const t=e.boundingBox.perimeter(),n=Math.PI/4,r=e.boundingBox.width,s=e.boundingBox.height,o=Math.sqrt(r*r+s*s),a=[];for(let c=0;c<4;c++){const u=n+c*Math.PI/2,y=e.value(u),R=e.derivative(u).normalize().mul(o),D=me.mkPP(y.sub(R),y.add(R));for(const L of te.getAllIntersections(t,D,!0))a.push(L)}a.sort((c,u)=>c.par0<u.par0?-1:c.par0>u.par0?1:0);const l=new He;return a.forEach(c=>l.addPoint(c.x)),l.closed=!0,l}static polyFromBox(e){const t=new He;return t.addPoint(e.leftTop),t.addPoint(e.rightTop),t.addPoint(e.rightBottom),t.addPoint(e.leftBottom),t.closed=!0,t}}function RE(i,e,t,n,r,s){let o=[];if(function b3(i,e,t,n,r,s){if(r instanceof me)return!0;for(const o of[1/3,.5,2/3])if(0==x.closeSquare(r.value(i*o+t*(1-o)),x.mkPoint(o,e,1-o,n),s))return!1;return!0}(i,e,t,n,r,s))o.push(e),o.push(n);else{const a=.5*(i+t),l=r.value(a);o=RE(i,e,a,l,r,s);const c=RE(a,l,t,n,r,s).slice(1);o=o.concat(c)}return o}class He{constructor(){this.initIsRequired=!0,this.isClosed_=!1}RemoveStartPoint(){const e=this.startPoint.next;e.prev=null,this.startPoint=e,this.setInitIsRequired()}RemoveEndPoint(){const e=this.endPoint.prev;e.next=null,this.endPoint=e,this.setInitIsRequired()}setInitIsRequired(){this.initIsRequired=!0}addPointXY(e,t){this.addPoint(new x(e,t))}isClockwise(){return x.getTriangleOrientation(this.startPoint.point,this.startPoint.next.point,this.startPoint.next.next.point)==Ie.Clockwise}addPoint(e){const t=new $i;t.polyline=this,t.point=e.clone(),null!=this.endPoint?(this.endPoint.next=t,t.prev=this.endPoint,this.endPoint=t):this.startPoint=this.endPoint=t,this.setInitIsRequired()}PrependPoint(e){const t=$i.mkFromPoint(e);t.polyline=this,null!=this.startPoint?x.closeDistEps(e,this.startPoint.point)||(this.startPoint.prev=t,t.next=this.startPoint,this.startPoint=t):(this.endPoint=t,this.startPoint=t),this.setInitIsRequired()}*[Symbol.iterator](){for(let e=this.startPoint;null!=e;e=e.next)yield e.point}*polylinePoints(){for(let e=this.startPoint;null!=e;e=e.next)yield e}*skip(e){for(let t=this.startPoint;null!=t;t=t.next)e>0?e--:yield t}static parallelogramOfLineSeg(e,t){const n=t.sub(e).div(2);return Et.parallelogramByCornerSideSide(e,n,n)}static mkFromPoints(e){const t=new He;for(const n of e)t.addPoint(n);return t}static mkClosedFromPoints(e){const t=He.mkFromPoints(e);return t.closed=!0,t}calculatePbNode(){const e=[],t=[];let n=this.startPoint,r=0;for(;null!=n.next;){const s=He.parallelogramOfLineSeg(n.point,n.next.point);e.push(s),t.push({parallelogram:s,seg:this,leafBoxesOffset:0,node:{low:r,high:r+1,chord:me.mkPP(n.point,n.next.point)}}),n=n.next,r++}if(this.isClosed_){const s=He.parallelogramOfLineSeg(this.endPoint.point,this.startPoint.point);e.push(s),t.push({parallelogram:s,seg:this,leafBoxesOffset:0,node:{low:r,high:r+1,chord:me.mkPP(this.endPoint.point,this.startPoint.point)}})}this.pBNode={parallelogram:Et.getParallelogramOfAGroup(e),seg:this,leafBoxesOffset:0,node:{children:t}}}init(){this.bBox=De.rectangleOnPoint(this.startPoint.point);for(const e of this.skip(1))this.bBox.add(e.point);this.updateCount(),this.calculatePbNode(),this.initIsRequired=!1}updateCount(){this.count_=0;for(let e=this.startPoint;null!=e;e=e.next)this.count_++}get count(){return this.initIsRequired&&this.init(),this.count_}get closed(){return this.isClosed_}set closed(e){this.isClosed_=e}value(e){this.initIsRequired&&this.init();const t=this.getAdjustedParamAndStartEndPoints(e);return x.convSum(t.t,t.a,t.b)}getAdjustedParamAndStartEndPoints(e){let t=this.startPoint;for(;null!=t.next;){if(e<=1)return{a:t.point,b:t.next.point,t:e};t=t.next,e-=1}if(this.closed&&e<=1)return{a:this.endPoint.point,b:this.startPoint.point,t:e};throw new Error("out of the parameter domain")}derivative(e){const t=this.getAdjustedParamAndStartEndPoints(e);return t.b.sub(t.a)}secondDerivative(e){return new x(0,0)}thirdDerivative(e){return new x(0,0)}pNodeOverICurve(){return this.initIsRequired&&this.init(),this.pBNode}get boundingBox(){return this.initIsRequired&&this.init(),this.bBox}get parStart(){return 0}get parEnd(){return this.initIsRequired&&this.init(),this.closed?this.count_:this.count_-1}static polylineFromCurve(e){const t=new He;t.addPoint(e.start);for(const n of e.segs)t.addPoint(n.end);return t.closed=e.start==e.end,t}trim(e,t){let n=this.toCurve();return n=n.trim(e,t),He.polylineFromCurve(n)}trimWithWrap(e,t){throw new Error("Method not implemented.")}translate(e){let t=this.startPoint;for(;t.point=t.point.add(e),t!=this.endPoint;)t=t.getNext();this.setInitIsRequired()}scaleFromOrigin(e,t){throw new Error("Method not implemented.")}get start(){return this.startPoint.point}get end(){return this.endPoint.point}reverse(){const e=new He;e.closed=this.closed;let t=this.endPoint;for(;e.addPoint(t.point),t!=this.startPoint;)t=t.getPrev();return e}offsetCurve(e,t){throw new Error("Method not implemented.")}lengthPartial(e,t){throw new Error("Method not implemented.")}get length(){throw new Error("Method not implemented.")}getParameterAtLength(e){throw new Error("Method not implemented.")}transform(e){const t=new He;for(const n of this.polylinePoints())t.addPoint(e.multiplyPoint(n.point));return t.closed=this.closed,t}closestParameterWithinBounds(e,t,n){throw new Error("Method not implemented.")}closestParameter(e){let t=0,n=Number.MAX_VALUE,r=0,s=this.startPoint;for(;null!=s.next;){const o=me.mkPP(s.point,s.next.point),a=o.closestParameter(e),l=o.value(a).sub(e),c=l.dot(l);c<n&&(n=c,t=a+r),s=s.next,r++}if(this.closed){const o=me.mkPP(this.endPoint.point,this.startPoint.point),a=o.closestParameter(e),l=o.value(a).sub(e);l.dot(l)<n&&(t=a+r)}return t}clone(){const e=new He;e.closed=this.closed;let t=this.startPoint;for(;e.addPoint(t.point),t!=this.endPoint;)t=t.getNext();return e}leftDerivative(e){throw new Error("Method not implemented.")}rightDerivative(e){throw new Error("Method not implemented.")}curvature(e){throw new Error("Method not implemented.")}curvatureDerivative(e){throw new Error("Method not implemented.")}curvatureSecondDerivative(e){throw new Error("Method not implemented.")}next(e){var t;return null!==(t=e.next)&&void 0!==t?t:this.closed?this.startPoint:null}prev(e){var t;return null!==(t=e.prev)&&void 0!==t?t:this.closed?this.endPoint:null}toCurve(){const e=new te;te.addLineSegment(e,this.startPoint.point,this.startPoint.next.point);let t=this.startPoint.next;for(;null!=(t=t.next);)te.continueWithLineSegmentP(e,t.point);return this.closed&&te.continueWithLineSegmentP(e,this.startPoint.point),e}}class Mu{constructor(e,t){this.width=e,this.height=t}pad(e){this.width+=2*e}}class De{constructor(e){this.left_=e.left,this.right_=e.right,this.top_=e.top,this.bottom=e.bottom}static mkSizeCenter(e,t){const n=e.width/2,r=e.height/2;return new De({left:t.x-n,right:t.x+n,bottom:t.y-r,top:t.y+r})}add_rect(e){return this.addRec(e)}contains_point(e){return this.contains(e)}contains_rect(e){return this.containsRect(e)}intersection_rect(e){return this.intersection(e)}intersects_rect(e){return this.intersects(e)}unite(e){return De.rectangleOfTwo(this,e)}contains_point_radius(e,t){return this.containsWithPadding(e,t)}intersects(e){return this.intersectsOnX(e)&&this.intersectsOnY(e)}intersection(e){if(!this.intersects(e)){const o=De.mkEmpty();return o.setToEmpty(),o}const t=Math.max(this.left,e.left),n=Math.min(this.right,e.right),r=Math.max(this.bottom,e.bottom),s=Math.min(this.top,e.top);return new De({left:t,bottom:r,right:n,top:s})}get center(){return this.leftTop.add(this.rightBottom).mul(.5)}set center(e){const t=e.sub(this.center);this.leftTop=this.leftTop.add(t),this.rightBottom=this.rightBottom.add(t)}intersectsOnY(e){return!(e.bottom_>this.top_+q.distanceEpsilon||e.top_<this.bottom_-q.distanceEpsilon)}intersectsOnX(e){return!(e.left>this.right_+q.distanceEpsilon||e.right<this.left_-q.distanceEpsilon)}static mkEmpty(){return new De({left:0,right:-1,bottom:0,top:-1})}get left(){return this.left_}set left(e){this.left_=e}get right(){return this.right_}set right(e){this.right_=e}get top(){return this.top_}set top(e){this.top_=e}get bottom(){return this.bottom_}set bottom(e){this.bottom_=e}get leftBottom(){return new x(this.left_,this.bottom_)}set leftBottom(e){this.left_=e.x,this.bottom=e.y}get rightTop(){return new x(this.right_,this.top_)}set rightTop(e){this.right_=e.x,this.top_=e.y}get leftTop(){return new x(this.left_,this.top_)}set leftTop(e){this.left_=e.x,this.top_=e.y}get rightBottom(){return new x(this.right_,this.bottom_)}set rightBottom(e){this.right_=e.x,this.bottom=e.y}static mkPP(e,t){const n=new De({left:e.x,right:e.x,top:e.y,bottom:e.y});return n.add(t),n}static rectangleOnPoint(e){return new De({left:e.x,right:e.x,top:e.y,bottom:e.y})}static rectangleFromLeftBottomAndSize(e,t,n){return new De({left:e,right:e+n.x,top:t+n.y,bottom:t})}static getRectangleOnCoords(e,t,n,r){const s=new De({left:e,bottom:t,right:e,top:t});return s.add(new x(n,r)),s}static mkOnPoints(e){const t=De.mkEmpty();for(const n of e)t.add(n);return t}static rectangleOnRectangles(e){const t=De.mkEmpty();for(const n of e)t.addRecSelf(n);return t}get width(){return this.right_-this.left_}set width(e){const t=e/2,n=(this.left_+this.right_)/2;this.left_=n-t,this.right_=n+t}isEmpty(){return this.width<0}setToEmpty(){this.left=0,this.right=-1}get height(){return this.top_-this.bottom_}set height(e){const t=e/2,n=(this.top_+this.bottom_)/2;this.top_=n+t,this.bottom=n-t}static rectangleOfTwo(e,t){const n=new De({left:e.left_,right:e.right_,top:e.top_,bottom:e.bottom_});return n.addRecSelf(t),n}containsWithPadding(e,t){return this.left_-t-q.distanceEpsilon<=e.x&&e.x<=this.right_+t+q.distanceEpsilon&&this.bottom_-t-q.distanceEpsilon<=e.y&&e.y<=this.top_+t+q.distanceEpsilon}get area(){return(this.right_-this.left_)*(this.top_-this.bottom_)}add(e){this.isEmpty()?(this.left_=this.right_=e.x,this.top_=this.bottom=e.y):(this.left_>e.x&&(this.left_=e.x),this.top_<e.y&&(this.top_=e.y),this.right_<e.x&&(this.right_=e.x),this.bottom_>e.y&&(this.bottom=e.y))}addWithCheck(e){let t,n;return(t=e.x<this.left_)?this.left_=e.x:(t=this.right_<e.x)&&(this.right_=e.x),(n=e.y>this.top_)?this.top_=e.y:(n=this.bottom_>e.y)&&(this.bottom=e.y),t||n}addRecSelf(e){this.add(e.leftTop),this.add(e.rightBottom)}addRec(e){const t=this.clone();return t.add(e.leftTop),t.add(e.rightBottom),t}static translate(e,t){const n=e.clone();return n.center=e.center.add(t),n}contains(e){return this.containsWithPadding(e,0)}containsRect(e){return this.contains(e.leftTop)&&this.contains(e.rightBottom)}get diagonal(){return Math.sqrt(this.width*this.width+this.height*this.height)}padWidth(e){this.left-=e,this.right+=e}padHeight(e){this.top+=e,this.bottom-=e}pad(e){return e<-this.width/2&&(e=-this.width/2),e<-this.height/2&&(e=-this.height/2),this.padWidth(e),this.padHeight(e),this}padEverywhere(e){this.left-=e.left,this.right+=e.right,this.bottom-=e.bottom,this.top+=e.top}static intersect(e,t){return e.intersects(t)?De.mkPP(new x(Math.max(e.left,t.left),Math.max(e.bottom,t.bottom)),new x(Math.min(e.right,t.right),Math.min(e.top,t.top))):De.mkEmpty()}perimeter(){const e=new He;return e.addPoint(this.leftTop),e.addPoint(this.rightTop),e.addPoint(this.rightBottom),e.addPoint(this.leftBottom),e.closed=!0,e}scaleAroundCenter(e){this.width=this.width*e,this.height=this.height*e}clone(){return De.mkPP(this.leftTop,this.rightBottom)}get size(){return new Mu(this.width,this.height)}set size(e){this.width=e.width,this.height=e.height}static creatRectangleWithSize(e,t){const n=e.width/2,o=e.height/2;return new De({left:t.x-n,right:t.x+n,top:t.y+o,bottom:t.y-o})}addPointWithSize(e,t){const n=e.width/2,r=e.height/2;this.add(new x(t.x-n,t.y-r)),this.add(new x(t.x+n,t.y-r)),this.add(new x(t.x-n,t.y+r)),this.add(new x(t.x+n,t.y+r))}}class kn{constructor(e){this.entity=e,this.bind()}bind(){this.entity&&this.entity.setAttr(0,this)}static getGeom(e){return e.getAttr(0)}}class Vn{constructor(e,t,n,r,s,o){this.elements=[[e,t,n],[r,s,o]]}get Elements(){return this.elements}getElem(e,t){return this.elements[e][t]}setElem(e,t,n){this.elements[e][t]=n}static Divide(e,t){return e.multiply(t.inverse())}isIdentity(){return ht(this.elements[0][0],1)&&ht(this.elements[0][1],0)&&ht(this.elements[0][2],0)&&ht(this.elements[1][0],0)&&ht(this.elements[1][1],1)&&ht(this.elements[1][2],0)}offset(){return new x(this.getElem(0,2),this.getElem(1,2))}static getIdentity(){return new Vn(1,0,0,0,1,0)}static rotation(e){const t=Math.cos(e),n=Math.sin(e);return new Vn(t,-n,0,n,t,0)}static scaleAroundCenterTransformation(e,t,n){return new Vn(e,0,(1-e)*n.x,0,t,(1-t)*n.y)}multiplyPoint(e){return new x(this.getElem(0,0)*e.x+this.getElem(0,1)*e.y+this.getElem(0,2),this.getElem(1,0)*e.x+this.getElem(1,1)*e.y+this.getElem(1,2))}multiply(e){return null!=e?new Vn(this.getElem(0,0)*e.getElem(0,0)+this.getElem(0,1)*e.getElem(1,0),this.getElem(0,0)*e.getElem(0,1)+this.getElem(0,1)*e.getElem(1,1),this.getElem(0,0)*e.getElem(0,2)+this.getElem(0,1)*e.getElem(1,2)+this.getElem(0,2),this.getElem(1,0)*e.getElem(0,0)+this.getElem(1,1)*e.getElem(1,0),this.getElem(1,0)*e.getElem(0,1)+this.getElem(1,1)*e.getElem(1,1),this.getElem(1,0)*e.getElem(0,2)+this.getElem(1,1)*e.getElem(1,2)+this.getElem(1,2)):null}inverse(){const e=this.getElem(0,0)*this.getElem(1,1)-this.getElem(1,0)*this.getElem(0,1),t=this.getElem(1,1)/e,n=-this.getElem(0,1)/e,r=-this.getElem(1,0)/e,s=this.getElem(0,0)/e,o=-t*this.getElem(0,2)-n*this.getElem(1,2),a=-r*this.getElem(0,2)-s*this.getElem(1,2);return new Vn(t,n,o,r,s,a)}}var oe=(()=>{return(i=oe||(oe={}))[i.None=0]="None",i[i.North=1]="North",i[i.East=2]="East",i[i.South=4]="South",i[i.West=8]="West",oe;var i})();class fe{static get DifferenceEpsilon(){return fe.differenceEpsilon}static EqualPP(e,t){return fe.Equal(e.x,t.x)&&fe.Equal(e.y,t.y)}static Equal(e,t){return 0==fe.Compare(e,t)}static Compare(e,t){let n=0;return e+fe.DifferenceEpsilon<t?n=-1:t+fe.DifferenceEpsilon<e&&(n=1),n}static ComparePP(e,t){let n=fe.Compare(e.x,t.x);return 0==n&&(n=fe.Compare(e.y,t.y)),n}static LessOrEqual(e,t){const n=fe.Compare(e,t);return n<0||0==n}static Less(e,t){return fe.Compare(e,t)<0}static GetDirections(e,t){return Ce.DirectionFromPointToPoint(e,t)}static IsPureDirection(e,t){return Ce.IsPureDirection(fe.GetDirections(e,t))}static IsPureDirectionD(e){return Ce.IsPureDirection(e)}static IsPureLower(e,t){const n=fe.GetDirections(e,t);return oe.East==n||oe.North==n}static GetPureDirectionVV(e,t){return fe.GetDirections(e.point,t.point)}}fe.differenceEpsilon=q.distanceEpsilon/2;class Ce{constructor(e){this.Dir=e}get Right(){return new Ce(Ce.RotateRight(this.Dir))}static RotateRight(e){switch(e){case oe.North:return oe.East;case oe.East:return oe.South;case oe.South:return oe.West;case oe.West:return oe.North;default:throw new Error}}static RotateLeft(e){switch(e){case oe.North:return oe.West;case oe.West:return oe.South;case oe.South:return oe.East;case oe.East:return oe.North;default:throw new Error}}static ToIndex(e){switch(e){case oe.North:return 0;case oe.East:return 1;case oe.South:return 2;case oe.West:return 3;default:throw new Error}}static VectorDirection(e){let t=oe.None;return e.x>fe.DifferenceEpsilon?t=oe.East:e.x<-fe.DifferenceEpsilon&&(t=oe.West),e.y>fe.DifferenceEpsilon?t|=oe.North:e.y<-fe.DifferenceEpsilon&&(t|=oe.South),t}static VectorDirectionPP(e,t){let n=oe.None;const r=t.x-e.x,s=t.y-e.y;return r>fe.DifferenceEpsilon?n=oe.East:-r>fe.DifferenceEpsilon&&(n=oe.West),s>fe.DifferenceEpsilon?n|=oe.North:-s>fe.DifferenceEpsilon&&(n|=oe.South),n}static DirectionFromPointToPoint(e,t){return Ce.VectorDirectionPP(e,t)}static OppositeDir(e){switch(e){case oe.North:return oe.South;case oe.West:return oe.East;case oe.South:return oe.North;case oe.East:return oe.West;default:return oe.None}}static IsPureDirection(e){switch(e){case oe.North:case oe.East:case oe.South:case oe.West:return!0;default:return!1}}static IsPureDirectionPP(e,t){return Ce.IsPureDirection(Ce.DirectionFromPointToPoint(e,t))}static DirectionsAreParallel(e,t){return e==t||e==Ce.OppositeDir(t)}ToPoint(){let e=0,t=0;return(this.Dir&oe.East)==oe.East&&e++,(this.Dir&oe.North)==oe.North&&t++,(this.Dir&oe.West)==oe.West&&e--,(this.Dir&oe.South)==oe.South&&t--,new x(e,t)}static toPoint(e){return new Ce(e).ToPoint()}static negate(e){return new Ce(Ce.OppositeDir(e.Dir))}}let vi=(()=>{class i{static createHexagon(t,n,r){const s=n/2,o=t/2,a=r.x,l=r.y;return He.mkClosedFromPoints([new x(-1*o+a,-1*s+l),new x(o+a,-1*s+l),new x(o+(s+a),0+l),new x(o+a,s+l),new x(-1*o+a,s+l),new x(-1*(o-s)+a,0+l)])}static createOctagon(t,n,r){const s=t/2,o=n/2,a=new Array(8);a[0]=new x(s+i.octagonPad*s,o-o*i.octagonPad),a[3]=new x(-1*a[0].x,a[0].y),a[4]=new x(a[3].x,-1*a[3].y),a[7]=new x(a[0].x,-1*a[0].y),a[1]=new x(s-s*i.octagonPad,o+o*i.octagonPad),a[2]=new x(-1*a[1].x,a[1].y),a[6]=new x(a[1].x,-1*a[1].y),a[5]=new x(a[2].x,-1*a[2].y);for(let l=0;l<8;l++)a[l]=a[l].add(r);return He.mkClosedFromPoints(a)}static createInvertedHouse(t,n,r){const s=i.createHouse(t,n,r);return i.rotateCurveAroundCenterByDegree(s,r,180)}static createHouse(t,n,r){const s=t/2,o=n/2,a=r.x,l=r.y,c=new te;return te.addLineSegmentCNNNN(c,a-s,l-o,a+s,l-o),te.continueWithLineSegmentNN(c,a+s,l+o),te.continueWithLineSegmentNN(c,a,l+2*o),te.continueWithLineSegmentNN(c,a-s,l+o),te.closeCurve(c)}static CreateDiamond(t,n,r){const s=t,o=n,a=r.x,l=r.y,c=new te,u=[new x(a,l-o),new x(a+s,l),new x(a,l+o),new x(a-s,l)];return c.addSegs([me.mkPP(u[0],u[1]),me.mkPP(u[1],u[2]),me.mkPP(u[2],u[3]),me.mkPP(u[3],u[0])]),c}static rotateCurveAroundCenterByDegree(t,n,r){return i.rotateCurveAroundCenterByRadian(t,n,r*Math.PI/180)}static rotateCurveAroundCenterByRadian(t,n,r){const s=Math.cos(r),o=Math.sin(r),a=new Vn(1,0,n.x,0,1,n.y).multiply(new Vn(s,-o,0,o,s,0)).multiply(new Vn(1,0,-n.x,0,1,-n.y));return t.transform(a)}static mkCircle(t,n){return Rt.mkCircle(t,n)}static createRectangle(t,n,r){const s=t/2,o=n/2,a=r.x,l=r.y,c=new te,u=[new x(a-s,l-o),new x(a+s,l-o),new x(a+s,l+o),new x(a-s,l+o)];return c.addSegs([me.mkPP(u[0],u[1]),me.mkPP(u[1],u[2]),me.mkPP(u[2],u[3]),me.mkPP(u[3],u[0])]),c}static isRoundedRect(t){if(!(t instanceof te))return;const n=t.segs;if(8!=n.length&&4!=n.length)return;const r=8==n.length;let s,o;for(let a=0;a<4;a++){const l=r?2*a+1:a;if(0==a){if(!(n[l]instanceof Rt))return;const c=n[l];s=c.aAxis.length,o=c.bAxis.length}else{if(!(n[l]instanceof Rt))return;const c=n[l];if(s!=c.aAxis.length||o!=c.bAxis.length)return}}return{radX:s,radY:o}}static mkRectangleWithRoundedCorners(t,n,r,s,o=new x(0,0)){if(0==r||0==s)return i.createRectangle(t,n,o);const a=new te,l=t/2;r>l/2&&(r=l/2);const c=n/2;s>c/2&&(s=c/2);const u=o.x,y=o.y,R=l-r,D=c-s,L=y+c,k=y-c,W=u-l,X=u+l,ne=new x(r,0),ce=new x(0,s);return R>0&&a.addSegment(me.mkPP(new x(u-R,k),new x(u+R,k))),a.addSegment(Rt.mkEllipse(1.5*Math.PI,2*Math.PI,ne,ce,u+R,y-D)),D>0&&a.addSegment(me.mkPP(new x(X,y-D),new x(X,y+D))),a.addSegment(Rt.mkEllipse(0,.5*Math.PI,ne,ce,u+R,y+D)),R>0&&a.addSegment(me.mkPP(new x(u+R,L),new x(u-R,L))),a.addSegment(Rt.mkEllipse(.5*Math.PI,Math.PI,ne,ce,u-R,y+D)),D>0&&a.addSegment(me.mkPP(new x(W,y+D),new x(W,y-D))),a.addSegment(Rt.mkEllipse(Math.PI,1.5*Math.PI,ne,ce,u-R,y-D)),a}}return i.octagonPad=1/4,i})(),TE=(()=>{class i extends kn{constructor(){super(...arguments),this.padding=1}get node(){return this.entity}get boundaryCurve(){return this._boundaryCurve}set boundaryCurve(t){(null!=t&&t.boundingBox.height<i.minHeight||t.boundingBox.width<i.minWidth)&&(t=vi.mkCircle(i.minWidth,t.boundingBox.center)),this._boundaryCurve=t}get id(){return this.node.id}toString(){return this.id}static mkNode(t,n){const r=new i(n);return r.boundaryCurve=t,r}get center(){return this.boundaryCurve.boundingBox.center}set center(t){const n=t.sub(this.center);this.boundaryCurve.translate(n)}fitBoundaryCurveToTarget(t){if(null!=this.boundaryCurve){const n=vi.isRoundedRect(this.boundaryCurve);null==n?(this.boundaryCurve=this.boundaryCurve.scaleFromOrigin(t.width/this.boundaryCurve.boundingBox.width,t.height/this.boundaryCurve.boundingBox.height),this.boundaryCurve.translate(t.center.sub(this.boundaryCurve.boundingBox.center))):this.boundaryCurve=vi.mkRectangleWithRoundedCorners(t.width,t.height,n.radX,n.radY,t.center)}}*inEdges(){for(const t of this.node.inEdges)yield kn.getGeom(t)}*outEdges(){for(const t of this.node.outEdges)yield kn.getGeom(t)}*selfEdges(){for(const t of this.node.selfEdges)yield kn.getGeom(t)}get boundingBox(){return this.boundaryCurve?this.boundaryCurve.boundingBox:null}set boundingBox(t){!this.boundaryCurve||(Math.abs(t.width-this.width)<1e-4&&Math.abs(t.height-this.height)<1e-4?this.center=t.center:this.fitBoundaryCurveToTarget(t))}get width(){return this.boundaryCurve.boundingBox.width}get height(){return this.boundaryCurve.boundingBox.height}transform(t,n=!0){null!=this.boundaryCurve&&(this.boundaryCurve=this.boundaryCurve.transform(t))}underCollapsedCluster(){return null!=this.node&&this.node.isUnderCollapsedGraph()}}return i.minHeight=2,i.minWidth=3,i})();class $t{constructor(){this.previouisBezierCoefficient=.5,this.nextBezierCoefficient=.5,this.previousTangentCoefficient=1/3,this.nextTangentCoefficient=1/3}static mkSiteP(e){const t=new $t;return t.point=e,t}static mkSiteSP(e,t){const n=new $t;return n.point=t,n.prev=e,e.next=n,n}static mkSiteSPS(e,t,n){const r=new $t;return r.prev=e,r.point=t,r.next=n,e.next=r,n.prev=r,r}get turn(){return null==this.next||null==this.prev?0:x.getTriangleOrientation(this.prev.point,this.point,this.next.point)}clone(){const e=new $t;return e.previouisBezierCoefficient=this.previouisBezierCoefficient,e.point=this.point,e}}class Nn{constructor(e){this.headSite=e}static mkFromPoints(e){let t=null,n=null;for(const r of e)if(null==n)n=$t.mkSiteP(r),t=new Nn(n);else{const s=$t.mkSiteP(r);s.prev=n,n.next=s,n=s}return t}clone(){let n,e=this.headSite,t=null,r=null;for(;null!=e;)n=e.clone(),n.prev=t,null!=t?t.next=n:r=n,e=e.next,t=n;return new Nn(r)}get lastSite(){let e=this.headSite;for(;null!=e.next;)e=e.next;return e}*getSegments(){let e=this.headSite,t=e.next;for(;null!=t;)yield me.mkPP(e.point,t.point),e=t,t=t.next}*[Symbol.iterator](){let e=this.headSite;for(;null!=e;)yield e.point,e=e.next}createCurve(){const e=new te;let t=this.headSite;for(;;){const r=te.findCorner(t);if(null==r)break;const s=Nn.createBezierSegOnSite(r.b);0==e.segs.length?x.closeDistEps(t.point,s.start)||te.addLineSegment(e,t.point,s.start):x.closeDistEps(e.end,s.start)||te.continueWithLineSegmentP(e,s.start),e.addSegment(s),t=r.b}return 0==e.segs.length?x.closeDistEps(t.point,t.next.point)?e.segs.push(new rn(t.point,t.point.add(new x(5,5)),t.point.add(new x(-5,5)),(void 0).point)):te.addLineSegment(e,t.point,t.next.point):x.closeDistEps(e.end,t.next.point)||te.continueWithLineSegmentP(e,t.next.point),e}static createBezierSegOnSite(e){const t=e.previouisBezierCoefficient,n=e.nextBezierCoefficient,s=e.next,o=e.prev.point.mul(t).add(e.point.mul(1-t)),a=s.point.mul(n).add(e.point.mul(1-n)),l=o.mul(e.previousTangentCoefficient).add(e.point.mul(1-e.previousTangentCoefficient)),c=a.mul(e.nextTangentCoefficient).add(e.point.mul(1-e.nextTangentCoefficient));return rn.mkBezier([o,l,c,a])}}let _o=(()=>{class i{constructor(){this.length=i.defaultArrowheadLength,this.width=0}clone(){const t=new i;return t.length=this.length,t.width=this.width,t.tipPosition=this.tipPosition,t}static calculateArrowheads(t){if(null==t.sourceArrowhead&&null==t.targetArrowhead)return!0;const n=i.findTrimStartForArrowheadAtSource(t);if(null==n)return!1;const r=i.findTrimEndForArrowheadAtTarget(t);if(null==r||n>r-q.intersectionEpsilon||te.closeIntersectionPoints(t.curve.value(n),t.curve.value(r)))return!1;const s=t.curve.trim(n,r);return null!=s&&(null!=t.sourceArrowhead&&(t.sourceArrowhead.tipPosition=t.curve.start),null!=t.targetArrowhead&&(t.targetArrowhead.tipPosition=t.curve.end),t.curve=s,!0)}static getIntersectionsWithArrowheadCircle(t,n,r){const s=Rt.mkFullEllipseNNP(n,n,r);return te.getAllIntersections(s,t,!0)}static findTrimEndForArrowheadAtTarget(t){const n=q.distanceEpsilon*q.distanceEpsilon;let r=t.curve.parEnd;if(null==t.targetArrowhead||t.targetArrowhead.length<=q.distanceEpsilon)return r;const s=t.curve;let a,l,o=t.targetArrowhead.length,c=10;do{if(c--,0==c)return;l=i.getIntersectionsWithArrowheadCircle(s,o,s.end),r=0!=l.length?Math.max(...l.map(u=>u.par1)):s.parEnd,a=t.curve.value(r),o/=2}while(a.sub(s.start).lengthSquared<n||0==l.length);return r}static findTrimStartForArrowheadAtSource(t){if(null==t.sourceArrowhead||t.sourceArrowhead.length<=q.distanceEpsilon)return t.curve.parStart;const n=q.distanceEpsilon*q.distanceEpsilon;let s,r=t.sourceArrowhead.length;const o=t.curve;let a,c,l=10;for(;--l>0;){if(a=i.getIntersectionsWithArrowheadCircle(o,r,o.start),0==a.length)return o.parStart;if(c=Math.min(...a.map(u=>u.par1)),s=a.filter(u=>u.par1==c)[0].x,s.sub(o.end).lengthSquared>=n)return c;r/=2}}static trimSplineAndCalculateArrowheads(t,n,r){return i.trimSplineAndCalculateArrowheadsII(t,t.source.boundaryCurve,t.target.boundaryCurve,n,r)}static trimSplineAndCalculateArrowheadsII(t,n,r,s,o){if(t.curve=te.trimEdgeSplineWithNodeBoundaries(n,r,s,o),null==t.curve)return!1;if((null==t.sourceArrowhead||t.sourceArrowhead.length<q.distanceEpsilon)&&(null==t.targetArrowhead||t.targetArrowhead.length<q.distanceEpsilon))return!0;let a=!1;const l=null!=t.sourceArrowhead?t.sourceArrowhead.length:0,c=null!=t.targetArrowhead?t.targetArrowhead.length:0,u=t.curve.end.sub(t.curve.start).length;null!=t.sourceArrowhead&&(t.sourceArrowhead.length=Math.min(u,l)),null!=t.targetArrowhead&&(t.targetArrowhead.length=Math.min(u,c));let y=10;for(;(null!=t.sourceArrowhead&&t.sourceArrowhead.length>q.intersectionEpsilon||null!=t.targetArrowhead&&t.targetArrowhead.length>q.intersectionEpsilon)&&!a&&(a=i.calculateArrowheads(t),a||(null!=t.sourceArrowhead&&(t.sourceArrowhead.length*=.5),null!=t.targetArrowhead&&(t.targetArrowhead.length*=.5)),y--,0!=y););return a||(null!=t.sourceArrowhead&&(t.sourceArrowhead.tipPosition=s.start),null!=t.targetArrowhead&&(t.targetArrowhead.tipPosition=s.end)),null!=t.sourceArrowhead&&(t.sourceArrowhead.length=l),null!=t.targetArrowhead&&(t.targetArrowhead.length=c),a}static createBigEnoughSpline(t){const n=t.source.center;let r=t.target.center;const s=r.sub(n);let a;s.length<.001?(a=new x(1,0),r=n.add(a.rotate(Math.PI/2))):a=s.rotate(Math.PI/2);let l=1;null!=t.sourceArrowhead&&(l+=t.sourceArrowhead.length),null!=t.targetArrowhead&&(l+=t.targetArrowhead.length),a=a.normalize().mul(1.5*l);for(let c=1;c<1e4;c*=2){const u=te.createBezierSegN(n,r,a,c);if(i.trimSplineAndCalculateArrowheadsII(t,t.source.boundaryCurve,t.target.boundaryCurve,u,!1))return}i.createEdgeCurveWithNoTrimming(t,n,r)}static createEdgeCurveWithNoTrimming(t,n,r){const s=r.sub(n).normalize();let o=n,a=r;const l=t.targetArrowhead;null!=l&&(l.tipPosition=r,a=r.sub(s.mul(l.length)));const c=t.sourceArrowhead;null!=c&&(c.tipPosition=n,o=n.add(s.mul(c.length))),t.curve=me.mkPP(o,a)}}return i.defaultArrowheadLength=5,i})();class Do extends kn{constructor(e){super(e),this.targetArrowhead=new _o,this.lineWidth=1}get sourcePort(){return this._sourcePort}set sourcePort(e){this._sourcePort=e}get targetPort(){return this._targetPort}set targetPort(e){this._targetPort=e}Translate(e){if(0!=e.x||0!=e.y){if(null!=this.curve&&this.curve.translate(e),null!=this.smoothedPolyline)for(let t=this.smoothedPolyline.headSite,n=this.smoothedPolyline.headSite;null!=t;t=t.next,n=n.next)t.point=n.point.add(e);null!=this.sourceArrowhead&&(this.sourceArrowhead.tipPosition=this.sourceArrowhead.tipPosition.add(e)),null!=this.targetArrowhead&&(this.targetArrowhead.tipPosition=this.targetArrowhead.tipPosition.add(e))}}GetMaxArrowheadLength(){let e=0;return null!=this.sourceArrowhead&&(e=this.sourceArrowhead.length),null!=this.targetArrowhead&&this.targetArrowhead.length>e?this.targetArrowhead.length:e}transform(e){if(null!=this.curve){if(this.curve=this.curve.transform(e),null!=this.underlyingPolyline)for(let t=this.underlyingPolyline.headSite,n=this.underlyingPolyline.headSite;null!=t;t=t.next,n=n.next)t.point=e.multiplyPoint(t.point);null!=this.sourceArrowhead&&(this.sourceArrowhead.tipPosition=e.multiplyPoint(this.sourceArrowhead.tipPosition)),null!=this.targetArrowhead&&(this.targetArrowhead.tipPosition=e.multiplyPoint(this.targetArrowhead.tipPosition)),null!=this.label&&(this.label.center=e.multiplyPoint(this.label.center))}}get labelBBox(){return this.label.boundingBox}get edge(){return this.entity}get source(){return kn.getGeom(this.edge.source)}get boundingBox(){const e=De.mkEmpty();if(null!=this.underlyingPolyline)for(const n of this.underlyingPolyline)e.add(n);null!=this.curve&&e.addRecSelf(this.curve.boundingBox),null!=this.sourceArrowhead&&e.add(this.sourceArrowhead.tipPosition),null!=this.targetArrowhead&&e.add(this.targetArrowhead.tipPosition),this.edge.label&&e.addRecSelf(this.label.boundingBox);const t=this.lineWidth;return e.left-=t,e.top+=t,e.right+=t,e.bottom-=t,e}isInterGraphEdge(){return this.edge.isInterGraphEdge()}get target(){return kn.getGeom(this.edge.target)}toString(){return this.source.toString()+"->"+this.target}static RouteSelfEdge(e,t,n){const r=e.boundingBox.width,s=e.boundingBox.height,o=e.boundingBox.center,a=new x(o.x-r/4,o.y),l=new x(o.x-r/4,o.y-s/2-t),c=new x(o.x+r/4,o.y-s/2-t),u=new x(o.x+r/4,o.y);return n.smoothedPolyline=Nn.mkFromPoints([a,l,c,u]),n.smoothedPolyline.createCurve()}underCollapsedCluster(){return this.source.underCollapsedCluster()||this.target.underCollapsedCluster()}EdgeToAncestor(){return this.edge.EdgeToAncestor()}}class dn{constructor(e){this.cancelToken=e}ProgressStep(){}}class Fu{}Fu.GoldenRatio=(1+Math.sqrt(5))/2,Fu.GoldenRatioRemainder=2-Fu.GoldenRatio;let R3=(()=>{class i extends dn{constructor(t,n){super(null),this.desiredAspectRatio=1.2,this.bestPacking=null,this.cachedCosts=new Map,this.rectangles=t,this.desiredAspectRatio=n}get PackedWidth(){return null!=this.bestPacking?this.bestPacking.PackedWidth:0}get PackedHeight(){return null!=this.bestPacking?this.bestPacking.PackedHeight:0}Pack(t,n,r){const s=i.GetGoldenSectionStep(t,n),o=Math.max(r/10,(n-t)/i.MaxSteps);n+=o,this.bestPackingCost=Number.MAX_VALUE,1==this.rectangles.length?this.PackLimit(t):2==this.rectangles.length?(this.PackLimit(t),this.PackLimit(n)):this.rectangles.length>2&&i.GoldenSectionSearch(l=>this.PackLimit(l),t,s,n,o);const a=this.bestPacking.getRects();for(let l=0;l<this.rectangles.length;l++)this.rectangles[l]=a[l]}PackLimit(t){let n=this.cachedCosts.get(t);if(null==n){const r=this.createPacking(this.rectangles,t);r.run(),this.cachedCosts.set(t,n=Math.abs(r.PackedAspectRatio-this.desiredAspectRatio)),n<this.bestPackingCost&&(this.bestPackingCost=n,this.bestPacking=r)}return n}static GoldenSectionSearch(t,n,r,s,o){if(Math.abs(n-s)<o)return t(n)<t(s)?n:s;const a=i.GetGoldenSectionStep(r,s),l=t(r),c=t(a),u=()=>i.GoldenSectionSearch(t,a,r,n,o),y=()=>i.GoldenSectionSearch(t,r,a,s,o);if(c<l)return y();if(c>l)return u();const R=y(),D=u();return t(D)<t(R)?D:R}static GetGoldenSectionStep(t,n){return t<n?t+Fu.GoldenRatioRemainder*(n-t):t-Fu.GoldenRatioRemainder*(t-n)}}return i.MaxSteps=1e3,i})();var Jt=h(5341);class T3 extends dn{get PackedWidth(){return this.packedWidth}set PackedWidth(e){this.packedWidth=e}get PackedHeight(){return this.packedHeight}set PackedHeight(e){this.packedHeight=e}get PackedAspectRatio(){return this.PackedWidth/this.PackedHeight}getRects(){const e=[];for(const[t,n]of this.rectsToCenters)t.center=n,e.push(t);return e}}class Cf extends T3{constructor(e,t,n=!1){super(null),this.rectsToCenters=new Map,this.rectanglesByDescendingHeight=n?e:Cf.SortRectangles(e),this.wrapWidth=t}static SortRectangles(e){return e.sort((t,n)=>n.height-t.height),e}run(){this.Pack()}Pack(){this.PackedWidth=0,this.PackedHeight=0;const e=new Jt.K;let t=!1,n=0,r=0,s=0;const o=this.rectanglesByDescendingHeight;for(let a=0;t||a<o.length;){const l=o[a],c=e.length>0?e.top:null;if(null==c||c.right+l.width<=this.wrapWidth&&n+l.height<=c.top){const y=new x(c?c.right:0,n).add(new x(l.width/2,l.height/2));l.center=y,this.rectsToCenters.set(l,y),r=Math.max(r,l.right),s=Math.max(s,l.top),e.push(l),t=!1}else n=c.top,e.pop(),t=!0;t||a++}this.PackedWidth=r,this.PackedHeight=s}}class yI extends R3{constructor(e,t){super(Cf.SortRectangles(e),t),this.createPacking=(n,r)=>new Cf(n,r,!0)}run(){let e=Number.MAX_VALUE,t=0,n=0;for(const r of this.rectangles){const s=r.width;n+=s,e=Math.min(e,s),t=Math.max(t,s)}this.Pack(t,n,e)}}var Gt=(()=>{return(i=Gt||(Gt={}))[i.Continue=0]="Continue",i[i.Stop=1]="Stop",Gt;var i})();function fn(i){if(0==i.length)return null;if(1==i.length)return i[0];const e={b0:i[0].irect,seed0:1},t=function I3(i,e){let n,t=EI(e.b0,i[e.seed0].irect);for(let r=2;r<i.length;r++){const s=EI(e.b0,i[r].irect);s>t&&(e.seed0=r,t=s)}for(let r=0;r<i.length;r++)if(r!=e.seed0){n=r;break}t=i[e.seed0].irect.add_rect(i[n].irect).area;for(let r=0;r<i.length;r++){if(r==e.seed0)continue;const s=i[e.seed0].irect.add_rect(i[r].irect).area;s>t&&(n=r,t=s)}return n}(i,e),n=[],r=[];n.push(i[e.seed0]),r.push(i[t]);const s={box0:i[e.seed0].irect,box1:i[t].irect};!function O3(i,e,t,n,r,s){for(let a=0;a<i.length;a++){if(a==e||a==t)continue;const l=s.box0.add_rect(i[a].irect),c=l.area-s.box0.area,u=s.box1.add_rect(i[a].irect),y=u.area-s.box1.area;2*n.length<r.length?(n.push(i[a]),s.box0=l):2*r.length<n.length?(r.push(i[a]),s.box1=u):c<y?(n.push(i[a]),s.box0=l):y<c?(r.push(i[a]),s.box1=u):s.box0.area<s.box1.area?(n.push(i[a]),s.box0=l):(r.push(i[a]),s.box1=u)}}(i,e.seed0,t,n,r,s);const o=wI(i.length);return o.irect=s.box0.add_rect(s.box1),o.Left=fn(n),o.Right=fn(r),o}function EI(i,e){return i.add_rect(e).area}function OE(i,e){return null==i||null==e?null:fn(Array.from(i).map(n=>Gn(n,e(n))))}function wI(i){const e=new PE;return e.Count=i,e}function Gn(i,e){const t=new PE;return t.UserData=i,t.irect=e,t.Count=1,t}function IE(i,e,t){return i.irect.intersects_rect(t)?e(i.UserData)==Gt.Continue?null!=i.Left?IE(i.Left,e,t)==Gt.Continue&&IE(i.Right,e,t)==Gt.Continue?Gt.Continue:Gt.Stop:Gt.Continue:Gt.Stop:Gt.Continue}class PE{toString(){return this.IsLeaf?this.Count.toString()+" "+this.UserData:this.Count.toString()}get IsLeaf(){return null==this.left}get Left(){return this.left}set Left(e){null!=this.left&&this.left.Parent==this&&(this.left.Parent=null),this.left=e,null!=this.left&&(this.left.Parent=this)}get Right(){return this.right}set Right(e){null!=this.right&&this.right.Parent==this&&(this.right.Parent=null),this.right=e,null!=this.right&&(this.right.Parent=this)}get IsLeftChild(){return this==this.Parent.Left}FirstHitNodePF(e,t){var n;return this.irect.contains_point(e)?this.IsLeaf?null!=t?t(e,this.UserData)==Gt.Stop?this:null:this:null!==(n=this.Left.FirstHitNodePF(e,t))&&void 0!==n?n:this.Right.FirstHitNodePF(e,t):null}FirstIntersectedNode(e){var t;return e.intersects_rect(this.irect)?this.IsLeaf?this:null!==(t=this.Left.FirstIntersectedNode(e))&&void 0!==t?t:this.Right.FirstIntersectedNode(e):null}FirstHitNodeWithPredicate(e,t){var n;return this.irect.contains_point(e)?this.IsLeaf?t(e,this.UserData)==Gt.Stop?this:null:null!==(n=this.Left.FirstHitNodeWithPredicate(e,t))&&void 0!==n?n:this.Right.FirstHitNodeWithPredicate(e,t):null}FirstHitNode(e){var t;return this.irect.contains_point(e)?this.IsLeaf?this:null!==(t=this.Left.FirstHitNode(e))&&void 0!==t?t:this.Right.FirstHitNode(e):null}*AllHitItems(e,t){const n=new Jt.K;for(n.push(this);n.size>0;){const r=n.pop();r.irect.intersects_rect(e)&&(r.IsLeaf?(null==t||t(r.UserData))&&(yield r.UserData):(n.push(r.left),n.push(r.right)))}}*AllHitItems_(e){const t=new Jt.K;for(t.push(this);t.size>0;){const n=t.pop();n.irect.contains_point(e)&&(n.IsLeaf?yield n.UserData:(t.push(n.left),t.push(n.right)))}}VisitTree(e,t){IE(this,e,t)}Clone(){const e=wI(this.Count);return e.UserData=this.UserData,e.irect=this.irect,null!=this.Left&&(e.Left=this.Left.Clone()),null!=this.Right&&(e.Right=this.Right.Clone()),e}*GetNodeItemsIntersectingRectangle(e){for(const t of this.GetLeafRectangleNodesIntersectingRectangle(e))yield t.UserData}*GetLeafRectangleNodesIntersectingRectangle(e){const t=new Jt.K;for(t.push(this);t.size>0;){const n=t.pop();n.irect.intersects_rect(e)&&(n.IsLeaf?yield n:(t.push(n.left),t.push(n.right)))}}*GetAllLeaves(){for(const e of this.GetAllLeafNodes())yield e.UserData}*GetAllLeafNodes(){for(const e of this.EnumRectangleNodes(!0))yield e}*EnumRectangleNodes(e){const t=new Jt.K;for(t.push(this);t.size>0;){const n=t.pop();(n.IsLeaf||!e)&&(yield n),n.IsLeaf||(t.push(n.left),t.push(n.right))}}TraverseHierarchy(e,t){t(e),null!=e.Left&&this.TraverseHierarchy(e.Left,t),null!=e.Right&&this.TraverseHierarchy(e.Right,t)}}function NE(i){return new Rf(fn(i.map(([e,t])=>Gn(t,e))))}function vI(i){for(let e=i.Parent;null!=e;e=e.Parent)e.Count--,e.irect=e.Left.irect.add_rect(e.Right.irect)}function SI(i){return 2*i.Left.Count>=i.Right.Count&&2*i.Right.Count>=i.Left.Count}function _E(i,e,t,n){return!i.irect.intersects_rect(e)||(i.IsLeaf?!n(i.UserData)||0!=--t.bound:_E(i.Left,e,t,n)&&_E(i.Right,e,t,n))}class Rf{constructor(e){this._rootNode=e}Clear(){this.RootNode=null}NumberOfIntersectedIsLessThanBound(e,t,n){return _E(this._rootNode,e,{bound:t},n)}get RootNode(){return this._rootNode}set RootNode(e){this._rootNode=e}*GetAllLeaves(){if(null!=this._rootNode&&this.Count>0)for(const e of this._rootNode.GetAllLeaves())yield e}get Count(){return null==this._rootNode?0:this._rootNode.Count}Add(e,t){this.AddNode(Gn(t,e))}AddNode(e){null==this._rootNode?this._rootNode=e:this.Count<=2?this._rootNode=fn(Array.from(this._rootNode.GetAllLeafNodes()).concat([e])):this.AddNodeToTreeRecursive(e,this._rootNode)}Rebuild(){this._rootNode=fn(Array.from(this._rootNode.GetAllLeafNodes()))}AddNodeToTreeRecursive(e,t){if(t.IsLeaf)t.Left=Gn(t.UserData,t.irect),t.Right=e,t.Count=2;else{let n,r;if(t.Count++,2*t.Left.Count<t.Right.Count)this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=t.Left.irect.add_rect(e.irect);else if(2*t.Right.Count<t.Left.Count)this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=t.Right.irect.add_rect(e.irect);else{n=t.Left.irect.add_rect(e.irect);const s=n.area-t.Left.irect.area;r=t.Right.irect.add_rect(e.irect);const o=r.area-t.Right.irect.area;s<o?(this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=n):s>o?(this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=r):n.area<r.area?(this.AddNodeToTreeRecursive(e,t.Left),t.Left.irect=n):(this.AddNodeToTreeRecursive(e,t.Right),t.Right.irect=r)}}t.irect=t.Left.irect.add_rect(t.Right.irect)}GetAllIntersecting(e){return null==this._rootNode||0==this.Count?[]:Array.from(this._rootNode.GetNodeItemsIntersectingRectangle(e))}OneIntersecting(e){if(null==this._rootNode||0==this.Count)return;const t=this._rootNode.FirstIntersectedNode(e);return null!=t?{intersectedLeaf:t.UserData}:void 0}GetAllLeavesIntersectingRectangle(e){return null==this._rootNode||0==this.Count?[]:this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e)}IsIntersecting(e){if(null==this._rootNode||0==this.Count)return!1;for(const t of this._rootNode.GetNodeItemsIntersectingRectangle(e))return!0;return!1}Contains(e,t){if(null==this._rootNode)return!1;for(const n of this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e))if(n.UserData==t)return!0;return!1}Remove(e,t){if(null==this._rootNode)return;let n;for(const r of this._rootNode.GetLeafRectangleNodesIntersectingRectangle(e))r.UserData==t&&(n=r);return null!=n?(1==this.RootNode.Count?this.RootNode=null:this.RemoveLeaf(n),n.UserData):void 0}RemoveLeaf(e){const t=function _3(i){for(let e=i.Parent;null!=e;e=e.Parent)if(!SI(e))return e;return null}(e);if(null!=t)(function N3(i,e){const t=new Array;for(const r of i.GetAllLeafNodes())r!=e&&t.push(r);const n=fn(t);i.Count=n.Count,i.Left=n.Left,i.Right=n.Right,i.irect=n.Left.irect.add_rect(n.Right.irect)})(t,e),vI(t);else{const n=e.Parent;null==n?this._rootNode=new PE:(function P3(i,e){i.UserData=e.UserData,i.Left=e.Left,i.Right=e.Right,i.Count--,i.irect=e.irect}(n,e.IsLeftChild?n.Right:n.Left),vI(n))}}UnbalancedNode(e){for(let t=e.Parent;null!=t;t=t.Parent)if(!SI(t))return t;return null}}function AI(i,e){const t=new Array;for(const s of e)t.push({g:s,lb:s.boundingBox.leftBottom.clone()});const n=e.map(s=>s.boundingBox),r=new yI(n,1.5);r.run();for(const{g:s,lb:o}of t){const a=s.boundingBox.leftBottom.sub(o);s.translate(a)}i.boundingBox=new De({left:0,bottom:0,right:r.PackedWidth,top:r.PackedHeight}),i.addLabelToGraphBB(i.boundingBox)}class Jr extends TE{constructor(e){super(e),this.MinimalWidth=0,this.MinimalHeight=0,this.Margins=10}static getGeom(e){return e.getAttr(0)}*intersectedObjects(e,t=!0){null==this._rtree&&(this._rtree=this.buildRTree());const n=this._rtree.GetAllIntersecting(e),r=e.perimeter();for(const s of n)if(s instanceof TE&&(yield s),!t&&s instanceof Do){const o=s.curve;(null!=te.intersectionOne(o,r,!1)||te.PointRelativeToCurveLocation(o.start,r)==We.Inside)&&(yield s)}}buildRTree(){return NE(Array.from(this.deepNodes()).concat(Array.from(this.deepEdges())).map(t=>[t.boundingBox,t]))}isEmpty(){return this.graph.isEmpty()}setSettingsRecursively(e){this.layoutSettings=e;for(const t of this.deepNodes())t.layoutSettings=e}get layoutSettings(){return this._layoutSettings}set layoutSettings(e){this._layoutSettings=e}translate(e){if(0==e.x&&0==e.y)return;const t=new Vn(1,0,e.x,0,1,e.y);this.transform(t)}get labelSize(){return this._labelSize}set labelSize(e){this._labelSize=e}get boundingBox(){return this._boundingBox}set boundingBox(e){this._boundingBox=e}transform(e,t=!0){if(!e.isIdentity()){null!=this.boundaryCurve&&(this.boundaryCurve=this.boundaryCurve.transform(e));for(const n of this.shallowNodes())n.transform(e,t);for(const n of this.edges())n.transform(e);t&&this.updateBoundingBox()}}*deepNodes(){for(const e of this.graph.deepNodes)yield kn.getGeom(e)}setEdge(e,t){const n=this.graph.setEdge(e,t);return new Do(n)}pumpTheBoxToTheGraphWithMargins(e){const t={b:De.mkEmpty()};return this.pumpTheBoxToTheGraph(t),t.b.pad(Math.max(this.Margins,e)),this.MinimalWidth>0&&(t.b.width=Math.max(t.b.width,this.MinimalWidth)),this.MinimalHeight>0&&(t.b.height=Math.max(t.b.height,this.MinimalHeight)),this._boundingBox=t.b,t.b}get center(){return this.boundingBox?this.boundingBox.center:new x(0,0)}set center(e){const t=e.sub(this.center),n=new Vn(1,0,t.x,0,1,t.y);this.transform(n)}pumpTheBoxToTheGraph(e){for(const t of this.edges())if(!t.underCollapsedCluster()){if(null!=t.curve){const n=t.curve.boundingBox;n.pad(t.lineWidth),e.b.addRecSelf(n)}null!=t.label&&e.b.addRecSelf(t.label.boundingBox)}for(const t of this.shallowNodes())t.underCollapsedCluster()||!t.boundingBox||e.b.addRecSelf(t.boundingBox)}get left(){return this.boundingBox.left}get right(){return this.boundingBox.right}get top(){return this.boundingBox.top}get bottom(){return this.boundingBox.bottom}CheckClusterConsistency(){throw new Error("Method not implemented.")}get edgeCount(){return this.graph.edgeCount}*shallowNodes(){for(const e of this.graph.shallowNodes)yield kn.getGeom(e)}*edges(){for(const e of this.graph.edges)yield kn.getGeom(e)}*deepEdges(){for(const e of this.graph.deepEdges())yield kn.getGeom(e)}static mk(e,t=new Mu(0,0)){const n=new Jr(new Ki(e));return n.labelSize=t,n}*subgraphs(){for(const e of this.graph.subgraphs())yield kn.getGeom(e)}static mkWithGraphAndLabel(e,t){const n=new Jr(e);return n.labelSize=t,n}get height(){return this.boundingBox.height}get width(){return this.boundingBox.width}get shallowNodeCount(){return this.graph.shallowNodeCount}get graph(){return this.entity}liftNode(e){const t=this.graph.liftNode(e.node);return t?kn.getGeom(t):null}findNode(e){const t=this.graph.findNode(e);return t?kn.getGeom(t):null}addNode(e){return this.graph.addNode(e.node),e}updateBoundingBox(){if(this.graph.isEmpty())return;const e=De.mkEmpty();let t=0;for(const n of this.graph.edges){const r=kn.getGeom(n);null!=r.curve&&(e.addRecSelf(r.boundingBox),t=Math.max(t,r.lineWidth))}for(const n of this.shallowNodes())n.boundingBox&&(e.addRecSelf(n.boundingBox),t=Math.max(t,n.padding));this.addLabelToGraphBB(e),e.pad(Math.max(t,this.Margins)),this.boundingBox=e}addLabelToGraphBB(e){this.labelSize&&(e.top+=this.labelSize.height+2,e.width<this.labelSize.width&&(e.width=this.labelSize.width))}FlipYAndMoveLeftTopToOrigin(){const e=new Vn(1,0,-this.left,0,-1,this.top);this.transform(e,!1);for(const n of this.deepNodes())if(n instanceof Jr&&!n.graph.isEmpty()){const s=n.boundingBox;n.boundingBox=De.mkSizeCenter(new Mu(s.width,s.height),e.multiplyPoint(s.center))}const t=this.boundingBox;this.boundingBox=De.mkSizeCenter(new Mu(t.width,t.height),e.multiplyPoint(t.center))}}function Tf(i){const e=new Si;return e.SetEdges(i,Si.vertexCount(i)),e}function bI(i){const e=new Si;return e.SetEdges(i,Si.vertexCount(i)),e}function Xs(i,e){const t=new Si;return t.SetEdges(i,e),t}class Si{constructor(){this.nodeCount=0}*incidentEdges(e){for(const t of this.outEdges[e])yield t;for(const t of this.inEdges[e])yield t}static deleteFromArray(e,t){const n=e.indexOf(t,0);n>-1&&e.splice(n,1)}removeEdge(e){Si.deleteFromArray(this.edges,e),e.source!=e.target?(Si.deleteFromArray(this.outEdges[e.source],e),Si.deleteFromArray(this.inEdges[e.target],e)):Si.deleteFromArray(this.selfEdges[e.source],e)}static vertexCount(e){let t=0;for(const n of e)n.source>=t&&(t=n.source),n.target>=t&&(t=n.target);return++t}SetEdges(e,t){this.edges=e,this.nodeCount=t;const n=new Array(this.nodeCount).fill(0),r=new Array(this.nodeCount).fill(0),s=new Array(this.nodeCount).fill(0);this.outEdges=new Array(this.nodeCount),this.inEdges=new Array(this.nodeCount),this.selfEdges=new Array(this.nodeCount);for(const o of this.edges)o.source!=o.target?(n[o.source]++,r[o.target]++):s[o.source]++;for(let o=0;o<this.nodeCount;o++)this.outEdges[o]=new Array(n[o]),n[o]=0,this.inEdges[o]=new Array(r[o]),r[o]=0,this.selfEdges[o]=new Array(s[o]),s[o]=0;for(const o of this.edges){const a=o.source,l=o.target;a!=l?(this.outEdges[a][n[a]++]=o,this.inEdges[l][r[l]++]=o):this.selfEdges[a][s[a]++]=o}}inEdgesCount(e){return this.inEdges[e].length}outEdgesCount(e){return this.outEdges[e].length}selfEdgesCount(e){return this.selfEdges[e].length}addEdge(e){this.edges.push(e),e.source!=e.target?(this.outEdges[e.source].push(e),this.inEdges[e.target].push(e)):this.selfEdges[e.source].push(e)}*nodesOfConnectedGraph(){if(0==this.edges.length)return;const e=new Set,t=new Io.c;let n=this.edges[0].source;for(Si.enqueue(e,t,n),yield n;t.length>0;){n=t.dequeue();for(const r of this.outEdges[n]){const s=r.target;e.has(s)||(Si.enqueue(e,t,s),yield s)}for(const r of this.inEdges[n]){const s=r.source;e.has(s)||(Si.enqueue(e,t,s),yield s)}}}*pred(e){for(const t of this.inEdges[e])yield t.source}*succ(e){for(const t of this.outEdges[e])yield t.target}static enqueue(e,t,n){t.enqueue(n),e.add(n)}}class mt{constructor(e,t){this.x=e,this.y=t}get source(){return this.x}get target(){return this.y}isDiagonal(){return this.x==this.y}}class Yl{constructor(e){this.arrayOfMaps=new Array(e);for(let t=0;t<e;t++)this.arrayOfMaps[t]=new Map}set(e,t,n){this.arrayOfMaps[e].set(t,n)}setPair(e,t){this.set(e.x,e.y,t)}delete(e,t){e<0||e>=this.arrayOfMaps.length||this.arrayOfMaps[e].delete(t)}has(e,t){return!(e<0||e>=this.arrayOfMaps.length)&&this.arrayOfMaps[e].has(t)}get(e,t){return e<0||e>=this.arrayOfMaps.length?null:this.arrayOfMaps[e].get(t)}getI(e){return this.get(e.x,e.y)}*keys(){for(let e=0;e<this.arrayOfMaps.length;e++){const t=this.arrayOfMaps[e];for(const n of t)yield new mt(e,n[0])}}*keyValues(){for(let e=0;e<this.arrayOfMaps.length;e++){const t=this.arrayOfMaps[e];for(const n of t)yield[new mt(e,n[0]),n[1]]}}*values(){for(let e=0;e<this.arrayOfMaps.length;e++){const t=this.arrayOfMaps[e];for(const n of t)yield n[1]}}}var vs=(()=>{return(i=vs||(vs={}))[i.NotVisited=0]="NotVisited",i[i.InStack=1]="InStack",i[i.Visited=2]="Visited",vs;var i})();class D3{constructor(e,t){this.v=e,this.i=t}}class xo{static getFeedbackSetWithConstraints(e,t){throw new Error("Method not implemented.")}static push(e,t,n,r){t[n]=vs.InStack,e.push(new D3(n,r))}static getFeedbackSet(e){const t=new Yl(e.nodeCount);if(null==e||0==e.nodeCount)return[];const n=new Array(e.nodeCount).fill(vs.NotVisited);for(let r=0;r<e.nodeCount;r++){if(n[r]==vs.Visited)continue;const s=new Jt.K;let o=0;for(xo.push(s,n,r,o);s.size>0;){const a=s.pop();r=a.v,n[r]=vs.Visited,o=a.i;let l=e.outEdges[r];for(;o<l.length;o++){const c=l[o];if(c.source==c.target)continue;const u=n[c.target];u==vs.InStack?t.set(c.source,c.target,c):u==vs.NotVisited&&(xo.push(s,n,r,o+1),r=c.target,n[c.target]=vs.Visited,l=e.outEdges[r],o=-1)}}}return Array.from(t.values())}}var Hn=h(9737);class Lo{constructor(e,t,n,r=1){this.Source=e,this.Target=t,this.CrossingWeight=n,this.Weight=r}toString(){return Hn.String.Format("{0}->{1}",this.Source,this.Target)}}class Ul{static FindClosestPoints(e,t){const n=te.minDistWithinIntervals(e,t,e.parStart,e.parEnd,t.parStart,t.parEnd,(e.parStart+e.parEnd)/2,(t.parStart+t.parEnd)/2);if(n)return{curveClosestPoint:n.aX,labelSideClosest:n.bX}}static GetSegmentInFrontOfLabel(e,t){if(e instanceof te)for(const n of e.segs)if((n.start.y-t)*(n.end.y-t)<=0)return n;return null}static ShiftLabel(e,t,n){const r=e.lineWidth/2,s=t.sub(n),o=s.length;o>r&&(e.label.center=e.label.center.add(s.div(o*(o-r))))}static updateLabel(e,t){let n=null;t.labelIsToTheRightOfTheSpline?(e.label.center=new x(t.x+t.rightAnchor/2,t.y),n=me.mkPP(e.labelBBox.leftTop,e.labelBBox.leftBottom)):t.labelIsToTheLeftOfTheSpline&&(e.label.center=new x(t.x-t.leftAnchor/2,t.y),n=me.mkPP(e.labelBBox.rightTop,e.labelBBox.rightBottom));const r=Ul.GetSegmentInFrontOfLabel(e.curve,e.label.center.y);if(null!=r&&0==te.getAllIntersections(e.curve,te.polyFromBox(e.labelBBox),!1).length){const s=Ul.FindClosestPoints(r,n);if(s)Ul.ShiftLabel(e,s.curveClosestPoint,s.labelSideClosest);else{let o,a;const l=r.closestParameter(n.start),c=r.closestParameter(n.end);r.value(l).sub(n.start).length<r.value(c).sub(n.end).length?(o=r.value(l),a=n.start):(o=r.value(c),a=n.end),Ul.ShiftLabel(e,o,a)}}}}class qr{constructor(e,t,n,r=1,s=1){this.reversed=!1,this.source=e,this.target=t,this.edge=n,this.weight=r,this.separation=s}get CrossingWeight(){return 1}get hasLabel(){return null!=this.edge.label}get labelWidth(){return this.edge.label.width}get labelHeight(){return this.edge.label.height}reverse(){const e=this.source;this.source=this.target,this.target=e,this.reversed=!this.reversed}toString(){return"edge("+this.source+"->"+this.target+")"}get curve(){return this.edge.curve}set curve(e){this.edge.curve=e}get underlyingPolyline(){return this.edge.underlyingPolyline}set underlyingPolyline(e){this.edge.underlyingPolyline=e}get LayerSpan(){return null!=this.LayerEdges?this.LayerEdges.length:0}isSelfEdge(){return this.source==this.target}reversedClone(){const e=new qr(this.target,this.source,this.edge);if(null!=this.LayerEdges){const t=this.LayerEdges.length;e.LayerEdges=new Array(t);for(let n=0;n<t;n++){const r=this.LayerEdges[t-1-n];e.LayerEdges[n]=new Lo(r.Target,r.Source,r.CrossingWeight)}e.LayerEdges[0].Source=this.target,e.LayerEdges[this.LayerEdges.length-1].Target=this.source}return e}get count(){return this.LayerEdges.length}getNode(e){if(e>=0){if(e<this.LayerEdges.length)return this.LayerEdges[e].Source;if(e==this.LayerEdges.length)return this.LayerEdges[e-1].Target}throw new Error("wrong index "+e)}updateEdgeLabelPosition(e){null!=this.edge.label&&Ul.updateLabel(this.edge,e[this.LayerEdges[this.LayerEdges.length/2].Source])}[Symbol.iterator](){return this.nodes()}*nodes(){yield this.LayerEdges[0].Source;for(const e of this.LayerEdges)yield e.Target}}class Qr{constructor(){this.arrayOfSets=new Array}has(e){return this.hasxy(e.x,e.y)}remove(e){if(!(e.x<0||e.x>=this.arrayOfSets.length))return this.arrayOfSets[e.x].delete(e.y)}hasxy(e,t){if(e<0||e>=this.arrayOfSets.length)return!1;const n=this.arrayOfSets[e];return null!=n&&n.has(t)}static mk(e){const t=new Qr;for(const n of e)t.add(n);return t}*values(){for(let e=0;e<this.arrayOfSets.length;e++){const t=this.arrayOfSets[e];if(t)for(const n of t.values())yield new mt(e,n)}}add(e){let t=this.arrayOfSets[e.x];null==t&&(this.arrayOfSets[e.x]=t=new Set),t.add(e.y)}addNN(e,t){let n=this.arrayOfSets[e];null==n&&(this.arrayOfSets[e]=n=new Set),n.add(t)}clear(){for(const e of this.arrayOfSets)e&&e.clear()}}function*Bu(i){const e=new Array(i.nodeCount).fill(!1),t=new Io.c;for(let n=0;n<i.nodeCount;n++)if(!e[n]){const r=new Array;for(CI(n,t,e);t.length>0;){const s=t.dequeue();r.push(s);for(const o of x3(i,s))CI(o,t,e)}yield r}}function*x3(i,e){for(const t of i.outEdges[e])yield t.target;for(const t of i.inEdges[e])yield t.source}function CI(i,e,t){0==t[i]&&(e.enqueue(i),t[i]=!0)}class L3{constructor(){this.maxLayerOfGeomGraph=new Set,this.minLayerOfGeomGraph=new Set,this.sameLayerConstraints=new Array,this.upDownConstraints=new Array,this.gluedUpDownIntConstraints=new Qr,this.sameLayerDictionaryOfRepresentatives=new Map,this.representativeToItsLayer=new Map,this.maxLayerInt=new Array,this.minLayerInt=new Array,this.sameLayerInts=new Array,this.upDownInts=new Array}getFeedbackSetExternal(e,t){throw new Error("Method not implemented.")}pinNodeToMaxLayer(e){this.maxLayerOfGeomGraph.add(e)}pinNodeToMinLayer(e){this.minLayerOfGeomGraph.add(e)}get isEmpty(){return 0==this.maxLayerOfGeomGraph.size&&0==this.minLayerOfGeomGraph.size&&0==this.sameLayerConstraints.length&&0==this.upDownConstraints.length}clear(){this.maxLayerOfGeomGraph.clear(),this.minLayerOfGeomGraph.clear(),this.sameLayerConstraints=[],this.upDownConstraints=[]}getFeedbackSetImp(e,t){return this.nodeIdToIndex=t,this.intGraph=e,this.maxRepresentative=-1,this.minRepresentative=-1,this.createIntegerConstraints(),this.glueTogetherSameConstraintsMaxAndMin(),this.addMaxMinConstraintsToGluedConstraints(),this.removeCyclesFromGluedConstraints(),this.getFeedbackSet()}removeCyclesFromGluedConstraints(){const e=Xs(Array.from(this.gluedUpDownIntConstraints.values()),this.intGraph.nodeCount),t=xo.getFeedbackSetWithConstraints(e,null);for(const n of t)this.gluedUpDownIntConstraints.remove(n)}addMaxMinConstraintsToGluedConstraints(){if(-1!=this.maxRepresentative)for(let e=0;e<this.intGraph.nodeCount;e++){const t=this.nodeToRepr(e);t!=this.maxRepresentative&&this.gluedUpDownIntConstraints.add(new mt(this.maxRepresentative,t))}if(-1!=this.minRepresentative)for(let e=0;e<this.intGraph.nodeCount;e++){const t=this.nodeToRepr(e);t!=this.minRepresentative&&this.gluedUpDownIntConstraints.add(new mt(t,this.minRepresentative))}}glueTogetherSameConstraintsMaxAndMin(){this.createDictionaryOfSameLayerRepresentatives(),this.upDownInts.map(this.gluedIntPairNN),this.gluedUpDownIntConstraints=new Qr}gluedIntPairNN(e){return new mt(this.nodeToRepr(e[0]),this.nodeToRepr(e[1]))}gluedIntPairI(e){return new mt(this.nodeToRepr(e.source),this.nodeToRepr(e.target))}gluedIntPair(e){return new mt(this.nodeToRepr(e.source),this.nodeToRepr(e.target))}gluedIntEdge(e){const t=this.nodeToRepr(e.source),n=this.nodeToRepr(e.target),r=new qr(t,n,e.edge);return r.separation=e.separation,r.weight=0,r}nodeToRepr(e){return this.sameLayerDictionaryOfRepresentatives.get(e)||e}createDictionaryOfSameLayerRepresentatives(){const e=this.createGraphOfSameLayers();for(const t of Bu(e))this.glueSameLayerNodesOfALayer(t)}createGraphOfSameLayers(){return Xs(this.createEdgesOfSameLayers(),this.intGraph.nodeCount)}createEdgesOfSameLayers(){const e=new Array;return-1!=this.maxRepresentative&&this.maxLayerInt.filter(t=>t!=this.maxRepresentative).map(t=>new mt(this.maxRepresentative,t)).forEach(t=>e.push(t)),-1!=this.minRepresentative&&this.minLayerInt.filter(t=>t!=this.minRepresentative).map(t=>new mt(this.minRepresentative,t)).forEach(t=>e.push(t)),this.sameLayerInts.forEach(t=>e.push(new mt(t[0],t[1]))),e}glueSameLayerNodesOfALayer(e){if(e.length>1){let t=-1;if(this.componentsIsMaxLayer(e))for(const n of e)this.sameLayerDictionaryOfRepresentatives.set(n,t=this.maxRepresentative);else if(this.componentIsMinLayer(e))for(const n of e)this.sameLayerDictionaryOfRepresentatives.set(n,t=this.minRepresentative);else for(const n of e)-1==t&&(t=n),this.sameLayerDictionaryOfRepresentatives.set(n,t);this.representativeToItsLayer.set(t,e)}}componentIsMinLayer(e){return e.findIndex(t=>this.minRepresentative==t)>=0}componentsIsMaxLayer(e){return e.findIndex(t=>this.maxRepresentative==t)>=0}createIntegerConstraints(){this.createMaxIntConstraints(),this.createMinIntConstraints(),this.createUpDownConstraints(),this.createSameLayerConstraints()}createSameLayerConstraints(){this.sameLayerInts=this.createIntConstraintsFromStringCouples(this.sameLayerConstraints)}createUpDownConstraints(){this.upDownInts=this.createIntConstraintsFromStringCouples(this.upDownConstraints)}createIntConstraintsFromStringCouples(e){return e.map(t=>[this.nodeIndex(t[0]),this.nodeIndex(t[1])]).filter(t=>-1!=t[0]&&-1!=t[1])}createMinIntConstraints(){this.minLayerInt=this.createIntConstraintsFromExtremeLayer(this.minLayerOfGeomGraph),this.minLayerInt.length>0&&(this.minRepresentative=this.minLayerInt[0])}createMaxIntConstraints(){this.maxLayerInt=this.createIntConstraintsFromExtremeLayer(this.maxLayerOfGeomGraph),this.maxLayerInt.length>0&&(this.maxRepresentative=this.maxLayerInt[0])}createIntConstraintsFromExtremeLayer(e){return Array.from(e).map(t=>this.nodeIndex(t)).filter(t=>-1!=t)}nodeIndex(e){return this.nodeIdToIndex.get(e.node.id)||-1}getFeedbackSet(){return this.gluedIntGraph=this.createGluedGraph(),Array.from(this.unglueIntPairs(xo.getFeedbackSetWithConstraints(this.gluedIntGraph,this.gluedUpDownIntConstraints)))}*unglueIntPairs(e){for(const t of e)for(const n of this.unglueEdge(t))yield n}*unglueEdge(e){for(const t of this.unglueNode(e.source))for(const n of this.intGraph.outEdges[t])this.nodeToRepr(n.target)==e.target&&(yield n)}createGluedGraph(){const e=new Qr;return this.intGraph.edges.forEach(t=>e.add(this.gluedIntPairI(t))),Xs(Array.from(e.values()),this.intGraph.nodeCount)}unglueNode(e){return this.representativeToItsLayer.get(e)||[e]}getGluedNodeCounts(){const e=new Array(this.nodeIdToIndex.size).fill(0);for(let t=0;t<e.length;t++)e[this.nodeToRepr(t)]++;return e}}class F3{constructor(){this.leftRightConstraints=new Array,this.leftRightNeighbors=new Array,this.nodeToBlockRoot=new Map,this.upDownVerticalConstraints=new Array,this.BlockRootToBlock=new Map}get IsEmpty(){return 0==this.leftRightNeighbors.length&&0==this.upDownVerticalConstraints.length&&0==this.leftRightConstraints.length}AddSameLayerNeighbors(e){for(let t=0;t<e.length-1;t++)this.AddSameLayerNeighborsPair(e[t],e[t+1])}AddSameLayerNeighborsPair(e,t){this.leftRightNeighbors.push([e,t])}NodeToBlockRootSoft(e){return this.nodeToBlockRoot.get(e)||e}CreateMappingOfNeibBlocks(){const e=this.BasicGraphFromLeftRightIntNeibs();for(let t=0;t<e.nodeCount;t++)if(0==e.inEdges[t].length&&!this.nodeToBlockRoot.has(t)){const n=new Array;let r=t;for(let s=e.outEdges[r];s.length>0;s=e.outEdges[r])r=s[0].y,n.push(r),this.nodeToBlockRoot.set(r,t);n.length>0&&this.BlockRootToBlock.set(t,n)}}BasicGraphFromLeftRightIntNeibs(){return Tf(Array.from(this.LeftRightIntNeibs.values()).map(e=>new mt(e.x,e.y)))}NodeIndex(e){return this.nodeIdToIndex.get(e.id)||-1}PrepareForOrdering(e,t){this.nodeIdToIndex=e,this.MapNodesToToIntegers(t),this.CreateMappingOfNeibBlocks(),this.LiftLeftRightRelationsToNeibBlocks()}LiftLeftRightRelationsToNeibBlocks(){this.LeftRighInts=Qr.mk(this.leftRightConstraints.map(t=>function M3(i,e){return[i,e]}(this.NodeIndex(t[0]),this.NodeIndex(t[1]))).filter(t=>-1!=t[0]&&-1!=t[1]).map(t=>new mt(this.NodeToBlockRootSoft(t[0]),this.NodeToBlockRootSoft(t[1]))).filter(t=>t.x!=t.x));const e=xo.getFeedbackSet(Tf(Array.from(this.LeftRighInts.values())));for(const t of e)this.LeftRighInts.remove(new mt(t.source,t.target))}MapNodesToToIntegers(e){this.LeftRightIntNeibs=Qr.mk(Array.from(this.leftRightNeighbors.values()).map(t=>[this.NodeIndex(t[0]),this.NodeIndex(t[1])]).filter(t=>-1!=t[0]&&-1!=t[1]).map(t=>new mt(t[0],t[1]))),this.VerticalInts=Qr.mk(this.upDownVerticalConstraints.map(t=>[this.NodeIndex(t[0]),this.NodeIndex(t[1])]).filter(t=>-1!=t[0]&&-1!=t[1]&&e[t[0]]>e[t[1]]).map(t=>new mt(t[0],t[1])))}}var Ji=(()=>{return(i=Ji||(Ji={}))[i.TB=0]="TB",i[i.LR=1]="LR",i[i.BT=2]="BT",i[i.RL=3]="RL",i[i.None=4]="None",Ji;var i})();let RI=(()=>{class i{constructor(){this.capacityOverflowCoefficient=i.DefaultCapacityOverflowCoefficientMultiplier,this.RotateBundles=!1,this.MaxHubRadius=50,this.MinHubRadius=.1,this.CreateUnderlyingPolyline=!1,this.pathLengthImportance=i.DefaultPathLengthImportance,this.inkImportance=i.DefaultInkImportance,this.edgeSeparation=i.DefaultEdgeSeparation,this.angleThreshold=Math.PI/180*45,this.hubRepulsionImportance=100,this.bundleRepulsionImportance=100,this.minimalRatioOfGoodCdtEdges=.9,this.highestQuality=!0,this.KeepOriginalSpline=!1,this.KeepOverlaps=!1,this.StopAfterShortestPaths=!1}get CapacityOverflowCoefficient(){return this.capacityOverflowCoefficient}set CapacityOverflowCoefficient(t){this.capacityOverflowCoefficient=t}get PathLengthImportance(){return this.pathLengthImportance}set PathLengthImportance(t){this.pathLengthImportance=t}get InkImportance(){return this.inkImportance}set InkImportance(t){this.inkImportance=t}get EdgeSeparation(){return this.edgeSeparation}set EdgeSeparation(t){this.edgeSeparation=t}get UseCubicBezierSegmentsInsideOfHubs(){return this.useCubicBezierSegmentsInsideOfHubs}set UseCubicBezierSegmentsInsideOfHubs(t){this.useCubicBezierSegmentsInsideOfHubs=t}get AngleThreshold(){return this.angleThreshold}set AngleThreshold(t){this.angleThreshold=t}get HubRepulsionImportance(){return this.hubRepulsionImportance}set HubRepulsionImportance(t){this.hubRepulsionImportance=t}get BundleRepulsionImportance(){return this.bundleRepulsionImportance}set BundleRepulsionImportance(t){this.bundleRepulsionImportance=t}get MinimalRatioOfGoodCdtEdges(){return this.minimalRatioOfGoodCdtEdges}set MinimalRatioOfGoodCdtEdges(t){this.minimalRatioOfGoodCdtEdges=t}get HighestQuality(){return this.highestQuality}set HighestQuality(t){this.highestQuality=t}}return i.DefaultCapacityOverflowCoefficientMultiplier=1e3,i.DefaultPathLengthImportance=500,i.DefaultInkImportance=.01,i.DefaultEdgeSeparation=.5,i})();var Cn=(()=>{return(i=Cn||(Cn={}))[i.Spline=0]="Spline",i[i.SplineBundling=1]="SplineBundling",i[i.StraightLine=2]="StraightLine",i[i.SugiyamaSplines=3]="SugiyamaSplines",i[i.Rectilinear=4]="Rectilinear",i[i.RectilinearToCenter=5]="RectilinearToCenter",i[i.None=6]="None",Cn;var i})();class TI{constructor(){this.coneAngle=Math.PI/180*30,this.padding=3,this.polylinePadding=1.5,this.routingToParentConeAngle=Math.PI/6,this.simpleSelfLoopsForParentEdgesThreshold=200,this.incrementalRoutingThreshold=5e6,this.routeMultiEdgesAsBundles=!0,this.KeepOriginalSpline=!1,this.EdgeRoutingMode=Cn.Spline}get EdgeRoutingMode(){return this.edgeRoutingMode}set EdgeRoutingMode(e){e==Cn.SplineBundling&&null==this.BundlingSettings&&null==this.BundlingSettings&&(this.BundlingSettings=new RI),this.edgeRoutingMode=e}get ConeAngle(){return this.coneAngle}set ConeAngle(e){this.coneAngle=e}get Padding(){return this.padding}set Padding(e){this.padding=e}get PolylinePadding(){return this.polylinePadding}set PolylinePadding(e){this.polylinePadding=e}get RoutingToParentConeAngle(){return this.routingToParentConeAngle}set RoutingToParentConeAngle(e){this.routingToParentConeAngle=e}get SimpleSelfLoopsForParentEdgesThreshold(){return this.simpleSelfLoopsForParentEdgesThreshold}set SimpleSelfLoopsForParentEdgesThreshold(e){this.simpleSelfLoopsForParentEdgesThreshold=e}get IncrementalRoutingThreshold(){return this.incrementalRoutingThreshold}set IncrementalRoutingThreshold(e){this.incrementalRoutingThreshold=e}get RouteMultiEdgesAsBundles(){return this.routeMultiEdgesAsBundles}set RouteMultiEdgesAsBundles(e){this.routeMultiEdgesAsBundles=e}}var Wl=(()=>{return(i=Wl||(Wl={}))[i.None=0]="None",i[i.Top=1]="Top",i[i.Bottom=2]="Bottom",Wl;var i})();class OI{constructor(){this.edgeRoutingSettings=new TI,this.minimalWidth=0,this.minimalHeight=0,this.nodeSeparation=10,this.packingAspectRatio=1.5}get MinimalWidth(){return this.minimalWidth}set MinimalWidth(e){this.minimalWidth=Math.max(e,0)}get MinimalHeight(){return this.minimalHeight}set MinimalHeight(e){this.minimalHeight=Math.max(e,0)}get NodeSeparation(){return this.nodeSeparation}set NodeSeparation(e){this.nodeSeparation=e}get PackingAspectRatio(){return this.packingAspectRatio}set PackingAspectRatio(e){this.packingAspectRatio=e}}class Of extends OI{constructor(){super(),this.margins={left:0,top:0,bottom:0,right:0},this.sameRanks=new Array,this.verticalConstraints=new L3,this.horizontalConstraints=new F3,this.NoGainAdjacentSwapStepsBound=5,this.RepetitionCoefficientForOrdering=1,this.AspectRatio=0,this.MaxNumberOfPassesInOrdering=24,this.BrandesThreshold=600,this.LabelCornersPreserveCoefficient=.1,this.MinNodeHeight=9,this.MinNodeWidth=13.5,this.SnapToGridByY=Wl.None,this.yLayerSep=30,this.transform=Vn.getIdentity(),this.GridSizeByY=0,this.GridSizeByX=0,this.edgeRoutingSettings.EdgeRoutingMode=Cn.SugiyamaSplines}get LayerSeparation(){return this.yLayerSep}set LayerSeparation(e){this.yLayerSep=Math.max(30,e)}ActualLayerSeparation(e){return e?this.LayerSeparation/2:this.LayerSeparation}transformIsRotation(e){const t=Vn.rotation(e);for(let n=0;n<2;n++)for(let r=0;r<3;r++)if(!ht(t.elements[n][r],this.transform.elements[n][r]))return!1;return!0}get layerDirection(){return this.transformIsRotation(0)?Ji.TB:this.transformIsRotation(Math.PI/2)?Ji.LR:this.transformIsRotation(-Math.PI/2)?Ji.RL:this.transformIsRotation(Math.PI)?Ji.BT:Ji.None}set layerDirection(e){switch(e){case Ji.TB:this.transform=Vn.getIdentity();break;case Ji.LR:this.transform=Vn.rotation(Math.PI/2);break;case Ji.RL:this.transform=Vn.rotation(-Math.PI/2);break;case Ji.BT:this.transform=Vn.rotation(Math.PI);break;default:throw new Error("unexpected layout direction")}}}class br{constructor(){this.isEmpty=!0}AddValue(e){this.isEmpty?(this.max=e,this.min=e,this.isEmpty=!1):e<this.min?this.min=e:e>this.max&&(this.max=e)}get length(){return this.max-this.min}static sign(e){return e>q.distanceEpsilon?1:e<-q.distanceEpsilon?-1:0}}class ku extends Si{constructor(e,t){super(),this.SetEdges(e,t)}}class B3{constructor(e){this.MultipleMiddles=new Set,this.Multiedges=new Yl(e)}*RegularMultiedges(){for(const[e,t]of this.Multiedges.keyValues())e.x!=e.y&&(yield t)}*AllIntEdges(){for(const e of this.Multiedges.values())for(const t of e)yield t}addFeedbackSet(e){for(const t of e){const n=new mt(t.source,t.target),r=new mt(t.target,t.source),s=this.Multiedges.get(n.x,n.y);for(const o of s)o.reverse();if(this.Multiedges.has(r.x,r.y)){const o=this.Multiedges.get(r.x,r.y);for(const a of s)o.push(a)}else this.Multiedges.set(r.x,r.y,s);this.Multiedges.delete(n.x,n.y)}}registerOriginalEdgeInMultiedges(e){let t=this.Multiedges.get(e.source,e.target);null==t&&this.Multiedges.set(e.source,e.target,t=[]),t.push(e)}*SkeletonEdges(){for(const[e,t]of this.Multiedges.keyValues())e.x!=e.y&&(yield t[0])}GetMultiedge(e,t){return this.GetMultiedgeI(new mt(e,t))}GetMultiedgeI(e){return this.Multiedges.has(e.x,e.y)?this.Multiedges.get(e.x,e.y):new Array}}function DE(i,e){for(let t=0;t<i.length;t++)e[t]=i[t]}class Zs{constructor(e){this.initialize(e)}initialize(e){this.y=e,this.verticesToX=null,this.layers=null}DropEmptyLayers(){const e=new Array(this.Layers.length);let t=0;for(let o=0;o<this.Layers.length;o++)e[o]=t,0==this.Layers[o].length&&t++;if(0==t)return this;const n=new Array(this.y.length);for(let o=0;o<n.length;o++)n[o]=this.y[o]-e[this.y[o]];const r=new Array(this.layers.length-t);for(let o=0;o<this.layers.length;o++)this.layers[o].length>0&&(r[o-e[o]]=Array.from(this.layers[o]));const s=new Zs(n);return s.layers=r,s}updateLayers(e){null==this.layers&&this.InitLayers();for(let t=0;t<this.layers.length;t++)DE(e[t],this.layers[t]);this.UpdateXFromLayers()}UpdateXFromLayers(){null==this.layers&&this.InitLayers(),null==this.verticesToX&&(this.verticesToX=new Array(this.y.length));for(const e of this.layers){let t=0;for(const n of e)this.verticesToX[n]=t++}}get x(){return null!=this.verticesToX||(this.verticesToX=new Array(this.y.length),this.UpdateXFromLayers()),this.verticesToX}ReversedClone(){const e=new Array(this.y.length),t=this.Layers.length-1;for(let n=0;n<this.y.length;n++)e[n]=t-this.y[n];return new Zs(e)}get Layers(){return null!=this.layers||this.InitLayers(),this.layers}set Layers(e){this.layers=e}InitLayers(){let e=0;for(const n of this.y)n+1>e&&(e=n+1);const t=new Array(e).fill(0);for(const n of this.y)t[n]++;this.layers=new Array(e);for(let n=0;n<e;n++)this.layers[n]=new Array(t[n]),t[n]=0;for(let n=0;n<this.y.length;n++){const r=this.y[n];this.layers[r][t[r]++]=n}}}class xE extends dn{constructor(e,t,n,r){super(r),this.jumpers=new Set,this.possibleJumperFeasibleIntervals=new Map,this.nodeCount=n,this.dag=e,this.layering=t,this.Init()}static Balance(e,t,n,r){new xE(e,t,n,r).run()}run(){for(;this.jumpers.size>0;)this.Jump(this.ChooseJumper())}Init(){this.CalculateLayerCounts(),this.InitJumpers()}Jump(e){this.jumpers.delete(e);const t=this.possibleJumperFeasibleIntervals.get(e),n=this.CalcJumpInfo(t.x,t.y,e);if(null==n)return;this.layering[e]=n.layerToJumpTo;const r=this.nodeCount[e];this.vertsCounts[n.jumperLayer]-=r,this.vertsCounts[n.layerToJumpTo]+=r,this.UpdateRegionsForPossibleJumpersAndInsertJumpers(n.jumperLayer,e)}IsJumper(e){return this.possibleJumperFeasibleIntervals.has(e)}UpdateRegionsForPossibleJumpersAndInsertJumpers(e,t){const n=new Set;for(const s of this.dag.pred(t))this.IsJumper(s)&&(this.CalculateRegionAndInsertJumper(s),n.add(s));for(const s of this.dag.succ(t))this.IsJumper(s)&&(this.CalculateRegionAndInsertJumper(s),n.add(s));const r=new Array;for(const s of this.possibleJumperFeasibleIntervals)n.has(s[0])||s[1].x>e&&s[1].y<e&&r.push(s[0]);for(const s of r)this.CalculateRegionAndInsertJumper(s)}InitJumpers(){const e=new Array(this.dag.nodeCount).fill(0);for(const t of this.dag.edges)e[t.source]-=t.weight,e[t.target]+=t.weight;this.possibleJumperFeasibleIntervals=new Map;for(let t=0;t<this.dag.nodeCount;t++)0==e[t]&&this.CalculateRegionAndInsertJumper(t)}CalculateRegionAndInsertJumper(e){const t=new mt(this.Up(e),this.Down(e));this.possibleJumperFeasibleIntervals.set(e,t),this.InsertJumper(t.x,t.y,e)}InsertJumper(e,t,n){null!=this.CalcJumpInfo(e,t,n)&&this.jumpers.add(n)}CalcJumpInfo(e,t,n){const r=this.layering[n];let s=-1,o=this.vertsCounts[r]-2*this.nodeCount[n];for(let a=e-1;a>r;a--)this.vertsCounts[a]<o&&(o=this.vertsCounts[a],s=a);for(let a=r-1;a>t;a--)this.vertsCounts[a]<o&&(o=this.vertsCounts[a],s=a);if(-1!=s)return{jumperLayer:r,layerToJumpTo:s}}Up(e){let t=Number.MAX_SAFE_INTEGER;for(const n of this.dag.inEdges[e]){const r=this.layering[n.source]-n.separation+1;r<t&&(t=r)}return t==Number.MAX_SAFE_INTEGER&&(t=this.layering[e]+1),t}Down(e){let t=Number.NEGATIVE_INFINITY;for(const n of this.dag.outEdges[e]){const r=this.layering[n.target]+n.separation-1;r>t&&(t=r)}return t==Number.NEGATIVE_INFINITY&&(t=this.layering[e]-1),t}CalculateLayerCounts(){this.vertsCounts=new Array(Math.max(...this.layering)+1).fill(0);for(const e of this.layering)this.vertsCounts[e]+=this.nodeCount[e]}ChooseJumper(){for(const e of this.jumpers)return e;throw new Error("there are no jumpers to choose")}}class ma{constructor(e){this.Initialize(e)}Initialize(e){this.BaseGraph=e,this.totalNumberOfNodes=e.nodeCount;for(const t of this.BaseGraph.edges)if(null!=t.LayerEdges)for(const n of t.LayerEdges){const r=Math.max(n.Source,n.Target)+1;r>this.totalNumberOfNodes&&(this.totalNumberOfNodes=r)}this.firstVirtualNode=Number.POSITIVE_INFINITY;for(const t of this.BaseGraph.edges)if(null!=t.LayerEdges)for(let n=1;n<t.LayerEdges.length;n++)this.firstVirtualNode=Math.min(this.firstVirtualNode,t.LayerEdges[n].Source);this.firstVirtualNode==Number.POSITIVE_INFINITY&&(this.firstVirtualNode=this.BaseGraph.nodeCount,this.totalNumberOfNodes=this.BaseGraph.nodeCount),this.virtualNodesToInEdges=new Array(this.totalNumberOfNodes-this.firstVirtualNode),this.virtualNodesToOutEdges=new Array(this.totalNumberOfNodes-this.firstVirtualNode);for(const t of this.BaseGraph.edges)if(t.LayerSpan>0)for(const n of t.LayerEdges)n.Target!=t.target&&(this.virtualNodesToInEdges[n.Target-this.firstVirtualNode]=n),n.Source!=t.source&&(this.virtualNodesToOutEdges[n.Source-this.firstVirtualNode]=n)}*edges_(){for(const e of this.BaseGraph.edges)if(e.LayerSpan>0)for(const t of e.LayerEdges)yield t}get Edges(){return this.edges_()}*InEdges(e){if(e<this.BaseGraph.nodeCount)for(const t of this.BaseGraph.inEdges[e])t.source!=t.target&&null!=t.LayerEdges&&(yield ma.LastEdge(t));else e>=this.firstVirtualNode&&(yield this.InEdgeOfVirtualNode(e))}static LastEdge(e){return e.LayerEdges[e.LayerEdges.length-1]}InEdgeOfVirtualNode(e){return this.virtualNodesToInEdges[e-this.firstVirtualNode]}*OutEdges(e){if(e<this.BaseGraph.nodeCount)for(const t of this.BaseGraph.outEdges[e])t.source!=t.target&&null!=t.LayerEdges&&(yield ma.FirstEdge(t));else e>=this.firstVirtualNode&&(yield this.OutEdgeOfVirtualNode(e))}OutDegreeIsMoreThanOne(e){return e<this.BaseGraph.nodeCount&&this.BaseGraph.outEdges[e].length>1}InDegreeIsMoreThanOne(e){return e<this.BaseGraph.nodeCount&&this.BaseGraph.inEdges[e].length>1}OutEdgeOfVirtualNode(e){return this.virtualNodesToOutEdges[e-this.firstVirtualNode]}static FirstEdge(e){return e.LayerEdges[0]}InEdgesCount(e){return this.RealInEdgesCount(e)}RealInEdgesCount(e){return e<this.BaseGraph.nodeCount?this.BaseGraph.inEdges[e].filter(t=>null!=t.LayerEdges).length:1}OutEdgesCount(e){return this.RealOutEdgesCount(e)}RealOutEdgesCount(e){return e<this.BaseGraph.nodeCount?this.BaseGraph.outEdges[e].filter(t=>null!=t.LayerEdges).length:1}get NodeCount(){return this.totalNumberOfNodes}IsRealNode(e){return e<this.BaseGraph.nodeCount}IsVirtualNode(e){return!this.IsRealNode(e)}ReversedClone(){const e=this.CreateReversedEdges();return new ma(new ku(e,this.BaseGraph.nodeCount))}CreateReversedEdges(){const e=new Array;for(const t of this.BaseGraph.edges)t.isSelfEdge()||e.push(t.reversedClone());return e}*Succ(e){for(const t of this.OutEdges(e))yield t.Target}*Pred(e){for(const t of this.InEdges(e))yield t.Source}}var LE=h(5027);class Vu{constructor(e,t,n,r){this.la=t,this.database=n,this.layeredGraph=e,this.intGraph=r}static InsertLayers(e,t,n,r){const s=new Vu(e,t,n,r);return s.InsertLayers(),{layeredGraph:s.nLayeredGraph,la:s.Nla.DropEmptyLayers()}}get NLayering(){return this.Nla.y}InsertLayers(){this.EditOldLayering(),this.CreateFullLayeredGraph(),this.InitNewLayering(),this.MapVirtualNodesToEdges(),this.FillUnsortedNewOddLayers(),this.WidenOriginalLayers(),this.SortNewOddLayers()}EditOldLayering(){let e=this.intGraph.nodeCount;for(const t of this.database.RegularMultiedges()){let n=0;const r=t[0];if(n=2*r.LayerSpan,n>0){for(const s of r.LayerEdges)s.Target!=r.target&&(e++,this.UpdateOldLayer(e++,s.Target));e+=(n-1)*(t.length-1)+1}}}UpdateOldLayer(e,t){this.la.Layers[this.la.y[t]][this.la.x[t]]=e}WidenOriginalLayers(){for(let e=0;e<this.la.Layers.length;e++){const t=this.Nla.Layers[2*e];let n=0;for(const r of this.la.Layers[e]){const s=this.virtNodesToIntEdges[r];if(null!=s){const o=this.NLayering[s.source]-this.NLayering[r],a=this.database.Multiedges.get(s.source,s.target);for(const l of a)if(l!=s){const c=l.LayerEdges[o].Source;t[n]=c,this.Nla.x[c]=n++}else t[n]=r,this.Nla.x[r]=n++}else t[n]=r,this.Nla.x[r]=n++}}}FillUnsortedNewOddLayers(){const e=new Array(this.Nla.Layers.length).fill(0);for(let t=this.intGraph.nodeCount;t<this.nLayeredGraph.NodeCount;t++){const n=this.NLayering[t];n%2==1&&(this.Nla.Layers[n][e[n]++]=t)}}MapVirtualNodesToEdges(){this.virtNodesToIntEdges=new Array(this.NLayering.length);for(const e of this.database.AllIntEdges())if(e.source!=e.target&&null!=e.LayerEdges)for(const t of e.LayerEdges)t.Target!=e.target&&(this.virtNodesToIntEdges[t.Target]=e)}CreateFullLayeredGraph(){this.totalNodes=this.intGraph.nodeCount;for(const e of this.database.RegularMultiedges()){let t=0,n=!0;for(const r of e)if(n&&(n=!1,t=2*r.LayerSpan),t>0){r.LayerEdges=new Array(t);for(let s=0;s<t;s++){const o={currentVV:this.totalNodes},a=ya.GetSource(o,r,s);this.totalNodes=o.currentVV;const l=ya.GetTarget(this.totalNodes,r,s,t);r.LayerEdges[s]=new Lo(a,l,r.CrossingWeight)}Vu.RegisterDontStepOnVertex(this.database,r)}}this.nLayeredGraph=new ma(this.intGraph)}SortNewOddLayers(){for(let e=1;e<this.Nla.Layers.length;e+=2){const t=new LE.SortedMap,n=this.Nla.Layers[e];for(const s of n){let o=-1;for(const c of this.nLayeredGraph.InEdges(s))o=c.Source;let a=-1;for(const c of this.nLayeredGraph.OutEdges(s))a=c.Target;const l=this.Nla.x[o]+this.Nla.x[a];if(t.has(l)){const c=t.get(l);if("number"==typeof c){const u=new Array;u.push(c),u.push(s),t.set(l,u)}else c.push(s)}else t.set(l,s)}let r=0;for(const s of t.values())if("number"==typeof s)n[r++]=s;else for(const o of s)n[r++]=o;for(let s=0;s<n.length;s++)this.Nla.x[n[s]]=s}}InitNewLayering(){this.Nla=new Zs(new Array(this.totalNodes));for(let n=0;n<this.layeredGraph.NodeCount;n++)this.NLayering[n]=2*this.la.y[n];for(const[n,r]of this.database.Multiedges.keyValues())if(n.x!=n.y&&this.la.y[n.x]!=this.la.y[n.y]){const s=2*this.la.y[n.x];for(const o of r){let a=s-1;for(const l of o.LayerEdges)l.Target!=o.target&&(this.NLayering[l.Target]=a--)}}const e=new Array(2*this.la.Layers.length-1),t=new Array(e.length).fill(0);for(const n of this.NLayering)t[n]++;for(let n=0;n<t.length;n++)e[n]=new Array(t[n]);this.Nla=new Zs(this.NLayering),this.Nla.Layers=e}static RegisterDontStepOnVertex(e,t){e.Multiedges.get(t.source,t.target).length>1&&e.MultipleMiddles.add(t.LayerEdges[t.LayerEdges.length/2].Source)}}class ya{constructor(e,t,n,r){this.virtNodesToIntEdges=new Map,this.la=t,this.database=n,this.layeredGraph=e,this.intGraph=r}get NLayering(){return this.Nla.y}static InsertPaths(e,t,n,r){const s=new ya(e,t,n,r);return s.InsertPaths(),{layeredGraph:s.NLayeredGraph,la:s.Nla}}InsertPaths(){this.CreateFullLayeredGraph(),this.InitNewLayering(),this.MapVirtualNodesToEdges(),this.WidenOriginalLayers()}WidenOriginalLayers(){for(let e=0;e<this.la.Layers.length;e++){const t=this.Nla.Layers[e];let n=0;for(const r of this.la.Layers[e]){const s=this.virtNodesToIntEdges.get(r);if(null!=s){const o=this.NLayering[s.source]-this.NLayering[r],a=this.database.Multiedges.get(s.source,s.target);for(const l of a)if(!this.EdgeIsFlat(l))if(l!=s){const c=l.LayerEdges[o].Source;t[n]=c,this.Nla.x[c]=n++}else t[n]=r,this.Nla.x[r]=n++}else t[n]=r,this.Nla.x[r]=n++}}}EdgeIsFlat(e){return this.la.y[e.source]==this.la.y[e.target]}MapVirtualNodesToEdges(){for(const e of this.database.RegularMultiedges())for(const t of e)if(!this.EdgeIsFlat(t))for(const n of t.LayerEdges)n.Target!=t.target&&this.virtNodesToIntEdges.set(n.Target,t)}CreateFullLayeredGraph(){let e=this.layeredGraph.NodeCount;for(const[t,n]of this.database.Multiedges.keyValues())if(t.x!=t.y){let r=!0,s=0;for(const o of n){if(r)r=!1,s=o.LayerSpan;else if(o.LayerEdges=new Array(s),1==s)o.LayerEdges[0]=new Lo(o.source,o.target,o.CrossingWeight);else for(let a=0;a<s;a++){const l={currentVV:e},c=ya.GetSource(l,o,a);e=l.currentVV;const u=ya.GetTarget(e,o,a,s);o.LayerEdges[a]=new Lo(c,u,o.CrossingWeight)}Vu.RegisterDontStepOnVertex(this.database,o)}}this.NLayeredGraph=new ma(this.intGraph)}static GetTarget(e,t,n,r){return n<r-1?e:t.target}static GetSource(e,t,n){return 0==n?t.source:e.currentVV++}InitNewLayering(){this.Nla=new Zs(new Array(this.NLayeredGraph.NodeCount));for(let n=0;n<this.layeredGraph.NodeCount;n++)this.NLayering[n]=this.la.y[n];for(const[n,r]of this.database.Multiedges.keyValues())if(n.x!=n.y&&this.la.y[n.x]!=this.la.y[n.y]){let s=0,o=!0;for(const a of r){o&&(o=!1,s=this.la.y[a.source]);let l=s-1;for(const c of a.LayerEdges)this.NLayering[c.Target]=l--}}const e=new Array(this.la.Layers.length),t=new Array(e.length).fill(0);for(const n of this.NLayering)t[n]++;for(let n=0;n<t.length;n++)e[n]=new Array(t[n]);this.Nla=new Zs(this.NLayering),this.Nla.Layers=e}}const II=BigInt("6364136223846793005"),ME=(BigInt(1)<<BigInt(32))-BigInt(1),eo=(BigInt(1)<<BigInt(64))-BigInt(1);class PI{constructor(e,t){this._state=BigInt(0),this._inc=(BigInt(t)<<BigInt(1)|BigInt(1))&eo,this._random_b(),this._state=this._state+BigInt(e)&eo,this._random_b()}_random_b(){const e=this._state;this._state=e*II+this._inc&eo;const t=(e>>BigInt(18)^e)>>BigInt(27),n=e>>BigInt(59);return(t>>n|t<<(n^BigInt(31)))&ME}_advance(e){e&=eo;let t=BigInt(1),n=II,r=BigInt(0),s=this._inc;for(;e>0;)e&BigInt(1)&&(t=t*n&eo,r=r*n+s&eo),s=(n+BigInt(1))*s&eo,n=n*n&eo,e>>=BigInt(1);this._state=t*this._state+r&eo}randint(e){if(e>ME)throw new TypeError(`Bound too large: ${e}`);if(e<=0)throw new TypeError(`Empty sample space for r: 0 \u2264 r < ${e}`);const t=BigInt(e),n=(ME^t)%t;for(;;){const r=this._random_b();if(r>=n)return Number(r%t)}}random(){return Number(this._random_b())/Math.pow(2,32)}}let Ea;function Gu(i){return null==Ea&&(Ea=new PI(0,0)),Ea.randint(i)}function FE(){return null==Ea&&(Ea=new PI(0,0)),Ea.random()}class NI{constructor(e,t,n){this.numberOfCrossings=t,this.la=e,this.virtVertexStart=n}LayerGroupDisbalance(e,t,n){return 1==t?this.LayerGroupDisbalanceWithOrigSeparators(e,n):this.LayerGroupDisbalanceWithVirtSeparators(e,t)}LayerGroupDisbalanceWithVirtSeparators(e,t){let n=0;for(let r=0;r<e.length;){const s=this.CurrentOrigGroupDelta(r,e,t);r=s.i,n+=s.ret}return n}CurrentOrigGroupDelta(e,t,n){let r=0,s=e;for(;s<t.length&&t[s]<this.virtVertexStart;s++)r++;return e=s+1,{ret:Math.abs(n-r),i:e}}LayerGroupDisbalanceWithOrigSeparators(e,t){let n=0;for(let r=0;r<e.length;){const s=this.CurrentVirtGroupDelta(r,e,t);n+=s.ret,r=s.i}return n}CurrentVirtGroupDelta(e,t,n){let r=0,s=e;for(;s<t.length&&t[s]>=this.virtVertexStart;s++)r++;return e=s+1,{ret:Math.abs(n-r),i:e}}static less(e,t){return e.numberOfCrossings<t.numberOfCrossings}static greater(e,t){return e.numberOfCrossings>t.numberOfCrossings}IsPerfect(){return 0==this.numberOfCrossings}}class V3{constructor(e){this.x=e}Compare(e,t){const n=this.x[e.Source]-this.x[t.Source];return 0!=n?n:this.x[e.Target]-this.x[t.Target]}}class G3{constructor(e){this.x=e}Compare(e,t){const n=this.x[e.Target]-this.x[t.Target];return 0!=n?n:this.x[e.Source]-this.x[t.Source]}}class ai{constructor(e,t){Af(e,t)<0?(this.first=e,this.second=t):(this.first=t,this.second=e)}get First(){return this.first}get Second(){return this.second}get Length(){return It(this.first,this.second)}CompareTo(e){const t=Af(this.first,e.first);return 0!=t?t:Af(this.second,e.second)}static equal(e,t){return e.first.equal(t.first)&&e.second.equal(t.second)}toString(){return this.first+" "+this.second}}class Rn{constructor(){this.size_=0,this.mapOfSets=new Map}delete(e){return this.deletexy(e.x,e.y)}clear(){this.mapOfSets.clear(),this.size_=0}get size(){return this.size_}static mk(e){const t=new Rn;for(const n of e)t.add(n);return t}addxy(e,t){let n=this.mapOfSets.get(e);null==n&&this.mapOfSets.set(e,n=new Set),n.has(t)||this.size_++,n.add(t)}add(e){return this.addxy(e.x,e.y),this}deletexy(e,t){const n=this.mapOfSets.get(e);return!(null==n||!n.delete(t)||(this.size_--,0))}hasxy(e,t){return this.mapOfSets.has(e)&&this.mapOfSets.get(e).has(t)}has(e){return this.hasxy(e.x,e.y)}forEach(e,t){for(const n of this)e(n,n,t)}*entries(){for(const e of this)yield[e,e]}keys(){return this.values()}*values(){for(const e of this.mapOfSets)for(const t of e[1])yield new x(e[0],t)}[(Symbol,Symbol.iterator)](){return this.values()}}function jl(i,e){const t=new Set;for(const n of i)e.has(n)||t.add(n);return t}function zl(i,e){const t=new Set(i);for(const n of e)t.add(n);return t}function wa(i,e){for(const t of e)i.push(t)}function Mo(i,e){const t=new Set;if(i.size<e.size)for(const n of i)e.has(n)&&t.add(n);else for(const n of e)i.has(n)&&t.add(n);return t}function Hu(i,e){for(const t of e)i.add(t)}function If(i,e){if(i.size!=e.size)return!1;for(const t of i)if(!e.has(t))return!1;return!0}function Yu(i,e){const t=[];for(const n of i)for(const r of e(n))t.push(r);return t}function Pf(i,e,t){let n=i.get(e);n||(n=new Set,i.set(e,n)),n.add(t)}function Kl(i,e,t){let n=i.get(e);n||(n=new Array,i.set(e,n)),n.push(t)}function _I(i,e,t){let n=i.get(e);n||(n=new Set,i.set(e,n)),n.add(t)}function U3(i,e,t){_I(i,new ai(e[0],e[1]),t)}function DI(i,e,t){!function W3(i,e,t){const n=i.get(e);n&&n.delete(t)}(i,new ai(e[0],e[1]),t)}function Nf(){return 0==Gu(2)}function j3(i,e,t){const n=t.Layers[i+1],r=t.Layers[i];return r.length<=n.length?function K3(i,e,t){const n=xI(i,e),r=new V3(t.x);n.sort((l,c)=>r.Compare(l,c));let s=1;for(;s<i.length;)s*=2;const o=new Array(2*s-1).fill(0);s--;let a=0;for(const l of n){let c=s+t.x[l.Target];const u=l.CrossingWeight;for(o[c]+=u;c>0;)c%2!=0&&(a+=u*o[c+1]),c=Math.floor((c-1)/2),o[c]+=u}return a}(r,e,t):function z3(i,e,t,n){const r=xI(e,t),s=new G3(n.x);r.sort((c,u)=>s.Compare(c,u));let o=1;for(;o<i.length;)o*=2;const a=new Array(2*o-1).fill(0);o--;let l=0;for(const c of r){let u=o+n.x[c.Source];const y=c.CrossingWeight;for(a[u]+=y;u>0;)u%2!=0&&(l+=y*a[u+1]),u=Math.floor((u-1)/2),a[u]+=y}return l}(n,r,e,t)}function xI(i,e){return Yu(i,t=>Array.from(e.InEdges(t)))}function LI(i,e){let t=0;for(let n=0;n<e.Layers.length-1;n++)t+=j3(n,i,e);return t}class $l extends dn{constructor(e,t,n,r,s,o,a){super(a),this.tryReverse=!0,this.MaxNumberOfAdjacentExchanges=50,this.cancelToken=a,this.tryReverse=t,this.startOfVirtNodes=r,this.layerArrays=n,this.layering=n.y,this.nOfLayers=n.Layers.length,this.layers=n.Layers,this.properLayeredGraph=e,this.hasCrossWeights=s,this.SugSettings=o}get NoGainStepsBound(){return this.SugSettings.NoGainAdjacentSwapStepsBound*this.SugSettings.RepetitionCoefficientForOrdering}get SeedOfRandom(){return Gu(100)}get MaxOfIterations(){return this.SugSettings.MaxNumberOfPassesInOrdering*this.SugSettings.RepetitionCoefficientForOrdering}static OrderLayers(e,t,n,r,s){let o=!1;for(const l of e.Edges)if(1!=l.CrossingWeight){o=!0;break}new $l(e,!0,t,n,o,r,s).run()}run(){if(this.Calculate(),this.tryReverse){const e=this.layerArrays.ReversedClone(),t=new $l(this.properLayeredGraph.ReversedClone(),!1,e,this.startOfVirtNodes,this.hasCrossWeights,this.SugSettings,this.cancelToken);if(t.run(),t.measure<this.measure){for(let n=0;n<this.nOfLayers;n++)DE(e.Layers[n],this.layerArrays.Layers[this.nOfLayers-1-n]);this.layerArrays.UpdateXFromLayers()}}}Calculate(){this.Init(),this.layerArraysCopy=$l.CloneLayers(this.layers,this.layerArraysCopy);let e=0;this.measure=new NI(this.layerArraysCopy,LI(this.properLayeredGraph,this.layerArrays),this.startOfVirtNodes);for(let t=0;t<this.MaxOfIterations&&e<this.NoGainStepsBound&&!this.measure.IsPerfect();t++){this.LayerByLayerSweep(t%2==0),this.AdjacentExchange();const r=new NI(this.layerArrays.Layers,LI(this.properLayeredGraph,this.layerArrays),this.startOfVirtNodes);this.measure<r?(this.Restore(),e++):(r<this.measure||Nf())&&(e=0,this.layerArraysCopy=$l.CloneLayers(this.layers,this.layerArraysCopy),this.measure=r)}}static CloneLayers(e,t){if(null==t){t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].map(r=>r)}else for(let n=0;n<e.length;n++)DE(e[n],t[n]);return t}Restore(){this.layerArrays.updateLayers(this.layerArraysCopy)}LayerByLayerSweep(e){if(e)for(let t=1;t<this.nOfLayers;t++)this.SweepLayer(t,!0);else for(let t=this.nOfLayers-2;t>=0;t--)this.SweepLayer(t,!1)}SweepLayer(e,t){const n=this.layers[e],r=new Array(n.length);for(let o=0;o<r.length;o++)r[o]=this.WMedian(n[o],t);this.Sort(e,r);const s=this.layerArrays.Layers[e];for(let o=0;o<s.length;o++)this.layerArrays.x[s[o]]=o}Sort(e,t){const n=new LE.SortedMap,r=this.layers[e];let s=0;for(const a of t){const l=r[s++];if(-1!=a)if(n.has(a)){const c=n.get(a);if("number"!=typeof c){const u=c;if(Nf())u.push(l);else{const y=Gu(u.length),R=u[y];u[y]=l,u.push(R)}}else{const u=c,y=new Array;n.set(a,y),Nf()?(y.push(u),y.push(l)):(y.push(l),y.push(u))}}else n.set(a,l)}const o=n.values();for(s=0;s<r.length;)if(-1!=t[s]){const a=o.next().value;if("number"==typeof a)r[s++]=a;else{const l=a;for(const c of l){for(;-1==t[s];)s++;r[s++]=c}}}else s++}WMedian(e,t){let n,r;if(t?(n=this.properLayeredGraph.OutEdges(e),r=this.properLayeredGraph.OutEdgesCount(e)):(n=this.properLayeredGraph.InEdges(e),r=this.properLayeredGraph.InEdgesCount(e)),0==r)return-1;const s=new Array(r);let o=0;if(t)for(const u of n)s[o++]=this.X[u.Target];else for(const u of n)s[o++]=this.X[u.Source];s.sort((u,y)=>u-y);const a=Math.floor(r/2);if(r%2==1)return s[a];if(2==r)return.5*(s[0]+s[1]);const l=s[a-1]-s[0],c=s[r-1]-s[a];return Math.floor((s[a-1]*l+s[a]*c)/(l+c))}Init(){const e=new Array(this.nOfLayers).fill(0),t=new Jt.K;for(let r=0;r<this.properLayeredGraph.NodeCount;r++)0==this.properLayeredGraph.InEdgesCount(r)&&t.push(r);const n=new Array(this.properLayeredGraph.NodeCount).fill(!1);for(;t.size>0;){const r=t.pop(),s=this.layerArrays.y[r];this.layerArrays.Layers[s][e[s]]=r,this.layerArrays.x[r]=e[s],e[s]++;for(const o of this.properLayeredGraph.Succ(r))n[o]||(n[o]=!0,t.push(o))}this.X=this.layerArrays.x}AdjacentExchange(){this.InitArrays();let e=0,t=!0;for(;t&&e++<this.MaxNumberOfAdjacentExchanges;){t=!1;for(let n=0;n<this.layers.length;n++)t=this.AdjExchangeLayer(n)||t;for(let n=this.layers.length-2;n>=0;n--)t=this.AdjExchangeLayer(n)||t}}AllocArrays(){const e=this.properLayeredGraph.NodeCount;this.predecessors=new Array(e),this.successors=new Array(e),this.pOrder=new Array(e),this.sOrder=new Array(e),this.hasCrossWeights&&(this.outCrossingCount=new Array(e),this.inCrossingCount=new Array(e));for(let t=0;t<e;t++){let n=this.properLayeredGraph.InEdgesCount(t);if(this.predecessors[t]=new Array(n),this.hasCrossWeights){const r=this.inCrossingCount[t]=new Map;for(const s of this.properLayeredGraph.InEdges(t))r.set(s.Source,s.CrossingWeight)}if(this.pOrder[t]=new Map,n=this.properLayeredGraph.OutEdgesCount(t),this.successors[t]=new Array(n),this.sOrder[t]=new Map,this.hasCrossWeights){const r=this.outCrossingCount[t]=new Map;for(const s of this.properLayeredGraph.OutEdges(t))r.set(s.Target,s.CrossingWeight)}}}InitArrays(){null==this.successors&&this.AllocArrays();for(let e=0;e<this.properLayeredGraph.NodeCount;e++)this.pOrder[e]=new Map,this.sOrder[e]=new Map;for(const e of this.layers)this.InitPsArraysForLayer(e)}CalcPair(e,t){const n=this.successors[e],r=this.successors[t],s=this.predecessors[e],o=this.predecessors[t];if(this.hasCrossWeights){const a=this.outCrossingCount[e],l=this.outCrossingCount[t],c=this.inCrossingCount[e],u=this.inCrossingCount[t];return{cuv:this.CountOnArraysUV(n,r,a,l)+this.CountOnArraysUV(s,o,c,u),cvu:this.CountOnArraysUV(r,n,l,a)+this.CountOnArraysUV(o,s,u,c)}}return{cuv:this.CountOnArrays(n,r)+this.CountOnArrays(s,o),cvu:this.CountOnArrays(r,n)+this.CountOnArrays(o,s)}}InitPsArraysForLayer(e){for(const t of e){for(const n of this.properLayeredGraph.Pred(t)){const r=this.sOrder[n],s=r.size;this.successors[n][s]=t,r.set(t,s)}for(const n of this.properLayeredGraph.Succ(t)){const r=this.pOrder[n],s=r.size;this.predecessors[n][s]=t,r.set(t,s)}}}CountOnArrays(e,t){let n=0;const r=t.length-1;let s=-1,o=0;for(const a of e){const l=this.X[a];for(;s<r&&this.X[t[s+1]]<l;s++)o++;n+=o}return n}CountOnArraysUV(e,t,n,r){let s=0;const o=t.length-1;let a=-1,l=0;for(const c of e){const u=this.X[c];let y;for(;a<o&&this.X[y=t[a+1]]<u;a++)l+=r.get(y);s+=l*n.get(c)}return s}AdjExchangeLayer(e){const t=this.layers[e];return!!this.ExchangeWithGainWithNoDisturbance(t)||(this.DisturbLayer(t),this.ExchangeWithGainWithNoDisturbance(t))}Swap(e,t){const n=this.X[e],r=this.X[t],o=this.layers[this.layering[e]];o[n]=t,o[r]=e,this.X[e]=r,this.X[t]=n,this.UpdateSsContainingUv(e,t),this.UpdatePsContainingUv(e,t)}UpdatePsContainingUv(e,t){if(this.successors[e].length<=this.successors[t].length)for(const n of this.successors[e]){const r=this.pOrder[n];if(r.has(t)){const s=r.get(t),o=this.predecessors[n];o[s-1]=t,o[s]=e,r.set(t,s-1),r.set(e,s)}}else for(const n of this.successors[t]){const r=this.pOrder[n];if(r.has(e)){const s=r.get(t),o=this.predecessors[n];o[s-1]=t,o[s]=e,r.set(t,s-1),r.set(e,s)}}}UpdateSsContainingUv(e,t){if(this.predecessors[e].length<=this.predecessors[t].length)for(const n of this.predecessors[e]){const r=this.sOrder[n];if(r.has(t)){const s=r.get(t),o=this.successors[n];o[s-1]=t,o[s]=e,r.set(t,s-1),r.set(e,s)}}else for(const n of this.predecessors[t]){const r=this.sOrder[n];if(r.has(e)){const s=r.get(t),o=this.successors[n];o[s-1]=t,o[s]=e,r.set(t,s-1),r.set(e,s)}}}DisturbLayer(e){for(let t=0;t<e.length-1;t++)this.AdjacentSwapToTheRight(e,t)}ExchangeWithGainWithNoDisturbance(e){let n,t=!1;do{n=this.ExchangeWithGain(e),t=t||n}while(n);return t}ExchangeWithGain(e){for(let t=0;t<e.length-1;t++)if(this.SwapWithGain(e[t],e[t+1]))return this.SwapToTheLeft(e,t),this.SwapToTheRight(e,t+1),!0;return!1}SwapToTheLeft(e,t){for(let n=t-1;n>=0;n--)this.AdjacentSwapToTheRight(e,n)}SwapToTheRight(e,t){for(let n=t;n<e.length-1;n++)this.AdjacentSwapToTheRight(e,n)}AdjacentSwapToTheRight(e,t){const n=e[t],r=e[t+1],s=this.SwapGain(n,r);(s>0||0==s&&Nf())&&this.Swap(n,r)}SwapGain(e,t){const n=this.CalcPair(e,t);return n.cuv-n.cvu}UvAreOfSameKind(e,t){return e<this.startOfVirtNodes&&t<this.startOfVirtNodes||e>=this.startOfVirtNodes&&t>=this.startOfVirtNodes}NeighborsForbidTheSwap(e,t){return this.UpperNeighborsForbidTheSwap(e,t)||this.LowerNeighborsForbidTheSwap(e,t)}LowerNeighborsForbidTheSwap(e,t){let n,r;return 0!=(n=this.properLayeredGraph.OutEdgesCount(e))&&0!=(r=this.properLayeredGraph.OutEdgesCount(t))&&this.X[this.successors[e][n>>1]]<this.X[this.successors[t][r>>1]]}UpperNeighborsForbidTheSwap(e,t){const n=this.properLayeredGraph.InEdgesCount(e),r=this.properLayeredGraph.InEdgesCount(t);return 0!=n&&0!=r&&this.X[this.predecessors[e][n>>1]]<this.X[this.predecessors[t][r>>1]]}CalcDeltaBetweenGroupsToTheLeftAndToTheRightOfTheSeparator(e,t,n){const r=this.GetKindDelegate(n);let s=0;for(let a=t-1;a>=0&&!r(e[a]);a--)s++;let o=0;for(let a=t+1;a<e.length&&!r(e[a]);a++)o++;return s-o}IsOriginal(e){return e<this.startOfVirtNodes}IsVirtual(e){return e>=this.startOfVirtNodes}GetKindDelegate(e){return this.IsVirtual(e)?this.IsVirtual:this.IsOriginal}SwapWithGain(e,t){return this.SwapGain(e,t)>0&&(this.Swap(e,t),!0)}}class Di{constructor(){this.size_=0,this.mapOfMaps=new Map}deleteP(e){return this.delete(e.x,e.y)}clear(){this.mapOfMaps.clear(),this.size_=0}get size(){return this.size_}setxy(e,t,n){let r=this.mapOfMaps.get(e);null==r&&this.mapOfMaps.set(e,r=new Map),r.has(t)||this.size_++,r.set(t,n)}set(e,t){this.setxy(e.x,e.y,t)}delete(e,t){const n=this.mapOfMaps.get(e);return null!=n&&(n.delete(t)&&this.size_--,!0)}hasxy(e,t){const n=this.mapOfMaps.get(e);return null!=n&&n.has(t)}has(e){return this.hasxy(e.x,e.y)}getxy(e,t){const n=this.mapOfMaps.get(e);if(null!=n)return n.get(t)}get(e){return this.getxy(e.x,e.y)}*keys(){for(const e of this.mapOfMaps)for(const t of e[1])yield new x(e[0],t[0])}*[Symbol.iterator](){for(const e of this.mapOfMaps)for(const t of e[1])yield[new x(e[0],t[0]),t[1]]}*values(){for(const e of this.mapOfMaps)for(const t of e[1])yield t[1]}}class _f{constructor(e,t,n){this.properLayeredGraph=e,this.layerArrays=t,this.nodePositions=n}static UpdateLayerArrays0(e,t,n){new _f(e,t,n).UpdateLayerArrays()}static UpdateLayerArrays1(e,t){const n=_f.BuildInitialNodePositions(e,t);this.UpdateLayerArrays0(e,t,n)}static BuildInitialNodePositions(e,t){const n=new Map;for(let r=0;r<t.Layers.length;r++){let s=0,o=0;for(;s<t.Layers[r].length;){for(;s<t.Layers[r].length&&e.IsVirtualNode(t.Layers[r][s]);)s++;for(let a=o;a<s;a++)n.set(t.Layers[r][a],new x(r,o));s<t.Layers[r].length&&n.set(t.Layers[r][s],new x(r,s)),s++,o=s}}return n}UpdateLayerArrays(){let e=this.CreateInitialOrdering();e=this.BuildOrdering(e),this.RestoreLayerArrays(e)}CreateInitialOrdering(){const e=new Di;for(const t of this.layerArrays.Layers)for(const n of t){const r=this.nodePositions.get(n);e.hasxy(r.x,r.y)||e.setxy(r.x,r.y,[]),e.getxy(r.x,r.y).push(n)}return e}BuildOrdering(e){const t=new Di,n=new Map;for(const r of this.layerArrays.Layers)for(const s of r){const o=this.nodePositions.get(s);t.hasxy(o.x,o.y)||(this.BuildNodeOrdering(e.get(o),n),t.set(o,e.get(o)))}return t}BuildNodeOrdering(e,t){e.sort(this.Comparison(t));for(let n=0;n<e.length;n++)t.set(e[n],n)}firstSucc(e){for(const t of this.properLayeredGraph.Succ(e))return t}firstPred(e){for(const t of this.properLayeredGraph.Pred(e))return t}Comparison(e){return(t,n)=>{const r=this.firstSucc(t),s=this.firstSucc(n);let o=this.firstPred(t),a=this.firstPred(n);const l=this.nodePositions.get(r),c=this.nodePositions.get(s),u=this.nodePositions.get(o),y=this.nodePositions.get(a);if(!l.equal(c))return u.equal(y)?l.compareTo(c):u.compareTo(y);if(this.properLayeredGraph.IsVirtualNode(r))return u.equal(y)?Vt(e.get(r),e.get(s)):u.compareTo(y);for(;this.nodePositions.get(o).equal(this.nodePositions.get(a))&&this.properLayeredGraph.IsVirtualNode(o);)o=this.firstPred(o),a=this.firstPred(a);return this.nodePositions.get(o).equal(this.nodePositions.get(a))?Vt(t,n):this.nodePositions.get(o).compareTo(this.nodePositions.get(a))}}RestoreLayerArrays(e){for(const t of this.layerArrays.Layers){let n=0,r=0;for(;n<t.length;){for(;n<t.length&&this.nodePositions.get(t[r]).equal(this.nodePositions.get(t[n]));)n++;const s=e.get(this.nodePositions.get(t[r]));for(let o=r;o<n;o++)t[o]=s[o-r];r=n}}this.layerArrays.UpdateXFromLayers()}}class Df{static getOrder(e,t){const n=Xs(t.map(([r,s])=>new mt(r,s)),e);return Df.getOrderOnGraph(n)}static getOrderOnGraph(e){const t=new Array(e.nodeCount).fill(!1),n=new Jt.K,r=[];let s;for(let o=0;o<e.nodeCount;o++){if(t[o])continue;let a=o;t[a]=!0;let l=0;for(s=e.outEdges[o];;){for(;l<s.length;l++){const c=s[l].target;t[c]||(t[c]=!0,n.push({edges:s,index:l+1,current_u:a}),a=c,s=e.outEdges[a],l=-1)}if(r.push(a),!(n.length>0))break;{const c=n.pop();s=c.edges,l=c.index,a=c.current_u}}}return r.reverse()}}class $3{constructor(e){this.graph=e}GetLayers(){const e=Df.getOrderOnGraph(this.graph),t=new Array(this.graph.nodeCount).fill(0);let n=this.graph.nodeCount;for(;n-- >0;){const r=e[n];for(const s of this.graph.inEdges[r]){const o=s.source,a=t[r]+s.separation;t[o]<a&&(t[o]=a)}}return t}checkTopoOrder(e){for(const t of this.graph.edges)if(J3(t,e))return!1;return!0}}function J3(i,e){const t=e.findIndex(r=>r==i.source),n=e.findIndex(r=>r==i.target);return-1==t||-1==n||t>=n}class xi{constructor(e){this.inTree=!1,this.cut=xi.infinity,this.iedge=e}get source(){return this.iedge.source}get target(){return this.iedge.target}get separation(){return this.iedge.separation}get crossingWeight(){return this.iedge.CrossingWeight}get weight(){return this.iedge.weight}}xi.infinity=Number.MAX_SAFE_INTEGER;class BE{constructor(e,t,n,r,s){this.v=e,this.outEnum=t,this.i=n,this.inEnum=r,this.j=s}}class FI{constructor(e,t){this.layers=null,this.treeVertices=[],this.vertices=[],this.leaves=[],this.graph=function q3(i){const e=new Array;for(const t of i.edges)e.push(new xi(t));return Xs(e,i.nodeCount)}(e),this.networkCancelToken=t;for(let n=0;n<this.graph.nodeCount;n++)this.vertices.push({inTree:!1,lim:-1,low:-1,parent:null})}get weight(){return this.graph.edges.map(e=>e.weight*(this.layers[e.source]-this.layers[e.target])).reduce((e,t)=>e+t,0)}get nodeCount(){return this.vertices.length}setLow(e,t){this.vertices[e].low=t}setLim(e,t){this.vertices[e].lim=t}setParent(e,t){this.vertices[e].parent=t}GetLayers(){return null==this.layers&&this.run(),this.layers}shiftLayerToZero(){const e=Math.min(...this.layers);for(let t=0;t<this.layers.length;t++)this.layers[t]-=e}addVertexToTree(e){this.vertices[e].inTree=!0}vertexInTree(e){return this.vertices[e].inTree}lim(e){return this.vertices[e].lim}low(e){return this.vertices[e].low}parent(e){return this.vertices[e].parent}feasibleTree(){for(this.initLayers();this.tightTree()<this.nodeCount;){const e=this.getNonTreeEdgeIncidentToTheTreeWithMinimalAmountOfSlack();if(null==e)break;let t=this.slack(e);this.vertexInTree(e.source)&&(t=-t);for(const n of this.treeVertices)this.layers[n]+=t}this.initCutValues()}vertexSourceTargetVal(e,t){const n=t.source,r=t.target;return this.lim(n)>this.lim(r)?this.lim(e)<=this.lim(r)&&this.low(r)<=this.lim(e)?0:1:this.lim(e)<=this.lim(n)&&this.low(n)<=this.lim(e)?1:0}incidentEdges(e){return this.graph.incidentEdges(e)}allLowCutsHaveBeenDone(e){for(const t of this.incidentEdges(e))if(t.inTree&&t.cut==xi.infinity&&t!=this.parent(e))return!1;return!0}edgeSourceTargetVal(e,t){return this.vertexSourceTargetVal(e.source,t)-this.vertexSourceTargetVal(e.target,t)}initCutValues(){this.initLimLowAndParent();let e=new Jt.K;for(const n of this.leaves)e.push(n);let t=new Jt.K;for(;e.length>0;){for(;e.length>0;){const r=e.pop(),s=this.parent(r);if(null==s)continue;let o=0;for(const l of this.incidentEdges(r))if(0==l.inTree){const c=this.edgeSourceTargetVal(l,s);0!=c&&(o+=c*l.weight)}else if(l==s)o+=l.weight;else{const c=s.source==l.target||s.target==l.source?1:-1;o+=this.edgeContribution(l,r)*c}s.cut=o;const a=s.source==r?s.target:s.source;this.allLowCutsHaveBeenDone(a)&&t.push(a)}const n=e;e=t,t=n}}edgeContribution(e,t){let n=e.cut-e.weight;for(const r of this.incidentEdges(t))if(0==r.inTree){const s=this.edgeSourceTargetVal(r,e);-1==s?n+=r.weight:1==s&&(n-=r.weight)}return n}initLimLowAndParent(){this.initLowLimParentAndLeavesOnSubtree(1,0)}initLowLimParentAndLeavesOnSubtree(e,t){const n=new Jt.K;let r=this.graph.outEdges[t],s=-1,o=this.graph.inEdges[t],a=-1;for(n.push(new BE(t,r,s,o,a)),this.vertices[t].low=e;n.length>0;){const l=n.pop();let c;t=l.v,r=l.outEnum,s=l.i,o=l.inEnum,a=l.j;do{for(c=!0;++s<r.length;){const u=r[s];!u.inTree||this.vertices[u.target].low>0||(n.push(new BE(t,r,s,o,a)),this.setParent(t=u.target,u),this.setLow(t,e),r=this.graph.outEdges[t],s=-1,o=this.graph.inEdges[t],a=-1)}for(;++a<o.length;){const u=o[a];if(u.inTree&&!(this.vertices[u.source].low>0)){n.push(new BE(t,r,s,o,a)),this.setLow(t=u.source,e),this.setParent(t,u),r=this.graph.outEdges[t],s=-1,o=this.graph.inEdges[t],a=-1,c=!1;break}}}while(!c);this.setLim(t,e++),this.lim(t)==this.low(t)&&this.leaves.push(t)}}updateLimLowLeavesAndParentsUnderNode(e){const t=this.vertices[e].low,n=this.vertices[e].lim;this.leaves=[];for(let r=0;r<this.nodeCount;r++)t<=this.vertices[r].lim&&this.vertices[r].lim<=n?this.setLow(r,0):this.low(r)==this.lim(r)&&this.leaves.push(r);this.initLowLimParentAndLeavesOnSubtree(t,e)}slack(e){return this.layers[e.source]-this.layers[e.target]-e.separation}getNonTreeEdgeIncidentToTheTreeWithMinimalAmountOfSlack(){let e=null,t=xi.infinity;for(const n of this.treeVertices){for(const r of this.graph.outEdges[n]){if(this.vertexInTree(r.source)&&this.vertexInTree(r.target))continue;const s=this.slack(r);if(s<t&&(e=r,t=s,1==s))return r}for(const r of this.graph.inEdges[n]){if(this.vertexInTree(r.source)&&this.vertexInTree(r.target))continue;const s=this.slack(r);if(s<t&&(e=r,t=s,1==s))return r}}return e}tightTree(){this.treeVertices=[];for(const t of this.graph.edges)t.inTree=!1;for(let t=1;t<this.nodeCount;t++)this.vertices[t].inTree=!1;this.vertices[0].inTree=!0,this.treeVertices.push(0);const e=new Jt.K;for(e.push(0);e.length>0;){const t=e.pop();for(const n of this.graph.outEdges[t])this.vertexInTree(n.target)||this.layers[n.source]-this.layers[n.target]==n.separation&&(e.push(n.target),this.addVertexToTree(n.target),this.treeVertices.push(n.target),n.inTree=!0);for(const n of this.graph.inEdges[t])this.vertexInTree(n.source)||this.layers[n.source]-this.layers[n.target]==n.separation&&(e.push(n.source),this.addVertexToTree(n.source),this.treeVertices.push(n.source),n.inTree=!0)}return this.treeVertices.length}leaveEnterEdge(){let e,t,n=0;for(const o of this.graph.edges)o.inTree&&o.cut<n&&(n=o.cut,e=o);if(null==e)return null;let r=!1,s=xi.infinity;for(const o of this.graph.edges){const a=this.slack(o);if(0==o.inTree&&-1==this.edgeSourceTargetVal(o,e)&&(a<s||a==s&&(r=1==Gu(2)))){if(s=a,t=o,0==s&&!r)break;r=!1}}if(null==t)throw new Error;return{leaving:e,entering:t}}exchange(e,t){const n=this.commonPredecessorOfSourceAndTargetOfF(t);this.createPathForCutUpdates(e,t,n),this.updateLimLowLeavesAndParentsUnderNode(n),this.updateCuts(e),this.updateLayersUnderNode(n)}updateLayersUnderNode(e){const t=new Jt.K;t.push(e);for(let n=0;n<this.nodeCount;n++)this.low(e)<=this.lim(n)&&this.lim(n)<=this.lim(e)&&n!=e&&(this.layers[n]=xi.infinity);for(;t.length>0;){const n=t.pop();for(const r of this.graph.outEdges[n])r.inTree&&this.layers[r.target]==xi.infinity&&(this.layers[r.target]=this.layers[n]-r.separation,t.push(r.target));for(const r of this.graph.inEdges[n])r.inTree&&this.layers[r.source]==xi.infinity&&(this.layers[r.source]=this.layers[n]+r.separation,t.push(r.source))}}updateCuts(e){let t=new Jt.K,n=new Jt.K;for(t.push(e.source),t.push(e.target);t.length>0;){for(;t.length>0;){const s=t.pop(),o=this.parent(s);if(null==o||o.cut!=xi.infinity)continue;let a=0;for(const c of this.incidentEdges(s))if(0==c.inTree)a+=this.edgeSourceTargetVal(c,o)*c.weight;else if(c==o)a+=c.weight;else{const u=o.source==c.target||o.target==c.source?1:-1;a+=this.edgeContribution(c,s)*u}o.cut=a;const l=o.source==s?o.target:o.source;this.allLowCutsHaveBeenDone(l)&&n.push(l)}const r=t;t=n,n=r}}createPathForCutUpdates(e,t,n){let r=t.target;for(;r!=n;){const s=this.parent(r);s.cut=xi.infinity,r=s.source==r?s.target:s.source}t.cut=xi.infinity,e.inTree=!1,t.inTree=!0}commonPredecessorOfSourceAndTargetOfF(e){let t,n;this.lim(e.source)<this.lim(e.target)?(t=this.lim(e.source),n=this.lim(e.target)):(t=this.lim(e.target),n=this.lim(e.source));let r=e.source;for(;!(this.low(r)<=t&&n<=this.lim(r));){const s=this.parent(r);s.cut=xi.infinity,r=s.source==r?s.target:s.source}return r}checkCutValues(){for(const e of this.graph.edges)if(e.inTree){let t=0;for(const n of this.graph.edges)t+=this.edgeSourceTargetVal(n,e)*n.weight;e.cut!=t&&console.log(Hn.String.Format("cuts are wrong for {0}; should be {1} but is {2}",e,t,e.cut))}}initLayers(){const e=new $3(this.graph);return this.layers=e.GetLayers()}run(){if(0==this.graph.edges.length&&0==this.graph.nodeCount)this.layers=[];else{let e;for(this.feasibleTree();null!=(e=this.leaveEnterEdge());)this.exchange(e.leaving,e.entering);this.shiftLayerToZero()}}}class Q3{constructor(e,t){this.graph=e,this.Cancel=t}GetLayers(){return new FI(this.graph,this.Cancel).GetLayers()}ShrunkComponent(e){const t=[];for(const n of e){const r=n[0],s=n[1];for(const o of this.graph.outEdges[r]){const a=new qr(s,e.get(o.target),o.edge);a.separation=o.separation,a.weight=o.weight,t.push(a)}}return new ku(t,e.size)}}class qi{constructor(e){this.padding=0,this.alreadySitsOnASpline=!1,this.labelIsToTheLeftOfTheSpline=!1,this.labelIsToTheRightOfTheSpline=!1,this.labelCornersPreserveCoefficient=e}toString(){return"la:ra "+this.la+" "+this.ra+" ta:ba "+this.ta+" "+this.ba+" x:y "+this.x_+" "+this.y_}get leftAnchor(){return this.la}set leftAnchor(e){this.la=Math.max(e,0)}get rightAnchor(){return this.ra}set rightAnchor(e){this.ra=Math.max(e,0)}get topAnchor(){return this.ta}set topAnchor(e){this.ta=Math.max(e,0)}get bottomAnchor(){return this.ba}set bottomAnchor(e){this.ba=Math.max(e,0)}get left(){return this.x_-this.la}get right(){return this.x_+this.ra}get top(){return this.y_+this.ta}set top(e){this.y_+=e-this.ta}get bottom(){return this.y_-this.ba}set bottom(e){this.y_+=e-this.ba}get leftTop(){return new x(this.left,this.top)}get leftBottom(){return new x(this.left,this.bottom)}get rightBottom(){return new x(this.right,this.bottom)}get node(){return this.node_}set node(e){this.node_=e,this.polygonalBoundary_=null}get rightTop(){return new x(this.right,this.top)}static mkAnchor(e,t,n,r,s,o){const a=new qi(o);return a.la=e,a.ra=t,a.ta=n,a.ba=r,a.node=s,a}get x(){return this.x_}set x(e){this.polygonalBoundary_=null,this.x_=e}get y(){return this.y_}set y(e){this.polygonalBoundary_=null,this.y_=e}get origin(){return new x(this.x,this.y)}get width(){return this.la+this.ra}get height(){return this.ta+this.ba}get hasLabel(){return this.labelIsToTheLeftOfTheSpline||this.labelIsToTheLeftOfTheSpline}get LabelWidth(){if(this.labelIsToTheLeftOfTheSpline)return this.leftAnchor;if(this.labelIsToTheRightOfTheSpline)return this.rightAnchor;throw new Error}get polygonalBoundary(){return null!=this.polygonalBoundary_?this.polygonalBoundary_:this.polygonalBoundary_=qi.pad(this.creatPolygonalBoundaryWithoutPadding(),this.padding)}static pad(e,t){return 0==t?e:qi.curveIsConvex(e)?qi.padConvexCurve(e,t):qi.padConvexCurve(e.boundingBox.perimeter(),t)}static padCorner(e,t,n,r,s){const o=qi.getPaddedCorner(t,n,r,s);e.addPoint(o.a),2==o.numberOfPoints&&e.addPoint(o.b)}static padConvexCurve(e,t){const n=new He;qi.padCorner(n,e.endPoint.prev,e.endPoint,e.startPoint,t),qi.padCorner(n,e.endPoint,e.startPoint,e.startPoint.next,t);for(let r=e.startPoint;null!=r.next.next;r=r.next)qi.padCorner(n,r,r.next,r.next.next,t);return n.closed=!0,n}static getPaddedCorner(e,t,n,r){const s=e.point,o=t.point,a=n.point,l=x.getTriangleOrientation(s,o,a)==Ie.Counterclockwise,c=o.sub(s),u=c.rotate((l?-Math.PI:Math.PI)/2).normalize(),y=c.normalize().add(o.sub(a).normalize());if(y.length<q.intersectionEpsilon)return{a:o.add(u.mul(r)),b:null,numberOfPoints:1};const R=y.normalize().mul(r),D=R.rotate(Math.PI/2),L=(r-R.dot(u))/D.dot(u);return{a:R.add(D.mul(L)).add(o),b:R.sub(D.mul(L)).add(o),numberOfPoints:2}}static*orientations(e){yield x.getTriangleOrientation(e.endPoint.point,e.startPoint.point,e.startPoint.next.point),yield x.getTriangleOrientation(e.endPoint.prev.point,e.endPoint.point,e.startPoint.point);let t=e.startPoint;for(;null!=t.next.next;)yield x.getTriangleOrientation(t.point,t.next.point,t.next.next.point),t=t.next}static curveIsConvex(e){let t=Ie.Collinear;for(const n of qi.orientations(e))if(n!=Ie.Collinear)if(t==Ie.Collinear)t=n;else if(n!=t)return!1;return!0}creatPolygonalBoundaryWithoutPadding(){return this.hasLabel?this.labelIsToTheLeftOfTheSpline?this.polygonOnLeftLabel():this.polygonOnRightLabel():null==this.nodeBoundary?this.standardRectBoundary():te.polylineAroundClosedCurve(this.nodeBoundary)}get nodeBoundary(){return null==this.node?null:this.node.boundaryCurve}standardRectBoundary(){const e=new He;return e.addPoint(this.leftTop),e.addPoint(this.rightTop),e.addPoint(this.rightBottom),e.addPoint(this.leftBottom),e.closed=!0,e}polygonOnLeftLabel(){const e=this.left+(1-this.labelCornersPreserveCoefficient)*this.LabelWidth;return He.mkClosedFromPoints([new x(e,this.top),this.rightTop,this.rightBottom,new x(e,this.bottom),new x(this.left,this.y)])}polygonOnRightLabel(){const e=this.right-(1-this.labelCornersPreserveCoefficient)*this.LabelWidth;return He.mkClosedFromPoints([new x(e,this.top),new x(this.right,this.y),new x(e,this.bottom),this.leftBottom,this.leftTop])}move(e){this.x+=e.x,this.y+=e.y}}let X3=(()=>{class i{constructor(t,n,r,s,o){this.xCoords=new Array(4),this.la=t,this.graph=n,this.nOfOriginalVertices=r,this.nOfVertices=this.graph.NodeCount,this.markedEdges=new Qr,this.h=this.la.Layers.length,this.root=new Array(this.nOfVertices),this.align=new Array(this.nOfVertices),this.anchors=s,this.nodeSep=o}get CurrentEnumRightUp(){return(this.LR?0:1)+2*(this.BT?0:1)}IsVirtual(t){return t>=this.nOfOriginalVertices}Source(t){return this.BT?t.Source:t.Target}Target(t){return this.BT?t.Target:t.Source}static CalculateXCoordinates(t,n,r,s,o){new i(t,n,r,s,o).Calculate()}Calculate(){this.SortInAndOutEdges(),this.RightUpSetup(),this.CalcBiasedAlignment(),this.LeftUpSetup(),this.CalcBiasedAlignment(),this.RightDownSetup(),this.CalcBiasedAlignment(),this.LeftDownSetup(),this.CalcBiasedAlignment(),this.HorizontalBalancing()}SortInAndOutEdges(){this.FillLowMedians(),this.FillUpperMedins()}FillUpperMedins(){this.upperMedians=new Array(this.graph.NodeCount);for(let t=0;t<this.graph.NodeCount;t++)this.FillUpperMediansForNode(t)}CompareByX(t,n){return this.la.x[t]-this.la.x[n]}FillUpperMediansForNode(t){let n=this.graph.InEdgesCount(t);if(n>0){const r=new Array(n);n=0;for(const o of this.graph.InEdges(t))r[n++]=o.Source;r.sort((o,a)=>this.CompareByX(o,a));const s=Math.floor(n/2);this.upperMedians[t]=2*s==n?new mt(r[s-1],r[s]):r[s]}else this.upperMedians[t]=-1}FillLowMedians(){this.lowMedians=new Array(this.graph.NodeCount);for(let t=0;t<this.graph.NodeCount;t++)this.FillLowMediansForNode(t)}FillLowMediansForNode(t){let n=this.graph.OutEdgesCount(t);if(n>0){const r=new Array(n);n=0;for(const o of this.graph.OutEdges(t))r[n++]=o.Target;r.sort((o,a)=>this.CompareByX(o,a));const s=Math.floor(n/2);this.lowMedians[t]=2*s==n?new mt(r[s-1],r[s]):r[s]}else this.lowMedians[t]=-1}HorizontalBalancing(){let t=-1;const n=new Array(4),r=new Array(4);let s=Number.MAX_VALUE;for(let a=0;a<4;a++){const l={a:0,b:0};this.AssignmentBounds(a,l),n[a]=l.a,r[a]=l.b;const c=r[a]-n[a];c<s&&(t=a,s=c)}for(let a=0;a<4;a++){let l;if(l=i.IsLeftMostAssignment(a)?n[t]-n[a]:r[t]-r[a],this.x=this.xCoords[a],0!=l)for(let c=0;c<this.nOfVertices;c++)this.x[c]=this.x[c]+l}const o=new Array(4);for(let a=0;a<this.nOfVertices;a++)o[0]=this.xCoords[0][a],o[1]=this.xCoords[1][a],o[2]=this.xCoords[2][a],o[3]=this.xCoords[3][a],o.sort((l,c)=>l-c),this.anchors[a].x=(o[1]+o[2])/2}static IsLeftMostAssignment(t){return 0==t||2==t}AssignmentBounds(t,n){if(0==this.nOfVertices)n.a=0,n.b=0;else{this.x=this.xCoords[t],n.a=n.b=this.x[0];for(let r=1;r<this.nOfVertices;r++){const s=this.x[r];s<n.a?n.a=s:s>n.b&&(n.b=s)}}}CalcBiasedAlignment(){this.ConflictElimination(),this.Align()}LeftUpSetup(){this.LR=!1,this.BT=!0}LeftDownSetup(){this.LR=!1,this.BT=!1}RightDownSetup(){this.LR=!0,this.BT=!1}RightUpSetup(){this.LR=!0,this.BT=!0}ConflictElimination(){this.RemoveMarksFromEdges(),this.MarkConflictingEdges()}*UpperEdgeMedians(t){const n=this.BT?this.upperMedians[t]:this.lowMedians[t];if("number"!=typeof n){const s=n;this.LR?(yield s.x,yield s.y):(yield s.y,yield s.x)}else{const s=n;s>=0&&(yield s)}}MarkConflictingEdges(){let t=this.LowerOf(0,this.h-1);const n=t,r=this.UpperOf(0,this.h-1),s=this.NextLower(r);for(;this.IsBelow(t,r);t=this.NextUpper(t))this.IsBelow(n,t)&&this.IsBelow(t,s)&&this.ConflictsWithAtLeastOneInnerEdgeForALayer(t)}NextUpper(t){return this.BT?t+1:t-1}NextLower(t){return this.BT?t-1:t+1}UpperOf(t,n){return this.BT?Math.max(t,n):Math.min(t,n)}LowerOf(t,n){return this.BT?Math.min(t,n):Math.max(t,n)}IsBelow(t,n){return this.BT?t<n:n<t}LeftMost(t,n){return this.LR?Math.min(t,n):Math.max(t,n)}RightMost(t,n){return this.LR?Math.max(t,n):Math.min(t,n)}IsNotRightFrom(t,n){return this.LR?t<=n:n<=t}IsLeftFrom(t,n){return this.LR?t<n:n<t}NextRight(t){return this.LR?t+1:t-1}NextLeft(t){return this.LR?t-1:t+1}ConflictsWithAtLeastOneInnerEdgeForALayer(t){if(t>=0&&t<this.la.Layers.length){const n=this.la.Layers[t];let r=null,s=this.LeftMost(0,n.length-1);const o=this.RightMost(0,n.length-1);for(;this.IsNotRightFrom(s,o)&&null==r;s=this.NextRight(s))r=this.InnerEdgeByTarget(n[s]);if(null!=r){const a=this.Pos(this.Source(r));for(let c=this.LeftMost(0,n.length-1);this.IsLeftFrom(c,s);c=this.NextRight(c))for(const u of this.InEdges(n[c]))this.IsLeftFrom(a,this.Pos(this.Source(u)))&&this.MarkEdge(u);let l=this.Pos(this.Source(r));for(;this.IsNotRightFrom(s,o);){const c=this.AlignmentToTheRightOfInner(n,s,a);if(s=this.NextRight(s),null!=c){const u=this.Pos(this.Source(c));this.MarkEdgesBetweenInnerAndNewInnerEdges(n,r,c,l,u),r=c,l=u}}for(let c=this.NextRight(this.Pos(this.Target(r)));this.IsNotRightFrom(c,o);c=this.NextRight(c))for(const u of this.InEdges(n[c]))this.IsLeftFrom(this.Pos(this.Source(u)),this.Pos(this.Source(r)))&&this.MarkEdge(u)}}}InEdgeOfVirtualNode(t){return this.BT?this.graph.InEdgeOfVirtualNode(t):this.graph.OutEdgeOfVirtualNode(t)}InEdges(t){return this.BT?this.graph.InEdges(t):this.graph.OutEdges(t)}MarkEdgesBetweenInnerAndNewInnerEdges(t,n,r,s,o){let a=this.NextRight(this.Pos(this.Target(n)));for(;this.IsLeftFrom(a,this.Pos(this.Target(r)));a=this.NextRight(a))for(const l of this.InEdges(t[a])){const c=this.Pos(this.Source(l));(this.IsLeftFrom(c,s)||this.IsLeftFrom(o,c))&&this.MarkEdge(l)}}AlignmentToTheRightOfInner(t,n,r){if(1==this.NumberOfInEdges(t[n])){let o=null;for(const a of this.InEdges(t[n]))o=a;return this.IsInnerEdge(o)&&this.IsLeftFrom(r,this.Pos(o.Source))?o:null}return null}NumberOfInEdges(t){return this.BT?this.graph.InEdgesCount(t):this.graph.OutEdgesCount(t)}Pos(t){return this.la.x[t]}InnerEdgeByTarget(t){if(this.IsVirtual(t)){const n=this.InEdgeOfVirtualNode(t);if(this.IsVirtual(this.Source(n)))return n}return null}IsInnerEdge(t){return this.IsVirtual(t.Source)&&this.IsVirtual(t.Target)}RemoveMarksFromEdges(){this.markedEdges.clear()}Align(){this.CreateBlocks(),this.AssignCoordinatesByLongestPath()}AssignCoordinatesByLongestPath(){this.x=this.xCoords[this.CurrentEnumRightUp]=new Array(this.nOfVertices);const t=new Array;for(let s=0;s<this.nOfVertices;s++)if(s==this.root[s]){let o=s;do{const a={neighbor:0};this.TryToGetRightNeighbor(o,a)&&t.push(new qr(s,this.root[a.neighbor],null)),o=this.align[o]}while(o!=s)}const n=Xs(t,this.nOfVertices),r=Df.getOrderOnGraph(n);for(const s of r)if(s==this.root[s]){let o=0,a=!0,l=s;do{const c={neighbor:0};this.TryToGetLeftNeighbor(l,c)&&(a?(o=this.x[this.root[c.neighbor]]+this.DeltaBetweenVertices(c.neighbor,l),a=!1):o=this.RightMost(o,this.x[this.root[c.neighbor]]+this.DeltaBetweenVertices(c.neighbor,l))),l=this.align[l]}while(l!=s);this.x[s]=o}for(const s of r)if(s==this.root[s]&&0==n.inEdges[s].length){let o=s,a=this.RightMost(-i.infinity,i.infinity);const l=a;do{const c={neighbor:0};this.TryToGetRightNeighbor(o,c)&&(a=this.LeftMost(a,this.x[this.root[c.neighbor]]-this.DeltaBetweenVertices(o,c.neighbor))),o=this.align[o]}while(o!=s);l!=a&&(this.x[s]=a)}for(let s=0;s<this.nOfVertices;s++)s!=this.root[s]&&(this.x[s]=this.x[this.root[s]])}TryToGetRightNeighbor(t,n){const r=this.NextRight(this.Pos(t)),s=this.la.Layers[this.la.y[t]];return r>=0&&r<s.length&&(n.neighbor=s[r],!0)}TryToGetLeftNeighbor(t,n){const r=this.NextLeft(this.Pos(t)),s=this.la.Layers[this.la.y[t]];return r>=0&&r<s.length&&(n.neighbor=s[r],!0)}CreateBlocks(){for(let n=0;n<this.nOfVertices;n++)this.root[n]=this.align[n]=n;const t=this.LowerOf(0,this.h-1);for(let n=this.NextLower(this.UpperOf(0,this.h-1));!this.IsBelow(n,t);n=this.NextLower(n)){const r=this.la.Layers[n];let s=this.LeftMost(-1,this.la.Layers[this.NextUpper(n)].length);const o=this.RightMost(0,r.length-1);for(let a=this.LeftMost(0,r.length-1);this.IsNotRightFrom(a,o);a=this.NextRight(a)){const l=r[a];for(const c of this.UpperEdgeMedians(l))if(!this.IsMarked(l,c)&&this.IsLeftFrom(s,this.Pos(c))){this.align[c]=l,this.root[l]=this.root[c],this.align[l]=this.root[c],s=this.Pos(c);break}}}}IsMarked(t,n){return this.BT?this.markedEdges.hasxy(n,t):this.markedEdges.hasxy(t,n)}MarkEdge(t){this.markedEdges.addNN(t.Source,t.Target)}DeltaBetweenVertices(t,n){let r;if(this.Pos(t)>this.Pos(n)){const s=t;t=n,n=s,r=-1}else r=1;return(this.anchors[t].rightAnchor+this.anchors[n].leftAnchor+this.nodeSep)*r}}return i.infinity=1e7,i})();class Z3 extends Si{constructor(e,t,n,r,s){super(),this.weightMultiplierOfOriginalOriginal=1,this.weightMultOfOneVirtual=3,this.weightMultiplierOfTwoVirtual=8,this.SetEdges(r,s),this.virtualVerticesStart=e.nodeCount,this.virtualVerticesEnd=t.NodeCount-1,this.layeredGraph=t,this.layerArrays=n}EdgeWeightMultiplier(e){const t=e.source,n=e.target;if(t<this.layeredGraph.NodeCount&&this.layerArrays.y[t]==this.layerArrays.y[n]&&this.layerArrays.x[t]==this.layerArrays.x[n]+1)return 0;let r=0,s=-1,o=-1;for(const l of this.outEdges[t])-1==o?o=l.target:s=l.target;return o>=this.virtualVerticesStart&&o<=this.virtualVerticesEnd&&r++,s>=this.virtualVerticesStart&&s<=this.virtualVerticesEnd&&r++,0==r?this.weightMultiplierOfOriginalOriginal:1==r?this.weightMultOfOneVirtual:this.weightMultiplierOfTwoVirtual}SetEdgeWeights(){for(const e of this.edges)e.weight=e.weight*this.EdgeWeightMultiplier(e)}}var Yn=(()=>{return(i=Yn||(Yn={}))[i.Top=0]="Top",i[i.Internal=1]="Internal",i[i.Bottom=2]="Bottom",Yn;var i})();class Jl{constructor(e,t){this.groupSplitThreshold=2,this.initialNodes=e,this.groupSplitThreshold=t}static Calculate(e,t=0){return new Jl(e,t).Calculate()}Calculate(){return this.Calc(this.initialNodes)}Calc(e){if(0==e.length)return null;if(1==e.length)return e[0];const t=e[0].parallelogram;let s,n=1,r=Et.parallelogramOfTwo(t,e[n].parallelogram).area;for(let u=2;u<e.length;u++){const y=Et.parallelogramOfTwo(t,e[u].parallelogram).area;y>r&&(n=u,r=y)}for(let u=0;u<e.length;u++)if(u!=n){s=u;break}r=Et.parallelogramOfTwo(e[n].parallelogram,e[s].parallelogram).area;for(let u=0;u<e.length;u++){if(u==n)continue;const y=Et.parallelogramOfTwo(e[n].parallelogram,e[u].parallelogram).area;y>r&&(s=u,r=y)}const o=new Array,a=new Array;o.push(e[n]),a.push(e[s]);let l=e[n].parallelogram,c=e[s].parallelogram;for(let u=0;u<e.length;u++){if(u==n||u==s)continue;const y=Et.parallelogramOfTwo(l,e[u].parallelogram),R=y.area-l.area,D=Et.parallelogramOfTwo(c,e[u].parallelogram),L=D.area-c.area;o.length*this.groupSplitThreshold<a.length?(o.push(e[u]),l=y):a.length*this.groupSplitThreshold<o.length?(a.push(e[u]),c=D):R<L?(o.push(e[u]),l=y):(a.push(e[u]),c=D)}return{parallelogram:Et.parallelogramOfTwo(l,c),node:{children:[this.Calc(o),this.Calc(a)]},seg:void 0,leafBoxesOffset:void 0}}}class Qi{constructor(e,t,n,r,s,o,a,l){this.topNode=e,this.bottomNode=t,this.topSite=n,this.bottomSite=n.next,this.currentTopSite=n,this.currentBottomSite=n.next,this.layerArrays=r,this.layeredGraph=s,this.originalGraph=o,this.anchors=a,this.layerSeparation=l}static Refine(e,t,n,r,s,o,a,l){new Qi(e,t,n,s,o,a,r,l).Refine()}Refine(){for(this.Init();this.InsertSites(););}FixCorner(e,t,n){if(e.equal(t))return t;const r=x.ClosestPointAtLineSegment(t,e,n);let s=t.sub(r);const o=Math.abs(s.y),a=this.layerSeparation/2;return o>a&&(s=s.mul(a/(2*o))),s.add(t)}InsertSites(){return 0==Gu(2)?this.CalculateNewTopSite()||this.CalculateNewBottomSite():this.CalculateNewBottomSite()||this.CalculateNewTopSite()}CalculateNewBottomSite(){const e=this.currentBottomSite.point.sub(this.currentTopSite.point);let n,t=Qi.absCotan(e),r=!1;for(const s of this.bottomCorners()){const o=Qi.absCotan(s.sub(this.currentBottomSite.point));o<t&&(t=o,n=s,r=!0)}return!!r&&!ht(t,Qi.absCotan(e))&&(this.currentBottomSite=$t.mkSiteSPS(this.currentTopSite,this.FixCorner(this.currentTopSite.point,n,this.currentBottomSite.point),this.currentBottomSite),!0)}static absCotan(e){return Math.abs(e.x/e.y)}CalculateNewTopSite(){const e=this.currentBottomSite.point.sub(this.currentTopSite.point);let n,t=Qi.absCotan(e),r=!1;for(const s of this.topCorners()){const o=Qi.absCotan(s.sub(this.currentTopSite.point));o<t&&(t=o,n=s,r=!0)}return!!r&&!ht(t,Qi.absCotan(e))&&(this.currentTopSite=$t.mkSiteSPS(this.currentTopSite,this.FixCorner(this.currentTopSite.point,n,this.currentBottomSite.point),this.currentBottomSite),!0)}Init(){this.IsTopToTheLeftOfBottom()?(this.topCorners=()=>this.CornersToTheRightOfTop(),this.bottomCorners=()=>this.CornersToTheLeftOfBottom()):(this.topCorners=()=>this.CornersToTheLeftOfTop(),this.bottomCorners=()=>this.CornersToTheRightOfBottom())}IsTopToTheLeftOfBottom(){return this.topSite.point.x<this.topSite.next.point.x}*NodeCorners(e){for(const t of this.anchors[e].polygonalBoundary.polylinePoints())yield t.point}*CornersToTheLeftOfBottom(){const e=this.layerArrays.x[this.bottomNode],t=this.currentTopSite.point.x,n=this.currentBottomSite.point.x;for(const r of this.LeftFromTheNode(this.NodeLayer(this.bottomNode),e,Yn.Bottom,t,n))for(const s of this.NodeCorners(r))s.y>this.currentBottomSite.point.y&&Qi.PossibleCorner(t,n,s)&&(yield s)}*CornersToTheLeftOfTop(){const e=this.layerArrays.x[this.topNode],t=this.currentBottomSite.point.x,n=this.currentTopSite.point.x;for(const r of this.LeftFromTheNode(this.NodeLayer(this.topNode),e,Yn.Top,t,n))for(const s of this.NodeCorners(r))s.y<this.currentTopSite.point.y&&Qi.PossibleCorner(t,n,s)&&(yield s)}*CornersToTheRightOfBottom(){const e=this.layerArrays.x[this.bottomNode],t=this.currentBottomSite.point.x,n=this.currentTopSite.point.x;for(const r of this.RightFromTheNode(this.NodeLayer(this.bottomNode),e,Yn.Bottom,t,n))for(const s of this.NodeCorners(r))s.y>this.currentBottomSite.point.y&&Qi.PossibleCorner(t,n,s)&&(yield s)}*CornersToTheRightOfTop(){const e=this.layerArrays.x[this.topNode],t=this.currentTopSite.point.x,n=this.currentBottomSite.point.x;for(const r of this.RightFromTheNode(this.NodeLayer(this.topNode),e,Yn.Top,t,n))for(const s of this.NodeCorners(r))s.y<this.currentTopSite.point.y&&Qi.PossibleCorner(t,n,s)&&(yield s)}static PossibleCorner(e,t,n){return n.x>e&&n.x<t}NodeLayer(e){return this.layerArrays.Layers[this.layerArrays.y[e]]}IsLabel(e){return this.anchors[e].hasLabel}NodeUCanBeCrossedByNodeV(e,t){return!this.IsLabel(e)&&!this.IsLabel(t)&&!!(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t)&&this.AdjacentEdgesIntersect(e,t))}AdjacentEdgesIntersect(e,t){return this.Intersect(this.IncomingEdge(e),this.IncomingEdge(t))||this.Intersect(this.OutcomingEdge(e),this.OutcomingEdge(t))}Intersect(e,t){return(this.layerArrays.x[e.Source]-this.layerArrays.x[t.Source])*(this.layerArrays.x[e.Target]-this.layerArrays.x[t.Target])<0}IncomingEdge(e){for(const t of this.layeredGraph.InEdges(e))return t;throw new Error}OutcomingEdge(e){for(const t of this.layeredGraph.OutEdges(e))return t;throw new Error}IsVirtualVertex(e){return e>=this.originalGraph.shallowNodeCount}*RightFromTheNode(e,t,n,r,s){let o=0,a=0;n==Yn.Bottom&&(o=Number.MAX_VALUE),n==Yn.Top&&(a=Number.MAX_VALUE);const l=e[t];for(let c=t+1;c<e.length;c++){const u=e[c];if(this.NodeUCanBeCrossedByNodeV(u,l))continue;const y=this.anchors[u];if(y.left>=s)break;y.right>r&&(y.topAnchor>a+q.distanceEpsilon?(a=y.topAnchor,yield u):y.bottomAnchor>o+q.distanceEpsilon&&(o=y.bottomAnchor,yield u))}}*LeftFromTheNode(e,t,n,r,s){let o=0,a=0;n==Yn.Bottom&&(o=Number.MAX_VALUE),n==Yn.Top&&(a=Number.MAX_VALUE);const l=e[t];for(let c=t-1;c>-1;c--){const u=e[c];if(this.NodeUCanBeCrossedByNodeV(u,l))continue;const y=this.anchors[u];if(y.right<=r)break;y.left<s&&(y.topAnchor>a+q.distanceEpsilon?(a=y.topAnchor,yield u):y.bottomAnchor>o+q.distanceEpsilon&&(o=y.bottomAnchor,yield u))}}}class li{constructor(e,t,n,r,s,o,a){this.thinRightNodes=new Array,this.thinWestNodes=new Array,this.database=a,this.edgePath=e,this.anchors=t,this.layerArrays=s,this.originalGraph=n,this.settings=r,this.layeredGraph=o,this.eastHierarchy=this.BuildEastHierarchy(),this.westHierarchy=this.BuildWestHierarchy()}BuildEastHierarchy(){const e=this.FindEastBoundaryAnchorCurves(),t=new Array;for(const n of e)t.push(n.pNodeOverICurve());return this.thinEastHierarchy=Jl.Calculate(this.thinRightNodes),Jl.Calculate(t)}BuildWestHierarchy(){const e=this.FindWestBoundaryAnchorCurves(),t=new Array;for(const n of e)t.push(n.pNodeOverICurve());return this.thinWestHierarchy=Jl.Calculate(this.thinWestNodes),Jl.Calculate(t)}FindEastBoundaryAnchorCurves(){const e=new Array;let t=0;for(const n of this.edgePath){let r=null;for(const s of this.EastBoundaryNodesOfANode(n,Yo.GetNodeKind(t,this.edgePath))){const o=this.anchors[s];(null==r||r.origin.x>o.origin.x)&&(r=o),e.push(o.polygonalBoundary)}null!=r&&this.thinRightNodes.push(me.mkLinePXY(r.origin,this.originalGraph.right,r.y).pNodeOverICurve()),t++}return e}FindWestBoundaryAnchorCurves(){const e=[];let t=0;for(const n of this.edgePath.nodes()){let r=-1;for(const s of this.LeftBoundaryNodesOfANode(n,Yo.GetNodeKind(t,this.edgePath)))(-1==r||this.layerArrays.x[s]>this.layerArrays.x[r])&&(r=s),e.push(this.anchors[s].polygonalBoundary);if(-1!=r){const s=this.anchors[r];this.thinWestNodes.push(me.mkLinePXY(s.origin,this.originalGraph.left,s.origin.y).pNodeOverICurve())}t++}return e}*FillRightTopAndBottomVerts(e,t,n){let r=0,s=0;n==Yn.Bottom?r=Number.MAX_VALUE:n==Yn.Top&&(s=Number.MAX_VALUE);const o=e[t];for(let a=t+1;a<e.length;a++){const l=e[a],c=this.anchors[l];c.topAnchor>s?this.NodeUCanBeCrossedByNodeV(l,o)||(s=c.topAnchor,c.bottomAnchor>r&&(r=c.bottomAnchor),yield l):c.bottomAnchor>r&&(this.NodeUCanBeCrossedByNodeV(l,o)||(r=c.bottomAnchor,c.topAnchor>s&&(s=c.topAnchor),yield l))}}*FillLeftTopAndBottomVerts(e,t,n){let r=0,s=0;n==Yn.Top?s=Number.MAX_VALUE:n==Yn.Bottom&&(r=Number.MAX_VALUE);const o=e[t];for(let a=t-1;a>=0;a--){const l=e[a],c=this.anchors[l];c.topAnchor>s+q.distanceEpsilon?this.NodeUCanBeCrossedByNodeV(l,o)||(s=c.topAnchor,r=Math.max(r,c.bottomAnchor),yield l):c.bottomAnchor>r+q.distanceEpsilon&&(this.NodeUCanBeCrossedByNodeV(l,o)||(s=Math.max(s,c.topAnchor),r=c.bottomAnchor,yield l))}}IsVirtualVertex(e){return e>=this.originalGraph.shallowNodeCount}IsLabel(e){return this.anchors[e].hasLabel}NodeUCanBeCrossedByNodeV(e,t){return!this.IsLabel(e)&&!this.IsLabel(t)&&!!(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t)&&this.EdgesIntersectSomewhere(e,t))}EdgesIntersectSomewhere(e,t){return!this.UVAreMiddlesOfTheSameMultiEdge(e,t)&&(this.IntersectAbove(e,t)||this.IntersectBelow(e,t))}UVAreMiddlesOfTheSameMultiEdge(e,t){return!(!this.database.MultipleMiddles.has(e)||!this.database.MultipleMiddles.has(t)||this.SourceOfTheOriginalEdgeContainingAVirtualNode(e)!=this.SourceOfTheOriginalEdgeContainingAVirtualNode(t))}SourceOfTheOriginalEdgeContainingAVirtualNode(e){for(;this.IsVirtualVertex(e);)e=this.IncomingEdge(e).Source;return e}IntersectBelow(e,t){do{const n=this.OutcomingEdge(e),r=this.OutcomingEdge(t);if(this.Intersect(n,r))return!0;e=n.Target,t=r.Target}while(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t));return e==t}IntersectAbove(e,t){do{const n=this.IncomingEdge(e),r=this.IncomingEdge(t);if(this.Intersect(n,r))return!0;e=n.Source,t=r.Source}while(this.IsVirtualVertex(e)&&this.IsVirtualVertex(t));return e==t}Intersect(e,t){const n=this.layerArrays.x[e.Source]-this.layerArrays.x[t.Source],r=this.layerArrays.x[e.Target]-this.layerArrays.x[t.Target];return n>0&&r<0||n<0&&r>0}IncomingEdge(e){return this.layeredGraph.InEdgeOfVirtualNode(e)}OutcomingEdge(e){return this.layeredGraph.OutEdgeOfVirtualNode(e)}EastBoundaryNodesOfANode(e,t){return this.FillRightTopAndBottomVerts(this.NodeLayer(e),this.layerArrays.x[e],t)}NodeLayer(e){return this.layerArrays.Layers[this.layerArrays.y[e]]}LeftBoundaryNodesOfANode(e,t){return this.FillLeftTopAndBottomVerts(this.NodeLayer(e),this.layerArrays.x[e],t)}getSpline(e){return this.createRefinedPolyline(e),this.createSmoothedPolyline()}get GetPolyline(){return new Nn(this.headSite)}LineSegIntersectBound(e,t){const n=me.mkPP(e,t);return li.CurveIntersectsHierarchy(n,this.westHierarchy)||li.CurveIntersectsHierarchy(n,this.thinWestHierarchy)||li.CurveIntersectsHierarchy(n,this.eastHierarchy)||li.CurveIntersectsHierarchy(n,this.thinEastHierarchy)}SegIntersectWestBound(e,t){return li.SegIntersectsBound(e,t,this.westHierarchy)||li.SegIntersectsBound(e,t,this.thinWestHierarchy)}SegIntersectEastBound(e,t){return li.SegIntersectsBound(e,t,this.eastHierarchy)||li.SegIntersectsBound(e,t,this.thinEastHierarchy)}TryToRemoveInflectionCorner(e){if(!e.s.next||!e.s.prev||e.s.turn==Ie.Counterclockwise&&this.SegIntersectEastBound(e.s.prev,e.s.next)||e.s.turn==Ie.Clockwise&&this.SegIntersectWestBound(e.s.prev,e.s.next))return e.cut=!1,void(e.s=e.s.next);const t=e.s.next;e.s.prev.next=t,t.prev=e.s.prev,e.s=t,e.cut=!0}static SegIntersectsBound(e,t,n){return li.CurveIntersectsHierarchy(me.mkPP(e.point,t.point),n)}static CurveIntersectsHierarchy(e,t){if(null==t||!Et.intersect(e.pNodeOverICurve().parallelogram,t.parallelogram))return!1;if(t.node.hasOwnProperty("children")){const n=t.node;return li.CurveIntersectsHierarchy(e,n.children[0])||li.CurveIntersectsHierarchy(e,n.children[1])}return null!=te.intersectionOne(e,t.seg,!1)}static Flat(e){return x.getTriangleOrientation(e.prev.point,e.point,e.next.point)==Ie.Collinear}Reverse(){const e=new li(this.edgePath,this.anchors,this.originalGraph,this.settings,this.layerArrays,this.layeredGraph,this.database);let t=this.headSite,n=null;for(;null!=t;)e.headSite=t.clone(),e.headSite.next=n,null!=n&&(n.prev=e.headSite),n=e.headSite,t=t.next;return e}createRefinedPolyline(e){this.CreateInitialListOfSites();let n,t=this.headSite;for(let r=0;r<this.edgePath.count;r++)n=t.next,this.RefineBeetweenNeighborLayers(t,this.EdgePathNode(r),this.EdgePathNode(r+1)),t=n;this.TryToRemoveInflections(),e&&this.OptimizeShortPath()}RefineBeetweenNeighborLayers(e,t,n){Qi.Refine(t,n,e,this.anchors,this.layerArrays,this.layeredGraph,this.originalGraph,this.settings.LayerSeparation)}CreateInitialListOfSites(){let e=this.headSite=$t.mkSiteP(this.EdgePathPoint(0));for(let t=1;t<=this.edgePath.count;t++)e=$t.mkSiteSP(e,this.EdgePathPoint(t))}get TailSite(){let e=this.headSite;for(;null!=e.next;)e=e.next;return e}OptimizeForThreeSites(){const e=this.EdgePathNode(0),t=this.EdgePathNode(2),n=this.anchors[e],r=this.anchors[t];if(ht(n.x,r.x))return;const s={ax:n.x,bx:r.x,sign:0};if(!this.FindLegalPositions(n,r,s))return;const o=(n.y-r.y)/(n.bottom-r.top),a=.5*(s.ax+s.bx),l=s.sign*(.5*(s.ax-s.bx));s.ax=a+o*(l*s.sign),s.bx=a-o*(l*s.sign),this.headSite.point=new x(s.ax,n.y);const c=this.headSite.next,u=c.point.y;c.point=new x(this.MiddlePos(s.ax,s.bx,n,r,u),u),c.next.point=new x(s.bx,r.y),this.anchors[this.EdgePathNode(1)].x=c.point.x}OptimizeForTwoSites(){const e=this.EdgePathNode(0),t=this.EdgePathNode(1),n=this.anchors[e],r=this.anchors[t];if(ht(n.x,r.x))return;const s={ax:n.x,bx:r.x,sign:0};if(!this.FindPositions(n,r,s))return;const o=(n.y-r.y)/(n.bottom-r.top),a=.5*(s.ax+s.bx),l=s.sign*(.5*(s.ax-s.bx));s.ax=a+o*(l*s.sign),s.bx=a-o*(l*s.sign),this.headSite.point=new x(s.ax,n.y),this.headSite.next.point=new x(s.bx,r.y)}FindLegalPositions(e,t,n){return!!this.FindPositions(e,t,n)&&this.PositionsAreLegal(n.ax,n.bx,n.sign,e,t,this.EdgePathNode(1))}FindPositions(e,t,n){let r,s;if(n.ax<n.bx?(n.sign=1,s=Math.max(n.ax,t.left),r=Math.min(e.right,n.bx)):(n.sign=-1,s=Math.max(e.left,n.bx),r=Math.min(t.right,n.ax)),s<=r)n.bx=.5*(s+r),n.ax=.5*(s+r);else{if(this.OriginToOriginSegCrossesAnchorSide(e,t))return!1;1==n.sign?(n.ax=e.right-.1*e.rightAnchor,n.bx=t.left):(n.ax=e.left+.1*e.leftAnchor,n.bx=t.right)}return!0}OriginToOriginSegCrossesAnchorSide(e,t){const n=me.mkPP(e.origin,t.origin);return e.x<t.x&&te.CurvesIntersect(n,me.mkPP(e.rightBottom,e.rightTop))||te.CurvesIntersect(n,me.mkPP(t.leftBottom,e.leftTop))||e.x>t.x&&te.CurvesIntersect(n,me.mkPP(e.leftBottom,e.leftTop))||te.CurvesIntersect(n,me.mkPP(t.rightBottom,e.rightTop))}OptimizeShortPath(){this.edgePath.count>2||(2==this.edgePath.count&&null!=this.headSite.next.next&&null==this.headSite.next.next.next&&null==this.anchors[this.EdgePathNode(1)].node?this.OptimizeForThreeSites():1==this.edgePath.count&&this.OptimizeForTwoSites())}PositionsAreLegal(e,t,n,r,s,o){if(!ht(e,t)&&(e-t)*n>0)return!1;const a=this.anchors[o],l=this.MiddlePos(e,t,r,s,a.y);return!!this.MiddleAnchorLegal(l,o,a)&&!this.LineSegIntersectBound(new x(e,r.bottom),new x(t,s.top))}MiddleAnchorLegal(e,t,n){const r=this.NodeLayer(t),s=this.layerArrays.x[t],o=e-n.x;return!(s>0&&this.anchors[r[s-1]].right>o+n.left||s<r.length-1&&this.anchors[r[s+1]].left<o+n.right)}MiddlePos(e,t,n,r,s){const o=n.y-s,a=s-r.y;return(e*o+t*a)/(o+a)}TryToRemoveInflections(){if(this.TurningAlwaySameDirection())return;let e=!0;for(;e;){e=!1;for(const t={s:this.headSite,cut:!1};t.s;)this.TryToRemoveInflectionCorner(t),e=t.cut||e}}TurningAlwaySameDirection(){let e=0;for(let t=this.headSite.next;null!=t&&null!=t.next;t=t.next){const n=t.turn;if(0==e)n>0?e=1:n<0&&(e=-1);else if(e*n<0)return!1}return!0}EdgePathPoint(e){return this.anchors[this.EdgePathNode(e)].origin}EdgePathNode(e){return e==this.edgePath.count?this.edgePath.LayerEdges[this.edgePath.count-1].Target:this.edgePath.LayerEdges[e].Source}createSmoothedPolyline(){this.RemoveVerticesWithNoTurns();let e=new te;const t=this.headSite,n=te.findCorner(t);return null!=n?(this.createFilletCurve(e,{a:t,b:n.b,c:n.c}),e=this.ExtendCurveToEndpoints(e)):e.addSegment(me.mkPP(this.headSite.point,this.TailSite.point)),e}curveIsLegal(e){return!0}RemoveVerticesWithNoTurns(){for(;this.RemoveVerticesWithNoTurnsOnePass(););}RemoveVerticesWithNoTurnsOnePass(){let e=!1;for(let t=this.headSite;null!=t.next&&null!=t.next.next;t=t.next)li.Flat(t.next)&&(e=!0,t.next=t.next.next,t.next.prev=t);return e}ExtendCurveToEndpoints(e){let t=this.headSite.point;if(!x.closeDistEps(t,e.start)){const n=new te;n.addSegs([me.mkPP(t,e.start),e]),e=n}return t=this.TailSite.point,x.closeDistEps(t,e.end)||e.addSegment(me.mkPP(e.end,t)),e}createFilletCurve(e,t){for(;this.AddSmoothedCorner(t.a,t.b,t.c,e),t.a=t.b,t.b=t.c,null!=t.b.next;)t.c=t.b.next}AddSmoothedCorner(e,t,n,r){let o,s=.5;do{o=te.createBezierSeg(s,s,e,t,n),t.previouisBezierCoefficient=s,s/=2}while(this.BezierSegIntersectsBoundary(o));if(s*=2,s<.5){s=.5*(s+2*s);const a=te.createBezierSeg(s,s,e,t,n);this.BezierSegIntersectsBoundary(a)||(t.nextBezierCoefficient=s,t.previouisBezierCoefficient=s,o=a)}r.segs.length>0&&!x.closeDistEps(r.end,o.start)&&r.addSegment(me.mkPP(r.end,o.start)),r.addSegment(o)}BezierSegIntersectsBoundary(e){return x.signedDoubledTriangleArea(e.B(0),e.B(1),e.B(2))<0?this.BezierSegIntersectsTree(e,this.thinWestHierarchy)||this.BezierSegIntersectsTree(e,this.westHierarchy):this.BezierSegIntersectsTree(e,this.thinEastHierarchy)||this.BezierSegIntersectsTree(e,this.eastHierarchy)}BezierSegIntersectsTree(e,t){if(null==t)return!1;if(Et.intersect(e.pNodeOverICurve().parallelogram,t.parallelogram)){if(t.node.hasOwnProperty("children")){const n=t.node;return this.BezierSegIntersectsTree(e,n.children[0])||this.BezierSegIntersectsTree(e,n.children[1])}return li.BezierSegIntersectsBoundary(e,t.seg)}return!1}static BezierSegIntersectsBoundary(e,t){for(const n of te.getAllIntersections(e,t,!1)){if(!(t instanceof te))return!0;if(te.realCutWithClosedCurve(n,t,!1))return!0}return!1}}class ql{constructor(e=null){this.parents=new Set,this.children=new Set,this.ports=new Set,this.BoundaryCurve=e}get Parents(){return Array.from(this.parents.values())}get Children(){return Array.from(this.children.values())}get BoundaryCurve(){return this.boundaryCurve}set BoundaryCurve(e){this.boundaryCurve=e}get BoundingBox(){return this.BoundaryCurve.boundingBox}get Ports(){return this.ports}static mkShape(){return new ql(null)}get IsGroup(){return this.children.size>0}*Descendants(){const e=new Io.c;for(const t of this.Children)e.enqueue(t);for(;e.length>0;){const t=e.dequeue();yield t;for(const n of t.Children)e.enqueue(n)}}*Ancestors(){const e=new Io.c;for(const t of this.Parents)e.enqueue(t);for(;e.length>0;){const t=e.dequeue();yield t;for(const n of t.Parents)e.enqueue(n)}}AddParent(e){this.parents.add(e),e.children.add(this)}AddChild(e){e.parents.add(this),this.children.add(e)}RemoveChild(e){this.children.delete(e),e.parents.delete(this)}RemoveParent(e){this.parents.delete(e),e.children.delete(this)}ToString(){return this.UserData?this.UserData.toString():"null"}}class kE{}class Ss extends kE{constructor(e,t){super(),this.curve=this.curve,this.location=t.clone()}get Location(){return this.location}set Location(e){this.location=e}Translate(e){this.location=this.location.add(e)}get Curve(){return this.curve}set Curve(e){this.curve=e}}class Fo extends Ss{constructor(e,t,n){super(null,t().add(n)),this.LocationOffset=n,this.CurveDelegate=e,this.CenterDelegate=t}static mk(e,t){return new Fo(e,t,new x(0,0))}get CenterDelegate(){return this.centerDelegate}set CenterDelegate(e){this.centerDelegate=e}get CurveDelegate(){return this.curveDelegate}set CurveDelegate(e){this.curveDelegate=e}get LocationOffset(){return this.locationOffset}set LocationOffset(e){this.locationOffset=e}get Location(){return this.CenterDelegate().add(this.LocationOffset)}get Curve(){return this.CurveDelegate()}}let ot=(()=>{class i{static mkDebugCurveTWCILD(t,n,r,s,o,a,l=!1){const c=new i;return c.transparency=t,c.width=n,c.color=r,c.icurve=s,c.label=o,c.dashArray=a,c.drawPN=l,c}static mkDebugCurveTWCI(t,n,r,s){return i.mkDebugCurveTWCILD(t,n,r,s,null,null)}static mkDebugCurveWCI(t,n,r){return i.mkDebugCurveTWCI(255,t,n,r)}static mkDebugCurveCI(t,n){return i.mkDebugCurveWCI(1,t,n)}static mkDebugCurveI(t){return i.mkDebugCurveCI("Black",t)}}return i.colors=["DeepSkyBlue","IndianRed","Orange","Gold","DarkRed","Plum","Red","Violet","Indigo","Yellow","OrangeRed","Tomato","Purple","SaddleBrown","Green","Navy","Aqua","Pink","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","Lime","BurlyWood","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","CadetBlue","Chartreuse","DarkBlue","DarkCyan","DarkGoldenrod","DarkGray","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkTurquoise","DarkViolet","DeepPink","DimGray","DodgerBlue","Firebrick","FloralWhite","ForestGreen","Fuchsia","CodeAnalysis","Gainsboro","GhostWhite","Goldenrod","Gray","GreenYellow","Honeydew","HotPink","Ivory","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenrodYellow","LightGray","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSteelBlue","LightYellow","LimeGreen","Linen","Magenta","Maroon","MediumAquamarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","OldLace","Olive","OliveDrab","Orchid","PaleGoldenrod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","PowderBlue","RosyBrown","RoyalBlue","Salmon","SandyBrown","SeaGreen","CodeAnalysis","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Transparent","Turquoise","Aquamarine","Azure","Beige","Wheat","White","WhiteSmoke","YellowGreen","Khaki","AntiqueWhite"],i})();class VE{constructor(e,t,n,r,s){this.color=e,void 0!==t&&(this.item=t),void 0!==n&&(this.parent=n),void 0!==r&&(this.left=r),void 0!==s&&(this.right=s)}toString(){return this.item.toString()}}var Je=(()=>{return(i=Je||(Je={}))[i.Red=0]="Red",i[i.Black=1]="Black",Je;var i})();class Xi{constructor(e){this.comparer=e,this.count=0,this.root=this.nil=new VE(Je.Black)}[Symbol.iterator](){return this.allNodes()}clear(){this.root=this.nil=new VE(Je.Black)}toNull(e){return e!=this.nil?e:null}isEmpty(){return this.root==this.nil}getComparer(){return this.comparer}getRoot(){return this.root}find(e,t=this.root){let n;for(;t!=this.nil&&0!=(n=this.comparer(e,t.item));)t=n<0?t.left:t.right;return this.toNull(t)}findFirst(e,t=this.root){if(t==this.nil)return null;let n=null;for(;t!=this.nil;)t=e(t.item)?(n=t).left:t.right;return n}findLast(e,t=this.root){if(t==this.nil)return null;let n=null;for(;t!=this.nil;)t=e(t.item)?(n=t).right:t.left;return n}treeMinimum(e=this.root){for(;e.left!=this.nil;)e=e.left;return this.toNull(e)}treeMaximum(e=this.root){for(;e.right!=this.nil;)e=e.right;return this.toNull(e)}next(e){if(e.right!=this.nil)return this.treeMinimum(e.right);let t=e.parent;for(;t!=this.nil&&e==t.right;)e=t,t=t.parent;return this.toNull(t)}previous(e){if(e.left!=this.nil)return this.treeMaximum(e.left);let t=e.parent;for(;t!=this.nil&&e==t.left;)e=t,t=t.parent;return this.toNull(t)}leftRotate(e){const t=e.right;e.right=t.left,t.left!=this.nil&&(t.left.parent=e),t.parent=e.parent,e.parent==this.nil?this.root=t:e==e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}rightRotate(e){const t=e.left;e.left=t.right,t.right!=this.nil&&(t.right.parent=e),t.parent=e.parent,e.parent==this.nil?this.root=t:e==e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}deleteFixup(e){for(;e!=this.root&&e.color==Je.Black;)if(e==e.parent.left){let t=e.parent.right;t.color==Je.Red&&(t.color=Je.Black,e.parent.color=Je.Red,this.leftRotate(e.parent),t=e.parent.right),t.left.color==Je.Black&&t.right.color==Je.Black?(t.color=Je.Red,e=e.parent):(t.right.color==Je.Black&&(t.left.color=Je.Black,t.color=Je.Red,this.rightRotate(t),t=e.parent.right),t.color=e.parent.color,e.parent.color=Je.Black,t.right.color=Je.Black,this.leftRotate(e.parent),e=this.root)}else{let t=e.parent.left;t.color==Je.Red&&(t.color=Je.Black,e.parent.color=Je.Red,this.rightRotate(e.parent),t=e.parent.left),t.right.color==Je.Black&&t.left.color==Je.Black?(t.color=Je.Red,e=e.parent):(t.left.color==Je.Black&&(t.right.color=Je.Black,t.color=Je.Red,this.leftRotate(t),t=e.parent.left),t.color=e.parent.color,e.parent.color=Je.Black,t.left.color=Je.Black,this.rightRotate(e.parent),e=this.root)}e.color=Je.Black}deleteSubTree(e){let t;if(e.left==this.nil||e.right==this.nil)t=e;else for(t=e.right;t.left!=this.nil;)t=t.left;const n=t.left!=this.nil?t.left:t.right;return n.parent=t.parent,t.parent==this.nil?this.root=n:t==t.parent.left?t.parent.left=n:t.parent.right=n,t!=e&&(e.item=t.item),t.color==Je.Black&&this.deleteFixup(n),this.toNull(e)}deleteNodeInternal(e){this.count--,this.deleteSubTree(e)}remove(e){const t=this.find(e);return null!=t?(this.count--,this.deleteSubTree(t)):null}insert(e){const t=this.treeInsert(e);return this.insertPrivate(t),this.toNull(t)}treeInsert(e){let t=this.nil,n=this.root,r=0;for(;n!=this.nil;)t=n,r=this.comparer(e,n.item),n=r<0?n.left:n.right;const s=new VE(Je.Black,e,t,this.nil,this.nil);return t==this.nil?this.root=s:r<0?t.left=s:t.right=s,this.toNull(s)}insertPrivate(e){for(this.count++,e.color=Je.Red;e!=this.root&&e.parent.color==Je.Red;)if(e.parent==e.parent.parent.left){const t=e.parent.parent.right;t.color==Je.Red?(e.parent.color=Je.Black,t.color=Je.Black,e.parent.parent.color=Je.Red,e=e.parent.parent):(e==e.parent.right&&this.leftRotate(e=e.parent),e.parent.color=Je.Black,e.parent.parent.color=Je.Red,this.rightRotate(e.parent.parent))}else{const t=e.parent.parent.left;t.color==Je.Red?(e.parent.color=Je.Black,t.color=Je.Black,e.parent.parent.color=Je.Red,e=e.parent.parent):(e==e.parent.left&&this.rightRotate(e=e.parent),e.parent.color=Je.Black,e.parent.parent.color=Je.Red,this.leftRotate(e.parent.parent))}this.root.color=Je.Black}*allNodes(){if(this.isEmpty())return;let e=this.treeMinimum();for(;null!=e;)yield e.item,e=this.next(e)}toString(){let e="{",t=0;for(const n of this.allNodes())e+=n.toString(),t!=this.count-1&&(e+="\n"),t++;return e+"}"}}class GE{constructor(e){this.heapSize=0,this.A=[],this.compare=e}Enqueue(e){let t=this.heapSize+1;this.A[t]=e,this.heapSize++;let r,s,n=t>>1;for(;t>1&&this.Less(r=this.A[t],s=this.A[n]);)this.A[n]=r,this.A[t]=s,t=n,n=t>>1}Dequeue(){if(this.heapSize<1)throw new Error;const e=this.A[1],t=this.A[this.heapSize];return this.heapSize--,this.ChangeMinimum(t),e}ChangeMinimum(e){this.A[1]=e;let t=1,n=2,r=!1;for(;n<this.heapSize&&!r;){r=!0;const s=this.A[n],o=this.A[n+1];this.compare(s,o)<0?this.compare(s,e)<0&&(this.A[t]=s,this.A[n]=e,r=!1,t=n,n=t<<1):this.compare(o,e)<0&&(this.A[t]=o,this.A[n+1]=e,r=!1,t=n+1,n=t<<1)}if(n==this.heapSize){const s=this.A[n];this.compare(s,e)<0&&(this.A[t]=s,this.A[n]=e)}}get Count(){return this.heapSize}Less(e,t){return this.compare(e,t)<0}GetMinimum(){return this.A[1]}}class to{}class Ql extends to{constructor(e){super(),this.Vertex=e}get Site(){return this.Vertex.point}get Polyline(){return this.Vertex.polyline}}class eU extends Ql{constructor(e){super(e)}}class tU{constructor(e){this.lineSweeper=e}Compare(e,t){switch(x.getTriangleOrientation(t.Start,t.End,this.x)){case Ie.Collinear:return 0;case Ie.Clockwise:return 1;default:return-1}}SetOperand(e){this.x=this.IntersectionOfSideAndSweepLine(e)}IntersectionOfSideAndSweepLine(e){const t=e.Direction.dot(this.lineSweeper.SweepDirection),n=(this.lineSweeper.Z-e.Start.dot(this.lineSweeper.SweepDirection))/t;return e.Start.add(e.Direction.mul(n))}}class nU extends to{constructor(e){super(),this.site=e}get Site(){return this.site}}class BI{constructor(e,t){this.PreviousZ=Number.NEGATIVE_INFINITY,this.z=Number.NEGATIVE_INFINITY,this.Obstacles=null!=e?e:[],this.SweepDirection=t,this.DirectionPerp=t.rotate(-Math.PI/2),this.EventQueue=new GE((n,r)=>this.Compare(n,r)),this.ObstacleSideComparer=new tU(this),this.LeftObstacleSideTree=new Xi((n,r)=>this.ObstacleSideComparer.Compare(n,r)),this.RightObstacleSideTree=new Xi((n,r)=>this.ObstacleSideComparer.Compare(n,r))}get EventQueue(){return this.eventQueue}set EventQueue(e){this.eventQueue=e}get DirectionPerp(){return this.directionPerp}set DirectionPerp(e){this.directionPerp=e}get Z(){return this.z}set Z(e){e>this.z+q.tolerance&&(this.PreviousZ=this.z),this.z=e}GetZS(e){return this.SweepDirection.dot(e.Site)}GetZP(e){return this.SweepDirection.dot(e)}SegmentIsNotHorizontal(e,t){return Math.abs(e.sub(t).dot(this.SweepDirection))>q.distanceEpsilon}RemoveLeftSide(e){this.ObstacleSideComparer.SetOperand(e),this.LeftObstacleSideTree.remove(e)}RemoveRightSide(e){this.ObstacleSideComparer.SetOperand(e),this.RightObstacleSideTree.remove(e)}InsertLeftSide(e){this.ObstacleSideComparer.SetOperand(e),this.LeftObstacleSideTree.insert(e)}InsertRightSide(e){this.ObstacleSideComparer.SetOperand(e),this.RightObstacleSideTree.insert(e)}FindFirstObstacleSideToTheLeftOfPoint(e){const t=this.RightObstacleSideTree.findLast(n=>x.pointToTheRightOfLineOrOnLine(e,n.Start,n.End));return null==t?null:t.item}FindFirstObstacleSideToToTheRightOfPoint(e){const t=this.LeftObstacleSideTree.findFirst(n=>!x.pointToTheRightOfLineOrOnLine(e,n.Start,n.End));return null==t?null:t.item}EnqueueEvent(e){this.eventQueue.Enqueue(e)}InitQueueOfEvents(){for(const e of this.Obstacles)this.EnqueueLowestPointsOnObstacles(e);if(null!=this.Ports)for(const e of this.Ports.values())this.EnqueueEvent(new nU(e))}EnqueueLowestPointsOnObstacles(e){const t=this.GetLowestPoint(e);this.EnqueueEvent(new eU(t))}GetLowestPoint(e){let t=e.startPoint,n=e.startPoint.next;for(;null!=n;n=n.next)this.Less(n.point,t.point)&&(t=n);return t}Compare(e,t){return this.ComparePoints(e.Site,t.Site)}Less(e,t){return this.ComparePoints(e,t)<0}ComparePoints(e,t){let n=this.SweepDirection.dot(e),r=this.SweepDirection.dot(t);return n<r?-1:n>r?1:(n=this.directionPerp.dot(e),r=this.directionPerp.dot(t),n<r?-1:n>r?1:0)}}class ci{constructor(e,t,n=1){this.LengthMultiplier=1,(ci.closeuv(e,t)||ci.closeuv(t,e))&&console.log(e),this.Source=e,this.Target=t,this.Weight=n}static closeuv(e,t){return x.closeDistEps(e.point,ci.u,.1)&&x.closeDistEps(t.point,ci.v,.1)}get SourcePoint(){return this.Source.point}get TargetPoint(){return this.Target.point}get Length(){return this.SourcePoint.sub(this.TargetPoint).length*this.LengthMultiplier}toString(){return Hn.String.Format("{0}->{1} ({2})",this.Source,this.Target,this.Weight)}ReversedClone(){return new ci(this.Target,this.Source)}Clone(){return new ci(this.Source,this.Target)}}ci.u=new x(545.833,840.458),ci.v=new x(606.1667261889578,786.2917261889578),ci.DefaultWeight=1;class As extends ci{static constructorVV(e,t){return new As(e,t,0)}constructor(e,t,n=0){super(e,t,n)}}class Xl{constructor(e){this._inEdges=new Array,this._outEdges=new Xi((t,n)=>this.Compare(t,n)),this.point=e}get InEdges(){return this._inEdges}get OutEdges(){return this._outEdges}get Degree(){return this._inEdges.length+this.OutEdges.count}InEdgesLength(){return this._inEdges.length}addInEdge(e){this._inEdges.push(e)}get IsTerminal(){return this._isTerminal}set IsTerminal(e){this._isTerminal=e}get IsShortestPathTerminal(){return this._isShortestPathTerminal}set IsShortestPathTerminal(e){this._isShortestPathTerminal=e}toString(){return this.point.toString()}RemoveOutEdge(e){this.OutEdges.remove(e)}RemoveInEdge(e){const t=this._inEdges.indexOf(e);if(-1==t)return;const n=this._inEdges.length-1;t!=n&&(this._inEdges[t]=this._inEdges[n]),this._inEdges.pop()}static FindFirst(e,t){return Xl.FindFirst_t(e.root,e,t)}static FindFirst_t(e,t,n){if(e==t.nil)return null;let r=null;for(;e!=t.nil;)e=e.item.TargetPoint.compareTo(n)>=0?(r=e).left:e.right;return r}get(e){let t=Xl.FindFirst(this.OutEdges,e.point);return null!=t&&t.item.Target==e||(t=Xl.FindFirst(e.OutEdges,this.point),null!=t&&t.item.Target==this)?t.item:null}Compare(e,t){return e.TargetPoint.compareTo(t.TargetPoint)}ClearEdges(){this._outEdges.clear(),this._inEdges=[]}}class gn{constructor(){this._prevEdgesMap=new Map,this.visVertexToId=new Map,this.VertexFactory=e=>new Xl(e),this.pointToVertexMap=new Di}*edges_(){for(const e of this.pointToVertexMap.values())for(const t of e.OutEdges)yield t}get Edges(){return this.edges_()}ClearPrevEdgesTable(){this._prevEdgesMap.clear()}ShrinkLengthOfPrevEdge(e,t){this._prevEdgesMap.get(e).LengthMultiplier=t}PreviosVertex(e){const t=this._prevEdgesMap.get(e);return t?t.Source==e?t.Target:t.Source:null}SetPreviousEdge(e,t){this._prevEdgesMap.set(e,t)}AddHole(e){let t=e.startPoint;for(;t!=e.endPoint;)this.AddEdgePlPl(t,t.next),t=t.next;this.AddEdgePlPl(e.endPoint,e.startPoint)}static*OrientHolesClockwise(e){for(const t of e)for(let n=t.startPoint;;n=n.next){const r=x.getTriangleOrientation(n.point,n.next.point,n.next.next.point);if(r!=Ie.Collinear){yield r==Ie.Clockwise?t:t.reverse();break}}}AddVertexP(e){const t=this.pointToVertexMap.get(e);if(t)return t;const n=this.VertexFactory(e);return this.pointToVertexMap.set(e,n),n}AddVertexV(e){this.pointToVertexMap.set(e.point,e)}ContainsVertex(e){return this.pointToVertexMap.has(e)}static AddEdgeVV(e,t){let n;if(n=e.get(t))return n;if(e==t)throw new Error("Self-edges are not allowed");const r=new ci(e,t);return e.OutEdges.insert(r),t.InEdges.push(r),r}AddEdgePlPl(e,t){this.AddEdgePP(e.point,t.point)}static AddEdge(e){e.Source.OutEdges.insert(e),e.Target.addInEdge(e)}AddEdgeF(e,t,n){let r=this.FindVertex(e),s=null;if(null!=r&&(s=this.FindVertex(t),null!=s)){const a=r.get(s);if(a)return a}null==r?(r=this.AddVertexP(e),s=this.AddVertexP(t)):null==s&&(s=this.AddVertexP(t));const o=n(r,s);return r.OutEdges.insert(o),s.addInEdge(o),o}AddEdgePP(e,t){return this.AddEdgeF(e,t,(n,r)=>new ci(n,r))}FindVertex(e){return this.pointToVertexMap.get(e)}Vertices(){return this.pointToVertexMap.values()}RemoveVertex(e){for(const t of e.OutEdges)t.Target.RemoveInEdge(t);for(const t of e.InEdges)t.Source.RemoveOutEdge(t);this.pointToVertexMap.deleteP(e.point)}FindEdgePP(e,t){const n=this.FindVertex(e);if(null==n)return null;const r=this.FindVertex(t);return null==r?null:n.get(r)}static RemoveEdge(e){e.Source.RemoveOutEdge(e),e.Target.RemoveInEdge(e)}ClearEdges(){for(const e of this.Vertices())e.ClearEdges()}}class HE{constructor(){this.Removed=!1}}class Bo extends HE{constructor(e,t,n){super(),this.start=e,this.EndVertex=t,this.ConeSide=n}get Start(){return this.start}get End(){return this.EndVertex.point}get Direction(){return this.End.sub(this.Start)}toString(){return"BrokenConeSide: "+this.Start+","+this.End}}class YE{constructor(e,t){this.apex=e,this.coneSweeper=t}get Removed(){return this.removed}set Removed(e){this.removed=e}get Apex(){return this.apex}set Apex(e){this.apex=e}get RightSideDirection(){return this.coneSweeper.ConeRightSideDirection}get LeftSideDirection(){return this.coneSweeper.ConeLeftSideDirection}get RightSide(){return this.rightSide}set RightSide(e){this.rightSide=e,this.rightSide.Cone=this}get LeftSide(){return this.leftSide}set LeftSide(e){this.leftSide=e,this.leftSide.Cone=this}}class kI extends to{constructor(e,t){super(),this.site=e,this.coneToClose=t}get ConeToClose(){return this.coneToClose}get Site(){return this.site}toString(){return"ConeClosureEvent "+this.site}}class bs extends HE{constructor(e){super(),this.Cone=e}get Start(){return this.Cone.Apex}get Direction(){return this.Cone.LeftSideDirection}toString(){return"ConeLeftSide "+this.Start+" "+this.Direction}}class ko extends HE{constructor(e){super(),this.Cone=e}get Start(){return this.Cone.Apex}get Direction(){return this.Cone.RightSideDirection}toString(){return"ConeRightSide "+this.Start+" "+this.Direction}}class xf{constructor(e){this.coneSweeper=e}SetOperand(e){this.x=this.IntersectionOfSegmentAndSweepLine(e)}Compare(e,t){const r=t instanceof Bo;return e instanceof Bo?r?this.CompareBrokenSides(e,t):this.CompareObstacleSideAndConeSide(t):r?this.CompareConeSideAndObstacleSide(e,t):xf.CompareNotIntersectingSegs(e,t)}static CompareNotIntersectingSegs(e,t){switch(x.getTriangleOrientation(e.Start,t.Start,t.Start.add(t.Direction))){case Ie.Counterclockwise:return-1;case Ie.Clockwise:return 1;default:return 0}}CompareObstacleSideAndConeSide(e){const t=x.getTriangleOrientation(this.x,e.Start,e.Start.add(e.Direction));return t==Ie.Counterclockwise?-1:t==Ie.Clockwise?1:e instanceof bs?-1:1}CompareConeSideAndObstacleSide(e,t){const n=x.getTriangleOrientation(this.x,t.start,t.End);return n==Ie.Counterclockwise?-1:n==Ie.Clockwise||e instanceof bs?1:-1}IntersectionOfSegmentAndSweepLine(e){const t=e.Direction.dot(this.coneSweeper.SweepDirection),n=(this.coneSweeper.Z-e.Start.dot(this.coneSweeper.SweepDirection))/t;return e.Start.add(e.Direction.mul(n))}CompareBrokenSides(e,t){return e.EndVertex==t.EndVertex?xf.CompareNotIntersectingSegs(e.ConeSide,t.ConeSide):x.getTriangleOrientation(this.x,t.start,t.EndVertex.point)==Ie.Counterclockwise?-1:1}}class Uu extends to{constructor(e,t,n){super(),this.coneLeftSide=e,this.intersectionPoint=t,this.endVertex=n}get EndVertex(){return this.endVertex}get Site(){return this.intersectionPoint}toString(){return"LeftIntersectionEvent "+this.intersectionPoint}}class UE{get Direction(){return this.End.sub(this.Start)}toString(){return this.Start+" "+this.End}}class WE extends UE{constructor(e){super(),this.Init(e)}Init(e){this.StartVertex=e}get Polyline(){return this.StartVertex.polyline}get Start(){return this.StartVertex.point}get End(){return this.EndVertex.point}}class Zl extends WE{constructor(e){super(e),this.end=e.nextOnPolyline.point}get End(){return this.end}get EndVertex(){return this.StartVertex.nextOnPolyline}}class va extends Ql{constructor(e){super(e)}}class VI extends to{constructor(e,t,n){super(),this.coneRightSide=e,this.intersectionPoint=t,this.endVertex=n}get EndVertex(){return this.endVertex}set EndVertex(e){this.endVertex=e}get Site(){return this.intersectionPoint}toString(){return"RightIntersectionEvent "+this.intersectionPoint}}class ec extends WE{constructor(e){super(e),this.end=e.prevOnPolyline.point}get End(){return this.end}get EndVertex(){return this.StartVertex.prevOnPolyline}}class Sa extends Ql{constructor(e){super(e)}}class Un extends BI{constructor(e,t,n,r,s,o,a){super(e,t),this.visibilityGraph=s,this.ConeRightSideDirection=n,this.ConeLeftSideDirection=r,this.coneSideComparer=new xf(this),this.leftConeSides=new Xi((l,c)=>this.coneSideComparer.Compare(l,c)),this.rightConeSides=new Xi((l,c)=>this.coneSideComparer.Compare(l,c)),this.Ports=o,this.BorderPolyline=a,this.PortEdgesCreator=(l,c)=>new As(l,c,0)}static Sweep(e,t,n,r,s,o){new Un(e,t,t.rotate(-n/2),t.rotate(n/2),r,s,o).Calculate()}Calculate(){for(this.InitQueueOfEvents();this.EventQueue.Count>0;)this.ProcessEvent(this.EventQueue.Dequeue());null!=this.BorderPolyline&&this.CloseRemainingCones(),this.CreatePortEdges()}CreatePortEdges(){if(null!=this.portEdgesGraph)for(const e of this.portEdgesGraph.Edges)this.visibilityGraph.AddEdgeF(e.SourcePoint,e.TargetPoint,this.PortEdgesCreator)}CloseRemainingCones(){if(0==this.leftConeSides.count)return;let e=this.BorderPolyline.startPoint,t=this.leftConeSides.count;do{const n=this.leftConeSides.treeMinimum().item.Cone;e=this.FindPolylineSideIntersectingConeRightSide(e,n),e=this.GetPolylinePointInsideOfConeAndRemoveCones(e,n),t--}while(this.leftConeSides.count>0&&t>0)}GetPolylinePointInsideOfConeAndRemoveCones(e,t){const n=e.nextOnPolyline,r=Un.FindInsidePoint(e.point,n.point,t);return x.closeDistEps(r,e.point)?(this.AddEdgeAndRemoveCone(t,e.point),this.AddEdgesAndRemoveRemainingConesByPoint(e.point)):x.closeDistEps(r,n.point)?(this.AddEdgeAndRemoveCone(t,n.point),this.AddEdgesAndRemoveRemainingConesByPoint(n.point),e=n):(e=Un.InsertPointIntoPolylineAfter(this.BorderPolyline,e,r),this.AddEdgeAndRemoveCone(t,e.point),this.AddEdgesAndRemoveRemainingConesByPoint(e.point)),e}static FindInsidePoint(e,t,n){return Un.FindInsidePointBool(e,t,n.Apex,n.Apex.add(n.LeftSideDirection),n.Apex.add(n.RightSideDirection))}static FindInsidePointBool(e,t,n,r,s){if(x.closeDistEps(e,t)||x.PointIsInsideCone(e,n,r,s))return e;if(x.PointIsInsideCone(t,n,r,s))return t;const o=x.middle(e,t);return x.pointToTheLeftOfLine(o,n,r)?Un.FindInsidePointBool(o,t,n,r,s):Un.FindInsidePointBool(e,o,n,r,s)}AddEdgesAndRemoveRemainingConesByPoint(e){const t=new Array;for(const n of this.leftConeSides){if(!x.PointToTheRightOfLineOrOnLine(e,n.Start,n.Start.add(n.Direction)))break;t.push(n.Cone)}for(const n of t)this.AddEdgeAndRemoveCone(n,e)}FindPolylineSideIntersectingConeRightSide(e,t){const n=e,r=t.Apex,s=t.Apex.add(this.ConeRightSideDirection);let o=Un.GetSign(e,r,s);for(;;){const a=e.nextOnPolyline,l=Un.GetSign(a,r,s);if(l-o>0)return e;if(o=l,(e=a)==n)throw new Error("cannod decide if the polyline intersects the cone!")}}static GetSign(e,t,n){const r=x.signedDoubledTriangleArea(t,n,e.point);return r<0?1:r>0?-1:0}AddEdgeAndRemoveCone(e,t){null!=this.Ports&&this.Ports.has(e.Apex)?this.CreatePortEdge(e,t):this.visibilityGraph.AddEdgePP(e.Apex,t),this.RemoveCone(e)}CreatePortEdge(e,t){null==this.portEdgesGraph&&(this.portEdgesGraph=new gn);const n=this.portEdgesGraph.FindVertex(e.Apex),r=null!=n?Array.from(n.InEdges).concat(Array.from(n.OutEdges.allNodes())):null;if(r)for(const s of r){const o=(s.Target==n?s.Source:s.Target).point;gn.RemoveEdge(s),this.portEdgesGraph.AddEdgePP(o,t)}this.portEdgesGraph.AddEdgePP(e.Apex,t)}static InsertPointIntoPolylineAfter(e,t,n){let r;return null!=t.next?(r=$i.mkFromPoint(n),r.prev=t,r.next=t.next,t.next.prev=r,t.next=r):(r=$i.mkFromPoint(n),r.prev=t,t.next=r,e.endPoint=r),r.polyline=e,e.setInitIsRequired(),r}ProcessEvent(e){e instanceof Ql?this.ProcessVertexEvent(e):e instanceof VI?this.ProcessRightIntersectionEvent(e):e instanceof Uu?this.ProcessLeftIntersectionEvent(e):(e instanceof kI?e.ConeToClose.Removed||this.RemoveCone(e.ConeToClose):this.ProcessPortObstacleEvent(e),this.Z=this.GetZS(e))}ProcessPortObstacleEvent(e){this.Z=this.GetZS(e),this.GoOverConesSeeingVertexEvent(e),this.CreateConeOnVertex(e)}ProcessLeftIntersectionEvent(e){if(0==e.coneLeftSide.Removed)if(Math.abs(e.EndVertex.point.sub(e.Site).dot(this.SweepDirection))<q.distanceEpsilon)this.RemoveCone(e.coneLeftSide.Cone);else{this.RemoveSegFromLeftTree(e.coneLeftSide),this.Z=this.GetZP(e.Site);const t=new Bo(e.Site,e.EndVertex,e.coneLeftSide);this.InsertToTree(this.leftConeSides,t),e.coneLeftSide.Cone.LeftSide=t,this.LookForIntersectionOfObstacleSideAndLeftConeSide(e.Site,e.EndVertex),this.TryCreateConeClosureForLeftSide(t)}else this.Z=this.GetZP(e.Site)}TryCreateConeClosureForLeftSide(e){if(e.Cone.RightSide instanceof ko){const t=e.Cone.RightSide;x.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.EndVertex.point)==Ie.Clockwise&&this.CreateConeClosureEvent(e,t)}}CreateConeClosureEvent(e,t){const n=x.RayIntersectsRayInteriors(e.start,e.Direction,t.Start,t.Direction),r=new kI(n,e.Cone);this.EnqueueEvent(r)}ProcessRightIntersectionEvent(e){if(0==e.coneRightSide.Removed){this.RemoveSegFromRightTree(e.coneRightSide),this.Z=this.GetZP(e.Site);const t=new Bo(e.Site,e.EndVertex,e.coneRightSide);this.InsertToTree(this.rightConeSides,t),e.coneRightSide.Cone.RightSide=t,this.LookForIntersectionOfObstacleSideAndRightConeSide(e.Site,e.EndVertex),this.TryCreateConeClosureForRightSide(t)}else this.Z=this.GetZP(e.Site)}TryCreateConeClosureForRightSide(e){if(e.Cone.LeftSide instanceof bs){const n=e.Cone.LeftSide;x.getTriangleOrientation(n.Start,n.Start.add(n.Direction),e.EndVertex.point)==Ie.Counterclockwise&&this.CreateConeClosureEvent(e,n)}}RemoveConesClosedBySegment(e,t){this.CloseConesCoveredBySegment(e,t,this.GetZP(e)>this.GetZP(t)?this.leftConeSides:this.rightConeSides)}CloseConesCoveredBySegment(e,t,n){let r=n.findFirst(a=>x.getTriangleOrientation(a.Start,a.Start.add(a.Direction),e)==Ie.Counterclockwise);if(null==r||!x.IntervalIntersectsRay(e,t,r.item.Start,r.item.Direction))return;const o=new Array;do{o.push(r.item.Cone),r=n.next(r)}while(null!=r&&null!=x.IntervalIntersectsRay(e,t,r.item.Start,r.item.Direction));for(const a of o)this.RemoveCone(a)}ProcessVertexEvent(e){this.Z=this.GetZS(e),this.GoOverConesSeeingVertexEvent(e),this.AddConeAndEnqueueEvents(e)}static Diamond(e){return vi.CreateDiamond(2,2,e)}AddConeAndEnqueueEvents(e){e instanceof va?this.CloseConesAddConeAtLeftVertex(e,e.Vertex.nextOnPolyline):(e instanceof Sa||this.CloseConesAddConeAtLeftVertex(e,e.Vertex.nextOnPolyline),this.CloseConesAddConeAtRightVertex(e,e.Vertex.prevOnPolyline))}CloseConesAddConeAtRightVertex(e,t){const n=e.Vertex.nextOnPolyline.point;this.directionPerp.dot(e.Site.sub(n))>q.distanceEpsilon&&this.RemoveConesClosedBySegment(n,e.Vertex.point),this.directionPerp.dot(t.point.sub(e.Site))>q.distanceEpsilon&&this.RemoveConesClosedBySegment(e.Site,t.point);const r=e.Site,s=r.add(this.ConeLeftSideDirection),o=r.add(this.ConeRightSideDirection),a=t.point;this.GetZP(r.sub(n))>q.distanceEpsilon&&this.RemoveRightSide(new ec(e.Vertex.nextOnPolyline)),this.GetZP(r.sub(t.point))>q.distanceEpsilon&&this.RemoveLeftSide(new Zl(t)),this.GetZP(a)+q.distanceEpsilon<this.GetZS(e)&&this.CreateConeOnVertex(e),x.PointToTheRightOfLineOrOnLine(a,r,s)?x.PointToTheLeftOfLineOrOnLine(a,r,o)?this.CaseToTheLeftOfLineOrOnLineConeRp(e,t):(this.GetZP(a.sub(r))>q.distanceEpsilon&&(this.LookForIntersectionOfObstacleSideAndLeftConeSide(e.Site,t),this.InsertRightSide(new ec(e.Vertex))),this.EnqueueRightVertexEvent(new Sa(t))):(this.CreateConeOnVertex(e),x.PointToTheLeftOfLineOrOnLine(a.add(this.DirectionPerp),a,r)&&this.EnqueueRightVertexEvent(new Sa(t)))}CaseToTheLeftOfLineOrOnLineConeRp(e,t){this.EnqueueRightVertexEvent(new Sa(t));const n=new YE(e.Vertex.point,this),r=new Bo(n.Apex,t,new bs(n));n.LeftSide=r,n.RightSide=new ko(n);const s=this.InsertToTree(this.rightConeSides,n.RightSide);this.LookForIntersectionWithConeRightSide(s);const o=this.InsertToTree(this.leftConeSides,n.LeftSide);this.FixConeLeftSideIntersections(r,o),this.GetZP(t.point.sub(e.Site))>q.distanceEpsilon&&this.InsertRightSide(new ec(e.Vertex))}LookForIntersectionOfObstacleSideAndRightConeSide(e,t){const n=this.GetLastNodeToTheLeftOfPointInRightSegmentTree(e);if(null!=n&&n.item instanceof ko!=null){const s=x.IntervalIntersectsRay(e,t.point,n.item.Start,this.ConeRightSideDirection);s&&this.SegmentIsNotHorizontal(s,t.point)&&this.EnqueueEvent(this.CreateRightIntersectionEvent(n.item,s,t))}}CreateRightIntersectionEvent(e,t,n){return new VI(e,t,n)}GetLastNodeToTheLeftOfPointInRightSegmentTree(e){return this.rightConeSides.findLast(t=>Un.PointIsToTheRightOfSegment(e,t))}LookForIntersectionOfObstacleSideAndLeftConeSide(e,t){const n=this.GetFirstNodeToTheRightOfPoint(e);if(null==n||!(n.item instanceof bs))return;const r=n.item,s=x.IntervalIntersectsRay(e,t.point,r.Start,this.ConeLeftSideDirection);s&&this.EnqueueEvent(new Uu(r,s,t))}GetFirstNodeToTheRightOfPoint(e){return this.leftConeSides.findFirst(t=>Un.PointIsToTheLeftOfSegment(e,t))}static PointIsToTheLeftOfSegment(e,t){return x.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e)==Ie.Counterclockwise}static PointIsToTheRightOfSegment(e,t){return x.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e)==Ie.Clockwise}FixConeLeftSideIntersections(e,t){do{t=this.leftConeSides.next(t)}while(null!=t&&x.PointToTheRightOfLineOrOnLine(e.Start,t.item.Start,t.item.Start.add(t.item.Direction)));if(null!=t&&t.item instanceof bs){const n=t.item,r=x.IntervalIntersectsRay(e.start,e.End,n.Start,n.Direction);r&&this.EnqueueEvent(new Uu(n,r,e.EndVertex))}}InsertToTree(e,t){return this.coneSideComparer.SetOperand(t),e.insert(t)}CloseConesAddConeAtLeftVertex(e,t){const n=e.Vertex.prevOnPolyline.point;e.Site.sub(n).dot(this.directionPerp)<-q.distanceEpsilon&&this.RemoveConesClosedBySegment(e.Site,n),t.point.sub(e.Site).dot(this.directionPerp)<-q.distanceEpsilon&&this.RemoveConesClosedBySegment(t.point,e.Site);const r=e.Site,s=r.add(this.ConeLeftSideDirection),o=r.add(this.ConeRightSideDirection),a=t.point;this.GetZP(r.sub(n))>q.distanceEpsilon&&this.RemoveLeftSide(new Zl(e.Vertex.prevOnPolyline));const l=this.GetZP(a)-this.Z;l<-q.distanceEpsilon&&this.RemoveRightSide(new ec(t));const c=a.sub(e.Site);if(l<-q.distanceEpsilon||ht(l,0)&&this.GetZP(c)>0&&c.dot(this.directionPerp)>-q.distanceEpsilon)this.CreateConeOnVertex(e);else if(x.PointToTheLeftOfLineOrOnLine(a,r,o))if(x.PointToTheLeftOfLineOrOnLine(a,r,s))this.EnqueueEvent(new va(t)),this.GetZP(c)>q.distanceEpsilon&&(this.LookForIntersectionOfObstacleSideAndRightConeSide(e.Site,t),this.InsertLeftSide(new Zl(e.Vertex)));else{this.EnqueueEvent(new va(t));const u=new YE(e.Vertex.point,this),y=new Bo(e.Vertex.point,t,new ko(u));u.RightSide=y,u.LeftSide=new bs(u),this.LookForIntersectionWithConeLeftSide(this.InsertToTree(this.leftConeSides,u.LeftSide));const R=this.InsertToTree(this.rightConeSides,y);this.FixConeRightSideIntersections(y,R),this.GetZP(c)>q.distanceEpsilon&&this.InsertLeftSide(new Zl(e.Vertex))}else this.CreateConeOnVertex(e),this.EnqueueEvent(new va(t))}RemoveCone(e){e.Removed=!0,this.RemoveSegFromLeftTree(e.LeftSide),this.RemoveSegFromRightTree(e.RightSide)}RemoveSegFromRightTree(e){this.coneSideComparer.SetOperand(e);let t=this.rightConeSides.remove(e);if(e.Removed=!0,null==t){const n=this.Z;this.Z=Math.max(this.GetZP(e.Start),this.Z-.01),this.coneSideComparer.SetOperand(e),t=this.rightConeSides.remove(e),this.Z=n}}RemoveSegFromLeftTree(e){if(e.Removed=!0,this.coneSideComparer.SetOperand(e),null==this.leftConeSides.remove(e)){const n=this.Z;this.Z=Math.max(this.GetZP(e.Start),this.Z-.01),this.coneSideComparer.SetOperand(e),this.leftConeSides.remove(e),this.Z=n}}FixConeRightSideIntersections(e,t){do{t=this.rightConeSides.previous(t)}while(null!=t&&x.PointToTheLeftOfLineOrOnLine(e.start,t.item.Start,t.item.Start.add(t.item.Direction)));if(null!=t){let n;if(t.item instanceof ko){const r=t.item;(n=x.IntervalIntersectsRay(e.start,e.End,r.Start,r.Direction))&&this.EnqueueEvent(this.CreateRightIntersectionEvent(r,n,e.EndVertex))}}}CreateConeOnVertex(e){const t=new YE(e.Site,this);t.LeftSide=new bs(t),t.RightSide=new ko(t);const n=this.InsertToTree(this.leftConeSides,t.LeftSide),r=this.InsertToTree(this.rightConeSides,t.RightSide);this.LookForIntersectionWithConeRightSide(r),this.LookForIntersectionWithConeLeftSide(n)}LookForIntersectionWithConeLeftSide(e){if(e.item instanceof bs){const n=e.item,r=this.FindFirstObstacleSideToTheLeftOfPoint(n.Start);null!=r&&this.TryIntersectionOfConeLeftSideAndObstacleSide(n,r)}else{const n=e.item;null!=(e=this.leftConeSides.next(e))&&e.item instanceof bs&&this.TryIntersectionOfConeLeftSideAndObstacleConeSide(e.item,n)}}LookForIntersectionWithConeRightSide(e){if(e.item instanceof ko){const n=e.item,r=this.FindFirstObstacleSideToToTheRightOfPoint(n.Start);null!=r&&this.TryIntersectionOfConeRightSideAndObstacleSide(n,r)}else{const n=e.item;null!=(e=this.rightConeSides.previous(e))&&e.item instanceof ko&&this.TryIntersectionOfConeRightSideAndObstacleConeSide(e.item,n)}}TryIntersectionOfConeRightSideAndObstacleConeSide(e,t){const n=x.IntervalIntersectsRay(t.start,t.End,e.Start,e.Direction);n&&this.EnqueueEvent(this.CreateRightIntersectionEvent(e,n,t.EndVertex))}TryIntersectionOfConeRightSideAndObstacleSide(e,t){const n=x.IntervalIntersectsRay(t.Start,t.End,e.Start,e.Direction);n&&this.EnqueueEvent(this.CreateRightIntersectionEvent(e,n,t.EndVertex))}TryIntersectionOfConeLeftSideAndObstacleConeSide(e,t){const n=x.IntervalIntersectsRay(t.start,t.End,e.Start,e.Direction);n&&this.EnqueueEvent(new Uu(e,n,t.EndVertex))}TryIntersectionOfConeLeftSideAndObstacleSide(e,t){const n=x.IntervalIntersectsRay(t.Start,t.End,e.Start,e.Direction);n&&this.EnqueueEvent(new Uu(e,n,t.EndVertex))}Show(e,t){let n=Array.from(this.Obstacles).map(r=>ot.mkDebugCurveTWCI(200,.5,"Blue",r));for(const r of this.rightConeSides)n.push(ot.mkDebugCurveWCI(.5,"Brown",this.ExtendSegmentToZ(r))),r instanceof Bo&&n.push(ot.mkDebugCurveCI("brown",Un.Diamond(r.start))),n.push(ot.mkDebugCurveWCI(.5,"Green",this.ExtendSegmentToZ(r.Cone.LeftSide))),r.Cone.LeftSide instanceof Bo&&n.push(ot.mkDebugCurveCI("green",Un.Diamond(r.Cone.LeftSide.start)));n=n.concat(Array.from(this.visibilityGraph.Edges).map(r=>ot.mkDebugCurveWCI(2,"Black",me.mkPP(r.SourcePoint,r.TargetPoint)))),n=n.concat(e.map(r=>ot.mkDebugCurveCI("Red",r)))}ExtendSegmentToZ(e){const t=e.Direction.dot(this.SweepDirection),n=(this.Z+40-e.Start.dot(this.SweepDirection))/t;return me.mkPP(e.Start,e.Start.add(e.Direction.mul(n)))}GoOverConesSeeingVertexEvent(e){let t=this.FindFirstSegmentInTheRightTreeNotToTheLeftOfVertex(e);if(null==t)return;const r=t.item.Cone,s=r.LeftSide;if(Un.VertexIsToTheLeftOfSegment(e,s))return;const o=[r];if(this.coneSideComparer.SetOperand(s),t=this.leftConeSides.find(s),null==t){const a=this.Z;this.Z=Math.max(this.GetZP(s.Start),this.PreviousZ),this.coneSideComparer.SetOperand(s),t=this.leftConeSides.find(s),this.Z=a}if(null!=t||(t=this.GetRbNodeEmergency(t,s),null!=t)){for(t=this.leftConeSides.next(t);null!=t&&!Un.VertexIsToTheLeftOfSegment(e,t.item);)o.push(t.item.Cone),t=this.leftConeSides.next(t);for(const a of o)this.AddEdgeAndRemoveCone(a,e.Site)}}GetRbNodeEmergency(e,t){for(let n=this.leftConeSides.treeMinimum();null!=n;n=this.leftConeSides.next(n))if(n.item==t){e=n;break}return e}static VertexIsToTheLeftOfSegment(e,t){return x.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.Site)==Ie.Counterclockwise}static VertexIsToTheRightOfSegment(e,t){return x.getTriangleOrientation(t.Start,t.Start.add(t.Direction),e.Site)==Ie.Clockwise}FindFirstSegmentInTheRightTreeNotToTheLeftOfVertex(e){return this.rightConeSides.findFirst(t=>!Un.VertexIsToTheRightOfSegment(e,t))}EnqueueRightVertexEvent(e){this.GetZP(e.Site.sub(e.Vertex.prevOnPolyline.point))>q.tolerance||this.EnqueueEvent(e)}invariant(){for(const e of this.leftConeSides)if(e.Removed)return!1;for(const e of this.rightConeSides)if(e.Removed)return!1;return!0}}class Wu extends dn{constructor(e,t){super(null),this.coneAngle=Math.PI/6,this.ports=new Rn,this._obstacles=Array.from(gn.OrientHolesClockwise(e)),this._visibilityGraph=t}static mk(e,t,n,r,s){const o=new Wu(e,t);return o.Ports=r,o.BorderPolyline=s,o.ConeAngle=n,o}get ConeAngle(){return this.coneAngle}set ConeAngle(e){this.coneAngle=e}get Ports(){return this.ports}set Ports(e){this.ports=e}get BorderPolyline(){return this.borderPolyline}set BorderPolyline(e){this.borderPolyline=e}get Bidirectional(){return this._bidirectional}set Bidirectional(e){this._bidirectional=e}static GetTotalSteps(e){return Math.floor((2*Math.PI-e/2)/e)+1}run(){const e=2*Math.PI-this.coneAngle/2;if(this.Bidirectional)this.HandleBideractionalCase();else{let t;for(let n=0;(t=this.coneAngle*n)<=e;n++)super.ProgressStep(),this.AddDirection(new x(Math.cos(t),Math.sin(t)),this.BorderPolyline,this._visibilityGraph)}}HandleBideractionalCase(){const e=Math.PI/this.coneAngle;for(let t=0;t<e;t++){const n=t*this.coneAngle,r=new gn;this.AddDirection(new x(Math.cos(n),Math.sin(n)),this.BorderPolyline,r);const s=new gn;this.AddDirection(new x(-1*Math.cos(n),-1*Math.sin(n)),this.BorderPolyline,s),this.AddIntersectionOfBothDirectionSweepsToTheResult(r,s)}}AddIntersectionOfBothDirectionSweepsToTheResult(e,t){for(const n of e.Edges)null!=t.FindEdgePP(n.SourcePoint,n.TargetPoint)&&this._visibilityGraph.AddEdgePP(n.SourcePoint,n.TargetPoint)}AddDirection(e,t,n){Un.Sweep(this._obstacles,e,this.coneAngle,n,this.Ports,t)}}class ui extends kE{constructor(e){super(),this.adjustmentAngle=Math.PI/10,this.hookSize=9,this.curve=e,this.location=this.curve().start}mk(e,t){const n=new ui(e);return n.HookSize=t,n}get Location(){return this.location}get Curve(){return this.curve()}SetLocation(e){this.location=e}get AdjustmentAngle(){return this.adjustmentAngle}set AdjustmentAngle(e){this.adjustmentAngle=e}get HookSize(){return this.hookSize}set HookSize(e){this.hookSize=e}}class Cr extends Fo{constructor(e,t,n=new x(0,0)){super(e,t,n)}get LoosePolyline(){return this.loosePolyline}set LoosePolyline(e){this.loosePolyline=e}static mk(e,t){return new Cr(e,t)}}class Li extends kE{get Location(){return this.curve.value(this.parameter)}set Location(e){throw new Error("Method should not be called.")}static mk(e,t){const n=new Li;return n.curve=e,n.parameter=t,n}get Parameter(){return this.parameter}set Parameter(e){this.parameter=e}get Curve(){return this.curve}set Curve(e){this.curve=e}}class jE extends ql{constructor(e){super(null),this.curveDelegate=e}get BoundaryCurve(){return this.curveDelegate()}set BoundaryCurve(e){if(e)throw new Error("Cannot set BoundaryCurve directly for RelativeShape")}}class Xr{static GetShapes(e,t){const n=new Map;for(const r of e)Xr.ProcessAncestorDescendantCouple(r.target,r.source,n),Xr.InsertEdgePortsToShapes(n,r);for(const r of t)Xr.ProcessAncestorDescendantCouple(r.source,r.target,n),Xr.InsertEdgePortsToShapes(n,r);return Xr.BindShapes(n),Array.from(n.values())}static InsertEdgePortsToShapes(e,t){e.get(t.target).Ports.add(t.targetPort),e.get(t.source).Ports.add(t.sourcePort)}static BindShapes(e){for(const[t,n]of e){if(!(t instanceof Jr))continue;const r=t;for(const s of zE(r)){const o=e.get(s);o&&n.AddChild(o)}}}static ProcessAncestorDescendantCouple(e,t,n){let r=Lf(t);for(;;){for(const s of zE(r))Xr.CreateShapeIfNeeeded(s,n);if(r==e)break;r=Lf(r)}Xr.CreateShapeIfNeeeded(r,n)}static CreateShapeIfNeeeded(e,t){t.has(e)||t.set(e,new jE(()=>e.boundaryCurve))}static NumberOfActiveNodesIsUnderThreshold(e,t,n){const r=new Set;for(const s of e)if(Xr.SetOfActiveNodesIsLargerThanThreshold(s.target,s.source,r,n))return!1;for(const s of t)if(Xr.SetOfActiveNodesIsLargerThanThreshold(s.source,s.target,r,n))return!1;return!0}static SetOfActiveNodesIsLargerThanThreshold(e,t,n,r){let s=Lf(t);for(;;){for(const o of zE(s))if(n.add(o),n.size>r)return!0;if(s==e)break;s=Lf(s)}return n.add(s),n.size>r}}function Lf(i){return kn.getGeom(i.node.parent)}function*zE(i){for(const e of i.graph.shallowNodes)yield kn.getGeom(e)}class Zr{constructor(e){this.stamp=0,this.SetPivotAndAllocateHullPointsArray(e)}SetPivotAndAllocateHullPointsArray(e){this.pivot=new x(0,Number.MAX_SAFE_INTEGER);let t=-1,n=0;for(const r of e)(r.y<this.pivot.y||r.y==this.pivot.y&&r.x>this.pivot.x)&&(this.pivot=r,t=n),n++;if(n>=1){this.hullPoints=new Array(n-1),n=0;for(const r of e)n!=t?this.hullPoints[n++]={point:r,deleted:!1,stamp:this.stamp++}:t=-1}}get StackTopPoint(){return this.stack.point}get StackSecondPoint(){return this.stack.next.point}static*CalculateConvexHull(e){const t=new Zr(e);for(const n of t.Calculate())yield n}*Calculate(){if(this.pivot.y!=Number.MAX_SAFE_INTEGER){if(0==this.hullPoints.length)return void(yield this.pivot);this.SortAllPointsWithoutPivot(),this.Scan();for(const e of this.EnumerateStack())yield e}}*EnumerateStack(){let e=this.stack;for(;null!=e;)yield e.point,e=e.next}Scan(){let e=0;for(;this.hullPoints[e].deleted;)e++;for(this.stack={point:this.pivot,next:null},this.Push(e++),e<this.hullPoints.length&&(this.hullPoints[e].deleted?e++:this.Push(e++));e<this.hullPoints.length;)this.hullPoints[e].deleted?e++:this.LeftTurn(e)?this.Push(e++):this.Pop();for(;this.StackHasMoreThanTwoPoints()&&!this.LeftTurnToPivot();)this.Pop()}LeftTurnToPivot(){return x.getTriangleOrientation(this.StackSecondPoint,this.StackTopPoint,this.pivot)==Ie.Counterclockwise}StackHasMoreThanTwoPoints(){return null!=this.stack.next&&null!=this.stack.next.next}Pop(){this.stack=this.stack.next}LeftTurn(e){if(null==this.stack.next)return!0;const t=x.getTriangleOrientationWithIntersectionEpsilon(this.StackSecondPoint,this.StackTopPoint,this.hullPoints[e].point);return t==Ie.Counterclockwise||t!=Ie.Clockwise&&this.BackSwitchOverPivot(this.hullPoints[e].point)}BackSwitchOverPivot(e){return null==this.stack.next.next&&this.StackTopPoint.x>this.pivot.x+q.distanceEpsilon&&e.x<this.pivot.x-q.distanceEpsilon}Push(e){this.stack={point:this.hullPoints[e].point,next:this.stack}}SortAllPointsWithoutPivot(){this.hullPoints.sort(function iU(i){return(e,t)=>{if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;switch(x.getTriangleOrientationWithIntersectionEpsilon(i,e.point,t.point)){case Ie.Counterclockwise:return-1;case Ie.Clockwise:return 1;case Ie.Collinear:const n=e.point.x-i.x,r=t.point.x-i.x;if(n>q.distanceEpsilon&&r<-1*q.distanceEpsilon)return-1;if(n<-1*q.distanceEpsilon&&r>q.distanceEpsilon)return 1;const s=e.point.sub(i),o=t.point.sub(i),a=s.l1-o.l1;return a<0?(e.deleted=!0,-1):a>0?(t.deleted=!0,1):(e.stamp>t.stamp?e.deleted=!0:t.deleted=!0,0)}throw new Error}}(this.pivot))}static createConvexHullAsClosedPolyline(e){return He.mkClosedFromPoints(Array.from(Zr.CalculateConvexHull(e)))}}function Zi(i,e,t){!i.irect.intersects_rect(e.irect)||(null==i.Left?null==e.Left?t(i.UserData,e.UserData):(Zi(i,e.Left,t),Zi(i,e.Right,t)):null!=e.Left?(Zi(i.Left,e.Left,t),Zi(i.Left,e.Right,t),Zi(i.Right,e.Left,t),Zi(i.Right,e.Right,t)):(Zi(i.Left,e,t),Zi(i.Right,e,t)))}function hi(i,e,t){!i.irect.intersects_rect(e.irect)||(i==e?function sU(i,e){null!=i.Left&&(hi(i.Left,i.Left,e),hi(i.Left,i.Right,e),hi(i.Right,i.Right,e))}(i,t):null==i.Left?null==e.Left?t(i.UserData,e.UserData):(hi(i,e.Left,t),hi(i,e.Right,t)):null!=e.Left?(hi(i.Left,e.Left,t),hi(i.Left,e.Right,t),hi(i.Right,e.Left,t),hi(i.Right,e.Right,t)):(hi(i.Left,e,t),hi(i.Right,e,t)))}function Rr(i,e,t){if(!i.irect.intersects_rect(e.irect))return!1;if(i==e)return function rU(i,e){return null!=i.Left&&(Rr(i.Left,i.Left,e)||Rr(i.Left,i.Right,e)||Rr(i.Right,i.Right,e))}(i,t);if(null==i.Left){if(null==e.Left)return t(i.UserData,e.UserData);if(Rr(i,e.Left,t)||Rr(i,e.Right,t))return!0}else if(null!=e.Left){if(Rr(i.Left,e.Left,t)||Rr(i.Left,e.Right,t)||Rr(i.Right,e.Left,t)||Rr(i.Right,e.Right,t))return!0}else if(Rr(i.Left,e,t)||Rr(i.Right,e,t))return!0;return!1}var Wn=(()=>{return(i=Wn||(Wn={}))[i.Increasing=0]="Increasing",i[i.Decreasing=1]="Decreasing",i[i.Extremum=2]="Extremum",Wn;var i})();class Mf{constructor(e,t){this.f=e,this.length=t}get Sequence(){return this.f}set Sequence(e){this.f=e}get Length(){return this.length}set Length(e){this.length=e}FindMinimum(){let e=0,t=this.length-1,n=e+Math.floor((t-e)/2);const r=this.f(n);if(r>=this.f(0)&&r>=this.f(this.length-1))return this.f(0)<this.f(this.length-1)?0:this.length-1;for(;t-e>1;)switch(n=e+Math.floor((t-e)/2),this.BehaviourAtIndex(n)){case Wn.Decreasing:e=n;break;case Wn.Increasing:t=n;break;case Wn.Extremum:return n}return e==t||this.f(e)<=this.f(t)?e:t}BehaviourAtIndex(e){const t=this.f(e);if(0==e){const s=this.f(1);return s==t?Wn.Extremum:s>t?Wn.Increasing:Wn.Decreasing}if(e==this.length-1){const s=this.f(this.length-2);return s==t?Wn.Extremum:s>t?Wn.Decreasing:Wn.Increasing}const n=t-this.f(e-1);return n*(this.f(e+1)-t)<=0?Wn.Extremum:n>0?Wn.Increasing:Wn.Decreasing}FindMaximum(){let e=0,t=this.length-1,n=e+Math.floor((t-e)/2);const r=this.f(n);if(r<=this.f(0)&&r<=this.f(this.length-1))return this.f(0)>this.f(this.length-1)?0:this.length-1;for(;t-e>1;)switch(n=e+Math.floor((t-e)/2),this.BehaviourAtIndex(n)){case Wn.Decreasing:t=n;break;case Wn.Increasing:e=n;break;case Wn.Extremum:return n}return e==t||this.f(e)>this.f(t)?e:t}}class oU{constructor(e,t){this.f=e,this.length=t}toArray(){const e=[];for(let t=0;t<this.length;t++)e.push(this.f(t));return e}GetAdjustedSequenceForMinimum(){const e=this.f(0),n=(this.f(this.length-1)-e)/(this.length-1);return r=>Math.min(this.f(r),e+n*r)}GetAdjustedSequenceForMaximum(){const e=this.f(0),n=(this.f(this.length-1)-e)/(this.length-1);return r=>Math.max(this.f(r),e+n*r)}FindMinimum(){return this.f(0)==this.f(this.length-1)?new Mf(this.f,this.length).FindMinimum():new Mf(this.GetAdjustedSequenceForMinimum(),this.length).FindMinimum()}FindMaximum(){return this.f(0)==this.f(this.length-1)?new Mf(this.f,this.length).FindMaximum():new Mf(this.GetAdjustedSequenceForMaximum(),this.length).FindMaximum()}}class Ff{constructor(e,t){this.P=e,this.Q=t}LeftFromLineOnP(e,t,n){const r=this.P.pnt(e);return this.upperBranchOnP?x.pointToTheLeftOfLineOrOnLine(n,r,t):x.pointToTheRightOfLineOrOnLine(n,r,t)}LeftFromLineOnQ(e,t,n){const r=this.Q.pnt(e);return this.lowerBranchOnQ?x.pointToTheLeftOfLineOrOnLine(n,r,t):x.pointToTheRightOfLineOrOnLine(n,r,t)}PrevOnP(e){return this.upperBranchOnP?this.P.Prev(e):this.P.Next(e)}PrevOnQ(e){return this.lowerBranchOnQ?this.Q.Prev(e):this.Q.Next(e)}NextOnP(e){return this.upperBranchOnP?this.P.Next(e):this.P.Prev(e)}NextOnQ(e){return this.lowerBranchOnQ?this.Q.Next(e):this.Q.Prev(e)}MedianOnP(e,t){return this.upperBranchOnP?this.P.Median(e,t):this.P.Median(t,e)}MedianOnQ(e,t){return this.lowerBranchOnQ?this.Q.Median(e,t):this.Q.Median(t,e)}ModuleP(e,t){return this.P.Module(this.upperBranchOnP?t-e:e-t)}ModuleQ(e,t){return this.Q.Module(this.lowerBranchOnQ?t-e:e-t)}TangentBetweenBranches(e,t,n,r){for(;t!=e||r!=n;){const s=t!=e?this.MedianOnP(e,t):e,o=r!=n?this.MedianOnQ(n,r):n,a=this.P.pnt(s),l=this.Q.pnt(o);let c=!0;this.ModuleP(e,t)>1?this.LeftFromLineOnP(this.NextOnP(s),a,l)?e=s:this.LeftFromLineOnP(this.PrevOnP(s),a,l)?t=s:c=!1:t!=e?this.LeftFromLineOnP(t,this.P.pnt(e),l)?e=t:this.LeftFromLineOnP(e,this.P.pnt(t),l)?t=e:c=!1:c=!1;let u=!0;this.ModuleQ(n,r)>1?this.LeftFromLineOnQ(this.NextOnQ(o),l,a)?n=o:this.LeftFromLineOnQ(this.PrevOnQ(o),l,a)?r=o:u=!1:r!=n?this.LeftFromLineOnQ(r,this.Q.pnt(n),a)?n=r:this.LeftFromLineOnQ(n,this.Q.pnt(r),a)?r=n:u=!1:u=!1,!c&&!u&&(e=s,t=s,n=o,r=o)}return[e,r]}FindDividingBisector(e){const t={pClosest:void 0,qClosest:void 0,p1:void 0,p2:void 0,q1:void 0,q2:void 0};this.FindClosestFeatures(t),e.bisectorPivot=x.middle(t.pClosest,t.qClosest),e.bisectorRay=t.pClosest.add(t.qClosest).rotate(Math.PI/2)}FindClosestPoints(){const e={q2:void 0,p1:void 0,p2:void 0,q1:void 0,pClosest:void 0,qClosest:void 0};return this.FindClosestFeatures(e),{pClosest:e.pClosest,qClosest:e.qClosest}}FindClosestFeatures(e){const t={leftTangentPoint:void 0,rightTangentPoint:void 0};this.P.GetTangentPoints(t,this.Q.pp(0).point),e.p2=t.leftTangentPoint,e.p1=t.rightTangentPoint,e.p2==e.p1&&(e.p2+=this.P.count),this.Q.GetTangentPoints(t,this.P.pp(0).point),e.q1=t.leftTangentPoint,e.q2=t.rightTangentPoint,e.q2==e.q1&&(e.q2+=this.Q.count),this.FindClosestPoints_(e)}FindClosestPoints_(e){for(;this.ChunksAreLong(e.p2,e.p1,e.q2,e.q1);)this.ShrinkChunks(e);e.p1==e.p2?(e.pClosest=this.P.pp(e.p2).point,e.q1==e.q2?e.qClosest=this.Q.pp(e.q1).point:(e.qClosest=x.ClosestPointAtLineSegment(e.pClosest,this.Q.pp(e.q1).point,this.Q.pp(e.q2).point),x.closeDistEps(e.qClosest,this.Q.pnt(e.q1))?e.q2=e.q1:x.closeDistEps(e.qClosest,this.Q.pnt(e.q2))&&(e.q1=e.q2))):(e.qClosest=this.Q.pp(e.q1).point,e.pClosest=x.ClosestPointAtLineSegment(e.qClosest,this.P.pp(e.p1).point,this.P.pp(e.p2).point),x.closeDistEps(e.pClosest,this.P.pnt(e.p1))?e.p2=e.p1:x.closeDistEps(e.qClosest,this.P.pnt(e.p2))&&(e.p1=e.p2))}ChunksAreLong(e,t,n,r){const s=this.P.Module(e-t)+1;if(s>2)return!0;const o=this.Q.Module(r-n)+1;return o>2||2==s&&2==o}ShrinkChunks(e){const t=e.p1==e.p2?e.p1:this.P.Median(e.p1,e.p2),n=e.q1==e.q2?e.q1:this.Q.Median(e.q2,e.q1),r=this.P.pp(t).point,s=this.Q.pp(n).point,o={a1:void 0,a2:void 0,b1:void 0,b2:void 0};if(this.GetAnglesAtTheMedian(t,n,r,s,o),!this.InternalCut(e,t,n,o.a1,o.a2,o.b1,o.b2)&&!Ff.OneOfChunksContainsOnlyOneVertex(e,t,n,o.a1,o.b1)&&!this.OnlyOneChunkContainsExactlyTwoVertices(e,{mp:t,mq:n},o)){if(e.p2==this.P.Next(e.p1)&&e.q1==this.Q.Next(e.q2)){const a=me.minDistBetweenLineSegments(this.P.pnt(e.p1),this.P.pnt(e.p2),this.Q.pnt(e.q1),this.Q.pnt(e.q2));return void(0==a.parab?e.p2=e.p1:1==a.parab?e.p1=e.p2:0==a.parcd?e.q2=e.q1:1==a.parcd&&(e.q1=e.q2))}o.a1<=Math.PI&&o.a2<=Math.PI&&o.b1<=Math.PI&&o.b2<=Math.PI?o.a1+o.b1>Math.PI?o.a1>=Math.PI/2?e.p1=t:e.q1=n:o.a2>=Math.PI/2?e.p2=t:e.q2=n:o.a1>Math.PI?e.p1=t:o.a2>Math.PI?e.p2=t:o.b1>Math.PI?e.q1=n:e.q2=n}}InternalCut(e,t,n,r,s,o,a){let l=!1;if(r>=Math.PI&&s>=Math.PI){const c=this.P.pp(t).point,u=this.Q.pp(n).point,y=this.P.pp(this.P.Next(t)).point;x.getTriangleOrientation(c,u,this.Q.pp(0).point)==x.getTriangleOrientation(c,u,y)?e.p1=this.P.Next(t):e.p2=this.P.Prev(t),l=!0}if(o>=Math.PI&&a>=Math.PI){const c=this.P.pp(t).point,u=this.Q.pp(n).point,y=this.Q.pp(this.Q.Next(n)).point;x.getTriangleOrientation(c,u,this.P.pp(0).point)==x.getTriangleOrientation(c,u,y)?e.q2=this.Q.Next(n):e.q1=this.Q.Prev(n),l=!0}return l}GetAnglesAtTheMedian(e,t,n,r,s){s.a1=x.anglePCP(r,n,this.P.pnt(this.P.Prev(e))),s.a2=x.anglePCP(this.P.pnt(this.P.Next(e)),n,r),s.b1=x.anglePCP(this.Q.pnt(this.Q.Next(t)),r,n),s.b2=x.anglePCP(n,r,this.Q.pnt(this.Q.Prev(t)))}OnlyOneChunkContainsExactlyTwoVertices(e,t,n){const r=e.p2==this.P.Next(e.p1),s=e.q1==this.Q.Next(e.q2);return r&&!s?(this.ProcessShortSide(e,t.mp,t.mq,n.a1,n.b1,n.a2,n.b2),!0):!(!s||r||(this.SwapEverything(e,t,n),this.ProcessShortSide(e,t.mp,t.mq,n.a1,n.b1,n.a2,n.b2),this.SwapEverything(e,t,n),0))}SwapEverything(e,t,n){this.SwapPq();let r=e.p2;e.p2=e.q1,e.q1=r,r=e.q2,e.q2=e.p1,e.p1=r,r=t.mq,t.mq=t.mp,t.mp=r,r=n.a2,n.a2=n.b1,n.b1=r,r=n.b2,n.b2=n.a1,n.a1=r}ProcessShortSide(e,t,n,r,s,o,a){t==e.p2?this.ProcessSide(e,n,r,s,a):o<=Math.PI?o+a>=Math.PI?o>=Math.PI/2?e.p2=e.p1:e.q2=n:s>=Math.PI/2?e.q1=n:o<a&&(x.canProject(this.Q.pnt(n),this.P.pp(e.p1).point,this.P.pp(e.p2).point)?e.q1=n:e.p1=e.p2):r+s<=Math.PI?e.p1=e.p2:e.p2=e.p1}SwapPq(){const e=this.P;this.P=this.Q,this.Q=e}ProcessSide(e,t,n,r,s){const o=this.Q.pnt(t);n<=Math.PI?n+r>=Math.PI?n>=Math.PI/2?e.p1=e.p2:e.q1=t:s>=Math.PI/2?e.q2=t:n<s&&(x.canProject(o,this.P.pp(e.p1).point,this.P.pp(e.p2).point)?e.q2=t:e.p2=e.p1):(e.p2=e.p1,r>=Math.PI?e.q1=t:s>=Math.PI&&(e.q2=t))}static OneOfChunksContainsOnlyOneVertex(e,t,n,r,s){return e.p1==e.p2?(s>=Math.PI/2?e.q1=n:e.q2=n,!0):e.q1==e.q2&&(r>=Math.PI/2?e.p1=t:e.p2=t,!0)}CalculateLeftTangents(){let e;this.FindDividingBisector(e);const t=this.P.FindTheFurthestVertexFromBisector(e.p1,e.p2,e.bisectorPivot,e.bisectorRay),n=this.Q.FindTheFurthestVertexFromBisector(e.q2,e.q1,e.bisectorPivot,e.bisectorRay);this.upperBranchOnP=!1,this.lowerBranchOnQ=!0,this.leftPLeftQ=this.TangentBetweenBranches(t,e.p1,n,e.q1),this.lowerBranchOnQ=!1,this.leftPRightQ=this.TangentBetweenBranches(t,e.p1,n,e.q2)}CalculateRightTangents(){let e;this.FindDividingBisector(e);const t=this.P.FindTheFurthestVertexFromBisector(e.p1,e.p2,e.bisectorPivot,e.bisectorRay),n=this.Q.FindTheFurthestVertexFromBisector(e.q2,e.q1,e.bisectorPivot,e.bisectorRay);this.upperBranchOnP=!0,this.lowerBranchOnQ=!0,this.rightPLeftQ=this.TangentBetweenBranches(t,e.p2,n,e.q1),this.lowerBranchOnQ=!1,this.rightPRightQ=this.TangentBetweenBranches(t,e.p2,n,e.q2)}}class Mi{constructor(e){this.polyline=e,this.points=new Array;for(let t=this.polyline.startPoint;t;t=t.next)this.points.push(t)}static mkFromPoints(e){return new Mi(He.mkClosedFromPoints(e))}get Polyline(){return this.polyline}Next(e){return this.Module(e+1)}Prev(e){return this.Module(e-1)}get count(){return this.Polyline.count}Module(e){return e<0?e+this.count:e<this.count?e:e-this.count}pp(e){return this.points[this.Module(e)]}pnt(e){return this.pp(e).point}toString(){return this.polyline.toString()}Median(e,t){return t>e?Math.floor((t+e)/2):this.Module(t+Math.floor((this.count+e)/2))}FindTheFurthestVertexFromBisector(e,t,n,r){let s=r.rotate(Math.PI/2);this.polyline.startPoint.point.sub(n).dot(s)<0&&(s=s.mul(-1)),e==t&&(t=this.Next(e));do{const o=this.Median(t,e),a=this.pnt(o);this.pnt(this.Next(o)).sub(a).dot(s)>=0?t=this.Next(o):this.pnt(this.Prev(o)).sub(a).dot(s)>=0?e=this.Prev(o):t=o,e=o}while(e!=t);return e}static TestPolygonDist(e,t){let n=Number.MAX_SAFE_INTEGER;for(let r=0;r<e.count;r++)for(let s=0;s<t.count;s++){const o=me.minDistBetweenLineSegments(e.pnt(r),e.pnt(r+1),t.pnt(s),t.pnt(s+1));n=Math.min(n,o.dist)}return n}static Distance(e,t){const r=new Ff(e,t).FindClosestPoints();return{p:r.pClosest,q:r.qClosest,dist:r.pClosest.sub(r.qClosest).length}}static DistanceOnly(e,t){return Mi.Distance(e,t).dist}static PolygonIsLegalDebug(e){for(let n=e.Polyline.startPoint;null!=n.next&&null!=n.next.next;n=n.next)if(x.getTriangleOrientation(n.point,n.next.point,n.next.next.point)==Ie.Collinear)return!1;return!0}static DistancePoint(e,t){let n=Number.MAX_VALUE;for(let r=0;r<e.count;r++){const s=x.distToLineSegment(t,e.points[r].point,e.points[(r+1)%e.count].point).dist;n=Math.min(n,s)}return n}GetTangentPoints(e,t){const n=new oU(this.GetSequenceDelegate(t),this.count);e.leftTangentPoint=n.FindMaximum(),e.rightTangentPoint=n.FindMinimum()}GetSequenceDelegate(e){const t=this.pnt(0);return n=>{const r=x.anglePCP(t,e,this.pnt(n));return r<Math.PI?r:r-2*Math.PI}}}let Tr=(()=>{class i{constructor(t,n,r,s){this.Obstacles=t,this.TightPadding=n,this.LoosePadding=r,this.IgnoreTightPadding=s}ObstaclesIntersectLine(t,n){return this.ObstaclesIntersectICurve(me.mkPP(t,n))}static PadCorner(t,n,r,s,o){const a=i.GetPaddedCorner(n,r,s,o);return-1!=a.numberOfPoints&&(t.addPoint(a.a),2==a.numberOfPoints&&t.addPoint(a.b),!0)}static CurveIsClockwise(t,n){return x.getTriangleOrientation(n,t.start,t.start.add(t.derivative(t.parStart)))==Ie.Clockwise}static PaddedPolylineBoundaryOfNode(t,n){return i.CreatePaddedPolyline(te.polylineAroundClosedCurve(t),n)}static LoosePolylineWithFewCorners(t,n){return n<q.distanceEpsilon?t:i.CreateLoosePolylineOnBisectors(t,n)}static CreateLoosePolylineOnBisectors(t,n){return He.mkClosedFromPoints(Zr.CalculateConvexHull(i.BisectorPoints(t,n)))}static CreateRectNodeOfPolyline(t){return Gn(t,t.boundingBox)}CreateLooseObstacles(){this.tightPolylinesToLooseDistances=new Map,this.LooseObstacles=new Array;for(const t of this.TightObstacles){const n=i.FindMaxPaddingForTightPolyline(this.RootOfTightHierarchy,t,this.LoosePadding);this.tightPolylinesToLooseDistances.set(t,n),this.LooseObstacles.push(i.LoosePolylineWithFewCorners(t,n))}this.RootOfLooseHierarchy=i.CalculateHierarchy(this.LooseObstacles)}CreateTightObstacles(){this.RootOfTightHierarchy=i.CreateTightObstacles_(this.Obstacles,this.TightPadding,this.TightObstacles),this.OverlapsDetected=this.TightObstacles.size<this.Obstacles.length}Calculate(){this.IgnoreTightPadding?this.CreateTightObstaclesIgnoringTightPadding():this.CreateTightObstacles(),this.IsEmpty()||this.CreateLooseObstacles()}IsEmpty(){return null==this.TightObstacles||0==this.TightObstacles.size}ObstaclesIntersectICurve(t){return i.CurveIntersectsRectangleNode(t,t.boundingBox,this.RootOfTightHierarchy)}static CurveIntersectsRectangleNode(t,n,r){if(!r.irect.intersects(n))return!1;if(null!=r.UserData){const s=r.UserData;return null!=te.intersectionOne(s,t,!1)||i.PointIsInside(s.start,t)}return i.CurveIntersectsRectangleNode(t,n,r.Left)||i.CurveIntersectsRectangleNode(t,n,r.Right)}static PointIsInside(t,n){return te.PointRelativeToCurveLocation(t,n)==We.Inside}CreateTightObstaclesIgnoringTightPadding(){const t=this.Obstacles.map(s=>te.polylineAroundClosedCurve(s)),n=i.CalculateHierarchy(t),r=i.GetOverlappedPairSet(n);if(this.TightObstacles=new Set,0==r.size){for(const s of t){const o=i.FindMaxPaddingForTightPolyline(n,s,this.TightPadding);this.TightObstacles.add(i.LoosePolylineWithFewCorners(s,o))}this.RootOfTightHierarchy=i.CalculateHierarchy(Array.from(this.TightObstacles))}else{for(const s of t)this.TightObstacles.add(i.CreatePaddedPolyline(s,this.TightPadding));if(!this.IsEmpty())for(this.RootOfTightHierarchy=i.CalculateHierarchy(Array.from(this.TightObstacles)),this.OverlapsDetected=!1;i.GetOverlappedPairSet(this.RootOfTightHierarchy).size>0;)this.RootOfTightHierarchy=i.ReplaceTightObstaclesWithConvexHulls(this.TightObstacles,Array.from(r)),this.OverlapsDetected=!0}}static CreateTightObstacles_(t,n,r){if(0==t.length)return null;for(const s of t)i.CalculateTightPolyline(r,n,s);return i.RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(r)}static CalculateTightPolyline(t,n,r){const s=i.PaddedPolylineBoundaryOfNode(r,n);t.add(s)}static CalculateHierarchy(t){return fn(t.map(r=>i.CreateRectNodeOfPolyline(r)))}static RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(t){let r,n=i.CalculateHierarchy(Array.from(t));for(;(r=i.GetOverlappedPairSet(n)).size>0;)n=i.ReplaceTightObstaclesWithConvexHulls(t,Array.from(r));return n}static MapToInt(t){const n=new Map;for(let r=0;r<t.length;r++)n.set(t[r],r);return n}static ReplaceTightObstaclesWithConvexHulls(t,n){const r=new Set;for(const c of n)r.add(c[0]),r.add(c[1]);const s=Array.from(r),o=i.MapToInt(s),l=Bu(bI(Array.from(n).map(c=>new mt(o.get(c[0]),o.get(c[1])))));for(const c of l){const u=c.map(D=>s[D]),y=Yu(u,D=>Array.from(D)),R=Zr.createConvexHullAsClosedPolyline(y);for(const D of u)t.delete(D);t.add(R)}return i.CalculateHierarchy(Array.from(t))}static OneCurveLiesInsideOfOther(t,n){return te.PointRelativeToCurveLocation(t.start,n)!=We.Outside||te.PointRelativeToCurveLocation(n.start,t)!=We.Outside}static PolylinesIntersect(t,n){return te.CurvesIntersect(t,n)||i.OneCurveLiesInsideOfOther(t,n)}static GetOverlappedPairSet(t){const n=new Set;return hi(t,t,(r,s)=>{i.PolylinesIntersect(r,s)&&n.add([r,s])}),n}static BisectorPoints(t,n){const r=new Array;for(let s=t.startPoint;null!=s;s=s.next){const o={skip:!1},a=i.GetStickingVertexOnBisector(s,n,o);o.skip||r.push(a)}return r}static GetStickingVertexOnBisector(t,n,r){const s=t.polyline.prev(t).point,o=t.point,a=t.polyline.next(t).point;let l=o.sub(s).normalize().add(o.sub(a).normalize());const c=l.length;return c<q.tolerance?r.skip=!0:(r.skip=!1,l=l.div(c)),l.mul(n).add(o)}static FindMaxPaddingForTightPolyline(t,n,r){let s=r;const o=new Mi(n),a=n.boundingBox.clone();a.pad(2*r);for(const l of Array.from(t.GetNodeItemsIntersectingRectangle(a)).filter(c=>c!=n)){const c=Mi.Distance(o,new Mi(l)).dist;s=Math.min(s,c/i.LooseDistCoefficient)}return s}static GetPaddedCorner(t,n,r,s){const o=t.point,a=n.point,l=r.point;if(x.getTriangleOrientation(o,a,l)==Ie.Counterclockwise)return{a:void 0,b:void 0,numberOfPoints:-1};let c=a.sub(o).rotate(Math.PI/2).normalize();if(i.CornerIsNotTooSharp(o,a,l)){c=c.mul(s);const k=l.sub(a).normalize().mul(s).rotate(Math.PI/2),W=x.lineLineIntersection(o.add(c),a.add(c),a.add(k),l.add(k));return{a:W,b:W,numberOfPoints:1}}const u=a.sub(o).normalize().add(a.sub(l).normalize());if(u.length<q.intersectionEpsilon){const k=a.add(c.mul(s));return{a:k,b:k,numberOfPoints:1}}const y=u.normalize().mul(s),R=y.rotate(Math.PI/2),D=(s-y.dot(c))/R.dot(c),L=R.mul(D);return{a:y.add(L).add(a),b:y.sub(L).add(a),numberOfPoints:2}}static CornerIsNotTooSharp(t,n,r){const s=t.sub(n).rotate(Math.PI/4).add(n);return x.getTriangleOrientation(n,s,r)==Ie.Counterclockwise}static CreatePaddedPolyline(t,n){const r=new He;if(!i.PadCorner(r,t.endPoint.prev,t.endPoint,t.startPoint,n)||!i.PadCorner(r,t.endPoint,t.startPoint,t.startPoint.next,n))return i.CreatePaddedPolyline(He.mkClosedFromPoints(Array.from(Zr.CalculateConvexHull(t))),n);for(let s=t.startPoint;null!=s.next.next;s=s.next)if(!i.PadCorner(r,s,s.next,s.next.next,n))return i.CreatePaddedPolyline(He.mkClosedFromPoints(Array.from(Zr.CalculateConvexHull(t))),n);return r.closed=!0,r}}return i.LooseDistCoefficient=2.1,i})();class KE{get TightPolyline(){return this.tightPoly}set TightPolyline(e){this.tightPoly=e}static mk(e,t,n){const r=new KE;return r.TightPolyline=e,r.LooseShape=t,r.Distance=n,r}toString(){return(null==this.TightPolyline?"null":this.TightPolyline.toString().substring(0,5))+","+(null==this.LooseShape?"null":this.LooseShape.toString().substring(0,5))}}class $E{constructor(e,t,n,r){this.MainShape=e,this.TightPadding=t,this.LoosePadding=n,this.ShapesToTightLooseCouples=r}Calculate(){0!=this.MainShape.Children.length&&(this.CreateTightObstacles(),this.CreateTigthLooseCouples(),this.FillTheMapOfShapeToTightLooseCouples())}FillTheMapOfShapeToTightLooseCouples(){Zi(fn(this.MainShape.Children.map(t=>Gn(t,t.BoundingBox))),this.coupleHierarchy,this.TryMapShapeToTightLooseCouple.bind(this))}TryMapShapeToTightLooseCouple(e,t){$E.ShapeIsInsideOfPoly(e,t.TightPolyline)&&this.ShapesToTightLooseCouples.set(e,t)}static ShapeIsInsideOfPoly(e,t){return te.PointRelativeToCurveLocation(e.BoundaryCurve.start,t)==We.Inside}CreateTigthLooseCouples(){const e=new Array;for(const t of this.tightHierarchy.GetAllLeaves()){const n=Tr.FindMaxPaddingForTightPolyline(this.tightHierarchy,t,this.LoosePadding),r=Tr.LoosePolylineWithFewCorners(t,n);e.push(KE.mk(t,new ql(r),n))}this.coupleHierarchy=fn(e.map(t=>Gn(t,t.TightPolyline.boundingBox)))}CreateTightObstacles(){const e=new Set(this.MainShape.Children.map(this.InitialTightPolyline.bind(this))),t=e.size;this.tightHierarchy=Tr.RemovePossibleOverlapsInTightPolylinesAndCalculateHierarchy(e),this.OverlapsDetected=t>e.size}InitialTightPolyline(e){const t=Tr.PaddedPolylineBoundaryOfNode(e.BoundaryCurve,this.TightPadding),n=Yu(this.LoosePolylinesUnderShape(e),s=>Array.from(s)).filter(s=>te.PointRelativeToCurveLocation(s,t)==We.Outside);if(n.length<=0)return t;const r=Array.from(t).concat(n);return He.mkClosedFromPoints(Zr.CalculateConvexHull(r))}LoosePolylinesUnderShape(e){return e.Children.map(t=>this.ShapesToTightLooseCouples.get(t).LooseShape.BoundaryCurve)}}class aU{constructor(e,t,n){this.indexToA=e,this.priority=t,this.v=n}}class Vo{constructor(e=Vt){this.heapSize=0,this.compare=e,this.cache=new Map,this.A=[]}get count(){return this.heapSize}ContainsElement(e){return this.cache.has(e)}SwapWithParent(e){const t=this.A[e>>1];this.PutAtI(e>>1,this.A[e]),this.PutAtI(e,t)}Enqueue(e,t){let n=++this.heapSize;const r=new aU(n,t,e);for(this.cache.set(e,r),this.A[n]=r;n>1&&this.compare(this.A[n>>1].priority,t)>0;)this.SwapWithParent(n),n>>=1}IsEmpty(){return 0==this.heapSize}PutAtI(e,t){this.A[e]=t,t.indexToA=e}Dequeue(){if(0==this.heapSize)throw new Error("dequeue on an empty queue");const e=this.A[1].v;return this.MoveQueueOneStepForward(e),e}DequeueAndGetPriority(e){if(0==this.heapSize)throw new Error("dequeue on an empty queue");const t=this.A[1].v;return e.priority=this.A[1].priority,this.MoveQueueOneStepForward(t),t}MoveQueueOneStepForward(e){this.cache.delete(e),this.PutAtI(1,this.A[this.heapSize]);let t=1;for(;;){let n=t;const r=t<<1;r<=this.heapSize&&this.compare(this.A[r].priority,this.A[t].priority)<0&&(n=r);const s=r+1;if(s<=this.heapSize&&this.compare(this.A[s].priority,this.A[n].priority)<0&&(n=s),n==t)break;this.SwapWithParent(n),t=n}this.heapSize--}DecreasePriority(e,t){const n=this.cache.get(e);if(!n)return;n.priority=t;let r=n.indexToA;for(;r>1&&this.compare(this.A[r].priority,this.A[r>>1].priority)<0;)this.SwapWithParent(r),r>>=1}*GetEnumerator(){for(let e=1;e<=this.heapSize;e++)yield this.A[e].v}Peek(e){if(0!=this.count)return e.priority=this.A[1].priority,this.A[1].v;e.priority=0}toString(){const e=new Hn.StringBuilder;for(const t of this.A)e.Append(t+",");return e.ToString()}}class ju{constructor(e,t,n){this.upperBound=Number.POSITIVE_INFINITY,this._visGraph=n,this._visGraph.ClearPrevEdgesTable();for(const r of n.Vertices())r.Distance=Number.POSITIVE_INFINITY;this.source=e,this.targets=new Set(t),this.source.Distance=0}GetPath(){const e=new Vo(Vt);for(this.source.Distance=0,e.Enqueue(this.source,0);!e.IsEmpty()&&(this.current=e.Dequeue(),!this.targets.has(this.current));){for(const t of this.current.OutEdges)this.PassableOutEdge(t)&&this.ProcessNeighbor(e,t,t.Target);for(const t of this.current.InEdges)this.PassableInEdge(t)&&this.ProcessNeighbor(e,t,t.Source)}return null==this._visGraph.PreviosVertex(this.current)?null:this.CalculatePath()}PassableOutEdge(e){return e.Source==this.source||this.targets.has(e.Target)||!ju.IsForbidden(e)}PassableInEdge(e){return this.targets.has(e.Source)||e.Target==this.source||!ju.IsForbidden(e)}static IsForbidden(e){return null!=e.IsPassable&&!e.IsPassable()||e instanceof As}ProcessNeighbor(e,t,n){const s=this.current.Distance+t.Length;s>=this.upperBound||(this.targets.has(n)&&(this.upperBound=s,this.closestTarget=n),n!=this.source&&null==this._visGraph.PreviosVertex(n)?(n.Distance=s,this._visGraph.SetPreviousEdge(n,t),e.Enqueue(n,s)):s<n.Distance&&(n.Distance=s,this._visGraph.SetPreviousEdge(n,t),e.DecreasePriority(n,s)))}CalculatePath(){if(null==this.closestTarget)return null;const e=new Array;let t=this.closestTarget;do{e.push(t),t=this._visGraph.PreviosVertex(t)}while(t!=this.source);return e.push(this.source),e.reverse()}}class Bf{constructor(e,t,n){this._lengthMultiplier=1,this._lengthMultiplierForAStar=1,this._visGraph=e,this._source=t,this._target=n,this._source.Distance=0}get LengthMultiplier(){return this._lengthMultiplier}set LengthMultiplier(e){this._lengthMultiplier=e}get LengthMultiplierForAStar(){return this._lengthMultiplierForAStar}set LengthMultiplierForAStar(e){this._lengthMultiplierForAStar=e}GetPath(e){const t=new Vo(Vt);for(this._source.Distance=0,this._target.Distance=Number.POSITIVE_INFINITY,t.Enqueue(this._source,this.H(this._source));!t.IsEmpty();){const n={priority:0},r=t.DequeueAndGetPriority(n);if(n.priority>=this._target.Distance)break;for(const s of r.OutEdges)this.PassableOutEdge(s)&&this.ProcessNeighbor(t,r,s,s.Target);for(const s of r.InEdges)this.PassableInEdge(s)&&this.ProcessNeighbor(t,r,s,s.Source)}return null==this._visGraph.PreviosVertex(this._target)?null:this.CalculatePath(e)}PassableOutEdge(e){return e.Source==this._source||e.Target==this._target||!Bf.IsForbidden(e)}PassableInEdge(e){return e.Source==this._target||e.Target==this._source||!Bf.IsForbidden(e)}static IsForbidden(e){return null!=e.IsPassable&&!e.IsPassable()||e instanceof As}ProcessNeighborN(e,t,n,r,s){const a=t.Distance+(n.Length+s);r!=this._source&&null==this._visGraph.PreviosVertex(r)?(r.Distance=a,this._visGraph.SetPreviousEdge(r,n),r!=this._target&&e.Enqueue(r,this.H(r))):r!=this._source&&a<r.Distance&&(r.Distance=a,this._visGraph.SetPreviousEdge(r,n),r!=this._target&&e.DecreasePriority(r,this.H(r)))}ProcessNeighbor(e,t,n,r){const o=t.Distance+n.Length;r!=this._source&&null==this._visGraph.PreviosVertex(r)?(r.Distance=o,this._visGraph.SetPreviousEdge(r,n),r!=this._target&&e.Enqueue(r,this.H(r))):r!=this._source&&o<r.Distance&&(r.Distance=o,this._visGraph.SetPreviousEdge(r,n),r!=this._target&&e.DecreasePriority(r,this.H(r)))}H(e){return e.Distance+e.point.sub(this._target.point).length*this.LengthMultiplierForAStar}CalculatePath(e){const t=new Array;let n=this._target;do{t.push(n),e&&this._visGraph.ShrinkLengthOfPrevEdge(n,this.LengthMultiplier),n=this._visGraph.PreviosVertex(n)}while(n!=this._source);return t.push(this._source),t.reverse()}}var Cs=(()=>{return(i=Cs||(Cs={}))[i.Regular=0]="Regular",i[i.Tangent=1]="Tangent",Cs;var i})();class GI{constructor(e,t){this.LeftTangent=e,this.RightTangent=t}toString(){return Hn.String.Format("{0},{1}",this.Start,this.End)}get Start(){return this.leftTangent.End.point}get End(){return this.rightTangent.End.point}get LeftTangent(){return this.leftTangent}set LeftTangent(e){this.leftTangent=e}get RightTangent(){return this.rightTangent}set RightTangent(e){this.rightTangent=e}get RbNode(){return this.rbNode}set RbNode(e){this.rbNode=e}}class HI{constructor(e,t){this.start=e,this.End=t}get Comp(){return this.comp}set Comp(e){this.comp=e}get IsHigh(){return!this.IsLow}get IsLow(){return this.lowTangent}set IsLow(e){this.lowTangent=e}get SeparatingPolygons(){return this.separatingPolygons}set SeparatingPolygons(e){this.separatingPolygons=e}get Diagonal(){return this.diagonal}set Diagonal(e){this.diagonal=e}get Start(){return this.start}set Start(e){this.start=e}get End(){return this.end}set End(e){this.end=e}toString(){return Hn.String.Format("{0},{1}",this.Start,this.End)}}class YI{get PointOnTangentAndInsertedDiagonal(){return this.pointOnTheRay}set PointOnTangentAndInsertedDiagonal(e){this.pointOnTheRay=e}Compare(e,t){return e.Start.equal(t.Start)?0:x.getTriangleOrientation(this.PointOnTangentAndInsertedDiagonal,t.Start,t.End)===Ie.Counterclockwise?-1:1}static BelongsToTheDiagonal(e,t,n){return x.closeDistEps(e,x.ClosestPointAtLineSegment(e,t,n))}static IntersectDiagonalWithRay(e,t,n){const r=t.sub(e),s=n.Start,o=n.End,a=Lu.solve(o.x-s.x,-1*r.x,e.x-s.x,o.y-s.y,-1*r.y,e.y-s.y);return e.add(r.mul(a.y))}}class tc{constructor(e){this.pivot=e}IComparer(e,t){if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;const n=e.Start.point.sub(this.pivot),r=t.Start.point.sub(this.pivot);return tc.CompareVectorsByAngleToXAxis(n,r)}static CompareVectorsByAngleToXAxis(e,t){return e.y>=0?t.y<0?-1:tc.CompareVectorsPointingToTheSameYHalfPlane(e,t):t.y>=0?1:tc.CompareVectorsPointingToTheSameYHalfPlane(e,t)}static CompareVectorsPointingToTheSameYHalfPlane(e,t){const n=e.x*t.y-e.y*t.x;if(n>q.tolerance)return-1;if(n<-q.tolerance)return 1;if(e.x>=0){if(t.x<0)return-1}else if(t.x>=0)return 1;let r=Math.abs(e.x)-Math.abs(t.x);return r<0?-1:r>0?1:(r=Math.abs(e.y)-Math.abs(t.y),r<0?-1:r>0?1:0)}}class Go extends dn{constructor(e,t,n){super(null),this.activeDiagonalComparer=new YI,this.polygons=e,this.visibilityGraph=n,this.addedPolygons=t}run(){this.useLeftPTangents=!0,this.CalculateAndAddEdges(),this.useLeftPTangents=!1,this.CalculateAndAddEdges()}CalculateAndAddEdges(){for(const e of this.addedPolygons)this.CalculateVisibleTangentsFromPolygon(e);this.ProgressStep()}CalculateVisibleTangentsFromPolygon(e){this.currentPolygon=e,this.AllocateDataStructures(),this.OrganizeTangents(),this.InitActiveDiagonals(),this.Sweep()}AllocateDataStructures(){this.tangents=new Array,this.diagonals=new Array,this.activeDiagonalTree=new Xi(this.activeDiagonalComparer.Compare.bind(this.activeDiagonalComparer))}Sweep(){if(!(this.tangents.length<2))for(let e=1;e<this.tangents.length;e++){const t=this.tangents[e];null!=t.Diagonal?(t.Diagonal.RbNode==this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(t),t.IsHigh&&this.RemoveDiagonalFromActiveNodes(t.Diagonal)):t.IsLow&&(this.activeDiagonalComparer.PointOnTangentAndInsertedDiagonal=t.End.point,this.InsertActiveDiagonal(new GI(t,t.Comp)),t.Diagonal.RbNode==this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(t))}}AddVisibleEdge(e){gn.AddEdgeVV(UI(this.visibilityGraph,e.start),UI(this.visibilityGraph,e.End))}InitActiveDiagonals(){if(0==this.tangents.length)return;const e=this.tangents[0],t=e.start.point,n=e.End.point;for(const r of this.diagonals)Go.RayIntersectDiagonal(t,n,r)&&(this.activeDiagonalComparer.PointOnTangentAndInsertedDiagonal=YI.IntersectDiagonalWithRay(t,n,r),this.InsertActiveDiagonal(r)),e.Diagonal.RbNode==this.activeDiagonalTree.treeMinimum()&&this.AddVisibleEdge(e),0==e.IsLow&&this.RemoveDiagonalFromActiveNodes(e.Diagonal)}RemoveDiagonalFromActiveNodes(e){const t=this.activeDiagonalTree.deleteSubTree(e.RbNode);null!=t&&null!=t.item&&(t.item.RbNode=t),e.LeftTangent.Diagonal=null,e.RightTangent.Diagonal=null}InsertActiveDiagonal(e){e.RbNode=this.activeDiagonalTree.insert(e),Go.MarkDiagonalAsActiveInTangents(e)}static MarkDiagonalAsActiveInTangents(e){e.LeftTangent.Diagonal=e,e.RightTangent.Diagonal=e}static RayIntersectDiagonal(e,t,n){const r=n.Start,s=n.End;return x.getTriangleOrientation(e,r,s)==Ie.Counterclockwise&&x.getTriangleOrientation(e,t,r)!=Ie.Counterclockwise&&x.getTriangleOrientation(e,t,s)!=Ie.Clockwise}static TangentComparison(e,t){return tc.CompareVectorsByAngleToXAxis(e.End.point.sub(e.start.point),t.End.point.sub(t.start.point))}*AllObstacles(){for(const e of this.addedPolygons)yield e;for(const e of this.polygons)yield e}OrganizeTangents(){for(const e of this.AllObstacles())e!=this.currentPolygon&&this.ProcessPolygonQ(e);this.tangents.sort(Go.TangentComparison)}ProcessPolygonQ(e){const t=new Ff(this.currentPolygon,e);this.useLeftPTangents?t.CalculateLeftTangents():t.CalculateRightTangents();let n=this.useLeftPTangents?t.leftPLeftQ:t.rightPLeftQ;const r=new HI(this.currentPolygon.pp(n[0]),e.pp(n[1]));r.IsLow=!0,r.SeparatingPolygons=!this.useLeftPTangents,n=this.useLeftPTangents?t.leftPRightQ:t.rightPRightQ;const s=new HI(this.currentPolygon.pp(n[0]),e.pp(n[1]));s.IsLow=!1,s.SeparatingPolygons=this.useLeftPTangents,r.Comp=s,s.Comp=r,this.tangents.push(r),this.tangents.push(s),this.diagonals.push(new GI(r,s))}}function UI(i,e){return i.FindVertex(e.point)}class JE{get Pivot(){return this.pivot}set Pivot(e){this.pivot=e}get IntersectionOfTheRayAndInsertedEdge(){return this.pointOnTheRay}set IntersectionOfTheRayAndInsertedEdge(e){this.pointOnTheRay=e}Compare(e,t){return x.getTriangleOrientation(this.IntersectionOfTheRayAndInsertedEdge,t.point,t.nextOnPolyline.point)===Ie.Counterclockwise?-1:1}IntersectionPointBelongsToTheInsertedEdge(e){const t=e.point.sub(this.IntersectionOfTheRayAndInsertedEdge),n=e.nextOnPolyline.point.sub(this.IntersectionOfTheRayAndInsertedEdge);return Math.abs(t.x*n.y-n.x*t.y)<q.distanceEpsilon}IntersectEdgeWithRayPPP(e,t,n){const r=Lu.solve(t.x-e.x,-n.x,this.Pivot.x-e.x,t.y-e.y,-n.y,this.Pivot.y-e.y);if(!(-q.tolerance<=r.x&&r.x<=1+q.tolerance))throw new Error;if(!r)throw new Error;return this.Pivot.add(n.mul(r.y))}IntersectEdgeWithRay(e,t){return this.IntersectEdgeWithRayPPP(e.point,e.nextOnPolyline.point,t)}static constructorPP(e,t){const n=new JE;return n.pivot=e,n.pointOnTheRay=t,n}}class zu{constructor(e,t){this.start=e,this.end=t}get Start(){return this.start}set Start(e){this.start=e}get End(){return this.end}set End(e){this.end=e}*Sides(){let e=this.start;for(;e!=this.end;){const t=e;yield t,e=t.nextOnPolyline}}MoveStartClockwise(){return this.Start!=this.End&&(this.Start=this.Start.nextOnPolyline,!0)}toString(){return Hn.String.Format("Stem({0},{1})",this.Start,this.End)}}class no{constructor(e,t,n,r){this.sideNodes=new Map,this.visibleBoundaries=new Map,this.sortedListOfPolypoints=new Array,this.holes=Array.from(e),this.visibilityGraph=t,this.q=n,this.qPolylinePoint=$i.mkFromPoint(this.q),this.QVertex=this.visibilityGraph.AddVertexP(this.qPolylinePoint.point),this.visibilityKind=r;const s=new tc(this.q);this.heapForSorting=new GE(s.IComparer.bind(s))}get QVertex(){return this.qV}set QVertex(e){this.qV=e}static CalculatePointVisibilityGraph(e,t,n,r){const s=t.FindVertex(n);if(null!=s)return s;const o=new no(e,t,n,r);return o.FillGraph(),o.QVertex}FillGraph(){this.ComputeHoleBoundariesPossiblyVisibleFromQ(),this.visibleBoundaries.size>0&&(this.SortSAndInitActiveSides(),this.Sweep())}SortSAndInitActiveSides(){this.InitHeapAndInsertActiveSides();for(let e=this.heapForSorting.GetMinimum();this.sortedListOfPolypoints.push(e.Start),e.MoveStartClockwise()?this.heapForSorting.ChangeMinimum(e):this.heapForSorting.Dequeue(),0!=this.heapForSorting.Count;e=this.heapForSorting.GetMinimum());}InitHeapAndInsertActiveSides(){for(const e of this.GetInitialVisibleBoundaryStemsAndInsertActiveSides())this.heapForSorting.Enqueue(e)}*GetInitialVisibleBoundaryStemsAndInsertActiveSides(){for(const[e,t]of this.visibleBoundaries){let n=!1;for(const r of t.Sides()){const s=r;if(s.point.y<this.q.y){if(r.nextOnPolyline.point.y>=this.q.y){const o=x.getTriangleOrientation(this.q,s.point,r.nextOnPolyline.point);if(o==Ie.Counterclockwise||o==Ie.Collinear){n=!0,yield new zu(t.Start,r),yield new zu(r.nextOnPolyline,t.End),this.RegisterActiveSide(r);break}}}else{if(s.point.y>this.q.y)break;if(r.point.x>=this.q.x){n=!0,yield new zu(r,t.End),r!=t.Start&&(yield new zu(t.Start,e.prev(s))),this.RegisterActiveSide(r);break}}}n||(yield t)}}RegisterActiveSide(e){this.activeEdgeComparer.IntersectionOfTheRayAndInsertedEdge=this.activeEdgeComparer.IntersectEdgeWithRay(e,new x(1,0)),this.sideNodes.set(e,this.activeSidesTree.insert(e))}Sweep(){for(const e of this.sortedListOfPolypoints)this.SweepPolylinePoint(e)}SweepPolylinePoint(e){const t=no.GetIncomingSide(e),n=this.GetOutgoingSide(e);let r;if(this.activeEdgeComparer.IntersectionOfTheRayAndInsertedEdge=e.point,r=this.sideNodes.get(t)){if(r==this.activeSidesTree.treeMinimum()&&this.AddEdge(e),null!=n)r.item=n,this.sideNodes.set(n,r);else{const s=this.activeSidesTree.deleteSubTree(r);null!=s&&null!=s.item&&this.sideNodes.set(s.item,s)}this.sideNodes.delete(t)}else{if(null==n)throw new Error;{let s;(s=this.sideNodes.get(n))||(s=this.activeSidesTree.insert(n),this.sideNodes.set(n,s),s==this.activeSidesTree.treeMinimum()&&this.AddEdge(e))}}}AddEdge(e){(this.visibilityKind==Cs.Regular||this.visibilityKind==Cs.Tangent&&no.LineTouchesPolygon(this.QVertex.point,e))&&this.visibilityGraph.AddEdgeF(this.QVertex.point,e.point,(t,n)=>new As(t,n))}static LineTouchesPolygon(e,t){const n=t.polyline.prev(t).point,r=t.polyline.next(t).point,s=t.point;return x.signedDoubledTriangleArea(e,s,n)*x.signedDoubledTriangleArea(e,s,r)>=0}GetOutgoingSide(e){return e==this.visibleBoundaries.get(e.polyline).End?null:e}static GetIncomingSide(e){return e.prevOnPolyline}ComputeHoleBoundariesPossiblyVisibleFromQ(){this.InitActiveEdgesAndActiveEdgesComparer();for(const e of this.holes)this.ComputeVisiblePartOfTheHole(e)}InitActiveEdgesAndActiveEdgesComparer(){this.activeEdgeComparer=new JE,this.activeEdgeComparer.pivot=this.q,this.activeSidesTree=new Xi(this.activeEdgeComparer.Compare.bind(this.activeEdgeComparer))}ComputeVisiblePartOfTheHole(e){let t,n=!0;for(t=e.startPoint;!this.HoleSideIsVisibleFromQ(e,t);t=e.next(t))n=!1;let r=e.next(t);if(n)for(;this.HoleSideIsVisibleFromQ(e,e.prev(t));)t=e.prev(t);for(;this.HoleSideIsVisibleFromQ(e,r);r=e.next(r));this.visibleBoundaries.set(e,new zu(t,r))}HoleSideIsVisibleFromQ(e,t){return x.signedDoubledTriangleArea(this.q,t.point,e.next(t).point)>=-q.squareOfDistanceEpsilon}}class WI{constructor(e,t){this.next=null,this.prev=null,this.PolylinePoint=e,this.OriginalPosition=t}get PolylinePoint(){return this.polylinePoint}set PolylinePoint(e){this.polylinePoint=e}get OriginalPosition(){return this.originalPosition}set OriginalPosition(e){this.originalPosition=e}get Next(){return this.next}set Next(e){this.next=e}get Prev(){return this.prev}set Prev(e){this.prev=e}}class Tt extends dn{constructor(){super(...arguments),this.IgnoreTightPadding=!0,this.activeRectangle=De.mkEmpty(),this.activePolygons=new Array,this.alreadyAddedOrExcludedPolylines=new Set,this.UseEdgeLengthMultiplier=!1,this.UseInnerPolylingShortcutting=!0,this.UsePolylineEndShortcutting=!0,this.AllowedShootingStraightLines=!0,this.LookForRoundedVertices=!1}get Obstacles(){return this.obstacles_}set Obstacles(e){this.obstacles_=e}get EnteringAngleBound(){return this.enteringAngleBound_}set EnteringAngleBound(e){this.enteringAngleBound_=e}get SourceTightPolyline(){return this._sourceTightPolyline}set SourceTightPolyline(e){this._sourceTightPolyline=e}get TargetTightPolyline(){return this.targetTightPolyline}set TargetTightPolyline(e){this.targetTightPolyline=e}get TargetLoosePolyline(){return this.targetLoosePolyline}set TargetLoosePolyline(e){this.targetLoosePolyline=e}get VisibilityGraph(){return this.visibilityGraph}set VisibilityGraph(e){this.visibilityGraph=e}get SourcePort(){return this.sourcePort}set SourcePort(e){if(this.sourcePort=e,null!=this.sourcePort)if(this.SourceTightPolyline=Tt.GetFirstHitPolyline(this.sourcePort.Location,this.ObstacleCalculator.RootOfTightHierarchy),this.sourcePort instanceof Ss)this.alreadyAddedOrExcludedPolylines.add(this.SourceLoosePolyline),this.StartPointOfEdgeRouting=this.SourcePort.Location;else{const t=this.sourcePort;this.StartPointOfEdgeRouting=this.TakeBoundaryPortOutsideOfItsLoosePolyline(t.Curve,t.Parameter,this.SourceLoosePolyline)}}get TargetPort(){return this.targetPort}set TargetPort(e){this.targetPort=e}get LoosePadding(){return this.loosePadding}set LoosePadding(e){this.loosePadding=e,null!=this.ObstacleCalculator&&(this.ObstacleCalculator.LoosePadding=e)}get StartPointOfEdgeRouting(){return this.startPointOfRouting_}set StartPointOfEdgeRouting(e){this.startPointOfRouting_=e}ExtendVisibilityGraphToLocation(e){null==this.VisibilityGraph&&(this.VisibilityGraph=new gn);let t=null;if(!this.activeRectangle.contains(e)){this.activeRectangle.isEmpty?this.activeRectangle=De.mkPP(this.SourcePort.Location,e):this.activeRectangle.add(e),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle();for(const n of t)this.VisibilityGraph.AddHole(n.Polyline)}null==t||0==t.length?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraph(e)):(this.RemovePointVisibilityGraphs(),new Go(t,this.activePolygons,this.VisibilityGraph).run(),wa(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraph(e),this.CalculateSourcePortVisibilityGraph())}RemovePointVisibilityGraphs(){null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),null!=this.sourceVV&&this.VisibilityGraph.RemoveVertex(this.sourceVV)}CalculateEdgeTargetVisibilityGraph(e){this.targetVV=no.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()),this.VisibilityGraph,e,Cs.Tangent)}CalculateSourcePortVisibilityGraph(){this.sourceVV=no.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()),this.VisibilityGraph,this.StartPointOfEdgeRouting,Cs.Tangent)}TakeBoundaryPortOutsideOfItsLoosePolyline(e,t,n){const r=e.value(t);let s=e.leftDerivative(t).normalize().add(e.rightDerivative(t).normalize()).normalize();x.getTriangleOrientation(Tt.PointInsideOfConvexCurve(e),r,r.add(s))==Ie.Counterclockwise&&(s=s.mul(-1)),s=s.rotate(Math.PI/2);let a=me.mkPP(r,r.add(s.mul(n.boundingBox.diagonal)));const l=te.intersectionOne(a,n,!1).x;let c=s.mul(l.sub(r).length/2);for(;;){a=me.mkPP(r,l.add(c));let u=!1;for(const y of Tt.IntersectionsOfLineAndRectangleNodeOverPolylineLR(a,this.ObstacleCalculator.RootOfLooseHierarchy))if(y.seg1!=n){c=c.div(1.5),u=!0;break}if(!u)break}return a.end}static PointInsideOfConvexCurve(e){return e.value(0).add(e.value(1.5)).div(2)}*GetActivePolylines(){for(const e of this.activePolygons)yield e.Polyline}GetAddedPolygonesAndMaybeExtendActiveRectangle(){const e=this.activeRectangle,t=new Array;let n;do{n=!1;for(const r of this.ObstacleCalculator.RootOfLooseHierarchy.GetNodeItemsIntersectingRectangle(this.activeRectangle))this.alreadyAddedOrExcludedPolylines.has(r)||(e.addRec(r.boundingBox),t.push(new Mi(r)),this.alreadyAddedOrExcludedPolylines.add(r),n=!0);n&&(this.activeRectangle=e)}while(n);return t}RelaxPolyline(){let e=Tt.CreateRelaxedPolylinePoints(this._polyline);for(e=e.Next;null!=e.Next;e=e.Next)this.RelaxPolylinePoint(e)}static CreateRelaxedPolylinePoints(e){let t=e.startPoint;const n=new WI(t,t.point);let r=n;for(;null!=t.next;){t=t.next;const s=new WI(t,t.point);s.Prev=r,r.Next=s,r=s}return n}RelaxPolylinePoint(e){if(!(null==e.PolylinePoint.prev.prev&&this.SourcePort instanceof Li&&e.PolylinePoint.polyline!=this.SourceLoosePolyline||null==e.PolylinePoint.next.next&&this.TargetPort instanceof Li&&e.PolylinePoint.polyline!=this.TargetLoosePolyline))for(let t=this.OffsetForPolylineRelaxing;t>q.distanceEpsilon&&!this.RelaxWithGivenOffset(t,e);)t/=2}RelaxWithGivenOffset(e,t){return Tt.SetRelaxedPointLocation(e,t),!!this.StickingSegmentDoesNotIntersectTightObstacles(t)||(Tt.PullCloserRelaxedPoint(t.Prev),!1)}static PullCloserRelaxedPoint(e){e.PolylinePoint.point=e.OriginalPosition.mul(.2).add(e.PolylinePoint.point.mul(.8))}StickingSegmentDoesNotIntersectTightObstacles(e){return!(this.PolylineSegmentIntersectsTightHierarchy(e.PolylinePoint.point,e.Prev.PolylinePoint.point)||null!=e.Next&&this.PolylineSegmentIntersectsTightHierarchy(e.PolylinePoint.point,e.Next.PolylinePoint.point))}PolylineSegmentIntersectsTightHierarchy(e,t){return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchyPPR(e,t,this.ObstacleCalculator.RootOfTightHierarchy)}PolylineIntersectsPolyRectangleNodeOfTightHierarchyPPR(e,t,n){return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(me.mkPP(e,t),n)}PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t){if(!e.boundingBox.intersects(t.irect))return!1;if(null!=t.UserData){for(const n of te.getAllIntersections(e,t.UserData,!1))if(n.seg1!=this.SourceTightPolyline&&n.seg1!=this.TargetTightPolyline||(n.seg1==this.SourceTightPolyline&&this.SourcePort)instanceof Li||(n.seg1==this.TargetTightPolyline&&this.TargetPort)instanceof Li)return!0;return!1}return this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t.Left)||this.PolylineIntersectsPolyRectangleNodeOfTightHierarchy(e,t.Right)}static IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,t){const n=new Array;return Tt.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t,n),n}static IntersectionsOfLineAndRectangleNodeOverPolyline(e,t,n){if(null!=t&&e.boundingBox.intersects(t.irect)){if(null!=t.UserData)return void wa(n,te.getAllIntersections(e,t.UserData,!0));Tt.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t.Left,n),Tt.IntersectionsOfLineAndRectangleNodeOverPolyline(e,t.Right,n)}}LineCanBeAcceptedForRouting(e){const n=this.TargetPort instanceof Ss;if(!((this.SourcePort instanceof Ss||this.targetIsInsideOfSourceTightPolyline||this.InsideOfTheAllowedConeOfBoundaryPort(e.end,this.SourcePort))&&(n||null==this.TargetPort||this.sourceIsInsideOfTargetTightPolyline||this.InsideOfTheAllowedConeOfBoundaryPort(e.start,this.TargetPort))))return!1;const r=Tt.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy);for(const s of r)if(s.seg1!=this.SourceTightPolyline&&s.seg1!=this.targetTightPolyline)return!1;return!0}InsideOfTheAllowedConeOfBoundaryPort(e,t){const n=t.Curve,r=Tr.CurveIsClockwise(n,Tt.PointInsideOfConvexCurve(n)),s=t.Location,o=this.GetPointOnTheRightBoundaryPortConeSide(s,n,r,t.Parameter),a=this.GetPointOnTheLeftBoundaryPortConeSide(s,n,r,t.Parameter);return x.getTriangleOrientation(s,o,e)!=Ie.Clockwise&&x.getTriangleOrientation(s,e,a)!=Ie.Clockwise}GetPointOnTheRightBoundaryPortConeSide(e,t,n,r){const s=n?t.rightDerivative(r):t.leftDerivative(r).neg();return e.add(s.rotate(this.EnteringAngleBound))}GetPointOnTheLeftBoundaryPortConeSide(e,t,n,r){const s=n?t.leftDerivative(r).neg():t.rightDerivative(r);return e.add(s.rotate(-this.EnteringAngleBound))}static SetRelaxedPointLocation(e,t){const n=x.getTriangleOrientation(t.Next.OriginalPosition,t.OriginalPosition,t.Prev.OriginalPosition)==Ie.Counterclockwise;let r=t.Next.OriginalPosition.sub(t.Prev.OriginalPosition).normalize().mul(e).rotate(Math.PI/2);n||(r=r.neg()),t.PolylinePoint.point=t.OriginalPosition.add(r)}SmoothCorners(e){let t=e.headSite,n={b:null,c:null};for(;n=te.findCorner(t);)t=this.SmoothOneCorner(t,n.c,n.b)}SmoothOneCorner(e,t,n){let a,l,c,o=.5;null==e.prev?(c=2,l=1):null==t.next?(c=1,l=2):l=1,c=1;do{a=te.createBezierSeg(o*c,o*l,e,n,t),n.previouisBezierCoefficient=o*c,n.nextBezierCoefficient=o*l,o/=1.5}while(this.ObstacleCalculator.ObstaclesIntersectICurve(a)&&o>.01);return o*=1.5,o<.5&&o>.01&&(o=.5*(o+1.5*o),a=te.createBezierSeg(o*c,o*l,e,n,t),this.ObstacleCalculator.ObstaclesIntersectICurve(a)||(n.previouisBezierCoefficient=o*c,n.nextBezierCoefficient=o*l)),n}TryToRemoveInflectionsAndCollinearSegments(e){let t=!0;const n={s:null};for(;t;)for(t=!1,n.s=e.headSite;null!=n.s&&null!=n.s.next;n.s=n.s.next)n.s.turn*n.s.next.turn<0&&(t=this.TryToRemoveInflectionEdge(n)||t)}TryToRemoveInflectionEdge(e){if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.prev.point,e.s.next.point)){const t=e.s.prev,n=e.s.next;return t.next=n,n.prev=t,e.s=t,!0}if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.prev.point,e.s.next.next.point)){const t=e.s.prev,n=e.s.next.next;return t.next=n,n.prev=t,e.s=t,!0}if(!this.ObstacleCalculator.ObstaclesIntersectLine(e.s.point,e.s.next.next.point)){const t=e.s.next.next;return e.s.next=t,t.prev=e.s,!0}return!1}GetShortestPolyline(e,t){this.CleanTheGraphForShortestPath();const r=new Bf(this.visibilityGraph,e,t).GetPath(this.UseEdgeLengthMultiplier);if(null==r)return null;const s=new He;for(const o of r)s.addPoint(o.point);return Tt.RemoveCollinearVertices(s)}CleanTheGraphForShortestPath(){this.visibilityGraph.ClearPrevEdgesTable()}static RemoveCollinearVertices(e){for(let t=e.startPoint.next;null!=t.next;t=t.next)x.getTriangleOrientation(t.prev.point,t.point,t.next.point)==Ie.Collinear&&(t.prev.next=t.next,t.next.prev=t.prev);return e}get OverlapsDetected(){return this.ObstacleCalculator.OverlapsDetected}get TightHierarchy(){return this.ObstacleCalculator.RootOfTightHierarchy}set TightHierarchy(e){this.ObstacleCalculator.RootOfTightHierarchy=e}get LooseHierarchy(){return this.ObstacleCalculator.RootOfLooseHierarchy}set LooseHierarchy(e){this.ObstacleCalculator.RootOfLooseHierarchy=e}CalculateObstacles(){this.ObstacleCalculator=new Tr(this.Obstacles,this.TightPadding,this.LoosePadding,this.IgnoreTightPadding),this.ObstacleCalculator.Calculate()}RouteEdgeToLocation(e){this.TargetPort=new Ss(null,e),this.TargetTightPolyline=null,this.TargetLoosePolyline=null;const t=new Do(null);let n=me.mkPP(this.SourcePort.Location,e);return this.LineCanBeAcceptedForRouting(n)?(this._polyline=new He,this._polyline.addPoint(n.start),this._polyline.addPoint(n.end),t.smoothedPolyline=Nn.mkFromPoints(this._polyline),t.curve=t.smoothedPolyline.createCurve(),t):this.SourcePort instanceof Li&&(n=me.mkPP(this.StartPointOfEdgeRouting,e),0==Tt.IntersectionsOfLineAndRectangleNodeOverPolylineLR(n,this.ObstacleCalculator.RootOfTightHierarchy).length)?(this._polyline=new He,this._polyline.addPoint(this.SourcePort.Location),this._polyline.addPoint(n.start),this._polyline.addPoint(n.end),t.smoothedPolyline=Nn.mkFromPoints(this._polyline),t.curve=t.smoothedPolyline.createCurve(),t):(this.ExtendVisibilityGraphToLocation(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),this.RelaxPolyline(),this.SourcePort instanceof Li&&this._polyline.PrependPoint(this.SourcePort.Location),t.smoothedPolyline=Nn.mkFromPoints(this._polyline),t.curve=t.smoothedPolyline.createCurve(),t)}RouteEdgeToPort(e,t,n,r){return this.ObstacleCalculator.IsEmpty()?null!=this.sourcePort&&null!=this.targetPort?(r.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(this.sourcePort.Location,this.targetPort.Location),me.mkPP(this.sourcePort.Location,this.targetPort.Location)):null:(this.TargetPort=e,this.TargetTightPolyline=Tt.GetFirstHitPolyline(e.Location,this.ObstacleCalculator.RootOfTightHierarchy),e instanceof Li?this.RouteEdgeToBoundaryPort(t,n,r):this.RouteEdgeToFloatingPortOfNode(t,n,r))}SmoothedPolylineFromTwoPoints(e,t){return this._polyline=new He,this._polyline.addPoint(e),this._polyline.addPoint(t),Nn.mkFromPoints(this._polyline)}RouteEdgeToFloatingPortOfNode(e,t,n){return this.sourcePort instanceof Ss?this.RouteFromFloatingPortToFloatingPort(e,t,n):this.RouteFromBoundaryPortToFloatingPort(e,t,n)}RouteFromBoundaryPortToFloatingPort(e,t,n){const r=this.SourcePort.Location,s=this.targetPort.Location;let o=me.mkPP(r,s);if(this.LineCanBeAcceptedForRouting(o))return n.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(o.start,o.end),o;if(!this.targetIsInsideOfSourceTightPolyline){const l=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.SourcePort.Curve,this.SourcePort.Parameter,this.SourceLoosePolyline);if(o=me.mkPP(l,s),this.LineAvoidsTightHierarchyLP(o,e))return n.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(o.start,o.end),o}this.ExtendVisibilityGraphToLocationOfTargetFloatingPort(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV);const a=this.SourceTightPolyline;return this.targetIsInsideOfSourceTightPolyline||(this.SourceTightPolyline=null),this.TryShortcutPolyline(),this.SourceTightPolyline=a,this.RelaxPolyline(),this._polyline.PrependPoint(r),this.SmoothCornersAndReturnCurve(t,n)}SmoothCornersAndReturnCurve(e,t){return t.smoothedPolyline=Nn.mkFromPoints(this._polyline),e&&this.SmoothCorners(t.smoothedPolyline),t.smoothedPolyline.createCurve()}RouteFromFloatingPortToFloatingPort(e,t,n){const s=me.mkPP(this.StartPointOfEdgeRouting,this.TargetPort.Location);return this.AllowedShootingStraightLines&&this.LineAvoidsTightHierarchyLPP(s,this.SourceTightPolyline,this.targetTightPolyline)?(n.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(s.start,s.end),s):(this.ExtendVisibilityGraphToLocationOfTargetFloatingPort(e),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),null==this._polyline?null:(this.UseSpanner&&this.TryShortcutPolyline(),this.RelaxPolyline(),n.smoothedPolyline=Nn.mkFromPoints(this._polyline),this.SmoothCornersAndReturnCurve(t,n)))}TryShortcutPolyline(){if(this.UseInnerPolylingShortcutting)for(;this.ShortcutPolylineOneTime(););this.UsePolylineEndShortcutting&&this.TryShortCutThePolylineEnds()}TryShortCutThePolylineEnds(){this.TryShortcutPolylineStart(),this.TryShortcutPolylineEnd()}TryShortcutPolylineEnd(){const e=this._polyline.endPoint,t=e.prev;if(null==t)return;const n=t.prev;if(null==n)return;const r=x.middle(t.point,n.point);if(this.LineAvoidsTightHierarchyPPPP(e.point,r,this._sourceTightPolyline,this.targetTightPolyline)){const s=$i.mkFromPoint(r);s.next=e,s.prev=n,e.prev=s,n.next=s}}TryShortcutPolylineStart(){const e=this._polyline.startPoint,t=e.next;if(null==t)return;const n=t.next;if(null==n)return;const r=x.middle(t.point,n.point);if(this.LineAvoidsTightHierarchyPPPP(e.point,r,this._sourceTightPolyline,this.targetTightPolyline)){const s=$i.mkFromPoint(r);s.prev=e,s.next=n,e.next=s,n.prev=s}}ShortcutPolylineOneTime(){let e=!1;for(let t=this._polyline.startPoint;null!=t.next&&null!=t.next.next;t=t.next)e=e||this.TryShortcutPolyPoint(t);return e}TryShortcutPolyPoint(e){return!!this.LineAvoidsTightHierarchyLPP(me.mkPP(e.point,e.next.next.point),this.SourceTightPolyline,this.targetTightPolyline)&&(e.next=e.next.next,e.next.prev=e,!0)}ExtendVisibilityGraphToLocationOfTargetFloatingPort(e){null==this.VisibilityGraph&&(this.VisibilityGraph=new gn);let t=null;const n=this.targetPort.Location;if(!this.activeRectangle.contains(n)){this.activeRectangle.isEmpty?this.activeRectangle=De.mkPP(this.SourcePort.Location,n):this.activeRectangle.add(n),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle();for(const r of t)this.VisibilityGraph.AddHole(r.Polyline)}null==t?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraphForFloatingPort(n,e),null==this.sourceVV&&this.CalculateSourcePortVisibilityGraph()):(this.RemovePointVisibilityGraphs(),new Go(t,this.activePolygons,this.VisibilityGraph).run(),wa(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraphForFloatingPort(n,e),this.CalculateSourcePortVisibilityGraph())}CalculateEdgeTargetVisibilityGraphForFloatingPort(e,t){this.targetVV=this.UseSpanner?this.AddTransientVisibilityEdgesForPort(e,t):no.CalculatePointVisibilityGraph(this.GetActivePolylinesWithException(t),this.VisibilityGraph,e,Cs.Tangent)}AddTransientVisibilityEdgesForPort(e,t){let n=this.GetVertex(e);if(null!=n)return n;if(n=this.visibilityGraph.AddVertexP(e),null!=t)for(const r of t)this.visibilityGraph.AddEdgeF(e,r,(s,o)=>new As(s,o));else n=no.CalculatePointVisibilityGraph(this.GetActivePolylines(),this.VisibilityGraph,e,Cs.Tangent);return n}GetVertex(e){let t=this.visibilityGraph.FindVertex(e);return null==t&&this.LookForRoundedVertices&&(t=this.visibilityGraph.FindVertex(q.RoundPoint(e))),t}*GetActivePolylinesWithException(e){for(const t of this.activePolygons)t.Polyline!=e&&(yield t.Polyline)}RouteEdgeToBoundaryPort(e,t,n){return this.TargetLoosePolyline=e,this.sourcePort instanceof Ss?this.RouteFromFloatingPortToBoundaryPort(t,n):this.RouteFromBoundaryPortToBoundaryPort(t,n)}RouteFromBoundaryPortToBoundaryPort(e,t){const n=this.SourcePort.Location;let r;const s=this.targetPort.Location;let o=me.mkPP(n,s);if(this.LineCanBeAcceptedForRouting(o))this._polyline=new He,this._polyline.addPoint(o.start),this._polyline.addPoint(o.end),t.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(o.start,o.end),r=Nn.mkFromPoints(this._polyline).createCurve();else{const a=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.targetPort.Curve,this.targetPort.Parameter,this.TargetLoosePolyline);if(o=me.mkPP(n,a),this.InsideOfTheAllowedConeOfBoundaryPort(a,this.SourcePort)&&this.LineAvoidsTightHierarchyLP(o,this._sourceTightPolyline))this._polyline=new He,this._polyline.addPoint(o.start),this._polyline.addPoint(o.end),this._polyline.addPoint(s),r=this.SmoothCornersAndReturnCurve(e,t);else if(o=me.mkPP(this.StartPointOfEdgeRouting,s),this.InsideOfTheAllowedConeOfBoundaryPort(this.StartPointOfEdgeRouting,this.TargetPort)&&this.LineAvoidsTightHierarchy(o))this._polyline=new He,this._polyline.addPoint(n),this._polyline.addPoint(o.start),this._polyline.addPoint(o.end),r=this.SmoothCornersAndReturnCurve(e,t);else{let l;if(l=me.IntersectPPPP(n,this.StartPointOfEdgeRouting,s,a))this._polyline=new He,this._polyline.addPoint(n),this._polyline.addPoint(l),this._polyline.addPoint(s),r=this.SmoothCornersAndReturnCurve(e,t);else if(x.closeDistEps(this.StartPointOfEdgeRouting,a))this._polyline=new He,this._polyline.addPoint(n),this._polyline.addPoint(a),this._polyline.addPoint(s),r=this.SmoothCornersAndReturnCurve(e,t);else if(this.LineAvoidsTightHierarchy(me.mkPP(this.StartPointOfEdgeRouting,a)))this._polyline=new He,this._polyline.addPoint(n),this._polyline.addPoint(this.StartPointOfEdgeRouting),this._polyline.addPoint(a),this._polyline.addPoint(s),r=this.SmoothCornersAndReturnCurve(e,t);else{this.ExtendVisibilityGraphToTargetBoundaryPort(a),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV);const c={tmpTargetTight:null},u=this.HideSourceTargetTightsIfNeeded(c);this.TryShortcutPolyline(),this.RecoverSourceTargetTights(u,c.tmpTargetTight),this.RelaxPolyline(),this._polyline.PrependPoint(n),this._polyline.addPoint(s),r=this.SmoothCornersAndReturnCurve(e,t)}}}return r}RecoverSourceTargetTights(e,t){this.SourceTightPolyline=e,this.TargetTightPolyline=t}HideSourceTargetTightsIfNeeded(e){const t=this.SourceTightPolyline;return e.tmpTargetTight=this.TargetTightPolyline,this.TargetTightPolyline=null,this.SourceTightPolyline=null,t}LineAvoidsTightHierarchy(e){return 0==Tt.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy).length}RouteFromFloatingPortToBoundaryPort(e,t){const n=this.targetPort.Location;let r;if(this.InsideOfTheAllowedConeOfBoundaryPort(this.sourcePort.Location,this.targetPort)&&(r=me.mkPP(this.SourcePort.Location,n),this.LineCanBeAcceptedForRouting(r)))return t.smoothedPolyline=this.SmoothedPolylineFromTwoPoints(r.start,r.end),r;const s=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.TargetPort.Curve,this.TargetPort.Parameter,this.TargetLoosePolyline);return r=me.mkPP(this.SourcePort.Location,s),this.LineAvoidsTightHierarchyLP(r,this._sourceTightPolyline)?(this._polyline=He.mkFromPoints([r.start,r.end,n]),t.smoothedPolyline=Nn.mkFromPoints(this._polyline),t.smoothedPolyline.createCurve()):(this.ExtendVisibilityGraphToTargetBoundaryPort(s),this._polyline=this.GetShortestPolyline(this.sourceVV,this.targetVV),this.RelaxPolyline(),this._polyline.addPoint(n),this.SmoothCornersAndReturnCurve(e,{smoothedPolyline:null}))}LineAvoidsTightHierarchyLP(e,t){let n=!0;for(const r of Tt.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy))if(r.seg1!=t){n=!1;break}return n}LineAvoidsTightHierarchyLPP(e,t,n){let r=!0;for(const s of Tt.IntersectionsOfLineAndRectangleNodeOverPolylineLR(e,this.ObstacleCalculator.RootOfTightHierarchy))if(s.seg1!=t&&s.seg1!=n){r=!1;break}return r}LineAvoidsTightHierarchyPPPP(e,t,n,r){return this.LineAvoidsTightHierarchyLPP(me.mkPP(e,t),n,r)}ExtendVisibilityGraphToTargetBoundaryPort(e){let t=null;if(null==this.VisibilityGraph&&(this.VisibilityGraph=new gn),!this.activeRectangle.contains(e)||!this.activeRectangle.containsRect(this.TargetLoosePolyline.boundingBox)){this.activeRectangle.isEmpty?(this.activeRectangle=this.TargetLoosePolyline.boundingBox.clone(),this.activeRectangle.add(this.SourcePort.Location),this.activeRectangle.add(this.StartPointOfEdgeRouting),this.activeRectangle.add(e)):(this.activeRectangle.add(e),this.activeRectangle.addRec(this.TargetLoosePolyline.boundingBox)),t=this.GetAddedPolygonesAndMaybeExtendActiveRectangle();for(const n of t)this.VisibilityGraph.AddHole(n.Polyline)}null==t?(null!=this.targetVV&&this.VisibilityGraph.RemoveVertex(this.targetVV),this.CalculateEdgeTargetVisibilityGraph(e)):(this.RemovePointVisibilityGraphs(),new Go(t,this.activePolygons,this.VisibilityGraph).run(),wa(this.activePolygons,t),this.CalculateEdgeTargetVisibilityGraph(e),this.CalculateSourcePortVisibilityGraph())}GetHitLoosePolyline(e){return this.ObstacleCalculator.IsEmpty()||null==this.ObstacleCalculator.RootOfLooseHierarchy?null:Tt.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy)}static GetFirstHitPolyline(e,t){const n=Tt.GetFirstHitRectangleNode(e,t);return n?n.UserData:null}static GetFirstHitRectangleNode(e,t){return null==t?null:t.FirstHitNodePF(e,(n,r)=>te.PointRelativeToCurveLocation(n,r)!=We.Outside?Gt.Stop:Gt.Continue)}Clean(){this.TargetPort=null,this.SourcePort=null,this.SourceTightPolyline=null,this.SourceLoosePolyline=null,this.TargetLoosePolyline=null,this.targetTightPolyline=null,this.VisibilityGraph=null,this.targetVV=null,this.sourceVV=null,this.activePolygons=[],this.alreadyAddedOrExcludedPolylines.clear(),this.activeRectangle.setToEmpty()}SetSourcePortAndSourceLoosePolyline(e,t){this.SourceLoosePolyline=t,this.sourcePort=e,null!=this.sourcePort&&(this.SourceTightPolyline=Tt.GetFirstHitPolyline(this.sourcePort.Location,this.ObstacleCalculator.RootOfTightHierarchy),this.sourcePort instanceof Ss?(this.alreadyAddedOrExcludedPolylines.add(this.SourceLoosePolyline),this.StartPointOfEdgeRouting=this.SourcePort.Location):this.StartPointOfEdgeRouting=this.TakeBoundaryPortOutsideOfItsLoosePolyline(this.SourcePort.Curve,this.sourcePort.Parameter,this.SourceLoosePolyline))}run(){this.CalculateWholeTangentVisibilityGraph()}CalculateWholeTangentVisibilityGraph(){this.VisibilityGraph=new gn,this.CalculateWholeVisibilityGraphOnExistingGraph()}CalculateWholeVisibilityGraphOnExistingGraph(){this.activePolygons=Array.from(this.AllPolygons());for(const t of this.ObstacleCalculator.LooseObstacles)this.VisibilityGraph.AddHole(t);let e;e=this.UseSpanner?new Wu(this.ObstacleCalculator.LooseObstacles,this.VisibilityGraph):new Go(new Array,this.activePolygons,this.visibilityGraph),e.run()}RouteSplineFromPortToPortWhenTheWholeGraphIsReady(e,t,n,r){const s=e instanceof Ss&&t instanceof Li||e instanceof ui;if(s){const a=e;e=t,t=a}this.sourcePort=e,this.targetPort=t,this.FigureOutSourceTargetPolylinesAndActiveRectangle();let o=this.GetEdgeGeomByRouting(n,r);return null==o?null:(this.targetVV=null,this.sourceVV=null,s&&(o=o.reverse()),o)}GetEdgeGeomByRouting(e,t){let n;if(this.sourceIsInsideOfTargetTightPolyline=null==this.TargetTightPolyline||te.PointRelativeToCurveLocation(this.sourcePort.Location,this.TargetTightPolyline)==We.Inside,this.sourcePort instanceof Li){const r=this.sourcePort;this.StartPointOfEdgeRouting=this.targetIsInsideOfSourceTightPolyline?r.Location:this.TakeBoundaryPortOutsideOfItsLoosePolyline(r.Curve,r.Parameter,this.SourceLoosePolyline),this.CalculateSourcePortVisibilityGraph();const s={smoothedPolyline:null};n=this.targetPort instanceof Li?this.RouteFromBoundaryPortToBoundaryPort(e,s):this.RouteFromBoundaryPortToFloatingPort(this.targetLoosePolyline,e,s)}else this.targetPort instanceof Ss?(this.ExtendVisibilityGraphFromFloatingSourcePort(),n=this.RouteFromFloatingPortToFloatingPort(this.targetLoosePolyline,e,t)):(Sf.assert(this.targetPort instanceof ui),n=this.RouteFromFloatingPortToAnywherePort(this.targetPort.LoosePolyline,e,t,this.targetPort));return n}RouteFromFloatingPortToAnywherePort(e,t,n,r){return r.Curve.boundingBox.contains(this.sourcePort.Location)?(this.sourceVV=this.GetVertex(this.sourcePort.Location),this._polyline=this.GetShortestPolylineToMulitpleTargets(this.sourceVV,Array.from(this.Targets(e))),null==this._polyline?null:(this.UseSpanner&&this.TryShortcutPolyline(),this.RelaxPolyline(),this.FixLastPolylinePointForAnywherePort(r),r.HookSize>0&&this.BuildHook(r),this.SmoothCornersAndReturnCurve(t,n))):(n.smoothedPolyline=null,null)}BuildHook(e){const t=e.Curve,n=Rt.mkFullEllipseNNP(e.HookSize,e.HookSize,this._polyline.end),r=te.getAllIntersections(t,n,!0);x.getTriangleOrientation(r[0].x,this._polyline.end,this._polyline.endPoint.prev.point)==Ie.Counterclockwise&&r.reverse();const s=this._polyline.end.sub(this._polyline.endPoint.prev.point).normalize(),o=t.derivative(r[0].par0).normalize(),a=o.dot(s);if(Math.abs(a)<.2)this.ExtendPolyline(o,r[0],s,e);else{const l=t.derivative(r[1].par0).normalize();l.dot(s)<a?this.ExtendPolyline(l,r[1],s,e):this.ExtendPolyline(o,r[0],s,e)}}ExtendPolyline(e,t,n,r){let s=e.rotate(Math.PI/2);s.dot(n)<0&&(s=s.neg());const o=t.x.add(s.mul(r.HookSize));let a;!(a=x.lineLineIntersection(o,o.add(e),this._polyline.end,this._polyline.end.add(n)))||(this._polyline.addPoint(a),this._polyline.addPoint(o),this._polyline.addPoint(t.x))}FixLastPolylinePointForAnywherePort(e){for(;;){const t=this.GetLastPointInsideOfCurveOnPolyline(e.Curve);t.next.next=null,this._polyline.endPoint=t.next;let n=t.next.point.sub(t.point);n=n.normalize().mul(e.Curve.boundingBox.diagonal);const r=n.rotate(-1*e.AdjustmentAngle),s=n.rotate(e.AdjustmentAngle),o=te.intersectionOne(e.Curve,me.mkPP(t.point,t.point.add(r)),!0),a=te.intersectionOne(e.Curve,me.mkPP(t.point,t.point.add(s)),!0);if(null==o||null==a)return;const l=Tt.GetTrimmedCurveForHookingUpAnywhere(e.Curve,t,o,a),c=l.value(l.closestParameter(t.point));if(!this.LineAvoidsTightHierarchyLPP(me.mkPP(t.point,c),this.SourceTightPolyline,null)){const u=te.intersectionOne(e.Curve,me.mkPP(t.point,t.next.point),!1);if(null==u)return;this._polyline.endPoint.point=u.x;break}if(this._polyline.endPoint.point=c,null==t.prev||!this.TryShortcutPolyPoint(t.prev))break}}static GetTrimmedCurveForHookingUpAnywhere(e,t,n,r){const s=x.getTriangleOrientation(r.x,n.x,t.point)==Ie.Clockwise,o=n.par0,a=r.par0;let l,c,u;return s?o<a?e.trim(o,a):(c=e.trim(o,e.parEnd),l=e.trim(e.parStart,a),u=new te,u.addSegs([c,l])):a<o?e.trim(a,o):(c=e.trim(a,e.parEnd),l=e.trim(e.parStart,o),u=new te,u.addSegs([c,l]))}GetLastPointInsideOfCurveOnPolyline(e){for(let t=this._polyline.endPoint.prev;null!=t;t=t.prev)if(null==t.prev||te.PointRelativeToCurveLocation(t.point,e)==We.Inside)return t;throw new Error}GetShortestPolylineToMulitpleTargets(e,t){this.CleanTheGraphForShortestPath();const r=new ju(e,t,this.VisibilityGraph).GetPath();if(null==r)return null;const s=new He;for(const o of r)s.addPoint(o.point);return Tt.RemoveCollinearVertices(s)}Targets(e){return Array.from(e).map(t=>this.visibilityGraph.FindVertex(t))}ExtendVisibilityGraphFromFloatingSourcePort(){this.StartPointOfEdgeRouting=this.sourcePort.Location,this.sourceVV=this.UseSpanner?this.AddTransientVisibilityEdgesForPort(this.sourcePort.Location,this.SourceLoosePolyline):no.CalculatePointVisibilityGraph(Array.from(this.GetActivePolylines()).filter(t=>t!=this.SourceLoosePolyline),this.VisibilityGraph,this.StartPointOfEdgeRouting,Cs.Tangent)}FigureOutSourceTargetPolylinesAndActiveRectangle(){let e=this.sourcePort.Curve.value(this.sourcePort.Curve.parStart);this._sourceTightPolyline=Tt.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfTightHierarchy),this.SourceLoosePolyline=Tt.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy),e=this.targetPort.Curve.value(this.targetPort.Curve.parStart),this.targetTightPolyline=Tt.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfTightHierarchy),this.targetLoosePolyline=Tt.GetFirstHitPolyline(e,this.ObstacleCalculator.RootOfLooseHierarchy),this.activeRectangle=De.mkPP(new x(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),new x(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY))}*AllPolygons(){for(const e of this.ObstacleCalculator.LooseObstacles)yield new Mi(e)}GetVisibilityGraph(){return this.VisibilityGraph}AddActivePolygons(e){wa(this.activePolygons,e)}ClearActivePolygons(){this.activePolygons=[]}}class Ku{constructor(){this.size_=0,this.mapOfMaps=new Di}clear(){this.mapOfMaps.clear(),this.size_=0}get size(){return this.size_}set(e,t){const n=e.first,r=e.second;let s=this.mapOfMaps.get(n);null==s&&this.mapOfMaps.set(n,s=new Di),s.has(r)||this.size_++,s.set(r,t)}delete(e){const n=e.second,r=this.mapOfMaps.get(e.first);null!=r&&r.deleteP(n)&&this.size_--}has(e){const t=this.mapOfMaps.get(e.first);return null!=t&&t.has(e.second)}get_(e,t){return this.get(new ai(e,t))}get(e){const t=this.mapOfMaps.get(e.first);if(null!=t)return t.get(e.second)}*keys(){for(const e of this.mapOfMaps)for(const t of e[1])yield new ai(e[0],t[0])}*[Symbol.iterator](){for(const[e,t]of this.mapOfMaps)for(const[n,r]of t)yield[new ai(e,n),r]}*values(){for(const e of this.mapOfMaps)for(const t of e[1])yield t[1]}}class er{static GetShapes(e,t=Array.from(e.edges())){const n=new Map;jI(e,n);for(const r of t){let s=n.get(r.source);s&&null!=r.sourcePort&&s.Ports.add(r.sourcePort),s=n.get(r.target),s&&null!=r.targetPort&&s.Ports.add(r.targetPort)}return Array.from(n.values())}static CreateShapeWithCenterPort(e){const t=new jE(()=>e.boundaryCurve),n=Fo.mk(()=>e.boundaryCurve,()=>e.center);t.Ports.add(n);for(const r of e.inEdges())er.FixPortAtTarget(n,r);for(const r of e.outEdges())er.FixPortAtSource(n,r);for(const r of e.selfEdges())er.FixPortAtSource(n,r),er.FixPortAtTarget(n,r);return t}static CreateShapeWithClusterBoundaryPort(e){Sf.assert(e instanceof Jr);const t=new jE(()=>e.boundaryCurve),n=Cr.mk(()=>e.boundaryCurve,()=>e.center);let r;t.Ports.add(n);for(const s of e.inEdges())s.EdgeToAncestor()==Po.ToAncestor?(null==r&&(r=new ui(()=>e.boundaryCurve)),s.targetPort=r):er.FixPortAtTarget(n,s);for(const s of e.outEdges())s.EdgeToAncestor()==Po.FromAncestor?(null==r&&(r=new ui(()=>e.boundaryCurve)),s.sourcePort=r):er.FixPortAtSource(n,s);for(const s of e.selfEdges())er.FixPortAtSource(n,s),er.FixPortAtTarget(n,s);return t}static FixPortAtSource(e,t){null==t.sourcePort&&(t.sourcePort=e)}static FixPortAtTarget(e,t){null==t.targetPort&&(t.targetPort=e)}}function jI(i,e){for(const t of i.shallowNodes())if(t instanceof Jr){const n=er.CreateShapeWithClusterBoundaryPort(t);e.set(t,n);const r=t;if(!r.graph.isCollapsed){jI(r,e);for(const s of r.shallowNodes())n.AddChild(e.get(s))}}else e.set(t,er.CreateShapeWithCenterPort(t))}class $u{constructor(e){this.Right=e,this.Left=e}SetActiveState(e,t){this.IsActive=e,this.VectorIndex=t,this.IsActive?(this.Left.ActiveConstraintCount++,this.Right.ActiveConstraintCount++):(this.Left.ActiveConstraintCount--,this.Right.ActiveConstraintCount--)}SetVectorIndex(e){this.VectorIndex=e}Reinitialize(){this.IsActive=!1,this.IsUnsatisfiable=!1,this.ClearDfDv()}UpdateGap(e){this.Gap=e}static constructorVVNB(e,t,n,r){const s=new $u(e);return s.Left=e,s.Right=t,s.Gap=n,s.IsEquality=r,s.Lagrangian=0,s.IsActive=!1,s}ToString(){return Hn.String.Format("  Cst: [{0}] [{1}] {2} {3:F5} vio {4:F5} Lm {5:F5}/{6:F5} {7}actv",this.Left,this.Right,this.IsEquality?"==":">=",this.Gap,this.Violation,this.Lagrangian,2*this.Lagrangian,this.IsActive?"+":this.IsUnsatisfiable?"!":"-")}get Violation(){return this.Left.ActualPos*this.Left.Scale+(this.Gap-this.Right.ActualPos*this.Right.Scale)}ClearDfDv(){this.Lagrangian=0}CompareTo(e){let t=this.Left.CompareTo(e.Left);return 0==t&&(t=this.Right.CompareTo(e.Right)),0==t&&(t=Vt(this.Gap,e.Gap)),t}}class Ju{constructor(e){this.ConstraintToEval=e,this.Depth=-1}static constructorDCVV(e,t,n,r){const s=new Ju(t);return s.Set(e,t,n,r),s}Set(e,t,n,r){return this.Parent=e,this.ConstraintToEval=t,this.VariableToEval=n,this.VariableDoneEval=r,this.Depth=0,this.ChildrenHaveBeenPushed=!1,t.Lagrangian=0,this}get IsLeftToRight(){return this.VariableToEval==this.ConstraintToEval.Right}toString(){return Hn.String.Format("{0} {1}{2} - {3}{4} ({5})","",this.IsLeftToRight?"":"*",this.ConstraintToEval.Left.Name,this.IsLeftToRight?"*":"",this.ConstraintToEval.Right.Name,this.Depth)}}class lU{constructor(e,t){this.Constraint=e,this.IsForward=t}}class kf{constructor(e,t){this.Variables=new Array,null!=e&&this.AddVariable(e),this.allConstraints=t}toString(){return Hn.String.Format("[Block: nvars = {0} refpos = {1:F5} scale = {2:F5}]",this.Variables.length,this.ReferencePos,this.Scale)}ComputeDfDv(e){this.allConstraints.DfDvStack=new Jt.K;const t=new $u(e);this.dfDvDummyParentNode=new Ju(t);const n=this.GetDfDvNode(this.dfDvDummyParentNode,t,e,null);for(this.allConstraints.DfDvStack.push(n);;){const r=this.allConstraints.DfDvStack.top,s=this.allConstraints.DfDvStack.length;if(!r.ChildrenHaveBeenPushed){r.ChildrenHaveBeenPushed=!0;for(const o of r.VariableToEval.LeftConstraints)if(o.IsActive&&o.Right!=r.VariableDoneEval){const a=this.GetDfDvNode(r,o,o.Right,r.VariableToEval);1==o.Right.ActiveConstraintCount?this.ProcessDfDvLeafNodeDirectly(a):this.PushDfDvNode(a)}for(const o of r.VariableToEval.RightConstraints)if(o.IsActive&&o.Left!=r.VariableDoneEval){const a=this.GetDfDvNode(r,o,o.Left,r.VariableToEval);1==o.Left.ActiveConstraintCount?this.ProcessDfDvLeafNodeDirectly(a):this.PushDfDvNode(a)}if(this.allConstraints.DfDvStack.length>s)continue}if(this.allConstraints.DfDvStack.pop(),this.ProcessDfDvLeafNode(r),r==n)break}}ProcessDfDvLeafNode(e){const t=e.VariableToEval.DfDv;e.IsLeftToRight?(e.ConstraintToEval.Lagrangian=e.ConstraintToEval.Lagrangian+t,e.Parent.ConstraintToEval.Lagrangian=e.Parent.ConstraintToEval.Lagrangian+e.ConstraintToEval.Lagrangian):(e.ConstraintToEval.Lagrangian=-1*(e.ConstraintToEval.Lagrangian+t),e.Parent.ConstraintToEval.Lagrangian=e.Parent.ConstraintToEval.Lagrangian-e.ConstraintToEval.Lagrangian),this.CheckForConstraintPathTarget(e),this.Debug_CheckForViolatedActiveConstraint(e.ConstraintToEval),this.allConstraints.RecycleDfDvNode(e)}Debug_CheckForViolatedActiveConstraint(e){}ProcessDfDvLeafNodeDirectly(e){this.ProcessDfDvLeafNode(e)}GetDfDvNode(e,t,n,r){const s=this.allConstraints.DfDvRecycleStack.size>0?this.allConstraints.DfDvRecycleStack.pop().Set(e,t,n,r):Ju.constructorDCVV(e,t,n,r);return s.Depth=s.Parent.Depth+1,this.allConstraints.MaxConstraintTreeDepth<s.Depth&&(this.allConstraints.MaxConstraintTreeDepth=s.Depth),s}PushDfDvNode(e){this.PushOnDfDvStack(e)}AddVariableAndPushDfDvNode(e,t){e.push(t.VariableToEval),this.PushOnDfDvStack(t)}PushOnDfDvStack(e){this.allConstraints.DfDvStack.push(e)}CheckForConstraintPathTarget(e){if(this.pathTargetVariable==e.VariableToEval){for(;e.Parent!=this.dfDvDummyParentNode;)this.constraintPath.push(new lU(e.ConstraintToEval,e.IsLeftToRight)),e=e.Parent;this.pathTargetVariable=null}}Expand(e){null==this.constraintPath&&(this.constraintPath=new Array),this.constraintPath=[],this.pathTargetVariable=e.Right,this.ComputeDfDv(e.Left);let t=null;if(this.constraintPath.length>0){for(const o of this.constraintPath)o.IsForward&&(null==t||o.Constraint.Lagrangian<t.Lagrangian)&&(o.Constraint.IsEquality||(t=o.Constraint));null!=t&&this.allConstraints.DeactivateConstraint(t)}if(this.constraintPath=[],this.pathTargetVariable=null,null==t)return e.IsUnsatisfiable=!0,void this.allConstraints.NumberOfUnsatisfiableConstraints++;const n=new Array;this.GetConnectedVariables(n,e.Right,e.Left);const r=e.Violation,s=n.length;for(let o=0;o<s;o++)n[o].OffsetInBlock=n[o].OffsetInBlock+r;this.allConstraints.ActivateConstraint(e),e.ClearDfDv(),this.UpdateReferencePos()}Split(e){if(e&&this.UpdateReferencePos(),this.Variables.length<2)return null;let t=null;this.ComputeDfDv(this.Variables[0]);let n=this.allConstraints.SolverParameters.Advanced.MinSplitLagrangianThreshold;const r=this.Variables.length;for(let s=0;s<r;s++)for(const o of this.Variables[s].LeftConstraints)o.IsActive&&!o.IsEquality&&o.Lagrangian<n&&(t=o,n=o.Lagrangian);return null==t?null:this.SplitOnConstraint(t)}SplitOnConstraint(e){this.allConstraints.DeactivateConstraint(e);let t=new kf(null,this.allConstraints);return this.TransferConnectedVariables(t,e.Right,e.Left),t.Variables.length>0?(this.UpdateReferencePos(),t.UpdateReferencePos()):t=null,t}AddVariable(e){this.Variables.push(e),e.Block=this,1==this.Variables.length?(this.Scale=e.Scale,this.ReferencePos=e.ActualPos,this.sumAd=e.ActualPos*e.Weight,this.sumAb=0,this.sumA2=e.Weight,e.OffsetInBlock=0):this.AddVariableToBlockSums(e)}UpdateReferencePos(){this.Scale=this.Variables[0].Scale,this.sumAd=0,this.sumAb=0,this.sumA2=0;const e=this.Variables.length;for(let t=0;t<e;t++)this.AddVariableToBlockSums(this.Variables[t]);this.UpdateReferencePosFromSums()}AddVariableToBlockSums(e){const t=this.Scale/e.Scale,n=e.OffsetInBlock/e.Scale,r=t*e.Weight;this.sumAd=this.sumAd+r*e.DesiredPos,this.sumAb=this.sumAb+r*n,this.sumA2=this.sumA2+r*t}UpdateReferencePosFromSums(){if(!(Number.isFinite(this.sumAd)&&Number.isFinite(this.sumAb)&&Number.isFinite(this.sumA2)))throw new Error("infinite numbers");this.ReferencePos=(this.sumAd-this.sumAb)/this.sumA2,this.UpdateVariablePositions()}UpdateVariablePositions(){const e=this.Scale*this.ReferencePos,t=this.Variables.length;for(let n=0;n<t;n++){const r=this.Variables[n];r.ActualPos=(e+r.OffsetInBlock)/r.Scale}}GetConnectedVariables(e,t,n){this.RecurseGetConnectedVariables(e,t,n)}RecurseGetConnectedVariables(e,t,n){this.allConstraints.DfDvStack=new Jt.K;const r=new $u(t);for(this.dfDvDummyParentNode=new Ju(r),this.allConstraints.DfDvStack.push(this.GetDfDvNode(this.dfDvDummyParentNode,r,t,n)),e.push(t);this.allConstraints.DfDvStack.length>0;){const s=this.allConstraints.DfDvStack.top,o=this.allConstraints.DfDvStack.length;if(!s.ChildrenHaveBeenPushed){s.ChildrenHaveBeenPushed=!0;for(const a of s.VariableToEval.LeftConstraints)a.IsActive&&a.Right!=s.VariableDoneEval&&(1==a.Right.ActiveConstraintCount?e.push(a.Right):this.AddVariableAndPushDfDvNode(e,this.GetDfDvNode(s,a,a.Right,s.VariableToEval)));for(const a of s.VariableToEval.RightConstraints)a.IsActive&&a.Left!=s.VariableDoneEval&&(1==a.Left.ActiveConstraintCount?e.push(a.Left):this.AddVariableAndPushDfDvNode(e,this.GetDfDvNode(s,a,a.Left,s.VariableToEval)))}this.allConstraints.DfDvStack.length>o||this.allConstraints.RecycleDfDvNode(this.allConstraints.DfDvStack.pop())}}TransferConnectedVariables(e,t,n){this.GetConnectedVariables(e.Variables,t,n);const r=e.Variables.length;for(let o=0;o<r;o++)e.Variables[o].Block=e;let s=this.Variables.length-1;for(let o=this.Variables.length-1;o>=0;o--)this.Variables[o].Block==e&&(o<s&&(this.Variables[o]=this.Variables[s]),s--);if(this.Variables=this.Variables.slice(0,s+1),0==this.Variables.length){for(let o=0;o<r;o++){const a=e.Variables[o];this.Variables.push(a),a.Block=this}e.Variables=[]}}}class cU{constructor(){this.Vector=new Array}get Count(){return this.Vector.length}item(e){return this.Vector[e]}Add(e){e.VectorIndex=this.Vector.length,this.Vector.push(e)}Remove(e){const t=this.Vector[this.Vector.length-1];this.Vector[e.VectorIndex]=t,t.VectorIndex=e.VectorIndex,this.Vector.pop()}toString(){return this.Vector.toString()}}class uU{constructor(){this.nextConstraintIndex=0,this.DfDvStack=new Jt.K,this.DfDvRecycleStack=new Jt.K}get IsEmpty(){return null==this.Vector}Create(e){this.Vector=new Array(e),this.firstActiveConstraintIndex=e}Add(e){e.SetVectorIndex(this.nextConstraintIndex),this.Vector[this.nextConstraintIndex++]=e}ActivateConstraint(e){this.firstActiveConstraintIndex--,this.SwapConstraint(e)}DeactivateConstraint(e){this.SwapConstraint(e),this.firstActiveConstraintIndex++}SwapConstraint(e){const t=this.Vector[this.firstActiveConstraintIndex];t.SetVectorIndex(e.VectorIndex),this.Vector[e.VectorIndex]=t,this.Vector[this.firstActiveConstraintIndex]=e,e.SetActiveState(!e.IsActive,this.firstActiveConstraintIndex)}Reinitialize(){if(null!=this.Vector){for(const e of this.Vector)e.Reinitialize();this.firstActiveConstraintIndex=this.Vector.length}}RecycleDfDvNode(e){this.DfDvRecycleStack.length<1024&&this.DfDvRecycleStack.push(e)}toString(){return this.Vector.toString()}}class qE{constructor(){this.GapTolerance=1e-4,this.QpscConvergenceEpsilon=1e-5,this.QpscConvergenceQuotient=1e-6,this.OuterProjectIterationsLimit=-1,this.InnerProjectIterationsLimit=-1,this.TimeLimit=-1,this.Advanced=new QE}Clone(){const e=this.MemberwiseClone();return e.Advanced=this.Advanced.Clone(),e}MemberwiseClone(){const e=new qE;return e.GapTolerance=this.GapTolerance,e.QpscConvergenceEpsilon=this.QpscConvergenceEpsilon,e.QpscConvergenceQuotient=this.QpscConvergenceQuotient,e.OuterProjectIterationsLimit=this.OuterProjectIterationsLimit,e.InnerProjectIterationsLimit=this.InnerProjectIterationsLimit,e.TimeLimit=this.TimeLimit,e}}class QE{constructor(){this.ForceQpsc=!1,this.ScaleInQpsc=!0,this.MinSplitLagrangianThreshold=-1e-7,this.UseViolationCache=!0,this.ViolationCacheMinBlocksDivisor=10,this.ViolationCacheMinBlocksCount=100}Clone(){const e=new QE;return e.ForceQpsc=this.ForceQpsc,e.ScaleInQpsc=this.ScaleInQpsc,e.MinSplitLagrangianThreshold=this.MinSplitLagrangianThreshold,e.UseViolationCache=this.UseViolationCache,e.ViolationCacheMinBlocksDivisor=this.ViolationCacheMinBlocksDivisor,e.ViolationCacheMinBlocksCount=this.ViolationCacheMinBlocksCount,e}}class hU{constructor(e){this.Variable=e,this.OrigWeight=e.Weight,this.OrigScale=e.Scale,this.OrigDesiredPos=this.Variable.DesiredPos}}class dU{constructor(e,t){this.Value=e,this.Column=t}}class tr{constructor(e,t){this.newMatrixRow=new Array,this.previousFunctionValue=Number.MAX_VALUE,this.solverParameters=this.solverParameters,this.matrixQ=new Array(t),this.vectorWiDi=new Array(t),this.vectorQpscVars=new Array(t),this.gradientVector=new Array(t),this.vectorQg=new Array(t),this.vectorPrevY=new Array(t),this.vectorCurY=new Array(t)}AddVariable(e){if(this.isFirstProjectCall=!0,this.vectorWiDi[e.Ordinal]=e.Weight*e.DesiredPos*2*-1,this.vectorPrevY[e.Ordinal]=e.Weight,null!=e.Neighbors)for(const t of e.Neighbors)this.vectorPrevY[e.Ordinal]=this.vectorPrevY[e.Ordinal]+t.Weight,this.vectorPrevY[t.Neighbor.Ordinal]=this.vectorPrevY[t.Neighbor.Ordinal]-t.Weight;for(let t=0;t<this.vectorPrevY.length;t++)0!=this.vectorPrevY[t]&&(this.newMatrixRow.push(new dU(2*this.vectorPrevY[t],t)),this.vectorPrevY[t]=0);this.matrixQ[e.Ordinal]=Array.from(this.newMatrixRow),this.newMatrixRow=[],this.vectorQpscVars[e.Ordinal]=new hU(e),e.Weight=1}VariablesComplete(){for(const e of this.vectorQpscVars){const t=e.Variable;for(const n of this.matrixQ[t.Ordinal])n.Column==t.Ordinal&&(this.solverParameters.Advanced.ScaleInQpsc&&(t.Scale=1/Math.sqrt(Math.abs(n.Value)),Number.isFinite(t.Scale)||(t.Scale=1),this.vectorWiDi[t.Ordinal]=this.vectorWiDi[t.Ordinal]*t.Scale),this.vectorCurY[t.Ordinal]=t.ActualPos,t.DesiredPos=t.ActualPos)}if(this.solverParameters.Advanced.ScaleInQpsc)for(let e=0;e<this.matrixQ.length;e++){const t=this.matrixQ[e];for(let n=0;n<t.length;n++)t[n].Value=t[n].Column==e?1:t[n].Value*(this.vectorQpscVars[e].Variable.Scale*this.vectorQpscVars[t[n].Column].Variable.Scale)}}PreProject(){if(this.isFirstProjectCall)for(const r of this.vectorQpscVars)this.vectorCurY[r.Variable.Ordinal]=r.Variable.ActualPos;if(this.MatrixVectorMultiply(this.vectorCurY,this.gradientVector),this.HasConverged())return!1;tr.VectorVectorAdd(this.gradientVector,this.vectorWiDi,this.gradientVector);const e=tr.VectorVectorMultiply(this.gradientVector,this.gradientVector);let t=0;if(0!=e&&(this.MatrixVectorMultiply(this.gradientVector,this.vectorQg),t=tr.VectorVectorMultiply(this.vectorQg,this.gradientVector)),0==t)return!1;const n=e/t;tr.VectorCopy(this.vectorPrevY,this.vectorCurY),tr.VectorScaledVectorSubtract(this.vectorPrevY,n,this.gradientVector,this.vectorCurY);for(let r=0;r<this.vectorCurY.length;r++)this.vectorQpscVars[r].Variable.DesiredPos=this.vectorCurY[r];return!0}PostProject(){for(const n of this.vectorQpscVars)this.vectorCurY[n.Variable.Ordinal]=n.Variable.ActualPos;tr.VectorVectorSubtract(this.vectorPrevY,this.vectorCurY,this.vectorCurY);const e=tr.VectorVectorMultiply(this.gradientVector,this.vectorCurY);let t=0;if(0!=e){this.MatrixVectorMultiply(this.vectorCurY,this.vectorQg);const n=tr.VectorVectorMultiply(this.vectorQg,this.vectorCurY);t=0==n?1:e/n,t>1?t=1:t<0&&(t=0)}return tr.VectorScaledVectorSubtract(this.vectorPrevY,t,this.vectorCurY,this.vectorCurY),this.isFirstProjectCall=!1,t>0}QpscComplete(){for(const e of this.vectorQpscVars)e.Variable.Weight=e.OrigWeight,e.Variable.DesiredPos=e.OrigDesiredPos,this.solverParameters.Advanced.ScaleInQpsc&&(e.Variable.ActualPos=e.Variable.ActualPos*e.Variable.Scale,e.Variable.Scale=e.OrigScale);return this.previousFunctionValue}HasConverged(){const e=this.GetFunctionValue(this.vectorCurY);let t=!1;if(!this.isFirstProjectCall){const n=this.previousFunctionValue-e;let r=0;0!=n&&(r=Math.abs(n/(0!=this.previousFunctionValue?this.previousFunctionValue:e))),(Math.abs(n)<this.solverParameters.QpscConvergenceEpsilon||Math.abs(r)<this.solverParameters.QpscConvergenceQuotient)&&(t=!0)}return this.previousFunctionValue=e,t}GetFunctionValue(e){return tr.VectorVectorMultiply(this.gradientVector,e)/2+tr.VectorVectorMultiply(this.vectorWiDi,e)}static VectorVectorMultiply(e,t){let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n}MatrixVectorMultiply(e,t){let n=0;for(const r of this.matrixQ){let s=0;for(const o of r)s+=o.Value*e[o.Column];t[n++]=s}}static VectorVectorAdd(e,t,n){for(let r=0;r<e.length;r++)n[r]=e[r]+t[r]}static VectorVectorSubtract(e,t,n){for(let r=0;r<e.length;r++)n[r]=e[r]-t[r]}static VectorScaledVectorSubtract(e,t,n,r){for(let s=0;s<e.length;s++)r[s]=e[s]-t*n[s]}static VectorCopy(e,t){for(let n=0;n<t.length;n++)e[n]=t[n]}}class Vf{get ExecutionLimitExceeded(){return this.TimeLimitExceeded||this.OuterProjectIterationsLimitExceeded||this.InnerProjectIterationsLimitExceeded}Clone(){const e=new Vf;return e.GoalFunctionValue=this.GoalFunctionValue,e.InnerProjectIterationsLimitExceeded=this.InnerProjectIterationsLimitExceeded,e.InnerProjectIterationsTotal=this.InnerProjectIterationsTotal,e.MaxConstraintTreeDepth=this.MaxConstraintTreeDepth,e.OuterProjectIterations=this.OuterProjectIterations,e.OuterProjectIterationsLimitExceeded=this.OuterProjectIterationsLimitExceeded,e.AlgorithmUsed=this.AlgorithmUsed,e.NumberOfUnsatisfiableConstraints=this.NumberOfUnsatisfiableConstraints,e.MaxInnerProjectIterations=this.MaxInnerProjectIterations,e}}var qu=(()=>{return(i=qu||(qu={}))[i.ProjectOnly=0]="ProjectOnly",i[i.QpscWithScaling=1]="QpscWithScaling",i[i.QpscWithoutScaling=2]="QpscWithoutScaling",qu;var i})();class fU{constructor(e,t){this.Neighbor=e,this.Weight=t}}class gU{constructor(e,t,n,r,s){if(this.ActiveConstraintCount=0,r<=0)throw new Error("weight");if(s<=0)throw new Error("scale");let o=n*r;if(!Number.isFinite(o)||Number.isNaN(o))throw new Error("desiredPos");if(o=n*s,!Number.isFinite(o)||Number.isNaN(o))throw new Error("desiredPos");this.Ordinal=e,this.UserData=t,this.DesiredPos=n,this.Weight=r,this.Scale=s,this.OffsetInBlock=0,this.ActualPos=this.DesiredPos}get DfDv(){return this.Weight*(this.ActualPos-this.DesiredPos)*2/this.Scale}Reinitialize(){this.ActiveConstraintCount=0,this.OffsetInBlock=0,this.ActualPos=this.DesiredPos}AddNeighbor(e,t){null==this.Neighbors&&(this.Neighbors=new Array),this.Neighbors.push(new fU(e,t))}toString(){return Hn.String.Format("{0} {1:F5} ({2:F5}) {3:F5} {4:F5}",this.Name,this.ActualPos,this.DesiredPos,this.Weight,this.Scale)}get Name(){return null==this.UserData?"-0-":this.UserData.toString()}SetConstraints(e,t){this.LeftConstraints=e,this.RightConstraints=t}CompareTo(e){return Vt(this.Ordinal,e.Ordinal)}}let pU=(()=>{class i{get IsFull(){return this.numConstraints==i.MaxConstraints}Clear(){this.LowViolation=0,this.numConstraints=0,this.constraints||(this.constraints=new Array(i.MaxConstraints))}FilterBlock(t){this.LowViolation=Number.MAX_VALUE;const n=this.numConstraints>0;for(let r=this.numConstraints-1;r>=0;r--){const s=this.constraints[r];if(s.Left.Block==t||s.Right.Block==t||s.IsActive||s.IsUnsatisfiable)r<this.numConstraints-1&&(this.constraints[r]=this.constraints[this.numConstraints-1]),this.numConstraints--;else{const o=s.Left.ActualPos*s.Left.Scale+(s.Gap-s.Right.ActualPos*s.Right.Scale);o<this.LowViolation&&(this.LowViolation=o)}}return 0==this.numConstraints&&(this.LowViolation=0),n}FindIfGreater(t){let n=null;for(let r=0;r<this.numConstraints;r++){const s=this.constraints[r],o=s.Left.ActualPos*s.Left.Scale+(s.Gap-s.Right.ActualPos*s.Right.Scale);o>t&&(t=o,n=s)}return n}Insert(t,n){let r=0,s=n,o=n;for(let a=0;a<this.numConstraints;a++){const l=this.constraints[a],c=l.Left.ActualPos*l.Left.Scale+(l.Gap-l.Right.ActualPos*l.Right.Scale);c<s?(o=s,r=a,s=c):c<o&&(o=c)}this.IsFull?(this.constraints[r]=t,this.LowViolation=o):(this.constraints[this.numConstraints++]=t,this.IsFull&&(this.LowViolation=s))}}return i.MaxConstraints=20,i})();class zI{constructor(e,t){this.NumberOfLeftConstraints=0,this.Constraints=e,this.NumberOfLeftConstraints=t}}class mU{constructor(){this.allBlocks=new cU,this.allConstraints=new uU,this.numberOfConstraints=0,this.numberOfVariables=0,this.equalityConstraints=new Array,this.loadedVariablesAndConstraintLists=new Map,this.emptyConstraintList=new Array(0),this.updatedConstraints=new Array,this.violationCache=new pU,this.violationCacheMinBlockCutoff=0,this.nextVariableOrdinal=0,this.solverParams=new qE,this.solverSolution=new Vf}get IsQpsc(){return this.hasNeighbourPairs||this.solverParams.Advanced.ForceQpsc}AddVariableAN(e,t){return this.AddVariableANNN(e,t,1,1)}AddVariableANN(e,t,n){return this.AddVariableANNN(e,t,n,1)}AddVariableANNN(e,t,n,r){if(!this.allConstraints.IsEmpty)throw new Error("Cannot add Variables or Constraints once Solve() has been called");const s=new gU(this.nextVariableOrdinal++,e,t,n,r),o=new kf(s,this.allConstraints);return s.Block=o,this.allBlocks.Add(o),this.numberOfVariables++,this.loadedVariablesAndConstraintLists.set(s,new zI(new Array,0)),s}UpdateVariables(){for(const e of this.allBlocks.Vector)e.UpdateReferencePos()}get Variables(){return Yu(this.allBlocks.Vector,e=>e.Variables)}get VariableCount(){return this.numberOfVariables}*Constraints(){if(this.allConstraints.IsEmpty)for(const e of this.loadedVariablesAndConstraintLists.keys()){const t=this.loadedVariablesAndConstraintLists.get(e);if(null!=t.Constraints){const n=t.Constraints.length;for(let r=0;r<n;r++){const s=t.Constraints[r];if(e==s.Left)return yield,s}}}else for(const e of this.allConstraints.Vector)yield e}get ConstraintCount(){return this.numberOfConstraints}AddEqualityConstraint(e,t,n){return this.AddConstraintVVNB(e,t,n,!0)}AddConstraintVVNB(e,t,n,r){if(!this.allConstraints.IsEmpty)throw new Error("Cannot add Variables or Constraints once Solve() has been called");if(e==t)throw new Error("Cannot add a constraint between a variable and itself");const s=this.loadedVariablesAndConstraintLists.get(e),o=this.loadedVariablesAndConstraintLists.get(t),a=$u.constructorVVNB(e,t,n,r);return this.loadedVariablesAndConstraintLists.set(e,new zI(s.Constraints,s.NumberOfLeftConstraints+1)),s.Constraints.push(a),o.Constraints.push(a),this.numberOfConstraints++,r&&this.equalityConstraints.push(a),a}AddConstraint(e,t,n){return this.AddConstraintVVNB(e,t,n,!1)}SetConstraintUpdate(e,t){t!=e.Gap&&this.updatedConstraints.push([e,t])}AddNeighborPair(e,t,n){if(n<=0||Number.isNaN(n)||!Number.isFinite(n))throw new Error("relationshipWeight");if(e==t)throw new Error;e.AddNeighbor(t,n),t.AddNeighbor(e,n),this.hasNeighbourPairs=!0}Solve(){return this.SolvePar(null)}SolvePar(e){e&&(this.solverParams=e.Clone()),this.solverParams.OuterProjectIterationsLimit<0&&(this.solverParams.OuterProjectIterationsLimit=100*(Math.log2(this.numberOfVariables)+1)),this.solverParams.InnerProjectIterationsLimit<0&&(this.solverParams.InnerProjectIterationsLimit=2*this.numberOfConstraints+100*(Math.log2(this.numberOfConstraints)+1));const t=!this.allConstraints.IsEmpty;if(this.CheckForUpdatedConstraints(),this.solverSolution=new Vf,this.solverSolution.MinInnerProjectIterations=Number.MAX_VALUE,this.allConstraints.MaxConstraintTreeDepth=0,this.allConstraints.SolverParameters=this.solverParams,0==this.numberOfConstraints){if(!this.IsQpsc)return this.solverSolution.Clone()}else t||this.SetupConstraints();return this.allConstraints.NumberOfUnsatisfiableConstraints=0,this.MergeEqualityConstraints(),this.IsQpsc?this.SolveQpsc():(this.SolveByStandaloneProject(),this.CalculateStandaloneProjectGoalFunctionValue()),this.solverSolution.MinInnerProjectIterations>this.solverSolution.MaxInnerProjectIterations&&(this.solverSolution.MinInnerProjectIterations=this.solverSolution.MaxInnerProjectIterations),this.solverSolution.NumberOfUnsatisfiableConstraints=this.allConstraints.NumberOfUnsatisfiableConstraints,this.solverSolution.MaxConstraintTreeDepth=this.allConstraints.MaxConstraintTreeDepth,this.solverSolution.Clone()}CheckForUpdatedConstraints(){if(0==this.updatedConstraints.length)return;let e=this.IsQpsc;for(const[t,n]of this.updatedConstraints){const r=t;r.UpdateGap(n),e||r.IsEquality?e=!0:this.SplitOnConstraintIfActive(r)}this.updatedConstraints=[],e&&this.ReinitializeBlocks()}SplitOnConstraintIfActive(e){if(e.IsActive){const t=e.Left.Block.SplitOnConstraint(e);null!=t&&this.allBlocks.Add(t)}}SetupConstraints(){this.allConstraints.Create(this.numberOfConstraints);for(const e of this.loadedVariablesAndConstraintLists.keys()){const t=this.loadedVariablesAndConstraintLists.get(e),n=t.Constraints;let r=0,s=0,o=0;null!=n&&(r=n.length,s=t.NumberOfLeftConstraints,o=r-s);let a=this.emptyConstraintList;0!=s&&(a=new Array(s));let l=this.emptyConstraintList;0!=o&&(l=new Array(o)),e.SetConstraints(a,l);let c=0,u=0;for(let y=0;y<r;y++){const R=n[y];e==R.Left?a[c++]=R:l[u++]=R}for(const y of e.LeftConstraints)this.allConstraints.Add(y)}this.loadedVariablesAndConstraintLists.clear(),this.violationCacheMinBlockCutoff=Number.MAX_VALUE,this.solverParams.Advanced.UseViolationCache&&this.solverParams.Advanced.ViolationCacheMinBlocksDivisor>0&&(this.violationCacheMinBlockCutoff=Math.min(this.allBlocks.Count/this.solverParams.Advanced.ViolationCacheMinBlocksDivisor,this.solverParams.Advanced.ViolationCacheMinBlocksCount))}SolveByStandaloneProject(){for(;;){let e;if(!this.RunProject(e))return;if(!this.SplitBlocks())break}}RunProject(e){return this.solverSolution.OuterProjectIterations++,this.Project(),!this.CheckForLimitsExceeded()}CheckForLimitsExceeded(){return this.solverParams.OuterProjectIterationsLimit>0&&this.solverSolution.OuterProjectIterations>=this.solverParams.OuterProjectIterationsLimit?(this.solverSolution.OuterProjectIterationsLimitExceeded=!0,!0):!!this.solverSolution.InnerProjectIterationsLimitExceeded}CalculateStandaloneProjectGoalFunctionValue(){this.solverSolution.GoalFunctionValue=0;const e=this.allBlocks.Count;for(let t=0;t<e;t++){const n=this.allBlocks.item(t),r=n.Variables.length;for(let s=0;s<r;s++){const o=n.Variables[s];this.solverSolution.GoalFunctionValue=this.solverSolution.GoalFunctionValue+o.Weight*(o.ActualPos*o.ActualPos),this.solverSolution.GoalFunctionValue=this.solverSolution.GoalFunctionValue-o.Weight*(o.DesiredPos*o.ActualPos)*2}}}SolveQpsc(){if(this.solverSolution.AlgorithmUsed=this.solverParams.Advanced.ScaleInQpsc?qu.QpscWithScaling:qu.QpscWithoutScaling,!this.QpscMakeFeasible())return;const e=new tr(this.solverParams,this.numberOfVariables);for(const r of this.allBlocks.Vector)for(const s of r.Variables)e.AddVariable(s);e.VariablesComplete(),this.ReinitializeBlocks(),this.MergeEqualityConstraints();let t=!1;for(;(e.PreProject()||t)&&(t=this.SplitBlocks(),this.RunProject(false))&&(e.PostProject()||t););this.solverSolution.GoalFunctionValue=e.QpscComplete()}QpscMakeFeasible(){return this.RunProject(void 0)}ReinitializeBlocks(){const e=Array.from(this.allBlocks.Vector);this.allBlocks.Vector=[];for(const t of e)for(const n of t.Variables){n.Reinitialize();const r=new kf(n,this.allConstraints);this.allBlocks.Add(r)}this.allConstraints.Reinitialize(),this.violationCache.Clear()}MergeEqualityConstraints(){for(const e of this.equalityConstraints)e.Left.Block!=e.Right.Block?this.MergeBlocks(e):Math.abs(e.Violation)>this.solverParams.GapTolerance&&(e.IsUnsatisfiable=!0,this.allConstraints.NumberOfUnsatisfiableConstraints++)}Project(){if(0==this.numberOfConstraints)return!1;this.violationCache.Clear(),this.lastModifiedBlock=null;let e=this.allBlocks.Count>this.violationCacheMinBlockCutoff,t=1,r=this.GetMaxViolatedConstraint({maxViolation:0},e);if(!r)return!1;for(;r;){if(r.Left.Block==r.Right.Block?(r.Left.Block.Expand(r),r.IsUnsatisfiable&&this.violationCache.Clear(),this.lastModifiedBlock=r.Left.Block):this.lastModifiedBlock=this.MergeBlocks(r),this.solverParams.InnerProjectIterationsLimit>0&&t>=this.solverParams.InnerProjectIterationsLimit){this.solverSolution.InnerProjectIterationsLimitExceeded=!0;break}e=this.allBlocks.Count>this.violationCacheMinBlockCutoff,e||this.violationCache.Clear(),t++,r=this.GetMaxViolatedConstraint({maxViolation:0},e)}return this.solverSolution.InnerProjectIterationsTotal=this.solverSolution.InnerProjectIterationsTotal+t,this.solverSolution.MaxInnerProjectIterations<t&&(this.solverSolution.MaxInnerProjectIterations=t),this.solverSolution.MinInnerProjectIterations>t&&(this.solverSolution.MinInnerProjectIterations=t),!0}MergeBlocks(e){let t=e.Left.Block,n=e.Right.Block,r=e.Left.OffsetInBlock+(e.Gap-e.Right.OffsetInBlock);n.Variables.length>t.Variables.length&&(t=e.Right.Block,n=e.Left.Block,r*=-1);const s=n.Variables.length;for(let o=0;o<s;o++){const a=n.Variables[o];a.OffsetInBlock=a.OffsetInBlock+r,t.AddVariable(a)}return t.UpdateReferencePosFromSums(),this.allConstraints.ActivateConstraint(e),this.allBlocks.Remove(n),t}SplitBlocks(){const e=new Array,t=this.allBlocks.Count;for(let r=0;r<t;r++){const o=this.allBlocks.item(r).Split(this.IsQpsc);null!=o&&e.push(o)}const n=e.length;for(let r=0;r<n;r++)this.allBlocks.Add(e[r]);return 0!=e.length}GetMaxViolatedConstraint(e,t){e.maxViolation=this.solverParams.GapTolerance;const n=this.SearchViolationCache(e.maxViolation);return null!=n?n:this.SearchAllConstraints(e.maxViolation,t)}SearchViolationCache(e){let t=null;if(null==this.lastModifiedBlock)return;this.lastModifiedBlock.Variables.length<this.numberOfVariables+1&&this.violationCache.FilterBlock(this.lastModifiedBlock);const n=this.lastModifiedBlock.Variables.length;for(let s=0;s<n;s++){const o=this.lastModifiedBlock.Variables[s];for(const a of o.LeftConstraints)a.IsActive||a.IsUnsatisfiable||CE(a.Left.ActualPos*a.Left.Scale+(a.Gap-a.Right.ActualPos*a.Right.Scale),e)&&(null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),e=a.Violation,t=a);for(const a of o.RightConstraints)if(!a.IsActive&&!a.IsUnsatisfiable&&a.Left.Block!=this.lastModifiedBlock){const l=a.Left.ActualPos*a.Left.Scale+(a.Gap-a.Right.ActualPos*a.Right.Scale);CE(l,e)&&(null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),e=l,t=a)}}const r=this.violationCache.FindIfGreater(e);return null!=r&&(null!=t&&e>this.violationCache.LowViolation&&this.violationCache.Insert(t,e),t=r),t}SearchAllConstraints(e,t){let n=null;this.violationCache.Clear();for(const r of this.allConstraints.Vector){if(r.IsActive)break;if(r.IsUnsatisfiable)continue;const s=r.Left.ActualPos*r.Left.Scale+(r.Gap-r.Right.ActualPos*r.Right.Scale);let o=null,a=0;CE(s,e)&&(e>this.violationCache.LowViolation&&(o=n,a=e),e=s,n=r),t&&(null==o&&r!=n&&(!this.violationCache.IsFull||s>this.violationCache.LowViolation)&&(o=r,a=s),null!=o&&a>this.violationCache.LowViolation&&this.violationCache.Insert(o,a))}return n}}let yU=(()=>{class i{constructor(){this.variables=new Map,this.fixedVars=new Map,this.FailToAdjustEpsilon=.001,this.InitSolver()}AddVariableWithIdealPositionNNN(t,n,r){this.variables.set(t,this.solver.AddVariableANN(t,n,r))}AddVariableWithIdealPositionNN(t,n){this.AddVariableWithIdealPositionNNN(t,n,1)}AddLeftRightSeparationConstraintNNNB(t,n,r,s){const o=this.GetVariable(t);if(null==o)return;const a=this.GetVariable(n);null!=a&&this.solver.AddConstraintVVNB(o,a,r,s)}AddLeftRightSeparationConstraintNNN(t,n,r){this.AddLeftRightSeparationConstraintNNNB(t,n,r,!1)}AddGoalTwoVariablesAreCloseNNN(t,n,r){const s=this.GetVariable(t);if(null==s)return;const o=this.GetVariable(n);null!=o&&this.solver.AddNeighborPair(s,o,r)}AddGoalTwoVariablesAreClose(t,n){this.AddGoalTwoVariablesAreCloseNNN(t,n,1)}GetVariable(t){return this.variables.get(t)}Solve(){this.SolveP(null)}SolveP(t){this.SolvePNS(t,{executionLimitExceeded:!1})}SolvePNS(t,n){let r;do{this.solution=null;let s=null;if(null!=t&&(s=t,null==s))throw new Error("parameters");this.solution=this.solver.SolvePar(s),n.executionLimitExceeded=this.solution.ExecutionLimitExceeded,r=this.AdjustConstraintsForMovedFixedVars()}while(r&&0==this.solution.ExecutionLimitExceeded);return 0==this.solution.ExecutionLimitExceeded}AdjustConstraintsForMovedFixedVars(){const t=new Set;for(const[n,r]of this.fixedVars.entries())i.Close(r,this.GetVariableResolvedPosition(n))||t.add(n);return 0!=t.size&&this.AdjustConstraintsForMovedFixedVarSet(t)}static Close(t,n){return Math.abs(t-n)<5e-4}AdjustConstraintsForMovedFixedVarSet(t){for(;t.size>0;){let n;for(const r of t){n=r;break}if(!this.AdjustSubtreeOfFixedVar(n,t))return!1}return!0}AdjustSubtreeOfFixedVar(t,n){const r={successInAdjusting:!1},s=this.AdjustConstraintsOfNeighborsOfFixedVariable(t,r);if(!r.successInAdjusting||0==s.length)return!1;for(const o of s)n.delete(o);return!0}AdjustConstraintsOfNeighborsOfFixedVariable(t,n){const r=this.variables.get(t).Block.Variables,s=new br,o=new br;let a=1;for(const l of r)!this.fixedVars.has(l.UserData)||(s.AddValue(l.ActualPos),o.AddValue(l.DesiredPos),o.length>0&&(a=Math.max(a,s.length/o.length)));return 1==a&&(a=2),n.successInAdjusting=this.FixActiveConstraints(r,a),r.map(l=>l.UserData)}FixActiveConstraints(t,n){let r=!1;for(const s of t)for(const o of s.LeftConstraints)o.IsActive&&(o.Gap>this.FailToAdjustEpsilon&&(r=!0),this.solver.SetConstraintUpdate(o,o.Gap/n));return r}GetVariableResolvedPosition(t){const n=this.GetVariable(t);return null==n?0:n.ActualPos}InitSolver(){this.solver=new mU,this.variables.clear()}AddFixedVariable(t,n){this.AddVariableWithIdealPositionNNN(t,n,i.FixedVarWeight),this.fixedVars.set(t,n)}ContainsVariable(t){return this.variables.has(t)}GetVariableIdealPosition(t){return this.variables.get(t).DesiredPos}get Solution(){return this.solution}}return i.FixedVarWeight=1e9,i})();class EU{constructor(){this.lowBound=Number.NEGATIVE_INFINITY,this.upperBound=Number.POSITIVE_INFINITY}get Position(){return this.position}set Position(e){this.position=e<this.lowBound?this.lowBound:e>this.upperBound?this.upperBound:e}get LowBound(){return this.lowBound}set LowBound(e){this.lowBound=e}get UpperBound(){return this.upperBound}set UpperBound(e){this.upperBound=e}toString(){return this.lowBound+" "+this.Position+" "+this.upperBound}}class wU{constructor(e){this.idealPositions=new Map,this.varList=new Array,this.constraints=new Set,this.solverShell=new yU,this.boundsToInt=new Map,this.varSepartion=e}SetLowBound(e,t){const n=this.Var(t);n.LowBound=Math.max(e,n.LowBound)}Var(e){return this.varList[e]}SetUpperBound(e,t){const n=this.Var(e);n.UpperBound=Math.min(t,n.UpperBound)}Solve(){this.SolveByRegularSolver()}SolveByRegularSolver(){this.CreateVariablesForBounds();for(let e=0;e<this.varList.length;e++){const t=this.varList[e];t.IsFixed?this.solverShell.AddFixedVariable(e,t.Position):(this.solverShell.AddVariableWithIdealPositionNN(e,this.idealPositions.get(e)),t.LowBound!=Number.NEGATIVE_INFINITY&&this.constraints.add(new mt(this.GetBoundId(t.LowBound),e)),t.UpperBound!=Number.POSITIVE_INFINITY&&this.constraints.add(new mt(e,this.GetBoundId(t.UpperBound))))}this.CreateGraphAndRemoveCycles();for(const e of this.graph.edges){let t=0;e.x<this.varList.length&&(t+=this.varList[e.x].Width),e.y<this.varList.length&&(t+=this.varList[e.y].Width),t/=2,this.solverShell.AddLeftRightSeparationConstraintNNN(e.x,e.y,this.varSepartion+t)}this.solverShell.Solve();for(let e=0;e<this.varList.length;e++)this.varList[e].Position=this.solverShell.GetVariableResolvedPosition(e)}GetBoundId(e){return this.boundsToInt.get(e)}CreateVariablesForBounds(){for(const e of this.varList)e.IsFixed||(e.LowBound!=Number.NEGATIVE_INFINITY&&this.RegisterBoundVar(e.LowBound),e.UpperBound!=Number.POSITIVE_INFINITY&&this.RegisterBoundVar(e.UpperBound))}RegisterBoundVar(e){if(!this.boundsToInt.has(e)){const t=this.varList.length+this.boundsToInt.size;this.boundsToInt.set(e,t),this.solverShell.AddFixedVariable(t,e)}}CreateGraphAndRemoveCycles(){this.graph=Xs(Array.from(this.constraints),this.varList.length+this.boundsToInt.size);const e=xo.getFeedbackSet(this.graph);if(null!=e)for(const t of e)this.graph.removeEdge(t)}GetVariablePosition(e){return this.varList[e].Position}AddConstraint(e,t){this.constraints.add(new mt(e,t))}AddVariableNNNN(e,t,n,r){this.idealPositions.set(e,n),this.AddVariableNNBN(e,t,!1,r)}AddFixedVariable(e,t){this.AddVariableNNBN(e,t,!0,0)}AddVariableNNBN(e,t,n,r){const s=new EU;s.Position=t,s.IsFixed=n,s.Width=r,this.varList.push(s)}}class vU extends ci{constructor(e,t){super(e,t),this.RightNeighbors=new Set,this.setOfLongestSegs=new Set,this.RightBound=Number.POSITIVE_INFINITY,this.LeftBound=Number.NEGATIVE_INFINITY,this.Direction=Ce.DirectionFromPointToPoint(e.point,t.point)}AddRightNeighbor(e){this.RightNeighbors.add(e)}get LongestNudgedSegments(){return this.setOfLongestSegs}AddLongestNudgedSegment(e){this.setOfLongestSegs.add(e)}BoundFromRight(e){e=Math.max(e,this.LeftBound),this.RightBound=Math.min(e,this.RightBound)}BoundFromLeft(e){e=Math.min(e,this.RightBound),this.LeftBound=Math.max(e,this.LeftBound)}}class io{constructor(e){this.Point=e}*GetEnumerator(){let e;for(e=this;null!=e;e=e.Next)yield e.Point}get X(){return this.Point.x}get Y(){return this.Point.y}InsertVerts(e,t,n){for(t--;e<t;t--)this.SetNewNext(n[t])}InsertVertsInReverse(e,t,n){for(e++;e<t;e++)this.SetNewNext(n[e])}SetNewNext(e){const t=new io(e),n=this.Next;this.Next=t,t.Next=n}}class Gf{constructor(e,t){this.IsFixed=!1,this.Reversed=!1,this.index=-1,this.AxisEdge=e,this.Width=t}toString(){return this.Source+" "+this.Target}get LongestNudgedSegment(){return this.longestNudgedSegment}set LongestNudgedSegment(e){this.longestNudgedSegment=e,null!=this.longestNudgedSegment&&(this.longestNudgedSegment.AddEdge(this),this.AxisEdge.AddLongestNudgedSegment(this.longestNudgedSegment))}get Source(){return this.Reversed?this.AxisEdge.TargetPoint:this.AxisEdge.SourcePoint}get Target(){return this.Reversed?this.AxisEdge.SourcePoint:this.AxisEdge.TargetPoint}static VectorsAreParallel(e,t){return ht(e.x*t.y-e.y*t.x,0)}static EdgesAreParallel(e,t){return Gf.VectorsAreParallel(e.AxisEdge.TargetPoint.sub(e.AxisEdge.SourcePoint),t.AxisEdge.TargetPoint.sub(t.AxisEdge.SourcePoint))}get Direction(){return this.Reversed?Ce.OppositeDir(this.AxisEdge.Direction):this.AxisEdge.Direction}get Index(){return this.index}set Index(e){this.index=e}}class $n{constructor(e){this.pathVisibilityGraph=new gn,this.axisEdgesToPathOrders=new Map,this.OriginalPaths=e}get PathVisibilityGraph(){return this.pathVisibilityGraph}GetOrder(){return this.FillTheVisibilityGraphByWalkingThePaths(),this.InitPathOrder(),this.OrderPaths(),this.axisEdgesToPathOrders}FillTheVisibilityGraphByWalkingThePaths(){for(const e of this.OriginalPaths)this.FillTheVisibilityGraphByWalkingPath(e)}FillTheVisibilityGraphByWalkingPath(e){const t=this.CreatePathEdgesFromPoints(function*r(){if(e.PathPoints instanceof io)for(let s=e.PathPoints;null!=s;s=s.Next)yield s.Point;else for(const s of e.PathPoints)yield s}(),e.Width);let n=t.next();for(n.done||e.SetFirstEdge(n.value);0==(n=t.next()).done;)e.AddEdge(n.value)}*CreatePathEdgesFromPoints(e,t){let n=e.next(),r=n.value;for(;!(n=e.next()).done;)yield this.CreatePathEdge(r,n.value,t),r=n.value}CreatePathEdge(e,t,n){switch(Ce.DirectionFromPointToPoint(e,t)){case oe.East:case oe.North:return new Gf(this.GetAxisEdge(e,t),n);case oe.South:case oe.West:{const s=new Gf(this.GetAxisEdge(t,e),n);return s.Reversed=!0,s}default:throw new Error("Not a rectilinear path")}}GetAxisEdge(e,t){return this.PathVisibilityGraph.AddEdgeF(e,t,(n,r)=>new vU(n,r))}InitPathOrder(){for(const e of this.PathVisibilityGraph.Edges)this.axisEdgesToPathOrders.set(e,new Array);for(const e of this.OriginalPaths)for(const t of e.PathEdges())this.axisEdgesToPathOrders.get(t.AxisEdge).push(t)}OrderPaths(){for(const e of $n.WalkGraphEdgesInTopologicalOrderIfPossible(this.PathVisibilityGraph))this.OrderPathEdgesSharingEdge(e)}OrderPathEdgesSharingEdge(e){const t=this.PathOrderOfVisEdge(e);t.sort($n.CompareTwoPathEdges);let n=0;for(const r of t)r.Index=n++}static CompareTwoPathEdges(e,t){if(e==t)return 0;const n=$n.CompareInDirectionStartingFromAxisEdge(e,t,e.AxisEdge,e.AxisEdge.Direction);return 0!=n?n:-$n.CompareInDirectionStartingFromAxisEdge(e,t,e.AxisEdge,Ce.OppositeDir(e.AxisEdge.Direction))}static CompareInDirectionStartingFromAxisEdge(e,t,n,r){for(;;){if(null==(e=$n.GetNextPathEdgeInDirection(e,n,r))||null==(t=$n.GetNextPathEdgeInDirection(t,n,r)))return 0;if(e.AxisEdge==t.AxisEdge){r=$n.FindContinuedDirection(n,r,e.AxisEdge),n=e.AxisEdge;const c=$n.GetExistingOrder(e,t);if(c==$n.NotOrdered)continue;return r==n.Direction?c:-c}const s=r==n.Direction?n.Target:n.Source,o=$n.OtherVertex(e.AxisEdge,s),a=$n.OtherVertex(t.AxisEdge,s),l=$n.ProjectionForCompare(n,r!=n.Direction);return Vt(l(o.point),l(a.point))}}static FindContinuedDirection(e,t,n){return e.Direction==t?n.Source==e.Target?n.Direction:Ce.OppositeDir(n.Direction):n.Source==e.Source?n.Direction:Ce.OppositeDir(n.Direction)}static OtherVertex(e,t){return e.Source==t?e.Target:e.Source}static ProjectionForCompare(e,t){return e.Direction==oe.North?t?n=>-n.x:n=>n.x:t?n=>n.y:n=>-n.y}static GetNextPathEdgeInDirection(e,t,n){return t.Direction==n?e.Reversed?e.Prev:e.Next:e.Reversed?e.Next:e.Prev}static GetExistingOrder(e,t){const n=e.Index;return-1==n?$n.NotOrdered:Vt(n,t.Index)}PathOrderOfVisEdge(e){return this.axisEdgesToPathOrders.get(e)}static InitQueueOfSources(e,t,n){for(const r of n.Vertices()){const s=r.InEdgesLength();t.set(r,s),0==s&&e.enqueue(r)}}static*WalkGraphEdgesInTopologicalOrderIfPossible(e){const t=new Io.c,n=new Map;for($n.InitQueueOfSources(t,n,e);t.length>0;){const r=t.dequeue();for(const s of r.OutEdges){const o=n.get(s.Target);n.set(s.Target,o-1),1==o&&t.enqueue(s.Target),yield s}}}}$n.NotOrdered=Number.MAX_VALUE;class SU extends to{constructor(e,t){super(),this.site=t,this.AxisEdge=e}get Site(){return this.site}}class KI extends to{constructor(e,t){super(),this.site=t,this.AxisEdge=e}get Site(){return this.site}}class AU{constructor(e){this.edges=new Set,this.Source=e}get Edges(){return this.edges}AddEdge(e){this.UpPoint=e.TargetPoint,this.edges.add(e)}RemoveAxis(e){this.edges.delete(e)}IsEmpty(){return 0==this.edges.size}}class ro extends BI{constructor(e,t,n,r,s){super(t,new Ce(e).ToPoint()),this.DirectionPerp=new Ce(e).Right.ToPoint(),this.PathOrders=r,this.xProjection=e==oe.North?o=>o.x:o=>-o.y,this.edgeContainersTree=new Xi((o,a)=>this.CompareAA(o,a)),this.SweepPole=Ce.VectorDirection(this.SweepDirection),this.AxisEdges=s,this.AxisEdgesToObstaclesTheyOriginatedFrom=n}FindFreeSpace(){this.InitTheQueueOfEvents(),this.ProcessEvents()}ProcessEvents(){for(;this.EventQueue.Count>0;)this.ProcessEvent(this.EventQueue.Dequeue())}ProcessEvent(e){e instanceof Ql?this.ProcessVertexEvent(e):(this.Z=this.GetZP(e.Site),e instanceof KI?this.ProcessLowEdgeEvent(e):this.ProcessHighEdgeEvent(e))}ProcessHighEdgeEvent(e){const t=e.AxisEdge;this.RemoveEdge(t),this.ConstraintEdgeWithObstaclesAtZ(t,t.Target.point)}ProcessLowEdgeEvent(e){const t=e.AxisEdge,n=this.GetOrCreateAxisEdgesContainer(t);n.item.AddEdge(t);const r=this.edgeContainersTree.previous(n);if(null!=r)for(const o of r.item.edges)for(const a of n.item.edges)this.TryToAddRightNeighbor(o,a);const s=this.edgeContainersTree.next(n);if(null!=s)for(const o of n.item.Edges)for(const a of s.item.edges)this.TryToAddRightNeighbor(o,a);this.ConstraintEdgeWithObstaclesAtZ(t,t.Source.point)}TryToAddRightNeighbor(e,t){this.ProjectionsOfEdgesOverlap(e,t)&&e.AddRightNeighbor(t)}ProjectionsOfEdgesOverlap(e,t){return this.SweepPole==oe.North?!(e.TargetPoint.y<t.SourcePoint.y-q.distanceEpsilon||t.TargetPoint.y<e.SourcePoint.y-q.distanceEpsilon):!(e.TargetPoint.x<t.SourcePoint.x-q.distanceEpsilon||t.TargetPoint.x<e.SourcePoint.x-q.distanceEpsilon)}GetObstacleBoundaries(e){return this.Obstacles.map(t=>ot.mkDebugCurveWCI(1,e,t))}ConstraintEdgeWithObstaclesAtZ(e,t){this.ConstraintEdgeWithObstaclesAtZFromLeft(e,t),this.ConstraintEdgeWithObstaclesAtZFromRight(e,t)}ConstraintEdgeWithObstaclesAtZFromRight(e,t){const n=this.GetActiveSideFromRight(t);if(null==n||this.NotRestricting(e,n.item.Polyline))return;const r=this.ObstacleSideComparer.IntersectionOfSideAndSweepLine(n.item);e.BoundFromRight(r.dot(this.DirectionPerp))}GetActiveSideFromRight(e){return this.LeftObstacleSideTree.findFirst(t=>ro.PointToTheLeftOfLineOrOnLineLocal(e,t.Start,t.End))}ConstraintEdgeWithObstaclesAtZFromLeft(e,t){const n=this.GetActiveSideFromLeft(t);if(null==n||this.NotRestricting(e,n.item.Polyline))return;const r=this.ObstacleSideComparer.IntersectionOfSideAndSweepLine(n.item);e.BoundFromLeft(r.dot(this.DirectionPerp))}static PointToTheLeftOfLineOrOnLineLocal(e,t,n){return x.signedDoubledTriangleArea(e,t,n)>-ro.AreaComparisonEpsilon}static PointToTheRightOfLineOrOnLineLocal(e,t,n){return x.signedDoubledTriangleArea(t,n,e)<ro.AreaComparisonEpsilon}GetActiveSideFromLeft(e){return this.RightObstacleSideTree.findLast(t=>ro.PointToTheRightOfLineOrOnLineLocal(e,t.Start,t.End))}static EdgeMidPoint(e){return x.middle(e.SourcePoint,e.TargetPoint)}GetOrCreateAxisEdgesContainer(e){const t=e.Source.point,n=this.GetAxisEdgesContainerNode(t);return null!=n?n:this.edgeContainersTree.insert(new AU(t))}GetAxisEdgesContainerNode(e){const t=this.xProjection(e),n=this.edgeContainersTree.findFirst(r=>this.xProjection(r.Source)>=t-q.distanceEpsilon/2);return null!=n&&this.xProjection(n.item.Source)<=t+q.distanceEpsilon/2?n:null}ProcessVertexEvent(e){this.Z=this.GetZS(e),e instanceof va?this.ProcessLeftVertex(e,e.Vertex.nextOnPolyline):(e instanceof Sa||this.ProcessLeftVertex(e,e.Vertex.nextOnPolyline),this.ProcessRightVertex(e,e.Vertex.prevOnPolyline))}ProcessRightVertex(e,t){this.ProcessPrevSegmentForRightVertex(e,e.Site);const r=t.point.sub(e.Site),s=r.dot(this.DirectionPerp),o=r.dot(this.SweepDirection);o<=q.distanceEpsilon?s>0&&o>=0?this.EnqueueEvent(new Sa(t)):this.RestrictEdgeContainerToTheRightOfEvent(e.Vertex):(this.InsertRightSide(new ec(e.Vertex)),this.EnqueueEvent(new Sa(t)),this.RestrictEdgeContainerToTheRightOfEvent(e.Vertex))}RestrictEdgeContainerToTheRightOfEvent(e){const t=e.point,n=this.xProjection(t),r=this.edgeContainersTree.findFirst(s=>n<=this.xProjection(s.Source));if(null!=r)for(const s of r.item.Edges)this.NotRestricting(s,e.polyline)||s.BoundFromLeft(this.DirectionPerp.dot(t))}NotRestricting(e,t){return this.AxisEdgesToObstaclesTheyOriginatedFrom.get(e)==t}ProcessPrevSegmentForRightVertex(e,t){t.sub(e.Vertex.nextOnPolyline.point).dot(this.SweepDirection)>q.distanceEpsilon&&this.RemoveRightSide(new ec(e.Vertex.nextOnPolyline))}RemoveEdge(e){const t=this.GetAxisEdgesContainerNode(e.Source.point);t.item.RemoveAxis(e),t.item.IsEmpty()&&this.edgeContainersTree.deleteNodeInternal(t)}ProcessLeftVertex(e,t){this.ProcessPrevSegmentForLeftVertex(e,e.Site);const r=t.point.sub(e.Site),s=r.dot(this.DirectionPerp),o=r.dot(this.SweepDirection);o<=q.distanceEpsilon?s<0&&o>=0&&this.EnqueueEvent(new va(t)):(this.InsertLeftSide(new Zl(e.Vertex)),this.EnqueueEvent(new va(t))),this.RestrictEdgeFromTheLeftOfEvent(e.Vertex)}RestrictEdgeFromTheLeftOfEvent(e){const t=e.point,n=this.GetContainerNodeToTheLeftOfEvent(t);if(null!=n)for(const r of n.item.Edges)this.NotRestricting(r,e.polyline)||r.BoundFromRight(t.dot(this.DirectionPerp))}GetContainerNodeToTheLeftOfEvent(e){const t=this.xProjection(e);return this.edgeContainersTree.findLast(n=>this.xProjection(n.Source)<=t)}ProcessPrevSegmentForLeftVertex(e,t){t.sub(e.Vertex.prevOnPolyline.point).dot(this.SweepDirection)>q.distanceEpsilon&&this.RemoveLeftSide(new Zl(e.Vertex.prevOnPolyline))}InitTheQueueOfEvents(){this.InitQueueOfEvents();for(const e of this.AxisEdges)this.EnqueueEventsForEdge(e)}EnqueueEventsForEdge(e){this.EdgeIsParallelToSweepDir(e)&&(this.EnqueueEvent(ro.EdgeLowPointEvent(e,e.Source.point)),this.EnqueueEvent(ro.EdgeHighPointEvent(e,e.Target.point)))}EdgeIsParallelToSweepDir(e){return e.Direction==this.SweepPole||e.Direction==Ce.OppositeDir(this.SweepPole)}static EdgeHighPointEvent(e,t){return new SU(e,t)}static EdgeLowPointEvent(e,t){return new KI(e,t)}CompareAA(e,t){return Vt(e.Source.dot(this.DirectionPerp),t.Source.dot(this.DirectionPerp))}}ro.AreaComparisonEpsilon=q.intersectionEpsilon;class bU extends UE{constructor(e){super(),this.CompassDirection=oe.None,this.edges=new Array,this._isFixed=!1,this.Id=-1,this.IdealPosition=0,this.Id=e}get Start(){return this.start}get End(){return this.end}get Edges(){return this.edges}AddEdge(e){if(0==this.Edges.length){let t=Ce.VectorDirectionPP(e.Source,e.Target);switch(t){case oe.South:t=oe.North;break;case oe.West:t=oe.East}this.CompassDirection=t,this.start=e.Source,this.end=e.Source}switch(this.CompassDirection){case oe.North:this.TryPointForStartAndEndNorth(e.Source),this.TryPointForStartAndEndNorth(e.Target);break;case oe.East:this.TryPointForStartAndEndEast(e.Source),this.TryPointForStartAndEndEast(e.Target)}this.Edges.push(e)}TryPointForStartAndEndNorth(e){e.y<this.start.y?this.start=e:e.y>this.end.y&&(this.end=e)}TryPointForStartAndEndEast(e){e.x<this.start.x?this.start=e:e.x>this.end.x&&(this.end=e)}get IsFixed(){return this._isFixed}set IsFixed(e){this._isFixed=e}get Width(){let e=0;for(const t of this.edges)e=Math.max(e,t.Width);return e}GetLeftBound(){if(!this.IsFixed){let e=Number.NEGATIVE_INFINITY;for(const t of this.edges)e=Math.max(e,t.AxisEdge.LeftBound);return e}return this.CompassDirection==oe.North?this.Edges[0].Source.x:-this.Edges[0].Source.y}GetRightBound(){if(!this.IsFixed){let e=Number.POSITIVE_INFINITY;for(const t of this.edges)e=Math.min(e,t.AxisEdge.RightBound);return e}return this.Position()}Position(){return this.CompassDirection==oe.North?this.Edges[0].Source.x:-this.Edges[0].Source.y}}class Rs{constructor(e,t){this.tree=new Xi((n,r)=>Vt(n.Point.x,r.Point.x)),this.VerticalPoints=t,this.HorizontalPoints=e}SplitPoints(){0==this.VerticalPoints.length||0==this.HorizontalPoints.length||(this.InitEventQueue(),this.ProcessEvents())}ProcessEvents(){for(;!this.Queue.IsEmpty();){const e={priority:0},t=this.Queue.DequeueAndGetPriority(e);this.ProcessEvent(t,e.priority)}}ProcessEvent(e,t){ht(e.Next.Point.x,e.Point.x)?t==Rs.Low(e)?this.ProcessLowLinkedPointEvent(e):this.ProcessHighLinkedPointEvent(e):this.IntersectWithTree(e)}IntersectWithTree(e){let t,n,r;const s=e.Y;if(e.Point.x<e.Next.Point.x?(n=e.Point.x,t=e.Next.Point.x,r=!0):(t=e.Point.x,n=e.Next.Point.x,r=!1),r)for(let o=this.tree.findFirst(a=>n<=a.Point.x);null!=o&&o.item.Point.x<=t;o=this.tree.next(o)){const a=new x(o.item.Point.x,s);e=Rs.TrySplitHorizontalPoint(e,a,!0),Rs.TrySplitVerticalPoint(o.item,a)}else for(let o=this.tree.findLast(a=>a.Point.x<=t);null!=o&&o.item.Point.x>=n;o=this.tree.previous(o)){const a=new x(o.item.Point.x,s);e=Rs.TrySplitHorizontalPoint(e,a,!1),Rs.TrySplitVerticalPoint(o.item,a)}}static TrySplitVerticalPoint(e,t){Rs.Low(e)+q.distanceEpsilon<t.y&&t.y+q.distanceEpsilon<Rs.High(e)&&e.SetNewNext(t)}static TrySplitHorizontalPoint(e,t,n){return n&&e.X+q.distanceEpsilon<t.x&&t.x+q.distanceEpsilon<e.Next.X||!n&&e.Next.X+q.distanceEpsilon<t.x&&t.x+q.distanceEpsilon<e.X?(e.SetNewNext(t),e.Next):e}ProcessHighLinkedPointEvent(e){this.tree.remove(e)}ProcessLowLinkedPointEvent(e){this.tree.insert(e)}InitEventQueue(){this.Queue=new Vo(Vt);for(const e of this.VerticalPoints)this.Queue.Enqueue(e,Rs.Low(e));for(const e of this.HorizontalPoints)this.Queue.Enqueue(e,e.Point.y)}static Low(e){return Math.min(e.Point.y,e.Next.Point.y)}static High(e){return Math.max(e.Point.y,e.Next.Point.y)}}class nc{constructor(e){this.verticesToPathOffsets=new Di,this.Paths=e}MergePaths(){this.InitVerticesToPathOffsetsAndRemoveSelfCycles();for(const e of this.Paths)this.ProcessPath(e)}ProcessPath(e){const t=new Map;let n=null;for(let r=e.PathPoints;null!=r;r=r.Next){const s=this.verticesToPathOffsets.get(r.Point);if(null!=n){if(t.size>0)for(const[o,a]of s){const l=t.get(o);l&&(this.CollapseLoopingPath(o,l,a,e,r),t.delete(o))}for(const[o,a]of n)s.has(o)||t.set(o,a)}n=s}}CollapseLoopingPath(e,t,n,r,s){const o=nc.FindLinkedPointInPath(r,t.Point),a=Array.from(nc.GetPointsInBetween(o,s));nc.Before(t,n)?(this.CleanDisappearedPiece(t,n,e),this.ReplacePiece(t,n,a,e)):(this.CleanDisappearedPiece(n,t,e),this.ReplacePiece(n,t,a.reverse(),e))}static*GetPointsInBetween(e,t){for(let n=e.Next;n!=t;n=n.Next)yield n.Point}ReplacePiece(e,t,n,r){let s=e;for(const o of n){const a=new io(o);s.Next=a,s=a,this.verticesToPathOffsets.get(o).set(r,s)}s.Next=t}CleanDisappearedPiece(e,t,n){for(const r of nc.GetPointsInBetween(e,t))this.verticesToPathOffsets.get(r).delete(n)}static Before(e,t){for(e=e.Next;null!=e;e=e.Next)if(e==t)return!0;return!1}static FindLinkedPointInPath(e,t){for(let n=e.PathPoints;;n=n.Next)if(n.Point.equal(t))return n}InitVerticesToPathOffsetsAndRemoveSelfCycles(){for(const e of this.Paths)for(let t=e.PathPoints;null!=t;t=t.Next){let n=this.verticesToPathOffsets.get(t.Point);n||this.verticesToPathOffsets.set(t.Point,n=new Map);const r=n.get(e);r?(this.CleanDisappearedPiece(r,t,e),r.Next=t.Next):n.set(e,t)}}}class CU{constructor(e){this.projection=e}compare(e,t){return Vt(this.projection(e),this.projection(t))}}class di{static RefinePaths(e,t){di.AdjustPaths(e);const n=di.CreatePathsToFirstLinkedVerticesMap(e);di.Refine(Array.from(n.values())),di.CrossVerticalAndHorizontalSegs(n.values()),di.ReconstructPathsFromLinkedVertices(n),t&&new nc(e).MergePaths()}static AdjustPaths(e){for(const t of e)t.PathPoints=di.AdjustPathPoints(t.PathPoints)}static AdjustPathPoints(e){if(!e||0==e.length)return;const t=[];let n=q.RoundPoint(e[0]);t.push(n);for(let r=1;r<e.length;r++){const s=q.RoundPoint(e[r]);n.equal(s)||(n=s,t.push(n))}return t}static CrossVerticalAndHorizontalSegs(e){const t=new Array,n=new Array;for(const r of e)for(let s=r;null!=s.Next;s=s.Next)ht(s.Point.x,s.Next.Point.x)?n.push(s):t.push(s);new Rs(t,n).SplitPoints()}static ReconstructPathsFromLinkedVertices(e){for(const[t,n]of e)t.PathPoints=n}static Refine(e){di.RefineInDirection(oe.North,e),di.RefineInDirection(oe.East,e)}static*groupByProj(e,t){const n=new Map;for(const r of t){const s=e(r.Point);let o=n.get(s);o||(o=new Array,n.set(s,o)),o.push(r)}for(const r of n.values())yield r}static RefineInDirection(e,t){const n={projectionToPerp:void 0,projectionToDirection:void 0};di.GetProjectionsDelegates(e,n);const r=Array.from(di.GetAllLinkedVertsInDirection(n.projectionToPerp,t)),s=di.groupByProj(n.projectionToPerp,r);for(const o of s)di.RefineCollinearBucket(o,n.projectionToDirection)}static GetProjectionsDelegates(e,t){e==oe.East?(t.projectionToDirection=n=>n.x,t.projectionToPerp=n=>n.y):(t.projectionToPerp=n=>n.x,t.projectionToDirection=n=>n.y)}static*GetAllLinkedVertsInDirection(e,t){for(const n of t)for(let r=n;null!=r.Next;r=r.Next)ht(e(r.Point),e(r.Next.Point))&&(yield r)}static RefineCollinearBucket(e,t){const n=new LE.SortedMap(new CU(t));for(const o of e)n.has(o.Point)||n.set(o.Point,0),n.has(o.Next.Point)||n.set(o.Next.Point,0);const r=new Array(n.size);let s=0;for(const o of n.keys())r[s++]=o;for(s=0;s<r.length;s++)n.set(r[s],s);for(const o of e){s=n.get(o.Point);const a=n.get(o.Next.Point);Math.abs(a-s)>1&&di.InsertPoints(o,r,s,a)}}static InsertPoints(e,t,n,r){n<r?e.InsertVerts(n,r,t):e.InsertVertsInReverse(r,n,t)}static CreatePathsToFirstLinkedVerticesMap(e){const t=new Map;for(const n of e)t.set(n,di.CreateLinkedVertexOfEdgePath(n));return t}static CreateLinkedVertexOfEdgePath(e){const t=e.PathPoints;let n=new io(t[0]);const r=n;for(let s=1;s<t.length;s++)n.Next=new io(t[s]),n=n.Next;return r}}class Aa{constructor(e,t){this.Points=e,this.I=t}static equal(e,t){return e.I==t.I&&e.Points==t.Points}get Start(){return this.Points[this.I]}get End(){return this.Points[this.I+1]}}class ba{constructor(e,t){this.segTree=new Rf(null),this.crossedOutPaths=new Set,this.HierarchyOfObstacles=new Rf(t),this.Paths=e}static RemoveStaircases(e,t){new ba(e,t).Calculate()}Calculate(){let e;this.InitHierarchies();do{e=!1;for(const t of this.Paths.filter(n=>!this.crossedOutPaths.has(n)))this.ProcessPath(t)&&(e=!0)}while(e)}ProcessPath(e){const t={pts:e.PathPoints,canHaveStaircase:!1};return this.ProcessPoints(t)?(e.PathPoints=t.pts,!0):(t.canHaveStaircase||this.crossedOutPaths.add(e),!1)}ProcessPoints(e){const t=this.FindStaircaseStart(e);return!(t<0||(e.pts=this.RemoveStaircasePN(e.pts,t),0))}FindStaircaseStart(e){if(e.canHaveStaircase=!1,e.pts.length<5)return-1;const t=[new Aa(e.pts,0),new Aa(e.pts,1),new Aa(e.pts,2),new Aa(e.pts,3)];let n=0;for(let r=0;;){const s={canHaveStaircaseAtI:!1};if(this.IsStaircase(e.pts,r,t,s))return e.canHaveStaircase=!0,r;if(e.canHaveStaircase=e.canHaveStaircase||s.canHaveStaircaseAtI,r++,e.pts.length<r+5)return-1;t[n]=new Aa(e.pts,r+3),n++,n%=4}}static GetFlippedPoint(e,t){return ht(e[t].y,e[t+1].y)?new x(e[t+4].x,e[t].y):new x(e[t].x,e[t+4].y)}Crossing(e,t,n){return ba.IsCrossing(me.mkPP(e,t),this.segTree,n)}static IsCrossing(e,t,n){for(const r of t.GetAllIntersecting(e.boundingBox))if(-1==n.findIndex(s=>s==r))return!0;return!1}IntersectObstacleHierarchyPPP(e,t,n){return this.IntersectObstacleHierarchyL(me.mkPP(e,t))||this.IntersectObstacleHierarchyL(me.mkPP(t,n))}IntersectObstacleHierarchyL(e){return this.HierarchyOfObstacles.GetAllIntersecting(e.boundingBox).some(t=>null!=te.intersectionOne(e,t,!1))}IsStaircase(e,t,n,r){const s=e[t],o=e[t+1];let a=e[t+2];const l=e[t+3],c=e[t+4];return r.canHaveStaircaseAtI=!1,Ce.DirectionFromPointToPoint(s,o)==Ce.DirectionFromPointToPoint(a,l)&&Ce.DirectionFromPointToPoint(o,a)==Ce.DirectionFromPointToPoint(l,c)&&(a=ba.GetFlippedPoint(e,t),!this.IntersectObstacleHierarchyPPP(o,a,l))&&(r.canHaveStaircaseAtI=!0,!this.Crossing(o,a,n))}RemoveStaircasePN(e,t){const s=Math.abs(e[t].y-e[t+1].y)<q.distanceEpsilon/2;return this.RemoveStaircasePNB(e,t,s)}RemoveStaircasePNB(e,t,n){this.RemoveSegs(e);const r=new Array(e.length-2);!function TU(i,e,t){let n=0;for(;t-- >0;)e[n++]=i[n++]}(e,r,t+1);const s=e[t+1],o=e[t+3];return r[t+1]=n?new x(o.x,s.y):new x(s.x,o.y),function RU(i,e,t,n,r){for(;r-- >0;)t[n++]=i[e++]}(e,t+4,r,t+2,r.length-t-2),this.InsertNewSegs(r,t),r}RemoveSegs(e){for(let t=0;t<e.length-1;t++)this.RemoveSeg(new Aa(e,t))}RemoveSeg(e){this.segTree.Remove(ba.Rect(e),e)}InsertNewSegs(e,t){this.InsSeg(e,t),this.InsSeg(e,t+1)}InitHierarchies(){for(const e of this.Paths)this.InsertPathSegs(e)}InsertPathSegs(e){this.InsertSegs(e.PathPoints)}InsertSegs(e){for(let t=0;t<e.length-1;t++)this.InsSeg(e,t)}InsSeg(e,t){const n=new Aa(e,t);this.segTree.Add(ba.Rect(n),n)}static Rect(e){return De.mkPP(e.Start,e.End)}}class Ht{constructor(e,t,n,r){this.AncestorsSets=r,this.HierarchyOfGroups=fn(Array.from(r.keys()).filter(s=>s.IsGroup).map(s=>Gn(s,s.BoundingBox))),this.Obstacles=n,this.EdgeSeparation=2*t,this.Paths=e,this.HierarchyOfObstacles=fn(n.map(s=>Gn(s,s.boundingBox))),this.MapPathsToTheirObstacles()}get HasGroups(){return null!=this.HierarchyOfGroups&&this.HierarchyOfGroups.Count>0}MapPathsToTheirObstacles(){this.PathToObstacles=new Map;for(const e of this.Paths)this.MapPathToItsObstacles(e)}MapPathToItsObstacles(e){if(!e.PathPoints||0==e.PathPoints.length)return;const t=e.PathPoints,n=this.HierarchyOfObstacles.FirstHitNodeWithPredicate(t[0],Ht.ObstacleTest),r=this.HierarchyOfObstacles.FirstHitNodeWithPredicate(t[t.length-1],Ht.ObstacleTest);null!=n&&null!=r&&this.PathToObstacles.set(e,[n.UserData,r.UserData])}static ObstacleTest(e,t){return te.PointRelativeToCurveLocation(e,t)!=We.Outside?Gt.Stop:Gt.Continue}Calculate(e,t){this.NudgingDirection=e,di.RefinePaths(this.Paths,t),this.GetPathOrdersAndPathGraph(),this.MapAxisEdgesToTheirObstacles(),this.DrawPaths()}MapAxisEdgesToTheirObstacles(){this.axisEdgesToObstaclesTheyOriginatedFrom=new Map;for(const e of this.Paths)this.MapPathEndAxisEdgesToTheirObstacles(e);for(const e of this.Paths)this.UmmapPathInteriourFromStrangerObstacles(e)}UmmapPathInteriourFromStrangerObstacles(e){const t=this.FindFirstUnmappedEdge(e);if(null==t)return;const n=this.FindLastUnmappedEdge(e);for(let r=t;null!=r&&r!=n;r=r.Next)this.axisEdgesToObstaclesTheyOriginatedFrom.delete(r.AxisEdge)}FindLastUnmappedEdge(e){for(let t=e.LastEdge;null!=t;t=t.Prev)if(t.AxisEdge.Direction!=this.NudgingDirection)return t;return null}FindFirstUnmappedEdge(e){for(let t=e.FirstEdge;null!=t;t=t.Next)if(t.AxisEdge.Direction!=this.NudgingDirection)return t;return null}MapPathEndAxisEdgesToTheirObstacles(e){const t=this.PathToObstacles.get(e);t&&(this.ProcessThePathStartToMapAxisEdgesToTheirObstacles(e,t[0]),this.ProcessThePathEndToMapAxisEdgesToTheirObstacles(e,t[1]))}ProcessThePathEndToMapAxisEdgesToTheirObstacles(e,t){for(let n=e.LastEdge;null!=n&&Ce.DirectionsAreParallel(n.Direction,this.NudgingDirection);n=n.Prev)this.axisEdgesToObstaclesTheyOriginatedFrom.set(n.AxisEdge,t)}ProcessThePathStartToMapAxisEdgesToTheirObstacles(e,t){for(let n=e.FirstEdge;null!=n&&Ce.DirectionsAreParallel(n.Direction,this.NudgingDirection);n=n.Next)this.axisEdgesToObstaclesTheyOriginatedFrom.set(n.AxisEdge,t)}GetPathOrdersAndPathGraph(){const e=new $n(this.Paths);this.PathOrders=e.GetOrder(),this.PathVisibilityGraph=e.PathVisibilityGraph}static GetCurvesForShow(e,t){const n=new Array;for(const r of e){const s=new He;for(const o of r.PathPoints)s.addPoint(o);n.push(s)}return n.concat(Array.from(t))}DrawPaths(){this.SetWidthsOfArrowheads(),this.CreateLongestNudgedSegments(),this.FindFreeSpaceInDirection(Array.from(this.PathVisibilityGraph.Edges)),this.MoveLongestSegsIdealPositionsInsideFeasibleIntervals(),this.PositionShiftedEdges()}SetWidthsOfArrowheads(){for(const e of this.Paths)Ht.SetWidthsOfArrowheadsForEdge(e)}static SetWidthsOfArrowheadsForEdge(e){const t=e.GeomEdge;if(null!=t.targetArrowhead){const n=e.LastEdge;n.Width=Math.max(t.targetArrowhead.width,n.Width)}if(null!=t.sourceArrowhead){const n=e.FirstEdge;n.Width=Math.max(t.sourceArrowhead.width,n.Width)}}PositionShiftedEdges(){this.Solver=new wU(this.EdgeSeparation);for(let e=0;e<this.LongestNudgedSegs.length;e++)this.CreateVariablesOfLongestSegment(this.LongestNudgedSegs[e]);this.CreateConstraintsOfTheOrder(),this.CreateConstraintsBetweenLongestSegments(),this.Solver.SolveByRegularSolver(),this.ShiftPathEdges()}MoveLongestSegsIdealPositionsInsideFeasibleIntervals(){for(let e=0;e<this.LongestNudgedSegs.length;e++)Ht.MoveLongestSegIdealPositionsInsideFeasibleInterval(this.LongestNudgedSegs[e])}static MoveLongestSegIdealPositionsInsideFeasibleInterval(e){if(e.IsFixed)return;const t=e.GetLeftBound(),n=e.GetRightBound();e.IdealPosition<t?e.IdealPosition=t:e.IdealPosition>n&&(e.IdealPosition=n)}ShiftPathEdges(){for(const e of this.Paths)e.PathPoints=this.GetShiftedPoints(e)}GetShiftedPoints(e){return Ht.RemoveSwitchbacksAndMiddlePoints(this.GetShiftedPointsSimple(e))}static Rectilinearise(e,t){return e.x==t.x||e.y==t.y?t:Math.abs(e.x-t.x)<Math.abs(e.y-t.y)?new x(e.x,t.y):new x(t.x,e.y)}GetShiftedPointsSimple(e){const t=[],n=e.FirstEdge;t.push(this.ShiftedPoint(n.Source,n.LongestNudgedSegment));for(const r of e.PathEdges())t.push(this.ShiftedEdgePositionOfTarget(r));return t}ShiftedEdgePositionOfTarget(e){return null!=e.LongestNudgedSegment||null==e.Next?this.ShiftedPoint(e.Target,e.LongestNudgedSegment):this.ShiftedPoint(e.Next.Source,e.Next.LongestNudgedSegment)}ShiftedPoint(e,t){if(null==t)return e;const n=this.Solver.GetVariablePosition(t.Id);return this.NudgingDirection==oe.North?new x(n,e.y):new x(e.x,-n)}static LineSegOfLongestSeg(e,t){const n=t==oe.East?s=>s.x:s=>s.y,r={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const s of e.Edges)Ht.UpdateMinMaxWithPoint(r,n,s.Source),Ht.UpdateMinMaxWithPoint(r,n,s.Target);return t==oe.East?new me(r.min,-e.IdealPosition,r.max,-e.IdealPosition):new me(e.IdealPosition,r.min,e.IdealPosition,r.max)}static UpdateMinMaxWithPoint(e,t,n){const r=t(n);e.min>r&&(e.min=r),e.max<r&&(e.max=r)}CreateConstraintsBetweenLongestSegments(){for(const e of this.LongestNudgedSegs)this.CreateConstraintsBetweenLongestSegmentsForSegment(e)}CreateConstraintsBetweenLongestSegmentsForSegment(e){const t=new Set;for(const n of e.Edges){const r=n.AxisEdge;if(null!=r)for(const s of r.RightNeighbors)for(const o of s.LongestNudgedSegments)t.add(o)}for(const n of t)this.ConstraintTwoLongestSegs(e,n)}CreateConstraintsOfTheOrder(){for(const e of this.PathOrders)Ht.ParallelToDirection(e[0],this.NudgingDirection)&&this.CreateConstraintsOfThePathOrder(e[1])}static ParallelToDirection(e,t){switch(t){case oe.North:case oe.South:return ht(e.SourcePoint.x,e.TargetPoint.x);default:return ht(e.SourcePoint.y,e.TargetPoint.y)}}CreateConstraintsOfThePathOrder(e){let t=null;for(const n of e.filter(r=>null!=r.LongestNudgedSegment))null!=t&&this.ConstraintTwoLongestSegs(t.LongestNudgedSegment,n.LongestNudgedSegment),t=n}ConstraintTwoLongestSegs(e,t){(!e.IsFixed||!t.IsFixed)&&this.Solver.AddConstraint(e.Id,t.Id)}CreateVariablesOfLongestSegment(e){if(e.IsFixed)this.Solver.AddFixedVariable(e.Id,Ht.SegmentPosition(e,this.NudgingDirection));else{const t=e.GetLeftBound(),n=e.GetRightBound();t>=n?(this.Solver.AddFixedVariable(e.Id,Ht.SegmentPosition(e,this.NudgingDirection)),e.IsFixed=!0):(this.Solver.AddVariableNNNN(e.Id,Ht.SegmentPosition(e,this.NudgingDirection),e.IdealPosition,e.Width),t!=Number.NEGATIVE_INFINITY&&this.Solver.SetLowBound(t,e.Id),n!=Number.POSITIVE_INFINITY&&this.Solver.SetUpperBound(e.Id,n))}}static SegmentPosition(e,t){return t==oe.North?e.Start.x:-e.Start.y}FindFreeSpaceInDirection(e){this.BoundAxisEdgesByRectsKnownInAdvance(),new ro(this.NudgingDirection,this.Obstacles,this.axisEdgesToObstaclesTheyOriginatedFrom,this.PathOrders,e).FindFreeSpace()}BoundAxisEdgesByRectsKnownInAdvance(){for(const e of this.Paths)this.HasGroups&&this.BoundPathByMinCommonAncestors(e),this.BoundAxisEdgesAdjacentToSourceAndTargetOnEdge(e)}BoundPathByMinCommonAncestors(e){for(const t of this.GetMinCommonAncestors(e.GeomEdge)){const n=t.BoundingBox;for(const r of e.PathEdges()){const s=r.AxisEdge;s.Direction==this.NudgingDirection&&this.BoundAxisEdgeByRect(n,s)}}}GetMinCommonAncestors(e){null==this.PortToShapes&&(this.PortToShapes=Ht.MapPortsToShapes(this.AncestorsSets.keys()));const t=function OU(i,e){const t=new Set;if(i.size<e.size)for(const n of i)e.has(n)&&t.add(n);else for(const n of e)i.has(n)&&t.add(n);return t}(this.AncestorsForPort(e.sourcePort),this.AncestorsForPort(e.targetPort));return Array.from(t).filter(n=>!n.Children.some(r=>t.has(r)))}AncestorsForPort(e){const t=this.PortToShapes.get(e);return t?this.AncestorsSets.get(t):new Set(this.HierarchyOfGroups.AllHitItems(De.mkPP(e.Location,e.Location),null))}BoundAxisEdgeAdjacentToObstaclePort(e,t){null==e.Curve?this.BoundAxisByPoint(e.Location,t):e.Curve.boundingBox.contains(e.Location)&&this.BoundAxisEdgeByRect(e.Curve.boundingBox,t)}BoundAxisByPoint(e,t){null!=t&&t.Direction==this.NudgingDirection&&(this.NudgingDirection==oe.North?(t.BoundFromLeft(e.x),t.BoundFromRight(e.x)):(t.BoundFromLeft(-e.y),t.BoundFromRight(-e.y)))}BoundAxisEdgesAdjacentToSourceAndTargetOnEdge(e){this.BoundAxisEdgeAdjacentToObstaclePort(e.GeomEdge.sourcePort,e.FirstEdge.AxisEdge),this.BoundAxisEdgeAdjacentToObstaclePort(e.GeomEdge.targetPort,e.LastEdge.AxisEdge)}BoundAxisEdgeByRect(e,t){null!=t&&t.Direction==this.NudgingDirection&&(this.NudgingDirection==oe.North?(t.BoundFromLeft(e.left),t.BoundFromRight(e.right)):(t.BoundFromLeft(-1*e.top),t.BoundFromRight(-1*e.bottom)))}CreateLongestNudgedSegments(){const e=this.NudgingDirection==oe.East?t=>-t.y:t=>t.x;this.LongestNudgedSegs=new Array;for(let t=0;t<this.Paths.length;t++)this.CreateLongestNudgedSegmentsForPath(this.Paths[t],e)}CreateLongestNudgedSegmentsForPath(e,t){this.GoOverPathAndCreateLongSegs(e),Ht.CalculateIdealPositionsForLongestSegs(e,t)}static CalculateIdealPositionsForLongestSegs(e,t){let n=null,r=null,s=t(e.Start);for(const o of e.PathEdges())if(null!=o.LongestNudgedSegment){if(n=o.LongestNudgedSegment,null!=r){let a;Ht.SetIdealPositionForSeg(r,a=t(r.start),s,t(n.Start)),s=a,r=null}}else null!=n&&(r=n,n=null);null!=r?Ht.SetIdealPositionForSeg(r,t(r.Start),s,t(e.End)):null!=n&&(n.IdealPosition=t(n.Start))}static SetIdealPositionForSeg(e,t,n,r){const s=Math.max(n,r),o=Math.min(n,r);e.IdealPosition=o+q.distanceEpsilon<t?t<s?.5*(s+o):s:o}GoOverPathAndCreateLongSegs(e){let t=null;const n=Ce.OppositeDir(this.NudgingDirection);for(const r of e.PathEdges()){const s=r.Direction;s==this.NudgingDirection||s==n?(null==t?(r.LongestNudgedSegment=t=new bU(this.LongestNudgedSegs.length),this.LongestNudgedSegs.push(t)):r.LongestNudgedSegment=t,r.IsFixed&&(t.IsFixed=!0)):(r.LongestNudgedSegment=null,t=null)}}static BuildPolylineForPath(e){const t={points:e.PathPoints.map(n=>n.clone())};return Ht.ExtendPolylineToPorts(t,e),t.points}static ExtendPolylineToPorts(e,t){Ht.ExtendPolylineToSourcePort(e,t.GeomEdge.sourcePort.Location),Ht.ExtendPolylineToTargetPort(e,t.GeomEdge.targetPort.Location),e.points.length<2&&(e.points=new Array(2),e.points[0]=t.GeomEdge.sourcePort.Location,e.points[1]=t.GeomEdge.targetPort.Location)}static ExtendPolylineToTargetPort(e,t){const n=e.points.length-1,r=Ce.VectorDirectionPP(e.points[n-1],e.points[n]);if(Ht.ProjectionsAreClose(e.points[n-1],r,t))return void(e.points=e.points.slice(0,n));const s=e.points[n];e.points[n]=r==oe.East||r==oe.West?new x(t.x,s.y):new x(s.x,t.y)}static ProjectionsAreClose(e,t,n){return t==oe.East||t==oe.West?ht(e.x,n.x):ht(e.y,n.y)}static ExtendPolylineToSourcePort(e,t){const n=Ce.VectorDirectionPP(e.points[0],e.points[1]);if(Ht.ProjectionsAreClose(e.points[1],n,t))return void(e.points=e.points.slice(1));const r=e.points[0];e.points[0]=n==oe.East||n==oe.West?new x(t.x,r.y):new x(r.x,t.y)}static RemoveSwitchbacksAndMiddlePoints(e){const t=[];let n=e[0];t.push(n);let r=e[1],s=Ce.VectorDirectionPP(n,r),o=1;for(;++o<e.length;){const a=Ce.VectorDirectionPP(r,e[o]);a==s||Ce.OppositeDir(a)==s||a==oe.None||(x.closeDistEps(n,r)||t.push(n=Ht.Rectilinearise(n,r)),s=a),r=e[o]}return x.closeDistEps(n,r)||t.push(Ht.Rectilinearise(n,r)),t}static NudgePaths(e,t,n,r,s){if(0==e.length)return;const o=new Ht(e,t,n,r);o.Calculate(oe.North,!0),o.Calculate(oe.East,!1),o.Calculate(oe.North,!1),s&&o.RemoveStaircases();for(const a of e)a.GeomEdge.curve=He.mkFromPoints(Ht.BuildPolylineForPath(a))}RemoveStaircases(){ba.RemoveStaircases(this.Paths,this.HierarchyOfObstacles)}static MapPortsToShapes(e){const t=new Map;for(const n of e)for(const r of n.Ports)t.set(r,n);return t}static*GetEdgePathFromPathEdgesAsDebugCurves(e,t,n,r){const s=r.ArrayOfPathPoints(),o=s.length,a=o>1?(t-e)/(o-1):1;for(let l=0;l<s.length-1;l++)yield ot.mkDebugCurveTWCI(200,e+a*l,n,me.mkPP(s[l],s[l+1]))}}class IU{constructor(e,t){this.Crossings=[],this.Location=e,this.Crossings=t}}class Qu{constructor(){this.ListOfPointsAndCrossings=[],this.index=0,this.ListOfPointsAndCrossings=new Array}Count(){return this.ListOfPointsAndCrossings.length}Add(e,t){this.ListOfPointsAndCrossings.push(new IU(e,t))}Pop(){return this.ListOfPointsAndCrossings[this.index++]}CurrentIsBeforeOrAt(e){return!(this.index>=this.ListOfPointsAndCrossings.length)&&fe.ComparePP(this.ListOfPointsAndCrossings[this.index].Location,e)<=0}get First(){return this.ListOfPointsAndCrossings[0]}get Last(){return this.ListOfPointsAndCrossings[this.ListOfPointsAndCrossings.length-1]}Reset(){this.index=0}MergeFrom(e){if(this.Reset(),null==e)return;const t=this.ListOfPointsAndCrossings.length;let n=0;const r=e.ListOfPointsAndCrossings.length;let s=0;const o=new Array(this.ListOfPointsAndCrossings.length);for(;n<t||s<r;){if(n>=t){o.push(e.ListOfPointsAndCrossings[s++]);continue}if(s>=r){o.push(this.ListOfPointsAndCrossings[n++]);continue}const a=this.ListOfPointsAndCrossings[n],l=e.ListOfPointsAndCrossings[s],c=fe.ComparePP(a.Location,l.Location);0==c?(o.push(a),++n,++s):-1==c?(o.push(a),++n):(o.push(l),++s)}this.ListOfPointsAndCrossings=o}Trim(e,t){this.Reset(),null!=this.ListOfPointsAndCrossings&&0!=this.ListOfPointsAndCrossings.length&&(this.ListOfPointsAndCrossings=this.ListOfPointsAndCrossings.filter(n=>fe.ComparePP(n.Location,e)>=0&&fe.ComparePP(n.Location,t)<=0))}static ToCrossingArray(e,t){let n=0;const r=e.length;for(let a=0;a<r;a++)e[a].DirectionToInside==t&&n++;if(0==n)return null;const s=new Array(n);let o=0;for(let a=0;a<r;a++)e[a].DirectionToInside==t&&(s[o++]=e[a]);return s}ToString(){return Hn.String.Format("{0} [{1}]",this.ListOfPointsAndCrossings.length,this.index)}}class Te{static EdgeDirectionVE(e){return Te.EdgeDirectionVV(e.Source,e.Target)}static EdgeDirectionVV(e,t){return fe.GetDirections(e.point,t.point)}static GetEdgeEnd(e,t){return t==Te.EdgeDirectionVE(e)?e.Target:e.Source}static FindAdjacentVertex(e,t){for(const n of e.InEdges)if(fe.GetDirections(e.point,n.SourcePoint)==t)return n.Source;for(const n of e.OutEdges)if(fe.GetDirections(e.point,n.TargetPoint)==t)return n.Target;return null}static FindAdjacentEdge(e,t){for(const n of e.InEdges)if(fe.GetDirections(n.SourcePoint,e.point)==t)return n;for(const n of e.OutEdges)if(fe.GetDirections(e.point,n.TargetPoint)==t)return n;return null}static FindBendPointBetween(e,t,n){return Te.IsVerticalD(n)?new x(t.x,e.y):new x(e.x,t.y)}static SegmentIntersectionPPP(e,t,n){const r=fe.GetDirections(e,t);return Te.IsVerticalD(r)?new x(e.x,n.y):new x(n.x,e.y)}static SegmentIntersectionSP(e,t){return Te.SegmentIntersectionPPP(e.Start,e.End,t)}static SegmentsIntersection(e,t){return Te.IntervalsIntersect(e.Start,e.End,t.Start,t.End)}static SegmentsIntersectLL(e,t){return Te.IntervalsIntersect(e.start,e.end,t.start,t.end)}static IntervalsOverlapSS(e,t){return Te.IntervalsOverlapPPPP(e.Start,e.End,t.Start,t.End)}static IntervalsOverlapPPPP(e,t,n,r){return Te.IntervalsAreCollinear(e,t,n,r)&&fe.ComparePP(e,r)!=fe.ComparePP(t,n)}static IntervalsAreCollinear(e,t,n,r){const s=Te.IsVerticalPP(e,t);return Te.IsVerticalPP(n,r)==s&&(s?fe.Equal(e.x,n.x):fe.Equal(e.y,n.y))}static IntervalsAreSame(e,t,n,r){return fe.EqualPP(e,n)&&fe.EqualPP(t,r)}static IntervalsIntersect(e,t,n,r){const s=Te.SegmentIntersectionPPP(e,t,n);return Te.PointIsOnSegmentPPP(e,t,s)&&Te.PointIsOnSegmentPPP(n,r,s)?s:void 0}static SegmentIntersectionEP(e,t){return Te.SegmentIntersectionPPP(e.SourcePoint,e.TargetPoint,t)}static PointIsOnSegmentPPP(e,t,n){return fe.EqualPP(e,n)||fe.EqualPP(t,n)||fe.GetDirections(e,n)==fe.GetDirections(n,t)}static PointIsOnSegmentSP(e,t){return Te.PointIsOnSegmentPPP(e.Start,e.End,t)}static IsVerticalD(e){return 0!=(e&(oe.North|oe.South))}static IsVerticalE(e){return Te.IsVerticalD(fe.GetDirections(e.SourcePoint,e.TargetPoint))}static IsVerticalPP(e,t){return Te.IsVerticalD(fe.GetDirections(e,t))}static IsVertical(e){return Te.IsVerticalD(fe.GetDirections(e.start,e.end))}static IsAscending(e){return 0!=(e&(oe.North|oe.East))}static Slope(e,t,n){const r=t.sub(e);return r.dot(n.PerpDirectionAsPoint)/r.dot(n.DirectionAsPoint)}static SortAscending(e,t){const n=fe.GetDirections(e,t);return oe.None==n||Te.IsAscending(n)?[e,t]:[t,e]}static RectangleBorderIntersect(e,t,n){switch(n){case oe.North:case oe.South:return new x(t.x,Te.GetRectangleBound(e,n));case oe.East:case oe.West:return new x(Te.GetRectangleBound(e,n),t.y);default:throw new Error}}static GetRectangleBound(e,t){switch(t){case oe.North:return e.top;case oe.South:return e.bottom;case oe.East:return e.right;case oe.West:return e.left;default:throw new Error}}static RectangleInteriorsIntersect(e,t){return fe.Compare(e.bottom,t.top)<0&&fe.Compare(t.bottom,e.top)<0&&fe.Compare(e.left,t.right)<0&&fe.Compare(t.left,e.right)<0}static PointIsInRectangleInterior(e,t){return fe.Compare(e.y,t.top)<0&&fe.Compare(t.bottom,e.y)<0&&fe.Compare(e.x,t.right)<0&&fe.Compare(t.left,e.x)<0}}class qt{constructor(e){this.Dir=e,this.DirectionAsPoint=Ce.toPoint(this.Dir),this.PerpDirection=oe.North==e?oe.East:oe.North,this.PerpDirectionAsPoint=Ce.toPoint(this.PerpDirection),this.OppositeDirection=Ce.OppositeDir(e)}get Dir(){return this.dir}set Dir(e){this.dir=e}get IsHorizontal(){return oe.East==this.Dir}get IsVertical(){return oe.North==this.Dir}Compare(e,t){const n=this.ComparePerpCoord(e,t);return 0!=n?n:this.CompareScanCoord(e,t)}CompareScanCoord(e,t){return fe.Compare(e.sub(t).dot(this.DirectionAsPoint),0)}ComparePerpCoord(e,t){return fe.Compare(e.sub(t).dot(this.PerpDirectionAsPoint),0)}IsFlatS(e){return this.IsFlatPP(e.Start,e.End)}IsFlatPP(e,t){return fe.Equal(t.sub(e).dot(this.PerpDirectionAsPoint),0)}IsPerpendicularS(e){return this.IsPerpendicularPP(e.Start,e.End)}IsPerpendicularPP(e,t){return fe.Equal(t.sub(e).dot(this.DirectionAsPoint),0)}Coord(e){return e.dot(this.DirectionAsPoint)}Min(e,t){return this.Compare(e,t)<=0?e:t}Max(e,t){return this.Compare(e,t)>=0?e:t}get PerpendicularInstance(){return this.IsHorizontal?qt.VerticalInstance:qt.HorizontalInstance}static GetInstance(e){return Te.IsVerticalD(e)?qt.VerticalInstance:qt.HorizontalInstance}ToString(){return this.Dir.toString()}}qt.HorizontalInstance=new qt(oe.East),qt.VerticalInstance=new qt(oe.North);class tt extends UE{constructor(e,t,n,r){super(),this.Update(e,t),this.Weight=n,this.GroupBoundaryPointAndCrossingsList=r}static mk(e,t){return new tt(e,t,tt.NormalWeight,null)}get Start(){return this.startPoint}get End(){return this.endPoint}get IsVertical(){return tt.IsVerticalSegment(this.Start,this.End)}get ScanDirection(){return this.IsVertical?qt.VerticalInstance:qt.HorizontalInstance}get IsOverlapped(){return tt.OverlappedWeight==this.Weight}get IsReflection(){return tt.ReflectionWeight==this.Weight}static IsVerticalSegment(e,t){return e.x==t.x}MergeGroupBoundaryCrossingList(e){null!=e&&(null==this.GroupBoundaryPointAndCrossingsList&&(this.GroupBoundaryPointAndCrossingsList=new Qu),this.GroupBoundaryPointAndCrossingsList.MergeFrom(e))}TrimGroupBoundaryCrossingList(){null!=this.GroupBoundaryPointAndCrossingsList&&this.GroupBoundaryPointAndCrossingsList.Trim(this.Start,this.End)}Update(e,t){this.startPoint=e,this.endPoint=t}SetInitialVisibilityVertex(e){this.LowestVisibilityVertex=e,this.HighestVisibilityVertex=e}AppendVisibilityVertex(e,t){if(null==this.HighestVisibilityVertex)this.AddGroupCrossingsBeforeHighestVisibilityVertex(e,t)||this.SetInitialVisibilityVertex(t);else{if(fe.IsPureLower(t.point,this.HighestVisibilityVertex.point))return;this.AddGroupCrossingsBeforeHighestVisibilityVertex(e,t)||this.AppendHighestVisibilityVertex(t)}}AddVisibilityEdge(e,t){const n=new ci(e,t,this.Weight);return gn.AddEdge(n),n}AppendHighestVisibilityVertex(e){fe.EqualPP(this.HighestVisibilityVertex.point,e.point)||(this.AddVisibilityEdge(this.HighestVisibilityVertex,e),this.HighestVisibilityVertex=e)}LoadStartOverlapVertexIfNeeded(e){if(this.NeedStartOverlapVertex){const t=e.FindVertex(this.Start);this.AppendVisibilityVertex(e,null!=t?t:e.AddVertexP(this.Start))}}LoadEndOverlapVertexIfNeeded(e){if(this.NeedEndOverlapVertex){const t=e.FindVertex(this.End);this.AppendVisibilityVertex(e,null!=t?t:e.AddVertexP(this.End))}}OnSegmentIntersectorBegin(e){this.AppendGroupCrossingsThroughPoint(e,this.Start)||this.LoadStartOverlapVertexIfNeeded(e)}OnSegmentIntersectorEnd(e){this.AppendGroupCrossingsThroughPoint(e,this.End),this.GroupBoundaryPointAndCrossingsList=null,(null==this.HighestVisibilityVertex||fe.IsPureLower(this.HighestVisibilityVertex.point,this.End))&&this.LoadEndOverlapVertexIfNeeded(e)}static Subsume(e,t,n,r,s,o,a,l){return l.extendStart=!0,l.extendEnd=!0,!(null==e.seg||!Te.IntervalsOverlapPPPP(e.seg.Start,e.seg.End,t,n)||(e.seg.Weight!=r?e.seg.Start!=t||e.seg.End!=n||(e.seg.Weight=Math.min(e.seg.Weight,r),0):(l.extendStart=-1==o.CompareScanCoord(t,e.seg.Start),l.extendEnd=1==o.CompareScanCoord(n,e.seg.End),(l.extendStart||l.extendEnd)&&(a.Remove(e.seg),e.seg.startPoint=o.Min(e.seg.Start,t),e.seg.endPoint=o.Max(e.seg.End,n),e.seg=a.InsertUnique(e.seg).item,e.seg.MergeGroupBoundaryCrossingList(s)),0)))}IntersectsSegment(e){return null!=Te.SegmentsIntersection(this,e)}toString(){return"["+this.Start+" -> "+this.End+(this.IsOverlapped?" olap":" free")+"]"}ContainsPoint(e){return fe.EqualPP(this.Start,e)||fe.EqualPP(this.End,e)||fe.GetDirections(this.Start,e)==fe.GetDirections(e,this.End)}get HasSparsePerpendicularCoords(){return null!=this.sparsePerpendicularCoords&&this.sparsePerpendicularCoords.size>0}CreatePointFromPerpCoord(e){return this.IsVertical?new x(this.Start.x,e):new x(e,this.Start.y)}AddSparseVertexCoord(e){null==this.sparsePerpendicularCoords&&(this.sparsePerpendicularCoords=new Set),this.sparsePerpendicularCoords.add(e)}AddSparseEndpoint(e){return!this.sparsePerpendicularCoords.has(e)&&(this.sparsePerpendicularCoords.add(e),!0)}CreateSparseVerticesAndEdges(e){var t;if(null!=this.sparsePerpendicularCoords){this.AppendGroupCrossingsThroughPoint(e,this.Start);for(const n of Array.from(this.sparsePerpendicularCoords.values()).sort(Vt)){const r=this.CreatePointFromPerpCoord(n);this.AppendVisibilityVertex(e,null!==(t=e.FindVertex(r))&&void 0!==t?t:e.AddVertexP(r))}this.AppendGroupCrossingsThroughPoint(e,this.End),this.GroupBoundaryPointAndCrossingsList=null,this.sparsePerpendicularCoords.clear(),this.sparsePerpendicularCoords=null}}HasVisibility(){return null!=this.LowestVisibilityVertex}AddGroupCrossingsBeforeHighestVisibilityVertex(e,t){return!!this.AppendGroupCrossingsThroughPoint(e,t.point)&&(fe.IsPureLower(this.HighestVisibilityVertex.point,t.point)&&(this.AddVisibilityEdge(this.HighestVisibilityVertex,t),this.HighestVisibilityVertex=t),!0)}AppendGroupCrossingsThroughPoint(e,t){var n;if(null==this.GroupBoundaryPointAndCrossingsList)return!1;let r=!1;for(;this.GroupBoundaryPointAndCrossingsList.CurrentIsBeforeOrAt(t);){const s=this.GroupBoundaryPointAndCrossingsList.Pop();let o=null,a=null;fe.ComparePP(s.Location,this.Start)>0&&(o=Qu.ToCrossingArray(s.Crossings,this.ScanDirection.OppositeDirection)),fe.ComparePP(s.Location,this.End)<0&&(a=Qu.ToCrossingArray(s.Crossings,this.ScanDirection.Dir)),r=!0;const l=null!==(n=e.FindVertex(s.Location))&&void 0!==n?n:e.AddVertexP(s.Location);e.AddVertexP(s.Location),null!=o||null!=a?(this.AddLowCrossings(e,l,o),this.AddHighCrossings(e,l,a)):null==this.LowestVisibilityVertex?this.SetInitialVisibilityVertex(l):this.AppendHighestVisibilityVertex(l)}return r}static GetCrossingInteriorVertex(e,t,n){var r;const s=n.GetInteriorVertexPoint(t.point);return null!==(r=e.FindVertex(s))&&void 0!==r?r:e.AddVertexP(s)}AddCrossingEdge(e,t,n,r){let s=null;null!=this.HighestVisibilityVertex&&(fe.EqualPP(this.HighestVisibilityVertex.point,n.point)?s=e.FindEdgePP(t.point,n.point):this.AppendHighestVisibilityVertex(t)),null==s&&(s=this.AddVisibilityEdge(t,n));const o=r.map(l=>l.Group.InputShape),a=s.IsPassable;s.IsPassable=null==a?()=>{for(const l of o)if(l.IsTransparent)return!0;return!1}:()=>{for(const l of o)if(l.IsTransparent||a())return!0;return!1},null==this.LowestVisibilityVertex&&this.SetInitialVisibilityVertex(t),this.HighestVisibilityVertex=n}AddLowCrossings(e,t,n){if(null!=n){const r=tt.GetCrossingInteriorVertex(e,t,n[0]);this.AddCrossingEdge(e,r,t,n)}}AddHighCrossings(e,t,n){if(null!=n){const r=tt.GetCrossingInteriorVertex(e,t,n[0]);this.AddCrossingEdge(e,t,r,n)}}}tt.NormalWeight=ci.DefaultWeight,tt.ReflectionWeight=5,tt.OverlappedWeight=500;class $I{constructor(e,t,n,r,s){this.IsClosed=!1,this.Vertex=e,this.Direction=null!=t?Ce.DirectionFromPointToPoint(t.Vertex.point,e.point):oe.None,this.ResetEntry(t,n,r,s)}ResetEntry(e,t,n,r){this.PreviousEntry=e,this.Length=t,this.NumberOfBends=n,this.Cost=r}get PreviousVertex(){return null==this.PreviousEntry?null:this.PreviousEntry.Vertex}toString(){return this.Vertex.point+" "+this.Direction+" "+this.IsClosed+" "+this.Cost}}class XE{constructor(){this.Clear()}Set(e,t){this.Vertex=e,this.Weight=t}Clear(){this.Vertex=null,this.Weight=Number.NaN}}class Ot{constructor(){this.nextNeighbors=[new XE,new XE,new XE],this.LengthImportance=1,this.BendsImportance=1}CombinedCost(e,t){return this.LengthImportance*e+this.BendsImportance*t}TotalCostFromSourceToVertex(e,t){return this.CombinedCost(e,t)+this.sourceCostAdjustment}InitPath(e,t,n){if(t==n||!this.InitEntryDirectionsAtTarget(n))return!1;this.Target=n,this.Source=t;const r=this.TotalCostFromSourceToVertex(0,0)+this.HeuristicDistanceFromVertexToTarget(t.point,oe.None);return!(r>=this.upperBoundOnCost)&&(this.queue=new Vo(Vt),this.visitedVertices=[t],null==e?this.EnqueueInitialVerticesFromSource(r):this.EnqueueInitialVerticesFromSourceEntries(e),this.queue.count>0)}InitEntryDirectionsAtTarget(e){this.EntryDirectionsToTarget=oe.None;for(const t of e.OutEdges)this.EntryDirectionsToTarget=this.EntryDirectionsToTarget|Ce.DirectionFromPointToPoint(t.TargetPoint,e.point);for(const t of e.InEdges)this.EntryDirectionsToTarget=this.EntryDirectionsToTarget|Ce.DirectionFromPointToPoint(t.SourcePoint,e.point);return this.EntryDirectionsToTarget!=oe.None}static IsInDirs(e,t){return e==(e&t)}MultistageAdjustedCostBound(e){return Number.isFinite(e)?e+this.BendsImportance:e}HeuristicDistanceFromVertexToTarget(e,t){const n=this.Target.point.sub(e);if(ht(n.x,0)&&ht(n.y,0))return this.targetCostAdjustment;const r=Ce.VectorDirection(n);let s;return s=this.GetNumberOfBends(t==oe.None?t=oe.East|oe.North|oe.West|oe.South:t,r),this.CombinedCost(Ot.ManhattanDistance(e,this.Target.point),s)+this.targetCostAdjustment}GetNumberOfBends(e,t){return Ce.IsPureDirection(t)?this.GetNumberOfBendsForPureDirection(e,t):Ot.GetBendsForNotPureDirection(t,e,this.EntryDirectionsToTarget)}GetNumberOfBendsForPureDirection(e,t){return(t&e)==t?Ot.IsInDirs(t,this.EntryDirectionsToTarget)?0:Ot.IsInDirs(Ot.Left(t),this.EntryDirectionsToTarget)||Ot.IsInDirs(Ot.Right(t),this.EntryDirectionsToTarget)?2:4:this.GetNumberOfBendsForPureDirection(Ot.AddOneTurn[e],t)+1}static GetBendsForNotPureDirection(e,t,n){const r=e&t;if(r==oe.None)return Ot.GetBendsForNotPureDirection(e,Ot.AddOneTurn[t],n)+1;const s=e&n;return s==oe.None?Ot.GetBendsForNotPureDirection(e,t,Ot.AddOneTurn[n])+1:(r|s)==e?1:2}static Left(e){switch(e){case oe.None:return oe.None;case oe.North:return oe.West;case oe.East:return oe.North;case oe.South:return oe.East;case oe.West:return oe.South;default:throw new Error("direction")}}static Right(e){switch(e){case oe.None:return oe.None;case oe.North:return oe.East;case oe.East:return oe.South;case oe.South:return oe.West;case oe.West:return oe.North;default:throw new Error("direction")}}static RestorePathV(e){return Ot.RestorePath(e,null)}static RestorePath(e,t){if(null==e.entry)return[];const n=new Array;let r=!1,s=oe.None;for(;;){s==e.entry.Direction?r=!0:(r=!1,n.push(e.entry.Vertex.point),s=e.entry.Direction);const o=e.entry.PreviousEntry;if(null==o||e.entry.Vertex==t)break;e.entry=o}return r&&n.push(e.entry.Vertex.point),n.reverse(),n}QueueReversedEntryToNeighborVertexIfNeeded(e,t,n){const r={numberOfBends:0,length:0},s=t.PreviousVertex,o=Ot.GetLengthAndNumberOfBendsToNeighborVertex(e,s,n,r);if(this.CombinedCost(r.length,r.numberOfBends)<this.CombinedCost(t.Length,t.NumberOfBends)||1==e.Vertex.Degree){const a=this.TotalCostFromSourceToVertex(r.length,r.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(s.point,o);this.EnqueueEntry(e,s,r.length,r.numberOfBends,a)}}UpdateEntryToNeighborVertexIfNeeded(e,t,n){const r={numberOfBends:0,length:0},s=Ot.GetLengthAndNumberOfBendsToNeighborVertex(e,t.Vertex,n,r);if(this.CombinedCost(r.length,r.numberOfBends)<this.CombinedCost(t.Length,t.NumberOfBends)){const o=this.TotalCostFromSourceToVertex(r.length,r.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(t.Vertex.point,s);t.ResetEntry(e,r.length,r.numberOfBends,o),this.queue.DecreasePriority(t,o)}}CreateAndEnqueueEntryToNeighborVertex(e,t,n){const r={numberOfBends:0,length:0},s=Ot.GetLengthAndNumberOfBendsToNeighborVertex(e,t,n,r),o=this.TotalCostFromSourceToVertex(r.length,r.numberOfBends)+this.HeuristicDistanceFromVertexToTarget(t.point,s);o<this.upperBoundOnCost&&(null==t.VertexEntries&&this.visitedVertices.push(t),this.EnqueueEntry(e,t,r.length,r.numberOfBends,o))}EnqueueEntry(e,t,n,r,s){const o=new $I(t,e,n,r,s);t.SetVertexEntry(o),this.queue.Enqueue(o,o.Cost)}static GetLengthAndNumberOfBendsToNeighborVertex(e,t,n,r){r.length=e.Length+Ot.ManhattanDistance(e.Vertex.point,t.point)*n;const s=Ce.DirectionFromPointToPoint(e.Vertex.point,t.point);return r.numberOfBends=e.NumberOfBends,e.Direction!=oe.None&&s!=e.Direction&&r.numberOfBends++,s}static ManhattanDistance(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}GetPathWithCost(e,t,n,r,s,o,a){if(this.upperBoundOnCost=a,this.sourceCostAdjustment=n,this.targetCostAdjustment=o,!this.InitPath(e,t,s))return null;for(;this.queue.count>0;){const l=this.queue.Dequeue(),c=l.Vertex;if(c==this.Target){if(null==r)return this.Cleanup(),l;if(this.EntryDirectionsToTarget==oe.None){let y=0;for(const R of this.Target.VertexEntries)r[y++]=R;return this.Cleanup(),null}this.upperBoundOnCost=Math.min(this.MultistageAdjustedCostBound(l.Cost),this.upperBoundOnCost);continue}l.IsClosed=!0;for(const y of this.nextNeighbors)y.Clear();const u=Ot.Right(l.Direction);this.ExtendPathAlongInEdges(l,c.InEdges,u),this.ExtendPathAlongOutEdges(l,c.OutEdges,u);for(const y of this.nextNeighbors)null!=y.Vertex&&this.ExtendPathToNeighborVertex(l,y.Vertex,y.Weight)}if(null!=r&&null!=this.Target.VertexEntries)for(let l=0;l<this.Target.VertexEntries.length;l++)r[l]=this.Target.VertexEntries[l];return this.Cleanup(),null}ExtendPathAlongInEdges(e,t,n){for(const r of t)this.ExtendPathAlongEdge(e,r,!0,n)}ExtendPathAlongOutEdges(e,t,n){let r=t.isEmpty()?null:t.treeMinimum();for(;null!=r;r=t.next(r))this.ExtendPathAlongEdge(e,r.item,!1,n)}ExtendPathAlongEdge(e,t,n,r){if(!Ot.IsPassable(t))return;const s=n?t.Source:t.Target;if(s==e.PreviousVertex){if(e.Vertex.Degree>1||e.Vertex!=this.Source)return;return void this.ExtendPathToNeighborVertex(e,s,t.Weight)}const o=Ce.DirectionFromPointToPoint(e.Vertex.point,s.point);let a=this.nextNeighbors[2];o!=e.Direction&&(a=this.nextNeighbors[o==r?1:0]),a.Set(s,t.Weight)}EnqueueInitialVerticesFromSource(e){const t=new $I(this.Source,null,0,0,e);for(const n of this.Source.OutEdges)!Ot.IsPassable(n)||this.ExtendPathToNeighborVertex(t,n.Target,n.Weight);for(const n of this.Source.InEdges)!Ot.IsPassable(n)||this.ExtendPathToNeighborVertex(t,n.Source,n.Weight)}EnqueueInitialVerticesFromSourceEntries(e){for(const t of e)null!=t&&this.queue.Enqueue(t,t.Cost)}ExtendPathToNeighborVertex(e,t,n){const r=Ce.DirectionFromPointToPoint(e.Vertex.point,t.point),s=null!=t.VertexEntries?t.VertexEntries[Ce.ToIndex(r)]:null;null==s?this.CreateAndEnqueueReversedEntryToNeighborVertex(e,t,n)||this.CreateAndEnqueueEntryToNeighborVertex(e,t,n):s.IsClosed||this.UpdateEntryToNeighborVertexIfNeeded(e,s,n)}CreateAndEnqueueReversedEntryToNeighborVertex(e,t,n){if(null!=e.Vertex.VertexEntries){const r=Ce.DirectionFromPointToPoint(t.point,e.Vertex.point),s=e.Vertex.VertexEntries[Ce.ToIndex(r)];if(null!=s)return this.QueueReversedEntryToNeighborVertexIfNeeded(e,s,n),!0}return!1}static IsPassable(e){return null==e.IsPassable||e.IsPassable()}Cleanup(){for(const e of this.visitedVertices)e.RemoveVertexEntries();this.visitedVertices=[],this.queue=null}}Ot.DefaultBendPenaltyAsAPercentageOfDistance=4,Ot.AddOneTurn=[oe.None,oe.North|oe.East|oe.West,oe.North|oe.East|oe.South,15,oe.East|oe.South|oe.West,15,15,15,13,15,15,15,15,15,15,15];class Xu{constructor(e){this.bendPenaltyAsAPercentageOfDistance=Ot.DefaultBendPenaltyAsAPercentageOfDistance,this.currentPassTargetEntries=new Array(4),this.bendPenaltyAsAPercentageOfDistance=e}GetPath(e,t){const n={entry:this.GetPathStage(null,e,null,t)};return Ot.RestorePathV(n)}GetPathStage(e,t,n,r){const s=new Ot,o={bestEntry:null,bestCost:Number.MAX_VALUE/tt.OverlappedWeight};let a=Number.POSITIVE_INFINITY;const l=Xu.Barycenter(t),c=Xu.Barycenter(r),u=Ot.ManhattanDistance(l,c);s.BendsImportance=Math.max(.001,u*(.01*this.bendPenaltyAsAPercentageOfDistance));const y=s.LengthImportance,R=null!=n?this.currentPassTargetEntries:null,D=[];for(const W of t)for(const X of r)D.push([W,X]);D.sort(([W,X],[ne,ce])=>L(W,X)-L(ne,ce));for(const[W,X]of D){if(x.closeDistEps(W.point,X.point))continue;const ne=k(W,l)*y,ce=k(X,c)*y;let Ae=o.bestCost;if(null!=n){for(let ke=0;ke<R.length;ke++)R[ke]=null;Ae=s.MultistageAdjustedCostBound(o.bestCost)}const Oe=s.GetPathWithCost(e,W,ne,R,X,ce,Ae);if(null!=R){Xu.UpdateTargetEntriesForEachDirection(n,R,o);continue}if(null==Oe)continue;const Be=Oe.Cost/L(W,X);(Oe.Cost<o.bestCost||ht(Oe.Cost,o.bestCost)&&Be<a)&&(o.bestCost=Oe.Cost,o.bestEntry=Oe,a=Oe.Cost/L(W,X))}return o.bestEntry;function L(W,X){return Ot.ManhattanDistance(W.point,X.point)}function k(W,X){return Ot.ManhattanDistance(W.point,X)}}static UpdateTargetEntriesForEachDirection(e,t,n){for(let r=0;r<t.length;r++){const s=t[r];null!=s&&(null==e[r]||s.Cost<e[r].Cost)&&(e[r]=s,s.Cost<n.bestCost&&(n.bestCost=s.Cost,n.bestEntry=s))}}static Barycenter(e){let t=new x(0,0);for(const n of e)t=t.add(n.point);return t.div(e.length)}}class PU{constructor(e){this.GeomEdge=e}get PathPoints(){return this._pathPoints}set PathPoints(e){this._pathPoints=e}get Width(){return this.GeomEdge.lineWidth}get End(){return this.LastEdge.Target}get Start(){return this.FirstEdge.Source}ArrayOfPathPoints(){return this._pathPoints instanceof io?Array.from(JI(this._pathPoints)):this._pathPoints}*PathEdges(){for(let e=this.FirstEdge;null!=e;e=e.Next)yield e}AddEdge(e){e.Path=this,this.LastEdge.Next=e,e.Prev=this.LastEdge,this.LastEdge=e}SetFirstEdge(e){this.FirstEdge=e,this.LastEdge=e,e.Path=this}toString(){const e=new Hn.StringBuilder;this.PathPoints instanceof io&&e.Append("L");for(const t of JI(this.PathPoints))e.Append(t.toString());return e.ToString()}}function*JI(i){if(i instanceof io)for(let e=i;null!=e;e=e.Next)yield e.Point;else for(const e of i)yield e}class qI extends WE{constructor(e,t,n,r){super(t),this.Slope=0,this.SlopeInverse=0,this.Obstacle=e,this.endVertex=r?t.nextOnPolyline:t.prevOnPolyline,n.IsPerpendicularPP(t.point,this.endVertex.point)||(this.Slope=Te.Slope(t.point,this.endVertex.point,n),this.SlopeInverse=1/this.Slope)}get Obstacle(){return this.obstacle}set Obstacle(e){this.obstacle=e}get EndVertex(){return this.endVertex}}class es extends qI{constructor(e,t,n){super(e,t,n,n.IsHorizontal)}}class Zu extends qI{constructor(e,t,n){super(e,t,n,n.IsVertical)}}let Ts=(()=>{class i{constructor(t,n,r){if(null!=t){if(n){const s=t.BoundingBox.clone();s.pad(r),this.PaddedPolyline=te.polyFromBox(s)}else this.PaddedPolyline=Tr.PaddedPolylineBoundaryOfNode(t.BoundaryCurve,r);i.RoundVerticesAndSimplify(this.PaddedPolyline),this.IsRectangle=this.IsPolylineRectangle(),this.InputShape=t,this.Ports=new Set(this.InputShape.Ports)}}get PaddedPolyline(){return this._PaddedPolyline}set PaddedPolyline(t){this._PaddedPolyline=t}GetPortChanges(t){return t.addedPorts=jl(this.InputShape.Ports,this.Ports),t.removedPorts=jl(this.Ports,this.InputShape.Ports),(0!=t.addedPorts.size||0!=t.removedPorts.size)&&(this.Ports=new Set(this.InputShape.Ports),!0)}get IsInConvexHull(){return null!=this.ConvexHull}get IsGroup(){return null!=this.InputShape&&this.InputShape.IsGroup}get VisibilityBoundingBox(){return this.VisibilityPolyline.boundingBox}get VisibilityPolyline(){return null!=this.ConvexHull?this.ConvexHull.Polyline:this.PaddedPolyline}static CreateSentinel(t,n,r,s){const o=i.mk(t,n,s);return o.CreateInitialSides(o.PaddedPolyline.startPoint,r),o}CreateInitialSides(t,n){this.ActiveLowSide=new es(this,t,n),this.ActiveHighSide=new Zu(this,t,n),n.IsFlatS(this.ActiveHighSide)&&(this.ActiveHighSide=new Zu(this,this.ActiveHighSide.EndVertex,n))}static mk(t,n,r){const s=new i(null,!1,0);return s.PaddedPolyline=He.mkClosedFromPoints([q.RoundPoint(t),q.RoundPoint(n)]),s.Ordinal=r,s}IsPolylineRectangle(){if(4!=this.PaddedPolyline.count)return!1;let t=this.PaddedPolyline.startPoint,n=t.nextOnPolyline,r=Ce.VectorDirectionPP(t.point,n.point);if(!Ce.IsPureDirection(r))return!1;do{t=n,n=t.nextOnPolyline;const s=Ce.DirectionFromPointToPoint(t.point,n.point);if(s!=Ce.RotateRight(r))return!1;r=s}while(t!=this.PaddedPolyline.startPoint);return!0}static RoundVerticesAndSimplify(t){let n=t.startPoint;do{n.point=q.RoundPoint(n.point),n=n.nextOnPolyline}while(n!=t.startPoint);i.RemoveCloseAndCollinearVerticesInPlace(t),t.setInitIsRequired()}get IsPrimaryObstacle(){return null==this.ConvexHull||this==this.ConvexHull.PrimaryObstacle}static RemoveCloseAndCollinearVerticesInPlace(t){const n=10*q.intersectionEpsilon;for(let r=t.startPoint.next;null!=r;r=r.next)x.close(r.prev.point,r.point,n)&&(null==r.next?t.RemoveEndPoint():(r.prev.next=r.next,r.next.prev=r.prev));return x.close(t.start,t.end,n)&&t.RemoveStartPoint(),Tt.RemoveCollinearVertices(t),null!=t.endPoint.prev&&t.endPoint.prev!=t.startPoint&&x.getTriangleOrientation(t.endPoint.prev.point,t.end,t.start)==Ie.Collinear&&t.RemoveEndPoint(),null!=t.startPoint.next&&t.endPoint.prev!=t.startPoint&&x.getTriangleOrientation(t.end,t.start,t.startPoint.next.point)==Ie.Collinear&&t.RemoveStartPoint(),t.setInitIsRequired(),t}get isOverlapped(){return null!=this.clump&&this.clump.length>0}get IsSentinel(){return null==this.InputShape}IsInSameClump(t){return this.isOverlapped&&this.clump==t.clump}Close(){this.ActiveLowSide=null,this.ActiveHighSide=null}SetConvexHull(t){this.clump=null,this.IsRectangle=!1,this.ConvexHull=t,this.looseVisibilityPolyline=null}static CreateLoosePolyline(t){const n=Tr.CreatePaddedPolyline(t,10*q.intersectionEpsilon);return i.RoundVerticesAndSimplify(n),n}get IsTransparentAncestor(){return null!=this.InputShape&&this.InputShape.IsTransparent}set IsTransparentAncestor(t){this.InputShape.IsTransparent=t}}return i.FirstSentinelOrdinal=1,i.FirstNonSentinelOrdinal=10,i})();class NU{constructor(e,t,n,r){this.IsOverlapped=!1,this.unpaddedToPaddedBorderWeight=tt.NormalWeight,this.ObstaclePort=e,this.UnpaddedBorderIntersect=t,this.OutwardDirection=n;const s=me.mkPP(this.UnpaddedBorderIntersect,Te.RectangleBorderIntersect(e.Obstacle.VisibilityBoundingBox,this.UnpaddedBorderIntersect,n)),o=te.getAllIntersections(s,e.Obstacle.VisibilityPolyline,!0);this.VisibilityBorderIntersect=q.RoundPoint(o[0].x);const a={pacList:null};this.MaxVisibilitySegment=r.CreateMaxVisibilitySegment(this.VisibilityBorderIntersect,this.OutwardDirection,a),this.pointAndCrossingsList=a.pacList,(this.Obstacle.isOverlapped||this.Obstacle.IsGroup&&!this.Obstacle.IsInConvexHull)&&(this.IsOverlapped=r.IntersectionIsInsideAnotherObstacle(null,this.Obstacle,this.VisibilityBorderIntersect,qt.GetInstance(this.OutwardDirection)),(!this.Obstacle.IsGroup||this.IsOverlapped||this.InteriorEdgeCrossesObstacle(r))&&(this.unpaddedToPaddedBorderWeight=tt.OverlappedWeight)),this.Obstacle.IsInConvexHull&&this.unpaddedToPaddedBorderWeight==tt.NormalWeight&&this.SetUnpaddedToPaddedBorderWeightFromHullSiblingOverlaps(r)}get Obstacle(){return this.ObstaclePort.Obstacle}get InitialWeight(){return this.IsOverlapped?tt.OverlappedWeight:tt.NormalWeight}get IsCollinearWithPort(){return Ce.IsPureDirection(fe.GetDirections(this.VisibilityBorderIntersect,this.ObstaclePort.Location))}get IsVertical(){return Te.IsVertical(this.MaxVisibilitySegment)}get WantVisibilityIntersection(){return!this.IsOverlapped&&this.CanExtend&&(!this.ObstaclePort.HasCollinearEntrances||this.IsCollinearWithPort)}get CanExtend(){return fe.GetDirections(this.MaxVisibilitySegment.start,this.MaxVisibilitySegment.end)!=oe.None}SetUnpaddedToPaddedBorderWeightFromHullSiblingOverlaps(e){(this.Obstacle.IsGroup?this.InteriorEdgeCrossesObstacle(e):this.InteriorEdgeCrossesConvexHullSiblings())&&(this.unpaddedToPaddedBorderWeight=tt.OverlappedWeight)}InteriorEdgeCrossesObstacle(e){const t=De.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect);return this.InteriorEdgeCrossesObstacleRFI(t,n=>n.VisibilityPolyline,Array.from(e.Root.GetLeafRectangleNodesIntersectingRectangle(t)).filter(n=>!n.UserData.IsGroup&&n.UserData!=this.Obstacle).map(n=>n.UserData))}InteriorEdgeCrossesConvexHullSiblings(){const e=De.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect);return this.InteriorEdgeCrossesObstacleRFI(e,t=>t.PaddedPolyline,this.Obstacle.ConvexHull.Obstacles.filter(t=>t!=this.Obstacle))}InteriorEdgeCrossesObstacleRFI(e,t,n){let r=null;for(const s of n){const o=t(s);if(Te.RectangleInteriorsIntersect(e,o.boundingBox)&&(r=null!=r?r:me.mkPP(this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect),null!=te.intersectionOne(r,o,!1)||We.Outside!=te.PointRelativeToCurveLocation(this.UnpaddedBorderIntersect,o)))return!0}return!1}get HasGroupCrossings(){return null!=this.pointAndCrossingsList&&this.pointAndCrossingsList.Count()>0}HasGroupCrossingBeforePoint(e){if(!this.HasGroupCrossings)return!1;const t=Te.IsAscending(this.OutwardDirection)?this.pointAndCrossingsList.First:this.pointAndCrossingsList.Last;return fe.GetDirections(this.MaxVisibilitySegment.start,t.Location)==fe.GetDirections(t.Location,e)}AddToAdjacentVertex(e,t,n,r){let s=e.VisGraph.FindVertex(this.VisibilityBorderIntersect);null==s?(this.OutwardDirection==fe.GetDirections(t.point,this.VisibilityBorderIntersect)?(this.VisibilityBorderIntersect=t.point,s=t):(s=e.FindOrAddVertex(this.VisibilityBorderIntersect),e.FindOrAddEdge(s,t,this.InitialWeight)),this.ExtendEdgeChain(e,s,t,n,r)):this.ExtendEdgeChain(e,s,s,n,r)}ExtendEdgeChain(e,t,n,r,s){e.ExtendEdgeChainVRLPB(n,r,this.MaxVisibilitySegment,this.pointAndCrossingsList,this.IsOverlapped);const o=e.FindOrAddVertex(this.UnpaddedBorderIntersect);e.FindOrAddEdge(o,t,this.unpaddedToPaddedBorderWeight),s&&e.ConnectVertexToTargetVertex(this.ObstaclePort.CenterVertex,o,this.OutwardDirection,this.InitialWeight)}toString(){return Hn.String.Format("{0} {1}~{2} {3}",this.ObstaclePort.Location,this.UnpaddedBorderIntersect,this.VisibilityBorderIntersect,this.OutwardDirection)}}class _U{constructor(e,t){this.HasCollinearEntrances=!1,this.VisibilityRectangle=De.mkEmpty(),this.Port=e,this.Obstacle=t,this.PortEntrances=new Array,this.Location=q.RoundPoint(this.Port.Location)}CreatePortEntrance(e,t,n){const r=new NU(this,e,t,n);this.PortEntrances.push(r),this.VisibilityRectangle.add(r.MaxVisibilitySegment.end),this.HasCollinearEntrances=this.HasCollinearEntrances||r.IsCollinearWithPort}ClearVisibility(){this.PortEntrances=[]}AddToGraph(e,t){t&&(this.CenterVertex=e.FindOrAddVertex(this.Location))}RemoveFromGraph(){this.CenterVertex=null}get LocationHasChanged(){return!x.closeDistEps(this.Location,q.RoundPoint(this.Port.Location))}get PortCurve(){return this.Port.Curve}get PortLocation(){return this.Port.Location}toString(){return this.Port+this.Obstacle.toString()}}class DU{constructor(e,t){this.maxVisibilitySegmentsAndCrossings=new Array(4),this.OutOfBoundsDirectionFromGraph=oe.None,this.GetVertex(e,t)}get Point(){return this.Vertex.point}get InitialWeight(){return this.IsOverlapped?tt.OverlappedWeight:tt.NormalWeight}get IsOutOfBounds(){return oe.None!=this.OutOfBoundsDirectionFromGraph}GetVertex(e,t){this.Vertex=e.FindOrAddVertex(t)}AddEdgeToAdjacentEdge(e,t,n,r){const s=Te.SegmentIntersectionEP(t,this.Point);let o=e.VisGraph.FindVertex(s);return null!=o?this.AddToAdjacentVertex(e,o,n,r):o=e.AddEdgeToTargetEdge(this.Vertex,t,s),this.ExtendEdgeChain(e,o,n,r),o}AddToAdjacentVertex(e,t,n,r){fe.EqualPP(this.Point,t.point)||e.FindOrAddEdge(this.Vertex,t,this.InitialWeight),this.ExtendEdgeChain(e,t,n,r)}ExtendEdgeChain(e,t,n,r){let s=this.IsOverlapped;s&&(s=e.ObstacleTree.PointIsInsideAnObstaclePD(t.point,n));const o=this.GetSegmentAndCrossings(this.IsOverlapped?t:this.Vertex,n,e);e.ExtendEdgeChainVRLPB(t,r,o[0],o[1],s)}GetSegmentAndCrossings(e,t,n){const r=Ce.ToIndex(t);let s=this.maxVisibilitySegmentsAndCrossings[r];if(null==s){const o={pacList:null};s=[n.ObstacleTree.CreateMaxVisibilitySegment(e.point,t,o),o.pacList],this.maxVisibilitySegmentsAndCrossings[r]=s}else fe.GetDirections(e.point,s[0].start)==t&&(s[0].start=e.point);return s}MaxVisibilityInDirectionForNonOverlappedFreePoint(e,t){return this.GetSegmentAndCrossings(this.Vertex,e,t)[0].end}AddOobEdgesFromGraphCorner(e,t){const n=fe.GetDirections(t,this.Vertex.point),r=e.VisGraph.FindVertex(t);e.ConnectVertexToTargetVertex(r,this.Vertex,n&(oe.North|oe.South),tt.NormalWeight),e.ConnectVertexToTargetVertex(r,this.Vertex,n&(oe.East|oe.West),tt.NormalWeight)}RemoveFromGraph(){this.Vertex=null}toString(){return this.Vertex.toString()}}class ZE{constructor(e,t){this.BoundaryWidth=q.distanceEpsilon,this.Group=e,this.DirectionToInside=t}GetInteriorVertexPoint(e){return q.RoundPoint(e.add(Ce.toPoint(this.DirectionToInside).mul(this.BoundaryWidth)))}toString(){return Hn.String.Format("{0} {1}",this.DirectionToInside,this.Group)}}ZE.BoundaryWidth=q.distanceEpsilon;class ew extends to{constructor(e){super(),this.site=e}get Site(){return this.site}}class Hf extends Ql{constructor(e,t){super(t),this.Obstacle=e}}class Yf extends Hf{constructor(e,t){super(e,t)}}class xU{constructor(e){this.Coord=e}AddPendingPerpendicularCoord(e){null==this.pendingPerpCoords&&(this.pendingPerpCoords=new Array),this.pendingPerpCoords.push(e)}ResetForIntersections(){this.CurrentSegment=this.FirstSegment}get IsHorizontal(){return!this.FirstSegment.IsVertical}TraverseToSegmentContainingPoint(e){if(this.CurrentSegment.ContainsPoint(e))return!0;if(!fe.Equal(this.Coord,this.IsHorizontal?e.y:e.x)){for(;this.MoveNext(););return!1}for(;;){if((null==this.CurrentSegment.NextSegment||fe.GetDirections(this.CurrentSegment.End,e)==fe.GetDirections(e,this.CurrentSegment.NextSegment.Start))&&x.closeIntersections(this.CurrentSegment.End,e))return this.CurrentSegment.Update(this.CurrentSegment.Start,e),!0;if(!this.MoveNext())return!1;if(this.CurrentSegment.ContainsPoint(e))return!0;if(fe.IsPureLower(e,this.CurrentSegment.Start))return this.CurrentSegment.Update(e,this.CurrentSegment.End),!0}}MoveNext(){return this.CurrentSegment=this.CurrentSegment.NextSegment,this.HasCurrent}get HasCurrent(){return null!=this.CurrentSegment}PointIsCurrentEndAndNextStart(e){return e.equal(this.CurrentSegment.End)&&null!=this.CurrentSegment.NextSegment&&e.equal(this.CurrentSegment.NextSegment.Start)}AddPerpendicularCoord(e){const t=this.IsHorizontal?new x(e,this.Coord):new x(this.Coord,e);this.TraverseToSegmentContainingPoint(t),this.CurrentSegment.AddSparseVertexCoord(e)}toString(){return null==this.FirstSegment?"-0- "+this.Coord:this.IsHorizontal?"(H) Y == "+this.Coord:"(V) X == "}AppendScanSegment(e){null==this.FirstSegment?this.FirstSegment=e:this.CurrentSegment.NextSegment=e,this.CurrentSegment=e}AddPendingPerpendicularCoordsToScanSegments(){if(null!=this.pendingPerpCoords){this.ResetForIntersections();for(const e of this.pendingPerpCoords)this.AddPerpendicularCoord(e)}}}class QI{constructor(e,t){this.CurrentSlotIndex=0,this.vector=[],this.IsHorizontal=t;const n=Array.from(e).sort((r,s)=>r>s?1:r<s?-1:0);for(const r of n)this.vector.push(new xU(r))}get Length(){return this.vector.length}get CurrentSlot(){return this.vector[this.CurrentSlotIndex]}Item(e){return this.vector[e]}CreateScanSegment(e,t,n,r){this.CurrentSlot.AppendScanSegment(new tt(e,t,n,r))}ScanSegmentsCompleteForCurrentSlot(){this.CurrentSlotIndex++}ScanSegmentsComplete(){for(const e of this.vector)e.AddPendingPerpendicularCoordsToScanSegments()}Items(){return this.vector}ResetForIntersections(){for(const e of this.vector)e.ResetForIntersections()}FindNearest(e,t){let n=0,r=this.vector.length-1;if(e<=this.vector[n].Coord)return n;if(e>=this.vector[r].Coord)return r;for(;r-n>2;){const s=n+(r-n>>1),o=this.vector[s];if(e<o.Coord)r=s;else{if(!(e>o.Coord))return s;n=s}}for(n++;n<=r;n++){const s=this.vector[n];if(e<s.Coord)return t>0?n:n-1;if(e==s.Coord)break}return n}CreateSparseVerticesAndEdges(e){for(const t of this.vector){t.ResetForIntersections();for(let n=t.FirstSegment;null!=n;n=n.NextSegment)n.CreateSparseVerticesAndEdges(e)}}GetParallelCoord(e){return this.IsHorizontal?e.y:e.x}GetPerpendicularCoord(e){return this.IsHorizontal?e.x:e.y}ConnectAdjoiningSegmentEndpoints(){for(const e of this.vector){e.ResetForIntersections();let t=e.FirstSegment;for(let n=t.NextSegment;null!=n;n=n.NextSegment){if(n.HasSparsePerpendicularCoords&&t.HasSparsePerpendicularCoords&&n.Start==t.End){const r=this.GetPerpendicularCoord(n.Start);t.AddSparseEndpoint(r),n.AddSparseEndpoint(r)}t=n}}}toString(){return(this.IsHorizontal?"(H) count":"(V) count == ")+this.vector.length}}class Ca extends to{constructor(e,t,n){super(),this.InitialObstacle=e,this.ReflectingObstacle=t,this.site=n}static mk(e,t,n){const r=new Ca(e.ReflectingObstacle,t,n);return r.PreviousSite=e,r}IsStaircaseStep(e){return this.InitialObstacle==e}get Site(){return this.site}}class XI{constructor(){this.eventTree=new GE((e,t)=>this.Compare(e,t))}Reset(e){this.scanDirection=e}Enqueue(e){this.eventTree.Enqueue(e)}Dequeue(){return this.eventTree.Dequeue()}get Count(){return this.eventTree.Count}Compare(e,t){if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;let n=this.scanDirection.ComparePerpCoord(e.Site,t.Site);return n||(n=(e instanceof Ca?0:1)-(t instanceof Ca?0:1),n||this.scanDirection.CompareScanCoord(e.Site,t.Site))}}class ZI{constructor(){this.pointCrossingMap=new Di,this.pointList=new Array}AddIntersection(e,t,n){let r=this.pointCrossingMap.get(e);r||(r=new Array,this.pointCrossingMap.set(e,r));const s=r.length;for(let a=0;a<s;a++){const l=r[a];if(l.Group==t)return l}const o=new ZE(t,n);return r.push(o),o}Clear(){this.pointCrossingMap.clear()}GetOrderedListBetween(e,t){if(0==this.pointCrossingMap.size)return null;if(fe.ComparePP(e,t)>0){const s=e;e=t,t=s}this.pointList=[];for(const s of this.pointCrossingMap.keys())fe.ComparePP(s,e)>=0&&fe.ComparePP(s,t)<=0&&this.pointList.push(s);this.pointList.sort((s,o)=>s.compareTo(o));const n=new Qu,r=this.pointList.length;for(let s=0;s<r;s++){const o=this.pointList[s];n.Add(o,this.pointCrossingMap.get(o))}return n}toString(){return Hn.String.Format("{0}",this.pointCrossingMap.size)}}class eP extends Ca{constructor(e,t,n){super(e.ReflectingObstacle,t.Obstacle,n),this.Side=t}}class LU{constructor(e){this.staleSites=new Array,this.scanDirection=e,this.eventTree=new Xi((t,n)=>this.CompareBB(t,n)),this.findFirstPred=t=>this.CompareToFindFirstPoint(t.Site)>=0}Add(e){this.eventTree.insert(e)}MarkStaleSite(e){this.staleSites.push(e)}RemoveStaleSites(){const e=this.staleSites.length;if(e>0){for(let t=0;t<e;t++)this.RemoveExact(this.staleSites[t]);this.staleSites=[]}}RemoveSitesForFlatBottom(e,t){for(let n=this.FindFirstInRange(e,t);null!=n;n=this.FindNextInRange(n,t))this.MarkStaleSite(n.item);this.RemoveStaleSites()}Find(e){return this.FindFirstInRange(e,e)}RemoveExact(e){const t=this.eventTree.find(e);return null!=t&&t.item.Site==e.Site&&(this.eventTree.deleteNodeInternal(t),!0)}FindFirstInRange(e,t){this.findFirstPoint=e;const n=this.eventTree.findFirst(this.findFirstPred);return null!=n&&this.Compare(n.item.Site,t)<=0?n:null}CompareToFindFirstPoint(e){return this.Compare(e,this.findFirstPoint)}FindNextInRange(e,t){const n=this.eventTree.next(e);return null!=n&&this.Compare(n.item.Site,t)<=0?n:null}CompareBB(e,t){return this.scanDirection.CompareScanCoord(e.Site,t.Site)}Compare(e,t){return this.scanDirection.CompareScanCoord(e,t)}}class tP extends Hf{constructor(e,t){super(e,t)}}class nP extends Hf{constructor(e,t){super(e,t)}}class iP extends Hf{constructor(e,t){super(e,t)}}class rP extends Ca{constructor(e,t,n){super(e.ReflectingObstacle,t.obstacle,n),this.Side=t}}class sP{get LowNeighborSide(){return null==this.LowNeighbor?null:this.LowNeighbor.item}get HighNeighborSide(){return null==this.HighNeighbor?null:this.HighNeighbor.item}Clear(){this.LowNeighbor=null,this.LowOverlapEnd=null,this.GroupSideInterveningBeforeLowNeighbor=null,this.HighNeighbor=null,this.HighOverlapEnd=null,this.GroupSideInterveningBeforeHighNeighbor=null}SetSides(e,t,n,r){if(Te.IsAscending(e))return this.HighNeighbor=t,this.HighOverlapEnd=n,void(this.GroupSideInterveningBeforeHighNeighbor=r);this.LowNeighbor=t,this.LowOverlapEnd=n,this.GroupSideInterveningBeforeLowNeighbor=r}}class oP{constructor(e,t){this.Polyline=e,this.Obstacles=Array.from(t),this.PrimaryObstacle=this.Obstacles[0],Ts.RoundVerticesAndSimplify(this.Polyline)}}class ic{static MungeClosestIntersectionInfo(e,t,n){const r=t.seg1.boundingBox,s=q.RoundPoint(t.x).clone();return n?new x(ic.MungeIntersect(e.x,s.x,r.left,r.right),s.y):new x(s.x,ic.MungeIntersect(e.y,s.y,r.bottom,r.top))}static MungeIntersect(e,t,n,r){if(e<t){const s=Math.min(n,r);t<s&&(t=s)}else if(e>t){const s=Math.max(n,r);t>s&&(t=s)}return q.RoundDouble(t)}}class Qt{constructor(){this.CurrentGroupBoundaryCrossingMap=new ZI,this.overlapPairs=new Qr,this.hasOverlaps=!1,this.lookupIntPair=new mt(-1,-1)}get GraphBox(){return this.Root.irect}Init(e,t,n){this.CreateObstacleListAndOrdinals(e),this.AncestorSets=t,this.CreateRoot(),this.shapeIdToObstacleMap=n}CreateObstacleListAndOrdinals(e){this.allObstacles=Array.from(e);let t=Ts.FirstNonSentinelOrdinal;for(const n of this.allObstacles)n.Ordinal=t++}OrdinalToObstacle(e){return this.allObstacles[e-Ts.FirstNonSentinelOrdinal]}CreateRoot(){this.Root=Qt.CalculateHierarchy(this.GetAllObstacles()),this.OverlapsExist()&&(this.AccreteClumps(),this.AccreteConvexHulls(),this.GrowGroupsToAccommodateOverlaps(),this.Root=Qt.CalculateHierarchy(this.GetAllObstacles().filter(e=>e.IsPrimaryObstacle)))}OverlapsExist(){return null!=this.Root&&(hi(this.Root,this.Root,(e,t)=>this.CheckForInitialOverlaps(e,t)),this.hasOverlaps)}OverlapPairAlreadyFound(e,t){return this.lookupIntPair.x=t.Ordinal,this.lookupIntPair.y=e.Ordinal,this.overlapPairs.has(this.lookupIntPair)}CheckForInitialOverlaps(e,t){if(this.hasOverlaps)return;const n={bIsInsideA:!1,aIsInsideB:!1};Qt.ObstaclesIntersect(e,t,n)?this.hasOverlaps=!0:!n.aIsInsideB&&!n.bIsInsideA||e.IsGroup&&t.IsGroup||e.IsGroup&&n.bIsInsideA||t.IsGroup&&n.aIsInsideB||(this.hasOverlaps=!0)}AccreteClumps(){this.AccumulateObstaclesForClumps(),this.CreateClumps()}AccreteConvexHulls(){for(;;)if(this.AccumulateObstaclesForConvexHulls(),!this.CreateConvexHulls())return}static CalculateHierarchy(e){return fn(Array.from(e).map(n=>Gn(n,n.VisibilityBoundingBox)))}AccumulateObstaclesForClumps(){this.overlapPairs.clear();const e=Qt.CalculateHierarchy(this.GetAllObstacles().filter(t=>!t.IsGroup&&t.IsRectangle));null!=e&&Zi(e,e,(t,n)=>this.EvaluateOverlappedPairForClump(t,n))}EvaluateOverlappedPairForClump(e,t){if(e==t||this.OverlapPairAlreadyFound(e,t))return;const n={bIsInsideA:!1,aIsInsideB:!1};!Qt.ObstaclesIntersect(e,t,n)&&!n.aIsInsideB&&!n.bIsInsideA||this.overlapPairs.add(new mt(e.Ordinal,t.Ordinal))}AccumulateObstaclesForConvexHulls(){this.overlapPairs.clear();const e=Qt.CalculateHierarchy(this.GetAllObstacles().filter(t=>t.IsPrimaryObstacle&&!t.IsGroup));null!=e&&Zi(e,e,(t,n)=>this.EvaluateOverlappedPairForConvexHull(t,n))}EvaluateOverlappedPairForConvexHull(e,t){if(e==t||this.OverlapPairAlreadyFound(e,t))return;const n={bIsInsideA:!1,aIsInsideB:!1};!Qt.ObstaclesIntersect(e,t,n)&&!n.aIsInsideB&&!n.bIsInsideA||!e.IsInConvexHull&&!t.IsInConvexHull&&e.IsRectangle&&t.IsRectangle||(this.overlapPairs.add(new mt(e.Ordinal,t.Ordinal)),this.AddClumpToConvexHull(e),this.AddClumpToConvexHull(t),this.AddConvexHullToConvexHull(e),this.AddConvexHullToConvexHull(t))}GrowGroupsToAccommodateOverlaps(){for(;;)if(this.AccumulateObstaclesForGroupOverlaps(),!this.GrowGroupsToResolveOverlaps())return}AccumulateObstaclesForGroupOverlaps(){const e=Qt.CalculateHierarchy(this.GetAllObstacles().filter(n=>n.IsGroup)),t=Qt.CalculateHierarchy(this.GetAllObstacles().filter(n=>n.IsPrimaryObstacle));null==e||null==t||Zi(e,t,(n,r)=>this.EvaluateOverlappedPairForGroup(n,r))}EvaluateOverlappedPairForGroup(e,t){if(e==t||this.OverlapPairAlreadyFound(e,t))return;const n={bIsInsideA:!1,aIsInsideB:!1},r=Qt.ObstaclesIntersect(e,t,n);if(r||n.aIsInsideB||n.bIsInsideA){if(e.IsRectangle&&t.IsRectangle)return void(t.IsGroup||(n.aIsInsideB||Qt.FirstRectangleContainsACornerOfTheOther(t.VisibilityBoundingBox,e.VisibilityBoundingBox))&&(t.OverlapsGroupCorner=!0));!r&&(t.IsGroup||n.bIsInsideA)||this.overlapPairs.add(new mt(e.Ordinal,t.Ordinal))}}static FirstRectangleContainsACornerOfTheOther(e,t){return e.contains(t.leftBottom)||e.contains(t.leftTop)||e.contains(t.rightTop)||e.contains(t.rightBottom)}static FirstPolylineStartIsInsideSecondPolyline(e,t){return te.PointRelativeToCurveLocation(e.start,t)!=We.Outside}AddClumpToConvexHull(e){if(e.isOverlapped){for(const t of e.clump.filter(n=>n.Ordinal!=e.Ordinal))this.overlapPairs.add(new mt(e.Ordinal,t.Ordinal));e.clump=[]}}AddConvexHullToConvexHull(e){if(e.IsInConvexHull){for(const t of e.ConvexHull.Obstacles.filter(n=>n.Ordinal!=e.Ordinal))this.overlapPairs.add(new mt(e.Ordinal,t.Ordinal));e.ConvexHull.Obstacles=[]}}CreateClumps(){const t=Bu(Tf(Array.from(this.overlapPairs.values())));for(const n of t){if(1==n.length)continue;const r=n.map(s=>this.OrdinalToObstacle(s));for(const s of r)s.clump=r}}CreateConvexHulls(){let e=!1;const n=Bu(Tf(Array.from(this.overlapPairs.values())));for(const r of n){if(1==r.length)continue;e=!0;const s=r.map(this.OrdinalToObstacle),o=Yu(s,l=>Array.from(l.VisibilityPolyline)),a=new oP(Zr.createConvexHullAsClosedPolyline(o),s);for(const l of s)l.SetConvexHull(a)}return e}GrowGroupsToResolveOverlaps(){let e=!1;for(const t of this.overlapPairs.values()){e=!0;const n=this.OrdinalToObstacle(t.x),r=this.OrdinalToObstacle(t.y);Qt.ResolveGroupAndGroupOverlap(n,r)||Qt.ResolveGroupAndObstacleOverlap(n,r)}return this.overlapPairs.clear(),e}static ResolveGroupAndGroupOverlap(e,t){return!!t.IsGroup&&(e.VisibilityPolyline.boundingBox.area>t.VisibilityPolyline.boundingBox.area?Qt.ResolveGroupAndObstacleOverlap(e,t):Qt.ResolveGroupAndObstacleOverlap(t,e),!0)}static ResolveGroupAndObstacleOverlap(e,t){let n=t.looseVisibilityPolyline;Qt.GrowGroupAroundLoosePolyline(e,n);const r={bIsInsideA:!1,aIsInsideB:!1};for(;Qt.ObstaclesIntersect(t,e,r)||!r.aIsInsideB;)n=Ts.CreateLoosePolyline(n),Qt.GrowGroupAroundLoosePolyline(e,n)}static GrowGroupAroundLoosePolyline(e,t){const n=Array.from(e.VisibilityPolyline).concat(Array.from(t));e.SetConvexHull(new oP(Zr.createConvexHullAsClosedPolyline(n),[e]))}static ObstaclesIntersect(e,t,n){return te.CurvesIntersect(e.VisibilityPolyline,t.VisibilityPolyline)?(n.aIsInsideB=!1,n.bIsInsideA=!1,!0):(n.aIsInsideB=Qt.FirstPolylineStartIsInsideSecondPolyline(e.VisibilityPolyline,t.VisibilityPolyline),n.bIsInsideA=!n.aIsInsideB&&Qt.FirstPolylineStartIsInsideSecondPolyline(t.VisibilityPolyline,e.VisibilityPolyline),!(e.IsRectangle&&t.IsRectangle||!Qt.ObstaclesAreCloseEnoughToBeConsideredTouching(e,t,n.aIsInsideB,n.bIsInsideA)||(n.aIsInsideB=!1,n.bIsInsideA=!1,0)))}static ObstaclesAreCloseEnoughToBeConsideredTouching(e,t,n,r){if(!n&&!r)return te.CurvesIntersect(e.looseVisibilityPolyline,t.VisibilityPolyline);const s=n?e.looseVisibilityPolyline:t.looseVisibilityPolyline,o=n?t.VisibilityPolyline:e.VisibilityPolyline;for(const a of s)if(te.PointRelativeToCurveLocation(a,o)==We.Outside){const l=te.ClosestPoint(o,a);if(!x.closeIntersections(a,l))return!0}return!1}AdjustSpatialAncestors(){if(this.SpatialAncestorsAdjusted)return!1;for(const t of this.GetAllGroups()){const n=t.VisibilityBoundingBox;for(const r of this.Root.GetNodeItemsIntersectingRectangle(n))if(r!=t&&te.ClosedCurveInteriorsIntersect(r.VisibilityPolyline,t.VisibilityPolyline)){if(r.IsInConvexHull)for(const s of r.ConvexHull.Obstacles)this.AncestorSets.get(s.InputShape).add(t.InputShape);this.AncestorSets.get(r.InputShape).add(t.InputShape)}}let e=new Array;for(const t of this.Root.GetAllLeaves()){const n=t.VisibilityBoundingBox;e=e.concat(Array.from(this.AncestorSets.get(t.InputShape)).filter(r=>!n.intersects(this.shapeIdToObstacleMap.get(r).VisibilityBoundingBox)));for(const r of e)this.AncestorSets.get(t.InputShape).delete(r);e=[]}return this.SpatialAncestorsAdjusted=!0,!0}GetAllGroups(){return this.GetAllObstacles().filter(e=>e.IsGroup)}Clear(){this.Root=null,this.AncestorSets=null}CreateMaxVisibilitySegment(e,t,n){const r=Te.RectangleBorderIntersect(this.GraphBox,e,t);if(fe.GetDirections(e,r)==oe.None)return n.pacList=null,me.mkPP(e,e);const s=this.RestrictSegmentWithObstacles(e,r);return n.pacList=this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(s.start,s.end),s}GetAllObstacles(){return this.allObstacles}GetAllPrimaryObstacles(){return this.Root.GetAllLeaves()}IntersectionIsInsideAnotherObstacle(e,t,n,r){return this.insideHitTestIgnoreObstacle1=t,this.insideHitTestIgnoreObstacle2=e,this.insideHitTestScanDirection=r,null!=this.Root.FirstHitNodeWithPredicate(n,this.InsideObstacleHitTest.bind(this))}PointIsInsideAnObstaclePD(e,t){return this.PointIsInsideAnObstacle(e,qt.GetInstance(t))}PointIsInsideAnObstacle(e,t){return this.insideHitTestIgnoreObstacle1=null,this.insideHitTestIgnoreObstacle2=null,this.insideHitTestScanDirection=t,null!=this.Root.FirstHitNodeWithPredicate(e,this.InsideObstacleHitTest.bind(this))}InsideObstacleHitTest(e,t){if(t==this.insideHitTestIgnoreObstacle1||t==this.insideHitTestIgnoreObstacle2||t.IsGroup||!Te.PointIsInRectangleInterior(e,t.VisibilityBoundingBox))return Gt.Continue;const n=Te.RectangleBorderIntersect(t.VisibilityBoundingBox,e,this.insideHitTestScanDirection.dir).add(this.insideHitTestScanDirection.DirectionAsPoint),r=Te.RectangleBorderIntersect(t.VisibilityBoundingBox,e,this.insideHitTestScanDirection.OppositeDirection).sub(this.insideHitTestScanDirection.DirectionAsPoint),s=me.mkPP(r,n),o=te.getAllIntersections(s,t.VisibilityPolyline,!0);if(2==o.length){const a=q.RoundPoint(o[0].x),l=q.RoundPoint(o[1].x);if(!fe.EqualPP(e,a)&&!fe.EqualPP(e,l)&&e.compareTo(a)!=e.compareTo(l)&&!ht(Math.floor(o[0].par1),Math.floor(o[1].par1)))return Gt.Stop}return Gt.Continue}SegmentCrossesAnObstacle(e,t){this.stopAtGroups=!0,this.wantGroupCrossings=!1;const n=this.RestrictSegmentPrivate(e,t);return!fe.EqualPP(n.end,t)}SegmentCrossesANonGroupObstacle(e,t){this.stopAtGroups=!1,this.wantGroupCrossings=!1;const n=this.RestrictSegmentPrivate(e,t);return!fe.EqualPP(n.end,t)}RestrictSegmentWithObstacles(e,t){return this.stopAtGroups=!1,this.wantGroupCrossings=!0,this.RestrictSegmentPrivate(e,t)}RestrictSegmentPrivate(e,t){return this.GetRestrictedIntersectionTestSegment(e,t),this.currentRestrictedRay=me.mkPP(e,t),this.restrictedRayLengthSquared=e.sub(t).lengthSquared,this.CurrentGroupBoundaryCrossingMap.Clear(),this.RecurseRestrictRayWithObstacles(this.Root),this.currentRestrictedRay}GetRestrictedIntersectionTestSegment(e,t){const n=fe.GetDirections(e,t),s=oe.West==n?this.GraphBox.left:oe.East==n?this.GraphBox.right:t.x,a=oe.South==n?this.GraphBox.bottom:oe.North==n?this.GraphBox.top:e.y;this.restrictedIntersectionTestSegment=me.mkPP(new x(oe.West==n?this.GraphBox.right:oe.East==n?this.GraphBox.left:e.x,oe.South==n?2*this.GraphBox.top:oe.North==n?this.GraphBox.bottom:e.y),new x(s,a))}RecurseRestrictRayWithObstacles(e){if(!Te.RectangleInteriorsIntersect(this.currentRestrictedRay.boundingBox,e.irect))return;const t=e.UserData;if(null!=t){const n=te.getAllIntersections(this.restrictedIntersectionTestSegment,t.VisibilityPolyline,!0);return!t.IsGroup||this.stopAtGroups?void this.LookForCloserNonGroupIntersectionToRestrictRay(n):void(this.wantGroupCrossings&&this.AddGroupIntersectionsToRestrictedRay(t,n))}this.RecurseRestrictRayWithObstacles(e.Left),this.RecurseRestrictRayWithObstacles(e.Right)}LookForCloserNonGroupIntersectionToRestrictRay(e){let t=0,n=null,r=this.restrictedRayLengthSquared;const s=fe.GetDirections(this.restrictedIntersectionTestSegment.start,this.restrictedIntersectionTestSegment.end);for(const o of e){const a=q.RoundPoint(o.x),l=fe.GetDirections(this.currentRestrictedRay.start,a);if(l==Ce.OppositeDir(s))continue;if(t++,oe.None==l){r=0,n=o;continue}const c=a.sub(this.currentRestrictedRay.start).lengthSquared;if(c<r){if(o.x.sub(this.currentRestrictedRay.start).lengthSquared<q.squareOfDistanceEpsilon)continue;r=c,n=o}}if(null!=n){if(1==t){const o=q.RoundPoint(n.x);if(x.closeIntersections(o,this.currentRestrictedRay.start)||x.closeIntersections(o,this.currentRestrictedRay.end))return}this.restrictedRayLengthSquared=r,this.currentRestrictedRay.end=ic.MungeClosestIntersectionInfo(this.currentRestrictedRay.start,n,!Te.IsVerticalPP(this.currentRestrictedRay.start,this.currentRestrictedRay.end))}}AddGroupIntersectionsToRestrictedRay(e,t){for(const n of t){const r=q.RoundPoint(n.x);if(r.sub(this.currentRestrictedRay.start).lengthSquared>this.restrictedRayLengthSquared)continue;const o=fe.GetDirections(this.currentRestrictedRay.start,this.currentRestrictedRay.end);let c=o;0!=(Ce.VectorDirection(n.seg1.derivative(n.par1))&Ce.RotateRight(o))&&(c=Ce.OppositeDir(c)),this.CurrentGroupBoundaryCrossingMap.AddIntersection(r,e,c)}}}class MU{constructor(e,t){this.scanDirection=e,this.SideTree=new Xi((n,r)=>this.Compare(n,r)),this.linePositionAtLastInsertOrRemove=t}Insert(e,t){return this.linePositionAtLastInsertOrRemove=t,this.SideTree.insert(e)}get Count(){return this.SideTree.count}Remove(e,t){this.linePositionAtLastInsertOrRemove=t,this.SideTree.remove(e)}Find(e){return-1==this.scanDirection.ComparePerpCoord(this.linePositionAtLastInsertOrRemove,e.Start)?null:this.SideTree.find(e)}NextLowB(e){return this.NextLowR(this.Find(e))}NextLowR(e){return this.SideTree.previous(e)}NextHighB(e){return this.NextHighR(this.Find(e))}NextHighR(e){return this.SideTree.next(e)}Next(e,t){return Te.IsAscending(e)?this.SideTree.next(t):this.SideTree.previous(t)}Lowest(){return this.SideTree.treeMinimum()}Compare(e,t){if(e.Obstacle==t.Obstacle)return e==t?0:e instanceof es?-1:1;const n=tw.ScanLineIntersectSidePBS(this.linePositionAtLastInsertOrRemove,e,this.scanDirection),r=tw.ScanLineIntersectSidePBS(this.linePositionAtLastInsertOrRemove,t,this.scanDirection);let s=n.compareTo(r);return 0==s&&(s=function p3(i,e){return(i?1:0)-(e?1:0)}(e instanceof es,t instanceof es),0==s&&(s=Vt(e.Obstacle.Ordinal,t.Obstacle.Ordinal))),s}}class Uf{constructor(e){this.lookupSegment=tt.mk(new x(0,0),new x(0,1)),this.ScanDirection=e,this.segmentTree=new Xi((t,n)=>this.Compare(t,n)),this.findIntersectorPred=t=>this.CompareIntersector(t),this.findPointPred=t=>this.CompareToPoint(t)}get Segments(){return this.segmentTree.allNodes()}InsertUnique(e){this.AssertValidSegmentForInsertion(e);const t=this.segmentTree.find(e);return null!=t?t:this.segmentTree.insert(e)}AssertValidSegmentForInsertion(e){}Remove(e){this.segmentTree.remove(e)}Find(e,t){this.lookupSegment.Update(e,t);const n=this.segmentTree.find(this.lookupSegment);return null!=n&&fe.EqualPP(n.item.End,t)?n.item:null}FindLowestIntersector(e,t){const n=this.FindLowestIntersectorNode(e,t);return null!=n?n.item:null}FindLowestIntersectorNode(e,t){this.lookupSegment.Update(e,e);let n=this.segmentTree.findLast(this.findIntersectorPred);if(fe.EqualPP(e,t))null!=n&&this.ScanDirection.Compare(n.item.End,e)<0&&(n=null);else for(this.lookupSegment.Update(e,t);null!=n&&!n.item.IntersectsSegment(this.lookupSegment);){if(this.ScanDirection.Compare(n.item.Start,t)>0)return null;n=this.segmentTree.next(n)}return n}FindHighestIntersector(e,t){this.lookupSegment.Update(t,t);let n=this.segmentTree.findLast(this.findIntersectorPred);if(fe.EqualPP(e,t))null!=n&&this.ScanDirection.Compare(n.item.End,e)<0&&(n=null);else for(this.lookupSegment.Update(e,t);null!=n&&!n.item.IntersectsSegment(this.lookupSegment);){if(this.ScanDirection.Compare(n.item.End,e)<0)return null;n=this.segmentTree.previous(n)}return null!=n?n.item:null}CompareIntersector(e){return this.ScanDirection.Compare(e.Start,this.lookupSegment.Start)<=0}FindSegmentContainingPoint(e,t){return this.FindSegmentOverlappingPoints(e,e,t)}FindSegmentOverlappingPoints(e,t,n){this.lookupSegment.Update(e,t);const r=this.segmentTree.findFirst(this.findPointPred);if(null!=r){const s=r.item;if(this.ScanDirection.Compare(s.Start,t)<=0)return s}return null}CompareToPoint(e){return this.ScanDirection.Compare(e.End,this.lookupSegment.Start)>=0}MergeAndRemoveNextNode(e,t){return-1==this.ScanDirection.Compare(e.End,t.item.End)&&e.Update(e.Start,t.item.End),e.MergeGroupBoundaryCrossingList(t.item.GroupBoundaryPointAndCrossingsList),this.segmentTree.deleteNodeInternal(t),this.segmentTree.find(e)}MergeSegments(){if(this.segmentTree.count<2)return;let e=this.segmentTree.treeMinimum(),t=this.segmentTree.next(e);for(;null!=t;t=this.segmentTree.next(e))switch(this.ScanDirection.Compare(t.item.Start,e.item.End)){case 1:e=t;break;case 0:t.item.IsOverlapped==e.item.IsOverlapped?e=this.MergeAndRemoveNextNode(e.item,t):(e.item.NeedEndOverlapVertex=!0,t.item.NeedStartOverlapVertex=!0,e=t);break;default:if(e.item.IsOverlapped!=t.item.IsOverlapped){if(e.item.IsOverlapped)e.item.Start==t.item.Start?e=this.MergeAndRemoveNextNode(t.item,e):(e.item.Update(e.item.Start,t.item.Start),e=t);else if(e.item.End==t.item.End)e=this.MergeAndRemoveNextNode(e.item,t);else{const r=t.item,s=e.item;this.segmentTree.deleteNodeInternal(t),r.Update(s.End,r.End),this.segmentTree.insert(r),r.TrimGroupBoundaryCrossingList(),e=this.segmentTree.find(s)}break}e=this.MergeAndRemoveNextNode(e.item,t)}}Compare(e,t){if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;let n=this.ScanDirection.Compare(e.Start,t.Start);return 0==n&&(n=-1*this.ScanDirection.Compare(e.End,t.End)),n}}class FU extends Xl{constructor(e){super(e)}SetVertexEntry(e){null==this.VertexEntries&&(this.VertexEntries=new Array(4)),this.VertexEntries[Ce.ToIndex(e.Direction)]=e}RemoveVertexEntries(){this.VertexEntries=null}}let tw=(()=>{class i{constructor(t){this.ObstacleTree=new Qt,this.CurrentGroupBoundaryCrossingMap=new ZI,this.LowNeighborSides=new sP,this.HighNeighborSides=new sP,this.ScanDirection=qt.HorizontalInstance,this.eventQueue=new XI,this.HorizontalScanSegments=new Uf(qt.HorizontalInstance),this.VerticalScanSegments=new Uf(qt.VerticalInstance),this.wantReflections=t}get ParallelScanSegments(){return this.ScanDirection.IsHorizontal?this.HorizontalScanSegments:this.VerticalScanSegments}get PerpendicularScanSegments(){return this.ScanDirection.IsHorizontal?this.VerticalScanSegments:this.HorizontalScanSegments}static NewVisibilityGraph(){const t=new gn;return t.VertexFactory=n=>new FU(n),t}GenerateVisibilityGraph(){if(null==this.ObstacleTree.Root)return;this.InitializeEventQueue(qt.HorizontalInstance);let t=Ts.FirstSentinelOrdinal,n=new x(this.ObstacleTree.GraphBox.left-i.SentinelOffset,this.ObstacleTree.GraphBox.bottom-i.SentinelOffset),r=new x(this.ObstacleTree.GraphBox.left-i.SentinelOffset,this.ObstacleTree.GraphBox.top+i.SentinelOffset),s=Ts.CreateSentinel(n,r,this.ScanDirection,t++);this.scanLine.Insert(s.ActiveHighSide,this.ObstacleTree.GraphBox.leftBottom),n=new x(this.ObstacleTree.GraphBox.right+i.SentinelOffset,this.ObstacleTree.GraphBox.bottom-i.SentinelOffset),r=new x(this.ObstacleTree.GraphBox.right+i.SentinelOffset,this.ObstacleTree.GraphBox.top+i.SentinelOffset),s=Ts.CreateSentinel(n,r,this.ScanDirection,t++),this.scanLine.Insert(s.ActiveLowSide,this.ObstacleTree.GraphBox.leftBottom),this.ProcessEvents(),this.InitializeEventQueue(qt.VerticalInstance),n=new x(this.ObstacleTree.GraphBox.left-i.SentinelOffset,this.ObstacleTree.GraphBox.bottom-i.SentinelOffset),r=new x(this.ObstacleTree.GraphBox.right+i.SentinelOffset,this.ObstacleTree.GraphBox.bottom-i.SentinelOffset),s=Ts.CreateSentinel(n,r,this.ScanDirection,t++),this.scanLine.Insert(s.ActiveHighSide,this.ObstacleTree.GraphBox.leftBottom),n=new x(this.ObstacleTree.GraphBox.left-i.SentinelOffset,this.ObstacleTree.GraphBox.top+i.SentinelOffset),r=new x(this.ObstacleTree.GraphBox.right+i.SentinelOffset,this.ObstacleTree.GraphBox.top+i.SentinelOffset),s=Ts.CreateSentinel(n,r,this.ScanDirection,t),this.scanLine.Insert(s.ActiveLowSide,this.ObstacleTree.GraphBox.leftBottom),this.ProcessEvents()}static ScanLineIntersectSidePBS(t,n,r){const s=n.Direction;let o=n.Start.x,a=n.Start.y;return r.IsHorizontal?(o+=s.x/s.y*(t.y-n.Start.y),o=ic.MungeIntersect(t.x,o,n.Start.x,n.End.x),a=t.y):(o=t.x,a+=s.y/s.x*(t.x-n.Start.x),a=ic.MungeIntersect(t.y,a,n.Start.y,n.End.y)),new x(o,a)}GetOpenVertex(t){let n=t.startPoint,r=this.TraversePolylineForEvents(n),s=this.PointCompare(r.point,n.point);for(;;r=this.TraversePolylineForEvents(r)){const o=this.PointCompare(r.point,n.point);if(o<=0)n=r;else if(o>0&&s<=0)break;s=o}return n}TraversePolylineForEvents(t){return this.ScanDirection.IsHorizontal?t.nextOnPolyline:t.prevOnPolyline}InitializeEventQueue(t){this.ScanDirection=t,this.eventQueue.Reset(this.ScanDirection),this.EnqueueBottomVertexEvents(),this.scanLine=new MU(this.ScanDirection,this.ObstacleTree.GraphBox.leftBottom),this.lookaheadScan=new LU(this.ScanDirection)}EnqueueBottomVertexEvents(){for(const t of this.ObstacleTree.GetAllPrimaryObstacles()){const n=this.GetOpenVertex(t.VisibilityPolyline);this.eventQueue.Enqueue(new Yf(t,n))}}IsFlat(t){return this.ScanDirection.IsFlatS(t)}IsPerpendicular(t){return this.ScanDirection.IsPerpendicularS(t)}ScanLineIntersectSide(t,n){return i.ScanLineIntersectSidePBS(t,n,this.ScanDirection)}SideReflectsUpward(t){return t instanceof es?this.ScanDirection.Coord(t.End)>this.ScanDirection.Coord(t.Start):this.ScanDirection.Coord(t.End)<this.ScanDirection.Coord(t.Start)}SideReflectsDownward(t){return t instanceof es?this.ScanDirection.Coord(t.End)<this.ScanDirection.Coord(t.Start):this.ScanDirection.Coord(t.End)>this.ScanDirection.Coord(t.Start)}StoreLookaheadSite(t,n,r,s){if(this.wantReflections&&!this.IsPerpendicular(n)){if(!s&&!Te.PointIsInRectangleInterior(r,n.Obstacle.VisibilityBoundingBox))return;this.SideReflectsUpward(n)&&null==this.lookaheadScan.Find(r)&&this.lookaheadScan.Add(new Ca(t,n.Obstacle,r))}}LoadReflectionEvents(t){this.LoadReflectionEventsBB(t,t)}LoadReflectionEventsBB(t,n){if(null==t||this.SideReflectsUpward(t)||this.IsPerpendicular(t))return;const r=De.mkPP(t.Start,t.End),s=De.mkPP(n.Start,n.End);if(this.ScanDirection.IsHorizontal?!r.intersectsOnX(s):!r.intersectsOnY(s))return;const o=De.intersect(r,s),l=o.rightTop;let c=this.lookaheadScan.FindFirstInRange(o.leftBottom,l);for(;null!=c;){const u=i.ScanLineIntersectSidePBS(c.item.Site,t,this.ScanDirection.PerpendicularInstance);this.ScanDirection.ComparePerpCoord(u,c.item.Site)>0?this.AddReflectionEvent(c.item,t,u):c.item.ReflectingObstacle!=t.Obstacle&&this.lookaheadScan.MarkStaleSite(c.item),c=this.lookaheadScan.FindNextInRange(c,l)}this.lookaheadScan.RemoveStaleSites()}AddPerpendicularReflectionSegment(t,n,r){if(this.lookaheadScan.RemoveExact(t.PreviousSite)){if(null==n)return!1;if(t.PreviousSite.IsStaircaseStep(t.ReflectingObstacle)){if(!Te.PointIsInRectangleInterior(t.Site,t.ReflectingObstacle.VisibilityBoundingBox)||!this.InsertPerpendicularReflectionSegment(t.PreviousSite.Site,t.Site))return!1;if(null!=r&&t.IsStaircaseStep(r.Obstacle))return this.ScanLineCrossesObstacle(t.Site,r.Obstacle)}}return!1}AddParallelReflectionSegment(t,n,r,s){{const o=this.ScanLineIntersectSide(s.Site,null!=n?n:r),a=null!=n?o:s.Site,l=null!=n?s.Site:o;return null==n?n=this.scanLine.NextLowB(r).item:r=this.scanLine.NextHighB(n).item,this.InsertParallelReflectionSegment(a,l,t,n,r,s)}}AddReflectionEvent(t,n,r){this.eventQueue.Enqueue(null!=n?new rP(t,n,r):new eP(t,n,r))}AddSideToScanLine(t,n){const r=this.scanLine.Insert(t,n);return this.LoadReflectionEvents(t),r}RemoveSideFromScanLine(t,n){this.scanLine.Remove(t.item,n)}PointCompare(t,n){return this.ScanDirection.Compare(t,n)}Clear(){this.ObstacleTree.Clear(),this.eventQueue=new XI,this.HorizontalScanSegments=new Uf(qt.HorizontalInstance),this.VerticalScanSegments=new Uf(qt.VerticalInstance),this.VisibilityGraph=null}ProcessEvents(){for(;this.eventQueue.Count>0;){const t=this.eventQueue.Dequeue();t instanceof Yf?this.ProcessEventO(t):t instanceof tP?this.ProcessEventLB(t):t instanceof nP?this.ProcessEventHB(t):t instanceof iP?this.ProcessEventCV(t):t instanceof rP?this.ProcessEventLR(t):t instanceof eP?this.ProcessEventHR(t):this.ProcessCustomEvent(t),this.LowNeighborSides.Clear(),this.HighNeighborSides.Clear()}}ProcessCustomEvent(t){}ScanLineCrossesObstacle(t,n){return this.ScanDirection.ComparePerpCoord(t,n.VisibilityBoundingBox.leftBottom)>0&&this.ScanDirection.ComparePerpCoord(t,n.VisibilityBoundingBox.rightTop)<0}FindInitialNeighborSides(t,n){n.lowNborSideNode=this.scanLine.NextLowR(t),n.highNborSideNode=this.scanLine.NextHighR(t)}FindNeighborsBRR(t,n,r){this.LowNeighborSides.Clear(),this.HighNeighborSides.Clear(),this.FindNeighbors(t,n,this.LowNeighborSides),this.FindNeighbors(t,r,this.HighNeighborSides)}FindNeighbors(t,n,r){const s=t instanceof Yf?n.item.Start:n.item.End,o={lowNborSideNode:null,highNborSideNode:null};this.FindInitialNeighborSides(n,o),this.SkipToNeighbor(this.ScanDirection.OppositeDirection,n.item,s,o.lowNborSideNode,r),this.SkipToNeighbor(this.ScanDirection.Dir,n.item,s,o.highNborSideNode,r)}SkipToNeighbor(t,n,r,s,o){let a=null,l=null;for(;;s=this.scanLine.Next(t,s))if(s.item.Obstacle!=n.Obstacle){if(s.item.Obstacle.IsGroup){this.ProcessGroupSideEncounteredOnTraversalToNeighbor(s,r,t)&&null==l&&(l=s.item);continue}if(s.item instanceof Zu==Te.IsAscending(t)){this.ScanLineCrossesObstacle(r,s.item.Obstacle)&&(a=s,l=null);continue}break}o.SetSides(t,s,a,l)}ProcessGroupSideEncounteredOnTraversalToNeighbor(t,n,r){if(!this.ScanLineCrossesObstacle(n,t.item.Obstacle))return!1;const s=t.item instanceof es==Te.IsAscending(r)?r:Ce.OppositeDir(r),o=this.ScanLineIntersectSide(n,t.item);return this.CurrentGroupBoundaryCrossingMap.AddIntersection(o,t.item.Obstacle,s),!0}FindNeighborsAndProcessVertexEvent(t,n,r){this.CurrentGroupBoundaryCrossingMap.Clear(),this.FindNeighborsBRR(r,t,n),this.ProcessVertexEvent(t,n,r),this.CurrentGroupBoundaryCrossingMap.Clear()}ProcessEventO(t){var n,r;const s=t.Obstacle;s.CreateInitialSides(t.Vertex,this.ScanDirection),this.AddSideToScanLine(s.ActiveLowSide,t.Site);const o=this.AddSideToScanLine(s.ActiveHighSide,t.Site),a=this.scanLine.Find(s.ActiveLowSide);this.FindNeighborsAndProcessVertexEvent(a,o,t);const l=null!==(n=this.LowNeighborSides.GroupSideInterveningBeforeLowNeighbor)&&void 0!==n?n:this.LowNeighborSides.LowNeighborSide;this.SideReflectsUpward(l)&&this.LoadReflectionEvents(s.ActiveLowSide);const c=null!==(r=this.HighNeighborSides.GroupSideInterveningBeforeHighNeighbor)&&void 0!==r?r:this.HighNeighborSides.HighNeighborSide;if(this.SideReflectsUpward(c)&&this.LoadReflectionEvents(s.ActiveHighSide),s.ActiveHighSide.Start!=s.ActiveLowSide.Start){const u=new Zu(s,t.Vertex,this.ScanDirection);this.lookaheadScan.RemoveSitesForFlatBottom(u.Start,u.End)}this.EnqueueLowBendVertexEvent(s.ActiveLowSide),this.EnqueueHighBendOrCloseVertexEvent(s.ActiveHighSide)}ProcessEventLB(t){const n=t.Obstacle,r=new es(n,t.Vertex,this.ScanDirection);this.ScanDirection.ComparePerpCoord(r.End,r.Start)>0&&(this.RemoveSideFromScanLine(this.scanLine.Find(n.ActiveLowSide),t.Site),this.AddSideToScanLine(r,t.Site),n.ActiveLowSide=r,this.EnqueueLowBendVertexEvent(r))}EnqueueLowBendVertexEvent(t){this.eventQueue.Enqueue(new tP(t.Obstacle,t.EndVertex))}ProcessEventHB(t){const n=t.Obstacle,r=new Zu(n,t.Vertex,this.ScanDirection);this.RemoveSideFromScanLine(this.scanLine.Find(n.ActiveHighSide),t.Site);const s=this.AddSideToScanLine(r,t.Site);if(n.ActiveHighSide=r,this.EnqueueHighBendOrCloseVertexEvent(n.ActiveHighSide),this.wantReflections&&this.ScanDirection.IsHorizontal&&r.Start.x==n.VisibilityBoundingBox.right&&this.SideReflectsUpward(r)){const o=this.scanLine.NextHighR(s);o.item instanceof es&&this.SideReflectsDownward(o.item)&&(!n.isOverlapped||!this.ObstacleTree.PointIsInsideAnObstacle(r.Start,this.ScanDirection))&&(this.StoreLookaheadSite(o.item.Obstacle,r,r.Start,!0),this.LoadReflectionEvents(o.item))}}EnqueueHighBendOrCloseVertexEvent(t){const n=t.Obstacle;this.ScanDirection.ComparePerpCoord((this.ScanDirection.IsHorizontal?t.EndVertex.prevOnPolyline:t.EndVertex.nextOnPolyline).point,t.End)>0?this.eventQueue.Enqueue(new nP(n,t.EndVertex)):this.eventQueue.Enqueue(new iP(n,t.EndVertex))}CreateCloseEventSegmentsAndFindNeighbors(t){const n=t.Obstacle;let r=this.scanLine.Find(n.ActiveLowSide),s=this.scanLine.Find(n.ActiveHighSide);if(1==this.scanLine.Compare(n.ActiveLowSide,n.ActiveHighSide)){const o=r;r=s,s=o}if(this.FindNeighborsAndProcessVertexEvent(r,s,t),this.wantReflections&&n.isOverlapped)for(let o=this.scanLine.NextHighR(r);o.item!=s.item;o=this.scanLine.NextHighR(o))this.LoadReflectionEvents(o.item);this.scanLine.Remove(n.ActiveLowSide,t.Site),this.scanLine.Remove(n.ActiveHighSide,t.Site)}ProcessEventCV(t){this.CreateCloseEventSegmentsAndFindNeighbors(t);const r=this.HighNeighborSides.HighNeighbor.item,s=t.Obstacle;this.LoadReflectionEvents(this.LowNeighborSides.LowNeighbor.item),this.LoadReflectionEvents(r),s.Close()}ProcessEventLR(t){const n=t.Side.Obstacle,r=this.scanLine.NextLowB(t.Side).item;this.AddPerpendicularReflectionSegment(t,t.Side,r)&&this.AddParallelReflectionSegment(n,r,null,t)&&this.LoadReflectionEvents(n.ActiveLowSide)}ProcessEventHR(t){const n=t.Side.Obstacle,r=this.scanLine.NextHighB(t.Side).item;this.AddPerpendicularReflectionSegment(t,t.Side,r)&&this.AddParallelReflectionSegment(n,null,r,t)&&this.LoadReflectionEvents(n.ActiveHighSide)}MakeInBoundsLocation(t){const n=Math.max(t.x,this.ObstacleTree.GraphBox.left),r=Math.max(t.y,this.ObstacleTree.GraphBox.bottom);return new x(Math.min(n,this.ObstacleTree.GraphBox.right),Math.min(r,this.ObstacleTree.GraphBox.top))}IsInBoundsV(t){return this.IsInBoundsP(t.point)}IsInBoundsP(t){return fe.EqualPP(t,this.MakeInBoundsLocation(t))}}return i.SentinelOffset=1,i})();class nr extends tw{constructor(){super(!1),this.horizontalVertexPoints=new Rn,this.verticalVertexPoints=new Rn,this.boundingBoxSteinerPoints=new Rn,this.xCoordAccumulator=new Set,this.yCoordAccumulator=new Set,this.horizontalCoordMap=new Map,this.verticalCoordMap=new Map}Clear(){super.Clear(),this.Cleanup()}Cleanup(){this.horizontalVertexPoints.clear(),this.verticalVertexPoints.clear(),this.boundingBoxSteinerPoints.clear(),this.xCoordAccumulator.clear(),this.yCoordAccumulator.clear(),this.horizontalCoordMap.clear(),this.verticalCoordMap.clear()}GenerateVisibilityGraph(){this.AccumulateVertexCoords(),this.CreateSegmentVectorsAndPopulateCoordinateMaps(),this.RunScanLineToCreateSegmentsAndBoundingBoxSteinerPoints(),this.GenerateSparseIntersectionsFromVertexPoints(),this.CreateScanSegmentTrees(),this.Cleanup()}AccumulateVertexCoords(){for(const e of this.ObstacleTree.GetAllObstacles())this.xCoordAccumulator.add(e.VisibilityBoundingBox.left),this.xCoordAccumulator.add(e.VisibilityBoundingBox.right),this.yCoordAccumulator.add(e.VisibilityBoundingBox.top),this.yCoordAccumulator.add(e.VisibilityBoundingBox.bottom)}CreateSegmentVectorsAndPopulateCoordinateMaps(){this.horizontalScanSegmentVector=new QI(this.yCoordAccumulator,!0),this.verticalScanSegmentVector=new QI(this.xCoordAccumulator,!1);for(let e=0;e<this.horizontalScanSegmentVector.Length;e++)this.horizontalCoordMap.set(this.horizontalScanSegmentVector.Item(e).Coord,e);for(let e=0;e<this.verticalScanSegmentVector.Length;e++)this.verticalCoordMap.set(this.verticalScanSegmentVector.Item(e).Coord,e)}RunScanLineToCreateSegmentsAndBoundingBoxSteinerPoints(){super.GenerateVisibilityGraph(),this.horizontalScanSegmentVector.ScanSegmentsComplete(),this.verticalScanSegmentVector.ScanSegmentsComplete(),this.xCoordAccumulator.clear(),this.yCoordAccumulator.clear()}InitializeEventQueue(e){super.InitializeEventQueue(e),this.SetVectorsAndCoordMaps(e),this.AddAxisCoordinateEvents(e)}AddAxisCoordinateEvents(e){if(e.IsHorizontal)for(const t of this.yCoordAccumulator)this.eventQueue.Enqueue(new ew(new x(this.ObstacleTree.GraphBox.left-nr.SentinelOffset,t)));else for(const t of this.xCoordAccumulator)this.eventQueue.Enqueue(new ew(new x(t,this.ObstacleTree.GraphBox.bottom-nr.SentinelOffset)))}ProcessCustomEvent(e){this.ProcessAxisCoordinate(e)||this.ProcessCustomEvent(e)}ProcessAxisCoordinate(e){return e instanceof ew&&(this.CreateScanSegmentsOnAxisCoordinate(e.Site),!0)}InsertPerpendicularReflectionSegment(e,t){return!1}InsertParallelReflectionSegment(e,t,n,r,s,o){return!1}ProcessVertexEvent(e,t,n){const r=this.ScanDirection.IsHorizontal?this.horizontalVertexPoints:this.verticalVertexPoints;r.add(n.Site);const s=this.LowNeighborSides.LowNeighbor.item,o=this.HighNeighborSides.HighNeighbor.item,a=this.ScanDirection.Dir,l=this.ScanDirection.OppositeDirection,c=this.ScanLineIntersectSide(n.Site,s),u=this.ScanLineIntersectSide(n.Site,o);if(this.ObstacleTree.GraphBox.contains(c)){const R=Te.RectangleBorderIntersect(s.Obstacle.VisibilityBoundingBox,c,a);fe.IsPureLower(R,n.Site)&&this.boundingBoxSteinerPoints.add(R)}if(this.ObstacleTree.GraphBox.contains(u)){const R=Te.RectangleBorderIntersect(o.Obstacle.VisibilityBoundingBox,u,l);fe.IsPureLower(n.Site,R)&&this.boundingBoxSteinerPoints.add(R)}const y={lowCorner:void 0,highCorner:void 0};nr.GetBoundingCorners(e.item.Obstacle.VisibilityBoundingBox,n instanceof Yf,this.ScanDirection.IsHorizontal,y),(fe.IsPureLower(c,y.lowCorner)||s.Obstacle.IsInSameClump(n.Obstacle))&&r.add(y.lowCorner),(fe.IsPureLower(y.highCorner,u)||o.Obstacle.IsInSameClump(n.Obstacle))&&r.add(y.highCorner)}static GetBoundingCorners(e,t,n,r){if(t)return r.lowCorner=e.leftBottom,void(r.highCorner=n?e.rightBottom:e.leftTop);r.lowCorner=n?e.leftTop:e.rightBottom,r.highCorner=e.rightTop}CreateScanSegmentsOnAxisCoordinate(e){this.CurrentGroupBoundaryCrossingMap.Clear();const t=this.scanLine.Lowest();let n=this.scanLine.NextHighR(t),r=0,s=e,o=!1;for(;null!=n;n=this.scanLine.NextHighR(n))if(!this.SkipSide(s,n.item))if(n.item.Obstacle.IsGroup)(0==r||o)&&this.HandleGroupCrossing(e,n.item);else if(n.item instanceof es){if(r>0){r++;continue}s=this.CreateScanSegment(s,n.item,tt.NormalWeight),this.CurrentGroupBoundaryCrossingMap.Clear(),r=1,o=n.item.Obstacle.isOverlapped}else r++,!(r>0)&&(s=n.item.Obstacle.isOverlapped||n.item.Obstacle.OverlapsGroupCorner?this.CreateScanSegment(s,n.item,tt.OverlappedWeight):this.ScanLineIntersectSide(s,n.item),this.CurrentGroupBoundaryCrossingMap.Clear(),o=!1);const a=this.ScanDirection.IsHorizontal?new x(this.ObstacleTree.GraphBox.right+nr.SentinelOffset,s.y):new x(s.x,this.ObstacleTree.GraphBox.top+nr.SentinelOffset);this.parallelSegmentVector.CreateScanSegment(s,a,tt.NormalWeight,this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(s,a)),this.parallelSegmentVector.ScanSegmentsCompleteForCurrentSlot()}HandleGroupCrossing(e,t){if(!this.ScanLineCrossesObstacle(e,t.Obstacle))return;const n=t instanceof es?this.ScanDirection.Dir:this.ScanDirection.OppositeDirection,r=this.ScanLineIntersectSide(e,t),s=this.CurrentGroupBoundaryCrossingMap.AddIntersection(r,t.Obstacle,n);this.AddPerpendicularCoordForGroupCrossing(r);const o=s.GetInteriorVertexPoint(r);this.AddPerpendicularCoordForGroupCrossing(o)}AddPerpendicularCoordForGroupCrossing(e){const t=this.FindPerpendicularSlot(e,0);-1!=t&&this.perpendicularSegmentVector.Item(t).AddPendingPerpendicularCoord(this.parallelSegmentVector.CurrentSlot.Coord)}SkipSide(e,t){if(t.Obstacle.IsSentinel)return!0;const n=t.Obstacle.VisibilityBoundingBox;return this.ScanDirection.IsHorizontal?e.y==n.bottom||e.y==n.top:e.x==n.left||e.x==n.right}CreateScanSegment(e,t,n){const r=this.ScanLineIntersectSide(e,t);return e!=r&&this.parallelSegmentVector.CreateScanSegment(e,r,n,this.CurrentGroupBoundaryCrossingMap.GetOrderedListBetween(e,r)),r}GenerateSparseIntersectionsFromVertexPoints(){this.VisibilityGraph=nr.NewVisibilityGraph(),this.GenerateSparseIntersectionsAlongHorizontalAxis(),this.GenerateSparseIntersectionsAlongVerticalAxis(),this.ConnectAdjoiningScanSegments(),this.horizontalScanSegmentVector.CreateSparseVerticesAndEdges(this.VisibilityGraph),this.verticalScanSegmentVector.CreateSparseVerticesAndEdges(this.VisibilityGraph)}GenerateSparseIntersectionsAlongHorizontalAxis(){this.currentAxisPointComparer=Af;const e=Array.from(this.horizontalVertexPoints.values()).sort(this.currentAxisPointComparer),t=Array.from(this.boundingBoxSteinerPoints.values()).sort(this.currentAxisPointComparer);this.ScanDirection=qt.HorizontalInstance,this.SetVectorsAndCoordMaps(this.ScanDirection),this.GenerateSparseIntersections(e,t)}GenerateSparseIntersectionsAlongVerticalAxis(){this.currentAxisPointComparer=(n,r)=>n.compareTo(r);const e=Array.from(this.verticalVertexPoints.values()).sort(this.currentAxisPointComparer),t=Array.from(this.boundingBoxSteinerPoints.values()).sort(this.currentAxisPointComparer);this.ScanDirection=qt.VerticalInstance,this.SetVectorsAndCoordMaps(this.ScanDirection),this.GenerateSparseIntersections(e,t)}SetVectorsAndCoordMaps(e){e.IsHorizontal?(this.parallelSegmentVector=this.horizontalScanSegmentVector,this.perpendicularSegmentVector=this.verticalScanSegmentVector,this.perpendicularCoordMap=this.verticalCoordMap):(this.parallelSegmentVector=this.verticalScanSegmentVector,this.perpendicularSegmentVector=this.horizontalScanSegmentVector,this.perpendicularCoordMap=this.horizontalCoordMap)}ConnectAdjoiningScanSegments(){this.horizontalScanSegmentVector.ConnectAdjoiningSegmentEndpoints(),this.verticalScanSegmentVector.ConnectAdjoiningSegmentEndpoints()}GenerateSparseIntersections(e,t){this.perpendicularSegmentVector.ResetForIntersections(),this.parallelSegmentVector.ResetForIntersections();let n=1;const r={j:0};for(const s of this.parallelSegmentVector.Items())for(;s.CurrentSegment.ContainsPoint(e[n])||this.AddSteinerPointsToInterveningSegments(e[n],t,r,s)&&s.TraverseToSegmentContainingPoint(e[n]);)if(this.AddPointsToCurrentSegmentIntersections(t,r,s),this.GenerateIntersectionsFromVertexPointForCurrentSegment(e[n],s),s.PointIsCurrentEndAndNextStart(e[n]))s.MoveNext();else if(++n>=e.length)return}AddSteinerPointsToInterveningSegments(e,t,n,r){for(;n.j<t.length&&-1==this.currentAxisPointComparer(t[n.j],e);){if(!r.TraverseToSegmentContainingPoint(t[n.j]))return!1;this.AddPointsToCurrentSegmentIntersections(t,n,r)}return!0}AddPointsToCurrentSegmentIntersections(e,t,n){for(;t.j<e.length&&n.CurrentSegment.ContainsPoint(e[t.j]);t.j++){const r=this.FindPerpendicularSlot(e[t.j],0);this.AddSlotToSegmentIntersections(n,r)}}GenerateIntersectionsFromVertexPointForCurrentSegment(e,t){const n=this.FindPerpendicularSlot(t.CurrentSegment.Start,1),r=this.FindPerpendicularSlot(t.CurrentSegment.End,-1),s=this.FindPerpendicularSlot(e,0);n>=r||(this.AddSlotToSegmentIntersections(t,n),this.AddSlotToSegmentIntersections(t,r),s>n&&s<r&&(this.AddSlotToSegmentIntersections(t,s),this.AddBinaryDivisionSlotsToSegmentIntersections(t,n,s,r)))}FindPerpendicularSlot(e,t){return nr.FindIntersectingSlot(this.perpendicularSegmentVector,this.perpendicularCoordMap,e,t)}static FindIntersectingSlot(e,t,n,r){const s=e.GetParallelCoord(n),o=t.get(s);return null!=o?o:0==r?-1:e.FindNearest(s,r)}AddSlotToSegmentIntersections(e,t){const n=this.perpendicularSegmentVector.Item(t);e.CurrentSegment.AddSparseVertexCoord(n.Coord),n.AddPerpendicularCoord(e.Coord)}AddBinaryDivisionSlotsToSegmentIntersections(e,t,n,r){let s=0,o=this.perpendicularSegmentVector.Length-1;for(;o-s>1;){const a=s+Math.floor((o-s)/2);n<=a?(o=a,n<o&&o<=r&&this.AddSlotToSegmentIntersections(e,o)):(s=a,n>s&&s>=t&&this.AddSlotToSegmentIntersections(e,s))}}CreateScanSegmentTrees(){nr.CreateScanSegmentTree(this.horizontalScanSegmentVector,this.HorizontalScanSegments),nr.CreateScanSegmentTree(this.verticalScanSegmentVector,this.VerticalScanSegments)}static CreateScanSegmentTree(e,t){for(const n of e.Items())for(let r=n.FirstSegment;null!=r;r=r.NextSegment)r.HasVisibility()&&t.InsertUnique(r)}}class ir{constructor(e){this.AddedVertices=new Array,this.AddedEdges=new Array,this.edgesToRestore=new Array,this.LimitPortVisibilitySpliceToEndpointBoundingBox=!1,this.GraphGenerator=e}get ObstacleTree(){return this.GraphGenerator.ObstacleTree}get VisGraph(){return this.GraphGenerator.VisibilityGraph}get IsSparseVg(){return this.GraphGenerator instanceof nr}AddVertex(e){const t=this.VisGraph.AddVertexP(e);return this.AddedVertices.push(t),t}FindOrAddVertex(e){const t=this.VisGraph.FindVertex(e);return null!=t?t:this.AddVertex(e)}FindOrAddEdgeVV(e,t){return this.FindOrAddEdge(e,t,tt.NormalWeight)}FindOrAddEdge(e,t,n){const r=fe.GetPureDirectionVV(e,t),s={bracketSource:void 0,bracketTarget:void 0,splitVertex:void 0};ir.GetBrackets(e,t,r,s);let o=this.VisGraph.FindEdgePP(s.bracketSource.point,s.bracketTarget.point);return o=null!=o?this.SplitEdge(o,s.splitVertex):this.CreateEdge(s.bracketSource,s.bracketTarget,n),o}static GetBrackets(e,t,n,r){if(r.splitVertex=t,!ir.FindBracketingVertices(e,t.point,n,r)){const s={bracketSource:null,bracketTarget:null};ir.FindBracketingVertices(t,e.point,Ce.OppositeDir(n),s)&&(r.bracketSource=s.bracketTarget,r.splitVertex=e),r.bracketTarget=s.bracketSource}}static FindBracketingVertices(e,t,n,r){for(r.bracketSource=e;r.bracketTarget=Te.FindAdjacentVertex(r.bracketSource,n),null!=r.bracketTarget;){if(x.closeDistEps(r.bracketTarget.point,t))return!0;if(n!=fe.GetDirections(r.bracketTarget.point,t))break;r.bracketSource=r.bracketTarget}return null!=r.bracketTarget}CreateEdge(e,t,n){let r=e,s=t;fe.IsPureLower(r.point,s.point)||(r=t,s=e);const o=new As(r,s,n);return gn.AddEdge(o),this.AddedEdges.push(o),o}RemoveFromGraph(){this.RemoveAddedVertices(),this.RemoveAddedEdges(),this.RestoreRemovedEdges()}RemoveAddedVertices(){for(const e of this.AddedVertices)null!=this.VisGraph.FindVertex(e.point)&&this.VisGraph.RemoveVertex(e);this.AddedVertices=[]}RemoveAddedEdges(){for(const e of this.AddedEdges)null!=this.VisGraph.FindVertex(e.SourcePoint)&&gn.RemoveEdge(e);this.AddedEdges=[]}RestoreRemovedEdges(){for(const e of this.edgesToRestore)gn.AddEdge(e);this.edgesToRestore=[]}FindNextEdge(e,t){return Te.FindAdjacentEdge(e,t)}FindPerpendicularOrContainingEdge(e,t,n){for(;;){const r=Te.FindAdjacentVertex(e,t);if(null==r)break;const s=fe.GetDirections(r.point,n);if(0!=(Ce.OppositeDir(t)&s))return this.VisGraph.FindEdgePP(e.point,r.point);e=r}return null}FindNearestPerpendicularOrContainingEdge(e,t,n){let r;fe.GetDirections(e.point,n);let a,s=e;for(;null!=oe.None;){const l=Te.FindAdjacentVertex(s,r);if(null==l||0!=(Ce.OppositeDir(r)&fe.GetDirections(l.point,n)))break;s=l,fe.GetDirections(s.point,n)}for(;a=this.FindPerpendicularOrContainingEdge(s,t,n),null==a&&s!=e;)s=Te.FindAdjacentVertex(s,Ce.OppositeDir(r));return a}ConnectVertexToTargetVertex(e,t,n,r){if(x.closeDistEps(e.point,t.point))return;const s=fe.GetDirections(e.point,t.point);if(fe.IsPureDirectionD(s))return void this.FindOrAddEdgeVV(e,t);const o=Te.FindBendPointBetween(e.point,t.point,n),a=this.FindOrAddVertex(o);this.FindOrAddEdge(e,a,r),this.FindOrAddEdge(a,t,r)}AddEdgeToTargetEdge(e,t,n){let r=this.VisGraph.FindVertex(n);return null==r&&(r=this.AddVertex(n),this.SplitEdge(t,r)),this.FindOrAddEdgeVV(e,r),r}SplitEdge(e,t){return null==e?null:x.closeDistEps(e.Source.point,t.point)||x.closeDistEps(e.Target.point,t.point)?e:(e instanceof As||this.edgesToRestore.push(e),gn.RemoveEdge(e),(this.IsSparseVg||e.Weight==tt.OverlappedWeight)&&t.Degree>0?(this.FindOrAddEdge(t,e.Source,e.Weight),this.FindOrAddEdge(t,e.Target,e.Weight)):(this.CreateEdge(t,e.Target,e.Weight),this.CreateEdge(e.Source,t,e.Weight)))}ExtendEdgeChainVRLPB(e,t,n,r,s){const o=fe.GetDirections(n.start,n.end);if(o==oe.None)return;const a=Te.GetRectangleBound(t,o),l=Te.IsVerticalD(o)?q.RoundPoint(new x(e.point.x,a)):q.RoundPoint(new x(a,e.point.y));if(x.closeDistEps(l,e.point)||fe.GetDirections(e.point,l)!=o)return;let c=n;fe.GetDirections(l,c.end)==o&&(c=me.mkPP(c.start,l)),this.ExtendEdgeChain(e,o,c,n,r,s)}ExtendEdgeChain(e,t,n,r,s,o){if(fe.GetDirections(e.point,n.end)!=t)return;let l=Ce.RotateLeft(t),c=Te.FindAdjacentVertex(e,l);if(null==c&&(l=Ce.OppositeDir(l),c=Te.FindAdjacentVertex(e,l),null==c))return;const u=Ce.OppositeDir(l),y={spliceTarget:null};this.ExtendSpliceWorker(c,t,u,n,r,o,y)&&this.ExtendSpliceWorker(y.spliceTarget,t,l,n,r,o,y),this.SpliceGroupBoundaryCrossings(s,e,n)}SpliceGroupBoundaryCrossings(e,t,n){if(null==e||0==e.Count())return;e.Reset();let r=n.start,s=n.end,o=fe.GetDirections(r,s);Te.IsAscending(o)||(r=n.end,s=n.start,o=Ce.OppositeDir(o));for(let a=t=ir.TraverseToFirstVertexAtOrAbove(t,r,Ce.OppositeDir(o));null!=a;a=Te.FindAdjacentVertex(a,o)){const l=fe.ComparePP(a.point,s)>=0;for(;e.CurrentIsBeforeOrAt(a.point);){const c=e.Pop();fe.ComparePP(c.Location,t.point)>0&&fe.ComparePP(c.Location,s)<=0&&this.SpliceGroupBoundaryCrossing(a,c,Ce.OppositeDir(o)),fe.ComparePP(c.Location,t.point)>=0&&fe.ComparePP(c.Location,s)<0&&this.SpliceGroupBoundaryCrossing(a,c,o)}if(l)break}}static TraverseToFirstVertexAtOrAbove(e,t,n){let r=e;const s=Ce.OppositeDir(n);for(;;){const o=Te.FindAdjacentVertex(r,n);if(null==o||fe.GetDirections(o.point,t)==s)break;r=o}return r}SpliceGroupBoundaryCrossing(e,t,n){var r,s;const o=Qu.ToCrossingArray(t.Crossings,n);if(null!=o){const a=null!==(r=this.VisGraph.FindVertex(t.Location))&&void 0!==r?r:this.AddVertex(t.Location);this.AddVertex(t.Location),e.point.equal(a.point)||this.FindOrAddEdgeVV(e,a);const l=o[0].GetInteriorVertexPoint(t.Location),c=null!==(s=this.VisGraph.FindVertex(l))&&void 0!==s?s:this.AddVertex(l);this.AddVertex(l),this.FindOrAddEdgeVV(a,c);const u=this.VisGraph.FindEdgePP(a.point,c.point),y=o.map(R=>R.Group.InputShape);u.IsPassable=()=>y.some(R=>R.IsTransparent)}}ExtendSpliceWorker(e,t,n,r,s,o,a){let l=Te.FindAdjacentVertex(e,n);a.spliceTarget=Te.FindAdjacentVertex(l,n);const c={spliceSource:e};for(;ir.GetNextSpliceSource(c,n,t);){const u=Te.FindBendPointBetween(l.point,c.spliceSource.point,Ce.OppositeDir(n));if(ir.IsPointPastSegmentEnd(s,u))break;if(a.spliceTarget=ir.GetSpliceTarget(c,n,u),null==a.spliceTarget){if(this.IsSkippableSpliceSourceWithNullSpliceTarget(c.spliceSource,t))continue;if(this.ObstacleTree.SegmentCrossesAnObstacle(c.spliceSource.point,u))return!1}let y=this.VisGraph.FindVertex(u);if(null!=y){if(null==a.spliceTarget||null!=this.VisGraph.FindEdgePP(l.point,u))return null==a.spliceTarget&&this.FindOrAddEdge(l,y,o?tt.OverlappedWeight:tt.NormalWeight),!1}else y=this.AddVertex(u);if(this.FindOrAddEdge(l,y,o?tt.OverlappedWeight:tt.NormalWeight),this.FindOrAddEdge(c.spliceSource,y,o?tt.OverlappedWeight:tt.NormalWeight),o&&(o=this.SeeIfSpliceIsStillOverlapped(t,y)),l=y,0==(t&fe.GetDirections(u,r.end))){a.spliceTarget=null;break}}return null!=a.spliceTarget}static GetNextSpliceSource(e,t,n){let r=Te.FindAdjacentVertex(e.spliceSource,n);if(null==r)for(r=e.spliceSource;;){if(r=Te.FindAdjacentVertex(r,Ce.OppositeDir(t)),null==r)return!1;const s=Te.FindAdjacentVertex(r,n);if(null!=s){r=s;break}}return e.spliceSource=r,!0}static GetSpliceTarget(e,t,n){const r=fe.GetDirections(e.spliceSource.point,n);let s=r,o=e.spliceSource;for(;s==r&&(e.spliceSource=o,o=Te.FindAdjacentVertex(e.spliceSource,t),null!=o);){if(x.closeDistEps(o.point,n)){o=Te.FindAdjacentVertex(o,t);break}s=fe.GetDirections(o.point,n)}return o}SeeIfSpliceIsStillOverlapped(e,t){let n=this.FindNextEdge(t,Ce.RotateLeft(e)),r=null!=n&&tt.NormalWeight==n.Weight;return r||(n=this.FindNextEdge(t,Ce.RotateRight(e)),r=null!=n&&tt.NormalWeight==n.Weight),!r||this.ObstacleTree.PointIsInsideAnObstaclePD(t.point,e)}IsSkippableSpliceSourceWithNullSpliceTarget(e,t){if(ir.IsSkippableSpliceSourceEdgeWithNullTarget(Te.FindAdjacentEdge(e,t)))return!0;const n=Te.FindAdjacentEdge(e,Ce.OppositeDir(t));return ir.IsSkippableSpliceSourceEdgeWithNullTarget(n)||ir.IsReflectionEdge(n)}static IsSkippableSpliceSourceEdgeWithNullTarget(e){return null!=e&&null!=e.IsPassable&&ht(e.Length,ZE.BoundaryWidth)}static IsReflectionEdge(e){return null!=e&&e.Weight==tt.ReflectionWeight}static IsPointPastSegmentEnd(e,t){return fe.GetDirections(e.start,e.end)==fe.GetDirections(e.end,t)}toString(){return Hn.String.Format("{0} {1}",this.AddedVertices.length,this.edgesToRestore.length)}}class eh{constructor(e){this.obstaclePortMap=new Map,this.freePointMap=new Di,this.freePointLocationsUsedByRouteEdges=new Rn,this.RouteToCenterOfObstacles=!1,this.obstaclePortsInGraph=new Array,this.freePointsInGraph=new Set,this.activeAncestors=new Array,this.TransUtil=new ir(e),this.graphGenerator=e}get LimitPortVisibilitySpliceToEndpointBoundingBox(){return this.TransUtil.LimitPortVisibilitySpliceToEndpointBoundingBox}set LimitPortVisibilitySpliceToEndpointBoundingBox(e){this.TransUtil.LimitPortVisibilitySpliceToEndpointBoundingBox=e}get VisGraph(){return this.graphGenerator.VisibilityGraph}get HScanSegments(){return this.graphGenerator.HorizontalScanSegments}get VScanSegments(){return this.graphGenerator.VerticalScanSegments}get ObstacleTree(){return this.graphGenerator.ObstacleTree}get AncestorSets(){return this.ObstacleTree.AncestorSets}Clear(){this.TransUtil.RemoveFromGraph(),this.obstaclePortMap.clear()}CreateObstaclePorts(e){for(const t of e.Ports)this.CreateObstaclePort(e,t)}CreateObstaclePort(e,t){if(null==t.Curve)return null;const n=q.RoundPoint(t.Location);if(We.Outside==te.PointRelativeToCurveLocation(n,e.InputShape.BoundaryCurve)||e.InputShape.BoundaryCurve!=t.Curve&&We.Outside==te.PointRelativeToCurveLocation(n,t.Curve))return null;const r=new _U(t,e);return this.obstaclePortMap.set(t,r),r}FindVertices(e){const t=new Array,n=this.obstaclePortMap.get(e);if(n)if(this.RouteToCenterOfObstacles)t.push(n.CenterVertex);else for(const r of n.PortEntrances){const s=this.VisGraph.FindVertex(r.UnpaddedBorderIntersect);null!=s&&t.push(s)}else t.push(this.VisGraph.FindVertex(q.RoundPoint(e.Location)));return t}RemoveObstaclePorts(e){for(const t of e.Ports)this.RemoveObstaclePort(t)}RemoveObstaclePort(e){this.obstaclePortMap.delete(e)}AddControlPointsToGraph(e,t){this.GetPortSpliceLimitRectangle(e),this.activeAncestors=[];const n={oport:null},r={oport:null},s=this.FindAncestorsAndObstaclePort(e.sourcePort,n),o=this.FindAncestorsAndObstaclePort(e.targetPort,r);if(this.AncestorSets.size>0&&null!=n.oport&&null!=r.oport){const a=jl(o,s),l=jl(s,o);this.ActivateAncestors(l,a,t)}this.AddPortToGraph(e.sourcePort,n.oport),this.AddPortToGraph(e.targetPort,r.oport)}ConnectOobWaypointToEndpointVisibilityAtGraphBoundary(e,t){if(null==e||!e.IsOutOfBounds)return;const n=this.FindVertices(t);let r=e.OutOfBoundsDirectionFromGraph&(oe.North|oe.South);this.ConnectToGraphAtPointsCollinearWithVertices(e,r,n),r=e.OutOfBoundsDirectionFromGraph&(oe.East|oe.West),this.ConnectToGraphAtPointsCollinearWithVertices(e,r,n)}ConnectToGraphAtPointsCollinearWithVertices(e,t,n){if(oe.None==t)return;const r=Ce.OppositeDir(t);for(const s of n){const o=this.InBoundsGraphBoxIntersect(s.point,t),a=this.VisGraph.FindVertex(o);null!=a&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,a,r,tt.NormalWeight)}}SetAllAncestorsActive(e,t){if(0==this.AncestorSets.size)return!1;this.ObstacleTree.AdjustSpatialAncestors(),this.ClearActiveAncestors();const s=this.FindAncestorsAndObstaclePort(e.sourcePort,{oport:null}),o=this.FindAncestorsAndObstaclePort(e.targetPort,{oport:null});return this.AncestorSets.size>0&&null!=s&&null!=o&&(this.ActivateAncestors(s,o,t),!0)}SetAllGroupsActive(){this.ClearActiveAncestors();for(const e of this.ObstacleTree.GetAllGroups())e.IsTransparentAncestor=!0,this.activeAncestors.push(e)}FindAncestorsAndObstaclePort(e,t){return t.oport=this.FindObstaclePort(e),0==this.AncestorSets.size?null:null!=t.oport?this.AncestorSets.get(t.oport.Obstacle.InputShape):new Set(Array.from(this.ObstacleTree.Root.AllHitItems(De.mkPP(e.Location,e.Location),n=>n.IsGroup)).map(n=>n.InputShape))}ActivateAncestors(e,t,n){for(const r of zl(e,t)){const s=n.get(r);s.IsTransparentAncestor=!0,this.activeAncestors.push(s)}}ClearActiveAncestors(){for(const e of this.activeAncestors)e.IsTransparentAncestor=!1;this.activeAncestors=[]}RemoveControlPointsFromGraph(){this.ClearActiveAncestors(),this.RemoveObstaclePortsFromGraph(),this.RemoveFreePointsFromGraph(),this.TransUtil.RemoveFromGraph(),this.portSpliceLimitRectangle=De.mkEmpty()}RemoveObstaclePortsFromGraph(){for(const e of this.obstaclePortsInGraph)e.RemoveFromGraph();this.obstaclePortsInGraph=[]}RemoveFreePointsFromGraph(){for(const e of this.freePointsInGraph)e.RemoveFromGraph();this.freePointsInGraph.clear()}RemoveStaleFreePoints(){if(this.freePointMap.size>this.freePointLocationsUsedByRouteEdges.size){const e=Array.from(this.freePointMap).filter(t=>!this.freePointLocationsUsedByRouteEdges.has(t[0]));for(const t of e)this.freePointMap.deleteP(t[0])}}ClearVisibility(){this.freePointMap.clear();for(const e of this.obstaclePortMap.values())e.ClearVisibility()}BeginRouteEdges(){this.RemoveControlPointsFromGraph(),this.freePointLocationsUsedByRouteEdges.clear()}EndRouteEdges(){this.RemoveStaleFreePoints()}FindObstaclePort(e){let t=this.obstaclePortMap.get(e);if(t){const n={removedPorts:null,addedPorts:null};if(t.Obstacle.GetPortChanges(n)){for(const r of n.addedPorts)this.CreateObstaclePort(t.Obstacle,r);for(const r of n.removedPorts)this.RemoveObstaclePort(r);t=this.obstaclePortMap.get(e)}}return t}AddPortToGraph(e,t){null==t?this.AddFreePointToGraph(e.Location):this.AddObstaclePortToGraph(t)}AddObstaclePortToGraph(e){if(!e.LocationHasChanged||(this.RemoveObstaclePort(e.Port),null!=(e=this.CreateObstaclePort(e.Obstacle,e.Port)))){e.AddToGraph(this.TransUtil,this.RouteToCenterOfObstacles),this.obstaclePortsInGraph.push(e),this.CreateObstaclePortEntrancesIfNeeded(e);for(const t of e.PortEntrances)this.AddObstaclePortEntranceToGraph(t)}}CreateObstaclePortEntrancesIfNeeded(e){e.PortEntrances.length>0||this.CreateObstaclePortEntrancesFromPoints(e)}GetPortVisibilityIntersection(e){const t=this.FindObstaclePort(e.sourcePort),n=this.FindObstaclePort(e.targetPort);if(null==t||null==n||t.Obstacle.IsInConvexHull||n.Obstacle.IsInConvexHull||(this.CreateObstaclePortEntrancesIfNeeded(t),this.CreateObstaclePortEntrancesIfNeeded(n),!t.VisibilityRectangle.intersects(n.VisibilityRectangle)))return null;for(const r of t.PortEntrances)if(r.WantVisibilityIntersection)for(const s of n.PortEntrances){if(!s.WantVisibilityIntersection)continue;const o=r.IsVertical==s.IsVertical?eh.GetPathPointsFromOverlappingCollinearVisibility(r,s):eh.GetPathPointsFromIntersectingVisibility(r,s);if(null!=o)return o}return null}static GetPathPointsFromOverlappingCollinearVisibility(e,t){return!Te.IntervalsAreSame(e.MaxVisibilitySegment.start,e.MaxVisibilitySegment.end,t.MaxVisibilitySegment.end,t.MaxVisibilitySegment.start)||e.HasGroupCrossings||t.HasGroupCrossings||x.closeDistEps(e.UnpaddedBorderIntersect,t.UnpaddedBorderIntersect)?null:[e.UnpaddedBorderIntersect,t.UnpaddedBorderIntersect]}static GetPathPointsFromIntersectingVisibility(e,t){const n=Te.SegmentsIntersectLL(e.MaxVisibilitySegment,t.MaxVisibilitySegment);return!n||e.HasGroupCrossingBeforePoint(n)||t.HasGroupCrossingBeforePoint(n)?null:[e.UnpaddedBorderIntersect,n,t.UnpaddedBorderIntersect]}CreateObstaclePortEntrancesFromPoints(e){const t=this.graphGenerator.ObstacleTree.GraphBox,n=De.mkPP(q.RoundPoint(e.PortCurve.boundingBox.leftBottom),q.RoundPoint(e.PortCurve.boundingBox.rightTop)),r=q.RoundPoint(e.PortLocation);let s=!1;const o={xx0:null,xx1:null};if(!fe.Equal(r.y,n.top)&&!fe.Equal(r.y,n.bottom)){s=!0;const a=new me(t.left,r.y,t.right,r.y);this.GetBorderIntersections(r,a,e.PortCurve,o);let l=new x(Math.min(o.xx0.x,o.xx1.x),r.y);l.x<n.left&&(l=new x(n.left,l.y));let c=new x(Math.max(o.xx0.x,o.xx1.x),r.y);c.x>n.right&&(c=new x(n.right,c.y)),this.CreatePortEntrancesAtBorderIntersections(n,e,r,l,c)}if(!fe.Equal(r.x,n.left)&&!fe.Equal(r.x,n.right)){s=!0;const a=new me(r.x,t.bottom,r.x,t.top);this.GetBorderIntersections(r,a,e.PortCurve,o);let l=new x(r.x,Math.min(o.xx0.y,o.xx1.y));l.y<t.bottom&&(l=new x(l.x,t.bottom));let c=new x(r.x,Math.max(o.xx0.y,o.xx1.y));c.y>t.top&&(c=new x(c.x,t.top)),this.CreatePortEntrancesAtBorderIntersections(n,e,r,l,c)}s||this.CreateEntrancesForCornerPort(n,e,r)}GetBorderIntersections(e,t,n,r){const s=te.getAllIntersections(t,n,!0);r.xx0=q.RoundPoint(s[0].x),r.xx1=q.RoundPoint(s[1].x)}CreatePortEntrancesAtBorderIntersections(e,t,n,r,s){const o=fe.GetDirections(r,s);fe.EqualPP(r,n)||this.CreatePortEntrance(e,t,s,o),fe.EqualPP(s,n)||this.CreatePortEntrance(e,t,r,Ce.OppositeDir(o))}static GetDerivative(e,t){const n=e.PortCurve.closestParameter(t);let r=e.PortCurve.derivative(n);return Tr.CurveIsClockwise(e.PortCurve,e.PortCurve.value((e.PortCurve.parStart+e.PortCurve.parEnd)/2))||(r=r.mul(-1)),r}CreatePortEntrance(e,t,n,r){t.CreatePortEntrance(n,r,this.ObstacleTree);const s=qt.GetInstance(r);let o=Te.GetRectangleBound(e,r)-s.Coord(n);if(o<0&&(o=-o),o>q.intersectionEpsilon){const a=Ce.VectorDirection(eh.GetDerivative(t,n));let l;Ce.OppositeDir(r),oe.None!=(r&a)&&(l=Ce.OppositeDir(l)),t.CreatePortEntrance(n,l,this.ObstacleTree)}}CreateEntrancesForCornerPort(e,t,n){let r=oe.North;fe.EqualPP(n,e.leftBottom)?r=oe.South:fe.EqualPP(n,e.leftTop)?r=oe.West:fe.EqualPP(n,e.rightTop)?r=oe.North:fe.EqualPP(n,e.rightBottom)&&(r=oe.East),t.CreatePortEntrance(n,r,this.ObstacleTree),t.CreatePortEntrance(n,Ce.RotateRight(r),this.ObstacleTree)}AddObstaclePortEntranceToGraph(e){const t=this.VisGraph.FindVertex(e.VisibilityBorderIntersect);if(t)return void e.ExtendEdgeChain(this.TransUtil,t,t,this.portSpliceLimitRectangle,this.RouteToCenterOfObstacles);const n={targetVertex:null};null!=this.FindorCreateNearestPerpEdgePPDNT(e.MaxVisibilitySegment.end,e.VisibilityBorderIntersect,e.OutwardDirection,e.IsOverlapped?tt.OverlappedWeight:tt.NormalWeight,n)&&e.AddToAdjacentVertex(this.TransUtil,n.targetVertex,this.portSpliceLimitRectangle,this.RouteToCenterOfObstacles)}InBoundsGraphBoxIntersect(e,t){return Te.RectangleBorderIntersect(this.graphGenerator.ObstacleTree.GraphBox,e,t)}FindorCreateNearestPerpEdgePPDN(e,t,n,r){return this.FindorCreateNearestPerpEdgePPDNT(e,t,n,r,{targetVertex:null})}FindorCreateNearestPerpEdgePPDNT(e,t,n,r,s){const o=Te.SortAscending(e,t),a=o[0],l=o[1],c=Te.IsVerticalD(n)?this.HScanSegments:this.VScanSegments,u=Te.IsAscending(n)?c.FindLowestIntersector(a,l):c.FindHighestIntersector(a,l);if(null==u)return s.targetVertex=null,null;const y=Te.SegmentIntersectionSP(u,a);return this.FindOrCreateNearestPerpEdgeFromNearestPerpSegment(Te.IsAscending(n)?a:l,u,y,r,s)}FindOrCreateNearestPerpEdgeFromNearestPerpSegment(e,t,n,r,s){var o;const a={segsegVertex:this.VisGraph.FindVertex(n),targetVertex:null};if(null==a.segsegVertex){const y=this.FindOrCreateSegmentIntersectionVertexAndAssociatedEdge(e,n,t,r,a);if(null!=y)return y}else if(fe.EqualPP(e,n))return s.targetVertex=a.segsegVertex,this.TransUtil.FindNextEdge(s.targetVertex,Ce.OppositeDir(t.ScanDirection.Dir));const l=fe.GetDirections(n,e);let c=fe.GetDirections(a.segsegVertex.point,e);if(l==c){const y={bracketTarget:null,bracketSource:null};return ir.FindBracketingVertices(a.segsegVertex,e,l,y),null!==(o=this.TransUtil.FindNextEdge(y.bracketSource,Ce.RotateLeft(l)))&&void 0!==o?o:this.TransUtil.FindNextEdge(y.bracketSource,Ce.RotateRight(l))}c&=~l;const u=this.TransUtil.FindNearestPerpendicularOrContainingEdge(a.segsegVertex,c,e);return null==u?(s.targetVertex=this.TransUtil.AddVertex(n),this.TransUtil.FindOrAddEdge(s.targetVertex,t.HighestVisibilityVertex,t.Weight)):(a.segsegVertex=Te.GetEdgeEnd(u,Ce.OppositeDir(c)),n=Te.SegmentIntersectionPPP(e,n,a.segsegVertex.point),fe.EqualPP(a.segsegVertex.point,n)?(s.targetVertex=a.segsegVertex,this.TransUtil.FindNextEdge(a.segsegVertex,c)):(s.targetVertex=this.TransUtil.FindOrAddVertex(n),this.TransUtil.FindOrAddEdge(a.segsegVertex,s.targetVertex,r)))}FindOrCreateSegmentIntersectionVertexAndAssociatedEdge(e,t,n,r,s){const a=(n.IsVertical?this.HScanSegments:this.VScanSegments).FindHighestIntersector(n.Start,t);if(null==a)return s.segsegVertex=null,s.targetVertex=this.TransUtil.AddVertex(t),this.TransUtil.FindOrAddEdge(s.targetVertex,n.LowestVisibilityVertex,n.Weight);const l=Te.SegmentsIntersection(n,a);if(s.segsegVertex=this.VisGraph.FindVertex(l),!s.segsegVertex){s.segsegVertex=this.TransUtil.AddVertex(l);const c=this.AddEdgeToClosestSegmentEnd(n,s.segsegVertex,n.Weight);if(this.AddEdgeToClosestSegmentEnd(a,s.segsegVertex,a.Weight),fe.EqualPP(s.segsegVertex.point,t))return s.targetVertex=s.segsegVertex,c}return fe.EqualPP(e,t)?(s.targetVertex=this.TransUtil.FindOrAddVertex(t),this.TransUtil.FindOrAddEdge(s.segsegVertex,s.targetVertex,r)):(s.targetVertex=null,null)}AddEdgeToClosestSegmentEnd(e,t,n){return fe.IsPureLower(e.HighestVisibilityVertex.point,t.point)?this.TransUtil.FindOrAddEdge(e.HighestVisibilityVertex,t,n):fe.IsPureLower(t.point,e.LowestVisibilityVertex.point)?this.TransUtil.FindOrAddEdge(t,e.LowestVisibilityVertex,n):this.TransUtil.FindOrAddEdgeVV(e.LowestVisibilityVertex,t)}GetPortSpliceLimitRectangle(e){this.LimitPortVisibilitySpliceToEndpointBoundingBox?(this.portSpliceLimitRectangle=this.GetPortRectangle(e.sourcePort),this.portSpliceLimitRectangle.addRecSelf(this.GetPortRectangle(e.targetPort))):this.portSpliceLimitRectangle=this.graphGenerator.ObstacleTree.GraphBox}GetPortRectangle(e){const t=this.obstaclePortMap.get(e);return t?t.Obstacle.VisibilityBoundingBox.clone():De.mkOnPoints([q.RoundPoint(e.Location)])}AddToLimitRectangle(e){this.graphGenerator.IsInBoundsP(e)&&this.portSpliceLimitRectangle.add(e)}FindOrCreateFreePoint(e){let t=this.freePointMap.get(e);return t?t.GetVertex(this.TransUtil,e):(t=new DU(this.TransUtil,e),this.freePointMap.set(e,t)),this.freePointsInGraph.add(t),this.freePointLocationsUsedByRouteEdges.add(e),t}AddFreePointToGraph(e){e=q.RoundPoint(e);const t=this.VisGraph.FindVertex(e),n=this.FindOrCreateFreePoint(e);if(null!=t)return n;if(!this.graphGenerator.IsInBoundsP(e))return this.CreateOutOfBoundsFreePoint(n),n;n.IsOverlapped=this.ObstacleTree.PointIsInsideAnObstacle(n.Point,this.HScanSegments.ScanDirection),this.VScanSegments.FindSegmentContainingPoint(e,!0);let o=oe.South;for(let a=0;a<4;a++)this.ConnectFreePointToLateralEdge(n,o),o=Ce.RotateLeft(o);return n}CreateOutOfBoundsFreePoint(e){const t=e.Point,n=this.graphGenerator.MakeInBoundsLocation(t),r=fe.GetDirections(n,t);if(e.OutOfBoundsDirectionFromGraph=r,!fe.IsPureDirectionD(r))return void e.AddOobEdgesFromGraphCorner(this.TransUtil,n);let s=this.VisGraph.FindVertex(n);const o=Ce.OppositeDir(r);if(null!=s)e.AddToAdjacentVertex(this.TransUtil,s,o,this.portSpliceLimitRectangle);else{const c=this.FindorCreateNearestPerpEdgePPDN(t,n,r,tt.NormalWeight);null!=c&&(s=e.AddEdgeToAdjacentEdge(this.TransUtil,c,o,this.portSpliceLimitRectangle))}const a=Te.FindAdjacentVertex(s,Ce.RotateLeft(o));null!=a&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,a,o,tt.NormalWeight);const l=Te.FindAdjacentVertex(s,Ce.RotateRight(o));null!=l&&this.TransUtil.ConnectVertexToTargetVertex(e.Vertex,l,o,tt.NormalWeight)}ConnectFreePointToLateralEdge(e,t){const n=e.IsOverlapped?this.InBoundsGraphBoxIntersect(e.Point,t):e.MaxVisibilityInDirectionForNonOverlappedFreePoint(t,this.TransUtil),r=this.FindorCreateNearestPerpEdgePPDN(n,e.Point,t,e.InitialWeight);null!=r&&e.AddEdgeToAdjacentEdge(this.TransUtil,r,t,this.portSpliceLimitRectangle)}}let BU=(()=>{class i extends dn{constructor(t,n,r,s,o){super(null),this.Padding=0,this.CornerFitRadius=0,this.BendPenaltyAsAPercentageOfDistance=0,this.UseObstacleRectangles=!1,this.ShapeToObstacleMap=new Map,this.EdgesToRoute=new Array,this.removeStaircases=!0,this.selfEdges=new Array,this.Padding=n,this.CornerFitRadius=r,this.BendPenaltyAsAPercentageOfDistance=Ot.DefaultBendPenaltyAsAPercentageOfDistance,this.GraphGenerator=new nr,this.UseObstacleRectangles=o,this.PortManager=new eh(this.GraphGenerator),this.AddShapes(t)}get RouteToCenterOfObstacles(){return this.PortManager.RouteToCenterOfObstacles}set RouteToCenterOfObstacles(t){this.PortManager.RouteToCenterOfObstacles=t}get LimitPortVisibilitySpliceToEndpointBoundingBox(){return this.PortManager.LimitPortVisibilitySpliceToEndpointBoundingBox}set LimitPortVisibilitySpliceToEndpointBoundingBox(t){this.PortManager.LimitPortVisibilitySpliceToEndpointBoundingBox=t}AddEdgeGeometryToRoute(t){x.closeDistEps(q.RoundPoint(t.sourcePort.Location),q.RoundPoint(t.targetPort.Location))?this.selfEdges.push(t):this.EdgesToRoute.push(t)}get EdgeGeometriesToRoute(){return this.EdgesToRoute}RemoveAllEdgeGeometriesToRoute(){this.EdgesToRoute=[]}get UseSparseVisibilityGraph(){return this.GraphGenerator instanceof nr}get Obstacles(){return Array.from(this.ShapeToObstacleMap.values()).map(t=>t.InputShape)}get PaddedObstacles(){return Array.from(this.ShapeToObstacleMap.values()).map(t=>t.PaddedPolyline)}AddObstacles(t){this.AddShapes(t),this.RebuildTreeAndGraph()}AddShapes(t){for(const n of t)this.AddObstacleWithoutRebuild(n)}AddObstacle(t){this.AddObstacleWithoutRebuild(t),this.RebuildTreeAndGraph()}UpdateObstacles(t){for(const n of t)this.UpdateObstacleWithoutRebuild(n);this.RebuildTreeAndGraph()}UpdateObstacle(t){this.UpdateObstacleWithoutRebuild(t),this.RebuildTreeAndGraph()}RemoveObstacles(t){for(const n of t)this.RemoveObstacleWithoutRebuild(n);this.RebuildTreeAndGraph()}RemoveObstacle(t){this.RemoveObstacleWithoutRebuild(t),this.RebuildTreeAndGraph()}AddObstacleWithoutRebuild(t){if(null==t.BoundaryCurve)throw new Error("Shape must have a BoundaryCurve");this.CreatePaddedObstacle(t)}UpdateObstacleWithoutRebuild(t){if(null==t.BoundaryCurve)throw new Error("Shape must have a BoundaryCurve");this.PortManager.RemoveObstaclePorts(this.ShapeToObstacleMap.get(t)),this.CreatePaddedObstacle(t)}CreatePaddedObstacle(t){const n=new Ts(t,this.UseObstacleRectangles,this.Padding);this.ShapeToObstacleMap.set(t,n),this.PortManager.CreateObstaclePorts(n)}RemoveObstacleWithoutRebuild(t){const n=this.ShapeToObstacleMap.get(t);this.ShapeToObstacleMap.delete(t),this.PortManager.RemoveObstaclePorts(n)}RemoveAllObstacles(){this.InternalClear(!1)}RebuildTreeAndGraph(){const t=null!=this.ObsTree.Root,n=null!=this.GraphGenerator.VisibilityGraph;this.InternalClear(!0),t&&this.GenerateObstacleTree(),n&&this.GenerateVisibilityGraph()}get VisibilityGraph(){return this.GenerateVisibilityGraph(),this.GraphGenerator.VisibilityGraph}Clear(){this.InternalClear(!1)}static constructorEmpty(){return i.constructorC(null)}static constructorC(t){return new i([],i.DefaultPadding,i.DefaultCornerFitRadius,!1,!1)}static constructorI(t){return new i(t,i.DefaultPadding,i.DefaultCornerFitRadius,!1,!1)}static constructorINNB(t,n,r,s){return new i(t,n,r,s,!1)}static constructorGNANB(t,n,r,s,o){return this.constructorGNANBB(t,n,r,s,o,!1)}static constructorGNANBB(t,n,r,s,o,a){const l=new i(er.GetShapes(t),r,s,o,a);if(null==n)for(const c of t.edges())l.AddEdgeGeometryToRoute(c);else for(const c of n)l.AddEdgeGeometryToRoute(c);return l}run(){this.GenerateVisibilityGraph(),this.GeneratePaths()}GeneratePaths(){const t=this.EdgesToRoute.map(n=>new PU(n));this.FillEdgePathsWithShortestPaths(t),this.NudgePaths(t),this.RouteSelfEdges(),this.FinaliseEdgeGeometries()}RouteSelfEdges(){for(const t of this.selfEdges){const n={smoothedPolyline:null};t.curve=Do.RouteSelfEdge(t.sourcePort.Curve,Math.max(this.Padding,2*t.GetMaxArrowheadLength()),n)}}FillEdgePathsWithShortestPaths(t){this.PortManager.BeginRouteEdges();const n=new Xu(this.BendPenaltyAsAPercentageOfDistance);for(const r of t)this.AddControlPointsAndGeneratePath(n,r);this.PortManager.EndRouteEdges()}AddControlPointsAndGeneratePath(t,n){const r=this.PortManager.GetPortVisibilityIntersection(n.GeomEdge);null==r?this.SpliceVisibilityAndGeneratePath(t,n):this.GeneratePathThroughVisibilityIntersection(n,r)}GeneratePathThroughVisibilityIntersection(t,n){t.PathPoints=n}SpliceVisibilityAndGeneratePath(t,n){this.PortManager.AddControlPointsToGraph(n.GeomEdge,this.ShapeToObstacleMap),this.GeneratePath(t,n,!1)||this.RetryPathsWithAdditionalGroupsEnabled(t,n),this.PortManager.RemoveControlPointsFromGraph()}GeneratePath(t,n,r){const s=this.PortManager.FindVertices(n.GeomEdge.sourcePort),o=this.PortManager.FindVertices(n.GeomEdge.targetPort);return i.GetSingleStagePath(n,t,s,o,r)}static GetSingleStagePath(t,n,r,s,o){return t.PathPoints=n.GetPath(r,s),o&&i.EnsureNonNullPath(t),null!=t.PathPoints&&t.PathPoints.length>0}static EnsureNonNullPath(t){null==t.PathPoints&&(t.PathPoints=fe.IsPureDirection(t.GeomEdge.sourcePort.Location,t.GeomEdge.targetPort.Location)?[t.GeomEdge.sourcePort.Location,t.GeomEdge.targetPort.Location]:[t.GeomEdge.sourcePort.Location,new x(t.GeomEdge.sourcePort.Location.x,t.GeomEdge.targetPort.Location.y),t.GeomEdge.targetPort.Location])}RetryPathsWithAdditionalGroupsEnabled(t,n){(!this.PortManager.SetAllAncestorsActive(n.GeomEdge,this.ShapeToObstacleMap)||!this.GeneratePath(t,n,!1))&&(this.PortManager.SetAllGroupsActive(),this.GeneratePath(t,n,!0))}NudgePaths(t){const n=this.ObsTree.SpatialAncestorsAdjusted?zt.GetAncestorSetsMap(this.Obstacles):this.AncestorsSets;Ht.NudgePaths(t,this.CornerFitRadius,this.PaddedObstacles,n,this.RemoveStaircases)}get RemoveStaircases(){return this.removeStaircases}set RemoveStaircases(t){this.removeStaircases=t}FinaliseEdgeGeometries(){for(const t of this.EdgesToRoute.concat(this.selfEdges))null!=t.curve&&(t.curve instanceof He&&(t.curve=i.FitArcsIntoCorners(this.CornerFitRadius,Array.from(t.curve))),i.CalculateArrowheads(t))}CreateVisibilityGraph(){this.GraphGenerator.Clear(),this.InitObstacleTree(),this.GraphGenerator.GenerateVisibilityGraph()}static CalculateArrowheads(t){_o.trimSplineAndCalculateArrowheadsII(t,t.sourcePort.Curve,t.targetPort.Curve,t.curve,!0)}get ObsTree(){return this.GraphGenerator.ObstacleTree}GenerateObstacleTree(){if(null==this.Obstacles||0==this.Obstacles.length)throw new Error("No obstacles have been added");null==this.ObsTree.Root&&this.InitObstacleTree()}InitObstacleTree(){this.AncestorsSets=zt.GetAncestorSetsMap(this.Obstacles),this.ObsTree.Init(this.ShapeToObstacleMap.values(),this.AncestorsSets,this.ShapeToObstacleMap)}InternalClear(t){this.GraphGenerator.Clear(),this.ClearShortestPaths(),t?this.PortManager.ClearVisibility():(this.PortManager.Clear(),this.ShapeToObstacleMap.clear(),this.EdgesToRoute=[])}ClearShortestPaths(){for(const t of this.EdgesToRoute)t.curve=null}GenerateVisibilityGraph(){if(null==this.Obstacles||0==this.Obstacles.length)throw new Error("No obstacles have been set");null==this.GraphGenerator.VisibilityGraph&&this.CreateVisibilityGraph()}static FitArcsIntoCorners(t,n){const r=i.GetFittedArcSegs(t,n),s=new te;let o=null;for(const a of r){const l=i.EllipseIsAlmostLineSegment(a);null!=o?l?te.continueWithLineSegmentP(s,i.CornerPoint(a)):(te.continueWithLineSegmentP(s,a.start),s.addSegment(a)):l?te.addLineSegment(s,n[0],i.CornerPoint(a)):(te.addLineSegment(s,n[0],a.start),s.addSegment(a)),o=a}return s.segs.length>0?te.continueWithLineSegmentP(s,n[n.length-1]):te.addLineSegment(s,n[0],n[n.length-1]),s}static CornerPoint(t){return t.center.add(t.aAxis.add(t.bAxis))}static EllipseIsAlmostLineSegment(t){return t.aAxis.lengthSquared<1e-4||t.aAxis.lengthSquared<1e-4}static*GetFittedArcSegs(t,n){let r=n[1].sub(n[0]),s=r.normalize(),o=Math.min(t,r.length/2);for(let a=1;a<n.length-1;a++){r=n[a+1].sub(n[a]);const l=r.length;if(l<q.intersectionEpsilon){yield new Rt(0,0,new x(0,0),new x(0,0),n[a]);continue}const c=r.div(l);Math.abs(c.dot(s))>.9&&(yield new Rt(0,0,new x(0,0),new x(0,0),n[a]));const u=Math.min(t,r.length/2),y=c.mul(-u),R=s.mul(o);yield new Rt(0,Math.PI/2,y,R,n[a].sub(R.add(y))),s=c,o=u}}}return i.DefaultPadding=1,i.DefaultCornerFitRadius=3,i})();class aP extends dn{constructor(e,t,n){super(null),this.graph=e,this.source=t,this.length=n}get Result(){return this.result}run(){const e=new Vo((r,s)=>r-s),t=new Map;for(const r of this.graph.shallowNodes()){const s=r==this.source?0:Number.POSITIVE_INFINITY;e.Enqueue(r,s),t.set(r,s)}for(;e.count>0;){const r={priority:0},s=e.DequeueAndGetPriority(r);t.set(s,r.priority);const o=t.get(s);for(const a of s.inEdges()){const l=a.source,c=o+this.length(a);t.get(l)>c&&(t.set(l,c),e.DecreasePriority(l,c))}for(const a of s.outEdges()){const l=a.target,c=o+this.length(a);t.get(l)>c&&(t.set(l,c),e.DecreasePriority(l,c))}}this.result=new Array(this.graph.shallowNodeCount);let n=0;for(const r of this.graph.shallowNodes()){const s=t.get(r);this.result[n++]=null!=s?s:Number.POSITIVE_INFINITY}}}class nw extends dn{constructor(e,t){super(null),this.graph=e,this.length=t}get Result(){return this.result}set Result(e){this.result=e}run(){this.result=new Array(this.graph.shallowNodeCount);let e=0;for(const t of this.graph.shallowNodes()){const n=new aP(this.graph,t,this.length);n.run(),this.Result[e++]=n.Result}}static Stress(e,t){let n=0;if(0==e.edgeCount)return n;const r=new nw(e,t);r.run();const s=r.Result;let o=0;for(const l of e.edges())o+=t(l);o/=e.edgeCount;let a=0;for(const l of e.shallowNodes()){let c=0;for(const u of e.shallowNodes()){if(a!=c){const y=l.center.sub(u.center).length,R=o*s[a][c],D=R-y;n+=D*D/(R*R)}c++}a++}return n}}class kU extends dn{constructor(e,t,n){super(null),this.graph=e,this.pivotArray=t,this.length=n}get Result(){return this.result}run(){this.result=new Array(this.pivotArray.length);const e=Array.from(this.graph.shallowNodes()),t=new Array(this.graph.shallowNodeCount).fill(Number.POSITIVE_INFINITY);let n=e[0];this.pivotArray[0]=0;for(let r=0;;r++){const s=new aP(this.graph,n,this.length);if(s.run(),this.Result[r]=s.Result,!(r+1<this.pivotArray.length))break;{let o=0;for(let a=0;a<this.Result[r].length;a++)t[a]=Math.min(t[a],this.Result[r][a]),t[a]>t[o]&&(o=a);n=e[o],this.pivotArray[r+1]=o}}}}class Ft{static DoubleCenter(e){const t=new Array(e.length).fill(0),n=new Array(e[0].length).fill(0);let r=0;for(let s=0;s<e.length;s++)for(let o=0;o<e[0].length;o++)t[s]+=e[s][o],n[o]+=e[s][o],r+=e[s][o];for(let s=0;s<e.length;s++)t[s]/=e.length;for(let s=0;s<e[0].length;s++)n[s]/=e[0].length;r/=e.length,r/=e[0].length;for(let s=0;s<e.length;s++)for(let o=0;o<e[0].length;o++)e[s][o]-=t[s]+n[o]-r}static SquareEntries(e){for(let t=0;t<e.length;t++)for(let n=0;n<e[0].length;n++)e[t][n]=Math.pow(e[t][n],2)}static Multiply(e,t){for(let n=0;n<e.length;n++)for(let r=0;r<e[0].length;r++)e[n][r]*=t}static MultiplyX(e,t){if(e[0].length!=t.length)return null;const n=new Array(t.length).fill(0);for(let r=0;r<e.length;r++)for(let s=0;s<e[0].length;s++)n[r]+=e[r][s]*t[s];return n}static Norm(e){let t=0;for(let n=0;n<e.length;n++)t+=Math.pow(e[n],2);return Math.sqrt(t)}static Normalize(e){const t=Ft.Norm(e);if(t<=0)return 0;for(let n=0;n<e.length;n++)e[n]/=t;return t}static RandomUnitLengthVector(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=FE();return Ft.Normalize(t),t}static SpectralDecomposition(e,t){Ft.SpectralDecompositionIE(e,t,30,1e-6)}static SpectralDecompositionIE(e,t,n,r){const s=e[0].length;t.u1=Ft.RandomUnitLengthVector(s),t.lambda1=0,t.u2=Ft.RandomUnitLengthVector(s),t.lambda2=0;let o=0;const a=1-r;for(let l=0;l<n&&o<a;l++){const c=Ft.MultiplyX(e,t.u1),u=Ft.MultiplyX(e,t.u2);t.lambda1=Ft.Normalize(c),t.lambda2=Ft.Normalize(u),Ft.MakeOrthogonal(u,c),Ft.Normalize(u),o=Math.min(Ft.DotProduct(t.u1,c),Ft.DotProduct(t.u2,u)),t.u1=c,t.u2=u}}static DotProduct(e,t){if(e.length!=t.length)return 0;let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n}static MakeOrthogonal(e,t){if(e.length!=t.length)return;const n=Ft.DotProduct(e,t)/Ft.DotProduct(t,t);for(let r=0;r<e.length;r++)e[r]-=n*t[r]}static ClassicalScaling(e,t){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r].slice();Ft.SquareEntries(n),Ft.DoubleCenter(n),Ft.Multiply(n,-.5),Ft.SpectralDecomposition(n,t),t.lambda1=Math.sqrt(Math.abs(t.lambda1)),t.lambda2=Math.sqrt(Math.abs(t.lambda2));for(let r=0;r<t.u1.length;r++)t.u1[r]*=t.lambda1,t.u2[r]*=t.lambda2}static DistanceScalingSubset(e,t,n,r,s){const o=t.length,a=e.length,l=new Array(a);for(let u=0;u<a;u++)for(let y=0;y<o;y++)0==e[u][y]&&(l[u]=y);const c=new Array(a).fill(0);for(let u=0;u<a;u++)for(let y=0;y<o;y++)l[u]!=y&&(c[u]+=r[u][y]);for(let u=0;u<s;u++)for(let y=0;y<a;y++){let R=0,D=0;for(let L=0;L<o;L++)if(y!=L){let k=Math.sqrt(Math.pow(t[l[y]]-t[L],2)+Math.pow(n[l[y]]-n[L],2));k>0&&(k=1/k),R+=r[y][L]*(t[L]+e[y][L]*(t[l[y]]-t[L])*k),D+=r[y][L]*(n[L]+e[y][L]*(n[l[y]]-n[L])*k)}t[l[y]]=R/c[y],n[l[y]]=D/c[y]}}static DistanceScaling(e,t,n,r,s){const o=t.length,a=new Array(o).fill(0);for(let l=0;l<o;l++)for(let c=0;c<o;c++)l!=c&&(a[l]+=r[l][c]);for(let l=0;l<s;l++)for(let c=0;c<o;c++){let u=0,y=0;for(let R=0;R<o;R++)if(c!=R){let D=Math.sqrt(Math.pow(t[c]-t[R],2)+Math.pow(n[c]-n[R],2));D>0&&(D=1/D),u+=r[c][R]*(t[R]+e[c][R]*(t[c]-t[R])*D),y+=r[c][R]*(n[R]+e[c][R]*(n[c]-n[R])*D)}t[c]=u/a[c],n[c]=y/a[c]}}static ExponentialWeightMatrix(e,t){const n=new Array(e.length);for(let r=0;r<e.length;r++){n[r]=new Array(e[r].length).fill(0);for(let s=0;s<e[r].length;s++)e[r][s]>0&&(n[r][s]=Math.pow(e[r][s],t))}return n}static EuclideanDistanceMatrix(e,t){const n=new Array(e.length);for(let r=0;r<e.length;r++){n[r]=new Array(e.length);for(let s=0;s<e.length;s++)n[r][s]=Math.sqrt(Math.pow(e[r]-e[s],2)+Math.pow(t[r]-t[s],2))}return n}static LandmarkClassicalScaling(e,t,n){const r=new Array(e.length);for(let a=0;a<e.length;a++){r[a]=new Array(e.length);for(let l=0;l<e.length;l++)r[a][l]=e[a][n[l]]}Ft.SquareEntries(r);const s=new Array(e.length).fill(0);for(let a=0;a<e.length;a++){for(let l=0;l<e.length;l++)s[a]+=r[a][l];s[a]/=e.length}Ft.DoubleCenter(r),Ft.Multiply(r,-.5);const o={u1:new Array,u2:new Array,lambda1:0,lambda2:0};Ft.SpectralDecomposition(r,o),o.lambda1=Math.sqrt(Math.abs(o.lambda1)),o.lambda2=Math.sqrt(Math.abs(o.lambda2)),t.x=new Array(e[0].length).fill(0),t.y=new Array(e[0].length).fill(0);for(let a=0;a<t.x.length;a++)for(let l=0;l<r.length;l++){const c=(Math.pow(e[l][a],2)-s[l])/2;t.x[a]-=o.u1[l]*c,t.y[a]-=o.u2[l]*c}}}class GU{constructor(e,t){this.Constrained=!1,this.Capacity=1e6,1==pn.AbovePP(e.point,t.point)?(this.upperSite=e,this.lowerSite=t):(this.lowerSite=e,this.upperSite=t),this.upperSite.AddEdgeToSite(this)}get CcwTriangle(){return this.ccwTriangle}set CcwTriangle(e){this.ccwTriangle=e}get CwTriangle(){return this.cwTriangle}set CwTriangle(e){this.cwTriangle=e}GetOtherTriangle_c(e){return this.cwTriangle.Contains(e)?this.ccwTriangle:this.cwTriangle}IsAdjacent(e){return e==this.upperSite||e==this.lowerSite}GetOtherTriangle_T(e){return this.ccwTriangle==e?this.cwTriangle:this.ccwTriangle}toString(){return Hn.String.Format("({0},{1})",this.upperSite,this.lowerSite)}OtherSite(e){return this.upperSite==e?this.lowerSite:this.upperSite}}class th{constructor(e){this.Owner=null,this.InEdges=new Array,this.point=e}static mkSO(e,t){const n=new th(e);return n.Owner=t,n}AddEdgeToSite(e){null==this.Edges&&(this.Edges=new Array),this.Edges.push(e)}EdgeBetweenUpperSiteAndLowerSite(e){if(null!=this.Edges)for(const t of this.Edges)if(t.lowerSite==e)return t;return null}AddInEdge(e){null==this.InEdges&&(this.InEdges=new Array),this.InEdges.push(e)}*Triangles(){let e;if(null!=this.Edges&&this.Edges.length>0)e=this.Edges[0];else{if(!(null!=this.InEdges&&this.InEdges.length>0))return;e=this.InEdges[0]}let t=e;do{const n=t.upperSite==this?t.CcwTriangle:t.CwTriangle;if(null==n){t=null;break}yield n,t=n.TriEdges.getItem(n.TriEdges.index(t)+2)}while(t!=e);if(t!=e)for(t=e;;){const n=t.upperSite==this?t.CwTriangle:t.CcwTriangle;if(null==n)break;yield n,t=n.TriEdges.getItem(n.TriEdges.index(t)+1)}}toString(){return this.point.toString()}}class rc{constructor(e,t){this.RightSite=t.upperSite==e?t.lowerSite:t.upperSite,this.LeftSite=e,this.Edge=t}get x(){return this.LeftSite.point.x}toString(){return"("+this.LeftSite.toString()+", "+this.Edge.toString()+","+this.RightSite.toString()+")"}}class iw{has(e){return e==this.item0||e==this.item1||e==this.item2}index(e){return e==this.item0?0:e==this.item1?1:e==this.item2?2:-1}getItem(e){switch(e){case 0:case 3:case-3:return this.item0;case 1:case 4:case-2:return this.item1;case 2:case 5:case-1:return this.item2;default:throw new Error}}setItem(e,t){switch(e){case 0:case 3:case-3:this.item0=t;break;case 1:case 4:case-2:this.item1=t;break;case 2:case 5:case-1:this.item2=t;break;default:throw new Error}}[Symbol.iterator](){return this.GetEnumerator()}*GetEnumerator(){yield this.item0,yield this.item1,yield this.item2}}class Or{constructor(){this.TriEdges=new iw,this.Sites=new iw}static mkSSSD(e,t,n,r){const s=x.getTriangleOrientation(e.point,t.point,n.point),o=new Or;switch(s){case Ie.Counterclockwise:o.FillCcwTriangle(e,t,n,r);break;case Ie.Clockwise:o.FillCcwTriangle(e,n,t,r);break;default:throw new Error}return o}static mkSED(e,t,n){const r=new Or;switch(x.getTriangleOrientation(t.upperSite.point,t.lowerSite.point,e.point)){case Ie.Counterclockwise:t.CcwTriangle=r,r.Sites.setItem(0,t.upperSite),r.Sites.setItem(1,t.lowerSite);break;case Ie.Clockwise:t.CwTriangle=r,r.Sites.setItem(0,t.lowerSite),r.Sites.setItem(1,t.upperSite);break;default:throw new Error}return r.TriEdges.setItem(0,t),r.Sites.setItem(2,e),r.CreateEdge(1,n),r.CreateEdge(2,n),r}static mkSSSEE(e,t,n,r,s,o){const a=Or.mkSSSD(e,t,n,o);return a.TriEdges.setItem(0,r),a.TriEdges.setItem(1,s),a.BindEdgeToTriangle(e,r),a.BindEdgeToTriangle(t,s),a.CreateEdge(2,o),a}BindEdgeToTriangle(e,t){e==t.upperSite?t.CcwTriangle=this:t.CwTriangle=this}FillCcwTriangle(e,t,n,r){this.Sites.setItem(0,e),this.Sites.setItem(1,t),this.Sites.setItem(2,n);for(let s=0;s<3;s++)this.CreateEdge(s,r)}CreateEdge(e,t){const n=this.Sites.getItem(e),s=t(n,this.Sites.getItem(e+1));this.TriEdges.setItem(e,s),this.BindEdgeToTriangle(n,s)}Contains(e){return this.Sites.has(e)}OppositeEdge(e){const t=this.Sites.index(e);return this.TriEdges.getItem(t+1)}OppositeSite(e){const t=this.TriEdges.index(e);return this.Sites.getItem(t+2)}BoundingBox(){const e=De.mkPP(this.Sites.getItem(0).point,this.Sites.getItem(1).point);return e.add(this.Sites.getItem(2).point),e}static mkSSSEED(e,t,n,r,s,o){const a=new Or;return a.Sites.setItem(0,e),a.Sites.setItem(1,t),a.Sites.setItem(2,n),a.TriEdges.setItem(0,r),a.TriEdges.setItem(1,s),a.BindEdgeToTriangle(e,r),a.BindEdgeToTriangle(t,s),a.CreateEdge(2,o),a}toString(){return this.Sites.getItem(0).toString()+","+this.Sites.getItem(1).toString()+","+this.Sites.getItem(2).toString()}}class HU{constructor(e,t,n,r,s){this.elementsToBeRemovedFromFront=new Array,this.removedTriangles=new Array,this.edge=e,this.triangles=t,this.front=n,this.leftPolygon=r,this.rightPolygon=s,this.a=e.upperSite,this.b=e.lowerSite}Run(){this.Init(),this.Traverse()}Traverse(){for(;!this.BIsReached();)null!=this.piercedToTheLeftFrontElemNode?this.ProcessLeftFrontPiercedElement():null!=this.piercedToTheRightFrontElemNode?this.ProcessRightFrontPiercedElement():this.ProcessPiercedEdge();null!=this.piercedTriangle&&this.removePiercedTriangle(this.piercedTriangle),this.FindMoreRemovedFromFrontElements();for(const e of this.elementsToBeRemovedFromFront)this.front.remove(e)}ProcessLeftFrontPiercedElement(){let e=this.piercedToTheLeftFrontElemNode;do{this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToLeftPolygon(e.item.LeftSite),e=this.front.previous(e)}while(x.pointToTheLeftOfLine(e.item.LeftSite.point,this.a.point,this.b.point));this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToRightPolygon(e.item.LeftSite),e.item.LeftSite!=this.b?(this.FindPiercedTriangle(e),this.piercedToTheLeftFrontElemNode=null):this.piercedToTheLeftFrontElemNode=e}FindPiercedTriangle(e){var t;const n=e.item.Edge,r=null!==(t=n.CcwTriangle)&&void 0!==t?t:n.CwTriangle,s=r.TriEdges.index(n);for(let o=1;o<=2;o++){const a=r.TriEdges.getItem(o+s),l=br.sign(x.signedDoubledTriangleArea(a.lowerSite.point,this.a.point,this.b.point));if(br.sign(x.signedDoubledTriangleArea(a.upperSite.point,this.a.point,this.b.point))*l<=0){this.piercedTriangle=r,this.piercedEdge=a;break}}}FindMoreRemovedFromFrontElements(){for(const e of this.removedTriangles)for(const t of e.TriEdges)if(null==t.CcwTriangle&&null==t.CwTriangle){const r=Jn.FindNodeInFrontBySite(this.front,t.upperSite.point.x<t.lowerSite.point.x?t.upperSite:t.lowerSite);r.item.Edge==t&&this.elementsToBeRemovedFromFront.push(r.item)}}ProcessPiercedEdge(){this.piercedEdge.CcwTriangle==this.piercedTriangle?(this.AddSiteToLeftPolygon(this.piercedEdge.lowerSite),this.AddSiteToRightPolygon(this.piercedEdge.upperSite)):(this.AddSiteToLeftPolygon(this.piercedEdge.upperSite),this.AddSiteToRightPolygon(this.piercedEdge.lowerSite)),this.removePiercedTriangle(this.piercedTriangle),this.PrepareNextStateAfterPiercedEdge()}PrepareNextStateAfterPiercedEdge(){var e,t;const n=null!==(e=this.piercedEdge.CwTriangle)&&void 0!==e?e:this.piercedEdge.CcwTriangle,r=n.TriEdges.index(this.piercedEdge);for(let s=1;s<=2;s++){const o=n.TriEdges.getItem(s+r),a=br.sign(x.signedDoubledTriangleArea(o.lowerSite.point,this.a.point,this.b.point));if(br.sign(x.signedDoubledTriangleArea(o.upperSite.point,this.a.point,this.b.point))*a<=0){if(null!=o.CwTriangle&&null!=o.CcwTriangle){this.piercedTriangle=n,this.piercedEdge=o;break}this.piercedTriangle=null,this.piercedEdge=null;const c=o.upperSite.point.x<o.lowerSite.point.x?o.upperSite:o.lowerSite,u=Jn.FindNodeInFrontBySite(this.front,c);c.point.x<this.a.point.x?this.piercedToTheLeftFrontElemNode=u:this.piercedToTheRightFrontElemNode=u,this.removePiercedTriangle(null!==(t=o.CwTriangle)&&void 0!==t?t:o.CcwTriangle);break}}}removePiercedTriangle(e){this.triangles.delete(e);for(const t of e.TriEdges)t.CwTriangle==e?t.CwTriangle=null:t.CcwTriangle=null,this.removedTriangles.push(e)}ProcessRightFrontPiercedElement(){let e=this.piercedToTheRightFrontElemNode;do{this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToRightPolygon(e.item.RightSite),e=this.front.next(e)}while(x.pointToTheRightOfLine(e.item.RightSite.point,this.a.point,this.b.point));this.elementsToBeRemovedFromFront.push(e.item),this.AddSiteToLeftPolygon(e.item.RightSite),e.item.RightSite!=this.b?(this.FindPiercedTriangle(e),this.piercedToTheRightFrontElemNode=null):this.piercedToTheRightFrontElemNode=e}AddSiteToLeftPolygon(e){this.AddSiteToPolygonWithCheck(e,this.leftPolygon)}AddSiteToPolygonWithCheck(e,t){e!=this.b&&(0==t.length||t[t.length-1]!=e)&&t.push(e)}AddSiteToRightPolygon(e){this.AddSiteToPolygonWithCheck(e,this.rightPolygon)}BIsReached(){var e;const t=null!==(e=this.piercedToTheLeftFrontElemNode)&&void 0!==e?e:this.piercedToTheRightFrontElemNode;return null!=t?t.item.Edge.IsAdjacent(this.b):this.piercedEdge.IsAdjacent(this.b)}Init(){const e=Jn.FindNodeInFrontBySite(this.front,this.a),t=this.front.previous(e);if(x.pointToTheLeftOfLine(this.b.point,t.item.LeftSite.point,t.item.RightSite.point))this.piercedToTheLeftFrontElemNode=t;else if(x.pointToTheRightOfLine(this.b.point,e.item.RightSite.point,e.item.LeftSite.point))this.piercedToTheRightFrontElemNode=e;else for(const n of this.a.Edges){const r=n.CcwTriangle;if(null==r||x.pointToTheLeftOfLine(this.b.point,n.lowerSite.point,n.upperSite.point))continue;const s=r.TriEdges.index(n),o=r.Sites.getItem(s+2);if(x.pointToTheLeftOfLineOrOnLine(this.b.point,o.point,n.upperSite.point)){this.piercedEdge=r.TriEdges.getItem(s+1),this.piercedTriangle=r;break}}}}class rw{constructor(e,t,n,r){this.rightPolygon=new Array,this.leftPolygon=new Array,this.addedTriangles=new Array,this.edge=e,this.triangles=t,this.front=n,this.createEdgeDelegate=r}Run(){this.TraceEdgeThroughTriangles(),this.TriangulatePolygon0(this.rightPolygon,this.edge.upperSite,this.edge.lowerSite,!0),this.TriangulatePolygon0(this.leftPolygon,this.edge.upperSite,this.edge.lowerSite,!1),this.UpdateFront()}UpdateFront(){const e=new Set;for(const t of this.addedTriangles)for(const n of t.TriEdges)(null==n.CwTriangle||null==n.CcwTriangle)&&e.add(n);for(const t of e)this.AddEdgeToFront(t)}AddEdgeToFront(e){this.front.insert(new rc(e.upperSite.point.x<e.lowerSite.point.x?e.upperSite:e.lowerSite,e))}TriangulatePolygon0(e,t,n,r){e.length>0&&this.TriangulatePolygon1(0,e.length-1,e,t,n,r)}TriangulatePolygon1(e,t,n,r,s,o){let a=n[e],l=e;for(let u=e+1;u<=t;u++){const y=n[u];rw.LocalInCircle(y,r,s,a,o)&&(l=u,a=y)}const c=Or.mkSSSD(r,s,a,this.createEdgeDelegate);this.triangles.add(c),this.addedTriangles.push(c),e<l&&this.TriangulatePolygon1(e,l-1,n,r,a,o),l<t&&this.TriangulatePolygon1(l+1,t,n,a,s,o)}static LocalInCircle(e,t,n,r,s){return s?ow(e,t,r,n):ow(e,t,n,r)}TraceEdgeThroughTriangles(){new HU(this.edge,this.triangles,this.front,this.leftPolygon,this.rightPolygon).Run()}}class lP{constructor(e){this.Edge=e}}class Jn extends dn{constructor(e,t,n,r){if(super(null),this.front=new Xi((o,a)=>o.x-a.x),this.triangles=new Set,this.listOfSites=e,0==this.listOfSites.length)return;this.p_1=t,this.p_2=n,this.createEdgeDelegate=r;const s=Or.mkSSSD(t,n,this.listOfSites[0],r);this.triangles.add(s),this.front.insert(new rc(t,s.TriEdges.getItem(2))),this.front.insert(new rc(this.listOfSites[0],s.TriEdges.getItem(1)))}run(){if(0!=this.listOfSites.length){for(let e=1;e<this.listOfSites.length;e++)this.ProcessSite(this.listOfSites[e]);this.FinalizeTriangulation()}}FinalizeTriangulation(){this.RemoveP1AndP2Triangles(),this.triangles.size>0&&this.MakePerimeterConvex()}MakePerimeterConvex(){let e=this.CreateDoubleLinkedListOfPerimeter();for(;;){const t=this.FindConcaveEdge(e);if(null==t)return;e=this.ShortcutTwoListElements(t)}}FindConcaveEdge(e){let n,t=e;do{if(n=t.Next,x.getTriangleOrientation(t.Start.point,t.End.point,n.End.point)==Ie.Counterclockwise)return t;t=n}while(n!=e);return null}static FindPivot(e){let t=e,n=e;do{n=n.Next,(n.Start.point.x<t.Start.point.x||n.Start.point.x==t.Start.point.x&&n.Start.point.y<t.Start.point.y)&&(t=n)}while(n!=e);return t}FindFirsePerimeterEdge(){for(const e of this.triangles)for(const t of e.TriEdges)if(null==t.GetOtherTriangle_T(e))return t;return null}CreateDoubleLinkedListOfPerimeter(){const e=this.FindFirsePerimeterEdge();let r,t=e,n=null,s=null;const o=new Array;do{r=Jn.CreatePerimeterElementFromEdge(t),o.push(me.mkPP(r.Start.point,r.End.point)),t=Jn.FindNextEdgeOnPerimeter(t),null!=s?(r.Prev=s,s.Next=r):n=r,s=r}while(t!=e);return n.Prev=r,r.Next=n,n}static FindNextEdgeOnPerimeter(e){var t;let n=null!==(t=e.CwTriangle)&&void 0!==t?t:e.CcwTriangle;for(e=n.TriEdges.getItem(n.TriEdges.index(e)+2);null!=e.CwTriangle&&null!=e.CcwTriangle;)n=e.GetOtherTriangle_T(n),e=n.TriEdges.getItem(n.TriEdges.index(e)+2);return e}static CreatePerimeterElementFromEdge(e){const t=new lP(e);return null!=e.CwTriangle?(t.Start=e.upperSite,t.End=e.lowerSite):(t.End=e.upperSite,t.Start=e.lowerSite),t}RemoveP1AndP2Triangles(){const e=new Set;for(const t of this.triangles)(t.Sites.has(this.p_1)||t.Sites.has(this.p_2))&&e.add(t);for(const t of e)Jn.RemoveTriangleWithEdges(this.triangles,t)}static RemoveTriangleWithEdges(e,t){e.delete(t);for(const n of t.TriEdges)n.CwTriangle==t?n.CwTriangle=null:n.CcwTriangle=null,null==n.CwTriangle&&null==n.CcwTriangle&&sw(n.upperSite.Edges,n)}static RemoveTriangleButLeaveEdges(e,t){e.delete(t);for(const n of t.TriEdges)n.CwTriangle==t?n.CwTriangle=null:n.CcwTriangle=null}ProcessSite(e){this.PointEvent(e);for(let t=0;t<e.Edges.length;t++){const n=e.Edges[t];n.Constrained&&this.EdgeEvent(n)}}EdgeEvent(e){Jn.EdgeIsProcessed(e)||new rw(e,this.triangles,this.front,this.createEdgeDelegate).Run()}static EdgeIsProcessed(e){return null!=e.CwTriangle||null!=e.CcwTriangle}ShowFrontWithSite(e,t=null){const n=new Array;if(null!=e.Edges)for(const r of e.Edges)n.push(ot.mkDebugCurveTWCI(200,.8,r.Constrained?"Pink":"Brown",me.mkPP(r.upperSite.point,r.lowerSite.point)));n.push(ot.mkDebugCurveTWCI(200,1,"Brown",Rt.mkFullEllipseNNP(.5,.5,e.point)));for(const r of this.triangles)for(let s=0;s<3;s++){const o=r.TriEdges.getItem(s);n.push(ot.mkDebugCurveTWCI(o.Constrained?155:100,o.Constrained?.8:.4,o.Constrained?"Pink":"Navy",me.mkPP(o.upperSite.point,o.lowerSite.point)))}if(null!=t)for(const r of t)n.push(ot.mkDebugCurveTWCI(100,.5,"Red",r));for(const r of this.front)n.push(ot.mkDebugCurveTWCI(100,5.5,"Green",me.mkPP(r.Edge.upperSite.point,r.Edge.lowerSite.point)))}Show(e){Jn.ShowCdt(Array.from(this.triangles.values()),this.front,null,null,[],e)}static ShowCdt(e,t,n,r,s,o){let a=new Array;if(null!=n)for(const l of n)a.push(ot.mkDebugCurveTWCI(200,.1,"Red",l));if(null!=r)for(const l of r)a.push(ot.mkDebugCurveTWCI(200,.1,"Blue",l));if(null!=t)for(const l of t)a.push(ot.mkDebugCurveTWCI(200,.1,"Green",me.mkPP(l.Edge.upperSite.point,l.Edge.lowerSite.point)));for(const l of e)for(let c=0;c<3;c++){const u=l.TriEdges.getItem(c);a.push(Jn.GetDebugCurveOfCdtEdge(u))}a=a.concat(s)}static GetDebugCurveOfCdtEdge(e){return null==e.CcwTriangle||null==e.CwTriangle?ot.mkDebugCurveTWCI(255,.5,e.Constrained?"Brown":"Black",me.mkPP(e.upperSite.point,e.lowerSite.point)):ot.mkDebugCurveTWCI(200,e.Constrained?.8:.2,e.Constrained?"Pink":"Navy",me.mkPP(e.upperSite.point,e.lowerSite.point))}PointEvent(e){const t=this.ProjectToFront(e),n={rightSite:null},r=t.item.x+q.distanceEpsilon<e.point.x?this.MiddleCase(e,t,n):this.LeftCase(e,t,n);let s=this.InsertSiteIntoFront(r,e,n.rightSite);this.TriangulateEmptySpaceToTheRight(s),s=Jn.FindNodeInFrontBySite(this.front,r),this.TriangulateEmptySpaceToTheLeft(s)}LeftCase(e,t,n){const r=t.item;this.InsertAndLegalizeTriangle(e,r);const s=this.front.previous(t),o=s.item.LeftSite;return n.rightSite=t.item.RightSite,this.InsertAndLegalizeTriangle(e,s.item),this.front.deleteNodeInternal(s),this.front.remove(r),o}MiddleCase(e,t,n){const r=t.item.LeftSite;return n.rightSite=t.item.RightSite,this.InsertAndLegalizeTriangle(e,t.item),this.front.deleteNodeInternal(t),r}TriangulateEmptySpaceToTheLeft(e){const t=e.item.RightSite;let n=this.front.previous(e);for(;null!=n;){const r=n.item,s=r.LeftSite,o=r.RightSite;if(!(o.point.sub(t.point).dot(s.point.sub(o.point))<0)){this.TryTriangulateBasinToTheLeft(e);break}e=this.ShortcutTwoFrontElements(n,e),n=this.front.previous(e)}}ShortcutTwoListElements(e){var t;const n=e.Next;let r=Or.mkSSSEE(e.Start,e.End,n.End,e.Edge,n.Edge,this.createEdgeDelegate);this.triangles.add(r);const s=r.TriEdges.getItem(2);this.LegalizeEdge(e.Start,r.OppositeEdge(e.Start)),r=null!==(t=s.CcwTriangle)&&void 0!==t?t:s.CwTriangle,this.LegalizeEdge(n.End,r.OppositeEdge(n.End));const o=new lP(s);return o.Start=e.Start,o.End=n.End,e.Prev.Next=o,o.Prev=e.Prev,o.Next=n.Next,n.Next.Prev=o,o}ShortcutTwoFrontElements(e,t){var n;const r=e.item,s=t.item;let o=Or.mkSSSEED(r.LeftSite,r.RightSite,s.RightSite,r.Edge,s.Edge,this.createEdgeDelegate);this.triangles.add(o),this.front.deleteNodeInternal(e),this.front.remove(s);const a=o.TriEdges.getItem(2);return this.LegalizeEdge(r.LeftSite,o.OppositeEdge(r.LeftSite)),o=null!==(n=a.CcwTriangle)&&void 0!==n?n:a.CwTriangle,this.LegalizeEdge(s.RightSite,o.OppositeEdge(s.RightSite)),this.front.insert(new rc(r.LeftSite,a))}TryTriangulateBasinToTheLeft(e){if(!Jn.DropsSharpEnoughToTheLeft(e.item))return;const t=new Jt.K;for(t.push(e.item.LeftSite);;){const n=t.pop();e=Jn.FindNodeInFrontBySite(this.front,n);const r=this.front.previous(e);if(null==r)return;if(x.getTriangleOrientation(r.item.LeftSite.point,e.item.LeftSite.point,e.item.RightSite.point)==Ie.Counterclockwise)t.push(r.item.LeftSite),this.ShortcutTwoFrontElements(r,e);else if(e.item.LeftSite.point.y>e.item.RightSite.point.y)t.push(r.item.LeftSite);else{if(r.item.LeftSite.point.y<=r.item.RightSite.point.y)return;t.push(r.item.LeftSite)}}}static DropsSharpEnoughToTheLeft(e){const t=e.Edge;if(e.RightSite!=t.upperSite)return!1;const n=t.lowerSite.point.sub(t.upperSite.point);return n.x>=.5*n.y}InsertSiteIntoFront(e,t,n){let r=null,s=null;for(const o of t.Edges)if(null==s&&o.lowerSite==e&&(s=o),null==r&&o.lowerSite==n&&(r=o),null!=s&&null!=r)break;return this.front.insert(new rc(e,s)),this.front.insert(new rc(t,r))}TriangulateEmptySpaceToTheRight(e){const n=e.item.LeftSite.point;let r=this.front.next(e);for(;null!=r;){const s=r.item,o=s.LeftSite,a=s.RightSite;if(!(o.point.sub(n).dot(a.point.sub(o.point))<0)){this.TryTriangulateBasinToTheRight(e);break}e=this.ShortcutTwoFrontElements(e,r),r=this.front.next(e)}}TryTriangulateBasinToTheRight(e){if(!Jn.DropsSharpEnoughToTheRight(e.item))return;const t=new Jt.K;for(t.push(e.item.LeftSite);;){const n=t.pop();e=Jn.FindNodeInFrontBySite(this.front,n);const r=this.front.next(e);if(null==r)return;if(x.getTriangleOrientation(e.item.LeftSite.point,e.item.RightSite.point,r.item.RightSite.point)==Ie.Counterclockwise)this.ShortcutTwoFrontElements(e,r),t.push(n);else if(e.item.LeftSite.point.y>e.item.RightSite.point.y)t.push(e.item.RightSite);else{if(r.item.LeftSite.point.y>=r.item.RightSite.point.y)return;t.push(e.item.RightSite)}}}static DropsSharpEnoughToTheRight(e){const t=e.Edge;if(e.LeftSite!=t.upperSite)return!1;const n=t.lowerSite.point.sub(t.upperSite.point);return n.x<=-.5*n.y}static FindNodeInFrontBySite(e,t){return e.findLast(n=>n.LeftSite.point.x<=t.point.x)}InsertAndLegalizeTriangle(e,t){var n;if(x.getTriangleOrientation(e.point,t.LeftSite.point,t.RightSite.point)!=Ie.Collinear){const r=Or.mkSED(e,t.Edge,this.createEdgeDelegate);this.triangles.add(r),this.LegalizeEdge(e,r.TriEdges.getItem(0))}else{const r=t.Edge;sw(r.upperSite.Edges,r);let s=null!==(n=r.CcwTriangle)&&void 0!==n?n:r.CwTriangle;const o=s.OppositeSite(r);Jn.RemoveTriangleButLeaveEdges(this.triangles,s),s=Or.mkSSSD(t.LeftSite,o,e,this.createEdgeDelegate);const a=Or.mkSSSD(t.RightSite,o,e,this.createEdgeDelegate);this.triangles.add(s),this.triangles.add(a),this.LegalizeEdge(e,s.OppositeEdge(e)),this.LegalizeEdge(e,a.OppositeEdge(e))}}LegalizeEdge(e,t){t.Constrained||null==t.CcwTriangle||null==t.CwTriangle||(t.CcwTriangle.Contains(e)?this.LegalizeEdgeForOtherCwTriangle(e,t):this.LegalizeEdgeForOtherCcwTriangle(e,t))}LegalizeEdgeForOtherCwTriangle(e,t){const n=t.CwTriangle.TriEdges.index(t);if(cP(e,t.upperSite,t.CwTriangle.Sites.getItem(n+2),t.lowerSite)){const r=uP(e,t);this.LegalizeEdge(e,r.CwTriangle.OppositeEdge(e)),this.LegalizeEdge(e,r.CcwTriangle.OppositeEdge(e))}}LegalizeEdgeForOtherCcwTriangle(e,t){const n=t.CcwTriangle.TriEdges.index(t);if(cP(e,t.lowerSite,t.CcwTriangle.Sites.getItem(n+2),t.upperSite)){const r=uP(e,t);this.LegalizeEdge(e,r.CwTriangle.OppositeEdge(e)),this.LegalizeEdge(e,r.CcwTriangle.OppositeEdge(e))}}ProjectToFront(e){return this.front.findLast(t=>t.x<=e.point.x)}}function sw(i,e){if(0==i.length)return;const t=i.findIndex(n=>e==n);t>=0&&(t!=i.length-1&&(i[t]=i[i.length-1]),i.pop())}function cP(i,e,t,n){return function YU(i,e,t,n){return x.getTriangleOrientation(e.point,i.point,t.point)==Ie.Clockwise&&x.getTriangleOrientation(t.point,i.point,n.point)==Ie.Clockwise}(i,e,t,n)&&ow(i,e,t,n)}function ow(i,e,t,n){const r=e.point.x-i.point.x,s=e.point.y-i.point.y,o=t.point.x-i.point.x,a=t.point.y-i.point.y,l=n.point.x-i.point.x,c=n.point.y-i.point.y,u=r*r+s*s,y=o*o+a*a,R=l*l+c*c;return r*(a*R-c*y)-o*(s*R-c*u)+l*(s*y-a*u)>q.tolerance}function uP(i,e){let t,n;e.CcwTriangle.Contains(i)?(t=e.CcwTriangle,n=e.CwTriangle):(t=e.CwTriangle,n=e.CcwTriangle);const r=t.TriEdges.index(e),s=n.TriEdges.index(e),o=n.Sites.getItem(s+2),a=t.TriEdges.getItem(r+1),l=n.TriEdges.getItem(s+1),c=pn.GetOrCreateEdge(i,o);return t.Sites.setItem(r+1,o),t.TriEdges.setItem(r,l),t.TriEdges.setItem(r+1,c),n.Sites.setItem(s+1,i),n.TriEdges.setItem(s,a),n.TriEdges.setItem(s+1,c),l.lowerSite==o?l.CcwTriangle=t:l.CwTriangle=t,a.lowerSite==i?a.CcwTriangle=n:a.CwTriangle=n,c.upperSite==i?(c.CcwTriangle=n,c.CwTriangle=t):(c.CcwTriangle=t,c.CwTriangle=n),sw(e.upperSite.Edges,e),c}class pn extends dn{constructor(e,t,n){super(null),this.isolatedSites=[],this.obstacles=[],this.PointsToSites=new Di,this.cdtTree=null,this.isolatedSites=e,this.obstacles=t,this.isolatedSegments=n}static constructor_(e){const t=new pn(null,null,null);return t.isolatedSitesWithObject=e,t}FillAllInputSites(){if(null!=this.isolatedSitesWithObject)for(const e of this.isolatedSitesWithObject)this.AddSite(e[0],e[1]);if(null!=this.isolatedSites)for(const e of this.isolatedSites)this.AddSite(e,null);if(null!=this.obstacles)for(const e of this.obstacles)this.AddPolylineToAllInputSites(e);if(null!=this.isolatedSegments)for(const e of this.isolatedSegments)this.AddConstrainedEdge(e.A,e.B,null);this.AddP1AndP2(),this.allInputSites=Array.from(this.PointsToSites.values())}AddSite(e,t){let n;return(n=this.PointsToSites.get(e))?n.Owner=t:(n=th.mkSO(e,t),this.PointsToSites.set(e,n)),n}AddP1AndP2(){const e=De.mkEmpty();for(const r of this.PointsToSites.keys())e.add(r);const t=Math.max(e.width/3,1),n=Math.max(e.height/3,1);this.P1=new th(e.leftBottom.add(new x(-t,-n))),this.P2=new th(e.rightBottom.add(new x(t,-n)))}AddPolylineToAllInputSites(e){for(let t=e.startPoint;null!=t.next;t=t.next)this.AddConstrainedEdge(t.point,t.next.point,e);e.closed&&this.AddConstrainedEdge(e.endPoint.point,e.startPoint.point,e)}AddConstrainedEdge(e,t,n){let s,o;pn.AbovePP(e,t)>0?(s=this.AddSite(e,n),o=this.AddSite(t,n)):(s=this.AddSite(t,n),o=this.AddSite(e,n)),pn.CreateEdgeOnOrderedCouple(s,o).Constrained=!0}static GetOrCreateEdge(e,t){if(1==pn.AboveCC(e,t)){const n=e.EdgeBetweenUpperSiteAndLowerSite(t);return null!=n?n:pn.CreateEdgeOnOrderedCouple(e,t)}{const n=t.EdgeBetweenUpperSiteAndLowerSite(e);return null!=n?n:pn.CreateEdgeOnOrderedCouple(t,e)}}static CreateEdgeOnOrderedCouple(e,t){return new GU(e,t)}GetTriangles(){return this.sweeper.triangles}run(){this.Initialization(),this.SweepAndFinalize()}SweepAndFinalize(){this.sweeper=new Jn(this.allInputSites,this.P1,this.P2,pn.GetOrCreateEdge),this.sweeper.run()}Initialization(){this.FillAllInputSites(),this.allInputSites.sort(pn.OnComparison)}static OnComparison(e,t){return pn.AboveCC(e,t)}static AbovePP(e,t){let n=e.y-t.y;return n>0?1:n<0?-1:(n=e.x-t.x,n>0?-1:n<0?1:0)}static AboveCC(e,t){return pn.AbovePP(e.point,t.point)}RestoreEdgeCapacities(){for(const e of this.allInputSites)for(const t of e.Edges)t.Constrained||(t.ResidualCapacity=t.Capacity)}SetInEdges(){for(const e of this.PointsToSites.values())for(const t of e.Edges)t.lowerSite.AddInEdge(t)}FindSite(e){return this.PointsToSites.get(e)}static PointIsInsideOfTriangle(e,t){for(let n=0;n<3;n++){const r=t.Sites.getItem(n).point,s=t.Sites.getItem(n+1).point;if(x.signedDoubledTriangleArea(e,r,s)<-1*q.distanceEpsilon)return!1}return!0}GetCdtTree(){return null==this.cdtTree&&(this.cdtTree=fn(Array.from(this.GetTriangles().values()).map(e=>Gn(e,e.BoundingBox())))),this.cdtTree}EdgeIsCorrect(e){const t=e.upperSite;let n=!1;for(const s of t.Edges)if(s==e){n=!0;break}return!!n&&this.PointsToSites.get(t.point)==t}}class nh{constructor(e,t){this.start=e,this.end=t}add(e){this.add_d(e)}add_rect(e){const t=e,n=this.clone();return n.add_d(t.start),n.add_d(t.end),n}clone(){return new nh(this.start,this.end)}contains_point(e){return this.contains_d(e)}contains_rect(e){const t=e;return this.contains_d(t.start)&&this.contains_d(t.end)}intersection_rect(e){const t=e;return new nh(Math.max(this.start,t.start),Math.min(this.end,t.end))}intersects_rect(e){return this.intersects(e)}contains_point_radius(e,t){return this.contains_d(e-t)&&this.contains_d(e+t)}static mkInterval(e,t){const n=new nh(e.start,e.end);return n.add_d(t.start),n.add_d(t.end),n}add_d(e){this.start>e&&(this.start=e),this.end<e&&(this.end=e)}get Start(){return this.start}set Start(e){this.start=e}get Length(){return this.end-this.start}contains_d(e){return this.start<=e&&e<=this.end}GetInRange(e){return e<this.start?this.start:e>this.end?this.end:e}intersects(e){return!(e.start>this.end+q.distanceEpsilon||e.end<this.start-q.distanceEpsilon)}}class hP{constructor(e){this.heapSize=0,this._priors=new Array(e),this._heap=new Array(e+1),this._reverse_heap=new Array(e)}get Count(){return this.heapSize}SwapWithParent(e){const t=this._heap[e>>1];this.PutAtI(e>>1,this._heap[e]),this.PutAtI(e,t)}Enqueue(e,t){this.heapSize++;let n=this.heapSize;for(this._priors[e]=t,this.PutAtI(n,e);n>1&&this._priors[this._heap[n>>1]]>t;)this.SwapWithParent(n),n>>=1}PutAtI(e,t){this._heap[e]=t,this._reverse_heap[t]=e}Dequeue(){if(0==this.heapSize)throw new Error;const e=this._heap[1];if(this.heapSize>1){this.PutAtI(1,this._heap[this.heapSize]);let t=1;for(;;){let n=t;const r=t<<1;r<=this.heapSize&&this._priors[this._heap[r]]<this._priors[this._heap[t]]&&(n=r);const s=r+1;if(s<=this.heapSize&&this._priors[this._heap[s]]<this._priors[this._heap[n]]&&(n=s),n==t)break;this.SwapWithParent(n),t=n}}return this.heapSize--,e}IsEmpty(){return 0==this.heapSize}DecreasePriority(e,t){this._priors[e]=t;let n=this._reverse_heap[e];for(;n>1&&this._priors[this._heap[n]]<this._priors[this._heap[n>>1]];)this.SwapWithParent(n),n>>=1}}class UU{constructor(e,t,n,r){this._numberOfOverlaps=0,this._proximityEdges=e,this._nodeSizes=t,this._nodePositions=n,this._forLayers=r,this._q=new hP(2*t.length)}Run(){return this.InitQueue(),this.FindOverlaps(),this._numberOfOverlaps}FindOverlaps(){for(;this._q.Count>0;){let e=this._q.Dequeue();e<this._nodePositions.length?(this.FindOverlapsWithInterval(e),this.AddIntervalToTree(e)):(e-=this._nodePositions.length,this.RemoveIntervalFromTree(e))}}RemoveIntervalFromTree(e){this._intervalTree.Remove(this.GetInterval(e),e)}AddIntervalToTree(e){const t=this.GetInterval(e);null==this._intervalTree&&(this._intervalTree=NE([])),this._intervalTree.Add(t,e)}FindOverlapsWithInterval(e){if(null==this._intervalTree)return;const t=this.GetInterval(e);for(const n of this._intervalTree.GetAllIntersecting(t)){const r=Os.GetIdealEdge(e,n,this._nodePositions[e],this._nodePositions[n],this._nodeSizes);if(r.overlapFactor<=1)return;this._proximityEdges.push(r),this._numberOfOverlaps++}}GetInterval(e){const t=this._nodeSizes[e].width/2,n=this._nodePositions[e].x;return new nh(n-t,n+t)}InitQueue(){for(let e=0;e<this._nodeSizes.length;e++){const t=this._nodeSizes[e].height/2,n=this._nodePositions[e].y;this._q.Enqueue(e,n-t),this._q.Enqueue(this._nodeSizes.length+e,n+t)}}}class dP{constructor(e,t,n){this.treeNodes=new Set,this.hedgehog=new Map,this.graph=e,this.weight=t,this.root=n,this.q=new hP(this.graph.nodeCount)}NodeIsInTree(e){return this.treeNodes.has(e)}GetTreeEdges(){const e=new Array;for(this.Init();e.length<this.graph.nodeCount-1&&this.q.Count>0;)this.AddEdgeToTree(e);return e}AddEdgeToTree(e){const t=this.q.Dequeue(),n=this.hedgehog.get(t);this.treeNodes.add(t),e.push(n),this.UpdateOutEdgesOfV(t),this.UpdateInEdgesOfV(t)}UpdateOutEdgesOfV(e){for(const t of this.graph.outEdges[e]){const n=t.target;if(this.NodeIsInTree(n))continue;const r=this.hedgehog.get(n);if(r){const s=this.weight(r),o=this.weight(t);o<s&&(this.q.DecreasePriority(n,o),this.hedgehog.set(n,t))}else this.q.Enqueue(n,this.weight(t)),this.hedgehog.set(n,t)}}UpdateInEdgesOfV(e){for(const t of this.graph.inEdges[e]){const n=t.source;if(this.NodeIsInTree(n))continue;const r=this.hedgehog.get(n);if(r){const s=this.weight(r),o=this.weight(t);o<s&&(this.q.DecreasePriority(n,o),this.hedgehog.set(n,t))}else this.q.Enqueue(n,this.weight(t)),this.hedgehog.set(n,t)}}Init(){this.treeNodes.add(this.root);for(const e of this.graph.outEdges[this.root]){const t=this.weight(e);this.q.Enqueue(e.target,t),this.hedgehog.set(e.target,e)}for(const e of this.graph.inEdges[this.root]){const t=this.weight(e);this.q.Enqueue(e.source,t),this.hedgehog.set(e.source,e)}}}class aw{static GetMst(e,t){if(0==e.length)return null;const n=e.map(l=>new mt(l.source,l.target)),r=n.reduce((l,c)=>Math.max(l,Math.max(c.x,c.y)),0),s=new Yl(r+1);for(let l=0;l<e.length;l++)s.setPair(n[l],e[l]);const o=Xs(n,t);return new dP(o,l=>s.get(l.source,l.target).weight,n[0].source).GetTreeEdges().map(l=>s.get(l.source,l.target))}static GetMstOnCdt(e,t){const n=Array.from(e.PointsToSites.values()),r=new Map;for(let l=0;l<n.length;l++)r.set(n[l],l);const s=aw.GetEdges(n,r),o=bI(Array.from(s.keys()));return new dP(o,l=>t(s.get(l.source,l.target)),0).GetTreeEdges().map(l=>s.get(l.source,l.target))}static GetEdges(e,t){const n=new Yl(e.length);for(let r=0;r<e.length;r++){const s=e[r],o=t.get(s);for(const a of s.Edges)n.set(o,t.get(a.lowerSite),a)}return n}}class lw{constructor(){this.epsilon=.01,this.iterationsMax=1e3,this.stopOnMaxIterat=!1,this.nodeSeparation=4,this.randomizationSeed=1,this.randomizeAllPointsOnStart=!1}get StopOnMaxIterat(){return this.stopOnMaxIterat}set StopOnMaxIterat(e){this.stopOnMaxIterat=e}get Epsilon(){return this.epsilon}set Epsilon(e){this.epsilon=e}get IterationsMax(){return this.iterationsMax}set IterationsMax(e){this.iterationsMax=e}get NodeSeparation(){return this.nodeSeparation}set NodeSeparation(e){this.nodeSeparation=e}get RandomizationSeed(){return this.randomizationSeed}set RandomizationSeed(e){this.randomizationSeed=e}get RandomizeAllPointsOnStart(){return this.randomizeAllPointsOnStart}set RandomizeAllPointsOnStart(e){this.randomizeAllPointsOnStart=e}Clone(){const e=new lw;return e.Epsilon=this.Epsilon,e.IterationsMax=this.IterationsMax,e.StopOnMaxIterat=this.StopOnMaxIterat,e.NodeSeparation=this.NodeSeparation,e.RandomizationSeed=this.RandomizationSeed,e.RandomizeAllPointsOnStart=this.randomizeAllPointsOnStart,e}}class Os{constructor(e,t){this._settings=e,this._nodes=t}static RemoveOverlaps(e,t){const n=new lw;n.RandomizeAllPointsOnStart=!0,n.NodeSeparation=t,new Os(n,e).RemoveOverlaps()}RemoveOverlaps(){if(this._nodes.length<3)return void this.RemoveOverlapsOnTinyGraph();const e={nodePositions:new Array,nodeSizes:new Array};for(function WU(i,e,t){t.nodePositions=e.map(n=>n.center),t.nodeSizes=e.map(n=>{const r=n.boundingBox.size;return r.width+=i.NodeSeparation,r.height+=i.NodeSeparation,r})}(this._settings,this._nodes,e),this.lastRunNumberIterations=0;this.OneIteration(e.nodePositions,e.nodeSizes,!1);)this.lastRunNumberIterations++;for(;this.OneIteration(e.nodePositions,e.nodeSizes,!0);)this.lastRunNumberIterations++;for(let t=0;t<this._nodes.length;t++)this._nodes[t].center=e.nodePositions[t]}RemoveOverlapsOnTinyGraph(){if(1!=this._nodes.length&&2==this._nodes.length){const e=this._nodes[0],t=this._nodes[1];x.closeDistEps(e.center,t.center)&&(t.center=t.center.add(new x(.001,0)));const n=this.GetIdealDistanceBetweenTwoNodes(e,t),r=x.middle(e.center,t.center);let s=e.center.sub(t.center);s=s.mul(n/s.length*.5),e.center=r.add(s),t.center=r.sub(s)}}GetIdealDistanceBetweenTwoNodes(e,t){const n=e.center.sub(t.center),r=Math.abs(n.x),s=Math.abs(n.y);let l=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY;return r>q.tolerance&&(l=((e.width+t.width)/2+this._settings.NodeSeparation)/r),s>q.tolerance&&(c=((e.height+t.height)/2+this._settings.NodeSeparation)/s),Math.min(l,c)*n.length}static AvgEdgeLength(e){let t=0,n=0;for(const r of e)for(const s of r.outEdges())n+=r.center.sub(s.target.center).length,t++;return t>0?n/t:1}OneIteration(e,t,n){const r=new Array;for(let u=0;u<e.length;u++)r.push([e[u],u]);const s=pn.constructor_(r);s.run();const o=new Map;for(let u=0;u<e.length;u++)o.set(s.PointsToSites.get(e[u]),u);let a=0;const l=new Array;for(const u of s.PointsToSites.values())for(const y of u.Edges){const R=y.upperSite.point,D=y.lowerSite.point,L=o.get(y.upperSite),k=o.get(y.lowerSite),W=Os.GetIdealEdge(L,k,R,D,t);l.push(W),W.overlapFactor>1&&a++}if(0==a||n){const u=this.FindProximityEdgesWithSweepLine(l,t,e);if(0==a&&0==u||0==a&&!n)return!1}const c=aw.GetMst(l,e.length);return Os.MoveNodePositions(c,e,c[0].source),!0}FindProximityEdgesWithSweepLine(e,t,n){return new UU(e,t,n,this._overlapForLayers).Run()}static GetIdealEdge(e,t,n,r,s){const o={overlapFactor:0},a=Os.GetIdealEdgeLength(e,t,n,r,s,o),l=n.sub(r).length,c=De.mkSizeCenter(s[e],n),u=De.mkSizeCenter(s[t],r),y=o.overlapFactor>1?l-a:Os.GetDistanceRects(c,u);return{source:Math.min(e,t),target:Math.max(e,t),overlapFactor:o.overlapFactor,idealDistance:a,weight:y}}static GetIdealEdgeLength(e,t,n,r,s,o){const a=n.sub(r),l=a.length,c=Math.abs(a.x),u=Math.abs(a.y),y=(s[e].width+s[t].width)/2,R=(s[e].height+s[t].height)/2;if(c>=y||u>=R)return o.overlapFactor=1,a.length;let D;const L=1e-10;if(c>L)D=u>L?Math.min(y/c,R/u):y/c;else{if(!(u>L))return o.overlapFactor=2,Math.sqrt(y*y+R*R)/4;D=R/u}return D=Math.max(D,1.001),o.overlapFactor=D,D*l}static GetDistanceRects(e,t){if(e.intersects(t))return 0;let n=0,r=0;return(e.right<t.left||t.right<e.left)&&(r=e.left-t.right),e.top<t.bottom?n=t.bottom-e.top:t.top<e.bottom&&(n=e.bottom-t.top),Math.sqrt(r*r+n*n)}static MoveNodePositions(e,t,n){const r=t.map(o=>o.clone()),s=new Set;s.add(n);for(let o=0;o<e.length;o++){const a=e[o];s.has(a.source)?Os.MoveNode(a.source,a.target,r,t,s,a.idealDistance):Os.MoveNode(a.target,a.source,r,t,s,a.idealDistance)}}static MoveNode(e,t,n,r,s,o){let a=n[t].sub(n[e]);a=a.mul(o/a.length+.01),r[t]=r[e].add(a),s.add(t)}GetLastRunIterations(){return this.lastRunNumberIterations}}class Wf extends dn{constructor(e,t,n,r){super(n),this.settings=e,this.graph=t,this.length=r}run(){this.LayoutConnectedGraphWithMds(),this.SetGraphBoundingBox()}SetGraphBoundingBox(){this.graph.boundingBox=this.graph.pumpTheBoxToTheGraphWithMargins(this.settings.NodeSeparation/2)}static ScaleToAverageEdgeLength(e,t,n,r){const s=new Map;let o=0;for(const c of e.shallowNodes())s.set(c,o),o++;let a=0,l=0;for(const c of e.edges()){const u=s.get(c.source),y=s.get(c.target);l+=Math.sqrt(Math.pow(t[u]-t[y],2)+Math.pow(n[u]-n[y],2)),a+=r(c)}if(a>0&&(l/=a),l>0)for(let c=0;c<t.length;c++)t[c]/=l,n[c]/=l}static LayoutGraphWithMds(e,t,n,r){if(n.x=new Array(e.shallowNodeCount),n.y=new Array(e.shallowNodeCount),0==n.x.length)return;if(1==n.x.length)return void(n.x[0]=n.y[0]=0);const s=Math.min(t.PivotNumber,e.shallowNodeCount),o=t.GetNumberOfIterationsWithMajorization(e.shallowNodeCount),a=t.Exponent,l=new Array(s),c=new kU(e,l,r);if(c.run(),Ft.LandmarkClassicalScaling(c.Result,n,l),Wf.ScaleToAverageEdgeLength(e,n.x,n.y,r),o>0){const y=new nw(e,r);y.run();const R=y.Result,D=Ft.ExponentialWeightMatrix(R,a);Ft.DistanceScalingSubset(R,n.x,n.y,D,o)}}LayoutConnectedGraphWithMds(){const e={x:[],y:[]};Wf.LayoutGraphWithMds(this.graph,this.settings,e,this.length),0!=this.settings.RotationAngle&&class VU{static Rotate(e,t,n){const r=Math.sin(n*(Math.PI/180)),s=Math.cos(n*(Math.PI/180));for(let o=0;o<e.length;o++){const a=s*e[o]+r*t[o];t[o]=s*t[o]-r*e[o],e[o]=a}}}.Rotate(e.x,e.y,this.settings.RotationAngle);let t=0;for(const n of this.graph.shallowNodes())n.boundingBox&&(n.center=new x(e.x[t]*this.settings.ScaleX,e.y[t]*this.settings.ScaleY)),t++;this.settings.RemoveOverlaps&&Os.RemoveOverlaps(Array.from(this.graph.shallowNodes()),this.settings.NodeSeparation),this.graph.pumpTheBoxToTheGraphWithMargins(this.settings.NodeSeparation/2)}ScaleNodes(e,t){for(const n of e)n.center=n.center.mul(t)}static PackGraphs(e,t){if(0==e.length)return De.mkEmpty();if(1==e.length)return e[0].boundingBox;const n=e.map(o=>o.boundingBox),r=new Array;for(const o of e)r.push({g:o,lb:o.boundingBox.leftBottom.clone()});const s=new yI(n,t.PackingAspectRatio);s.run();for(const{g:o,lb:a}of r){const l=o.boundingBox.leftBottom.sub(a);o.translate(l)}return new De({left:0,bottom:0,right:s.PackedWidth,top:s.PackedHeight})}}class fP extends OI{constructor(){super(...arguments),this.pivotNumber=50,this.iterationsWithMajorization=30,this.scaleX=200,this.scaleY=200,this.exponent=-2,this.rotationAngle=0,this.removeOverlaps=!0,this._callIterationsWithMajorizationThreshold=3e3,this.adjustScale=!1}get RemoveOverlaps(){return this.removeOverlaps}set RemoveOverlaps(e){this.removeOverlaps=e}get PivotNumber(){return this.pivotNumber}set PivotNumber(e){this.pivotNumber=e}get IterationsWithMajorization(){return this.iterationsWithMajorization}set IterationsWithMajorization(e){this.iterationsWithMajorization=e}get ScaleX(){return this.scaleX}set ScaleX(e){this.scaleX=e}get ScaleY(){return this.scaleY}set ScaleY(e){this.scaleY=e}get Exponent(){return this.exponent}set Exponent(e){this.exponent=e}get RotationAngle(){return this.rotationAngle}set RotationAngle(e){this.rotationAngle=e%360}get IdealEdgeLength(){return this.edgeConstraints}set IdealEdgeLength(e){this.edgeConstraints=e}get AdjustScale(){return this.adjustScale}set AdjustScale(e){this.adjustScale=e}GetNumberOfIterationsWithMajorization(e){return e>this.CallIterationsWithMajorizationThreshold?0:this.IterationsWithMajorization}get CallIterationsWithMajorizationThreshold(){return this._callIterationsWithMajorizationThreshold}set CallIterationsWithMajorizationThreshold(e){this._callIterationsWithMajorizationThreshold=e}}class gP extends dn{constructor(e,t,n,r){super(t),this.graph=e,this.length=n,this.settings=r,this.settings.ScaleX=this.settings.ScaleY=200}get scaleX(){return this.settings.ScaleX}set scaleX(e){this.settings.ScaleX=e}get scaleY(){return this.settings.ScaleY}set scaleY(e){this.settings.ScaleY=e}run(){new Wf(this.settings,this.graph,this.cancelToken,this.length).run()}}function pP(i,e){i.layoutSettings||(i.layoutSettings=e);for(const t of i.shallowNodes())t instanceof Jr&&pP(t,i.layoutSettings)}function mP(i){for(;;){if(i.layoutSettings&&i.layoutSettings.edgeRoutingSettings)return i.layoutSettings.edgeRoutingSettings;const t=i.graph.parent;if(!t)break;i=kn.getGeom(t)}const e=new TI;return e.EdgeRoutingMode=Cn.Spline,e}function yP(i,e,t){const n=mP(i);if(n.EdgeRoutingMode==Cn.Rectilinear)!function JU(i,e,t,n=1,r=3){BU.constructorGNANB(i,e,n,r,!0).run()}(i,e);else if(n.EdgeRoutingMode==Cn.Spline||n.EdgeRoutingMode==Cn.SplineBundling)!function uW(i,e,t){const n=i.layoutSettings?i.layoutSettings.edgeRoutingSettings:mP(i);new zt(i,e,n.Padding,n.PolylinePadding,n.coneAngle,n.BundlingSettings,t).run()}(i,e,t);else if(n.EdgeRoutingMode==Cn.StraightLine)!function hW(i,e,t){if(e)for(const n of e){if(t&&t.canceled)return;Fi.RouteEdge(n,i.padding)}else for(const n of i.deepNodes()){if(t&&t.canceled)return;for(const r of n.outEdges())null==r.curve&&Fi.RouteEdge(r,i.padding);for(const r of n.selfEdges())null==r.curve&&Fi.RouteEdge(r,i.padding)}}(i,e,t);else if(null==i.graph.parent&&n.EdgeRoutingMode!=Cn.None){const r=Array.from(i.deepEdges()).filter(s=>!s.curve);r.length>0&&new zt(i,r).run()}}function cw(i,e,t,n,r,s=!0){if(i.graph.isEmpty())return;const o=function R(){const L=new Set,k=i.graph;if(null==k.parent)return L;for(const W of k.shallowNodes){for(const X of W.outEdges){const ne=k.liftNode(X.target);(null==ne||ne==W)&&L.add(X)}for(const X of W.inEdges){const ne=k.liftNode(X.source);(null==ne||ne==W)&&L.add(X)}}for(const W of L)W.remove();return L}();!function y(L){for(const k of L.shallowNodes())if(k instanceof Jr){const W=k;if(cw(W,e,t,n,r),!W.graph.isEmpty()){const X=W.boundingBox;X&&!X.isEmpty()&&(k.boundaryCurve=vi.mkRectangleWithRoundedCorners(X.width,X.height,Math.min(10,X.width/10),Math.min(10,X.height/10),X.center))}}}(i);const a=function KU(i){const e=new Array;for(const t of i.deepNodes){const n=i.liftNode(t);if(null!=n)for(const r of t.outEdges.values()){const s=r.target,o=i.liftNode(s);if(null==o||n==t&&o==s||n==o)continue;r.remove();const a=new pI(n,o),l=new Do(a);e.push([l,r])}}return e}(i.graph),l=function $U(i){const e=i.graph,t=function*g3(i){const e=new Set,t=new Io.c;for(const s of i.shallowNodes){if(e.has(s))continue;const o=new Array;for(r(s,t,e);t.length>0;){const a=t.dequeue();o.push(a);for(const l of n(a))r(l,t,e)}yield o}function*n(s){for(const o of s.outEdges)yield o.target;for(const o of s.inEdges)yield o.source}function r(s,o,a){a.has(s)||(o.enqueue(s),a.add(s))}}(e),n=[];let r=0;for(const s of t){const o=new Ki(e.id+r++);o.parent=e;const a=new Jr(o);a.layoutSettings=i.layoutSettings;for(const l of s)l.parent=o,o.addNode(l);n.push(a)}return n}(i);(function D(){if(0!=l.length){for(const L of l)t(L,e);r(i,l)}})(),a.forEach(L=>{L[0].edge.remove(),L[1].add()}),l.forEach(L=>{for(const k of L.graph.shallowNodes)k.parent=i.graph});const c=function u(L){const k=[];for(const W of L.deepNodes()){for(const X of W.outEdges())null==X.curve&&k.push(X);for(const X of W.selfEdges())null==X.curve&&k.push(X)}return k}(i);o.forEach(L=>L.add()),n(i,c,e),null==i.graph.parent&&s&&i.FlipYAndMoveLeftTopToOrigin()}class uw{static constructorStatic(e,t){const n=new uw;n.edges=e,n.nodeBoundaries=t,n.boundingBox=De.mkEmpty();for(const r of n.nodeBoundaries)n.boundingBox=n.boundingBox.addRec(r.boundingBox);return n}AddGraph(e){this.edges=this.edges.concat(e.edges),this.nodeBoundaries=zl(this.nodeBoundaries,e.nodeBoundaries),this.boundingBox.addRec(e.boundingBox)}AddNodeBoundary(e){this.nodeBoundaries.add(e),this.boundingBox.addRec(e.boundingBox)}}var ih=(()=>{return(i=ih||(ih={}))[i.Success=0]="Success",i[i.Overlaps=1]="Overlaps",i[i.EdgeSeparationIsTooLarge=2]="EdgeSeparationIsTooLarge",ih;var i})(),EP=h(2243);class jf{constructor(e,t,n){this.currentTriangle=e,this.start=t,this.end=n}get CurrentPiercedEdge(){return this.currentPiercedEdge}get CurrentTriangle(){return this.currentTriangle}*Triangles(){for(;this.MoveNext();)yield this.CurrentTriangle}FindFirstPiercedEdge(){const e=this.GetHyperplaneSign(this.currentTriangle.Sites.item0),t=this.GetHyperplaneSign(this.currentTriangle.Sites.item1);if(e!=t&&x.getTriangleOrientation(this.end,this.currentTriangle.Sites.item0.point,this.currentTriangle.Sites.item1.point)==Ie.Clockwise)return this.positiveSign=e,this.negativeSign=t,this.currentTriangle.TriEdges.item0;const n=this.GetHyperplaneSign(this.currentTriangle.Sites.item2);return t!=n&&x.getTriangleOrientation(this.end,this.currentTriangle.Sites.item1.point,this.currentTriangle.Sites.item2.point)==Ie.Clockwise?(this.positiveSign=t,this.negativeSign=n,this.currentTriangle.TriEdges.item1):(this.positiveSign=n,this.negativeSign=e,this.currentTriangle.TriEdges.item2)}static PointLocationForTriangle(e,t){let n=!1;for(let r=0;r<3;r++){const s=x.signedDoubledTriangleArea(e,t.Sites.getItem(r).point,t.Sites.getItem(r+1).point);if(s<-1*q.distanceEpsilon)return We.Outside;s<q.distanceEpsilon&&(n=!0)}return n?We.Boundary:We.Inside}FindNextPierced(){if(this.currentTriangle=this.currentPiercedEdge.GetOtherTriangle_T(this.currentTriangle),null==this.currentTriangle)return void(this.currentPiercedEdge=null);const e=this.currentTriangle.TriEdges.index(this.currentPiercedEdge);let t;const n=this.currentTriangle.Sites.getItem(e+2),r=this.GetHyperplaneSign(n);0==this.negativeSign?-1==r||0==r?(this.negativeSign=r,t=e+1):t=e+2:0==this.positiveSign?1==r||0==r?(this.positiveSign=r,t=e+2):t=e+1:r!=this.positiveSign?(this.negativeSign=r,t=e+1):(this.positiveSign=r,t=e+2),this.currentPiercedEdge=x.signedDoubledTriangleArea(this.end,this.currentTriangle.Sites.getItem(t).point,this.currentTriangle.Sites.getItem(t+1).point)<-q.distanceEpsilon?this.currentTriangle.TriEdges.getItem(t):null}GetHyperplaneSign(e){const t=x.signedDoubledTriangleArea(this.start,e.point,this.end);return t>q.distanceEpsilon?1:t<-1*q.distanceEpsilon?-1:0}MoveNext(){return null==this.currentPiercedEdge?this.currentPiercedEdge=this.FindFirstPiercedEdge():this.FindNextPierced(),null!=this.currentPiercedEdge}}class hw{constructor(e,t){this.ComputeForcesForBundles=!1,this.metroGraphData=e,this.bundlingSettings=t}EdgeIsLegal_(e,t,n,r){if(pn.PointIsInsideOfTriangle(t,n))return!0;const s=new jf(n,e,t);for(;s.MoveNext();){const o=s.CurrentPiercedEdge;if(o.Constrained&&!r.has(o.lowerSite.Owner))return!1}return!0}BundleAvoidsObstacles(e,t,n,r,s,o){o.closestDist=new Array;const a=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,t),l=this.FindCloseObstaclesForBundle(t.CdtTriangle,r,n,a,s);if(null==l)return!1;for(const c of l)o.closestDist.push(c[1]);return!0}FindCloseObstaclesForBundle(e,t,n,r,s){const o=new Map,a=[];if(!this.ThreadLineSegmentThroughTriangles(e,t,n,r,a))return null;if(!this.ComputeForcesForBundles&&!this.bundlingSettings.HighestQuality)return o;const l=new EP.HashSet;for(const c of a)for(const u of c.Sites){if(l.has(u))continue;l.add(u);const y=u.Owner;if(r.has(y))continue;const R=hw.FindPolylinePoint(y,u.point),D=me.minDistBetweenLineSegments(R.point,R.nextOnPolyline.point,t,n),L=D.dist,k=D.parab,W=D.parcd,X=me.minDistBetweenLineSegments(R.point,R.prevOnPolyline.point,t,n),ne=X.dist,ce=X.parab,Ae=X.parcd;let Oe,Be,ke;if(L<ne){if(ke=L,ke>s)continue;Oe=R.point.add(R.nextOnPolyline.point.sub(R.point).mul(k)),Be=t.add(n.sub(t).mul(W))}else{if(ke=ne,ke>s)continue;Oe=R.point.add(R.prevOnPolyline.point.sub(R.point).mul(ce)),Be=t.add(n.sub(t).mul(Ae))}o.get(y)||o.set(y,[Oe,Be])}return o}ThreadLineSegmentThroughTriangles(e,t,n,r,s){if(pn.PointIsInsideOfTriangle(n,e))return s.push(e),!0;const o=new jf(e,t,n);for(s.push(e);o.MoveNext();){s.push(o.CurrentTriangle);const a=o.CurrentPiercedEdge;if(a.Constrained&&!r.has(a.lowerSite.Owner))return!1}return null!=o.CurrentTriangle&&s.push(o.CurrentTriangle),!0}static PointLocationInsideTriangle(e,t){let n=!1;for(let r=0;r<3;r++){const s=x.signedDoubledTriangleArea(e,t.Sites.getItem(r).point,t.Sites.getItem(r+1).point);if(s<-1*q.distanceEpsilon)return We.Outside;s<q.distanceEpsilon&&(n=!0)}return n?We.Boundary:We.Inside}static FindPolylinePoint(e,t){for(const n of e.polylinePoints())if(n.point.equal(t))return n;throw new Error("polyline point "+t+" not found")}EdgeIsLegal(e,t,n,r){const o=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,t);return this.ThreadLineSegmentThroughTriangles(e.CdtTriangle,n,r,o,[])}static closedeb(e,t){return e.Position.sub(new x(360.561,428.416)).length<.1&&t.Position.sub(new x(414.281,440.732)).length<.1}EdgeIsLegalSSPPS(e,t,n){const r=e.Position,s=e.CdtTriangle,o=t.Position;if(pn.PointIsInsideOfTriangle(o,s))return!0;const a=new jf(s,r,o);for(;a.MoveNext();){const l=a.CurrentPiercedEdge;if(l.Constrained&&!n.has(l.lowerSite.Owner))return!1}return!0}}class ts{constructor(e,t,n,r){this.metroGraphData=e,this.obstaclesToIgnoreLambda=r,this.bundlingSettings=t,this.obstacleTree=n}ObstaclesToIgnoreForBundle(e,t){return null!=e&&null!=t?zl(this.obstaclesToIgnoreLambda(e),this.obstaclesToIgnoreLambda(t)):null==e&&null==t?new Set:this.obstaclesToIgnoreLambda(null!=e?e:t)}HubAvoidsObstaclesSPNBA(e,t,n,r){const s={minimalDistance:n};return ts.IntersectCircleWithTree(this.obstacleTree,t,n,this.obstaclesToIgnoreLambda(e),r.touchedObstacles,s)}HubAvoidsObstaclesPNS__(e,t,n){const r={touchedObstacles:Array()};return this.HubAvoidsObstaclesPNSTT(e,t,n,r,{minimalDistance:0})}GetMinimalDistanceToObstacles(e,t,n){const r=new Array,s={minimalDistance:n};return ts.IntersectCircleWithTree(this.obstacleTree,t,n,this.obstaclesToIgnoreLambda(e),r,s)?s.minimalDistance:0}HubAvoidsObstaclesPNSTT(e,t,n,r,s){return r.touchedObstacles=new Array,s.minimalDistance=t,ts.IntersectCircleWithTree(this.obstacleTree,e,t,n,r.touchedObstacles,s)}static IntersectCircleWithTree(e,t,n,r,s,o){if(!e.irect.contains_point_radius(t,n))return!0;if(null==e.UserData){let a=ts.IntersectCircleWithTree(e.Left,t,n,r,s,o);if(!a||(a=ts.IntersectCircleWithTree(e.Right,t,n,r,s,o),!a))return!1}else{const a=e.UserData;if(r.has(a))return!0;if(te.PointRelativeToCurveLocation(t,a)!=We.Outside)return ts.containingPoly=a,!1;const c=a.value(a.closestParameter(t)),u=c.sub(t).length;u<=n&&s.push([a,c]),o.minimalDistance=Math.min(u,o.minimalDistance)}return!0}static Create4gon(e,t,n,r){let s=t.sub(e).normalize();return s=new x(s.y,-1*s.x),He.mkFromPoints([e.add(s.mul(n/2)),e.sub(s.mul(n/2)),t.sub(s.mul(r/2)),t.add(s.mul(r/2))])}}class qU{constructor(e,t,n,r){this.Width=t,this.Polyline=e,this.sourceAndTargetLoosePolylines=n,this.Index=r}UpdateLengths(){let e=0;for(let t=this.Polyline.startPoint;null!=t.next;t=t.next)e+=t.next.point.sub(t.point).length;this.Length=e,this.IdealLength=this.Polyline.end.sub(this.Polyline.start).length}}class QU{constructor(e,t,n){this.metroline=e,this.station=t,this.polyPoint=n}get Metroline(){return this.metroline}get PolyPoint(){return this.polyPoint}}class XU{constructor(e,t,n){this.Radius=0,this.BundleBases=new Map,this.MetroNodeInfos=new Array,this._cachedIdealRadius=0,this.SerialNumber=e,this.IsReal=t,this.Position=n}debStop(){return 28==this.SerialNumber&&this.Position.sub(new x(841.2662778763244,303.3817005853006)).length<.001}get Position(){return this._Position}set Position(e){this._Position=e}getELP(){return this.EnterableLoosePolylines}setELP(e){this.EnterableLoosePolylines=e}addEL(e){this.EnterableLoosePolylines.add(e)}static less(e,t){return e.SerialNumber<t.SerialNumber}static greater(e,t){return e.SerialNumber>t.SerialNumber}get cachedIdealRadius(){return this._cachedIdealRadius}set cachedIdealRadius(e){this._cachedIdealRadius=e}AddEnterableLoosePolyline(e){null==this.EnterableLoosePolylines&&(this.EnterableLoosePolylines=new Set),this.EnterableLoosePolylines.add(e)}AddEnterableTightPolyline(e){null==this.EnterableTightPolylines&&(this.EnterableTightPolylines=new Set),this.EnterableTightPolylines.add(e)}}class ZU{constructor(){this.Width=0,this.Metrolines=new Array,this.cachedBundleCost=0}get Count(){return this.Metrolines.length}}class fi{constructor(e,t){this.metroGraphData=e,this.bundlingSettings=t}CreateNodeRadii(){for(const e of this.metroGraphData.VirtualStations())e.Radius=0,e.cachedIdealRadius=fi.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e);this.GrowHubs(!1),this.GrowHubs(!0);for(const e of this.metroGraphData.VirtualStations())e.Radius=Math.max(e.Radius,this.bundlingSettings.MinHubRadius)}GrowHubs(e){const t=new Vo(Vt);for(const r of this.metroGraphData.VirtualStations())t.Enqueue(r,-this.CalculatePotential(r,e));let n=!1;for(;!t.IsEmpty();){const r={priority:0},s=t.DequeueAndGetPriority(r);if(r.priority>=0)break;this.TryGrowHub(s,e)&&(t.Enqueue(s,-this.CalculatePotential(s,e)),n=!0)}return n}TryGrowHub(e,t){const n=this.CalculateAllowedHubRadius(e);if(e.Radius>=n)return!1;const r=t?fi.CalculateIdealHubRadiusWithAdjacentEdges(this.bundlingSettings,e):e.cachedIdealRadius;if(e.Radius>=r)return!1;let o=.05*(r-e.Radius);o<1&&(o=1);const a=Math.min(e.Radius+o,n);return!(a<=e.Radius||(e.Radius=a,0))}CalculatePotential(e,t){const n=t?fi.CalculateIdealHubRadiusWithAdjacentEdges(this.bundlingSettings,e):e.cachedIdealRadius;return n<=e.Radius?0:(n-e.Radius)/n}CalculateAllowedHubRadius(e){let t=this.bundlingSettings.MaxHubRadius;for(const r of e.Neighbors){const s=r.Position.sub(e.Position).length;t=Math.min(t,s/1.05-r.Radius)}const n=this.metroGraphData.tightIntersections.GetMinimalDistanceToObstacles(e,e.Position,t);return n<t&&(t=n-.001),Math.max(t,.1)}static CalculateIdealHubRadius(e,t,n){let r=1;for(const s of n.Neighbors){const a=e.GetWidthSSN(s,n,t.EdgeSeparation)/2+t.EdgeSeparation;r=Math.max(r,a)}return r=Math.min(r,2*t.MaxHubRadius),r}static CalculateIdealHubRadiusWithNeighborsMBS(e,t,n){return fi.CalculateIdealHubRadiusWithNeighborsMBNP(e,t,n,n.Position)}static CalculateIdealHubRadiusWithNeighborsMBNP(e,t,n,r){let s=fi.CalculateIdealHubRadius(e,t,n);if(n.Neighbors.length>1){const o=n.Neighbors;for(let a=0;a<o.length;a++)s=Math.max(s,fi.GetMinRadiusForTwoAdjacentBundles(s,n,r,o[a],o[(a+1)%o.length],e,t))}return s=Math.min(s,2*t.MaxHubRadius),s}static CalculateIdealHubRadiusWithAdjacentEdges(e,t){let n=e.MaxHubRadius;for(const r of t.Neighbors)n=Math.min(n,t.Position.sub(r.Position).length/2);return n}static GetMinRadiusForTwoAdjacentBundles(e,t,n,r,s,o,a){const l=o.GetWidthSSN(t,r,a.EdgeSeparation),c=o.GetWidthSSN(t,s,a.EdgeSeparation);return fi.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(e,n,r.Position,s.Position,l,c,a)}static GetMinRadiusForTwoAdjacentBundlesNPPPNNB(e,t,n,r,s,o,a){if(s<q.distanceEpsilon||o<q.distanceEpsilon)return e;let l=x.anglePCP(n,t,r);if(l=Math.min(l,2*Math.PI-l),l<q.distanceEpsilon)return 2*a.MaxHubRadius;if(l>=Math.PI/2)return 1.05*e;const c=Math.sin(l),u=Math.cos(l),y=s/(4*c),R=o/(4*c);let D=2*Math.sqrt(y*y+(R*R+y*(R*u)*2));return D=Math.min(D,2*a.MaxHubRadius),D=Math.max(D,e),D}}class zf{constructor(e,t,n,r){this.metroGraphData=e,this.bundlingSettings=t,this.costCalculator=n,this.cdt=r}InitializeCostCache(){for(const e of this.metroGraphData.VirtualStations())e.cachedIdealRadius=fi.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e),e.cachedRadiusCost=this.costCalculator.RadiusCost(e,e.Position),e.cachedBundleCost=0;for(const e of this.metroGraphData.VirtualEdges()){const t=e[0],n=e[1],r=this.metroGraphData.GetIjInfo(t,n);r.cachedBundleCost=this.costCalculator.BundleCost(t,n,t.Position),t.cachedBundleCost+=r.cachedBundleCost,n.cachedBundleCost+=r.cachedBundleCost}}UpdateCostCache(e){const t=this.cdt.GetCdtTree();e.CdtTriangle=t.FirstHitNodeWithPredicate(e.Position,zf.testPointInside).UserData,e.cachedIdealRadius=fi.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,e),e.cachedRadiusCost=this.costCalculator.RadiusCost(e,e.Position),e.cachedBundleCost=0;for(const n of e.Neighbors){n.IsReal||(n.cachedIdealRadius=fi.CalculateIdealHubRadiusWithNeighborsMBS(this.metroGraphData,this.bundlingSettings,n),n.cachedRadiusCost=this.costCalculator.RadiusCost(n,n.Position));const r=this.metroGraphData.GetIjInfo(e,n);n.cachedBundleCost-=r.cachedBundleCost,r.cachedBundleCost=this.costCalculator.BundleCost(e,n,e.Position),e.cachedBundleCost+=r.cachedBundleCost,n.cachedBundleCost+=r.cachedBundleCost}}static testPointInside(e,t){return pn.PointIsInsideOfTriangle(e,t)?Gt.Stop:Gt.Continue}}class wP{constructor(){this.mainMap=new Map}get isEmpty(){return 0==this.mainMap.size||this.everyMapIsEmpty()}everyMapIsEmpty(){for(const e of this.mainMap.values())if(e.size)return!1;return!0}get(e,t){const n=this.mainMap.get(e);if(n)return n.get(t)}has(e,t){const n=this.mainMap.get(e);return!!n&&n.has(t)}set(e,t,n){let r=this.mainMap.get(e);r||(r=new Map,this.mainMap.set(e,r)),r.set(t,n)}*[Symbol.iterator](){for(const[e,t]of this.mainMap)for(const[n,r]of t)yield[e,n,r]}*keys(){for(const[e,t]of this.mainMap)for(const[n]of t)yield[e,n]}}class eW{constructor(e,t,n,r,s,o,a,l){this.cachedEnterableLooseForEnd=new Di,this.regularEdges=e,this.Cdt=null!=s?s:sc.CreateConstrainedDelaunayTriangulation(t),this.EdgeLooseEnterable=o,this.EdgeTightEnterable=a,this.LoosePolylineOfPort=l,this.looseIntersections=new ts(this,r,t,c=>c.getELP()),this.tightIntersections=new ts(this,r,n,c=>c.EnterableTightPolylines),this.cdtIntersections=new hw(this,r),this.Initialize(!1)}get Ink(){return this.ink}get Edges(){return this.regularEdges}VirtualStations(){return Array.from(this.Stations).filter(e=>!e.IsReal)}get Metrolines(){return this.metrolines}get LooseTree(){return this.looseIntersections.obstacleTree}get TightTree(){return this.tightIntersections.obstacleTree}*VirtualEdges(){for(const e of this.edgeInfoDictionary.keys())yield e}RealEdgeCount(e,t){const n=e.SerialNumber<t.SerialNumber?[e,t]:[t,e],r=this.edgeInfoDictionary.get(n[0],n[1]);return r?r.Count:0}MetroNodeInfosOfNode(e){return e.MetroNodeInfos}GetIjInfo(e,t){const n=e.SerialNumber<t.SerialNumber?[e,t]:[t,e];return this.edgeInfoDictionary.get(n[0],n[1])}MoveNode(e,t){const n=e.Position;this.PointToStations.deleteP(n),this.PointToStations.set(t,e),e.Position=t;for(const r of this.MetroNodeInfosOfNode(e))r.PolyPoint.point=t;for(const r of this.MetroNodeInfosOfNode(e)){const o=r.PolyPoint.prev.point,a=r.PolyPoint.next.point;r.Metroline.Length+=a.sub(t).length+o.sub(t).length-a.sub(n).length-o.sub(n).length}for(const r of e.Neighbors)this.ink+=t.sub(r.Position).length-n.sub(r.Position).length;this.SortNeighbors(e);for(const r of e.Neighbors)this.SortNeighbors(r)}GetWidthSSN(e,t,n){const r=e.SerialNumber<t.SerialNumber?[e,t]:[t,e],s=this.edgeInfoDictionary.get(r[0],r[1]);return s?s.Width+(s.Count-1)*n:0}GetWidthAN(e,t){let n=0;for(const s of e)n+=s.Width;const r=e.length;return n+=r>0?(r-1)*t:0,n}Initialize(e){this.SimplifyRegularEdges(),this.InitializeStationData(),this.InitializeEdgeData(),this.InitializeVirtualGraph(),this.InitializeEdgeNodeInfo(e),this.InitializeCdtInfo()}SimplifyRegularEdges(){for(const e of this.regularEdges)this.SimplifyRegularEdge(e)}SimplifyRegularEdge(e){const t=e.curve,n=new Jt.K,r=new Rn;for(let s=t.endPoint;null!=s;s=s.prev){const o=s.point;if(r.has(s.point)){let a=s.next;for(;;){const l=n.top;if(l.equal(o))break;r.delete(l),n.pop(),a=a.next}a.prev=s.prev,a.prev.next=a}else n.push(o),r.add(o)}}InitializeStationData(){this.Stations=[],this.PointToStations=new Di;for(const e of this.regularEdges)this.ProcessPolylinePoints(e.curve)}ProcessPolylinePoints(e){let t=e.startPoint;for(this.RegisterStation(t,!0),t=t.next;t!=e.endPoint;t=t.next)this.RegisterStation(t,!1);this.RegisterStation(t,!0)}RegisterStation(e,t){if(!this.PointToStations.has(e.point)){const n=new XU(this.Stations.length,t,e.point);this.PointToStations.set(e.point,n),this.Stations.push(n)}}InitializeEdgeData(){this.metrolines=new Array;for(let e=0;e<this.regularEdges.length;e++)this.InitEdgeData(this.regularEdges[e],e)}InitEdgeData(e,t){const n=new qU(e.curve,e.lineWidth,this.EdgeSourceAndTargetFunc(e),t);this.metrolines.push(n),this.PointToStations.get(n.Polyline.start).BoundaryCurve=e.sourcePort.Curve,this.PointToStations.get(n.Polyline.end).BoundaryCurve=e.targetPort.Curve}EdgeSourceAndTargetFunc(e){return()=>[this.LoosePolylineOfPort(e.sourcePort),this.LoosePolylineOfPort(e.targetPort)]}InitializeVirtualGraph(){const e=new Map;for(const t of this.metrolines){let r,n=this.PointToStations.get(t.Polyline.start);for(let s=t.Polyline.startPoint;null!=s.next;s=s.next,n=r)r=this.PointToStations.get(s.next.point),Pf(e,n,r),Pf(e,r,n)}for(const t of this.Stations)t.Neighbors=Array.from(e.get(t))}GetUnorderedIjInfo(e,t){return e.SerialNumber<t.SerialNumber?this.GetCreateOrderedIjInfo(e,t):this.GetCreateOrderedIjInfo(t,e)}static closedeb(e,t){return e.Position.sub(new x(360.561,428.416)).length<.1&&t.Position.sub(new x(414.281,440.732)).length<.1}GetCreateOrderedIjInfo(e,t){let n=this.edgeInfoDictionary.get(e,t);return n||(n=new ZU,this.edgeInfoDictionary.set(e,t,n),n)}InitializeEdgeNodeInfo(e){this.edgeInfoDictionary=new wP,this.InitAllMetroNodeInfos(e),this.SortAllNeighbors(),this.InitEdgeIjInfos(),this.ink=0;for(const t of this.VirtualEdges())this.ink+=t[0].Position.sub(t[1].Position).length}InitAllMetroNodeInfos(e){for(let t=0;t<this.metrolines.length;t++){const n=this.metrolines[t];this.InitMetroNodeInfos(n),this.InitNodeEnterableLoosePolylines(n,this.regularEdges[t]),e&&this.InitNodeEnterableTightPolylines(n,this.regularEdges[t]),n.UpdateLengths()}}InitMetroNodeInfos(e){for(let t=e.Polyline.startPoint;null!=t;t=t.next){const n=this.PointToStations.get(t.point);n.MetroNodeInfos.push(new QU(e,n,t))}}InitNodeEnterableLoosePolylines(e,t){const n=null!=this.EdgeLooseEnterable?this.EdgeLooseEnterable.get(t):new Set;for(let r=e.Polyline.startPoint.next;null!=r&&null!=r.next;r=r.next){const s=this.PointToStations.get(r.point);null!=s.getELP()?s.setELP(Mo(s.getELP(),n)):s.setELP(new Set(n))}this.AddLooseEnterableForMetrolineStartEndPoints(e)}AddLooseEnterableForMetrolineStartEndPoints(e){this.AddLooseEnterableForEnd(e.Polyline.start),this.AddLooseEnterableForEnd(e.Polyline.end)}AddTightEnterableForMetrolineStartEndPoints(e){this.AddTightEnterableForEnd(e.Polyline.start),this.AddTightEnterableForEnd(e.Polyline.end)}AddLooseEnterableForEnd(e){const t=this.PointToStations.get(e);if(this.cachedEnterableLooseForEnd.has(e))t.setELP(this.cachedEnterableLooseForEnd.get(e));else{for(const n of this.LooseTree.AllHitItems_(e))te.PointRelativeToCurveLocation(e,n)==We.Inside&&t.AddEnterableLoosePolyline(n);this.cachedEnterableLooseForEnd.set(e,t.getELP())}}AddTightEnterableForEnd(e){const t=this.PointToStations.get(e);for(const n of this.TightTree.AllHitItems_(e))te.PointRelativeToCurveLocation(e,n)==We.Inside&&t.AddEnterableTightPolyline(n)}InitNodeEnterableTightPolylines(e,t){const n=null!=this.EdgeTightEnterable?this.EdgeTightEnterable.get(t):new Set;for(let r=e.Polyline.startPoint.next;null!=r&&null!=r.next;r=r.next){const s=this.PointToStations.get(r.point),o=s.EnterableTightPolylines;s.EnterableTightPolylines=null!=o?Mo(o,n):new Set(n)}this.AddTightEnterableForMetrolineStartEndPoints(e)}SortAllNeighbors(){for(const e of this.Stations)this.SortNeighbors(e)}SortNeighbors(e){if(e.Neighbors.length<=2)return;const t=e.Neighbors[0].Position,n=e.Position;e.Neighbors.sort((r,s)=>Ra(t.sub(n),r.Position.sub(n),s.Position.sub(n)))}InitEdgeIjInfos(){for(const e of this.metrolines){let r,n=this.PointToStations.get(e.Polyline.start);for(let s=e.Polyline.startPoint;null!=s.next;s=s.next,n=r){r=this.PointToStations.get(s.next.point);const o=this.GetUnorderedIjInfo(n,r);o.Width+=e.Width,o.Metrolines.push(e)}}}InitializeCdtInfo(){const e=this.Cdt.GetCdtTree();for(const t of this.Stations)t.CdtTriangle=e.FirstHitNodeWithPredicate(t.Position,zf.testPointInside).UserData}PointIsAcceptableForEdge(e,t){if(null==this.LoosePolylineOfPort)return!0;const n=e.sourceAndTargetLoosePolylines();return te.PointRelativeToCurveLocation(t,n[0])==We.Outside&&te.PointRelativeToCurveLocation(t,n[1])==We.Outside}}function Ra(i,e,t){i=i.mul(1e3),e=e.mul(1e3),t=t.mul(1e3);const r=x.crossProduct(i,t),s=i.dot(t),o=x.crossProduct(i,e),a=i.dot(e);return ht(o,0)&&Kf(a,0)?ht(r,0)&&Kf(s,0)?0:1:ht(r,0)&&Kf(s,0)?-1:ht(o,0)||ht(r,0)||o*r>0?Hl(x.crossProduct(t,e),0):-Hl(Math.sign(o),0)}function Kf(i,e){return Hl(i,e)>=0}let rr=(()=>{class i{constructor(t,n){this.metroGraphData=t,this.bundlingSettings=n}static InkError(t,n,r){return(t-n)*r.InkImportance}static PathLengthsError(t,n,r,s){return s.PathLengthImportance/r*(t-n)}static RError(t,n,r){return t<=n?0:r.HubRepulsionImportance*((1-n/t)*(t-n))}static BundleError(t,n,r){return t<=n?0:r.BundleRepulsionImportance*((1-n/t)*(t-n))}static Cost(t,n){let r=n.InkImportance*t.Ink;for(const s of t.Metrolines)r+=n.PathLengthImportance*s.Length/s.IdealLength;return r+=this.CostOfForces(t),r}static CostOfForces(t){let n=0;for(const r of t.VirtualStations())n+=r.cachedRadiusCost;for(const r of t.VirtualEdges())n+=t.GetIjInfo(r[0],r[1]).cachedBundleCost;return n}InkGain(t,n){const r=this.metroGraphData.Ink;let s=this.metroGraphData.Ink;for(const o of t.Neighbors){const a=o.Position;s-=a.sub(t.Position).length,s+=a.sub(n).length}return i.InkError(r,s,this.bundlingSettings)}PathLengthsGain(t,n){let r=0;for(const s of this.metroGraphData.MetroNodeInfosOfNode(t)){const o=s.Metroline.Length,a=s.PolyPoint.prev.point,l=s.PolyPoint.next.point,c=s.Metroline.Length+l.sub(n).length+a.sub(n).length-l.sub(t.Position).length-a.sub(t.Position).length;r+=i.PathLengthsError(o,c,s.Metroline.IdealLength,this.bundlingSettings)}return r}RadiusGain(t,n){let r=0;return r+=t.cachedRadiusCost,r-=this.RadiusCost(t,n),r}RadiusCost(t,n){let r;r=x.closeDistEps(t.Position,n)?t.cachedIdealRadius:fi.CalculateIdealHubRadiusWithNeighborsMBNP(this.metroGraphData,this.bundlingSettings,t,n);const s={touchedObstacles:[]};if(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesSPNBA(t,n,r,s))return i.Inf;let o=0;for(const a of s.touchedObstacles){const l=a[1].sub(n).length;o+=i.RError(r,l,this.bundlingSettings)}return o}BundleGain(t,n){let r=t.cachedBundleCost;for(const s of t.Neighbors){const o=this.BundleCost(t,s,n);if(Kf(o,i.Inf))return-i.Inf;r-=o}return r}BundleCost(t,n,r){const s=this.metroGraphData.GetWidthSSN(t,n,this.bundlingSettings.EdgeSeparation),o={closestDist:[]};if(!this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(t,n,r,n.Position,s,o))return i.Inf;let a=0;for(const l of o.closestDist){const c=l[0].sub(l[1]).length;a+=i.BundleError(s/2,c,this.bundlingSettings)}return a}}return i.Inf=1e9,i})();class tW{constructor(e){this.polylineToEdgeGeom=new Map,this.pathsThroughPoints=new Di,this.interestingPoints=new Rn,this.metroGraphData=e}get Polylines(){return Array.from(this.polylineToEdgeGeom.keys())}Run(){this.Init(),this.SwitchFlips()}Init(){for(const e of this.metroGraphData.Edges)this.polylineToEdgeGeom.set(e.curve,e);for(const e of this.Polylines)this.RegisterPolylinePointInPathsThrough(e.polylinePoints())}RegisterPolylinePointInPathsThrough(e){for(const t of e)this.RegisterPolylinePointInPathsThroughP(t)}RegisterPolylinePointInPathsThroughP(e){!function nW(i,e,t){let n=i.get(e);n||(n=new Set,i.set(e,n)),n.add(t)}(this.pathsThroughPoints,e.point,e)}UnregisterPolylinePointsInPathsThrough(e){for(const t of e)this.UnregisterPolylinePointInPathsThrough(t)}UnregisterPolylinePointInPathsThrough(e){!function iW(i,e,t){const n=i.get(e);!n||(n.delete(t),0==n.size&&i.deleteP(e))}(this.pathsThroughPoints,e.point,e)}SwitchFlips(){const e=new Set(this.Polylines),t=new Io.c;for(const n of this.Polylines)t.enqueue(n);for(;t.length>0;){const n=t.dequeue();e.delete(n);const r=this.ProcessPolyline(n);null!=r&&(e.has(n)||(e.add(n),t.enqueue(n)),e.has(r)||(e.add(r),t.enqueue(r)))}}ProcessPolyline(e){const t=new Map;for(let n=e.startPoint.next;null!=n;n=n.next){this.FillDepartedPolylinePoints(n,t);for(const r of this.pathsThroughPoints.get(n.point)){const s=t.get(r.polyline);if(s){if(this.ProcessFlip(n,s))return r.polyline;t.delete(r.polyline)}}}return null}FillDepartedPolylinePoints(e,t){const n=e.prev.point;for(const r of this.pathsThroughPoints.get(n))this.IsNeighborOnTheSamePolyline(r,e)||t.has(r.polyline)||t.set(r.polyline,r)}ProcessFlip(e,t){const n=e.polyline,r=t.polyline,s=e.point,o=t.point,a=this.polylineToEdgeGeom.get(n),l=this.polylineToEdgeGeom.get(r);if(a.lineWidth!=l.lineWidth||null==this.metroGraphData.EdgeLooseEnterable||!If(this.metroGraphData.EdgeLooseEnterable.get(a),this.metroGraphData.EdgeLooseEnterable.get(l)))return!1;let c=this.FindPointsOnPolyline(n,s,o);const u=c[0],y=c[1],R=c[2];c=this.FindPointsOnPolyline(r,s,o);const D=c[0],L=c[1],k=c[2],W=this.FindRelationOnFirstPoint(u,D,R,k),X=this.FindRelationOnLastPoint(y,L,R,k);return(2==W||2==X)&&1!=W&&1!=X&&(this.UnregisterPolylinePointsInPathsThrough(n.polylinePoints()),this.UnregisterPolylinePointsInPathsThrough(r.polylinePoints()),this.Swap(u,D,y,L,R,k),this.RegisterPolylinePointInPathsThrough(n.polylinePoints()),this.RegisterPolylinePointInPathsThrough(r.polylinePoints()),this.RegisterInterestingPoint(u.point),this.RegisterInterestingPoint(y.point),this.numberOfReducedCrossings++,!0)}FindPointsOnPolyline(e,t,n){let r,s;for(let o=e.startPoint;null!=o;o=o.next)if(null==r)if(o.point.equal(t)){if(null!=s)return[o,s,!1];r=o}else null==s&&o.point.equal(n)&&(s=o);else if(o.point.equal(n))return[r,o,!0]}PolylinePointsAreInForwardOrder(e,t){for(let n=e;null!=n;n=n.next)if(n==t)return!0;return!1}Next(e,t){return t?e.next:e.prev}Prev(e,t){return t?e.prev:e.next}FindRelationOnFirstPoint(e,t,n,r){const s=e,o=t;for(;;){const a=this.Prev(e,n),l=this.Prev(t,r);if(null==a||null==l)return 0;if(!a.point.equal(l.point))break;e=a,t=l}return this.PolylinesIntersect(s,o,e,t,n,r)}FindRelationOnLastPoint(e,t,n,r){const s=e,o=t;for(;;){const a=this.Next(e,n),l=this.Next(t,r);if(null==a||null==l)return 0;if(!a.point.equal(l.point))break;e=a,t=l}for(;this.Next(e,n).point.equal(this.Prev(t,r).point);)e=this.Next(e,n),t=this.Prev(t,r);return this.PolylinesIntersect(e,t,s,o,n,r)}PolylinesIntersect(e,t,n,r,s,o){const a=this.Prev(e,s),l=this.Next(e,s),c=this.Next(n,s),u=this.Prev(n,s),y=this.Next(t,o),R=this.Prev(r,o);if(e.point.equal(n.point)){const D=e.point;return Ra(u.point.sub(D),R.point.sub(D),l.point.sub(D))==Ra(u.point.sub(D),y.point.sub(D),l.point.sub(D))?1:2}return Ra(a.point.sub(e.point),l.point.sub(e.point),y.point.sub(e.point))==Ra(c.point.sub(n.point),R.point.sub(n.point),u.point.sub(n.point))?1:2}Swap(e,t,n,r,s,o){const a=this.GetRangeOnPolyline(this.Next(e,s),n,s),l=this.GetRangeOnPolyline(this.Next(t,o),r,o);this.ChangePolylineSegment(e,n,s,l),this.ChangePolylineSegment(t,r,o,a),rh.RemoveSelfCyclesFromPolyline(e.polyline),rh.RemoveSelfCyclesFromPolyline(t.polyline)}ChangePolylineSegment(e,t,n,r){let s=e;for(const o of r){const a=$i.mkFromPoint(o.point);a.polyline=s.polyline,n?(a.prev=s,s.next=a):(a.next=s,s.prev=a),s=a}n?(s.next=t,t.prev=s):(s.prev=t,t.next=s)}GetRangeOnPolyline(e,t,n){const r=new Array;for(let s=e;s!=t;s=this.Next(s,n))r.push(s);return r}IsNeighborOnTheSamePolyline(e,t){return null!=e.prev&&e.prev.point.equal(t.point)||null!=e.next&&e.next.point.equal(t.point)}RegisterInterestingPoint(e){this.interestingPoints.has(e)||this.interestingPoints.add(e)}GetChangedHubs(){return this.interestingPoints}NumberOfReducedCrossings(){return this.numberOfReducedCrossings}PolylineIsOK(e){const t=new Rn;for(let n=e.startPoint;null!=n;n=n.next){if(n==e.startPoint){if(null!=n.prev)return!1}else if(n.prev.next!=n)return!1;if(n==e.endPoint){if(null!=n.next)return!1}else if(n.next.prev!=n)return!1;if(t.has(n.point))return!1;t.add(n.point)}return!(null!=e.startPoint.prev||null!=e.endPoint.next)}}class rh{constructor(e,t){this.foundCrossings=new Rn,this.crossingsThatShouldBecomeHubs=new Rn,this.metroGraphData=e,this.polylineAcceptsPoint=t}*Vertices(){for(const e of this.Polylines)for(const t of e.polylinePoints())yield t}get Polylines(){return this.metroGraphData.Edges.map(e=>e.curve)}Edges(){const e=new Ku;for(const t of this.Vertices())t.next&&e.set(new ai(t.point,t.next.point),0);return Array.from(e.keys())}run(){if(0==this.metroGraphData.Edges.length)return!1;const e=new Ku,t=new Rf(null);for(const a of this.Vertices()){const l=De.mkOnPoints([a.point]);l.pad(q.intersectionEpsilon),t.Add(l,a.point)}const n=OE(this.Edges(),a=>De.mkPP(a.First,a.Second));hi(n,n,(a,l)=>this.IntersectTwoEdges.bind(a,l,e,t)),this.SortInsertedPoints(e);const r=this.InsertPointsIntoPolylines(e),s=this.FixPaths(),o=this.RemoveUnimportantCrossings();return s||r||o}FixPaths(){let e=!1;return this.RemoveSelfCycles()&&(e=!0),this.ReduceEdgeCrossings()&&(e=!0),e}SortInsertedPoints(e){for(const t of e)this.SortInsideSegment(t[0],t[1])}SortInsideSegment(e,t){t.sort((n,r)=>Vt(It(n,e.First),It(r,e.First)))}InsertPointsIntoPolylines(e){let t=!1;for(const n of this.metroGraphData.Metrolines)return this.InsertPointsIntoPolyline(n,e)&&(t=!0),t}InsertPointsIntoPolyline(e,t){let n=!1;for(let r=e.Polyline.startPoint;null!=r.next;r=r.next)this.InsertPointsOnPolypoint(r,t,e)&&(n=!0);return n}InsertPointsOnPolypoint(e,t,n){const r=new ai(e.point,e.next.point),s=e.point!=r.First,o=t.get(r);if(!o)return!1;const a=e.next,l=e.polyline;if(s)for(let c=o.length-1;c>=0;c--){if(null!=this.polylineAcceptsPoint&&!this.polylineAcceptsPoint(n,o[c]))continue;const u=$i.mkFromPoint(o[c]);u.prev=e,u.polyline=l,e.next=u,e=u}else for(let c=0;c<o.length;c++){if(null!=this.polylineAcceptsPoint&&!this.polylineAcceptsPoint(n,o[c]))continue;const u=$i.mkFromPoint(o[c]);u.prev=e,u.polyline=l,e.next=u,e=u}return e.next=a,a.prev=e,!0}RemoveSelfCycles(){let e=!1;for(const t of this.Polylines)rh.RemoveSelfCyclesFromPolyline(t)&&(e=!0);return e}static RemoveSelfCyclesFromPolyline(e){let t=!1;const n=new Di;for(let r=e.startPoint;null!=r;r=r.next){const o=n.get(r.point);if(o){for(let a=o.next;a!=r.next;a=a.next)n.deleteP(a.point);o.next=r.next,r.next.prev=o,t=!0}else n.set(r.point,r)}return t}ReduceEdgeCrossings(){const e=new tW(this.metroGraphData);e.Run();for(const t of e.GetChangedHubs())this.crossingsThatShouldBecomeHubs.add(t);return e.NumberOfReducedCrossings()>0}RemoveUnimportantCrossings(){let e=!1;this.pointsToDelete=function H3(i,e){const t=new Rn;for(const n of i)e.has(n)||t.add(n);return t}(this.foundCrossings,this.crossingsThatShouldBecomeHubs);for(const t of this.Polylines)this.RemoveUnimportantCrossingsFromPolyline(t)&&(e=!0);return e}RemoveUnimportantCrossingsFromPolyline(e){let t=!1;for(let n=e.startPoint.next;null!=n&&null!=n.next;n=n.next)if(this.pointsToDelete.has(n.point)&&x.getTriangleOrientation(n.prev.point,n.point,n.next.point)==Ie.Collinear){const r=n.prev,s=n.next;r.next=s,s.prev=r,n=r,t=!0}return t}IntersectTwoEdges(e,t,n,r){const s=me.IntersectPPPP(e.First,e.Second,t.First,t.Second);if(s){const o=this.FindExistingVertexOrCreateNew(r,s);(this.AddVertexToSplittingList(e,n,o)||this.AddVertexToSplittingList(t,n,o))&&this.foundCrossings.add(o)}}FindExistingVertexOrCreateNew(e,t){const n=e.RootNode.FirstHitNode(t);if(null!=n)return n.UserData;const r=De.mkOnPoints([t]).pad(q.intersectionEpsilon);return e.Add(r,t),t}AddVertexToSplittingList(e,t,n){if(!te.closeIntersectionPoints(n,e.First)&&!te.closeIntersectionPoints(n,e.Second)){let r=t.get(e);if(r||(r=new Array,t.set(e,r)),!r.find(s=>s.equal(n)))return r.push(n),!0}return!1}}class vP{constructor(e,t,n,r){this.BelongsToRealNode=r,this.Curve=t,this.Position=n,this.points=new Array(e),this.tangents=new Array(e),this.OrientedHubSegments=new Array(e),this.ParameterSpan=this.Curve.parEnd-this.Curve.parStart}get Count(){return this.points.length}get CurveCenter(){return this.Curve.boundingBox.center}get OppositeBase(){return null!=this.OutgoingBundleInfo?this.OutgoingBundleInfo.TargetBase:this.IncomingBundleInfo.SourceBase}get length(){return this.points.length}get Points(){return this.points}get Tangents(){return this.tangents}get InitialMidParameter(){return this.initialMidParameter}set InitialMidParameter(e){this.initialMidParameter=e,this.InitialMidPoint=this.Curve.value(e)}get ParRight(){return this.parRight}set ParRight(e){this.parRight=e,this.RightPoint=this.Curve.value(this.parRight)}get ParLeft(){return this.parLeft}set ParLeft(e){this.parLeft=e,this.LeftPoint=this.Curve.value(this.parLeft)}get ParMid(){return(this.parRight+this.parLeft)/2}get MidPoint(){return x.middle(this.RightPoint,this.LeftPoint)}get Span(){return this.SpanBetweenTwoPoints(this.parRight,this.parLeft)}SpanBetweenTwoPoints(e,t){return e<=t?t-e:t-e+this.ParameterSpan}RotateLeftPoint(e,t){return 0==e?this.LeftPoint:this.RotatePoint(e,this.parLeft,t)}RotateRigthPoint(e,t){return 0==e?this.RightPoint:this.RotatePoint(e,this.parRight,t)}RotatePoint(e,t,n){return t=this.AdjustParam(t+=e*(this.ParameterSpan*n)),this.Curve.value(t)}AdjustParam(e){return e>this.Curve.parEnd?e=this.Curve.parStart+(e-this.Curve.parEnd):e<this.Curve.parStart&&(e=this.Curve.parEnd-(this.Curve.parStart-e)),e}RotateBy(e,t,n){const r=this.ParameterSpan*n;0!=e&&(this.ParRight=this.AdjustParam(this.ParRight+e*r)),0!=t&&(this.ParLeft=this.AdjustParam(this.ParLeft+t*r))}Intersect(e){return this.IntersectNNNB(this.parRight,this.parLeft,e.parRight,e.parLeft)}IntersectNNNB(e,t,n,r){return e>t?this.IntersectNNNB(e,this.Curve.parEnd,n,r)||this.IntersectNNNB(this.Curve.parStart,t,n,r):n>r?this.IntersectNNNB(e,t,n,this.Curve.parEnd)||this.IntersectNNNB(e,t,this.Curve.parStart,r):!(Hl(t,n)||Hl(r,e))}RelativeOrderOfBasesIsPreserved(e,t,n){const r=this.ParameterSpan*n,s=this.parRight+e*r,o=this.parRight<this.parLeft?this.parLeft+t*r:this.parLeft+this.ParameterSpan+t*r;if(s>o||this.SpanBetweenTwoPoints(s,o)>this.ParameterSpan/2)return!1;if(null==this.Prev||this.SpanBetweenTwoPoints(this.Prev.ParMid,this.ParMid)>r&&this.SpanBetweenTwoPoints(this.ParMid,this.Next.ParMid)>r)return!0;const a=this.RotateLeftPoint(t,n),l=this.RotateRigthPoint(e,n),c=x.middle(a,l),u=this.MidPoint;return!(x.getTriangleOrientation(this.CurveCenter,this.Prev.MidPoint,u)!=x.getTriangleOrientation(this.CurveCenter,this.Prev.MidPoint,c)||x.getTriangleOrientation(this.CurveCenter,this.Next.MidPoint,u)!=x.getTriangleOrientation(this.CurveCenter,this.Next.MidPoint,c))}}let rW=(()=>{class i{constructor(t,n,r,s,o){this.SourceBase=t,this.TargetBase=n,this.obstaclesToIgnore=r,this.EdgeSeparation=s,this.HalfWidthArray=o,this.TotalRequiredWidth=this.EdgeSeparation*(this.HalfWidthArray.length-1)+2*this.HalfWidthArray.reduce((l,c)=>l+c,0),this.longEnoughSideLength=t.Curve.boundingBox.addRec(n.Curve.boundingBox).diagonal;const a=Math.max(t.Curve.boundingBox.diagonal,n.Curve.boundingBox.diagonal);if(this.TotalRequiredWidth>a){const l=this.TotalRequiredWidth/a;for(let c=0;c<this.HalfWidthArray.length;c++)this.HalfWidthArray[c]/=l;this.TotalRequiredWidth/=l,this.EdgeSeparation/=l}}SetParamsFeasiblySymmetrically(t){this.CalculateTightObstaclesForBundle(t,this.obstaclesToIgnore),this.SetEndParamsSymmetrically()}CalculateTightObstaclesForBundle(t,n){const o=ts.Create4gon(this.SourceBase.Position,this.TargetBase.Position,this.SourceBase.Curve.boundingBox.diagonal/2*2,this.TargetBase.Curve.boundingBox.diagonal/2*2);this.tightObstaclesInTheBoundingBox=Array.from(t.AllHitItems(o.boundingBox,a=>!n.has(a)&&te.ClosedCurveInteriorsIntersect(o,a)))}SetEndParamsSymmetrically(){const t=this.TargetBase.Position,n=this.SourceBase.Position,r=t.sub(n).normalize(),s=r.rotate90Ccw(),o=x.middle(t,n),a=r.mul(this.longEnoughSideLength),l=o.add(a),c=o.sub(a);if(this.SetRLParamsIfWidthIsFeasible(s.mul(this.TotalRequiredWidth/2),l,c))return void this.SetInitialMidParams();let u=this.TotalRequiredWidth,y=0,R=u/2;for(;u-y>i.FeasibleWidthEpsilon;)this.SetRLParamsIfWidthIsFeasible(s.mul(R/2),l,c)?y=R:u=R,R=.5*(u+y);R<=i.FeasibleWidthEpsilon&&(this.SetRLParamsIfWidthIsFeasible_(s.mul(i.FeasibleWidthEpsilon),new x(0,0),l,c)||this.SetRLParamsIfWidthIsFeasible_(new x(0,0),s.mul(-i.FeasibleWidthEpsilon),l,c))&&(R=2*i.FeasibleWidthEpsilon),this.SourceBase.InitialMidParameter=this.SourceBase.AdjustParam(this.SourceBase.ParRight+this.SourceBase.Span/2),this.TargetBase.InitialMidParameter=this.TargetBase.AdjustParam(this.TargetBase.ParRight+this.TargetBase.Span/2)}mkNameFromLRST(){return"/tmp/leftRight"+this.SourceBase.Position.toString()+"_"+this.TargetBase.Position.toString()+".svg"}SetRLParamsIfWidthIsFeasible(t,n,r){return this.SetRLParamsIfWidthIsFeasible_(t,t.neg(),n,r)}SetRLParamsIfWidthIsFeasible_(t,n,r,s){const o={par:0},a={par:0},l={par:0},c={par:0};let u=this.TrimSegWithBoundaryCurves(me.mkPP(r.add(t),s.add(t)),a,l);return null!=u&&!this.tightObstaclesInTheBoundingBox.find(R=>null!=te.intersectionOne(u,R,!1))&&(u=this.TrimSegWithBoundaryCurves(me.mkPP(r.add(n),s.add(n)),c,o),null!=u)&&!this.tightObstaclesInTheBoundingBox.find(R=>null!=te.intersectionOne(u,R,!1))&&(this.SourceBase.IsParent?(this.SourceBase.ParRight=a.par,this.SourceBase.ParLeft=c.par):(this.SourceBase.ParRight=c.par,this.SourceBase.ParLeft=a.par),this.TargetBase.IsParent?(this.TargetBase.ParRight=o.par,this.TargetBase.ParLeft=l.par):(this.TargetBase.ParRight=l.par,this.TargetBase.ParLeft=o.par),!0)}SetInitialMidParams(){const t={par:0},n={par:0};null!=this.TrimSegWithBoundaryCurves(me.mkPP(this.TargetBase.CurveCenter,this.TargetBase.CurveCenter),n,t)?(this.SourceBase.InitialMidParameter=n.par,this.TargetBase.InitialMidParameter=t.par):(this.SourceBase.InitialMidParameter=this.SourceBase.AdjustParam(this.SourceBase.ParRight+this.SourceBase.Span/2),this.TargetBase.InitialMidParameter=this.TargetBase.AdjustParam(this.TargetBase.ParRight+this.TargetBase.Span/2))}mkNameFromST(){return"/tmp/mparam"+this.SourceBase.Position.toString()+"_"+this.TargetBase.Position.toString()+".svg"}TrimSegWithBoundaryCurves(t,n,r){let o,a,s=te.getAllIntersections(t,this.SourceBase.Curve,!0);return 0==s.length?(r.par=0,n.par=0,null):(o=1==s.length?s[0]:this.SourceBase.IsParent?s[0].par0<s[1].par0?s[1]:s[0]:s[0].par0<s[1].par0?s[0]:s[1],s=te.getAllIntersections(t,this.TargetBase.Curve,!0),0==s.length?(r.par=0,n.par=0,null):(a=1==s.length?s[0]:this.TargetBase.IsParent?s[0].par0>s[1].par0?s[1]:s[0]:s[0].par0>s[1].par0?s[0]:s[1],n.par=o.par1,r.par=a.par1,me.mkPP(o.x,a.x)))}RotateBy(t,n,r,s,o){const a=0!=t||0!=n,l=0!=r||0!=s;a&&this.SourceBase.RotateBy(t,n,o),l&&this.TargetBase.RotateBy(r,s,o),this.UpdateSourceAndTargetBases(a,l)}UpdateSourceAndTargetBases(t,n){t&&this.UpdatePointsOnBundleBase(this.SourceBase),n&&this.UpdatePointsOnBundleBase(this.TargetBase),this.UpdateTangentsOnBases()}UpdateTangentsOnBases(){const t=this.TargetBase.length;for(let n=0;n<t;n++){let r=this.TargetBase.Points[n].sub(this.SourceBase.Points[t-1-n]);const s=r.length;s>=q.tolerance&&(r=r.div(s),this.TargetBase.Tangents[n]=r,this.SourceBase.Tangents[t-1-n]=r.neg())}}UpdatePointsOnBundleBase(t){const n=t.length,r=t.Points,s=me.mkPP(t.LeftPoint,t.RightPoint),o=1/this.TotalRequiredWidth;let a=this.HalfWidthArray[0];r[0]=s.value(a*o);for(let l=1;l<n;l++)a+=this.HalfWidthArray[l-1]+this.EdgeSeparation+this.HalfWidthArray[l],r[l]=s.value(a*o)}RotationIsLegal(t,n,r,s,o){if(this.SourceBase.IsParent||this.TargetBase.IsParent){if(0!=n||0!=s){const a=this.SourceBase.RotateLeftPoint(n,o),l=this.TargetBase.RotateLeftPoint(s,o);if(!this.LineIsLegal(a,l))return!1}if(0!=t||0!=r){const a=this.SourceBase.RotateRigthPoint(t,o),l=this.TargetBase.RotateRigthPoint(r,o);if(!this.LineIsLegal(a,l))return!1}}else{if(0!=n||0!=r){const a=this.SourceBase.RotateLeftPoint(n,o),l=this.TargetBase.RotateRigthPoint(r,o);if(!this.LineIsLegal(a,l))return!1}if(0!=t||0!=s){const a=this.SourceBase.RotateRigthPoint(t,o),l=this.TargetBase.RotateLeftPoint(s,o);if(!this.LineIsLegal(a,l))return!1}}return!((0!=t||0!=n)&&!this.SourceBase.RelativeOrderOfBasesIsPreserved(t,n,o)||(0!=r||0!=s)&&!this.TargetBase.RelativeOrderOfBasesIsPreserved(r,s,o))}LineIsLegal(t,n){return null==this.tightObstaclesInTheBoundingBox.find(r=>null!=te.intersectionOne(me.mkPP(t,n),r,!1))}}return i.FeasibleWidthEpsilon=.1,i})();class SP{constructor(e,t,n,r){this.Segment=e,this.Reversed=t,this.Index=n,this.BundleBase=r}get Segment(){return this.segment}set Segment(e){this.segment=e}value(e){return this.Segment.value(this.Reversed?this.Segment.parEnd-e:e)}}let sW=(()=>{class i{constructor(t,n,r){this.fixedBundles=new EP.HashSet,this.stepsWithProgress=0,this.metroOrdering=t,this.metroGraphData=n,this.bundlingSettings=r}Run(){this.AllocateBundleBases(),this.SetBasesRightLeftParamsToTheMiddles(),this.bundlingSettings.KeepOverlaps?(this.UpdateSourceAndTargetBases(),this.CreateOrientedSegs()):(this.SetRightLeftParamsFeasiblySymmetrically(),this.AdjustStartEndParamsToAvoidBaseOverlaps(),this.UpdateSourceAndTargetBases(),this.CreateOrientedSegs(),this.bundlingSettings.RotateBundles&&this.RotateBundlesToDiminishCost(),this.AdjustStartEndParamsToAvoidBaseOverlaps(),this.UpdateSourceAndTargetBases())}AllocateBundleBases(){this.externalBases=new Map,this.internalBases=new Map,this.Bundles=new Array;for(const t of this.metroGraphData.Stations)null==t.BoundaryCurve&&(t.BoundaryCurve=Rt.mkCircle(t.Radius,t.Position));for(const t of this.metroGraphData.Stations)for(const n of t.Neighbors)if(t.SerialNumber<n.SerialNumber){const r=new vP(this.metroGraphData.RealEdgeCount(t,n),t.BoundaryCurve,t.Position,t.IsReal);t.BundleBases.set(n,r);const s=new vP(this.metroGraphData.RealEdgeCount(t,n),n.BoundaryCurve,n.Position,n.IsReal);n.BundleBases.set(t,s),te.PointRelativeToCurveLocation(n.Position,t.BoundaryCurve)!=We.Outside?(r.IsParent=!0,Kl(this.internalBases,t.BoundaryCurve,r),Kl(this.externalBases,n.BoundaryCurve,s)):te.PointRelativeToCurveLocation(t.Position,n.BoundaryCurve)!=We.Outside?(s.IsParent=!0,Kl(this.externalBases,t.BoundaryCurve,r),Kl(this.internalBases,n.BoundaryCurve,s)):(Kl(this.externalBases,t.BoundaryCurve,r),Kl(this.externalBases,n.BoundaryCurve,s));const o=this.metroGraphData.tightIntersections.ObstaclesToIgnoreForBundle(t,n),a=new rW(r,s,o,this.bundlingSettings.EdgeSeparation,Array.from(this.metroOrdering.GetOrder(t,n)).map(l=>l.Width/2));r.OutgoingBundleInfo=s.IncomingBundleInfo=a,this.Bundles.push(a)}this.SetBundleBaseNeighbors()}SetBundleBaseNeighbors(){for(const t of this.externalBases.keys()){const n=this.externalBases.get(t);this.SortBundlesCounterClockwise(n),this.SetLeftRightBases(n)}for(const t of this.internalBases.keys()){const n=this.internalBases.get(t);this.SortBundlesCounterClockwise(n),this.SetLeftRightBases(n)}}SortBundlesCounterClockwise(t){if(t.length>2){const n=t[0].OppositeBase.Position,r=t[0].CurveCenter;t.sort((s,o)=>Ra(n.sub(r),s.OppositeBase.Position.sub(r),o.OppositeBase.Position.sub(r)))}}SetLeftRightBases(t){const n=t.length;if(!(n<=1))for(let r=0;r<n;r++)t[r].Prev=t[(r-1+n)%n],t[r].Next=t[(r+1)%n]}CreateOrientedSegs(){for(const t of this.metroGraphData.Metrolines)this.CreateOrientedSegsOnLine(t)}CreateOrientedSegsOnLine(t){for(let n=t.Polyline.startPoint.next;null!=n.next;n=n.next)this.CreateOrientedSegsOnLineVertex(t,n)}CreateOrientedSegsOnLineVertex(t,n){const r=this.metroGraphData.PointToStations.get(n.prev.point),s=this.metroGraphData.PointToStations.get(n.point),o=this.metroGraphData.PointToStations.get(n.next.point),a=s.BundleBases.get(r),l=s.BundleBases.get(o),c=this.metroOrdering.GetLineIndexInOrder(r,s,t),u=this.metroOrdering.GetLineIndexInOrder(o,s,t),y=a.OrientedHubSegments[c]=new SP(null,!1,c,a),R=l.OrientedHubSegments[u]=new SP(null,!0,u,l);R.Other=y,y.Other=R}UpdateSourceAndTargetBases(){for(const t of this.Bundles)t.UpdateSourceAndTargetBases(!0,!0)}SetBasesRightLeftParamsToTheMiddles(){for(const t of this.Bundles){const n=t.SourceBase,r=t.TargetBase;n.ParLeft=n.ParRight=this.GetBaseMiddleParamInDirection(n,n.Position,r.Position),r.ParLeft=r.ParRight=this.GetBaseMiddleParamInDirection(r,r.Position,n.Position)}}GetBaseMiddleParamInDirection(t,n,r){const s=t.Curve;if(s instanceof Rt){const l=s;if(l.isArc())return x.angle(l.aAxis,r.sub(n))}const a=te.getAllIntersections(s,me.mkPP(n,r),!0);for(const l of a){const c=l.x;if(c.sub(n).dot(c.sub(r))<=0)return l.par0}throw new Error}SetRightLeftParamsFeasiblySymmetrically(){for(const t of this.Bundles)t.SetParamsFeasiblySymmetrically(this.metroGraphData.TightTree)}AdjustStartEndParamsToAvoidBaseOverlaps(){for(const t of this.externalBases.keys())this.AdjustCurrentBundleWidthsOnCurve(this.externalBases.get(t));for(const t of this.internalBases.keys())this.AdjustCurrentBundleWidthsOnCurve(this.internalBases.get(t))}AdjustCurrentBundleWidthsOnCurve(t){const n=t.length;if(!(n<=1))for(let r=0;r<n;r++){const s=t[r];this.ShrinkBasesToMakeTwoConsecutiveNeighborsHappy(s,s.Next)}}ShrinkBasesToMakeTwoConsecutiveNeighborsHappy(t,n){if(!t.Intersect(n))return;let r=t.ParRight,s=t.ParLeft,o=n.ParRight,a=n.ParLeft;const l=n.ParameterSpan;r>s&&(r-=l),o>a&&(o-=l),o>s&&(o-=l,a-=l),r>a&&(r-=l,s-=l);const c=this.RegularCut(r,s,o,a,t.Span,n.Span),u=x.getTriangleOrientation(n.CurveCenter,n.OppositeBase.InitialMidPoint,t.OppositeBase.InitialMidPoint);u==Ie.Clockwise?(s=c,o=c):u==Ie.Counterclockwise?(a=c,r=c):a-r>=s-o?(s=c,o=c):(a=c,r=c),n.ParRight=n.AdjustParam(o),n.ParLeft=n.AdjustParam(a),t.ParRight=t.AdjustParam(r),t.ParLeft=t.AdjustParam(s)}RegularCut(t,n,r,s,o,a){let l=(o*s+a*t)/(o+a);const c=Math.min(n,s),u=Math.max(t,r);return l<u&&(l=u),l>c&&(l=c),l}RotateBundlesToDiminishCost(){let t=i.MaxParameterChange;const n={cost:this.Cost()};let r=0;for(;r++<i.MaxIterations;){const s=n.cost;if(this.RotateBundlesToDiminishCostOneIteration(t,n),t=this.UpdateParameterChange(t,s,n.cost),t<i.MinParameterChange)break}}UpdateParameterChange(t,n,r){return r+1<n?(this.stepsWithProgress++,this.stepsWithProgress>=5&&(this.stepsWithProgress=0,this.fixedBundles.clear())):(this.stepsWithProgress=0,t*=.8,this.fixedBundles.clear()),t}RotateBundlesToDiminishCostOneIteration(t,n){let r=!1;for(const s of this.Bundles)this.fixedBundles.has(s)||(this.OptimizeBundle(s,t,n)?r=!0:this.fixedBundles.add(s));return r}OptimizeBundle(t,n,r){const s=this.CostBi(t);if(s<i.CostThreshold)return!1;let o=0,a=-1,l=-1;for(let c=0;c<i.Deltas.length-1;c++){let u=this.DeltaWithChangedAngles(i.Deltas[c][0],i.Deltas[c][1],0,0,t,s,n);u>i.CostDeltaThreshold&&u>o&&(l=c,a=i.Deltas.length-1,o=u),u=this.DeltaWithChangedAngles(0,0,i.Deltas[c][0],i.Deltas[c][1],t,s,n),u>i.CostDeltaThreshold&&u>o&&(l=i.Deltas.length-1,a=c,o=u)}return!(o<i.CostDeltaThreshold||(r.cost-=o,t.RotateBy(i.Deltas[l][0],i.Deltas[l][1],i.Deltas[a][0],i.Deltas[a][1],n),0))}DeltaWithChangedAngles(t,n,r,s,o,a,l){if(!o.RotationIsLegal(t,n,r,s,l))return 0;o.RotateBy(t,n,r,s,l);const c=this.CostBN(o,a);return o.RotateBy(-1*t,-1*n,-1*r,-1*s,l),a-c}CostBi(t){return i.SeparationCoeff*this.SeparationCost(t)+(i.SqueezeCoeff*this.SqueezeCost(t)+(i.AssymetryCoeff*this.AssymetryCost(t)+i.CenterCoeff*this.CenterCostBi(t)))}CostBN(t,n){let r=0;return r+=i.CenterCoeff*this.CenterCostBi(t),r>n||(r+=i.SeparationCoeff*this.SeparationCost(t),r>n)||(r+=i.SqueezeCoeff*this.SqueezeCost(t),r>n)||(r+=i.AssymetryCoeff*this.AssymetryCost(t)),r}SqueezeCost(t){const r=t.TargetBase.MidPoint.sub(t.SourceBase.MidPoint).normalize().rotate90Ccw(),s=Math.abs(t.SourceBase.RightPoint.sub(t.SourceBase.LeftPoint).dot(r)),o=Math.abs(t.TargetBase.RightPoint.sub(t.TargetBase.LeftPoint).dot(r)),a=Math.abs(t.TotalRequiredWidth-s)/t.TotalRequiredWidth,l=Math.abs(t.TotalRequiredWidth-o)/t.TotalRequiredWidth,c=Math.abs(s-o)/t.TotalRequiredWidth;return Math.exp(10*a)-1+(Math.exp(10*l)-1)+c}CenterCostBi(t){return t.SourceBase.BelongsToRealNode||t.TargetBase.BelongsToRealNode?this.CenterCostBb(t.SourceBase)+this.CenterCostBb(t.TargetBase):0}CenterCostBb(t){if(!t.BelongsToRealNode)return 0;const n=t.ParMid,r=Math.min(t.InitialMidParameter,n),s=Math.max(t.InitialMidParameter,n),o=Math.min(s-r,r+(t.ParameterSpan-s));return t.CurveCenter.equal(t.Position)||t.IsParent?o*o*25:o*o*500}AssymetryCost(t){return this.GetAssymetryCostForBase(t.SourceBase)+this.GetAssymetryCostForBase(t.TargetBase)}GetAssymetryCostForBase(t){if(t.BelongsToRealNode)return 0;const n=t.OppositeBase.BelongsToRealNode?200:500;let r=0;for(const s of t.OrientedHubSegments){const o=s.Index,a=s.Other.Index,u=s.Other.BundleBase,D=t.Count+u.Count;r+=this.GetAssymetryCostOnData(t.Points[o],t.Tangents[o],u.Points[a],u.Tangents[a],n)/D}return r}GetAssymetryCostOnData(t,n,r,s,o){const a=t.sub(r);if(a.length<q.distanceEpsilon)return 0;const c=n.add(s).dot(a),u=x.crossProduct(a,n),y=x.crossProduct(a,s),R=u-y;return 10*(c*c+R*R)+o*(u*u+y*y)}SeparationCost(t){return this.SeparationCostForBundleBase(t.SourceBase)+this.SeparationCostForBundleBase(t.TargetBase)}SeparationCostForBundleBase(t){return null==t.Prev?0:this.SeparationCostForAdjacentBundleBases(t,t.Prev)+this.SeparationCostForAdjacentBundleBases(t,t.Next)}SeparationCostForAdjacentBundleBases(t,n){const s=this.IntervalsOverlapLength(t.ParRight,t.ParLeft,n.ParRight,n.ParLeft,t.Curve),o=Math.min(t.Span,n.Span);return Math.exp(s/(10*o))-1}IntervalsOverlapLength(t,n,r,s,o){const a=o.parStart,l=o.parEnd;return t<n?r<s?this.IntersectRegularIntervals(t,n,r,s):this.IntersectRegularIntervals(t,n,r,l)+this.IntersectRegularIntervals(t,n,a,s):r<s?this.IntersectRegularIntervals(t,l,r,s)+this.IntersectRegularIntervals(a,n,r,s):this.IntersectRegularIntervals(t,l,r,l)+this.IntersectRegularIntervals(a,n,a,s)}IntersectRegularIntervals(t,n,r,s){const o=Math.max(t,r),a=Math.min(n,s);return o<a?a-o:0}Cost(){let t=0;for(const n of this.Bundles)t+=(i.SeparationCoeff*this.SeparationCost(n)+i.AssymetryCoeff*this.AssymetryCost(n))/2+i.SqueezeCoeff*this.SqueezeCost(n)+i.CenterCoeff*this.CenterCostBi(n);return t}}return i.Deltas=[[1,-1],[1,-1]],i.SeparationCoeff=1,i.SqueezeCoeff=1,i.CenterCoeff=10,i.AssymetryCoeff=1,i.MaxIterations=200,i.MaxParameterChange=8/360,i.MinParameterChange=.1/360,i.CostThreshold=1e-5,i.CostDeltaThreshold=.01,i})();class oW{constructor(){this.Metrolines=new Array}Add(e){this.Metrolines.push(e)}}class $f{constructor(e){this.Metrolines=e,this.BuildOrder()}*GetOrder(e,t){const n=new ai(e.Position,t.Position),r=this.bundles.get(n).Metrolines;if(e.Position==n.First)for(let s=0;s<r.length;s++)yield r[s];else for(let s=r.length-1;s>=0;s--)yield r[s]}GetLineIndexInOrder(e,t,n){const r=new ai(e.Position,t.Position),s=e.Position!=r.First,o=this.bundles.get(r).LineIndexInOrder;return s?o.size-1-o.get(n):o.get(n)}BuildOrder(){this.bundles=new Ku;for(const e of this.Metrolines)for(let t=e.Polyline.startPoint;null!=t.next;t=t.next){const n=new ai(t.point,t.next.point);let r=this.bundles.get(n);r||this.bundles.set(n,r=new oW),r.Add(e)}for(const e of this.bundles)this.BuildOrderPP(e[0],e[1])}BuildOrderPP(e,t){if(!t.orderFixed){t.Metrolines.sort((n,r)=>this.CompareLines(n,r,e.First,e.Second)),t.orderFixed=!0,t.LineIndexInOrder=new Map;for(let n=0;n<t.Metrolines.length;n++)t.LineIndexInOrder.set(t.Metrolines[n],n)}}CompareLines(e,t,n,r){const s={polyPoint:null,next:null,prev:null};this.FindStationOnLine(n,r,e,s);const o=s.polyPoint,a=s.next,l=s.prev;this.FindStationOnLine(n,r,t,s);const c=s.polyPoint,u=s.next,y=s.prev;let L,k,R=o,D=c;for(;null!=(k=l(R))&&null!=(L=y(D))&&k.point.equal(L.point);){const W=new ai(k.point,R.point);if(this.bundles.get(W).orderFixed)return this.CompareOnFixedOrder(W,e,t,!k.point.equal(W.First));R=k,D=L}if(null!=k&&null!=L){const W=R.point;return-$f.IsLeft(a(R).point.sub(W),k.point.sub(W),L.point.sub(W))}for(R=o,D=c;null!=(k=a(R))&&null!=(L=u(D))&&k.point.equal(L.point);){const W=new ai(k.point,R.point);if(this.bundles.get(W).orderFixed)return this.CompareOnFixedOrder(W,e,t,!R.point.equal(W.First));R=k,D=L}if(null!=k&&null!=L){const W=R.point;return $f.IsLeft(l(R).point.sub(W),k.point.sub(W),L.point.sub(W))}return Vt(e.Index,t.Index)}CompareOnFixedOrder(e,t,n,r){const s=this.bundles.get(e).LineIndexInOrder;return(r?-1:1)*Vt(s.get(t),s.get(n))}FindStationOnLine(e,t,n,r){for(let s=n.Polyline.startPoint;null!=s.next;s=s.next){if(s.point.equal(e)&&s.next.point.equal(t))return r.next=o=>o.next,r.prev=o=>o.prev,void(r.polyPoint=s);if(s.point.equal(t)&&s.next.point.equal(e))return r.next=o=>o.prev,r.prev=o=>o.next,void(r.polyPoint=s.next)}throw new Error}static IsLeft(e,t,n){return Ra(e,t,n)}}let Jf=(()=>{class i extends dn{constructor(t,n){super(null),this.metroGraphData=t,this.bundlingSettings=n}run(){this.CreateMetroOrdering(),this.InitRadii(),this.FinalizePaths()}InitRadii(){new fi(this.metroGraphData,this.bundlingSettings).CreateNodeRadii()}CreateMetroOrdering(){this.metroOrdering=new $f(this.metroGraphData.Metrolines)}FinalizePaths(){this.CreateBundleBases(),this.CreateSegmentsInsideHubs(),this.CreateCurves()}CreateBundleBases(){new sW(this.metroOrdering,this.metroGraphData,this.bundlingSettings).Run()}CreateCurves(){for(let t=0;t<this.metroGraphData.Metrolines.length;t++)this.CreateCurveLine(this.metroGraphData.Metrolines[t],this.metroGraphData.Edges[t])}CreateCurveLine(t,n){const r=new te;let o=i.FindCurveStart(this.metroGraphData,this.metroOrdering,t);const a=i.HubSegsOfLine(this.metroGraphData,this.metroOrdering,t);for(const l of a)null!=l&&(r.addSegment(me.mkPP(o,l.start)),r.addSegment(l),o=l.end);r.addSegment(me.mkPP(o,i.FindCurveEnd(this.metroGraphData,this.metroOrdering,t))),n.curve=r}static FindCurveStart(t,n,r){const s=t.PointToStations.get(r.Polyline.startPoint.point),o=t.PointToStations.get(r.Polyline.startPoint.next.point),a=s.BundleBases.get(o),l=a.IsParent?n.GetLineIndexInOrder(s,o,r):n.GetLineIndexInOrder(o,s,r);return a.Points[l]}static FindCurveEnd(t,n,r){const s=t.PointToStations.get(r.Polyline.endPoint.prev.point),o=t.PointToStations.get(r.Polyline.endPoint.point),a=o.BundleBases.get(s),l=a.IsParent?n.GetLineIndexInOrder(o,s,r):n.GetLineIndexInOrder(s,o,r);return a.Points[l]}static*HubSegsOfLine(t,n,r){for(let s=r.Polyline.startPoint.next;null!=s.next;s=s.next)yield i.SegOnLineVertex(t,n,r,s)}static SegOnLineVertex(t,n,r,s){const o=t.PointToStations.get(s.prev.point),a=t.PointToStations.get(s.point),l=a.BundleBases.get(o),c=n.GetLineIndexInOrder(o,a,r);if(null==l.OrientedHubSegments[c]||null==l.OrientedHubSegments[c].Segment){const u=t.PointToStations.get(s.next.point),y=a.BundleBases.get(u),R=n.GetLineIndexInOrder(u,a,r);return me.mkPP(l.Points[c],y.Points[R])}return l.OrientedHubSegments[c].Segment}CreateSegmentsInsideHubs(){for(const t of this.metroGraphData.Metrolines)this.CreateOrientedSegsOnLine(t);this.bundlingSettings.UseCubicBezierSegmentsInsideOfHubs&&this.FanBezierSegs()}CreateOrientedSegsOnLine(t){for(let n=t.Polyline.startPoint.next;null!=n.next;n=n.next)this.CreateOrientedSegsOnLineVertex(t,n)}CreateOrientedSegsOnLineVertex(t,n){const r=this.metroGraphData.PointToStations.get(n.prev.point),s=this.metroGraphData.PointToStations.get(n.point),o=this.metroGraphData.PointToStations.get(n.next.point),a=s.BundleBases.get(r),l=s.BundleBases.get(o),c=this.metroOrdering.GetLineIndexInOrder(r,s,t),u=this.metroOrdering.GetLineIndexInOrder(o,s,t),y=this.bundlingSettings.UseCubicBezierSegmentsInsideOfHubs?i.StandardBezier(a.Points[c],a.Tangents[c],l.Points[u],l.Tangents[u]):i.BiArc(a.Points[c],a.Tangents[c],l.Points[u],l.Tangents[u]);a.OrientedHubSegments[c].Segment=y,l.OrientedHubSegments[u].Segment=y}static ShowHubs(t,n,r,s,o=[]){let a=i.GetAllDebugCurves(n,t);null!=r&&a.push(ot.mkDebugCurveTWCI(255,1,"red",vi.CreateDiamond(5,25,r.Position))),a=a.concat(o)}static GetAllDebugCurves(t,n){return i.GraphNodes(n).concat(i.VertexDebugCurves(t,n)).concat(i.DebugEdges(n))}static DebugEdges(t){return t.Edges.map(n=>ot.mkDebugCurveTWCI(40,.1,"gray",n.curve))}static VertexDebugCurves(t,n){return i.DebugCircles(n).concat(i.DebugHubBases(n)).concat(i.DebugSegs(n)).concat(i.BetweenHubs(t,n))}static BetweenHubs(t,n){const r=[];for(const s of n.Metrolines){const o=i.GetInterestingSegs(n,t,s),a=i.GetMonotoneColor(s.Polyline.start,s.Polyline.end,o);for(const l of o)r.push(ot.mkDebugCurveTWCI(100,s.Width,a,me.mkPP(l[0],l[1])))}return r}static GetInterestingSegs(t,n,r){const s=new Array;if(0==t.Stations.length||null==t.Stations[0].BundleBases||0==t.Stations[0].BundleBases.size)return[];let o=i.FindCurveStart(t,n,r);const a=i.HubSegsOfLine(t,n,r);for(const l of a)null!=l&&(s.push([o,l.start]),o=l.end);return s.push([o,i.FindCurveEnd(t,n,r)]),s}static GetMonotoneColor(t,n,r){return"green"}static DebugHubBases(t){const n=new Array;for(const r of t.Stations)for(const s of r.BundleBases.values())n.push(ot.mkDebugCurveTWCI(100,1,"red",me.mkPP(s.LeftPoint,s.RightPoint)));return n}static DebugCircles(t){return t.Stations.map(n=>ot.mkDebugCurveTWCI(100,.1,"blue",vi.mkCircle(n.Radius,n.Position)))}static DebugSegs(t){const n=new Array;for(const r of t.VirtualStations())for(const s of r.BundleBases.values())for(const o of s.OrientedHubSegments)null!=o&&n.push(null==o.Segment?me.mkPP(s.Points[o.Index],o.Other.BundleBase.Points[o.Other.Index]):o.Segment);return n.map(r=>ot.mkDebugCurveTWCI(100,.01,"green",r))}static GraphNodes(t){return t.Edges.map(r=>r.sourcePort.Curve).concat(t.Edges.map(r=>r.targetPort.Curve)).map(r=>ot.mkDebugCurveTWCI(40,1,"black",r))}static BiArc(t,n,r,s){const o=t.sub(r);if(o.length<q.distanceEpsilon)return null;const a=o.dot(n.sub(s)),c=2*(-n.dot(s)-1),u=2*a,y=o.dot(o);let R;if(Math.abs(c)<q.distanceEpsilon){if(!(Math.abs(u)>q.distanceEpsilon))return null;R=-y/u}else{let X=u*u-4*c*y;X<0&&(X=0),X=Math.sqrt(X),R=(-u+X)/(2*c),R<0&&(R=(-u-X)/(2*c))}const D=t.add(n.mul(R)),L=r.add(s.mul(R)),k=x.middle(D,L),W=new te;return W.addSegs([i.ArcOn(t,D,k),i.ArcOn(k,L,r)]),n.dot(r.sub(t))<=0&&n.dot(s)<=0?i.StandardBezier(t,n,r,s):W}static ArcOn(t,n,r){const s={center:null};if(Math.abs(x.signedDoubledTriangleArea(t,n,r))<1e-4||!i.FindArcCenter(t,n,r,s))return me.mkPP(t,r);const o=s.center,a=It(t,o);if(It(t,n)/a<1e-4)return me.mkPP(t,r);const c=t.sub(o);let u=Math.atan2(c.y,c.x);const y=r.sub(o);let R=Math.atan2(y.y,y.x),D=R-u;if(D<0&&(D+=2*Math.PI,R+=2*Math.PI),D<=Math.PI)return new Rt(u,R,new x(a,0),new x(0,a),o);for(R>2*Math.PI&&(R-=2*Math.PI),u=Math.PI-u,R=Math.PI-R,u<0&&(u+=2*Math.PI);R<u;)R+=2*Math.PI;return D=R-u,new Rt(u,R,new x(-a,0),new x(0,a),o)}static FindArcCenter(t,n,r,s){const o=n.sub(t).rotate90Cw(),a=n.sub(r).rotate90Cw();return s.center=x.lineLineIntersection(t,t.add(o),r,r.add(a)),null!=s.center}static StandardBezier(t,n,r,s){const o=It(t,r)/4;return rn.mkBezier([t,t.add(n.mul(o)),r.add(s.mul(o)),r])}FanBezierSegs(){let t=!0,r=0;for(;t&&r++<5;){t=!1;for(const s of this.metroGraphData.Stations)for(const o of s.BundleBases.values())t||(t=this.FanEdgesOfHubSegment(o))}}FanEdgesOfHubSegment(t){let n=!1;for(let r=0;r<t.Count-1;r++)n||(n=this.FanCouple(t,r,t.CurveCenter,t.Curve.boundingBox.diagonal/2));return n}FanCouple(t,n,r,s){const o=t.OrientedHubSegments[n],a=t.OrientedHubSegments[n+1];if(null==o||me.IntersectPPPP(o.Segment.start,o.Segment.end,a.Segment.start,a.Segment.end)||x.getTriangleOrientation(o.value(0),o.value(.5),o.value(1))!=x.getTriangleOrientation(a.value(0),a.value(.5),a.value(1)))return!1;const c=this.BaseLength(o),u=this.BaseLength(a);return!(Math.abs(c-u)<q.intersectionEpsilon)&&(c>u?this.AdjustLongerSeg(o,a,r,s):this.AdjustLongerSeg(a,o,r,s))}AdjustLongerSeg(t,n,r,s){const o=t.value(0).sub(n.value(0)),a=t.value(1).sub(n.value(1)),l=Math.min(o.length,a.length),c=n.value(.5),u=Math.max(o.length,a.length);return 0!=this.NicelyAligned(t.Segment,o,a,c,l,u)&&this.FitLonger(t,o,a,c,l,u,r,s)}FitLonger(t,n,r,s,o,a,l,c){let u=t.Segment;const y=u.start,R=u.end;let D=0,k=u.start.mul(1-i.SqueezeBound).add(u.B(1).mul(i.SqueezeBound)),W=u.end.mul(1-i.SqueezeBound).add(u.B(2).mul(i.SqueezeBound)),X=u.B(1).mul(2).sub(u.start),ne=u.B(2).mul(2).sub(u.end);const ce={highP:X};this.PullControlPointToTheCircle(u.start,ce,l,c),X=ce.highP;let Ae=this.NicelyAligned(u,n,r,s,o,a);for(;;){if(-1==Ae){const Oe=x.middle(u.B(1),k),Be=x.middle(u.B(2),W);X=u.B(1),ne=u.B(2),u=new rn(y,Oe,Be,R)}else{const Oe=x.middle(u.B(1),X),Be=(u.B(2),ne);k=u.B(1),W=u.B(2),u=new rn(y,Oe,Be,R)}if(0==(Ae=this.NicelyAligned(u,n,r,s,o,a)))return t.Segment=u,t.Other.Segment=u,!0;if(D++>10)return!1}}PullControlPointToTheCircle(t,n,r,s){const o=x.ProjectionToLine(t,n.highP,r),a=Math.sqrt(s*s-o.sub(r).lengthSquared),l=n.highP.sub(o),c=l.length;c>a&&(n.highP=o.add(l.mul(a/c)))}NicelyAligned(t,n,r,s,o,a){const c=t.value(.5).sub(s),u=c.length;return n.dot(c)<0||r.dot(c)<0||u<o-.001?1:u>a+.001?-1:0}BaseLength(t){return t.value(0).sub(t.value(1)).lengthSquared}}return i.SqueezeBound=.2,i})(),sh=(()=>{class i{constructor(t,n){this.stepsWithProgress=0,this.metroGraphData=t,this.bundlingSettings=n,this.costCalculator=new rr(this.metroGraphData,this.bundlingSettings),this.cache=new zf(this.metroGraphData,this.bundlingSettings,this.costCalculator,this.metroGraphData.Cdt)}static FixRouting(t,n){return this.FixRoutingMBP(t,n,null)}static FixRoutingMBP(t,n,r){return new i(t,n).FixRoutingP(r)}FixRoutingP(t){this.stationsForOptimizations=this.GetStationsForOptimizations(t),this.cache.InitializeCostCache();let n=i.MaxStep,r=Number.POSITIVE_INFINITY,s=this.metroGraphData.VirtualStations().map(a=>a.Position),o=0;for(;o++<i.MaxIterations;){const a=this.TryMoveStations();if(o<=1&&!a)return!1;if(!a)break;const l=r;r=rr.Cost(this.metroGraphData,this.bundlingSettings),n=this.UpdateMaxStep(n,l,r);const c=s;if(s=this.metroGraphData.VirtualStations().map(u=>u.Position),n<i.MinStep||this.Converged(n,c,s))break}return!0}static stationsArePositionedCorrectly(t){for(const n of t.VirtualEdges())if(!this.edgeIsPositionedCorrectly(n,t))return!1;return!0}static edgeIsPositionedCorrectly(t,n){const r=t[0],s=t[1],o=n.looseIntersections.ObstaclesToIgnoreForBundle(r,s),a=me.mkPP(r.Position,s.Position),l=Array.from(n.looseIntersections.obstacleTree.GetNodeItemsIntersectingRectangle(a.boundingBox)).filter(c=>!o.has(c)).filter(c=>te.CurvesIntersect(a,c));return!(l.length>0&&(Jf.ShowHubs(n,null,null,"/tmp/badcross.svg",[ot.mkDebugCurveTWCI(200,1,"Brown",a),ot.mkDebugCurveTWCI(200,1,"Red",vi.mkCircle(2,r.Position)),ot.mkDebugCurveTWCI(200,1,"Blue",vi.mkCircle(5,s.Position)),ot.mkDebugCurveTWCI(100,1,"Blue",vi.mkCircle(5,s.Position))].concat(l.map(c=>ot.mkDebugCurveTWCI(100,1,"Pink",c)))),1))}GetStationsForOptimizations(t){if(null==t)return new Set(this.metroGraphData.VirtualStations());{const n=new Set;for(const r of t){const s=this.metroGraphData.PointToStations.get(r);s&&!s.IsReal&&n.add(s)}return n}}Converged(t,n,r){let s=0,o=0;for(let l=0;l<n.length;l++)o+=n[l].sub(r[l]).lengthSquared,s+=n[l].lengthSquared;return Math.sqrt(o/s)<i.MinRelativeChange}UpdateMaxStep(t,n,r){return r+1<n?(this.stepsWithProgress++,this.stepsWithProgress>=5&&(this.stepsWithProgress=0,t=Math.min(i.MaxStep,t/.8))):(this.stepsWithProgress=0,t*=.8),t}TryMoveStations(){let t=!1;const n=new Set;for(const r of this.stationsForOptimizations)if(this.TryMoveStation(r)){t=!0,n.add(r);for(const s of r.Neighbors)s.IsReal||n.add(s)}return this.stationsForOptimizations=n,t}TryMoveStation(t){let n=this.BuildDirection(t);if(0==n.length)return!1;let r=this.BuildStepLength(t,n);if(r<i.MinStep&&(n=function aW(){return new x(1+2*FE(),1+2*FE())}(),r=this.BuildStepLength(t,n),r<i.MinStep))return!1;const s=n.mul(r),o=t.Position.add(s);return!(this.metroGraphData.PointToStations.has(o)||!this.moveIsLegalForAdjacentBundles(t,o)||(this.metroGraphData.MoveNode(t,o),this.cache.UpdateCostCache(t),0))}moveIsLegalForAdjacentBundles(t,n){for(const r of this.metroGraphData.looseIntersections.obstacleTree.AllHitItems(De.mkOnPoints([n]),s=>te.PointRelativeToCurveLocation(n,s)!=We.Outside))if(0==t.getELP().has(r))return!1;for(const r of t.Neighbors){const s=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(r,t);if(!this.metroGraphData.cdtIntersections.EdgeIsLegal_(r.Position,n,r.CdtTriangle,s))return!1}return!0}BuildDirection(t){const n=this.BuildForceForInk(t),r=this.BuildForceForPathLengths(t),s=this.BuildForceForRadius(t),o=this.BuildForceForBundle(t),a=n.add(r.add(s.add(o)));return a.length<.1?new x(0,0):a.normalize()}BuildStepLength(t,n){let r=i.MinStep,s=this.CostGain(t,t.Position.add(n.mul(r)));if(s<.01)return 0;for(;2*r<=i.MaxStep;){const o=this.CostGain(t,t.Position.add(n.mul(2*r)));if(o<=s)break;r*=2,s=o}return r}CostGain(t,n){const s=this.costCalculator.RadiusGain(t,n);if(s<-12345678)return-12345678;const o=this.costCalculator.BundleGain(t,n);return o<-12345678?-12345678:s+this.costCalculator.InkGain(t,n)+this.costCalculator.PathLengthsGain(t,n)+o}BuildForceForInk(t){let n=new x(0,0);for(const s of t.Neighbors){const o=s.Position.sub(t.Position);n=n.add(o.normalize())}return n.mul(this.bundlingSettings.InkImportance)}BuildForceForPathLengths(t){let n=new x(0,0);for(const s of this.metroGraphData.MetroNodeInfosOfNode(t)){const o=s.Metroline,l=s.PolyPoint.prev.point,c=s.PolyPoint.next.point.sub(t.Position),u=l.sub(t.Position);n=n.add(c.div(c.length*o.IdealLength)),n=n.add(u.div(u.length*o.IdealLength))}return n.mul(this.bundlingSettings.PathLengthImportance)}BuildForceForRadius(t){let n=new x(0,0);const r=t.cachedIdealRadius,s={touchedObstacles:[]};if(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesSPNBA(t,t.Position,r,s))throw Jf.ShowHubs(this.metroGraphData,null,t,"/tmp/hubs.svg",[ot.mkDebugCurveTWCI(255,1,"Brown",ts.containingPoly),ot.mkDebugCurveTWCI(100,1,"Blue",vi.mkCircle(r,t.Position))]),new Error;for(const l of s.touchedObstacles){const u=2*(1-l[1].sub(t.Position).length/r),y=t.Position.sub(l[1]).normalize();n=n.add(y.mul(u))}return n.mul(this.bundlingSettings.HubRepulsionImportance)}BuildForceForBundle(t){let n=new x(0,0);for(const s of t.Neighbors){const o=this.metroGraphData.GetWidthSSN(t,s,this.bundlingSettings.EdgeSeparation),a={closestDist:[]};this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(t,s,t.Position,s.Position,o/2,a)||Jf.ShowHubs(this.metroGraphData,null,t,"/tmp/inside_forbid.svg",[ot.mkDebugCurveTWCI(100,.2,"Blue",me.mkPP(t.Position,s.Position)),ot.mkDebugCurveTWCI(100,.2,"Red",vi.mkCircle(2,t.Position)),ot.mkDebugCurveTWCI(100,.2,"Red",vi.mkCircle(3,s.Position))]);for(const c of a.closestDist){const y=2*(1-c[0].sub(c[1]).length/(o/2)),R=c[0].sub(c[1]).normalize().neg();n=n.add(R.mul(y))}}return n.mul(this.bundlingSettings.BundleRepulsionImportance)}}return i.MaxIterations=100,i.MaxStep=50,i.MinStep=1,i.MinRelativeChange=5e-4,i})();class Ta{constructor(e,t){this.metroGraphData=e,this.bundlingSettings=t}static FixRouting(e,t){const n=new Ta(e,t);n.GlueConflictingStations(),n.UnglueEdgesFromBundleToSaveInk(!0);let r=0;for(;++r<10;){let o=n.GlueConflictingStations();if(o||(o=n.RelaxConstrainedEdges()),o||(o=r<=3&&n.UnglueEdgesFromBundleToSaveInk(!1)),o||(o=n.GlueCollinearNeighbors(r)),o||(o=3==r&&n.RemoveDoublePathCrossings()),!o)break}for(e.cdtIntersections.ComputeForcesForBundles=!0,n.RemoveDoublePathCrossings(),n.UnglueEdgesFromBundleToSaveInk(!0);n.GlueConflictingStations(););e.Initialize(!0)}GlueConflictingStations(){const e=this.GetCirclesHierarchy();if(null==e)return!1;const t=new Map,n=new Set;if(hi(e,e,(s,o)=>this.TryToGlueStations(s,o,t,n)),0==t.size)return!1;for(let s=0;s<this.metroGraphData.Edges.length;s++)this.RegenerateEdge(t,s);const r=new Rn;for(const s of n){r.add(s.Position);for(const o of s.Neighbors)o.IsReal||r.add(o.Position)}return this.metroGraphData.Initialize(!1),sh.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,r),!0}GetCirclesHierarchy(){for(const n of this.metroGraphData.VirtualStations())n.Radius=this.GetCurrentHubRadius(n);return fn(this.metroGraphData.VirtualStations().map(function t(n){const r=n.Position,s=Math.max(n.Radius,5),o=new x(s,s);return Gn(n,De.mkPP(r.add(o),r.sub(o)))}))}GetCurrentHubRadius(e){if(e.IsReal)return e.BoundaryCurve.boundingBox.diagonal/2;{let n=this.metroGraphData.looseIntersections.GetMinimalDistanceToObstacles(e,e.Position,e.cachedIdealRadius);for(const r of e.Neighbors)n=Math.min(n,e.Position.sub(r.Position).length);return n}}TryToGlueStations(e,t,n,r){if(!If(e.getELP(),t.getELP()))return!1;e.Position.sub(t.Position).length>=Math.max(e.Radius,5)+Math.max(t.Radius,5)||this.TryGlueOrdered(e,t,r,n)||this.TryGlueOrdered(t,e,r,n)}TryGlueOrdered(e,t,n,r){return!(r.has(e)||n.has(e)||!this.StationGluingIsAllowed(e,t,r)||(this.Map(e,t,n,r),0))}Map(e,t,n,r){r.set(e,t),n.add(t)}StationGluingIsAllowed(e,t,n){for(const s of e.Neighbors){const o=Ta.Glued(s,n),a=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(o,e);if(!this.metroGraphData.cdtIntersections.EdgeIsLegalSSPPS(o,t,a))return!1}return!(this.ComputeCostDeltaAfterStationGluing(e,t,n)<0)}ComputeCostDeltaAfterStationGluing(e,t,n){const r=e.Position.sub(t.Position).length;if(e.Radius>=r||t.Radius>=r)return 1;let s=0;const o=this.metroGraphData.Ink;let a=this.metroGraphData.Ink-t.Position.sub(e.Position).length;for(const l of e.Neighbors){const c=Ta.Glued(l,n);a-=c.Position.sub(e.Position).length,a+=0==this.metroGraphData.RealEdgeCount(c,t)?c.Position.sub(t.Position).length:0}s+=rr.InkError(o,a,this.bundlingSettings);for(const l of this.metroGraphData.MetroNodeInfosOfNode(e)){const c=l.Metroline.Length;let u=l.Metroline.Length;const y=l.PolyPoint,R=y.prev,D=y.next;u-=R.point.sub(e.Position).length+D.point.sub(e.Position).length,u+=R.point.sub(t.Position).length+D.point.sub(t.Position).length,s+=rr.PathLengthsError(c,u,l.Metroline.IdealLength,this.bundlingSettings)}return s}RegenerateEdge(e,t){const n=this.metroGraphData.Metrolines[t].Polyline;for(const o of n)if(!this.metroGraphData.PointToStations.has(o))return;let r=!1;for(const o of n)if(e.has(this.metroGraphData.PointToStations.get(o))){r=!0;break}if(!r)return;const s=Array.from(n).map(o=>this.metroGraphData.PointToStations.get(o));this.metroGraphData.Edges[t].curve=He.mkFromPoints(Ta.GluedPolyline(s,e))}static GluedPolyline(e,t){let n;const r=new Jt.K;r.push(e[0]);const s=new Set;for(n=1;n<e.length-1;n++){const o=Ta.Glued(e[n],t);if(s.has(o))for(;r.top!=o;)s.delete(r.pop());else x.closeDistEps(o.Position,r.top.Position)||(s.add(o),r.push(o))}return r.push(e[n]),Array.from(r).reverse().map(o=>o.Position)}static Glued(e,t){var n;return null!==(n=t.get(e))&&void 0!==n?n:e}UnglueEdgesFromBundleToSaveInk(e){const t=new Ku;this.ink=this.metroGraphData.Ink,this.polylineLength=new Map;for(const s of this.metroGraphData.Metrolines){this.polylineLength.set(s,s.Length);for(let o=s.Polyline.startPoint;null!=o.next;o=o.next)_I(t,new ai(o.point,o.next.point),s)}const n=new Rn;let r=!1;for(const s of this.metroGraphData.Metrolines){const o=Mo(this.metroGraphData.PointToStations.get(s.Polyline.start).getELP(),this.metroGraphData.PointToStations.get(s.Polyline.end).getELP());this.TrySeparateOnPolyline(s,t,n,o)&&(r=!0)}return r&&this.metroGraphData.Initialize(!1),(e||r)&&sh.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,e?null:n),r}TrySeparateOnPolyline(e,t,n,r){let s=!1,o=!0;for(;o;){o=!1;for(let a=e.Polyline.startPoint;null!=a.next&&null!=a.next.next;a=a.next)this.TryShortcutPolypoint(a,t,n,r)&&(o=!0);o&&(s=!0)}return s}TryShortcutPolypoint(e,t,n,r){return!!this.SeparationShortcutAllowed(e,t,r)&&(n.add(e.point),n.add(e.next.point),n.add(e.next.next.point),this.RemoveShortcuttedPolypoint(e,t),!0)}SeparationShortcutAllowed(e,t,n){const r=e.point,s=e.next.point,o=e.next.next.point,a=this.metroGraphData.PointToStations.get(r),l=this.metroGraphData.PointToStations.get(s),c=this.metroGraphData.PointToStations.get(o),u=zl(a.getELP(),c.getELP()),y=function Y3(i){if(0==i.length)return new Set;let e=i[0];for(let t=1;t<i.length;t++)e=Mo(e,i[t]);return e}([n,l.getELP(),u]);return!(!this.metroGraphData.cdtIntersections.EdgeIsLegalSSPPS(a,c,y)||this.GetInkgain(e,t,r,s,o)<0)}GetInkgain(e,t,n,r,s){const[o,a,l]=this.FindPolylines(e,t);let c=0;const u=this.ink;let y=this.ink;const R=n.sub(r).length,D=r.sub(s).length,L=n.sub(s).length;o.size==l.size&&(y-=R),a.size==l.size&&(y-=D);const k=t.get(new ai(n,s));(!k||0==k.size)&&(y+=L),c+=rr.InkError(u,y,this.bundlingSettings);for(const Oe of l){const Be=this.polylineLength.get(Oe);c+=rr.PathLengthsError(Be,Be-(R+D-L),Oe.IdealLength,this.bundlingSettings)}let W=this.GetCurrentHubRadius(this.metroGraphData.PointToStations.get(n));const X=this.metroGraphData.GetWidthAN(Array.from(l),this.bundlingSettings.EdgeSeparation),ne=this.metroGraphData.GetWidthAN(Array.from(jl(o,l)),this.bundlingSettings.EdgeSeparation);let ce=fi.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(W,n,s,r,X,ne,this.bundlingSettings);ce>W&&(c-=rr.RError(ce,W,this.bundlingSettings)),W=this.GetCurrentHubRadius(this.metroGraphData.PointToStations.get(s));const Ae=this.metroGraphData.GetWidthAN(Array.from(jl(a,l)),this.bundlingSettings.EdgeSeparation);return ce=fi.GetMinRadiusForTwoAdjacentBundlesNPPPNNB(W,s,r,n,Ae,X,this.bundlingSettings),ce>W&&(c-=rr.RError(ce,W,this.bundlingSettings)),c}RemoveShortcuttedPolypoint(e,t){const n=e.point,r=e.next.point,s=e.next.next.point,[o,a,l]=this.FindPolylines(e,t),c=It(n,r),u=It(r,s),y=It(n,s);o.size==l.size&&(this.ink-=c),a.size==l.size&&(this.ink-=u);const R=t.get(new ai(n,s));(!R||0==R.size)&&(this.ink+=y);for(const D of l){const L=this.polylineLength.get(D);this.polylineLength.set(D,L-(c+u-y))}for(const D of l){const L=Array.from(D.Polyline.polylinePoints()).find(k=>k.point.equal(r));this.RemovePolypoint(L),DI(t,[n,r],D),DI(t,[r,s],D),U3(t,[n,s],D)}}FindPolylines(e,t){const r=e.next.point,s=e.next.next.point,o=t.get_(e.point,r),a=t.get_(r,s);return[o,a,Mo(o,a)]}RemovePolypoint(e){const t=e.prev,n=e.next;t.next=n,n.prev=t}GlueCollinearNeighbors(e){const t=new Rn;let n=!1;for(const r of this.metroGraphData.Stations)this.GlueCollinearNeighborsSPN(r,t,e)&&(n=!0);return n&&(this.metroGraphData.Initialize(!1),sh.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,t)),n}GlueCollinearNeighborsSPN(e,t,n){if(e.Neighbors.length<=1)return!1;const r=new wP,s=e.Neighbors;for(let o=0;o<s.length;o++)this.TryToGlueEdges(e,s[o],s[(o+1)%s.length],r,n);if(r.isEmpty)return!1;for(const o of r)this.GlueEdge(o),t.add(o[0].Position),t.add(o[1].Position),t.add(o[2]);return!0}TryToGlueEdges(e,t,n,r,s){if(x.anglePCP(t.Position,e.Position,n.Position)<this.bundlingSettings.AngleThreshold){const a=It(t.Position,e.Position),l=It(n.Position,e.Position),c=Math.min(a,l)/Math.max(a,l);if(c<.05)return;if(a<l){if(this.EdgeGluingIsAllowedSSS(e,t,n))return void this.AddEdgeToGlue(e,n,t,t.Position,r)}else if(this.EdgeGluingIsAllowedSSS(e,n,t))return void this.AddEdgeToGlue(e,t,n,n.Position,r);if(s<5&&c>.5){const u=this.ConstructGluingPoint(e,t,n);this.EdgeGluingIsAllowedSSSP(e,t,n,u)&&this.AddEdgeToGlue(e,n,t,u,r)}}}ConstructGluingPoint(e,t,n){const r=Math.min(It(t.Position,e.Position),It(n.Position,e.Position)/2),s=t.Position.sub(e.Position).normalize().add(n.Position.sub(e.Position).normalize());return e.Position.add(s.mul(r/2))}EdgeGluingIsAllowedSSS(e,t,n){if(t.IsReal||n.IsReal||!If(t.getELP(),n.getELP())||!this.metroGraphData.cdtIntersections.EdgeIsLegal(t,n,t.Position,n.Position))return!1;const r=this.metroGraphData.looseIntersections.ObstaclesToIgnoreForBundle(e,n);return!(Tt.IntersectionsOfLineAndRectangleNodeOverPolylineLR(me.mkPP(e.Position,t.Position),this.metroGraphData.LooseTree).find(l=>!r.has(l.seg1))||Tt.IntersectionsOfLineAndRectangleNodeOverPolylineLR(me.mkPP(t.Position,n.Position),this.metroGraphData.LooseTree).find(l=>!r.has(l.seg1))||this.ComputeCostDeltaAfterEdgeGluing(e,t,n,t.Position)<0)}EdgeGluingIsAllowedSSSP(e,t,n,r){return!(!this.metroGraphData.looseIntersections.HubAvoidsObstaclesPNS__(r,0,Mo(t.getELP(),n.getELP()))||!this.metroGraphData.cdtIntersections.EdgeIsLegal(e,null,e.Position,r)||!this.metroGraphData.cdtIntersections.EdgeIsLegal(t,null,t.Position,r)||!this.metroGraphData.cdtIntersections.EdgeIsLegal(n,null,n.Position,r)||this.ComputeCostDeltaAfterEdgeGluing(e,t,n,r)<0)}ComputeCostDeltaAfterEdgeGluing(e,t,n,r){let s=0;const o=this.metroGraphData.Ink,a=this.metroGraphData.Ink-It(e.Position,n.Position)-It(e.Position,t.Position)+It(e.Position,r)+It(r,t.Position)+It(r,n.Position);s+=rr.InkError(o,a,this.bundlingSettings);for(const y of this.metroGraphData.GetIjInfo(e,n).Metrolines){const R=y.Length,D=y.Length-It(e.Position,n.Position)+It(e.Position,r)+It(r,n.Position);s+=rr.PathLengthsError(R,D,y.IdealLength,this.bundlingSettings)}for(const y of this.metroGraphData.GetIjInfo(e,t).Metrolines){const R=y.Length,D=y.Length-It(e.Position,t.Position)+It(e.Position,r)+It(r,t.Position);s+=rr.PathLengthsError(R,D,y.IdealLength,this.bundlingSettings)}const l=e.cachedIdealRadius,c=this.GetCurrentHubRadius(e),u=fi.GetMinRadiusForTwoAdjacentBundles(c,e,e.Position,t,n,this.metroGraphData,this.bundlingSettings);return u>c&&(s+=rr.RError(u,c,this.bundlingSettings)),l>It(e.Position,r)&&!e.IsReal&&(s-=rr.RError(l,It(e.Position,r),this.bundlingSettings)),s}AddEdgeToGlue(e,t,n,r,s){s.has(n,e)||s.has(t,e)||s.has(e,n)||s.has(e,t)||(s.set(e,n,r),s.set(e,t,r))}GlueEdge(e){const t=e[0],n=e[1],r=e[2];for(const s of t.MetroNodeInfos.map(o=>o.PolyPoint))null!=s.next&&s.next.point.equal(n.Position)?this.SplitPolylinePoint(s,r):null!=s.prev&&s.prev.point.equal(n.Position)&&this.SplitPolylinePoint(s.prev,r)}SplitPolylinePoint(e,t){if(e.point==t||e.next.point==t)return;const n=$i.mkFromPoint(t);n.polyline=e.polyline,n.next=e.next,n.prev=e,n.next.prev=n,n.prev.next=n}RelaxConstrainedEdges(){const e=new Rn;let t=!1;for(const n of this.metroGraphData.VirtualEdges())this.RelaxConstrainedEdge(n[0],n[1],e)&&(t=!0);return t&&(this.metroGraphData.Initialize(!1),sh.FixRoutingMBP(this.metroGraphData,this.bundlingSettings,e)),t}RelaxConstrainedEdge(e,t,n){const r=this.metroGraphData.GetWidthSSN(e,t,this.bundlingSettings.EdgeSeparation),s={closestDist:new Array};this.metroGraphData.cdtIntersections.BundleAvoidsObstacles(e,t,e.Position,t.Position,.99*r/2,s);const o=s.closestDist;if(o.length>0){let l,a=-1;for(const c of o){if(Math.min(It(e.Position,c[1]),It(t.Position,c[1]))/It(e.Position,t.Position)<.1)continue;const D=It(c[0],c[1]);(-1==a||D<a)&&(a=D,l=c[1])}if(-1==a||!this.metroGraphData.looseIntersections.HubAvoidsObstaclesPNS__(l,0,Mo(e.getELP(),t.getELP())))return!1;n.add(l),n.add(e.Position),n.add(t.Position);for(const c of this.metroGraphData.GetIjInfo(e,t).Metrolines){let u=null;for(const y of c.Polyline.polylinePoints())if(y.point.equal(e.Position)){u=y;break}null!=u.next&&u.next.point.equal(t.Position)?this.SplitPolylinePoint(u,l):this.SplitPolylinePoint(u.prev,l)}return!0}return!1}RemoveDoublePathCrossings(){const e=new rh(this.metroGraphData,this.metroGraphData.PointIsAcceptableForEdge.bind(this)).run();return e&&(this.metroGraphData.Initialize(!1),sh.FixRouting(this.metroGraphData,this.bundlingSettings)),e}}class qf{constructor(e,t,n){this.upperBound=Number.POSITIVE_INFINITY,this._visGraph=n,n.ClearPrevEdgesTable();for(const r of n.Vertices())r.Distance=Number.POSITIVE_INFINITY;this.sources=e,this.targets=new Set(t)}GetPath(){const e=new Vo;for(const t of this.sources)t.Distance=0,e.Enqueue(t,0);for(;!e.IsEmpty()&&(this._current=e.Dequeue(),!this.targets.has(this._current));){for(const t of this._current.OutEdges)this.PassableOutEdge(t)&&this.ProcessNeighbor(e,t,t.Target);for(const t of this._current.InEdges.filter(this.PassableInEdge.bind))this.ProcessNeighbor(e,t,t.Source)}return null==this._visGraph.PreviosVertex(this._current)?null:this.CalculatePath()}PassableOutEdge(e){return this.targets.has(e.Target)||!qf.IsForbidden(e)}PassableInEdge(e){return this.targets.has(e.Source)||!qf.IsForbidden(e)}static IsForbidden(e){return(null!=e.IsPassable&&!e.IsPassable()||e)instanceof As}ProcessNeighbor(e,t,n){const s=this._current.Distance+t.Length;s>=this.upperBound||(this.targets.has(n)&&(this.upperBound=s,this.closestTarget=n),null==this._visGraph.PreviosVertex(n)?(n.Distance=s,this._visGraph.SetPreviousEdge(n,t),e.Enqueue(n,s)):s<n.Distance&&(n.Distance=s,this._visGraph.SetPreviousEdge(n,t),e.DecreasePriority(n,s)))}CalculatePath(){if(null==this.closestTarget)return null;const e=new Array;let t=this.closestTarget;do{e.push(t),t=this._visGraph.PreviosVertex(t)}while(t.Distance>0);return e.push(t),e.reverse()}}let sc=(()=>{class i extends dn{constructor(t,n,r,s,o,a,l,c,u,y){super(null),this.bundlingSettings=s,this.edgesToRoute=t,this.regularEdges=t.filter(R=>R.source!=R.target),this.VisibilityGraph=r,this.shortestPathRouter=n,this.LoosePadding=o,this.LooseHierarchy=l,this.TightHierarchy=a,this.EdgeLooseEnterable=c,this.EdgeTightEnterable=u,this.loosePolylineOfPort=y}ThereAreOverlaps(t){return Rr(t,t,te.CurvesIntersect)}run(){this.ThereAreOverlaps(this.TightHierarchy)?this.Status=ih.Overlaps:(this.FixLocationsForHookAnywherePorts(this.edgesToRoute),this.RoutePathsWithSteinerDijkstra()?(this.FixChildParentEdges(),this.bundlingSettings.StopAfterShortestPaths||this.OrderOptimizeNudgeEtc(),this.RouteSelfEdges(),this.FixArrowheads()):this.Status=ih.EdgeSeparationIsTooLarge)}OrderOptimizeNudgeEtc(){const t=new eW(this.regularEdges,this.LooseHierarchy,this.TightHierarchy,this.bundlingSettings,this.shortestPathRouter.CdtProperty,this.EdgeLooseEnterable,this.EdgeTightEnterable,this.loosePolylineOfPort);Ta.FixRouting(t,this.bundlingSettings),new Jf(t,this.bundlingSettings).run()}FixChildParentEdges(){for(const t of this.regularEdges){const n=t.sourcePort,r=t.targetPort;if(n.Curve.boundingBox.containsRect(r.Curve.boundingBox)){const s=te.intersectionOne(n.Curve,me.mkPP(t.curve.start,t.curve.end),!1);t.curve.startPoint.point=s.x}if(r.Curve.boundingBox.containsRect(n.Curve.boundingBox)){const s=te.intersectionOne(r.Curve,me.mkPP(t.curve.start,t.curve.end),!0);t.curve.endPoint.point=s.x}}}static CreateConstrainedDelaunayTriangulation(t){const n=Array.from(t.GetAllLeaves());let r=t.irect;return r=r.pad(r.diagonal/4),i.GetConstrainedDelaunayTriangulation(n.concat([r.perimeter()]))}static GetConstrainedDelaunayTriangulation(t){const n=new pn(null,t,null);return n.run(),n}FixLocationsForHookAnywherePorts(t){for(const n of t){let r=n.sourcePort instanceof ui;if(r){const s=n.sourcePort;s.SetLocation(this.FigureOutHookLocation(s.LoosePolyline,n.targetPort,n))}else if(r=n.targetPort instanceof ui,r){const s=n.targetPort;s.SetLocation(this.FigureOutHookLocation(s.LoosePolyline,n.sourcePort,n))}}}FigureOutHookLocation(t,n,r){return n instanceof Cr?this.FigureOutHookLocationForClusterOtherPort(t,n,r):this.FigureOutHookLocationForSimpleOtherPort(t,n,r)}FigureOutHookLocationForClusterOtherPort(t,n,r){const s=this.shortestPathRouter.MakeTransparentShapesOfEdgeGeometry(r),a=new qf(Array.from(n.LoosePolyline).map(this.VisibilityGraph.FindVertex.bind),Array.from(t).map(this.VisibilityGraph.FindVertex.bind),this.VisibilityGraph).GetPath();for(const l of s)l.IsTransparent=!1;return a[a.length-1].point}FigureOutHookLocationForSimpleOtherPort(t,n,r){const s=n.Location,o=this.shortestPathRouter.MakeTransparentShapesOfEdgeGeometry(r),l=new ju(this.VisibilityGraph.FindVertex(s),Array.from(t).map(c=>this.VisibilityGraph.FindVertex(c)),this.VisibilityGraph).GetPath();for(const c of o)c.IsTransparent=!1;return l[l.length-1].point}RoutePathsWithSteinerDijkstra(){return this.shortestPathRouter.VisibilityGraph=this.VisibilityGraph,this.shortestPathRouter.BundlingSettings=this.bundlingSettings,this.shortestPathRouter.geomEdges=this.regularEdges,this.shortestPathRouter.ObstacleHierarchy=this.LooseHierarchy,this.shortestPathRouter.RouteEdges(),!(null!=this.shortestPathRouter.CdtProperty&&!this.AnalyzeEdgeSeparation())}AnalyzeEdgeSeparation(){const t=new Map;this.shortestPathRouter.FillCrossedCdtEdges(t);const n=this.GetPathsOnCdtEdge(t),r=this.CalculateMaxAllowedEdgeSeparation(n);if(r>=this.bundlingSettings.EdgeSeparation)return!0;if(r<=.02){for(const s of this.regularEdges)s.curve=null;return!1}return this.bundlingSettings.EdgeSeparation=r,this.shortestPathRouter.RouteEdges(),!0}GetPathsOnCdtEdge(t){const n=new Map;for(const r of t.keys())for(const s of t.get(r))Pf(n,s,r);return n}CalculateMaxAllowedEdgeSeparation(t){let n=.01,r=10;if(this.EdgeSeparationIsOkMN(t,r))return r;for(;Math.abs(r-n)>.01;){const s=(n+r)/2;this.EdgeSeparationIsOkMN(t,s)?n=s:r=s}return n}EdgeSeparationIsOkMN(t,n){const r=t.size;if(0==r)return!0;let s=0;for(const o of t.keys())this.EdgeSeparationIsOk(o,t.get(o),n)&&s++;return s/r>this.bundlingSettings.MinimalRatioOfGoodCdtEdges}EdgeSeparationIsOk(t,n,r){return Array.from(n).map(o=>o.lineWidth).reduce((o,a)=>o+a,0)+(n.size-1)*r<=t.Capacity}RouteSelfEdges(){for(const t of this.edgesToRoute)t.source==t.target&&(t.curve=Do.RouteSelfEdge(t.source.boundaryCurve,2*this.LoosePadding,{smoothedPolyline:null}))}FixArrowheads(){for(const t of this.edgesToRoute)_o.trimSplineAndCalculateArrowheadsII(t,t.source.boundaryCurve,t.target.boundaryCurve,t.curve,!1)}}return i.SuperLoosePaddingCoefficient=1.1,i})();class lW{constructor(e,t,n){this.numberOfPassedPaths=0,this.VisibilityEdge=e,this.Source=t,this.Target=n}get TargetPoint(){return this.Target.Point}get SourcePoint(){return this.Source.Point}get IsOccupied(){return this.numberOfPassedPaths>0}get IsPassable(){return this.Target.IsTargetOfRouting||this.Source.IsSourceOfRouting||null==this.VisibilityEdge.IsPassable||this.VisibilityEdge.IsPassable()}AddOccupiedEdge(){this.numberOfPassedPaths++}RemoveOccupiedEdge(){this.numberOfPassedPaths--}}class cW{constructor(e){this.InBoneEdges=new Array,this.OutBoneEdges=new Array,this.VisibilityVertex=e}get Prev(){return null==this.PrevEdge?null:this.PrevEdge.Source==this?this.PrevEdge.Target:this.PrevEdge.Source}get Point(){return this.VisibilityVertex.point}get Cost(){return this.IsSourceOfRouting?this.cost:null==this.Prev?Number.POSITIVE_INFINITY:this.cost}set Cost(e){this.cost=e}SetPreviousToNull(){this.PrevEdge=null}}class Ho{constructor(e,t,n){this.EdgesToRoutes=new Map,this.EdgesToRouteSources=new Map,this.MakeTransparentShapesOfEdgeGeometry=e,this.CdtProperty=t,this.Gates=n}CreateGraphElements(){for(const e of this.vertexArray){const t=e.VisibilityVertex;for(const n of t.InEdges){const r=new lW(n,this.VisibilityVerticesToSdVerts.get(n.Source),this.VisibilityVerticesToSdVerts.get(n.Target)),s=this.VisibilityVerticesToSdVerts.get(n.Source);e.InBoneEdges.push(r),s.OutBoneEdges.push(r)}}}CreateRoutingGraph(){this.vertexArray=[],this.VisibilityVerticesToSdVerts=new Map;for(const e of this.VisibilityGraph.Vertices()){const t=new cW(e);this.vertexArray.push(t),this.VisibilityVerticesToSdVerts.set(e,t)}this.CreateGraphElements()}RouteEdges(){this.Initialize(),this.RestoreCapacities();for(const e of this.geomEdges)this.EdgesToRoutes.set(e,this.RouteEdge(e));this.RerouteEdges();for(const e of this.geomEdges)this.SetEdgeGeometryCurve(e)}SetEdgeGeometryCurve(e){const t=new He;let n=this.EdgesToRouteSources.get(e);t.addPoint(n.Point);for(const o of this.EdgesToRoutes.get(e))o.SourcePoint.equal(n.Point)?(t.addPoint(o.TargetPoint),n=o.Target):(t.addPoint(o.SourcePoint),n=o.Source);e.curve=t,e.sourcePort instanceof Cr&&Ho.ExtendPolylineStartToClusterBoundary(t,e.sourcePort.Curve),e.targetPort instanceof Cr&&Ho.ExtendPolylineEndToClusterBoundary(t,e.targetPort.Curve)}static ExtendPolylineEndToClusterBoundary(e,t){const n=t.closestParameter(e.end);e.addPoint(t.value(n))}static ExtendPolylineStartToClusterBoundary(e,t){const n=t.closestParameter(e.start);e.PrependPoint(t.value(n))}RerouteEdges(){this.RestoreCapacities();for(const e of this.geomEdges){const t=this.RerouteEdge(e);this.EdgesToRoutes.set(e,t)}}RestoreCapacities(){null!=this.CdtProperty&&this.CdtProperty.RestoreEdgeCapacities()}RerouteEdge(e){const t=this.EdgesToRoutes.get(e);for(const n of t)n.RemoveOccupiedEdge();return this.RouteEdge(e)}RouteEdge(e){this.CurrentEdgeGeometry=e;for(let r=0;r<this.vertexArray.length;r++){const s=this.vertexArray[r];s.SetPreviousToNull(),s.IsTargetOfRouting=s.IsSourceOfRouting=!1}const t=this.MakeTransparentShapesOfEdgeGeometry(e),n=this.RouteEdgeWithGroups();for(const r of t)r.IsTransparent=!1;return n}RouteEdgeWithGroups(){for(let e=0;e<2;e++){this.SetLengthCoefficient(),this.Queue=new Vo,this.sourceLoosePoly=this.SetPortVerticesAndObstacles(this.CurrentEdgeGeometry.sourcePort,!0),this.targetLoosePoly=this.SetPortVerticesAndObstacles(this.CurrentEdgeGeometry.targetPort,!1);const t=this.RouteOnKnownSourceTargetVertices(this.CurrentEdgeGeometry.targetPort.Location.sub(this.CurrentEdgeGeometry.sourcePort.Location).normalize(),0==e);if(null!=t)return t;for(let n=0;n<this.vertexArray.length;n++)this.vertexArray[n].SetPreviousToNull()}throw new Error}RouteOnKnownSourceTargetVertices(e,t){for(this.LowestCostToTarget=Number.POSITIVE_INFINITY,this.ClosestTargetVertex=null;this.Queue.count>0;){const n={priority:0},r=this.Queue.DequeueAndGetPriority(n);if(!(n.priority>=this.LowestCostToTarget)){for(let s=0;s<r.OutBoneEdges.length;s++){const o=r.OutBoneEdges[s];o.IsPassable&&this.ProcessOutcomingBoneEdge(r,o,e,t)}for(let s=0;s<r.InBoneEdges.length;s++){const o=r.InBoneEdges[s];o.IsPassable&&this.ProcessIncomingBoneEdge(r,o,e,t)}}}return this.GetPathAndUpdateRelatedCosts()}ProcessOutcomingBoneEdge(e,t,n,r){r&&n.dot(t.TargetPoint.sub(t.SourcePoint))<0||this.ProcessBoneEdge(e,t.Target,t)}ProcessIncomingBoneEdge(e,t,n,r){r&&n.dot(t.SourcePoint.sub(t.TargetPoint))<0||this.ProcessBoneEdge(e,t.Source,t)}ProcessBoneEdge(e,t,n){const r=this.GetEdgeAdditionalCost(n,e.Cost);if(!(t.Cost<=r))if(t.Cost=r,t.PrevEdge=n,this.Queue.ContainsElement(t))this.Queue.DecreasePriority(t,r);else{if(t.IsTargetOfRouting){let s=0;return this.CurrentEdgeGeometry.targetPort instanceof Cr&&(s=this.LengthCoefficient*t.Point.sub(this.CurrentEdgeGeometry.targetPort.Location).length),void(r+s<this.LowestCostToTarget&&(this.LowestCostToTarget=r+s,this.ClosestTargetVertex=t))}this.Enqueue(t)}}GetPathAndUpdateRelatedCosts(){let e=this.ClosestTargetVertex;if(null==e)return null;const t=new Array;for(;null!=e.PrevEdge;)t.push(e.PrevEdge),this.RegisterPathInBoneEdge(e.PrevEdge),e=e.Prev;return this.EdgesToRouteSources.set(this.CurrentEdgeGeometry,e),t.reverse(),t}RegisterPathInBoneEdge(e){e.AddOccupiedEdge(),null!=this.CdtProperty&&0!=this.BundlingSettings.CapacityOverflowCoefficient&&this.UpdateResidualCostsOfCrossedCdtEdges(e)}UpdateResidualCostsOfCrossedCdtEdges(e){for(const t of e.CrossedCdtEdges)this.AdjacentToSourceOrTarget(t)||(t.ResidualCapacity-=t.ResidualCapacity==t.Capacity?this.CurrentEdgeGeometry.lineWidth:this.CurrentEdgeGeometry.lineWidth+this.BundlingSettings.EdgeSeparation)}H(e){return e.Cost+this.LengthCoefficient*e.Point.sub(this.CurrentEdgeGeometry.targetPort.Location).length}GetEdgeAdditionalCost(e,t){const n=e.TargetPoint.sub(e.SourcePoint).length;return this.LengthCoefficient*n+t+(e.IsOccupied?0:this.BundlingSettings.InkImportance*n)+this.CapacityOverflowCost(e)}CapacityOverflowCost(e){if(null==this.CdtProperty||0==this.BundlingSettings.CapacityOverflowCoefficient)return 0;let t=0;for(const n of this.CrossedCdtEdgesOfBoneEdge(e))t+=this.CostOfCrossingCdtEdgeLocal(this.capacityOverlowPenaltyMultiplier,this.BundlingSettings,this.CurrentEdgeGeometry,n);return t}CrossedCdtEdgesOfBoneEdge(e){return Array.from(null!=e.CrossedCdtEdges?e.CrossedCdtEdges:e.CrossedCdtEdges=this.ThreadBoneEdgeThroughCdt(e))}ThreadBoneEdgeThroughCdt(e){const t=e.SourcePoint,n=e.Source.Triangle,r=new Set,s=e.TargetPoint;if(pn.PointIsInsideOfTriangle(s,n))return r;const o=new jf(n,t,s);for(;o.MoveNext();){const a=o.CurrentPiercedEdge;this.Gates.has(a)&&r.add(a)}return r}static CostOfCrossingCdtEdge(e,t,n,r){let s=n.lineWidth;r.Capacity!=r.ResidualCapacity&&(s+=t.EdgeSeparation);const o=r.ResidualCapacity-s;return o>=0?0:o*e*-1}CostOfCrossingCdtEdgeLocal(e,t,n,r){return this.AdjacentToSourceOrTarget(r)?0:Ho.CostOfCrossingCdtEdge(e,t,n,r)}AdjacentToSourceOrTarget(e){return e.upperSite.Owner==this.sourceLoosePoly||e.lowerSite.Owner==this.sourceLoosePoly||e.upperSite.Owner==this.targetLoosePoly||e.lowerSite.Owner==this.targetLoosePoly}SetLengthCoefficient(){const e=this.GetIdealDistanceBetweenSourceAndTarget(this.CurrentEdgeGeometry);this.LengthCoefficient=this.BundlingSettings.PathLengthImportance/e}GetIdealDistanceBetweenSourceAndTarget(e){return e.sourcePort.Location.sub(e.targetPort.Location).length}SetPortVerticesAndObstacles(e,t){let n;if(e instanceof Cr){n=e.LoosePolyline;for(const s of n){let o=0;t&&(o=this.LengthCoefficient*s.sub(this.CurrentEdgeGeometry.sourcePort.Location).length),this.AddAndEnqueueVertexToEnds(s,t,o)}}else if(e instanceof ui){n=e.LoosePolyline;for(const s of n)this.AddAndEnqueueVertexToEnds(s,t,0)}else{this.AddAndEnqueueVertexToEnds(e.Location,t,0);const r=Array.from(this.ObstacleHierarchy.GetNodeItemsIntersectingRectangle(e.Curve.boundingBox));let s=r[0].boundingBox.diagonal;n=r[0];for(let o=1;o<r.length;o++){const a=r[o],l=a.boundingBox.diagonal;l<s&&(s=l,n=a)}}return n}Enqueue(e){this.Queue.Enqueue(e,this.H(e))}AddAndEnqueueVertexToEnds(e,t,n){const r=this.FindVertex(e),s=this.VisibilityVerticesToSdVerts.get(r);t?(s.IsSourceOfRouting=!0,s.Cost=n,this.Enqueue(s)):s.IsTargetOfRouting=!0}FindVertex(e){return this.VisibilityGraph.FindVertex(e)}Initialize(){this.CreateRoutingGraph(),null!=this.CdtProperty&&(this.capacityOverlowPenaltyMultiplier=Ho.CapacityOverflowPenaltyMultiplier(this.BundlingSettings),this.SetVertexTriangles(),this.CalculateCapacitiesOfTrianglulation())}CalculateCapacitiesOfTrianglulation(){for(const e of this.Gates)Ho.CalculateCdtEdgeCapacityForEdge(e)}static CalculateCdtEdgeCapacityForEdge(e){if(e.Constrained||null==e.CwTriangle||null==e.CcwTriangle)return;const t=e.upperSite.Owner,n=e.lowerSite.Owner;if(t!=n){const r=Mi.DistancePoint(new Mi(t),e.lowerSite.point),s=Mi.DistancePoint(new Mi(n),e.upperSite.point);e.Capacity=(r+s)/2}}SetVertexTriangles(){Zi(fn(Array.from(this.CdtProperty.GetTriangles()).map(n=>Gn(n,n.BoundingBox()))),fn(this.vertexArray.map(n=>Gn(n,De.mkOnPoints([n.Point])))),(n,r)=>this.TryToAssigenTriangleToVertex(n,r));for(const n of this.vertexArray);}TryToAssigenTriangleToVertex(e,t){null==t.Triangle&&pn.PointIsInsideOfTriangle(t.Point,e)&&(t.Triangle=e)}static CapacityOverflowPenaltyMultiplier(e){return e.CapacityOverflowCoefficient*(e.PathLengthImportance+e.InkImportance)}FillCrossedCdtEdges(e){for(const t of this.geomEdges){this.sourceLoosePoly=this.SetPortVerticesAndObstacles(t.sourcePort,!0),this.targetLoosePoly=this.SetPortVerticesAndObstacles(t.targetPort,!1);for(const n of this.EdgesToRoutes.get(t))for(const r of this.CrossedCdtEdgesOfBoneEdge(n))this.AdjacentToSourceOrTarget(r)||Pf(e,t,r)}}}class Qf{constructor(e,t,n,r,s){this.multiEdges=e,this.interactiveEdgeRouter=t,this.bundlingSettings=r,this.transparentShapeSetter=s,this.nodeTree=OE(n,o=>o.boundingBox)}run(){for(const e of this.GetIndependantPreGraphs())new sc(e.edges,new Ho(this.transparentShapeSetter,null,null),this.interactiveEdgeRouter.VisibilityGraph,this.bundlingSettings,this.interactiveEdgeRouter.LoosePadding,this.interactiveEdgeRouter.TightHierarchy,this.interactiveEdgeRouter.LooseHierarchy,null,null,null).run()}GetPortCurve(e){return this.nodeTree.FirstHitNodeWithPredicate(e.Location,(n,r)=>te.PointRelativeToCurveLocation(n,r)!=We.Outside?Gt.Stop:Gt.Continue).UserData}GetIndependantPreGraphs(){const e=this.CreateInitialPregraphs();for(;;){const t=e.length;if(this.UniteConnectedPreGraphs({preGraphs:e}),t<=e.length)break}return e}UniteConnectedPreGraphs(e){const t=Qf.GetIntersectionGraphOfPreGraphs(e.preGraphs);if(null==t)return;const n=Bu(t),r=new Array;for(const s of n){let o=null;for(const a of s)null==o?(o=e.preGraphs[a],r.push(o)):o.AddGraph(e.preGraphs[a])}e.preGraphs=r;for(const s of e.preGraphs)this.AddIntersectingNodes(s)}AddIntersectingNodes(e){const t=e.boundingBox;for(const n of this.nodeTree.GetNodeItemsIntersectingRectangle(t))e.AddNodeBoundary(n)}static GetIntersectionGraphOfPreGraphs(e){const t=Qf.EnumeratePairsOfIntersectedPreGraphs(e);return t.length?Xs(t,e.length):null}static EnumeratePairsOfIntersectedPreGraphs(e){const n=OE(Array.from(Array(e.length).keys()),s=>e[s].boundingBox),r=new Array;return hi(n,n,(s,o)=>r.push(new mt(s,o))),r}CreateInitialPregraphs(){return this.multiEdges.map(e=>this.CreatePregraphFromSetOfEdgeGeometries(e))}CreatePregraphFromSetOfEdgeGeometries(e){const t=new Set,n=e[0],r=this.GetPortCurve(n.sourcePort),s=r.boundingBox;t.add(r),t.add(n.targetPort.Curve),s.addRec(n.targetPort.Curve.boundingBox);const o=this.nodeTree.GetNodeItemsIntersectingRectangle(s);for(const a of o)t.add(a);return uw.constructorStatic(e,t)}}class zt extends dn{constructor(e,t,n=2,r=1.5,s=Math.PI/180*30,o=null,a=null){super(a),this.continueOnOverlaps=!0,this.shapesToTightLooseCouples=new Map,this.portLocationsToLoosePolylines=new Di,this.multiEdgesSeparation=5,this.routeMultiEdgesAsBundles=!0,this.UsePolylineEndShortcutting=!0,this.UseInnerPolylingShortcutting=!0,this.AllowedShootingStraightLines=!0,this._overlapsDetected=!1,this.KeepOriginalSpline=!1,this.ArrowHeadRatio=0,this.bidirectional=!1,this._edges=t,this.BundlingSettings=o,this.geomGraph=e,this.LoosePadding=r,this.tightPadding=n,this.coneAngle=s}get ContinueOnOverlaps(){return this.continueOnOverlaps}set ContinueOnOverlaps(e){this.continueOnOverlaps=e}*edges(){if(null!=this._edges)for(const e of this._edges)yield e}get LoosePadding(){return this.loosePadding}set LoosePadding(e){this.loosePadding=e}get MultiEdgesSeparation(){return this.multiEdgesSeparation}set MultiEdgesSeparation(e){this.multiEdgesSeparation=e}static mk2(e,t){return zt.mk5(e,t.Padding,t.PolylinePadding,t.ConeAngle,t.BundlingSettings)}static mk4(e,t,n,r){return new zt(e,Array.from(e.edges()),t,n,r,null)}static mk5(e,t,n,r,s){return new zt(e,Array.from(e.edges()),t,n,r,s)}static mk6(e,t,n,r,s,o){const a=zt.mk4(e,t,n,r),l=Xr.GetShapes(s,o);return a.Initialize(l,r),a}Initialize(e,t){this.rootShapes=e.filter(n=>null==n.Parents||0==n.Parents.length),this.coneAngle=t,0==this.coneAngle&&(this.coneAngle=Math.PI/6)}run(){if(this.geomGraph.isEmpty())return;const e=er.GetShapes(this.geomGraph,this._edges);null==this.BundlingSettings&&this.geomGraph.layoutSettings&&this.geomGraph.layoutSettings.edgeRoutingSettings&&this.geomGraph.layoutSettings.edgeRoutingSettings.BundlingSettings&&(this.BundlingSettings=this.geomGraph.layoutSettings.edgeRoutingSettings.BundlingSettings),this.Initialize(e,this.coneAngle),this.GetOrCreateRoot(),this.RouteOnRoot(),this.RemoveRoot()}RouteOnRoot(){this.CalculatePortsToShapes(),this.CalculatePortsToEnterableShapes(),this.CalculateShapeToBoundaries(this.root),(!this.OverlapsDetected||this.ContinueOnOverlaps)&&(this.BindLooseShapes(),this.SetLoosePolylinesForAnywherePorts(),this.CalculateVisibilityGraph(),this.RouteOnVisGraph())}CalculatePortsToEnterableShapes(){this.portsToEnterableShapes=new Map;for(const[e,t]of this.portsToShapes){const n=new Set;zt.EdgesAttachedToPortAvoidTheNode(e)||n.add(t),this.portsToEnterableShapes.set(e,n)}for(const e of this.rootShapes)for(const t of e.Descendants())for(const n of t.Ports)Hu(this.portsToEnterableShapes.get(n),Array.from(t.Ancestors()).filter(s=>null!=s.BoundaryCurve))}static EdgesAttachedToPortAvoidTheNode(e){return e instanceof Li||e instanceof Cr}SetLoosePolylinesForAnywherePorts(){for(const[e,t]of this.shapesToTightLooseCouples)for(const n of e.Ports)n instanceof ui&&(n.LoosePolyline=t.LooseShape.BoundaryCurve),n instanceof Cr&&(n.LoosePolyline=t.LooseShape.BoundaryCurve)}BindLooseShapes(){this.looseRoot=new ql;for(const e of this.root.Children){const t=this.shapesToTightLooseCouples.get(e).LooseShape;this.BindLooseShapesUnderShape(e),this.looseRoot.AddChild(t)}}BindLooseShapesUnderShape(e){const t=this.shapesToTightLooseCouples.get(e).LooseShape;for(const n of e.Children){const r=this.shapesToTightLooseCouples.get(n).LooseShape;t.AddChild(r),this.BindLooseShapesUnderShape(n)}}CalculateShapeToBoundaries(e){if(this.ProgressStep(),0==e.Children.length)return;for(const n of e.Children)this.CalculateShapeToBoundaries(n);const t=new $E(e,this.tightPadding,this.AdjustedLoosePadding,this.shapesToTightLooseCouples);t.Calculate(),this.OverlapsDetected||(this.OverlapsDetected=t.OverlapsDetected)}get OverlapsDetected(){return this._overlapsDetected}set OverlapsDetected(e){this._overlapsDetected=e}get AdjustedLoosePadding(){return null==this.BundlingSettings?this.LoosePadding:this.LoosePadding*sc.SuperLoosePaddingCoefficient}GroupEdgesByPassport(){const e=new Array;for(const t of this._edges){const n=this.EdgePassport(t);let r=e.find(s=>If(s.passport,n));r||(r={passport:n,edges:[]},e.push(r)),r.edges.push(t)}return e}RouteOnVisGraph(){if(this.ancestorSets=zt.GetAncestorSetsMap(Array.from(this.root.Descendants())),null==this.BundlingSettings)for(const e of this.GroupEdgesByPassport()){const n=this.GetObstaclesFromPassport(e.passport),r=this.CreateInteractiveEdgeRouter(Array.from(n));this.RouteEdgesWithTheSamePassport(e,r,n)}else this.RouteBundles()}RouteEdgesWithTheSamePassport(e,t,n){const r={regularEdges:[],multiEdges:[]};if(this.RouteMultiEdgesAsBundles){this.SplitOnRegularAndMultiedges(e.edges,r);for(const s of r.regularEdges)this.RouteEdge(t,s);null!=r.multiEdges&&(this.ScaleDownLooseHierarchy(t,n),this.RouteMultiEdges(r.multiEdges,t,e.passport))}else for(const s of e.edges)this.RouteEdge(t,s)}get RouteMultiEdgesAsBundles(){return this.routeMultiEdgesAsBundles}set RouteMultiEdgesAsBundles(e){this.routeMultiEdgesAsBundles=e}RouteEdge(e,t){const n=this.MakeTransparentShapesOfEdgeGeometryAndGetTheShapes(t);this.ProgressStep(),this.RouteEdgeInternal(t,e),zt.SetTransparency(n,!1)}ScaleDownLooseHierarchy(e,t){const n=new Array;for(const r of t){const s=this.shapesToTightLooseCouples.get(r);n.push(Tr.LoosePolylineWithFewCorners(s.TightPolyline,s.Distance/1.1))}e.LooseHierarchy=zt.CreateLooseObstacleHierarachy(n),e.ClearActivePolygons(),e.AddActivePolygons(n.map(r=>new Mi(r)))}RouteMultiEdges(e,t,n){const r=[];for(const a of n)for(const l of a.Children)r.push(l.BoundaryCurve);const s=new RI;s.InkImportance=1e-5,s.EdgeSeparation=this.MultiEdgesSeparation,new Qf(e,t,r,s,a=>this.MakeTransparentShapesOfEdgeGeometryAndGetTheShapes(a)).run()}SplitOnRegularAndMultiedges(e,t){const n=new Ku;for(const r of e)zt.IsEdgeToParent(r)?t.regularEdges.push(r):zt.RegisterInPortLocationsToEdges(r,n);t.multiEdges=null;for(const r of n.values())1==r.length||this.OverlapsDetected?t.regularEdges.push(r[0]):(null==t.multiEdges&&(t.multiEdges=new Array),t.multiEdges.push(r))}static RegisterInPortLocationsToEdges(e,t){let n;const r=new ai(e.sourcePort.Location,e.targetPort.Location);n=t.get(r),n||(n=new Array,t.set(r,n)),n.push(e)}static IsEdgeToParent(e){return e.sourcePort instanceof ui||e.targetPort instanceof ui}CreateInteractiveEdgeRouter(e){const t=new Set(e.map(r=>this.shapesToTightLooseCouples.get(r).LooseShape.BoundaryCurve)),n=new Tt(this.cancelToken);return n.ObstacleCalculator=new Tr(e.map(r=>r.BoundaryCurve),this.tightPadding,this.loosePadding,!1),n.VisibilityGraph=this.visGraph,n.TightHierarchy=this.CreateTightObstacleHierarachy(e),n.LooseHierarchy=zt.CreateLooseObstacleHierarachy(Array.from(t)),n.UseSpanner=!0,n.LookForRoundedVertices=!0,n.TightPadding=this.tightPadding,n.LoosePadding=this.LoosePadding,n.UseEdgeLengthMultiplier=this.UseEdgeLengthMultiplier,n.UsePolylineEndShortcutting=this.UsePolylineEndShortcutting,n.UseInnerPolylingShortcutting=this.UseInnerPolylingShortcutting,n.AllowedShootingStraightLines=this.AllowedShootingStraightLines,n.AddActivePolygons(Array.from(t).map(r=>new Mi(r))),n}GetObstaclesFromPassport(e){if(0==e.size)return new Set(this.root.Children);const t=this.GetCommonAncestorsAbovePassport(e),n=this.GetAllAncestors(e),r=new Set;for(const a of e)for(const l of a.Children)n.has(l)||r.add(l);const s=zl(new Set(e),r),o=new Io.c;for(const a of e)t.has(a)||o.enqueue(a);for(;o.length>0;){const a=o.dequeue();for(const l of a.Parents){for(const c of l.Children)n.has(c)||r.add(c);!t.has(l)&&!s.has(l)&&(o.enqueue(l),s.add(l))}}return r}GetAllAncestors(e){if(0==e.size)return new Set;let t=new Set(e);for(const n of e)t=zl(t,this.ancestorSets.get(n));return t}GetCommonAncestorsAbovePassport(e){if(0==e.size)return new Set;const t=Array.from(e);let n=this.ancestorSets.get(t[0]);for(let r=1;r<t.length;r++)n=Mo(n,this.ancestorSets.get(t[r]));return n}RouteBundles(){this.ScaleLooseShapesDown(),this.CalculateEdgeEnterablePolylines();const e=this.GetLooseHierarchy(),t=sc.CreateConstrainedDelaunayTriangulation(e),n=new Ho(s=>this.MakeTransparentShapesOfEdgeGeometryAndGetTheShapes(s),t,this.FindCdtGates(t));new sc(this._edges,n,this.visGraph,this.BundlingSettings,this.LoosePadding,this.GetTightHierarchy(),e,this.enterableLoose,this.enterableTight,s=>this.LoosePolyOfOriginalShape(this.portsToShapes.get(s))).run()}CreateTheMapToParentLooseShapes(e,t){for(const n of e.Children){const s=this.shapesToTightLooseCouples.get(n).LooseShape.BoundaryCurve;t.set(s,e),this.CreateTheMapToParentLooseShapes(n,t)}}FindCdtGates(e){const t=new Map;this.CreateTheMapToParentLooseShapes(this.root,t);const n=new Set;for(const r of e.PointsToSites.values())for(const s of r.Edges){if(null==s.CwTriangle&&null==s.CcwTriangle)continue;const o=r.Owner,a=s.lowerSite.Owner;if(o==a)continue;const l=t.get(o);l&&l==t.get(a)&&n.add(s)}return n}CalculateEdgeEnterablePolylines(){this.enterableLoose=new Map,this.enterableTight=new Map;for(const e of this.edges()){const t=new Set,n=new Set;this.GetEdgeEnterablePolylines(e,t,n),this.enterableLoose.set(e,t),this.enterableTight.set(e,n)}}GetEdgeEnterablePolylines(e,t,n){const r=this.portsToShapes.get(e.sourcePort),s=this.portsToShapes.get(e.targetPort);r!=this.root&&this.GetEnterablesForShape(r,t,n),s!=this.root&&this.GetEnterablesForShape(s,t,n)}GetEnterablesForShape(e,t,n){for(const r of this.ancestorSets.get(e)){const s=this.LoosePolyOfOriginalShape(r);s&&t.add(s);const o=this.TightPolyOfOriginalShape(r);o&&n.add(o)}}GetTightHierarchy(){return fn(Array.from(this.shapesToTightLooseCouples.values()).map(e=>Gn(e.TightPolyline,e.TightPolyline.boundingBox)))}GetLooseHierarchy(){const e=new Set;for(const t of this.shapesToTightLooseCouples.values())e.add(t.LooseShape.BoundaryCurve);return fn(Array.from(e).map(t=>Gn(t,t.boundingBox)))}ScaleLooseShapesDown(){for(const[,e]of this.shapesToTightLooseCouples)e.LooseShape.BoundaryCurve=Tr.LoosePolylineWithFewCorners(e.TightPolyline,e.Distance/sc.SuperLoosePaddingCoefficient)}EdgePassport(e){const t=new Set,n=this.portsToShapes.get(e.sourcePort),r=this.portsToShapes.get(e.targetPort);return this.IsAncestor(n,r)?(Hu(t,r.Parents),t.add(n),t):this.IsAncestor(r,n)?(Hu(t,n.Parents),t.add(r),t):(n!=this.looseRoot&&Hu(t,n.Parents),r!=this.looseRoot&&Hu(t,r.Parents),t)}*AllPorts(){for(const e of this.edges())yield e.sourcePort,yield e.targetPort}CalculatePortsToShapes(){this.portsToShapes=new Map;for(const e of this.root.Descendants())for(const t of e.Ports)this.portsToShapes.set(t,e);for(const e of this.AllPorts())this.portsToShapes.has(e)||(this.root.Ports.add(e),this.portsToShapes.set(e,this.root))}RouteEdgeInternal(e,t){const n=new Array;e.sourcePort instanceof ui||wa(n,this.AddVisibilityEdgesFromPort(e.sourcePort)),e.targetPort instanceof ui||wa(n,this.AddVisibilityEdgesFromPort(e.targetPort));const r={smoothedPolyline:null};if(e.curve=x.closeDistEps(e.sourcePort.Location,e.targetPort.Location)?Do.RouteSelfEdge(e.sourcePort.Curve,Math.max(2*this.LoosePadding,e.GetMaxArrowheadLength()),r):t.RouteSplineFromPortToPortWhenTheWholeGraphIsReady(e.sourcePort,e.targetPort,!0,r),e.smoothedPolyline=r.smoothedPolyline,null==e.curve)throw new Error;for(const s of n)gn.RemoveEdge(s);_o.trimSplineAndCalculateArrowheadsII(e,e.sourcePort.Curve,e.targetPort.Curve,e.curve,!1)}*AddVisibilityEdgesFromPort(e){let t,n;if(e instanceof Li||!(t=this.portsToShapes.get(e))||!(n=this.shapesToTightLooseCouples.get(t)))return;const r=n.LooseShape;for(const s of r.BoundaryCurve)null==this.visGraph.FindEdgePP(e.Location,s)&&(yield this.visGraph.AddEdgePP(e.Location,s))}MakeTransparentShapesOfEdgeGeometryAndGetTheShapes(e){const t=this.portsToShapes.get(e.sourcePort),n=this.portsToShapes.get(e.targetPort),r=new Array;for(const s of this.GetTransparentShapes(e.sourcePort,e.targetPort,t,n))null!=s&&r.push(this.LooseShapeOfOriginalShape(s));for(const s of this.portsToEnterableShapes.get(e.sourcePort))r.push(this.LooseShapeOfOriginalShape(s));for(const s of this.portsToEnterableShapes.get(e.targetPort))r.push(this.LooseShapeOfOriginalShape(s));return zt.SetTransparency(r,!0),r}LooseShapeOfOriginalShape(e){return e==this.root?this.looseRoot:this.shapesToTightLooseCouples.get(e).LooseShape}LoosePolyOfOriginalShape(e){return this.LooseShapeOfOriginalShape(e).BoundaryCurve}TightPolyOfOriginalShape(e){return e==this.root?null:this.shapesToTightLooseCouples.get(e).TightPolyline}*GetTransparentShapes(e,t,n,r){for(const s of this.ancestorSets.get(n))yield s;for(const s of this.ancestorSets.get(r))yield s;zt.EdgesAttachedToPortAvoidTheNode(e)||(yield n),zt.EdgesAttachedToPortAvoidTheNode(t)||(yield r)}static SetTransparency(e,t){for(const n of e)n.IsTransparent=t}IsAncestor(e,t){let n;return null!=t&&null!=(n=this.ancestorSets.get(t))&&n.has(e)}static CreateLooseObstacleHierarachy(e){return fn(e.map(t=>Gn(t,t.boundingBox)))}CreateTightObstacleHierarachy(e){return fn(e.map(n=>this.shapesToTightLooseCouples.get(n).TightPolyline).map(n=>Gn(n,n.boundingBox)))}CalculateVisibilityGraph(){const e=null!=this.LineSweeperPorts?Rn.mk(this.LineSweeperPorts):new Rn;this.ProcessHookAnyWherePorts(e),this.portRTree=NE(Array.from(e.values()).map(t=>[De.rectangleOnPoint(t),t])),this.visGraph=new gn,this.FillVisibilityGraphUnderShape(this.root)}static ShowVisGraph(e,t,n,r=null,s=null){const o=Array.from(t.Edges).map(a=>ot.mkDebugCurveTWCI(100,1,null!=a.IsPassable&&a.IsPassable()?"green":"black",me.mkPP(a.SourcePoint,a.TargetPoint)));if(null!=n)for(const a of n){o.push(ot.mkDebugCurveTWCI(100,.3,"brown",a));for(const l of a)o.push(ot.mkDebugCurveTWCI(100,1,"green",vi.mkCircle(1,l)))}if(null!=r)for(const a of r)o.push(ot.mkDebugCurveTWCI(100,10,"navy",a));if(null!=s)for(const a of s)o.push(ot.mkDebugCurveTWCI(100,10,"red",a))}ProcessHookAnyWherePorts(e){for(const t of this.edges())t.sourcePort instanceof ui||t.sourcePort instanceof Cr||e.add(t.sourcePort.Location),t.targetPort instanceof ui||t.targetPort instanceof Cr||e.add(t.targetPort.Location)}FillVisibilityGraphUnderShape(e){const t=e.Children;for(const u of t)this.FillVisibilityGraphUnderShape(u);const n=this.shapesToTightLooseCouples.get(e),r=n?n.LooseShape.BoundaryCurve:null,s=n?n.LooseShape:this.looseRoot,o=new Set(s.Children.map(u=>u.BoundaryCurve)),a=this.RemoveInsidePortsAndSplitBoundaryIfNeeded(r);let l=new gn,c=Wu.mk([],l,this.coneAngle,a,r);c.run(),l=new gn,c=Wu.mk(Array.from(o),l,this.coneAngle,a,r),c.run(),this.ProgressStep();for(const u of l.Edges)this.TryToCreateNewEdgeAndSetIsPassable(u,s);this.AddBoundaryEdgesToVisGraph(r)}get Bidirectional(){return this.bidirectional}set Bidirectional(e){this.bidirectional=e}TryToCreateNewEdgeAndSetIsPassable(e,t){let n=this.visGraph.FindEdgePP(e.SourcePoint,e.TargetPoint);null==n&&(n=this.visGraph.AddEdgePP(e.SourcePoint,e.TargetPoint),null!=t&&(n.IsPassable=()=>t.IsTransparent))}AddBoundaryEdgesToVisGraph(e){if(null==e)return;let t;for(let n=e.startPoint;t=n.nextOnPolyline,this.visGraph.AddEdgePP(n.point,t.point),t!=e.startPoint;n=t);}RemoveInsidePortsAndSplitBoundaryIfNeeded(e){const t=new Rn;if(null==e){for(const s of this.portRTree.GetAllLeaves())t.add(s);return this.portRTree.Clear(),t}const r=this.portRTree.GetAllIntersecting(e.boundingBox);for(const s of r)switch(te.PointRelativeToCurveLocation(s,e)){case We.Inside:t.add(s),this.portLocationsToLoosePolylines.set(s,e),this.portRTree.Remove(De.rectangleOnPoint(s),s);break;case We.Boundary:this.portRTree.Remove(De.rectangleOnPoint(s),s),this.portLocationsToLoosePolylines.set(s,e);const o=zt.FindPointOnPolylineToInsertAfter(e,s);if(null==o)throw new Error;Un.InsertPointIntoPolylineAfter(e,o,s)}return t}static FindPointOnPolylineToInsertAfter(e,t){for(let n=e.startPoint;;){const r=n.nextOnPolyline;if(x.closeDistEps(t,n.point)||x.closeDistEps(t,r.point))return null;if(ht(x.distToLineSegment(t,n.point,r.point).dist,0))return n;if(n=r,n==e.startPoint)throw new Error}}GetOrCreateRoot(){if(1==this.rootShapes.length){const e=this.rootShapes[0];if(null==e.BoundaryCurve)return void(this.root=e)}this.rootWasCreated=!0,this.root=new ql(null);for(const e of this.rootShapes)this.root.AddChild(e)}RemoveRoot(){if(this.rootWasCreated)for(const e of this.rootShapes)e.RemoveParent(this.root)}static GetAncestorSetsMap(e){const t=new Map;for(const n of e.filter(r=>!t.has(r)))t.set(n,zt.GetAncestorSet(n,t));return t}static GetAncestorSet(e,t){const n=new Set(e.Parents);for(const r of e.Parents){let s=t.get(r);s||t.set(r,s=zt.GetAncestorSet(r,t));for(const o of s)n.add(o)}return n}static CreatePortsIfNeeded(e){for(const t of e){if(null==t.sourcePort){const n=t;new Fo(()=>n.source.boundaryCurve,()=>n.source.center,new x(0,0))}if(null==t.targetPort){const n=t;new Fo(()=>n.target.boundaryCurve,()=>n.target.center,new x(0,0))}}}static ComputeLooseSplinePadding(e,t){return(e-2*t)/8}}class Fi extends dn{constructor(e,t){super(null),this.edges=e,this.padding=t}run(){zt.CreatePortsIfNeeded(this.edges);for(const e of this.edges)Fi.RouteEdge(e,this.padding)}static RouteEdge(e,t){const n=e;null==n.sourcePort&&(n.sourcePort=Fo.mk(()=>e.source.boundaryCurve,()=>e.source.center)),null==n.targetPort&&(n.targetPort=Fo.mk(()=>e.target.boundaryCurve,()=>e.target.center)),Fi.ContainmentLoop(n,t)||(n.curve=Fi.GetEdgeLine(e)),_o.trimSplineAndCalculateArrowheadsII(n,n.sourcePort.Curve,n.targetPort.Curve,e.curve,!1)}static ContainmentLoop(e,t){const n=e.sourcePort.Curve,r=e.targetPort.Curve;if(null==n||null==r)return!1;const s=n.boundingBox,o=r.boundingBox,a=s.containsRect(o),l=!a&&o.containsRect(s);return!(!a&&!l||(e.curve=Fi.CreateLoop(s,o,l,t),0))}static CreateLoop(e,t,n,r){return n?Fi.CreateLoop_(e,t,r,!1):Fi.CreateLoop_(t,e,r,!0)}static CreateLoop_(e,t,n,r){const s=e.center,o=Fi.FindClosestPointOnBoxBoundary(e.center,t);let a=o.sub(s);const c=(Math.abs(a.x)<q.distanceEpsilon?Math.min(s.y-t.bottom,t.top-s.y):Math.min(s.x-t.left,t.right-s.x))/2,u=Math.min(n,c);a.length<=q.distanceEpsilon&&(a=new x(1,0));const y=a.normalize(),R=y.rotate(Math.PI/2),D=o.add(y.mul(n)),L=D.add(R.mul(u)),k=o.add(R.mul(u)),W=s.add(R.mul(u));return Nn.mkFromPoints(r?[W,k,L,D,o,s]:[s,o,D,L,k,W]).createCurve()}static FindClosestPointOnBoxBoundary(e,t){const n=e.x-t.left<t.right-e.x?t.left:t.right,r=e.y-t.bottom<t.top-e.y?t.bottom:t.top;return Math.abs(n-e.x)<Math.abs(r-e.y)?new x(n,e.y):new x(e.x,r)}static GetEdgeLine(e){let t,n,r,s;null==e.sourcePort?(t=e.source.center,n=e.source.boundaryCurve):(t=e.sourcePort.Location,n=e.sourcePort.Curve),null==e.targetPort?(r=e.target.center,s=e.target.boundaryCurve):(r=e.targetPort.Location,s=e.targetPort.Curve);let o=me.mkPP(t,r),a=te.getAllIntersections(n,o,!1);if(a.length>0){let l=o.trim(a[0].par1,1);l instanceof me&&(o=l,a=te.getAllIntersections(s,o,!1),a.length>0&&(l=o.trim(0,a[0].par1),l instanceof me&&(o=l)))}return o}static CreateSimpleEdgeCurveWithUnderlyingPolyline(e){const t=e.source.center,n=e.target.center;e.source==e.target?(e.underlyingPolyline=Fi.CreateUnderlyingPolylineForSelfEdge(t,2/(3*e.source.boundaryCurve.boundingBox.width),e.source.boundingBox.height/4),e.curve=e.underlyingPolyline.createCurve()):(e.underlyingPolyline=Nn.mkFromPoints([t,n]),e.curve=e.underlyingPolyline.createCurve()),_o.trimSplineAndCalculateArrowheadsII(e,e.source.boundaryCurve,e.target.boundaryCurve,e.curve,!1)}static CreateUnderlyingPolylineForSelfEdge(e,t,n){const r=e.add(new x(0,n)),s=e.add(new x(t,n)),o=e.add(new x(t,-1*n)),a=e.add(new x(0,-1*n));let l=$t.mkSiteP(e);const c=new Nn(l);return l=$t.mkSiteSP(l,r),l=$t.mkSiteSP(l,s),l=$t.mkSiteSP(l,o),l=$t.mkSiteSP(l,a),$t.mkSiteSP(l,e),c}static SetStraightLineEdgesWithUnderlyingPolylines(e){zt.CreatePortsIfNeeded(Array.from(e.edges()));for(const t of e.edges())Fi.CreateSimpleEdgeCurveWithUnderlyingPolyline(t)}}class Yo extends dn{constructor(e,t,n,r,s,o){super(null),this.settings=e,this.OriginalGraph=t,this.Database=n,this.ProperLayeredGraph=s,this.LayerArrays=r,this.IntGraph=o}run(){this.createSplines()}createSplines(){this.createRegularSplines(),this.createSelfSplines(),null!=this.IntGraph&&this.RouteFlatEdges(),null==this.OriginalGraph.graph.parent&&this.RouteUnroutedEdges()}RouteUnroutedEdges(){for(const e of this.OriginalGraph.deepNodes())for(const t of e.outEdges())t.curve||Fi.RouteEdge(t,Math.max(t.source.padding,t.target.padding))}RouteFlatEdges(){}createRegularSplines(){for(const e of this.Database.RegularMultiedges()){const t=e.length,n=1==t&&!this.FanAtSourceOrTarget(e[0]);for(let r=Math.floor(t/2);r<t;r++)this.createSplineForNonSelfEdge(e[r],n);for(let r=Math.floor(t/2)-1;r>=0;r--)this.createSplineForNonSelfEdge(e[r],n)}}FanAtSourceOrTarget(e){return this.ProperLayeredGraph.OutDegreeIsMoreThanOne(e.source)||this.ProperLayeredGraph.InDegreeIsMoreThanOne(e.target)}createSelfSplines(){for(const[e,t]of this.Database.Multiedges.keyValues()){const n=e;if(n.x==n.y){const r=this.Database.Anchors[n.x];let s=r.leftAnchor;for(const o of t){const a=this.settings.NodeSeparation+(this.settings.MinNodeWidth+s),l=r.bottomAnchor/2,c=r.origin,u=c.add(new x(0,l)),y=c.add(new x(a,l)),R=c.add(new x(a,-1*l)),D=c.add(new x(0,-1*l));let L=$t.mkSiteP(c);const k=new Nn(L);L=$t.mkSiteSP(L,u),L=$t.mkSiteSP(L,y),L=$t.mkSiteSP(L,R),L=$t.mkSiteSP(L,D),$t.mkSiteSP(L,c);const W=k.createCurve();if(o.curve=W,o.edge.underlyingPolyline=k,s=a,null!=o.edge.label){s+=o.edge.label.width;const X=o.edge.label.center=new x(W.value((W.parStart+W.parEnd)/2).x+o.labelWidth/2,r.y),ne=new x(o.edge.label.width/2,o.edge.label.height/2),ce=De.mkPP(X.add(ne),X.sub(ne));o.edge.label.boundingBox=ce}_o.trimSplineAndCalculateArrowheadsII(o.edge,o.edge.source.boundaryCurve,o.edge.target.boundaryCurve,W,!1)}}}}createSplineForNonSelfEdge(e,t){null!=e.LayerEdges&&(this.drawSplineBySmothingThePolyline(e,t),e.IsVirtualEdge||(e.updateEdgeLabelPosition(this.Database.Anchors),_o.trimSplineAndCalculateArrowheadsII(e.edge,e.edge.source.boundaryCurve,e.edge.target.boundaryCurve,e.curve,!0)))}drawSplineBySmothingThePolyline(e,t){const n=new li(e,this.Database.Anchors,this.OriginalGraph,this.settings,this.LayerArrays,this.ProperLayeredGraph,this.Database),r=n.getSpline(t);e.reversed?(e.curve=r.reverse(),e.underlyingPolyline=n.Reverse().GetPolyline):(e.curve=r,e.underlyingPolyline=n.GetPolyline)}static UpdateLabel(e,t){let n=null;t.labelIsToTheRightOfTheSpline?(e.label.center=new x(t.x+t.rightAnchor/2,t.y),n=me.mkPP(e.labelBBox.leftTop,e.labelBBox.leftBottom)):t.labelIsToTheLeftOfTheSpline&&(e.label.center=new x(t.x-t.leftAnchor/2,t.y),n=me.mkPP(e.labelBBox.rightTop,e.labelBBox.rightBottom));const r=Yo.GetSegmentInFrontOfLabel(e.curve,e.label.center.y);if(null!=r&&0==te.getAllIntersections(e.curve,te.polyFromBox(e.labelBBox),!1).length){const s={curveClosestPoint:void 0,labelSideClosest:void 0};if(Yo.FindClosestPoints(s,r,n))Yo.ShiftLabel(e,s);else{const o=r.closestParameter(n.start),a=r.closestParameter(n.end);r.value(o).sub(n.start).length<r.value(a).sub(n.end).length?(s.curveClosestPoint=r.value(o),s.labelSideClosest=n.start):(s.curveClosestPoint=r.value(a),s.labelSideClosest=n.end),Yo.ShiftLabel(e,s)}}}static ShiftLabel(e,t){const n=e.lineWidth/2,r=t.curveClosestPoint.sub(t.labelSideClosest),s=r.length;s>n&&(e.label.center=e.label.center.add(r.div(s*(s-n))))}static FindClosestPoints(e,t,n){const r=te.minDistWithinIntervals(t,n,t.parStart,t.parEnd,n.parStart,n.parEnd,(t.parStart+t.parEnd)/2,(n.parStart+n.parEnd)/2);return!!r&&(e.curveClosestPoint=r.aX,e.labelSideClosest=r.bX,!0)}static GetSegmentInFrontOfLabel(e,t){if(e instanceof te){const n=e;for(const r of n.segs)if((r.start.y-t)*(r.end.y-t)<=0)return r}return null}static GetNodeKind(e,t){return 0==e?Yn.Top:e<t.count?Yn.Internal:Yn.Bottom}}function dW(i,e){new dw(i,i.layoutSettings,e).run()}function fW(i,e=null,t=!0){pP(i,i.layoutSettings?i.layoutSettings:new Of),cw(i,e,dW,yP,AI,t)}class dw extends dn{constructor(e,t,n){if(super(n),this.LayersAreDoubled=!1,null==e)return;this.originalGraph=e,this.sugiyamaSettings=t;const r=Array.from(e.shallowNodes());this.nodeIdToIndex=new Map;let s=0;for(const a of r)this.nodeIdToIndex.set(a.id,s++);const o=[];for(const a of this.originalGraph.edges()){const l=this.nodeIdToIndex.get(a.source.id);if(null==l)continue;const c=this.nodeIdToIndex.get(a.target.id);if(null==c)continue;const u=new qr(l,c,a);o.push(u)}this.IntGraph=new ku(o,e.shallowNodeCount),this.IntGraph.nodes=r,this.database=new B3(r.length);for(const a of this.IntGraph.edges)this.database.registerOriginalEdgeInMultiedges(a);this.cycleRemoval()}get verticalConstraints(){return this.sugiyamaSettings.verticalConstraints}get HorizontalConstraints(){return this.sugiyamaSettings.horizontalConstraints}run(){0!=this.originalGraph.shallowNodeCount?(function IW(i,e){if(e.isIdentity())return;const t=e.inverse();for(const n of i.shallowNodes())n.transform(t);for(const n of i.edges())if(null!=n.label){const r=De.mkPP(t.multiplyPoint(new x(0,0)),t.multiplyPoint(new x(n.label.width,n.label.height)));n.label.width=r.width,n.label.height=r.height}}(this.originalGraph,this.sugiyamaSettings.transform),this.engineLayerArrays=this.calculateLayers(),this.sugiyamaSettings.edgeRoutingSettings.EdgeRoutingMode==Cn.SugiyamaSplines&&this.runPostLayering(),function PW(i,e){if(!e.isIdentity()){for(const t of i.shallowNodes())t.transform(e);for(const t of i.edges())if(null!=t.label){const n=De.mkPP(e.multiplyPoint(new x(0,0)),e.multiplyPoint(new x(t.label.width,t.label.height)));t.label.width=n.width,t.label.height=n.height}!function NW(i,e){for(const t of i.edges())null!=t.label&&(t.label.center=e.multiplyPoint(t.label.center)),_W(e,t)}(i,e)}}(this.originalGraph,this.sugiyamaSettings.transform),this.originalGraph.updateBoundingBox(),this.SetMargins()):this.originalGraph.boundingBox=De.mkEmpty()}SetMargins(){this.originalGraph.boundingBox.right+=this.sugiyamaSettings.margins.right,this.originalGraph.boundingBox.top+=this.sugiyamaSettings.margins.bottom,this.originalGraph.boundingBox.left-=this.sugiyamaSettings.margins.left,this.originalGraph.boundingBox.bottom-=this.sugiyamaSettings.margins.bottom}runPostLayering(){const t=null!=this.constrainedOrdering?Cn.Spline:this.sugiyamaSettings.edgeRoutingSettings.EdgeRoutingMode;switch(t){case Cn.SugiyamaSplines:this.calculateEdgeSplines();break;case Cn.StraightLine:case Cn.Spline:case Cn.SplineBundling:throw new Error("not implemented");case Cn.Rectilinear:case Cn.RectilinearToCenter:throw new Error("Not implemented yet");default:throw new Error("Unexpected mode "+t)}}SetLabels(){throw new Error("not implementedt")}cycleRemoval(){const e=this.sugiyamaSettings.verticalConstraints,t=e.isEmpty?xo.getFeedbackSet(this.IntGraph):e.getFeedbackSetExternal(this.IntGraph,this.nodeIdToIndex);this.database.addFeedbackSet(t)}calculateLayers(){this.CreateGluedDagSkeletonForLayering();const e=this.CalculateLayerArrays();return this.UpdateNodePositionData(),e}UpdateNodePositionData(){this.TryToSatisfyMinWidhtAndMinHeight();for(let e=0;e<this.IntGraph.nodeCount&&e<this.database.Anchors.length;e++)this.IntGraph.nodes[e].center=this.database.Anchors[e].origin;if(this.sugiyamaSettings.GridSizeByX>0)for(let e=0;e<this.originalGraph.shallowNodeCount;e++)this.SnapLeftSidesOfTheNodeToGrid(e,this.sugiyamaSettings.GridSizeByX)}SnapLeftSidesOfTheNodeToGrid(e,t){const n=this.IntGraph.nodes[e],r=this.database.Anchors[e];r.leftAnchor-=t/2,r.rightAnchor-=t/2;const s=n.boundingBox.left,a=s-Math.floor(s/t)*t;Math.abs(a)<.001||(n.center=Math.abs(a)<=t/2?n.center.add(new x(-a,0)):n.center.add(new x(t-a,0)),r.x=n.center.x)}TryToSatisfyMinWidhtAndMinHeight(){this.TryToSatisfyMinWidth(),this.TryToSatisfyMinHeight()}TryToSatisfyMinWidth(){0!=this.sugiyamaSettings.MinimalWidth&&this.GetCurrentWidth()<this.sugiyamaSettings.MinimalWidth&&this.StretchWidth()}StretchWidth(){const e=new br;for(const n of this.originalGraph.shallowNodes())e.AddValue(n.boundingBox.width/2),e.AddValue(this.sugiyamaSettings.MinimalWidth-n.boundingBox.width/2);const t=new br;for(const n of this.NodeAnchors())t.AddValue(n.x);if(t.length>q.distanceEpsilon){const n=e.length/t.length;if(n>1)for(const r of this.anchors)r.x*=n}}TryToSatisfyMinHeight(){0!=this.sugiyamaSettings.MinimalHeight&&this.GetCurrentHeight()<this.sugiyamaSettings.MinimalHeight&&this.StretchHeight()}GetCurrentHeight(){const e=new br;for(const t of this.NodeAnchors())e.AddValue(t.top),e.AddValue(t.bottom);return e.length}StretchHeight(){const e=new br;for(const n of this.originalGraph.shallowNodes())e.AddValue(n.boundingBox.height/2),e.AddValue(this.sugiyamaSettings.MinimalHeight-n.boundingBox.height/2);const t=new br;for(const n of this.NodeAnchors())t.AddValue(n.y);if(t.length>q.distanceEpsilon){const n=e.length/t.length;if(n>1)for(const r of this.anchors)r.y*=n}}*NodeAnchors(){const e=Math.min(this.IntGraph.nodeCount,this.anchors.length);for(let t=0;t<e;t++)yield this.anchors[t]}GetCurrentWidth(){const e=new br;for(const t of this.NodeAnchors())e.AddValue(t.left),e.AddValue(t.right);return e.length}ExtendLayeringToUngluedSameLayerVertices(e){const t=this.verticalConstraints;for(let n=0;n<e.length;n++)e[n]=e[t.nodeToRepr(n)];return e}calculateEdgeSplines(){new Yo(this.sugiyamaSettings,this.originalGraph,this.database,this.engineLayerArrays,this.properLayeredGraph,this.IntGraph).run()}YLayeringAndOrdering(e){let t=e.GetLayers();xE.Balance(this.gluedDagSkeletonForLayering,t,this.GetNodeCountsOfGluedDag(),null),t=this.ExtendLayeringToUngluedSameLayerVertices(t);let n=new Zs(t);if(null==this.HorizontalConstraints||this.HorizontalConstraints.IsEmpty)return n=this.YLayeringAndOrderingWithoutHorizontalConstraints(n),n;throw new Error("not implemented")}CreateProperLayeredGraph(e){const t=e.length;let n=0;for(const s of this.database.SkeletonEdges()){const o=EW(e,s);o>0&&(s.LayerEdges=new Array(o));let a=0;if(o>1){let l=t+n++,c=new Lo(s.source,l,s.CrossingWeight,s.weight);s.LayerEdges[a++]=c;for(let u=0;u<o-2;u++)l++,n++,c=new Lo(l-1,l,s.CrossingWeight,s.weight),s.LayerEdges[a++]=c;c=new Lo(l,s.target,s.CrossingWeight,s.weight),s.LayerEdges[a]=c}else if(1==o){const l=new Lo(s.source,s.target,s.CrossingWeight,s.weight);s.LayerEdges[a]=l}}const r=new Array(this.originalGraph.shallowNodeCount+n).fill(0);for(const s of this.database.SkeletonEdges())if(null!=s.LayerEdges){let o=e[s.source];r[s.source]=o--;for(const a of s.LayerEdges)r[a.Target]=o--}else r[s.source]=e[s.source],r[s.target]=e[s.target];return this.properLayeredGraph=new ma(new ku(Array.from(this.database.SkeletonEdges()),e.length)),this.properLayeredGraph.BaseGraph.nodes=this.IntGraph.nodes,new Zs(r)}YLayeringAndOrderingWithoutHorizontalConstraints(e){const t=this.CreateProperLayeredGraph(e.y);return $l.OrderLayers(this.properLayeredGraph,t,this.originalGraph.shallowNodeCount,this.sugiyamaSettings,this.cancelToken),_f.UpdateLayerArrays1(this.properLayeredGraph,t),t}CalculateYLayers(){const e=this.YLayeringAndOrdering(new Q3(this.gluedDagSkeletonForLayering,this.cancelToken));return null!=this.constrainedOrdering?e:this.InsertLayersIfNeeded(e)}InsertLayersIfNeeded(e){this.InsertVirtualEdgesIfNeeded(e);const t=this.AnalyzeNeedToInsertLayersAndHasMultiedges(e);if(t.needToInsertLayers){const n=Vu.InsertLayers(this.properLayeredGraph,e,this.database,this.IntGraph);this.properLayeredGraph=n.layeredGraph,e=n.la,this.LayersAreDoubled=!0}else if(t.multipleEdges){const n=ya.InsertPaths(this.properLayeredGraph,e,this.database,this.IntGraph);this.properLayeredGraph=n.layeredGraph,e=n.la}return this.RecreateIntGraphFromDataBase(),e}RecreateIntGraphFromDataBase(){let e=new Array;for(const t of this.database.Multiedges.values())e=e.concat(t);this.IntGraph.SetEdges(e,this.IntGraph.nodeCount)}InsertVirtualEdgesIfNeeded(e){if(null==this.constrainedOrdering)for(const[t,n]of this.database.Multiedges.keyValues())if(n.length%2==0&&e.y[t.x]-1==e.y[t.y]){const r=new Do(null),s=new qr(t.x,t.y,r);s.IsVirtualEdge=!0,n.splice(n.length/2,0,s),this.IntGraph.addEdge(s)}}AnalyzeNeedToInsertLayersAndHasMultiedges(e){let t=!1,n=!1;for(const r of this.IntGraph.edges)if(r.hasLabel&&e.y[r.source]!=e.y[r.target]){t=!0;break}if(0==t&&null==this.constrainedOrdering)for(const[r,s]of this.database.Multiedges.keyValues())if(s.length>1&&(n=!0,e.y[r.x]-e.y[r.y]==1)){t=!0;break}return{needToInsertLayers:t,multipleEdges:n}}UseBrandesXCalculations(e){return e.x.length>=this.sugiyamaSettings.BrandesThreshold}CalculateAnchorsAndYPositions(e){this.anchors=function pW(i,e,t,n,r){const s=i.Anchors=new Array(e.NodeCount);for(let o=0;o<s.length;o++)s[o]=new qi(r.LabelCornersPreserveCoefficient);for(let o=0;o<t.shallowNodeCount;o++)dw.CalcAnchorsForOriginalNode(o,n,s,i,r);for(const o of i.AllIntEdges())if(null!=o.LayerEdges){for(const a of o.LayerEdges){const l=a.Target;if(l!=o.target){const c=s[l];i.MultipleMiddles.has(l)?(c.leftAnchor=c.rightAnchor=4,c.topAnchor=c.bottomAnchor=bP(r)/2):(c.leftAnchor=c.rightAnchor=.5,c.topAnchor=c.bottomAnchor=bP(r)/2)}}if(o.hasLabel){const l=s[o.LayerEdges[o.LayerEdges.length/2].Source],u=o.labelHeight;l.rightAnchor=o.labelWidth,l.leftAnchor=8,l.topAnchor<u/2&&(l.topAnchor=l.bottomAnchor=u/2),l.labelIsToTheRightOfTheSpline=!0}}return s}(this.database,this.properLayeredGraph,this.originalGraph,this.IntGraph,this.sugiyamaSettings),function mW(i,e,t,n,r,s,o){const a=n.Anchors;let l=t.Margins+e,c=0;for(const u of i.Layers){let y=0,R=0;for(const X of u){const ne=a[X];ne.bottomAnchor>y&&(y=ne.bottomAnchor),ne.topAnchor>R&&(R=ne.topAnchor)}wW(u,y,R,t.shallowNodeCount,n.Anchors);const L=l+y+CP(n,i,c,r,s,l);let k=L+R;if(vW(s)){k+=AP(k,s.GridSizeByY);for(const X of u)a[X].top=k}else if(SW(s)){let X=L-y;X+=AP(X,X);for(const ne of u)a[ne].bottom=X,k=Math.max(a[ne].top,k)}else for(const X of u)a[X].y=L;l=k+s.ActualLayerSeparation(o),c++}CP(n,i,c,r,s,l)}(e,500,this.originalGraph,this.database,this.IntGraph,this.sugiyamaSettings,this.LayersAreDoubled)}OptimizeEdgeLabelsLocations(){for(let e=0;e<this.anchors.length;e++){const t=this.anchors[e];if(t.labelIsToTheRightOfTheSpline){const n=this.GetSuccessorAndPredecessor(e);if(!AW(t,n.predecessor,n.successor)){const r=n.predecessor.origin.sub(t.origin).length+n.successor.origin.sub(t.origin).length,o=new x(t.right-t.leftAnchor,t.y);n.predecessor.origin.sub(o).length+n.successor.origin.sub(o).length<r&&RP(t)}}}}GetSuccessorAndPredecessor(e){let t,n;for(const r of this.properLayeredGraph.InEdges(e))t=r.Source;for(const r of this.properLayeredGraph.OutEdges(e))n=r.Target;return{predecessor:this.anchors[t],successor:this.anchors[n]}}CalculateLayerArrays(){const e=this.CalculateYLayers();return null==this.constrainedOrdering?(this.CalculateAnchorsAndYPositions(e),this.UseBrandesXCalculations(e)?this.CalculateXPositionsByBrandes(e):this.CalculateXLayersByGansnerNorth(e)):this.anchors=this.database.Anchors,this.OptimizeEdgeLabelsLocations(),this.engineLayerArrays=e,this.StraightensShortEdges(),this.CalculateOriginalGraphBox(),e}StretchToDesiredAspectRatio(e,t){e>t?this.StretchInYDirection(e/t):e<t&&this.StretchInXDirection(t/e)}StretchInYDirection(e){const t=(this.originalGraph.boundingBox.top+this.originalGraph.boundingBox.bottom)/2;for(const r of this.database.Anchors)r.bottomAnchor=r.bottomAnchor*e,r.topAnchor=r.topAnchor*e,r.y=t+e*(r.y-t);const n=this.originalGraph.height*e;this.originalGraph.boundingBox=new De({left:this.originalGraph.boundingBox.left,top:t+n/2,right:this.originalGraph.boundingBox.right,bottom:t-n/2})}StretchInXDirection(e){const t=(this.originalGraph.boundingBox.left+this.originalGraph.boundingBox.right)/2;for(const r of this.database.Anchors)r.leftAnchor=r.leftAnchor*e,r.rightAnchor=r.rightAnchor*e,r.x=t+e*(r.x-t);const n=this.originalGraph.width*e;this.originalGraph.boundingBox=new De({left:t-n/2,top:this.originalGraph.boundingBox.top,right:t+n/2,bottom:this.originalGraph.boundingBox.bottom})}CalculateOriginalGraphBox(){if(0==this.anchors.length)return 0;const e=new De({left:this.anchors[0].left,top:this.anchors[0].top,right:this.anchors[0].right,bottom:this.anchors[0].bottom});for(let r=1;r<this.anchors.length;r++){const s=this.anchors[r];e.add(s.leftTop),e.add(s.rightBottom)}const t=e.leftTop.sub(e.rightBottom).length/2,n=new x(-1*t,t);return e.add(e.leftTop.add(n)),e.add(e.rightBottom.sub(n)),this.originalGraph.boundingBox=e,0!=e.height?e.width/e.height:0}StraightensShortEdges(){for(;this.StraightenEdgePaths(););}StraightenEdgePaths(){let e=!1;for(const t of this.database.AllIntEdges())2==t.LayerSpan&&(e=this.ShiftVertexWithNeighbors(t.LayerEdges[0].Source,t.LayerEdges[0].Target,t.LayerEdges[1].Target)||e);return e}ShiftVertexWithNeighbors(e,t,n){const r=this.database.Anchors[e],s=this.database.Anchors[n],o=this.database.Anchors[t],a=(s.x-r.x)/(s.y-r.y)*(o.y-r.y)+r.x,l=1e-4;return a>o.x+l?this.TryShiftToTheRight(a,t):a<o.x-l&&this.TryShiftToTheLeft(a,t)}TryShiftToTheLeft(e,t){const r=this.engineLayerArrays.x[t];if(r>0){const o=Math.max(this.database.Anchors[this.engineLayerArrays.Layers[this.engineLayerArrays.y[t]][r-1]].right+(this.sugiyamaSettings.NodeSeparation+this.database.Anchors[t].leftAnchor),e);return o<this.database.Anchors[t].x-1&&(this.database.Anchors[t].x=o,!0)}return this.database.Anchors[t].x=e,!0}TryShiftToTheRight(e,t){const n=this.engineLayerArrays.Layers[this.engineLayerArrays.y[t]],r=this.engineLayerArrays.x[t];if(r<n.length-1){const o=Math.min(this.database.Anchors[n[r+1]].left-(this.sugiyamaSettings.NodeSeparation-this.database.Anchors[t].rightAnchor),e);return o>this.database.Anchors[t].x+1&&(this.database.Anchors[t].x=o,!0)}return this.database.Anchors[t].x=e,!0}CalculateXLayersByGansnerNorth(e){this.xLayoutGraph=this.CreateXLayoutGraph(e),this.CalculateXLayersByGansnerNorthOnProperLayeredGraph()}CalculateXLayersByGansnerNorthOnProperLayeredGraph(){const e=new FI(this.xLayoutGraph,null).GetLayers();for(let t=0;t<this.database.Anchors.length;t++)this.anchors[t].x=e[t]}CreateXLayoutGraph(e){let t=this.properLayeredGraph.NodeCount;const n=new Array;for(const s of this.properLayeredGraph.Edges){const o=new qr(t,s.Source,null),a=new qr(t,s.Target,null);a.weight=s.Weight,o.weight=s.Weight,o.separation=0,a.separation=0,t++,n.push(o),n.push(a)}for(const s of e.Layers)for(let o=s.length-1;o>0;o--){const a=s[o],l=s[o-1],c=new qr(a,l,null);c.separation=Math.ceil(this.database.Anchors[a].leftAnchor+(this.database.Anchors[l].rightAnchor+this.sugiyamaSettings.NodeSeparation)+.5),n.push(c)}const r=new Z3(this.IntGraph,this.properLayeredGraph,e,n,t);return r.SetEdgeWeights(),r}CalculateXPositionsByBrandes(e){X3.CalculateXCoordinates(e,this.properLayeredGraph,this.originalGraph.shallowNodeCount,this.database.Anchors,this.sugiyamaSettings.NodeSeparation)}GluedDagSkeletonEdges(){const e=new Yl(this.IntGraph.nodeCount);for(const[n,r]of this.database.Multiedges.keyValues()){if(n.isDiagonal())continue;const s=this.verticalConstraints.gluedIntEdge(r[0]);s.source!=s.target&&e.set(s.source,s.target,s)}const t=Array.from(this.verticalConstraints.gluedUpDownIntConstraints.values()).map(n=>function yW(i,e){const t=new qr(i.x,i.y,e);return t.weight=0,t.separation=1,t}(n,null));for(const n of t)e.set(n.source,n.target,n);return Array.from(e.values())}static CalcAnchorsForOriginalNode(e,t,n,r,s){const o={leftAnchor:0,rightAnchor:0,topAnchor:0,bottomAnchor:0};null!=t.nodes&&function RW(i,e,t){i.rightAnchor=i.leftAnchor=(e.width+t.GridSizeByX)/2,i.topAnchor=i.bottomAnchor=e.height/2}(o,t.nodes[e],s),function TW(i,e,t,n){const r=function OW(i,e,t,n){let r=0;const s=i.GetMultiedge(e,e);if(s.length>0){for(const o of s)null!=o.edge.label&&(t.rightAnchor+=o.edge.label.width,t.topAnchor<o.edge.label.height/2&&(t.topAnchor=t.bottomAnchor=o.edge.label.height/2));r+=(n.NodeSeparation+n.MinNodeWidth)*s.length}return r}(t,i,e,n);e.rightAnchor+=r}(e,o,r,s);const a=s.MinNodeWidth/2;o.leftAnchor<a&&(o.leftAnchor=a),o.rightAnchor<a&&(o.rightAnchor=a);const l=s.MinNodeHeight/2;o.topAnchor<l&&(o.topAnchor=l),o.bottomAnchor<l&&(o.bottomAnchor=l),n[e]=qi.mkAnchor(o.leftAnchor,o.rightAnchor,o.topAnchor,o.bottomAnchor,t.nodes[e],s.LabelCornersPreserveCoefficient),n[e].padding=t.nodes[e].padding}CreateGluedDagSkeletonForLayering(){this.gluedDagSkeletonForLayering=new ku(this.GluedDagSkeletonEdges(),this.originalGraph.shallowNodeCount),this.SetGluedEdgesWeights()}SetGluedEdgesWeights(){const e=new Yl(this.IntGraph.nodeCount);for(const t of this.gluedDagSkeletonForLayering.edges)e.set(t.source,t.target,t);for(const[t,n]of this.database.Multiedges.keyValues())if(t.x!=t.y){const r=this.verticalConstraints.gluedIntPair(t);if(r.x==r.y)continue;const s=e.get(r.x,r.y);for(const o of n)s.weight+=o.weight}}GetNodeCountsOfGluedDag(){return this.verticalConstraints.isEmpty?new Array(this.IntGraph.nodeCount).fill(1):this.verticalConstraints.getGluedNodeCounts()}}function AP(i,e){if(0==e)return 0;const n=i-Math.floor(i/e)*e;return Math.abs(n)<1e-4?0:e-n}function bP(i){return 1.5*i.MinNodeHeight/8}function CP(i,e,t,n,r,s){let o=0;if(t>0){const a=function bW(i,e,t){const n=new Qr;for(const r of i)if(!(r>=t.nodeCount))for(const s of t.outEdges[r])e[s.source]==e[s.target]&&n.addNN(s.source,s.target);return Array.from(n.values())}(e.Layers[t-1],e.y,n);if(a.length){const l=r.LayerSeparation/3,c=s;o=Math.max(...a.map(u=>function CW(i,e,t,n){let r=0;const s=n.GetMultiedgeI(i);for(const o of s){r+=t;const a=o.edge.label;null!=a&&(a.center=new x(a.center.x,e+r+a.height/2),r+=a.height)}return r}(u,c,l,i)))}}return o}function EW(i,e){return i[e.source]-i[e.target]}function wW(i,e,t,n,r){if(function gW(i,e){for(const t of i)if(t<e)return!0;return!1}(i,n))for(const s of i)if(s>=n){const o=r[s];o.bottomAnchor=e,o.topAnchor=t}}function vW(i){return i.SnapToGridByY==Wl.Top}function SW(i){return i.SnapToGridByY==Wl.Bottom}function AW(i,e,t){if(i.labelIsToTheRightOfTheSpline){if(x.getTriangleOrientation(e.origin,i.origin,t.origin)==Ie.Clockwise)return!0;const n=i.leftAnchor,r=i.rightAnchor,s=i.x;return RP(i),x.getTriangleOrientation(e.origin,i.origin,t.origin)==Ie.Counterclockwise||(i.x=s,i.leftAnchor=n,i.rightAnchor=r,i.labelIsToTheRightOfTheSpline=!0,i.labelIsToTheLeftOfTheSpline=!1,!1)}return!1}function RP(i){const e=i.right,t=i.leftAnchor;i.leftAnchor=i.rightAnchor,i.rightAnchor=t,i.x=e-i.rightAnchor,i.labelIsToTheLeftOfTheSpline=!0,i.labelIsToTheRightOfTheSpline=!1}function _W(i,e){if(null!=e.curve){e.curve=e.curve.transform(i);const t=e;null!=t.sourceArrowhead&&(t.sourceArrowhead.tipPosition=i.multiplyPoint(t.sourceArrowhead.tipPosition)),null!=t.targetArrowhead&&(t.targetArrowhead.tipPosition=i.multiplyPoint(t.targetArrowhead.tipPosition)),function DW(i,e){if(null!=i.underlyingPolyline)for(let t=i.underlyingPolyline.headSite;null!=t;t=t.next)t.point=e.multiplyPoint(t.point)}(e,i)}}class LW{constructor(e,t,n){this.useMSAGLLayeredLayout=e,this.nodeWidth=t,this.nodeHeight=n,this.cachedGeomGraph=void 0}run(e){var t,n;if(!this.cachedGeomGraph){const s=this.createGeomGraph(e);if(this.useMSAGLLayeredLayout){const o=new Of;o.layerDirection=Ji.LR,o.LayerSeparation=150,o.MinNodeHeight=this.nodeHeight,o.MinNodeWidth=this.nodeWidth,s.layoutSettings=o,fW(s)}else!function zU(i,e){function t(s){s.layoutSettings||(s.layoutSettings=function r(s){return s.shallowNodeCount<200||s.edgeCount<200?new Of:new fP}(s))}t(i),cw(i,e,function n(s,o){if(t(s),s.layoutSettings instanceof Of)new dw(s,s.layoutSettings,o).run();else{if(!(s.layoutSettings instanceof fP))throw Error("not implemented");new gP(s,o,()=>1,s.layoutSettings).run()}},yP,AI)}(s,void 0);this.cachedGeomGraph=s}e.edgeLabels=[];for(const s of this.cachedGeomGraph.shallowNodes()){const o=e.nodes.find(a=>a.id===s.id);if((null===(t=o.position)||void 0===t?void 0:t.x)===s.center.x&&(null===(n=o.position)||void 0===n?void 0:n.y)===s.center.y)break;o.position={x:s.center.x,y:s.center.y},o.dimension={width:o.dimension.width,height:o.dimension.height}}const r=Array.from(this.cachedGeomGraph.edges());for(const s of e.edges)this.updateGraphEdge(e,s,r);return e}updateEdge(e,t){return e}setNode(e,t,n,r,s=new x(0,0)){let o=e.graph.findNode(t);null==o&&e.graph.addNode(o=new mI(t));const a=new TE(o);return a.boundaryCurve=vi.mkCircle(10,new x(10,10)),a}createGeomGraph(e){const t=Jr.mk("graph",new Mu(0,0));return e.nodes.forEach(n=>{this.setNode(t,n.id,n.dimension.width,n.dimension.height)}),e.edges.forEach(n=>{t.setEdge(n.source,n.target)}),t}updateGraphEdge(e,t,n){var r;if(!t.points||0===t.points.length){const s=n.find(o=>o.source.id===t.source&&o.target.id===t.target);t.points=this.getPointsFromGeoEdge(s)}if((null===(r=t.points)||void 0===r?void 0:r.length)>0){const s=`${t.source}\x01${t.target}\x01\0`,o=e.edgeLabels[s];o?o.points=t.points:e.edgeLabels[s]={points:t.points}}return e}getPointsFromGeoEdge(e){const t=[],n=function C3(i,e){return RE(i.parStart,i.start,i.parEnd,i.end,i,e)}(e.curve,e.curve.end.sub(e.curve.start).length/20);for(let r=0;r<n.length;r++)t.push({y:n[r].y,x:n[r].x});return t.push({y:e.targetArrowhead.tipPosition.y,x:e.targetArrowhead.tipPosition.x}),t}}function OP(i,e,t){i._context.bezierCurveTo((2*i._x0+i._x1)/3,(2*i._y0+i._y1)/3,(i._x0+2*i._x1)/3,(i._y0+2*i._y1)/3,(i._x0+4*i._x1+e)/6,(i._y0+4*i._y1+t)/6)}function Xf(i){this._context=i}function MW(i){return new Xf(i)}Xf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:OP(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,e){switch(i=+i,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,e):this._context.moveTo(i,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:OP(this,i,e)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=e}};var IP=h(655);class PP{}const so="*";function NP(i,e){return{type:7,name:i,definitions:e,options:{}}}function gw(i,e=null){return{type:4,styles:e,timings:i}}function _P(i,e=null){return{type:2,steps:i,options:e}}function oc(i){return{type:6,styles:i,offset:null}}function DP(i,e,t){return{type:0,name:i,styles:e,options:t}}function pw(i,e,t=null){return{type:1,expr:i,animation:e,options:t}}function xP(i){Promise.resolve(null).then(i)}class oh{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){xP(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class LP{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const s=this.players.length;0==s?xP(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(r)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function BW(){}function yw(i){return null==i?BW:function(){return this.querySelector(i)}}function VW(){return[]}function MP(i){return null==i?VW:function(){return this.querySelectorAll(i)}}function FP(i){return function(){return this.matches(i)}}function BP(i){return new Array(i.length)}function Zf(i,e){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=e}function WW(i,e,t,n,r,s){for(var a,o=0,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],n[o]=a):t[o]=new Zf(i,s[o]);for(;o<l;++o)(a=e[o])&&(r[o]=a)}function jW(i,e,t,n,r,s,o){var a,l,D,c={},u=e.length,y=s.length,R=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(R[a]=D="$"+o.call(l,l.__data__,a,e),D in c?r[a]=l:c[D]=l);for(a=0;a<y;++a)(l=c[D="$"+o.call(i,s[a],a,s)])?(n[a]=l,l.__data__=s[a],c[D]=null):t[a]=new Zf(i,s[a]);for(a=0;a<u;++a)(l=e[a])&&c[R[a]]===l&&(r[a]=l)}function XW(i,e){return i<e?-1:i>e?1:i>=e?0:NaN}Zf.prototype={constructor:Zf,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,e){return this._parent.insertBefore(i,e)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};var Ew="http://www.w3.org/1999/xhtml";const VP={svg:"http://www.w3.org/2000/svg",xhtml:Ew,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function eg(i){var e=i+="",t=e.indexOf(":");return t>=0&&"xmlns"!==(e=i.slice(0,t))&&(i=i.slice(t+1)),VP.hasOwnProperty(e)?{space:VP[e],local:i}:i}function s4(i){return function(){this.removeAttribute(i)}}function o4(i){return function(){this.removeAttributeNS(i.space,i.local)}}function a4(i,e){return function(){this.setAttribute(i,e)}}function l4(i,e){return function(){this.setAttributeNS(i.space,i.local,e)}}function c4(i,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttribute(i):this.setAttribute(i,t)}}function u4(i,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,t)}}function GP(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function d4(i){return function(){this.style.removeProperty(i)}}function f4(i,e,t){return function(){this.style.setProperty(i,e,t)}}function g4(i,e,t){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(i):this.style.setProperty(i,n,t)}}function ac(i,e){return i.style.getPropertyValue(e)||GP(i).getComputedStyle(i,null).getPropertyValue(e)}function m4(i){return function(){delete this[i]}}function y4(i,e){return function(){this[i]=e}}function E4(i,e){return function(){var t=e.apply(this,arguments);null==t?delete this[i]:this[i]=t}}function HP(i){return i.trim().split(/^|\s+/)}function ww(i){return i.classList||new YP(i)}function YP(i){this._node=i,this._names=HP(i.getAttribute("class")||"")}function UP(i,e){for(var t=ww(i),n=-1,r=e.length;++n<r;)t.add(e[n])}function WP(i,e){for(var t=ww(i),n=-1,r=e.length;++n<r;)t.remove(e[n])}function v4(i){return function(){UP(this,i)}}function S4(i){return function(){WP(this,i)}}function A4(i,e){return function(){(e.apply(this,arguments)?UP:WP)(this,i)}}function C4(){this.textContent=""}function R4(i){return function(){this.textContent=i}}function T4(i){return function(){var e=i.apply(this,arguments);this.textContent=null==e?"":e}}function I4(){this.innerHTML=""}function P4(i){return function(){this.innerHTML=i}}function N4(i){return function(){var e=i.apply(this,arguments);this.innerHTML=null==e?"":e}}function D4(){this.nextSibling&&this.parentNode.appendChild(this)}function L4(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function F4(i){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===Ew&&e.documentElement.namespaceURI===Ew?e.createElement(i):e.createElementNS(t,i)}}function B4(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function jP(i){var e=eg(i);return(e.local?B4:F4)(e)}function V4(){return null}function H4(){var i=this.parentNode;i&&i.removeChild(this)}function U4(){var i=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function W4(){var i=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}YP.prototype={add:function(i){this._names.indexOf(i)<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var e=this._names.indexOf(i);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};var zP={},Oa=null;function $4(i,e,t){return i=KP(i,e,t),function(n){var r=n.relatedTarget;(!r||r!==this&&!(8&r.compareDocumentPosition(this)))&&i.call(this,n)}}function KP(i,e,t){return function(n){var r=Oa;Oa=n;try{i.call(this,this.__data__,e,t)}finally{Oa=r}}}function J4(i){return i.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function q4(i){return function(){var e=this.__on;if(e){for(var s,t=0,n=-1,r=e.length;t<r;++t)s=e[t],i.type&&s.type!==i.type||s.name!==i.name?e[++n]=s:this.removeEventListener(s.type,s.listener,s.capture);++n?e.length=n:delete this.__on}}}function Q4(i,e,t){var n=zP.hasOwnProperty(i.type)?$4:KP;return function(r,s,o){var l,a=this.__on,c=n(e,s,o);if(a)for(var u=0,y=a.length;u<y;++u)if((l=a[u]).type===i.type&&l.name===i.name)return this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=c,l.capture=t),void(l.value=e);this.addEventListener(i.type,c,t),l={type:i.type,name:i.name,value:e,listener:c,capture:t},a?a.push(l):this.__on=[l]}}function $P(i,e,t){var n=GP(i),r=n.CustomEvent;"function"==typeof r?r=new r(e,t):(r=n.document.createEvent("Event"),t?(r.initEvent(e,t.bubbles,t.cancelable),r.detail=t.detail):r.initEvent(e,!1,!1)),i.dispatchEvent(r)}function Z4(i,e){return function(){return $P(this,i,e)}}function e5(i,e){return function(){return $P(this,i,e.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(zP={mouseenter:"mouseover",mouseleave:"mouseout"}));var JP=[null];function sr(i,e){this._groups=i,this._parents=e}function qP(){return new sr([[document.documentElement]],JP)}sr.prototype=qP.prototype={constructor:sr,select:function kW(i){"function"!=typeof i&&(i=yw(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var l,c,s=e[r],o=s.length,a=n[r]=new Array(o),u=0;u<o;++u)(l=s[u])&&(c=i.call(l,l.__data__,u,s))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new sr(n,this._parents)},selectAll:function GW(i){"function"!=typeof i&&(i=MP(i));for(var e=this._groups,t=e.length,n=[],r=[],s=0;s<t;++s)for(var l,o=e[s],a=o.length,c=0;c<a;++c)(l=o[c])&&(n.push(i.call(l,l.__data__,c,o)),r.push(l));return new sr(n,r)},filter:function HW(i){"function"!=typeof i&&(i=FP(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var l,s=e[r],o=s.length,a=n[r]=[],c=0;c<o;++c)(l=s[c])&&i.call(l,l.__data__,c,s)&&a.push(l);return new sr(n,this._parents)},data:function zW(i,e){if(!i)return D=new Array(this.size()),c=-1,this.each(function(Be){D[++c]=Be}),D;var t=e?jW:WW,n=this._parents,r=this._groups;"function"!=typeof i&&(i=function UW(i){return function(){return i}}(i));for(var s=r.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var u=n[c],y=r[c],R=y.length,D=i.call(u,u&&u.__data__,c,n),L=D.length,k=a[c]=new Array(L),W=o[c]=new Array(L);t(u,y,k,W,l[c]=new Array(R),D,e);for(var Ae,Oe,ne=0,ce=0;ne<L;++ne)if(Ae=k[ne]){for(ne>=ce&&(ce=ne+1);!(Oe=W[ce])&&++ce<L;);Ae._next=Oe||null}}return(o=new sr(o,n))._enter=a,o._exit=l,o},enter:function YW(){return new sr(this._enter||this._groups.map(BP),this._parents)},exit:function KW(){return new sr(this._exit||this._groups.map(BP),this._parents)},join:function $W(i,e,t){var n=this.enter(),r=this,s=this.exit();return n="function"==typeof i?i(n):n.append(i+""),null!=e&&(r=e(r)),null==t?s.remove():t(s),n&&r?n.merge(r).order():r},merge:function JW(i){for(var e=this._groups,t=i._groups,n=e.length,s=Math.min(n,t.length),o=new Array(n),a=0;a<s;++a)for(var R,l=e[a],c=t[a],u=l.length,y=o[a]=new Array(u),D=0;D<u;++D)(R=l[D]||c[D])&&(y[D]=R);for(;a<n;++a)o[a]=e[a];return new sr(o,this._parents)},order:function qW(){for(var i=this._groups,e=-1,t=i.length;++e<t;)for(var o,n=i[e],r=n.length-1,s=n[r];--r>=0;)(o=n[r])&&(s&&4^o.compareDocumentPosition(s)&&s.parentNode.insertBefore(o,s),s=o);return this},sort:function QW(i){function e(y,R){return y&&R?i(y.__data__,R.__data__):!y-!R}i||(i=XW);for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s){for(var c,o=t[s],a=o.length,l=r[s]=new Array(a),u=0;u<a;++u)(c=o[u])&&(l[u]=c);l.sort(e)}return new sr(r,this._parents).order()},call:function ZW(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this},nodes:function e4(){var i=new Array(this.size()),e=-1;return this.each(function(){i[++e]=this}),i},node:function t4(){for(var i=this._groups,e=0,t=i.length;e<t;++e)for(var n=i[e],r=0,s=n.length;r<s;++r){var o=n[r];if(o)return o}return null},size:function n4(){var i=0;return this.each(function(){++i}),i},empty:function i4(){return!this.node()},each:function r4(i){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a,r=e[t],s=0,o=r.length;s<o;++s)(a=r[s])&&i.call(a,a.__data__,s,r);return this},attr:function h4(i,e){var t=eg(i);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((null==e?t.local?o4:s4:"function"==typeof e?t.local?u4:c4:t.local?l4:a4)(t,e))},style:function p4(i,e,t){return arguments.length>1?this.each((null==e?d4:"function"==typeof e?g4:f4)(i,e,null==t?"":t)):ac(this.node(),i)},property:function w4(i,e){return arguments.length>1?this.each((null==e?m4:"function"==typeof e?E4:y4)(i,e)):this.node()[i]},classed:function b4(i,e){var t=HP(i+"");if(arguments.length<2){for(var n=ww(this.node()),r=-1,s=t.length;++r<s;)if(!n.contains(t[r]))return!1;return!0}return this.each(("function"==typeof e?A4:e?v4:S4)(t,e))},text:function O4(i){return arguments.length?this.each(null==i?C4:("function"==typeof i?T4:R4)(i)):this.node().textContent},html:function _4(i){return arguments.length?this.each(null==i?I4:("function"==typeof i?N4:P4)(i)):this.node().innerHTML},raise:function x4(){return this.each(D4)},lower:function M4(){return this.each(L4)},append:function k4(i){var e="function"==typeof i?i:jP(i);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function G4(i,e){var t="function"==typeof i?i:jP(i),n=null==e?V4:"function"==typeof e?e:yw(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function Y4(){return this.each(H4)},clone:function j4(i){return this.select(i?W4:U4)},datum:function z4(i){return arguments.length?this.property("__data__",i):this.node().__data__},on:function X4(i,e,t){var r,o,n=J4(i+""),s=n.length;if(!(arguments.length<2)){for(a=e?Q4:q4,null==t&&(t=!1),r=0;r<s;++r)this.each(a(n[r],e,t));return this}var a=this.node().__on;if(a)for(var u,l=0,c=a.length;l<c;++l)for(r=0,u=a[l];r<s;++r)if((o=n[r]).type===u.type&&o.name===u.name)return u.value},dispatch:function t5(i,e){return this.each(("function"==typeof e?e5:Z4)(i,e))}};const ah=qP;function QP(i){return"string"==typeof i?new sr([[document.querySelector(i)]],[document.documentElement]):new sr([[i]],JP)}function XP(i,e){this._basis=new Xf(i),this._beta=e}XP.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var i=this._x,e=this._y,t=i.length-1;if(t>0)for(var l,n=i[0],r=e[0],s=i[t]-n,o=e[t]-r,a=-1;++a<=t;)this._basis.point(this._beta*i[a]+(1-this._beta)*(n+(l=a/t)*s),this._beta*e[a]+(1-this._beta)*(r+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(i,e){this._x.push(+i),this._y.push(+e)}};const n5=function i(e){function t(n){return 1===e?new Xf(n):new XP(n,e)}return t.beta=function(n){return i(+n)},t}(.85);var vw=Math.PI,Sw=2*vw,Ia=1e-6,i5=Sw-Ia;function Aw(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ZP(){return new Aw}Aw.prototype=ZP.prototype={constructor:Aw,moveTo:function(i,e){this._+="M"+(this._x0=this._x1=+i)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(i,e){this._+="L"+(this._x1=+i)+","+(this._y1=+e)},quadraticCurveTo:function(i,e,t,n){this._+="Q"+ +i+","+ +e+","+(this._x1=+t)+","+(this._y1=+n)},bezierCurveTo:function(i,e,t,n,r,s){this._+="C"+ +i+","+ +e+","+ +t+","+ +n+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(i,e,t,n,r){var s=this._x1,o=this._y1,a=(t=+t)-(i=+i),l=(n=+n)-(e=+e),c=s-i,u=o-e,y=c*c+u*u;if((r=+r)<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=i)+","+(this._y1=e);else if(y>Ia)if(Math.abs(u*a-l*c)>Ia&&r){var R=t-s,D=n-o,L=a*a+l*l,k=R*R+D*D,W=Math.sqrt(L),X=Math.sqrt(y),ne=r*Math.tan((vw-Math.acos((L+y-k)/(2*W*X)))/2),ce=ne/X,Ae=ne/W;Math.abs(ce-1)>Ia&&(this._+="L"+(i+ce*c)+","+(e+ce*u)),this._+="A"+r+","+r+",0,0,"+ +(u*R>c*D)+","+(this._x1=i+Ae*a)+","+(this._y1=e+Ae*l)}else this._+="L"+(this._x1=i)+","+(this._y1=e)},arc:function(i,e,t,n,r,s){i=+i,e=+e,s=!!s;var o=(t=+t)*Math.cos(n),a=t*Math.sin(n),l=i+o,c=e+a,u=1^s,y=s?n-r:r-n;if(t<0)throw new Error("negative radius: "+t);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>Ia||Math.abs(this._y1-c)>Ia)&&(this._+="L"+l+","+c),t&&(y<0&&(y=y%Sw+Sw),y>i5?this._+="A"+t+","+t+",0,1,"+u+","+(i-o)+","+(e-a)+"A"+t+","+t+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):y>Ia&&(this._+="A"+t+","+t+",0,"+ +(y>=vw)+","+u+","+(this._x1=i+t*Math.cos(r))+","+(this._y1=e+t*Math.sin(r))))},rect:function(i,e,t,n){this._+="M"+(this._x0=this._x1=+i)+","+(this._y0=this._y1=+e)+"h"+ +t+"v"+ +n+"h"+-t+"Z"},toString:function(){return this._}};const r5=ZP;function tg(i){return function(){return i}}function e0(i){this._context=i}function s5(i){return new e0(i)}function o5(i){return i[0]}function a5(i){return i[1]}e0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,e){switch(i=+i,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,e):this._context.moveTo(i,e);break;case 1:this._point=2;default:this._context.lineTo(i,e)}}};var t0=Math.PI;function r0(i){return(1-Math.cos(t0*i))/2}var c5={value:function(){}};function s0(){for(var n,i=0,e=arguments.length,t={};i<e;++i){if(!(n=arguments[i]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new ng(t)}function ng(i){this._=i}function u5(i,e){return i.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}function h5(i,e){for(var r,t=0,n=i.length;t<n;++t)if((r=i[t]).name===e)return r.value}function o0(i,e,t){for(var n=0,r=i.length;n<r;++n)if(i[n].name===e){i[n]=c5,i=i.slice(0,n).concat(i.slice(n+1));break}return null!=t&&i.push({name:e,value:t}),i}ng.prototype=s0.prototype={constructor:ng,on:function(i,e){var r,t=this._,n=u5(i+"",t),s=-1,o=n.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(r=(i=n[s]).type)t[r]=o0(t[r],i.name,e);else if(null==e)for(r in t)t[r]=o0(t[r],i.name,null);return this}for(;++s<o;)if((r=(i=n[s]).type)&&(r=h5(t[r],i.name)))return r},copy:function(){var i={},e=this._;for(var t in e)i[t]=e[t].slice();return new ng(i)},call:function(i,e){if((r=arguments.length-2)>0)for(var r,s,t=new Array(r),n=0;n<r;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(n=0,r=(s=this._[i]).length;n<r;++n)s[n].value.apply(e,t)},apply:function(i,e,t){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var n=this._[i],r=0,s=n.length;r<s;++r)n[r].value.apply(e,t)}};const bw=s0;var ig,uh,lc=0,lh=0,ch=0,rg=0,Pa=0,sg=0,hh="object"==typeof performance&&performance.now?performance:Date,l0="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function cc(){return Pa||(l0(d5),Pa=hh.now()+sg)}function d5(){Pa=0}function dh(){this._call=this._time=this._next=null}function og(i,e,t){var n=new dh;return n.restart(i,e,t),n}function c0(){cc(),++lc;for(var e,i=ig;i;)(e=Pa-i._time)>=0&&i._call.call(null,e),i=i._next;--lc}function u0(){Pa=(rg=hh.now())+sg,lc=lh=0;try{c0()}finally{lc=0,function g5(){for(var i,t,e=ig,n=1/0;e;)e._call?(n>e._time&&(n=e._time),i=e,e=e._next):(t=e._next,e._next=null,e=i?i._next=t:ig=t);uh=i,Cw(n)}(),Pa=0}}function f5(){var i=hh.now(),e=i-rg;e>1e3&&(sg-=e,rg=i)}function Cw(i){lc||(lh&&(lh=clearTimeout(lh)),i-Pa>24?(i<1/0&&(lh=setTimeout(u0,i-hh.now()-sg)),ch&&(ch=clearInterval(ch))):(ch||(rg=hh.now(),ch=setInterval(f5,1e3)),lc=1,l0(u0)))}function Rw(i,e,t){var n=new dh;return n.restart(function(r){n.stop(),i(r+e)},e=null==e?0:+e,t),n}dh.prototype=og.prototype={constructor:dh,restart:function(i,e,t){if("function"!=typeof i)throw new TypeError("callback is not a function");t=(null==t?cc():+t)+(null==e?0:+e),!this._next&&uh!==this&&(uh?uh._next=this:ig=this,uh=this),this._call=i,this._time=t,Cw()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cw())}};var p5=bw("start","end","cancel","interrupt"),m5=[];function cg(i,e,t,n,r,s){var o=i.__transition;if(o){if(t in o)return}else i.__transition={};!function y5(i,e,t){var r,n=i.__transition;function o(c){var u,y,R,D;if(1!==t.state)return l();for(u in n)if((D=n[u]).name===t.name){if(3===D.state)return Rw(o);4===D.state?(D.state=6,D.timer.stop(),D.on.call("interrupt",i,i.__data__,D.index,D.group),delete n[u]):+u<e&&(D.state=6,D.timer.stop(),D.on.call("cancel",i,i.__data__,D.index,D.group),delete n[u])}if(Rw(function(){3===t.state&&(t.state=4,t.timer.restart(a,t.delay,t.time),a(c))}),t.state=2,t.on.call("start",i,i.__data__,t.index,t.group),2===t.state){for(t.state=3,r=new Array(R=t.tween.length),u=0,y=-1;u<R;++u)(D=t.tween[u].value.call(i,i.__data__,t.index,t.group))&&(r[++y]=D);r.length=y+1}}function a(c){for(var u=c<t.duration?t.ease.call(null,c/t.duration):(t.timer.restart(l),t.state=5,1),y=-1,R=r.length;++y<R;)r[y].call(i,u);5===t.state&&(t.on.call("end",i,i.__data__,t.index,t.group),l())}function l(){for(var c in t.state=6,t.timer.stop(),delete n[e],n)return;delete i.__transition}n[e]=t,t.timer=og(function s(c){t.state=1,t.timer.restart(o,t.delay,t.time),t.delay<=c&&o(c-t.delay)},0,t.time)}(i,t,{name:e,index:n,group:r,on:p5,tween:m5,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function Iw(i,e){var t=ns(i,e);if(t.state>0)throw new Error("too late; already scheduled");return t}function oo(i,e){var t=ns(i,e);if(t.state>3)throw new Error("too late; already running");return t}function ns(i,e){var t=i.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function Uo(i,e){return i=+i,e=+e,function(t){return i*(1-t)+e*t}}var fh,Nw,m0,ug,g0=180/Math.PI,Pw={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function p0(i,e,t,n,r,s){var o,a,l;return(o=Math.sqrt(i*i+e*e))&&(i/=o,e/=o),(l=i*t+e*n)&&(t-=i*l,n-=e*l),(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a,l/=a),i*n<e*t&&(i=-i,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,i)*g0,skewX:Math.atan(l)*g0,scaleX:o,scaleY:a}}function y0(i,e,t,n){function r(c){return c.length?c.pop()+" ":""}return function(c,u){var y=[],R=[];return c=i(c),u=i(u),function s(c,u,y,R,D,L){if(c!==y||u!==R){var k=D.push("translate(",null,e,null,t);L.push({i:k-4,x:Uo(c,y)},{i:k-2,x:Uo(u,R)})}else(y||R)&&D.push("translate("+y+e+R+t)}(c.translateX,c.translateY,u.translateX,u.translateY,y,R),function o(c,u,y,R){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),R.push({i:y.push(r(y)+"rotate(",null,n)-2,x:Uo(c,u)})):u&&y.push(r(y)+"rotate("+u+n)}(c.rotate,u.rotate,y,R),function a(c,u,y,R){c!==u?R.push({i:y.push(r(y)+"skewX(",null,n)-2,x:Uo(c,u)}):u&&y.push(r(y)+"skewX("+u+n)}(c.skewX,u.skewX,y,R),function l(c,u,y,R,D,L){if(c!==y||u!==R){var k=D.push(r(D)+"scale(",null,",",null,")");L.push({i:k-4,x:Uo(c,y)},{i:k-2,x:Uo(u,R)})}else(1!==y||1!==R)&&D.push(r(D)+"scale("+y+","+R+")")}(c.scaleX,c.scaleY,u.scaleX,u.scaleY,y,R),c=u=null,function(D){for(var W,L=-1,k=R.length;++L<k;)y[(W=R[L]).i]=W.x(D);return y.join("")}}}var A5=y0(function v5(i){return"none"===i?Pw:(fh||(fh=document.createElement("DIV"),Nw=document.documentElement,m0=document.defaultView),fh.style.transform=i,i=m0.getComputedStyle(Nw.appendChild(fh),null).getPropertyValue("transform"),Nw.removeChild(fh),p0(+(i=i.slice(7,-1).split(","))[0],+i[1],+i[2],+i[3],+i[4],+i[5]))},"px, ","px)","deg)"),b5=y0(function S5(i){return null!=i&&(ug||(ug=document.createElementNS("http://www.w3.org/2000/svg","g")),ug.setAttribute("transform",i),i=ug.transform.baseVal.consolidate())?p0((i=i.matrix).a,i.b,i.c,i.d,i.e,i.f):Pw},", ",")",")");function C5(i,e){var t,n;return function(){var r=oo(this,i),s=r.tween;if(s!==t)for(var o=0,a=(n=t=s).length;o<a;++o)if(n[o].name===e){(n=n.slice()).splice(o,1);break}r.tween=n}}function R5(i,e,t){var n,r;if("function"!=typeof t)throw new Error;return function(){var s=oo(this,i),o=s.tween;if(o!==n){r=(n=o).slice();for(var a={name:e,value:t},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}s.tween=r}}function _w(i,e,t){var n=i._id;return i.each(function(){var r=oo(this,n);(r.value||(r.value={}))[e]=t.apply(this,arguments)}),function(r){return ns(r,n).value[e]}}function Dw(i,e,t){i.prototype=e.prototype=t,t.constructor=i}function E0(i,e){var t=Object.create(i.prototype);for(var n in e)t[n]=e[n];return t}function gh(){}var hg=1/.7,uc="\\s*([+-]?\\d+)\\s*",mh="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Is="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",O5=/^#([0-9a-f]{3,8})$/,I5=new RegExp("^rgb\\("+[uc,uc,uc]+"\\)$"),P5=new RegExp("^rgb\\("+[Is,Is,Is]+"\\)$"),N5=new RegExp("^rgba\\("+[uc,uc,uc,mh]+"\\)$"),_5=new RegExp("^rgba\\("+[Is,Is,Is,mh]+"\\)$"),D5=new RegExp("^hsl\\("+[mh,Is,Is]+"\\)$"),x5=new RegExp("^hsla\\("+[mh,Is,Is,mh]+"\\)$"),w0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function v0(){return this.rgb().formatHex()}function S0(){return this.rgb().formatRgb()}function yh(i){var e,t;return i=(i+"").trim().toLowerCase(),(e=O5.exec(i))?(t=e[1].length,e=parseInt(e[1],16),6===t?A0(e):3===t?new or(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===t?dg(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===t?dg(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=I5.exec(i))?new or(e[1],e[2],e[3],1):(e=P5.exec(i))?new or(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=N5.exec(i))?dg(e[1],e[2],e[3],e[4]):(e=_5.exec(i))?dg(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=D5.exec(i))?R0(e[1],e[2]/100,e[3]/100,1):(e=x5.exec(i))?R0(e[1],e[2]/100,e[3]/100,e[4]):w0.hasOwnProperty(i)?A0(w0[i]):"transparent"===i?new or(NaN,NaN,NaN,0):null}function A0(i){return new or(i>>16&255,i>>8&255,255&i,1)}function dg(i,e,t,n){return n<=0&&(i=e=t=NaN),new or(i,e,t,n)}function M5(i){return i instanceof gh||(i=yh(i)),i?new or((i=i.rgb()).r,i.g,i.b,i.opacity):new or}function fg(i,e,t,n){return 1===arguments.length?M5(i):new or(i,e,t,null==n?1:n)}function or(i,e,t,n){this.r=+i,this.g=+e,this.b=+t,this.opacity=+n}function b0(){return"#"+xw(this.r)+xw(this.g)+xw(this.b)}function C0(){var i=this.opacity;return(1===(i=isNaN(i)?1:Math.max(0,Math.min(1,i)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===i?")":", "+i+")")}function xw(i){return((i=Math.max(0,Math.min(255,Math.round(i)||0)))<16?"0":"")+i.toString(16)}function R0(i,e,t,n){return n<=0?i=e=t=NaN:t<=0||t>=1?i=e=NaN:e<=0&&(i=NaN),new Ps(i,e,t,n)}function T0(i){if(i instanceof Ps)return new Ps(i.h,i.s,i.l,i.opacity);if(i instanceof gh||(i=yh(i)),!i)return new Ps;if(i instanceof Ps)return i;var e=(i=i.rgb()).r/255,t=i.g/255,n=i.b/255,r=Math.min(e,t,n),s=Math.max(e,t,n),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(t-n)/a+6*(t<n):t===s?(n-e)/a+2:(e-t)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new Ps(o,a,l,i.opacity)}function Ps(i,e,t,n){this.h=+i,this.s=+e,this.l=+t,this.opacity=+n}function Lw(i,e,t){return 255*(i<60?e+(t-e)*i/60:i<180?t:i<240?e+(t-e)*(240-i)/60:e)}function O0(i,e,t,n,r){var s=i*i,o=s*i;return((1-3*i+3*s-o)*e+(4-6*s+3*o)*t+(1+3*i+3*s-3*o)*n+o*r)/6}function I0(i){return function(){return i}}function N0(i,e){var t=e-i;return t?function P0(i,e){return function(t){return i+t*e}}(i,t):I0(isNaN(i)?e:i)}Dw(gh,yh,{copy:function(i){return Object.assign(new this.constructor,this,i)},displayable:function(){return this.rgb().displayable()},hex:v0,formatHex:v0,formatHsl:function L5(){return T0(this).formatHsl()},formatRgb:S0,toString:S0}),Dw(or,fg,E0(gh,{brighter:function(i){return i=null==i?hg:Math.pow(hg,i),new or(this.r*i,this.g*i,this.b*i,this.opacity)},darker:function(i){return i=null==i?.7:Math.pow(.7,i),new or(this.r*i,this.g*i,this.b*i,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:b0,formatHex:b0,formatRgb:C0,toString:C0})),Dw(Ps,function F5(i,e,t,n){return 1===arguments.length?T0(i):new Ps(i,e,t,null==n?1:n)},E0(gh,{brighter:function(i){return i=null==i?hg:Math.pow(hg,i),new Ps(this.h,this.s,this.l*i,this.opacity)},darker:function(i){return i=null==i?.7:Math.pow(.7,i),new Ps(this.h,this.s,this.l*i,this.opacity)},rgb:function(){var i=this.h%360+360*(this.h<0),e=isNaN(i)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,r=2*t-n;return new or(Lw(i>=240?i-240:i+120,r,n),Lw(i,r,n),Lw(i<120?i+240:i-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var i=this.opacity;return(1===(i=isNaN(i)?1:Math.max(0,Math.min(1,i)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===i?")":", "+i+")")}}));const _0=function i(e){var t=function G5(i){return 1==(i=+i)?N0:function(e,t){return t-e?function V5(i,e,t){return i=Math.pow(i,t),e=Math.pow(e,t)-i,t=1/t,function(n){return Math.pow(i+n*e,t)}}(e,t,i):I0(isNaN(e)?t:e)}}(e);function n(r,s){var o=t((r=fg(r)).r,(s=fg(s)).r),a=t(r.g,s.g),l=t(r.b,s.b),c=N0(r.opacity,s.opacity);return function(u){return r.r=o(u),r.g=a(u),r.b=l(u),r.opacity=c(u),r+""}}return n.gamma=i,n}(1);function D0(i){return function(e){var o,a,t=e.length,n=new Array(t),r=new Array(t),s=new Array(t);for(o=0;o<t;++o)a=fg(e[o]),n[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return n=i(n),r=i(r),s=i(s),a.opacity=1,function(l){return a.r=n(l),a.g=r(l),a.b=s(l),a+""}}}D0(function B5(i){var e=i.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,e-1):Math.floor(t*e),r=i[n],s=i[n+1];return O0((t-n/e)*e,n>0?i[n-1]:2*r-s,r,s,n<e-1?i[n+2]:2*s-r)}}),D0(function k5(i){var e=i.length;return function(t){var n=Math.floor(((t%=1)<0?++t:t)*e);return O0((t-n/e)*e,i[(n+e-1)%e],i[n%e],i[(n+1)%e],i[(n+2)%e])}});var Mw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fw=new RegExp(Mw.source,"g");function U5(i,e){var n,r,s,t=Mw.lastIndex=Fw.lastIndex=0,o=-1,a=[],l=[];for(i+="",e+="";(n=Mw.exec(i))&&(r=Fw.exec(e));)(s=r.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(n=n[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:Uo(n,r)})),t=Fw.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?function Y5(i){return function(e){return i(e)+""}}(l[0].x):function H5(i){return function(){return i}}(e):(e=l.length,function(c){for(var y,u=0;u<e;++u)a[(y=l[u]).i]=y.x(c);return a.join("")})}function x0(i,e){var t;return("number"==typeof e?Uo:e instanceof yh?_0:(t=yh(e))?(e=t,_0):U5)(i,e)}function W5(i){return function(){this.removeAttribute(i)}}function j5(i){return function(){this.removeAttributeNS(i.space,i.local)}}function z5(i,e,t){var n,s,r=t+"";return function(){var o=this.getAttribute(i);return o===r?null:o===n?s:s=e(n=o,t)}}function K5(i,e,t){var n,s,r=t+"";return function(){var o=this.getAttributeNS(i.space,i.local);return o===r?null:o===n?s:s=e(n=o,t)}}function $5(i,e,t){var n,r,s;return function(){var o,l,a=t(this);return null==a?void this.removeAttribute(i):(o=this.getAttribute(i))===(l=a+"")?null:o===n&&l===r?s:(r=l,s=e(n=o,a))}}function J5(i,e,t){var n,r,s;return function(){var o,l,a=t(this);return null==a?void this.removeAttributeNS(i.space,i.local):(o=this.getAttributeNS(i.space,i.local))===(l=a+"")?null:o===n&&l===r?s:(r=l,s=e(n=o,a))}}function Q5(i,e){return function(t){this.setAttribute(i,e.call(this,t))}}function X5(i,e){return function(t){this.setAttributeNS(i.space,i.local,e.call(this,t))}}function Z5(i,e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&X5(i,s)),t}return r._value=e,r}function ej(i,e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&Q5(i,s)),t}return r._value=e,r}function nj(i,e){return function(){Iw(this,i).delay=+e.apply(this,arguments)}}function ij(i,e){return e=+e,function(){Iw(this,i).delay=e}}function sj(i,e){return function(){oo(this,i).duration=+e.apply(this,arguments)}}function oj(i,e){return e=+e,function(){oo(this,i).duration=e}}function lj(i,e){if("function"!=typeof e)throw new Error;return function(){oo(this,i).ease=e}}function fj(i,e,t){var n,r,s=function dj(i){return(i+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(e)?Iw:oo;return function(){var o=s(this,i),a=o.on;a!==n&&(r=(n=a).copy()).on(e,t),o.on=r}}var wj=ah.prototype.constructor;function L0(i){return function(){this.style.removeProperty(i)}}function Tj(i,e,t){return function(n){this.style.setProperty(i,e.call(this,n),t)}}function Oj(i,e,t){var n,r;function s(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Tj(i,o,t)),n}return s._value=e,s}function Dj(i){return function(e){this.textContent=i.call(this,e)}}function xj(i){var e,t;function n(){var r=i.apply(this,arguments);return r!==t&&(e=(t=r)&&Dj(r)),e}return n._value=i,n}var Bj=0;function ao(i,e,t,n){this._groups=i,this._parents=e,this._name=t,this._id=n}function M0(){return++Bj}var hc=ah.prototype;ao.prototype=function kj(i){return ah().transition(i)}.prototype={constructor:ao,select:function yj(i){var e=this._name,t=this._id;"function"!=typeof i&&(i=yw(i));for(var n=this._groups,r=n.length,s=new Array(r),o=0;o<r;++o)for(var u,y,a=n[o],l=a.length,c=s[o]=new Array(l),R=0;R<l;++R)(u=a[R])&&(y=i.call(u,u.__data__,R,a))&&("__data__"in u&&(y.__data__=u.__data__),c[R]=y,cg(c[R],e,t,R,c,ns(u,t)));return new ao(s,this._parents,e,t)},selectAll:function Ej(i){var e=this._name,t=this._id;"function"!=typeof i&&(i=MP(i));for(var n=this._groups,r=n.length,s=[],o=[],a=0;a<r;++a)for(var u,l=n[a],c=l.length,y=0;y<c;++y)if(u=l[y]){for(var D,R=i.call(u,u.__data__,y,l),L=ns(u,t),k=0,W=R.length;k<W;++k)(D=R[k])&&cg(D,e,t,k,R,L);s.push(R),o.push(u)}return new ao(s,o,e,t)},filter:function uj(i){"function"!=typeof i&&(i=FP(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var l,s=e[r],o=s.length,a=n[r]=[],c=0;c<o;++c)(l=s[c])&&i.call(l,l.__data__,c,s)&&a.push(l);return new ao(n,this._parents,this._name,this._id)},merge:function hj(i){if(i._id!==this._id)throw new Error;for(var e=this._groups,t=i._groups,n=e.length,s=Math.min(n,t.length),o=new Array(n),a=0;a<s;++a)for(var R,l=e[a],c=t[a],u=l.length,y=o[a]=new Array(u),D=0;D<u;++D)(R=l[D]||c[D])&&(y[D]=R);for(;a<n;++a)o[a]=e[a];return new ao(o,this._parents,this._name,this._id)},selection:function vj(){return new wj(this._groups,this._parents)},transition:function Mj(){for(var i=this._name,e=this._id,t=M0(),n=this._groups,r=n.length,s=0;s<r;++s)for(var l,o=n[s],a=o.length,c=0;c<a;++c)if(l=o[c]){var u=ns(l,e);cg(l,i,t,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ao(n,this._parents,i,t)},call:hc.call,nodes:hc.nodes,node:hc.node,size:hc.size,empty:hc.empty,each:hc.each,on:function gj(i,e){var t=this._id;return arguments.length<2?ns(this.node(),t).on.on(i):this.each(fj(t,i,e))},attr:function q5(i,e){var t=eg(i),n="transform"===t?b5:x0;return this.attrTween(i,"function"==typeof e?(t.local?J5:$5)(t,n,_w(this,"attr."+i,e)):null==e?(t.local?j5:W5)(t):(t.local?K5:z5)(t,n,e))},attrTween:function tj(i,e){var t="attr."+i;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;var n=eg(i);return this.tween(t,(n.local?Z5:ej)(n,e))},style:function Rj(i,e,t){var n="transform"==(i+="")?A5:x0;return null==e?this.styleTween(i,function Sj(i,e){var t,n,r;return function(){var s=ac(this,i),o=(this.style.removeProperty(i),ac(this,i));return s===o?null:s===t&&o===n?r:r=e(t=s,n=o)}}(i,n)).on("end.style."+i,L0(i)):"function"==typeof e?this.styleTween(i,function bj(i,e,t){var n,r,s;return function(){var o=ac(this,i),a=t(this),l=a+"";return null==a&&(this.style.removeProperty(i),l=a=ac(this,i)),o===l?null:o===n&&l===r?s:(r=l,s=e(n=o,a))}}(i,n,_w(this,"style."+i,e))).each(function Cj(i,e){var t,n,r,a,s="style."+e,o="end."+s;return function(){var l=oo(this,i),c=l.on,u=null==l.value[s]?a||(a=L0(e)):void 0;(c!==t||r!==u)&&(n=(t=c).copy()).on(o,r=u),l.on=n}}(this._id,i)):this.styleTween(i,function Aj(i,e,t){var n,s,r=t+"";return function(){var o=ac(this,i);return o===r?null:o===n?s:s=e(n=o,t)}}(i,n,e),t).on("end.style."+i,null)},styleTween:function Ij(i,e,t){var n="style."+(i+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,Oj(i,e,null==t?"":t))},text:function _j(i){return this.tween("text","function"==typeof i?function Nj(i){return function(){var e=i(this);this.textContent=null==e?"":e}}(_w(this,"text",i)):function Pj(i){return function(){this.textContent=i}}(null==i?"":i+""))},textTween:function Lj(i){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==i)return this.tween(e,null);if("function"!=typeof i)throw new Error;return this.tween(e,xj(i))},remove:function mj(){return this.on("end.remove",function pj(i){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==i)return;e&&e.removeChild(this)}}(this._id))},tween:function T5(i,e){var t=this._id;if(i+="",arguments.length<2){for(var o,n=ns(this.node(),t).tween,r=0,s=n.length;r<s;++r)if((o=n[r]).name===i)return o.value;return null}return this.each((null==e?C5:R5)(t,i,e))},delay:function rj(i){var e=this._id;return arguments.length?this.each(("function"==typeof i?nj:ij)(e,i)):ns(this.node(),e).delay},duration:function aj(i){var e=this._id;return arguments.length?this.each(("function"==typeof i?sj:oj)(e,i)):ns(this.node(),e).duration},ease:function cj(i){var e=this._id;return arguments.length?this.each(lj(e,i)):ns(this.node(),e).ease},end:function Fj(){var i,e,t=this,n=t._id,r=t.size();return new Promise(function(s,o){var a={value:o},l={value:function(){0==--r&&s()}};t.each(function(){var c=oo(this,n),u=c.on;u!==i&&((e=(i=u).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e})})}};var Bw={time:null,delay:0,duration:250,ease:function Vj(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}};function Gj(i,e){for(var t;!(t=i.__transition)||!(t=t[e]);)if(!(i=i.parentNode))return Bw.time=cc(),Bw;return t}ah.prototype.interrupt=function w5(i){return this.each(function(){!function E5(i,e){var n,r,o,t=i.__transition,s=!0;if(t){for(o in e=null==e?null:e+"",t)(n=t[o]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",i,i.__data__,n.index,n.group),delete t[o]):s=!1;s&&delete i.__transition}}(this,i)})},ah.prototype.transition=function Hj(i){var e,t;i instanceof ao?(e=i._id,i=i._name):(e=M0(),(t=Bw).time=cc(),i=null==i?null:i+"");for(var n=this._groups,r=n.length,s=0;s<r;++s)for(var l,o=n[s],a=o.length,c=0;c<a;++c)(l=o[c])&&cg(l,i,e,c,o,t||Gj(l,e));return new ao(n,this._parents,i,e)};const Uj=["addListener","removeListener"],Wj=["addEventListener","removeEventListener"],jj=["on","off"];function dc(i,e,t,n){if(v(t)&&(n=t,t=void 0),n)return dc(i,e,t).pipe(nE(n));const[r,s]=function $j(i){return v(i.addEventListener)&&v(i.removeEventListener)}(i)?Wj.map(o=>a=>i[o](e,a,t)):function zj(i){return v(i.addListener)&&v(i.removeListener)}(i)?Uj.map(F0(i,e)):function Kj(i){return v(i.on)&&v(i.off)}(i)?jj.map(F0(i,e)):[];if(!r&&hr(i))return yn(o=>dc(o,e,t))(Bi(i));if(!r)throw new TypeError("Invalid event target");return new K(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function F0(i,e){return t=>n=>i[t](e,n)}class Jj extends f{constructor(e,t){super()}schedule(e,t=0){return this}}const gg={setInterval(...i){const{delegate:e}=gg;return((null==e?void 0:e.setInterval)||setInterval)(...i)},clearInterval(i){const{delegate:e}=gg;return((null==e?void 0:e.clearInterval)||clearInterval)(i)},delegate:void 0};class kw extends Jj{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,n=0){return gg.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;gg.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,n=!1;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,d(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const B0={now:()=>(B0.delegate||Date).now(),delegate:void 0};class Eh{constructor(e,t=Eh.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}Eh.now=B0.now;class Vw extends Eh{constructor(e,t=Eh.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const Gw=new Vw(kw),k0=Gw;function Hw(i,e=Gw){return ae((t,n)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,n.next(c)}};function l(){const c=o+i,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void n.add(r);a()}t.subscribe(new he(n,c=>{s=c,o=e.now(),r||(r=e.schedule(l,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{s=r=null}))})}function i8(i){return void 0===i}function a8(i){if(Array.isArray(i)){for(var e=0,t=Array(i.length);e<i.length;e++)t[e]=i[e];return t}return Array.from(i)}function l8(i){return Array.isArray(i)?i:Array.from(i)}function wh(){for(var i=arguments.length,e=Array(i),t=0;t<i;t++)e[t]=arguments[t];var n=function(y,R){return{a:y.a*R.a+y.c*R.b,c:y.a*R.c+y.c*R.d,e:y.a*R.e+y.c*R.f+y.e,b:y.b*R.a+y.d*R.b,d:y.b*R.c+y.d*R.d,f:y.b*R.e+y.d*R.f+y.f}};switch((e=Array.isArray(e[0])?e[0]:e).length){case 0:throw new Error("no matrices provided");case 1:return e[0];case 2:return n(e[0],e[1]);default:var r=e,s=l8(r),o=s[0],a=s[1],l=s.slice(2),c=n(o,a);return wh.apply(void 0,[c].concat(a8(l)))}}function H0(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{a:1,c:0,e:i,b:0,d:1,f:e}}"function"==typeof Symbol&&Symbol,Math,Math,Math,Math;class Y0 extends Map{constructor(e,t=j0){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(Yw(this,e))}has(e){return super.has(Yw(this,e))}set(e,t){return super.set(function U0({_intern:i,_key:e},t){const n=e(t);return i.has(n)?i.get(n):(i.set(n,t),t)}(this,e),t)}delete(e){return super.delete(function W0({_intern:i,_key:e},t){const n=e(t);return i.has(n)&&(t=i.get(n),i.delete(n)),t}(this,e))}}function Yw({_intern:i,_key:e},t){const n=e(t);return i.has(n)?i.get(n):t}function j0(i){return null!==i&&"object"==typeof i?i.valueOf():i}function u8(i,e){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(e).domain(i)}return this}Set;const z0=Symbol("implicit");function K0(){var i=new Y0,e=[],t=[],n=z0;function r(s){let o=i.get(s);if(void 0===o){if(n!==z0)return n;i.set(s,o=e.push(s)-1)}return t[o%t.length]}return r.domain=function(s){if(!arguments.length)return e.slice();e=[],i=new Y0;for(const o of s)i.has(o)||i.set(o,e.push(o)-1);return r},r.range=function(s){return arguments.length?(t=Array.from(s),r):t.slice()},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return K0(e,t).unknown(n)},u8.apply(r,arguments),r}var gc=h(9695);function h8(i,e){var t;function n(){var r,o,s=t.length,a=0,l=0;for(r=0;r<s;++r)a+=(o=t[r]).x,l+=o.y;for(a=a/s-i,l=l/s-e,r=0;r<s;++r)(o=t[r]).x-=a,o.y-=l}return null==i&&(i=0),null==e&&(e=0),n.initialize=function(r){t=r},n.x=function(r){return arguments.length?(i=+r,n):i},n.y=function(r){return arguments.length?(e=+r,n):e},n}function _n(i){return function(){return i}}function Wo(){return 1e-6*(Math.random()-.5)}function $0(i,e,t,n){if(isNaN(e)||isNaN(t))return i;var r,y,R,D,L,k,W,X,ne,s=i._root,o={data:n},a=i._x0,l=i._y0,c=i._x1,u=i._y1;if(!s)return i._root=o,i;for(;s.length;)if((k=e>=(y=(a+c)/2))?a=y:c=y,(W=t>=(R=(l+u)/2))?l=R:u=R,r=s,!(s=s[X=W<<1|k]))return r[X]=o,i;if(D=+i._x.call(null,s.data),L=+i._y.call(null,s.data),e===D&&t===L)return o.next=s,r?r[X]=o:i._root=o,i;do{r=r?r[X]=new Array(4):i._root=new Array(4),(k=e>=(y=(a+c)/2))?a=y:c=y,(W=t>=(R=(l+u)/2))?l=R:u=R}while((X=W<<1|k)==(ne=(L>=R)<<1|D>=y));return r[ne]=s,r[X]=o,i}function Ai(i,e,t,n,r){this.node=i,this.x0=e,this.y0=t,this.x1=n,this.y1=r}function C8(i){return i[0]}function T8(i){return i[1]}function Uw(i,e,t){var n=new Ww(null==e?C8:e,null==t?T8:t,NaN,NaN,NaN,NaN);return null==i?n:n.addAll(i)}function Ww(i,e,t,n,r,s){this._x=i,this._y=e,this._x0=t,this._y0=n,this._x1=r,this._y1=s,this._root=void 0}function J0(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}var bi=Uw.prototype=Ww.prototype;function I8(i){return i.x+i.vx}function P8(i){return i.y+i.vy}function q0(i){var e,t,n=1,r=1;function s(){for(var l,u,y,R,D,L,k,c=e.length,W=0;W<r;++W)for(u=Uw(e,I8,P8).visitAfter(o),l=0;l<c;++l)k=(L=t[(y=e[l]).index])*L,R=y.x+y.vx,D=y.y+y.vy,u.visit(X);function X(ne,ce,Ae,Oe,Be){var ke=ne.data,Yt=ne.r,bt=L+Yt;if(!ke)return ce>R+bt||Oe<R-bt||Ae>D+bt||Be<D-bt;if(ke.index>y.index){var sn=R-ke.x-ke.vx,Ci=D-ke.y-ke.vy,Dn=sn*sn+Ci*Ci;Dn<bt*bt&&(0===sn&&(Dn+=(sn=Wo())*sn),0===Ci&&(Dn+=(Ci=Wo())*Ci),Dn=(bt-(Dn=Math.sqrt(Dn)))/Dn*n,y.vx+=(sn*=Dn)*(bt=(Yt*=Yt)/(k+Yt)),y.vy+=(Ci*=Dn)*bt,ke.vx-=sn*(bt=1-bt),ke.vy-=Ci*bt)}}}function o(l){if(l.data)return l.r=t[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function a(){if(e){var l,u,c=e.length;for(t=new Array(c),l=0;l<c;++l)t[(u=e[l]).index]=+i(u,l,e)}}return"function"!=typeof i&&(i=_n(null==i?1:+i)),s.initialize=function(l){e=l,a()},s.iterations=function(l){return arguments.length?(r=+l,s):r},s.strength=function(l){return arguments.length?(n=+l,s):n},s.radius=function(l){return arguments.length?(i="function"==typeof l?l:_n(+l),a(),s):i},s}bi.copy=function(){var t,n,i=new Ww(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root;if(!e)return i;if(!e.length)return i._root=J0(e),i;for(t=[{source:e,target:i._root=new Array(4)}];e=t.pop();)for(var r=0;r<4;++r)(n=e.source[r])&&(n.length?t.push({source:n,target:e.target[r]=new Array(4)}):e.target[r]=J0(n));return i},bi.add=function d8(i){var e=+this._x.call(null,i),t=+this._y.call(null,i);return $0(this.cover(e,t),e,t,i)},bi.addAll=function f8(i){var e,t,r,s,n=i.length,o=new Array(n),a=new Array(n),l=1/0,c=1/0,u=-1/0,y=-1/0;for(t=0;t<n;++t)isNaN(r=+this._x.call(null,e=i[t]))||isNaN(s=+this._y.call(null,e))||(o[t]=r,a[t]=s,r<l&&(l=r),r>u&&(u=r),s<c&&(c=s),s>y&&(y=s));if(l>u||c>y)return this;for(this.cover(l,c).cover(u,y),t=0;t<n;++t)$0(this,o[t],a[t],i[t]);return this},bi.cover=function g8(i,e){if(isNaN(i=+i)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,r=this._x1,s=this._y1;if(isNaN(t))r=(t=Math.floor(i))+1,s=(n=Math.floor(e))+1;else{for(var l,c,o=r-t,a=this._root;t>i||i>=r||n>e||e>=s;)switch(c=(e<n)<<1|i<t,l=new Array(4),l[c]=a,a=l,o*=2,c){case 0:r=t+o,s=n+o;break;case 1:t=r-o,s=n+o;break;case 2:r=t+o,n=s-o;break;case 3:t=r-o,n=s-o}this._root&&this._root.length&&(this._root=a)}return this._x0=t,this._y0=n,this._x1=r,this._y1=s,this},bi.data=function p8(){var i=[];return this.visit(function(e){if(!e.length)do{i.push(e.data)}while(e=e.next)}),i},bi.extent=function m8(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},bi.find=function y8(i,e,t){var n,o,a,l,c,L,k,r=this._x0,s=this._y0,u=this._x1,y=this._y1,R=[],D=this._root;for(D&&R.push(new Ai(D,r,s,u,y)),null==t?t=1/0:(r=i-t,s=e-t,u=i+t,y=e+t,t*=t);L=R.pop();)if(!(!(D=L.node)||(o=L.x0)>u||(a=L.y0)>y||(l=L.x1)<r||(c=L.y1)<s))if(D.length){var W=(o+l)/2,X=(a+c)/2;R.push(new Ai(D[3],W,X,l,c),new Ai(D[2],o,X,W,c),new Ai(D[1],W,a,l,X),new Ai(D[0],o,a,W,X)),(k=(e>=X)<<1|i>=W)&&(L=R[R.length-1],R[R.length-1]=R[R.length-1-k],R[R.length-1-k]=L)}else{var ne=i-+this._x.call(null,D.data),ce=e-+this._y.call(null,D.data),Ae=ne*ne+ce*ce;if(Ae<t){var Oe=Math.sqrt(t=Ae);r=i-Oe,s=e-Oe,u=i+Oe,y=e+Oe,n=D.data}}return n},bi.remove=function E8(i){if(isNaN(u=+this._x.call(null,i))||isNaN(y=+this._y.call(null,i)))return this;var e,n,r,s,u,y,R,D,L,k,W,X,t=this._root,o=this._x0,a=this._y0,l=this._x1,c=this._y1;if(!t)return this;if(t.length)for(;;){if((L=u>=(R=(o+l)/2))?o=R:l=R,(k=y>=(D=(a+c)/2))?a=D:c=D,e=t,!(t=t[W=k<<1|L]))return this;if(!t.length)break;(e[W+1&3]||e[W+2&3]||e[W+3&3])&&(n=e,X=W)}for(;t.data!==i;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[W]=s:delete e[W],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[X]=t:this._root=t),this):(this._root=s,this)},bi.removeAll=function w8(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this},bi.root=function v8(){return this._root},bi.size=function S8(){var i=0;return this.visit(function(e){if(!e.length)do{++i}while(e=e.next)}),i},bi.visit=function A8(i){var t,r,s,o,a,l,e=[],n=this._root;for(n&&e.push(new Ai(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!i(n=t.node,s=t.x0,o=t.y0,a=t.x1,l=t.y1)&&n.length){var c=(s+a)/2,u=(o+l)/2;(r=n[3])&&e.push(new Ai(r,c,u,a,l)),(r=n[2])&&e.push(new Ai(r,s,u,c,l)),(r=n[1])&&e.push(new Ai(r,c,o,a,u)),(r=n[0])&&e.push(new Ai(r,s,o,c,u))}return this},bi.visitAfter=function b8(i){var n,e=[],t=[];for(this._root&&e.push(new Ai(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var r=n.node;if(r.length){var s,o=n.x0,a=n.y0,l=n.x1,c=n.y1,u=(o+l)/2,y=(a+c)/2;(s=r[0])&&e.push(new Ai(s,o,a,u,y)),(s=r[1])&&e.push(new Ai(s,u,a,l,y)),(s=r[2])&&e.push(new Ai(s,o,y,u,c)),(s=r[3])&&e.push(new Ai(s,u,y,l,c))}t.push(n)}for(;n=t.pop();)i(n.node,n.x0,n.y0,n.x1,n.y1);return this},bi.x=function R8(i){return arguments.length?(this._x=i,this):this._x},bi.y=function O8(i){return arguments.length?(this._y=i,this):this._y};var Ir="$";function pg(){}function Q0(i,e){var t=new pg;if(i instanceof pg)i.each(function(a,l){t.set(l,a)});else if(Array.isArray(i)){var s,n=-1,r=i.length;if(null==e)for(;++n<r;)t.set(n,i[n]);else for(;++n<r;)t.set(e(s=i[n],n,i),s)}else if(i)for(var o in i)t.set(o,i[o]);return t}pg.prototype=Q0.prototype={constructor:pg,has:function(i){return Ir+i in this},get:function(i){return this[Ir+i]},set:function(i,e){return this[Ir+i]=e,this},remove:function(i){var e=Ir+i;return e in this&&delete this[e]},clear:function(){for(var i in this)i[0]===Ir&&delete this[i]},keys:function(){var i=[];for(var e in this)e[0]===Ir&&i.push(e.slice(1));return i},values:function(){var i=[];for(var e in this)e[0]===Ir&&i.push(this[e]);return i},entries:function(){var i=[];for(var e in this)e[0]===Ir&&i.push({key:e.slice(1),value:this[e]});return i},size:function(){var i=0;for(var e in this)e[0]===Ir&&++i;return i},empty:function(){for(var i in this)if(i[0]===Ir)return!1;return!0},each:function(i){for(var e in this)e[0]===Ir&&i(this[e],e.slice(1),this)}};const jw=Q0;function mg(){}var Na=jw.prototype;function x8(i){return i.index}function eN(i,e){var t=i.get(e);if(!t)throw new Error("missing: "+e);return t}function tN(i){var n,s,o,a,l,e=x8,t=function u(k){return 1/Math.min(a[k.source.index],a[k.target.index])},r=_n(30),c=1;function y(k){for(var W=0,X=i.length;W<c;++W)for(var ce,Ae,Oe,Be,ke,Yt,bt,ne=0;ne<X;++ne)Be=(Oe=(ce=i[ne]).target).x+Oe.vx-(Ae=ce.source).x-Ae.vx||Wo(),ke=Oe.y+Oe.vy-Ae.y-Ae.vy||Wo(),ke*=Yt=((Yt=Math.sqrt(Be*Be+ke*ke))-s[ne])/Yt*k*n[ne],Oe.vx-=(Be*=Yt)*(bt=l[ne]),Oe.vy-=ke*bt,Ae.vx+=Be*(bt=1-bt),Ae.vy+=ke*bt}function R(){if(o){var k,ce,W=o.length,X=i.length,ne=jw(o,e);for(k=0,a=new Array(W);k<X;++k)(ce=i[k]).index=k,"object"!=typeof ce.source&&(ce.source=eN(ne,ce.source)),"object"!=typeof ce.target&&(ce.target=eN(ne,ce.target)),a[ce.source.index]=(a[ce.source.index]||0)+1,a[ce.target.index]=(a[ce.target.index]||0)+1;for(k=0,l=new Array(X);k<X;++k)l[k]=a[(ce=i[k]).source.index]/(a[ce.source.index]+a[ce.target.index]);n=new Array(X),D(),s=new Array(X),L()}}function D(){if(o)for(var k=0,W=i.length;k<W;++k)n[k]=+t(i[k],k,i)}function L(){if(o)for(var k=0,W=i.length;k<W;++k)s[k]=+r(i[k],k,i)}return null==i&&(i=[]),y.initialize=function(k){o=k,R()},y.links=function(k){return arguments.length?(i=k,R(),y):i},y.id=function(k){return arguments.length?(e=k,y):e},y.iterations=function(k){return arguments.length?(c=+k,y):c},y.strength=function(k){return arguments.length?(t="function"==typeof k?k:_n(+k),D(),y):t},y.distance=function(k){return arguments.length?(r="function"==typeof k?k:_n(+k),L(),y):r},y}function L8(i){return i.x}function M8(i){return i.y}mg.prototype=function D8(i,e){var t=new mg;if(i instanceof mg)i.each(function(s){t.add(s)});else if(i){var n=-1,r=i.length;if(null==e)for(;++n<r;)t.add(i[n]);else for(;++n<r;)t.add(e(i[n],n,i))}return t}.prototype={constructor:mg,has:Na.has,add:function(i){return this[Ir+(i+="")]=i,this},remove:Na.remove,clear:Na.clear,values:Na.keys,size:Na.size,empty:Na.empty,each:Na.each};var B8=Math.PI*(3-Math.sqrt(5));function nN(i){var e,t=1,n=.001,r=1-Math.pow(n,1/300),s=0,o=.6,a=jw(),l=og(u),c=bw("tick","end");function u(){y(),c.call("tick",e),t<n&&(l.stop(),c.call("end",e))}function y(L){var k,X,W=i.length;void 0===L&&(L=1);for(var ne=0;ne<L;++ne)for(t+=(s-t)*r,a.each(function(ce){ce(t)}),k=0;k<W;++k)null==(X=i[k]).fx?X.x+=X.vx*=o:(X.x=X.fx,X.vx=0),null==X.fy?X.y+=X.vy*=o:(X.y=X.fy,X.vy=0);return e}function R(){for(var W,L=0,k=i.length;L<k;++L){if((W=i[L]).index=L,null!=W.fx&&(W.x=W.fx),null!=W.fy&&(W.y=W.fy),isNaN(W.x)||isNaN(W.y)){var X=10*Math.sqrt(L),ne=L*B8;W.x=X*Math.cos(ne),W.y=X*Math.sin(ne)}(isNaN(W.vx)||isNaN(W.vy))&&(W.vx=W.vy=0)}}function D(L){return L.initialize&&L.initialize(i),L}return null==i&&(i=[]),R(),e={tick:y,restart:function(){return l.restart(u),e},stop:function(){return l.stop(),e},nodes:function(L){return arguments.length?(i=L,R(),a.each(D),e):i},alpha:function(L){return arguments.length?(t=+L,e):t},alphaMin:function(L){return arguments.length?(n=+L,e):n},alphaDecay:function(L){return arguments.length?(r=+L,e):+r},alphaTarget:function(L){return arguments.length?(s=+L,e):s},velocityDecay:function(L){return arguments.length?(o=1-L,e):1-o},force:function(L,k){return arguments.length>1?(null==k?a.remove(L):a.set(L,D(k)),e):a.get(L)},find:function(L,k,W){var ce,Ae,Oe,Be,ke,X=0,ne=i.length;for(null==W?W=1/0:W*=W,X=0;X<ne;++X)(Oe=(ce=L-(Be=i[X]).x)*ce+(Ae=k-Be.y)*Ae)<W&&(ke=Be,W=Oe);return ke},on:function(L,k){return arguments.length>1?(c.on(L,k),e):c.on(L)}}}function iN(){var i,e,t,r,n=_n(-30),s=1,o=1/0,a=.81;function l(R){var D,L=i.length,k=Uw(i,L8,M8).visitAfter(u);for(t=R,D=0;D<L;++D)e=i[D],k.visit(y)}function c(){if(i){var R,L,D=i.length;for(r=new Array(D),R=0;R<D;++R)r[(L=i[R]).index]=+n(L,R,i)}}function u(R){var L,k,X,ne,ce,D=0,W=0;if(R.length){for(X=ne=ce=0;ce<4;++ce)(L=R[ce])&&(k=Math.abs(L.value))&&(D+=L.value,W+=k,X+=k*L.x,ne+=k*L.y);R.x=X/W,R.y=ne/W}else{(L=R).x=L.data.x,L.y=L.data.y;do{D+=r[L.data.index]}while(L=L.next)}R.value=D}function y(R,D,L,k){if(!R.value)return!0;var W=R.x-e.x,X=R.y-e.y,ne=k-D,ce=W*W+X*X;if(ne*ne/a<ce)return ce<o&&(0===W&&(ce+=(W=Wo())*W),0===X&&(ce+=(X=Wo())*X),ce<s&&(ce=Math.sqrt(s*ce)),e.vx+=W*R.value*t/ce,e.vy+=X*R.value*t/ce),!0;if(!(R.length||ce>=o)){(R.data!==e||R.next)&&(0===W&&(ce+=(W=Wo())*W),0===X&&(ce+=(X=Wo())*X),ce<s&&(ce=Math.sqrt(s*ce)));do{R.data!==e&&(e.vx+=W*(ne=r[R.data.index]*t/ce),e.vy+=X*ne)}while(R=R.next)}}return l.initialize=function(R){i=R,c()},l.strength=function(R){return arguments.length?(n="function"==typeof R?R:_n(+R),c(),l):n},l.distanceMin=function(R){return arguments.length?(s=R*R,l):Math.sqrt(s)},l.distanceMax=function(R){return arguments.length?(o=R*R,l):Math.sqrt(o)},l.theta=function(R){return arguments.length?(a=R*R,l):Math.sqrt(a)},l}function k8(i,e,t){var n,s,o,r=_n(.1);function a(c){for(var u=0,y=n.length;u<y;++u){var R=n[u],D=R.x-e||1e-6,L=R.y-t||1e-6,k=Math.sqrt(D*D+L*L),W=(o[u]-k)*s[u]*c/k;R.vx+=D*W,R.vy+=L*W}}function l(){if(n){var c,u=n.length;for(s=new Array(u),o=new Array(u),c=0;c<u;++c)o[c]=+i(n[c],c,n),s[c]=isNaN(o[c])?0:+r(n[c],c,n)}}return"function"!=typeof i&&(i=_n(+i)),null==e&&(e=0),null==t&&(t=0),a.initialize=function(c){n=c,l()},a.strength=function(c){return arguments.length?(r="function"==typeof c?c:_n(+c),l(),a):r},a.radius=function(c){return arguments.length?(i="function"==typeof c?c:_n(+c),l(),a):i},a.x=function(c){return arguments.length?(e=+c,a):e},a.y=function(c){return arguments.length?(t=+c,a):t},a}function V8(i){var t,n,r,e=_n(.1);function s(a){for(var u,l=0,c=t.length;l<c;++l)(u=t[l]).vx+=(r[l]-u.x)*n[l]*a}function o(){if(t){var a,l=t.length;for(n=new Array(l),r=new Array(l),a=0;a<l;++a)n[a]=isNaN(r[a]=+i(t[a],a,t))?0:+e(t[a],a,t)}}return"function"!=typeof i&&(i=_n(null==i?0:+i)),s.initialize=function(a){t=a,o()},s.strength=function(a){return arguments.length?(e="function"==typeof a?a:_n(+a),o(),s):e},s.x=function(a){return arguments.length?(i="function"==typeof a?a:_n(+a),o(),s):i},s}function G8(i){var t,n,r,e=_n(.1);function s(a){for(var u,l=0,c=t.length;l<c;++l)(u=t[l]).vy+=(r[l]-u.y)*n[l]*a}function o(){if(t){var a,l=t.length;for(n=new Array(l),r=new Array(l),a=0;a<l;++a)n[a]=isNaN(r[a]=+i(t[a],a,t))?0:+e(t[a],a,t)}}return"function"!=typeof i&&(i=_n(null==i?0:+i)),s.initialize=function(a){t=a,o()},s.strength=function(a){return arguments.length?(e="function"==typeof a?a:_n(+a),o(),s):e},s.y=function(a){return arguments.length?(i="function"==typeof a?a:_n(+a),o(),s):i},s}var H8=h(7824);function Y8(i,e,t){var n=new dh,r=e;return null==e?(n.restart(i,e,t),n):(e=+e,t=null==t?cc():+t,n.restart(function s(o){o+=r,n.restart(s,r+=e,t),i(o)},e,t),n)}const U8=["linkTemplate"],W8=["nodeTemplate"],j8=["clusterTemplate"],z8=["defsTemplate"],K8=["miniMapNodeTemplate"],$8=["nodeElement"],J8=["linkElement"];function q8(i,e){1&i&&(cn(),Ao(0,14)),2&i&&rt("ngTemplateOutlet",lt(2).defsTemplate)}function Q8(i,e){if(1&i&&(cn(),ti(0,"path",15)),2&i){const t=e.$implicit;Wt("d",t.textPath)("id",t.id)}}const vh=function(i){return{$implicit:i}};function X8(i,e){if(1&i&&(cn(),Ao(0,20)),2&i){const t=lt().$implicit;rt("ngTemplateOutlet",lt(2).clusterTemplate)("ngTemplateOutletContext",Nl(2,vh,t))}}function Z8(i,e){if(1&i&&(cn(),je(0,"g",21),ti(1,"rect"),je(2,"text",22),ri(3),et()()),2&i){const t=lt().$implicit;ft(1),Wt("width",t.dimension.width)("height",t.dimension.height)("fill",null==t.data?null:t.data.color),ft(1),Wt("x",10)("y",t.dimension.height/2),ft(1),Cd(" ",t.label," ")}}function e6(i,e){if(1&i){const t=bo();cn(),je(0,"g",16,17),ni("click",function(){const s=mr(t).$implicit;return lt(2).onClick(s)}),Dt(2,X8,1,4,"ng-container",18),Dt(3,Z8,4,6,"g",19),et()}if(2&i){const t=e.$implicit,n=lt(2);Mn("old-node",n.animate&&n.oldClusters.has(t.id)),rt("id",t.id),Wt("transform",t.transform),ft(2),rt("ngIf",n.clusterTemplate),ft(1),rt("ngIf",!n.clusterTemplate)}}function t6(i,e){if(1&i&&(cn(),Ao(0,20)),2&i){const t=lt().$implicit;rt("ngTemplateOutlet",lt(2).linkTemplate)("ngTemplateOutletContext",Nl(2,vh,t))}}function n6(i,e){1&i&&(cn(),ti(0,"path",26)),2&i&&Wt("d",lt().$implicit.line)}function i6(i,e){if(1&i&&(cn(),je(0,"g",23,24),Dt(2,t6,1,4,"ng-container",18),Dt(3,n6,1,1,"path",25),et()),2&i){const t=e.$implicit,n=lt(2);rt("id",t.id),ft(2),rt("ngIf",n.linkTemplate),ft(1),rt("ngIf",!n.linkTemplate)}}function r6(i,e){if(1&i&&(cn(),Ao(0,20)),2&i){const t=lt().$implicit;rt("ngTemplateOutlet",lt(2).nodeTemplate)("ngTemplateOutletContext",Nl(2,vh,t))}}function s6(i,e){if(1&i&&(cn(),ti(0,"circle",30)),2&i){const t=lt().$implicit;Wt("cx",t.dimension.width/2)("cy",t.dimension.height/2)("fill",null==t.data?null:t.data.color)}}function o6(i,e){if(1&i){const t=bo();cn(),je(0,"g",27,28),ni("click",function(){const s=mr(t).$implicit;return lt(2).onClick(s)})("mousedown",function(r){const o=mr(t).$implicit;return lt(2).onNodeMouseDown(r,o)}),Dt(2,r6,1,4,"ng-container",18),Dt(3,s6,1,3,"circle",29),et()}if(2&i){const t=e.$implicit,n=lt(2);Mn("old-node",n.animate&&n.oldNodes.has(t.id)),rt("id",t.id),Wt("transform",t.transform),ft(2),rt("ngIf",n.nodeTemplate),ft(1),rt("ngIf",!n.nodeTemplate)}}function a6(i,e){if(1&i){const t=bo();cn(),je(0,"g",4),ni("touchstart",function(r){return mr(t),lt().onTouchStart(r)})("touchend",function(r){return mr(t),lt().onTouchEnd(r)}),je(1,"defs"),Dt(2,q8,1,1,"ng-container",5),Dt(3,Q8,1,2,"path",6),et(),je(4,"rect",7),ni("mousedown",function(){return mr(t),lt().isPanning=!0}),et(),ii(5),je(6,"g",8),Dt(7,e6,4,6,"g",9),et(),je(8,"g",10),Dt(9,i6,4,3,"g",11),et(),je(10,"g",12),Dt(11,o6,4,6,"g",13),et()()}if(2&i){const t=lt();Wt("transform",t.transform),ft(2),rt("ngIf",t.defsTemplate),ft(1),rt("ngForOf",t.graph.edges),ft(1),Wt("width",100*t.dims.width)("height",100*t.dims.height)("transform","translate("+50*(-t.dims.width||0)+","+50*(-t.dims.height||0)+")"),ft(3),rt("ngForOf",t.graph.clusters)("ngForTrackBy",t.trackNodeBy),ft(2),rt("ngForOf",t.graph.edges)("ngForTrackBy",t.trackLinkBy),ft(2),rt("ngForOf",t.graph.nodes)("ngForTrackBy",t.trackNodeBy)}}function l6(i,e){if(1&i&&(cn(),Ao(0,20)),2&i){const t=lt().$implicit;rt("ngTemplateOutlet",lt(2).miniMapNodeTemplate)("ngTemplateOutletContext",Nl(2,vh,t))}}function c6(i,e){if(1&i&&(cn(),Ao(0,20)),2&i){const t=lt().$implicit;rt("ngTemplateOutlet",lt(2).nodeTemplate)("ngTemplateOutletContext",Nl(2,vh,t))}}function u6(i,e){if(1&i&&(cn(),ti(0,"circle",30)),2&i){const t=lt().$implicit,n=lt(2);Wt("cx",t.dimension.width/2/n.minimapScaleCoefficient)("cy",t.dimension.height/2/n.minimapScaleCoefficient)("fill",null==t.data?null:t.data.color)}}function h6(i,e){if(1&i&&(cn(),je(0,"g",36,28),Dt(2,l6,1,4,"ng-container",18),Dt(3,c6,1,4,"ng-container",18),Dt(4,u6,1,3,"circle",29),et()),2&i){const t=e.$implicit,n=lt(2);Mn("old-node",n.animate&&n.oldNodes.has(t.id)),rt("id",t.id),Wt("transform",t.transform),ft(2),rt("ngIf",n.miniMapNodeTemplate),ft(1),rt("ngIf",!n.miniMapNodeTemplate&&n.nodeTemplate),ft(1),rt("ngIf",!n.nodeTemplate&&!n.miniMapNodeTemplate)}}function d6(i,e){if(1&i){const t=bo();cn(),je(0,"g",31)(1,"rect",32),ni("mousedown",function(r){return mr(t),lt().onMinimapPanTo(r)}),et(),je(2,"g")(3,"g",33),Dt(4,h6,5,7,"g",34),et(),je(5,"rect",35),ni("mousedown",function(){return mr(t),lt().onMinimapDragMouseDown()}),et()()()}if(2&i){const t=lt();Wt("transform",t.minimapTransform)("clip-path","url(#"+t.minimapClipPathId+")"),ft(1),Wt("width",t.graphDims.width/t.minimapScaleCoefficient)("height",t.graphDims.height/t.minimapScaleCoefficient),ft(1),Co("transform","translate("+-t.minimapOffsetX/t.minimapScaleCoefficient+"px,"+-t.minimapOffsetY/t.minimapScaleCoefficient+"px)"),ft(1),Co("transform","scale("+1/t.minimapScaleCoefficient+")"),ft(1),rt("ngForOf",t.graph.nodes)("ngForTrackBy",t.trackNodeBy),ft(1),Mn("panning",t.isMinimapPanning),Wt("transform","translate("+t.panOffsetX/t.zoomLevel/-t.minimapScaleCoefficient+","+t.panOffsetY/t.zoomLevel/-t.minimapScaleCoefficient+")")("width",t.width/t.minimapScaleCoefficient/t.zoomLevel)("height",t.height/t.minimapScaleCoefficient/t.zoomLevel)}}const f6=["*"],rN={};function lo(){let i=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);return i=`a${i}`,rN[i]?lo():(rN[i]=!0,i)}var pc=(()=>{return(i=pc||(pc={})).Both="both",i.Horizontal="horizontal",i.Vertical="vertical",pc;var i})(),mc=(()=>{return(i=mc||(mc={})).UpperLeft="UpperLeft",i.UpperRight="UpperRight",mc;var i})();function g6(i,e,t){t=t||{};let n,r,s,o=null,a=0;function l(){a=!1===t.leading?0:+new Date,o=null,s=i.apply(n,r)}return function(){const c=+new Date;!a&&!1===t.leading&&(a=c);const u=e-(c-a);return n=this,r=arguments,u<=0?(clearTimeout(o),o=null,a=c,s=i.apply(n,r)):!o&&!1!==t.trailing&&(o=setTimeout(l,u)),s}}function p6(i,e){return function(n,r,s){return{configurable:!0,enumerable:s.enumerable,get:function(){return Object.defineProperty(this,r,{configurable:!0,enumerable:s.enumerable,value:g6(s.value,i,e)}),this[r]}}}}let sN=[{name:"vivid",selectable:!0,group:"Ordinal",domain:["#647c8a","#3f51b5","#2196f3","#00b862","#afdf0a","#a7b61a","#f3e562","#ff9800","#ff5722","#ff4514"]},{name:"natural",selectable:!0,group:"Ordinal",domain:["#bf9d76","#e99450","#d89f59","#f2dfa7","#a5d7c6","#7794b1","#afafaf","#707160","#ba9383","#d9d5c3"]},{name:"cool",selectable:!0,group:"Ordinal",domain:["#a8385d","#7aa3e5","#a27ea8","#aae3f5","#adcded","#a95963","#8796c0","#7ed3ed","#50abcc","#ad6886"]},{name:"fire",selectable:!0,group:"Ordinal",domain:["#ff3d00","#bf360c","#ff8f00","#ff6f00","#ff5722","#e65100","#ffca28","#ffab00"]},{name:"solar",selectable:!0,group:"Continuous",domain:["#fff8e1","#ffecb3","#ffe082","#ffd54f","#ffca28","#ffc107","#ffb300","#ffa000","#ff8f00","#ff6f00"]},{name:"air",selectable:!0,group:"Continuous",domain:["#e1f5fe","#b3e5fc","#81d4fa","#4fc3f7","#29b6f6","#03a9f4","#039be5","#0288d1","#0277bd","#01579b"]},{name:"aqua",selectable:!0,group:"Continuous",domain:["#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00bcd4","#00acc1","#0097a7","#00838f","#006064"]},{name:"flame",selectable:!1,group:"Ordinal",domain:["#A10A28","#D3342D","#EF6D49","#FAAD67","#FDDE90","#DBED91","#A9D770","#6CBA67","#2C9653","#146738"]},{name:"ocean",selectable:!1,group:"Ordinal",domain:["#1D68FB","#33C0FC","#4AFFFE","#AFFFFF","#FFFC63","#FDBD2D","#FC8A25","#FA4F1E","#FA141B","#BA38D1"]},{name:"forest",selectable:!1,group:"Ordinal",domain:["#55C22D","#C1F33D","#3CC099","#AFFFFF","#8CFC9D","#76CFFA","#BA60FB","#EE6490","#C42A1C","#FC9F32"]},{name:"horizon",selectable:!1,group:"Ordinal",domain:["#2597FB","#65EBFD","#99FDD0","#FCEE4B","#FEFCFA","#FDD6E3","#FCB1A8","#EF6F7B","#CB96E8","#EFDEE0"]},{name:"neons",selectable:!1,group:"Ordinal",domain:["#FF3333","#FF33FF","#CC33FF","#0000FF","#33CCFF","#33FFFF","#33FF66","#CCFF33","#FFCC00","#FF6600"]},{name:"picnic",selectable:!1,group:"Ordinal",domain:["#FAC51D","#66BD6D","#FAA026","#29BB9C","#E96B56","#55ACD2","#B7332F","#2C83C9","#9166B8","#92E7E8"]},{name:"night",selectable:!1,group:"Ordinal",domain:["#2B1B5A","#501356","#183356","#28203F","#391B3C","#1E2B3C","#120634","#2D0432","#051932","#453080","#75267D","#2C507D","#4B3880","#752F7D","#35547D"]},{name:"nightLights",selectable:!1,group:"Ordinal",domain:["#4e31a5","#9c25a7","#3065ab","#57468b","#904497","#46648b","#32118d","#a00fb3","#1052a2","#6e51bd","#b63cc3","#6c97cb","#8671c1","#b455be","#7496c3"]}];class m6{constructor(e,t,n){"string"==typeof e&&(e=sN.find(r=>r.name===e)),this.colorDomain=e.domain,this.domain=t,this.customColors=n,this.scale=this.generateColorScheme(e,this.domain)}generateColorScheme(e,t){return"string"==typeof e&&(e=sN.find(n=>n.name===e)),K0().range(e.domain).domain(t)}getColor(e){if(null==e)throw new Error("Value can not be null");if("function"==typeof this.customColors)return this.customColors(e);const t=e.toString();let n;return this.customColors&&this.customColors.length>0&&(n=this.customColors.find(r=>r.name.toLowerCase()===t.toLowerCase())),n?n.value:this.scale(e)}}let E6=(()=>{class i{constructor(t,n){this.element=t,this.zone=n,this.visible=new Mt,this.isVisible=!1,this.runCheck()}destroy(){clearTimeout(this.timeout)}onVisibilityChange(){this.zone.run(()=>{this.isVisible=!0,this.visible.emit(!0)})}runCheck(){const t=()=>{if(!this.element)return;const{offsetHeight:n,offsetWidth:r}=this.element.nativeElement;n&&r?(clearTimeout(this.timeout),this.onVisibilityChange()):(clearTimeout(this.timeout),this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>t(),100)}))};this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>t())})}}return i.\u0275fac=function(t){return new(t||i)(we(Sn),we(St))},i.\u0275dir=an({type:i,selectors:[["visibility-observer"]],outputs:{visible:"visible"}}),i})();var yc=(()=>{return(i=yc||(yc={})).LEFT_TO_RIGHT="LR",i.RIGHT_TO_LEFT="RL",i.TOP_TO_BOTTOM="TB",i.BOTTOM_TO_TOM="BT",yc;var i})();function Ec(i){return"string"==typeof i?{id:i,x:0,y:0}:i}function aN(i,e){return"number"==typeof e?i[e]:e}const lN={dagre:class w6{constructor(){this.defaultSettings={orientation:yc.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}run(e){this.createDagreGraph(e),gc.layout(this.dagreGraph),e.edgeLabels=this.dagreGraph._edgeLabels;for(const t in this.dagreGraph._nodes){const n=this.dagreGraph._nodes[t],r=e.nodes.find(s=>s.id===n.id);r.position={x:n.x,y:n.y},r.dimension={width:n.width,height:n.height}}return e}updateEdge(e,t){const n=e.nodes.find(l=>l.id===t.source),r=e.nodes.find(l=>l.id===t.target),s=n.position.y<=r.position.y?-1:1;return t.points=[{x:n.position.x,y:n.position.y-s*(n.dimension.height/2)},{x:r.position.x,y:r.position.y+s*(r.dimension.height/2)}],e}createDagreGraph(e){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new gc.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=e.nodes.map(n=>{const r=Object.assign({},n);return r.width=n.dimension.width,r.height=n.dimension.height,r.x=n.position.x,r.y=n.position.y,r}),this.dagreEdges=e.edges.map(n=>{const r=Object.assign({},n);return r.id||(r.id=lo()),r});for(const n of this.dagreNodes)n.width||(n.width=20),n.height||(n.height=30),this.dagreGraph.setNode(n.id,n);for(const n of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(n.source,n.target,n,n.id):this.dagreGraph.setEdge(n.source,n.target);return this.dagreGraph}},dagreCluster:class v6{constructor(){this.defaultSettings={orientation:yc.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}run(e){this.createDagreGraph(e),gc.layout(this.dagreGraph),e.edgeLabels=this.dagreGraph._edgeLabels;const t=n=>{const r=this.dagreGraph._nodes[n.id];return Object.assign(Object.assign({},n),{position:{x:r.x,y:r.y},dimension:{width:r.width,height:r.height}})};return e.clusters=(e.clusters||[]).map(t),e.nodes=e.nodes.map(t),e}updateEdge(e,t){const n=e.nodes.find(l=>l.id===t.source),r=e.nodes.find(l=>l.id===t.target),s=n.position.y<=r.position.y?-1:1;return t.points=[{x:n.position.x,y:n.position.y-s*(n.dimension.height/2)},{x:r.position.x,y:r.position.y+s*(r.dimension.height/2)}],e}createDagreGraph(e){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new gc.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=e.nodes.map(n=>{const r=Object.assign({},n);return r.width=n.dimension.width,r.height=n.dimension.height,r.x=n.position.x,r.y=n.position.y,r}),this.dagreClusters=e.clusters||[],this.dagreEdges=e.edges.map(n=>{const r=Object.assign({},n);return r.id||(r.id=lo()),r});for(const n of this.dagreNodes)this.dagreGraph.setNode(n.id,n);for(const n of this.dagreClusters)this.dagreGraph.setNode(n.id,n),n.childNodeIds.forEach(r=>{this.dagreGraph.setParent(r,n.id)});for(const n of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(n.source,n.target,n,n.id):this.dagreGraph.setEdge(n.source,n.target);return this.dagreGraph}},dagreNodesOnly:class A6{constructor(){this.defaultSettings={orientation:yc.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,curveDistance:20,multigraph:!0,compound:!0},this.settings={}}run(e){this.createDagreGraph(e),gc.layout(this.dagreGraph),e.edgeLabels=this.dagreGraph._edgeLabels;for(const t in this.dagreGraph._nodes){const n=this.dagreGraph._nodes[t],r=e.nodes.find(s=>s.id===n.id);r.position={x:n.x,y:n.y},r.dimension={width:n.width,height:n.height}}for(const t of e.edges)this.updateEdge(e,t);return e}updateEdge(e,t){const n=e.nodes.find(L=>L.id===t.source),r=e.nodes.find(L=>L.id===t.target),s="BT"===this.settings.orientation||"TB"===this.settings.orientation?"y":"x",o="y"===s?"x":"y",a="y"===s?"height":"width",l=n.position[s]<=r.position[s]?-1:1,c={[o]:n.position[o],[s]:n.position[s]-l*(n.dimension[a]/2)},u={[o]:r.position[o],[s]:r.position[s]+l*(r.dimension[a]/2)},y=this.settings.curveDistance||this.defaultSettings.curveDistance;t.points=[c,{[o]:c[o],[s]:c[s]-l*y},{[o]:u[o],[s]:u[s]+l*y},u];const D=e.edgeLabels[`${t.source}\x01${t.target}\x01\0`];return D&&(D.points=t.points),e}createDagreGraph(e){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new gc.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=e.nodes.map(n=>{const r=Object.assign({},n);return r.width=n.dimension.width,r.height=n.dimension.height,r.x=n.position.x,r.y=n.position.y,r}),this.dagreEdges=e.edges.map(n=>{const r=Object.assign({},n);return r.id||(r.id=lo()),r});for(const n of this.dagreNodes)n.width||(n.width=20),n.height||(n.height=30),this.dagreGraph.setNode(n.id,n);for(const n of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(n.source,n.target,n,n.id):this.dagreGraph.setEdge(n.source,n.target);return this.dagreGraph}},d3ForceDirected:class b6{constructor(){this.defaultSettings={force:nN().force("charge",iN().strength(-150)).force("collide",q0(5)),forceLink:tN().id(e=>e.id).distance(()=>100)},this.settings={},this.outputGraph$=new Ee}run(e){return this.inputGraph=e,this.d3Graph={nodes:[...this.inputGraph.nodes.map(t=>Object.assign({},t))],edges:[...this.inputGraph.edges.map(t=>Object.assign({},t))]},this.outputGraph={nodes:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&this.settings.force.nodes(this.d3Graph.nodes).force("link",this.settings.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",()=>{this.outputGraph$.next(this.d3GraphToOutputGraph(this.d3Graph))}),this.outputGraph$.asObservable()}updateEdge(e,t){const n=Object.assign({},this.defaultSettings,this.settings);return n.force&&n.force.nodes(this.d3Graph.nodes).force("link",n.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",()=>{this.outputGraph$.next(this.d3GraphToOutputGraph(this.d3Graph))}),this.outputGraph$.asObservable()}d3GraphToOutputGraph(e){return this.outputGraph.nodes=this.d3Graph.nodes.map(t=>Object.assign(Object.assign({},t),{id:t.id||lo(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:`translate(${t.x-(t.dimension&&t.dimension.width||20)/2||0}, ${t.y-(t.dimension&&t.dimension.height||20)/2||0})`})),this.outputGraph.edges=this.d3Graph.edges.map(t=>Object.assign(Object.assign({},t),{source:Ec(t.source).id,target:Ec(t.target).id,points:[{x:Ec(t.source).x,y:Ec(t.source).y},{x:Ec(t.target).x,y:Ec(t.target).y}]})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph}onDragStart(e,t){this.settings.force.alphaTarget(.3).restart();const n=this.d3Graph.nodes.find(r=>r.id===e.id);!n||(this.draggingStart={x:t.x-n.x,y:t.y-n.y},n.fx=t.x-this.draggingStart.x,n.fy=t.y-this.draggingStart.y)}onDrag(e,t){if(!e)return;const n=this.d3Graph.nodes.find(r=>r.id===e.id);!n||(n.fx=t.x-this.draggingStart.x,n.fy=t.y-this.draggingStart.y)}onDragEnd(e,t){if(!e)return;const n=this.d3Graph.nodes.find(r=>r.id===e.id);!n||(this.settings.force.alphaTarget(0),n.fx=void 0,n.fy=void 0)}},colaForceDirected:class C6{constructor(){this.defaultSettings={force:(0,H8.d3adaptor)(Object.assign(Object.assign(Object.assign({},T),p),C)).linkDistance(150).avoidOverlaps(!0),viewDimensions:{width:600,height:600}},this.settings={},this.outputGraph$=new Ee}run(e){return this.inputGraph=e,this.inputGraph.clusters||(this.inputGraph.clusters=[]),this.internalGraph={nodes:[...this.inputGraph.nodes.map(t=>Object.assign(Object.assign({},t),{width:t.dimension?t.dimension.width:20,height:t.dimension?t.dimension.height:20}))],groups:[...this.inputGraph.clusters.map(t=>({padding:5,groups:t.childNodeIds.map(n=>this.inputGraph.clusters.findIndex(r=>r.id===n)).filter(n=>n>=0),leaves:t.childNodeIds.map(n=>this.inputGraph.nodes.findIndex(r=>r.id===n)).filter(n=>n>=0)}))],links:[...this.inputGraph.edges.map(t=>{const n=this.inputGraph.nodes.findIndex(s=>t.source===s.id),r=this.inputGraph.nodes.findIndex(s=>t.target===s.id);if(-1!==n&&-1!==r)return Object.assign(Object.assign({},t),{source:n,target:r})}).filter(t=>!!t)],groupLinks:[...this.inputGraph.edges.map(t=>{const n=this.inputGraph.nodes.findIndex(s=>t.source===s.id),r=this.inputGraph.nodes.findIndex(s=>t.target===s.id);if(!(n>=0&&r>=0))return t}).filter(t=>!!t)]},this.outputGraph={nodes:[],clusters:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&(this.settings.force=this.settings.force.nodes(this.internalGraph.nodes).groups(this.internalGraph.groups).links(this.internalGraph.links).alpha(.5).on("tick",()=>{this.settings.onTickListener&&this.settings.onTickListener(this.internalGraph),this.outputGraph$.next(this.internalGraphToOutputGraph(this.internalGraph))}),this.settings.viewDimensions&&(this.settings.force=this.settings.force.size([this.settings.viewDimensions.width,this.settings.viewDimensions.height])),this.settings.forceModifierFn&&(this.settings.force=this.settings.forceModifierFn(this.settings.force)),this.settings.force.start()),this.outputGraph$.asObservable()}updateEdge(e,t){const n=Object.assign({},this.defaultSettings,this.settings);return n.force&&n.force.start(),this.outputGraph$.asObservable()}internalGraphToOutputGraph(e){return this.outputGraph.nodes=e.nodes.map(t=>Object.assign(Object.assign({},t),{id:t.id||lo(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:`translate(${t.x-(t.dimension&&t.dimension.width||20)/2||0}, ${t.y-(t.dimension&&t.dimension.height||20)/2||0})`})),this.outputGraph.edges=e.links.map(t=>{const n=aN(e.nodes,t.source),r=aN(e.nodes,t.target);return Object.assign(Object.assign({},t),{source:n.id,target:r.id,points:[n.bounds.rayIntersection(r.bounds.cx(),r.bounds.cy()),r.bounds.rayIntersection(n.bounds.cx(),n.bounds.cy())]})}).concat(e.groupLinks.map(t=>{const n=e.nodes.find(a=>a.id===t.source),r=e.nodes.find(a=>a.id===t.target),s=n||e.groups.find(a=>a.id===t.source),o=r||e.groups.find(a=>a.id===t.target);return Object.assign(Object.assign({},t),{source:s.id,target:o.id,points:[s.bounds.rayIntersection(o.bounds.cx(),o.bounds.cy()),o.bounds.rayIntersection(s.bounds.cx(),s.bounds.cy())]})})),this.outputGraph.clusters=e.groups.map((t,n)=>Object.assign(Object.assign({},this.inputGraph.clusters[n]),{dimension:{width:t.bounds?t.bounds.width():20,height:t.bounds?t.bounds.height():20},position:{x:t.bounds?t.bounds.x+t.bounds.width()/2:0,y:t.bounds?t.bounds.y+t.bounds.height()/2:0}})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph}onDragStart(e,t){const n=this.outputGraph.nodes.findIndex(s=>s.id===e.id),r=this.internalGraph.nodes[n];!r||(this.draggingStart={x:r.x-t.x,y:r.y-t.y},r.fixed=1,this.settings.force.start())}onDrag(e,t){if(!e)return;const n=this.outputGraph.nodes.findIndex(s=>s.id===e.id),r=this.internalGraph.nodes[n];!r||(r.x=this.draggingStart.x+t.x,r.y=this.draggingStart.y+t.y)}onDragEnd(e,t){if(!e)return;const n=this.outputGraph.nodes.findIndex(s=>s.id===e.id),r=this.internalGraph.nodes[n];!r||(r.fixed=0)}}};let cN=(()=>{class i{getLayout(t){if(lN[t])return new lN[t];throw new Error(`Unknown layout type '${t}'`)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})(),R6=(()=>{class i{constructor(){this.mouseWheelUp=new Mt,this.mouseWheelDown=new Mt}onMouseWheelChrome(t){this.mouseWheelFunc(t)}onMouseWheelFirefox(t){this.mouseWheelFunc(t)}onWheel(t){this.mouseWheelFunc(t)}onMouseWheelIE(t){this.mouseWheelFunc(t)}mouseWheelFunc(t){window.event&&(t=window.event);const n=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail||t.deltaY||t.deltaX)),s=t.wheelDelta?n<0:n>0;(t.wheelDelta?n>0:n<0)?this.mouseWheelUp.emit(t):s&&this.mouseWheelDown.emit(t),t.returnValue=!1,t.preventDefault&&t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=an({type:i,selectors:[["","mouseWheel",""]],hostBindings:function(t,n){1&t&&ni("mousewheel",function(s){return n.onMouseWheelChrome(s)})("DOMMouseScroll",function(s){return n.onMouseWheelFirefox(s)})("wheel",function(s){return n.onWheel(s)})("onmousewheel",function(s){return n.onMouseWheelIE(s)})},outputs:{mouseWheelUp:"mouseWheelUp",mouseWheelDown:"mouseWheelDown"}}),i})(),T6=(()=>{class i{constructor(t,n,r,s){this.el=t,this.zone=n,this.cd=r,this.layoutService=s,this.nodes=[],this.clusters=[],this.links=[],this.activeEntries=[],this.draggingEnabled=!0,this.panningEnabled=!0,this.panningAxis=pc.Both,this.enableZoom=!0,this.zoomSpeed=.1,this.minZoomLevel=.1,this.maxZoomLevel=4,this.autoZoom=!1,this.panOnZoom=!0,this.animate=!1,this.autoCenter=!1,this.enableTrackpadSupport=!1,this.showMiniMap=!1,this.miniMapMaxWidth=100,this.miniMapPosition=mc.UpperRight,this.scheme="cool",this.animations=!0,this.select=new Mt,this.activate=new Mt,this.deactivate=new Mt,this.zoomChange=new Mt,this.clickHandler=new Mt,this.isMouseMoveCalled=!1,this.graphSubscription=new f,this.subscriptions=[],this.isPanning=!1,this.isDragging=!1,this.initialized=!1,this.graphDims={width:0,height:0},this._oldLinks=[],this.oldNodes=new Set,this.oldClusters=new Set,this.transformationMatrix={a:1,c:0,e:0,b:0,d:1,f:0},this._touchLastX=null,this._touchLastY=null,this.minimapScaleCoefficient=3,this.minimapOffsetX=0,this.minimapOffsetY=0,this.isMinimapPanning=!1,this.groupResultsBy=o=>o.label}get zoomLevel(){return this.transformationMatrix.a}set zoomLevel(t){this.zoomTo(Number(t))}get panOffsetX(){return this.transformationMatrix.e}set panOffsetX(t){this.panTo(Number(t),null)}get panOffsetY(){return this.transformationMatrix.f}set panOffsetY(t){this.panTo(null,Number(t))}ngOnInit(){this.update$&&this.subscriptions.push(this.update$.subscribe(()=>{this.update()})),this.center$&&this.subscriptions.push(this.center$.subscribe(()=>{this.center()})),this.zoomToFit$&&this.subscriptions.push(this.zoomToFit$.subscribe(()=>{this.zoomToFit()})),this.panToNode$&&this.subscriptions.push(this.panToNode$.subscribe(t=>{this.panToNodeId(t)})),this.minimapClipPathId=`minimapClip${lo()}`}ngOnChanges(t){this.basicUpdate();const{layoutSettings:r}=t;this.setLayout(this.layout),r&&this.setLayoutSettings(this.layoutSettings),this.update()}setLayout(t){this.initialized=!1,t||(t="dagre"),"string"==typeof t&&(this.layout=this.layoutService.getLayout(t),this.setLayoutSettings(this.layoutSettings))}setLayoutSettings(t){this.layout&&"string"!=typeof this.layout&&(this.layout.settings=t)}ngOnDestroy(){this.unbindEvents(),this.visibilityObserver&&(this.visibilityObserver.visible.unsubscribe(),this.visibilityObserver.destroy());for(const t of this.subscriptions)t.unsubscribe();this.subscriptions=null}ngAfterViewInit(){this.bindWindowResizeEvent(),this.visibilityObserver=new E6(this.el,this.zone),this.visibilityObserver.visible.subscribe(this.update.bind(this)),setTimeout(()=>this.update())}update(){this.basicUpdate(),this.curve||(this.curve=n5.beta(1)),this.zone.run(()=>{this.dims=function y6({width:i,height:e}){let t=i,n=e;return t=Math.max(0,t),n=Math.max(0,n),{width:Math.floor(t),height:Math.floor(n)}}({width:this.width,height:this.height}),this.seriesDomain=this.getSeriesDomain(),this.setColors(),this.createGraph(),this.updateTransform(),this.initialized=!0})}createGraph(){this.graphSubscription.unsubscribe(),this.graphSubscription=new f;const t=n=>(n.meta||(n.meta={}),n.id||(n.id=lo()),n.dimension?n.meta.forceDimensions=void 0===n.meta.forceDimensions||n.meta.forceDimensions:(n.dimension={width:this.nodeWidth?this.nodeWidth:30,height:this.nodeHeight?this.nodeHeight:30},n.meta.forceDimensions=!1),n.position={x:0,y:0},n.data=n.data?n.data:{},n);this.graph={nodes:this.nodes.length>0?[...this.nodes].map(t):[],clusters:this.clusters&&this.clusters.length>0?[...this.clusters].map(t):[],edges:this.links.length>0?[...this.links].map(n=>(n.id||(n.id=lo()),n)):[]},requestAnimationFrame(()=>this.draw())}draw(){if(!this.layout||"string"==typeof this.layout)return;this.applyNodeDimensions();const t=this.layout.run(this.graph),n=t instanceof K?t:Ue(t);this.graphSubscription.add(n.subscribe(r=>{this.graph=r,this.tick()})),0!==this.graph.nodes.length&&n.pipe(ha()).subscribe(()=>this.applyNodeDimensions())}tick(){const t=new Set;this.graph.nodes.map(s=>{s.transform=`translate(${s.position.x-s.dimension.width/2||0}, ${s.position.y-s.dimension.height/2||0})`,s.data||(s.data={}),s.data.color=this.colors.getColor(this.groupResultsBy(s)),t.add(s.id)});const n=new Set;(this.graph.clusters||[]).map(s=>{s.transform=`translate(${s.position.x-s.dimension.width/2||0}, ${s.position.y-s.dimension.height/2||0})`,s.data||(s.data={}),s.data.color=this.colors.getColor(this.groupResultsBy(s)),n.add(s.id)}),setTimeout(()=>{this.oldNodes=t,this.oldClusters=n},500);const r=[];for(const s in this.graph.edgeLabels){const o=this.graph.edgeLabels[s],a=s.replace(/[^\w-]*/g,""),l=this.layout&&"string"!=typeof this.layout&&this.layout.settings&&this.layout.settings.multigraph;let c=this._oldLinks.find(l?k=>`${k.source}${k.target}${k.id}`===a:k=>`${k.source}${k.target}`===a);const u=this.graph.edges.find(l?k=>`${k.source}${k.target}${k.id}`===a:k=>`${k.source}${k.target}`===a);c?c.data&&u&&u.data&&JSON.stringify(c.data)!==JSON.stringify(u.data)&&(c.data=u.data):c=u||o,c.oldLine=c.line;const y=o.points,R=this.generateLine(y),D=Object.assign({},c);D.line=R,D.points=y,this.updateMidpointOnEdge(D,y);const L=y[Math.floor(y.length/2)];L&&(D.textTransform=`translate(${L.x||0},${L.y||0})`),D.textAngle=0,D.oldLine||(D.oldLine=D.line),this.calcDominantBaseline(D),r.push(D)}this.graph.edges=r,this.graph.edges&&(this._oldLinks=this.graph.edges.map(s=>{const o=Object.assign({},s);return o.oldLine=s.line,o})),this.updateMinimap(),this.autoZoom&&this.zoomToFit(),this.autoCenter&&this.center(),requestAnimationFrame(()=>this.redrawLines()),this.cd.markForCheck()}getMinimapTransform(){switch(this.miniMapPosition){case mc.UpperLeft:return"";case mc.UpperRight:return"translate("+(this.dims.width-this.graphDims.width/this.minimapScaleCoefficient)+",0)";default:return""}}updateGraphDims(){let t=1/0,n=-1/0,r=1/0,s=-1/0;for(let o=0;o<this.graph.nodes.length;o++){const a=this.graph.nodes[o];t=a.position.x<t?a.position.x:t,r=a.position.y<r?a.position.y:r,n=a.position.x+a.dimension.width>n?a.position.x+a.dimension.width:n,s=a.position.y+a.dimension.height>s?a.position.y+a.dimension.height:s}t-=100,r-=100,n+=100,s+=100,this.graphDims.width=n-t,this.graphDims.height=s-r,this.minimapOffsetX=t,this.minimapOffsetY=r}updateMinimap(){this.graph.nodes&&this.graph.nodes.length&&(this.updateGraphDims(),this.miniMapMaxWidth&&(this.minimapScaleCoefficient=this.graphDims.width/this.miniMapMaxWidth),this.miniMapMaxHeight&&(this.minimapScaleCoefficient=Math.max(this.minimapScaleCoefficient,this.graphDims.height/this.miniMapMaxHeight)),this.minimapTransform=this.getMinimapTransform())}applyNodeDimensions(){this.nodeElements&&this.nodeElements.length&&this.nodeElements.map(t=>{const n=t.nativeElement,r=this.graph.nodes.find(o=>o.id===n.id);if(!r)return;let s;try{if(s=n.getBBox(),!s.width||!s.height)return}catch(o){return}if(r.dimension.height=this.nodeHeight?r.dimension.height&&r.meta.forceDimensions?r.dimension.height:this.nodeHeight:r.dimension.height&&r.meta.forceDimensions?r.dimension.height:s.height,this.nodeMaxHeight&&(r.dimension.height=Math.max(r.dimension.height,this.nodeMaxHeight)),this.nodeMinHeight&&(r.dimension.height=Math.min(r.dimension.height,this.nodeMinHeight)),this.nodeWidth)r.dimension.width=r.dimension.width&&r.meta.forceDimensions?r.dimension.width:this.nodeWidth;else if(n.getElementsByTagName("text").length){let o;try{for(const a of n.getElementsByTagName("text")){const l=a.getBBox();o?(l.width>o.width&&(o.width=l.width),l.height>o.height&&(o.height=l.height)):o=l}}catch(a){return}r.dimension.width=r.dimension.width&&r.meta.forceDimensions?r.dimension.width:o.width+20}else r.dimension.width=r.dimension.width&&r.meta.forceDimensions?r.dimension.width:s.width;this.nodeMaxWidth&&(r.dimension.width=Math.max(r.dimension.width,this.nodeMaxWidth)),this.nodeMinWidth&&(r.dimension.width=Math.min(r.dimension.width,this.nodeMinWidth))})}redrawLines(t=this.animate){this.linkElements.map(n=>{const r=this.graph.edges.find(s=>s.id===n.nativeElement.id);r&&(QP(n.nativeElement).select(".line").attr("d",r.oldLine).transition().ease(r0).duration(t?500:0).attr("d",r.line),QP(this.el.nativeElement).select(`#${r.id}`).attr("d",r.oldTextPath).transition().ease(r0).duration(t?500:0).attr("d",r.textPath),this.updateMidpointOnEdge(r,r.points))})}calcDominantBaseline(t){const n=t.points[0],r=t.points[t.points.length-1];t.oldTextPath=t.textPath,r.x<n.x?(t.dominantBaseline="text-before-edge",t.textPath=this.generateLine([...t.points].reverse())):(t.dominantBaseline="text-after-edge",t.textPath=t.line)}generateLine(t){return function l5(){var i=o5,e=a5,t=tg(!0),n=null,r=s5,s=null;function o(a){var l,u,R,c=a.length,y=!1;for(null==n&&(s=r(R=r5())),l=0;l<=c;++l)!(l<c&&t(u=a[l],l,a))===y&&((y=!y)?s.lineStart():s.lineEnd()),y&&s.point(+i(u,l,a),+e(u,l,a));if(R)return s=null,R+""||null}return o.x=function(a){return arguments.length?(i="function"==typeof a?a:tg(+a),o):i},o.y=function(a){return arguments.length?(e="function"==typeof a?a:tg(+a),o):e},o.defined=function(a){return arguments.length?(t="function"==typeof a?a:tg(!!a),o):t},o.curve=function(a){return arguments.length?(r=a,null!=n&&(s=r(n)),o):r},o.context=function(a){return arguments.length?(null==a?n=s=null:s=r(n=a),o):n},o}().x(r=>r.x).y(r=>r.y).curve(this.curve)(t)}onZoom(t,n){if(this.enableTrackpadSupport&&!t.ctrlKey)return void this.pan(-1*t.deltaX,-1*t.deltaY);const r=1+("in"===n?this.zoomSpeed:-this.zoomSpeed),s=this.zoomLevel*r;if(!(s<=this.minZoomLevel||s>=this.maxZoomLevel)&&this.enableZoom)if(!0===this.panOnZoom&&t){const o=t.clientX,a=t.clientY,l=this.el.nativeElement.querySelector("svg"),c=l.querySelector("g.chart"),u=l.createSVGPoint();u.x=o,u.y=a;const y=u.matrixTransform(c.getScreenCTM().inverse());this.pan(y.x,y.y,!0),this.zoom(r),this.pan(-y.x,-y.y,!0)}else this.zoom(r)}pan(t,n,r=!1){const s=r?1:this.zoomLevel;this.transformationMatrix=wh(this.transformationMatrix,H0(t/s,n/s)),this.updateTransform()}panTo(t,n){null==t||isNaN(t)||null==n||isNaN(n)||(this.transformationMatrix=wh(this.transformationMatrix,H0((-this.panOffsetX-t*this.zoomLevel+this.dims.width/2)/this.zoomLevel,(-this.panOffsetY-n*this.zoomLevel+this.dims.height/2)/this.zoomLevel)),this.updateTransform())}zoom(t){this.transformationMatrix=wh(this.transformationMatrix,function r8(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return i8(e)&&(e=i),{a:i,c:0,e:0,b:0,d:e,f:0}}(t,t)),this.zoomChange.emit(this.zoomLevel),this.updateTransform()}zoomTo(t){this.transformationMatrix.a=isNaN(t)?this.transformationMatrix.a:Number(t),this.transformationMatrix.d=isNaN(t)?this.transformationMatrix.d:Number(t),this.zoomChange.emit(this.zoomLevel),this.updateTransform(),this.update()}onDrag(t){if(!this.draggingEnabled)return;const n=this.draggingNode;this.layout&&"string"!=typeof this.layout&&this.layout.onDrag&&this.layout.onDrag(n,t),n.position.x+=t.movementX/this.zoomLevel,n.position.y+=t.movementY/this.zoomLevel,n.transform=`translate(${n.position.x-n.dimension.width/2}, ${n.position.y-n.dimension.height/2})`;for(const o of this.graph.edges)if((o.target===n.id||o.source===n.id||o.target.id===n.id||o.source.id===n.id)&&this.layout&&"string"!=typeof this.layout){const a=this.layout.updateEdge(this.graph,o),l=a instanceof K?a:Ue(a);this.graphSubscription.add(l.subscribe(c=>{this.graph=c,this.redrawEdge(o)}))}this.redrawLines(!1),this.updateMinimap()}redrawEdge(t){const n=this.generateLine(t.points);this.calcDominantBaseline(t),t.oldLine=t.line,t.line=n}updateTransform(){this.transform=function o8(i){return function G0(i){return"matrix("+i.a+","+i.b+","+i.c+","+i.d+","+i.e+","+i.f+")"}(i)}(function c8(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return{a:Math.round(i.a*e)/e,b:Math.round(i.b*e)/e,c:Math.round(i.c*e)/e,d:Math.round(i.d*e)/e,e:Math.round(i.e*e)/e,f:Math.round(i.f*e)/e}}(this.transformationMatrix,100))}onClick(t){this.select.emit(t)}onActivate(t){this.activeEntries.indexOf(t)>-1||(this.activeEntries=[t,...this.activeEntries],this.activate.emit({value:t,entries:this.activeEntries}))}onDeactivate(t){const n=this.activeEntries.indexOf(t);this.activeEntries.splice(n,1),this.activeEntries=[...this.activeEntries],this.deactivate.emit({value:t,entries:this.activeEntries})}getSeriesDomain(){return this.nodes.map(t=>this.groupResultsBy(t)).reduce((t,n)=>-1!==t.indexOf(n)?t:t.concat([n]),[]).sort()}trackLinkBy(t,n){return n.id}trackNodeBy(t,n){return n.id}setColors(){this.colors=new m6(this.scheme,this.seriesDomain,this.customColors)}onMouseMove(t){this.isMouseMoveCalled=!0,(this.isPanning||this.isMinimapPanning)&&this.panningEnabled?this.panWithConstraints(this.panningAxis,t):this.isDragging&&this.draggingEnabled&&this.onDrag(t)}onMouseDown(t){this.isMouseMoveCalled=!1}graphClick(t){this.isMouseMoveCalled||this.clickHandler.emit(t)}onTouchStart(t){this._touchLastX=t.changedTouches[0].clientX,this._touchLastY=t.changedTouches[0].clientY,this.isPanning=!0}onTouchMove(t){if(this.isPanning&&this.panningEnabled){const n=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY,s=n-this._touchLastX,o=r-this._touchLastY;this._touchLastX=n,this._touchLastY=r,this.pan(s,o)}}onTouchEnd(t){this.isPanning=!1}onMouseUp(t){this.isDragging=!1,this.isPanning=!1,this.isMinimapPanning=!1,this.layout&&"string"!=typeof this.layout&&this.layout.onDragEnd&&this.layout.onDragEnd(this.draggingNode,t)}onNodeMouseDown(t,n){!this.draggingEnabled||(this.isDragging=!0,this.draggingNode=n,this.layout&&"string"!=typeof this.layout&&this.layout.onDragStart&&this.layout.onDragStart(n,t))}onMinimapDragMouseDown(){this.isMinimapPanning=!0}onMinimapPanTo(t){this.panTo((t.offsetX-(this.dims.width-(this.graphDims.width+this.minimapOffsetX)/this.minimapScaleCoefficient))*this.minimapScaleCoefficient,(t.offsetY+this.minimapOffsetY/this.minimapScaleCoefficient)*this.minimapScaleCoefficient),this.isMinimapPanning=!0}center(){this.panTo(this.graphDims.width/2,this.graphDims.height/2)}zoomToFit(){let r=Math.min(this.dims.height/this.graphDims.height,this.dims.width/this.graphDims.width,1);r<this.minZoomLevel&&(r=this.minZoomLevel),r>this.maxZoomLevel&&(r=this.maxZoomLevel),r!==this.zoomLevel&&(this.zoomLevel=r,this.updateTransform(),this.zoomChange.emit(this.zoomLevel))}panToNodeId(t){const n=this.graph.nodes.find(r=>r.id===t);!n||this.panTo(n.position.x,n.position.y)}panWithConstraints(t,n){let r=n.movementX,s=n.movementY;switch(this.isMinimapPanning&&(r=-this.minimapScaleCoefficient*r*this.zoomLevel,s=-this.minimapScaleCoefficient*s*this.zoomLevel),t){case pc.Horizontal:this.pan(r,0);break;case pc.Vertical:this.pan(0,s);break;default:this.pan(r,s)}}updateMidpointOnEdge(t,n){if(t&&n)if(n.length%2==1)t.midPoint=n[Math.floor(n.length/2)];else{const r=n[n.length/2],s=n[n.length/2-1];t.midPoint={x:(r.x+s.x)/2,y:(r.y+s.y)/2}}}basicUpdate(){if(this.view)this.width=this.view[0],this.height=this.view[1];else{const t=this.getContainerDims();t&&(this.width=t.width,this.height=t.height)}this.width||(this.width=600),this.height||(this.height=400),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this.cd&&this.cd.markForCheck()}getContainerDims(){let t,n;const r=this.el.nativeElement;if(null!==r.parentNode){const s=r.parentNode.getBoundingClientRect();t=s.width,n=s.height}return t&&n?{width:t,height:n}:null}unbindEvents(){this.resizeSubscription&&this.resizeSubscription.unsubscribe()}bindWindowResizeEvent(){const n=dc(window,"resize").pipe(Hw(200)).subscribe(r=>{this.update(),this.cd&&this.cd.markForCheck()});this.resizeSubscription=n}}return i.\u0275fac=function(t){return new(t||i)(we(Sn),we(St),we(aa),we(cN))},i.\u0275cmp=En({type:i,selectors:[["ngx-graph"]],contentQueries:function(t,n,r){if(1&t&&(zi(r,U8,5),zi(r,W8,5),zi(r,j8,5),zi(r,z8,5),zi(r,K8,5)),2&t){let s;Fn(s=Bn())&&(n.linkTemplate=s.first),Fn(s=Bn())&&(n.nodeTemplate=s.first),Fn(s=Bn())&&(n.clusterTemplate=s.first),Fn(s=Bn())&&(n.defsTemplate=s.first),Fn(s=Bn())&&(n.miniMapNodeTemplate=s.first)}},viewQuery:function(t,n){if(1&t&&(_l($8,5),_l(J8,5)),2&t){let r;Fn(r=Bn())&&(n.nodeElements=r),Fn(r=Bn())&&(n.linkElements=r)}},hostBindings:function(t,n){1&t&&ni("mousemove",function(s){return n.onMouseMove(s)},!1,ol)("mousedown",function(s){return n.onMouseDown(s)},!1,ol)("click",function(s){return n.graphClick(s)},!1,ol)("touchmove",function(s){return n.onTouchMove(s)},!1,ol)("mouseup",function(s){return n.onMouseUp(s)},!1,ol)},inputs:{nodes:"nodes",clusters:"clusters",links:"links",activeEntries:"activeEntries",curve:"curve",draggingEnabled:"draggingEnabled",nodeHeight:"nodeHeight",nodeMaxHeight:"nodeMaxHeight",nodeMinHeight:"nodeMinHeight",nodeWidth:"nodeWidth",nodeMinWidth:"nodeMinWidth",nodeMaxWidth:"nodeMaxWidth",panningEnabled:"panningEnabled",panningAxis:"panningAxis",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",minZoomLevel:"minZoomLevel",maxZoomLevel:"maxZoomLevel",autoZoom:"autoZoom",panOnZoom:"panOnZoom",animate:"animate",autoCenter:"autoCenter",update$:"update$",center$:"center$",zoomToFit$:"zoomToFit$",panToNode$:"panToNode$",layout:"layout",layoutSettings:"layoutSettings",enableTrackpadSupport:"enableTrackpadSupport",showMiniMap:"showMiniMap",miniMapMaxWidth:"miniMapMaxWidth",miniMapMaxHeight:"miniMapMaxHeight",miniMapPosition:"miniMapPosition",view:"view",scheme:"scheme",customColors:"customColors",animations:"animations",groupResultsBy:"groupResultsBy",zoomLevel:"zoomLevel",panOffsetX:"panOffsetX",panOffsetY:"panOffsetY"},outputs:{select:"select",activate:"activate",deactivate:"deactivate",zoomChange:"zoomChange",clickHandler:"clickHandler"},features:[po],ngContentSelectors:f6,decls:6,vars:11,consts:[["mouseWheel","",1,"ngx-charts-outer",3,"mouseWheelUp","mouseWheelDown"],[1,"ngx-charts"],["class","graph chart",3,"touchstart","touchend",4,"ngIf"],["class","minimap",4,"ngIf"],[1,"graph","chart",3,"touchstart","touchend"],[3,"ngTemplateOutlet",4,"ngIf"],["class","text-path",4,"ngFor","ngForOf"],[1,"panning-rect",3,"mousedown"],[1,"clusters"],["class","node-group",3,"old-node","id","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"links"],["class","link-group",3,"id",4,"ngFor","ngForOf","ngForTrackBy"],[1,"nodes"],["class","node-group",3,"old-node","id","click","mousedown",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngTemplateOutlet"],[1,"text-path"],[1,"node-group",3,"id","click"],["clusterElement",""],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],["class","node cluster",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"node","cluster"],["alignment-baseline","central"],[1,"link-group",3,"id"],["linkElement",""],["class","edge",4,"ngIf"],[1,"edge"],[1,"node-group",3,"id","click","mousedown"],["nodeElement",""],["r","10",4,"ngIf"],["r","10"],[1,"minimap"],[1,"minimap-background",3,"mousedown"],[1,"minimap-nodes"],["class","node-group",3,"old-node","id",4,"ngFor","ngForOf","ngForTrackBy"],[1,"minimap-drag",3,"mousedown"],[1,"node-group",3,"id"]],template:function(t,n){1&t&&(Yr(),je(0,"div",0),ni("mouseWheelUp",function(s){return n.onZoom(s,"in")})("mouseWheelDown",function(s){return n.onZoom(s,"out")}),cn(),je(1,"svg",1),Dt(2,a6,12,12,"g",2),je(3,"clipPath"),ti(4,"rect"),et(),Dt(5,d6,6,15,"g",3),et()()),2&t&&(Co("width",n.width,"px"),rt("@animationState","active")("@.disabled",!n.animations),ft(1),Wt("width",n.width)("height",n.height),ft(1),rt("ngIf",n.initialized&&n.graph),ft(1),Wt("id",n.minimapClipPathId),ft(1),Wt("width",n.graphDims.width/n.minimapScaleCoefficient)("height",n.graphDims.height/n.minimapScaleCoefficient),ft(1),rt("ngIf",n.showMiniMap))},directives:[R6,Ll,kT,LT],styles:[".minimap .minimap-background{fill:#0000001a}.minimap .minimap-drag{fill:#0003;stroke:#fff;stroke-width:1px;stroke-dasharray:2px;stroke-dashoffset:2px;cursor:pointer}.minimap .minimap-drag.panning{fill:#0000004d}.minimap .minimap-nodes{opacity:.5;pointer-events:none}.graph{-webkit-user-select:none;user-select:none}.graph .edge{stroke:#666;fill:none}.graph .edge .edge-label{stroke:none;font-size:12px;fill:#251e1e}.graph .panning-rect{fill:#0000;cursor:move}.graph .node-group.old-node{transition:transform .5s ease-in-out}.graph .node-group .node:focus{outline:none}.graph .cluster rect{opacity:.2}\n"],encapsulation:2,data:{animation:[NP("animationState",[pw(":enter",[oc({opacity:0}),gw("500ms 100ms",oc({opacity:1}))])])]},changeDetection:0}),(0,IP.__decorate)([p6(500)],i.prototype,"updateMinimap",null),i})(),O6=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({providers:[cN],imports:[[qd]]}),i})(),I6=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[qd],O6]}),i})();function P6(i,e){1&i&&(cn(),je(0,"marker",4),ti(1,"path",5),et())}function N6(i,e){1&i&&(cn(),je(0,"g",6),ti(1,"path",7),et())}function _6(i,e){if(1&i&&(je(0,"ngx-graph",1),Dt(1,P6,2,0,"ng-template",null,2,dy),Dt(3,N6,2,0,"ng-template",null,3,dy),et()),2&i){const t=lt();rt("links",t.links)("nodes",t.nodes)("layout",t.useMsaglLayout?t.msaglLayout:void 0)("curve",t.curve)("enableZoom",!0)("nodeWidth",t.nodeWidth)("nodeHeight",t.nodeHeight)("draggingEnabled",!1)("autoZoom",!0)}}let D6=(()=>{class i{constructor(){this.nodes=void 0,this.links=void 0,this.nodeWidth=10,this.nodeHeight=10,this.useMsaglLayout=!0,this.useMSAGLLayeredLayout=!1,this.curve=MW}ngOnInit(){this.msaglLayout=new LW(this.useMSAGLLayeredLayout,this.nodeWidth,this.nodeHeight)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=En({type:i,selectors:[["ngx-graph-msagl"]],inputs:{nodes:"nodes",links:"links",nodeWidth:"nodeWidth",nodeHeight:"nodeHeight",useMsaglLayout:"useMsaglLayout",useMSAGLLayeredLayout:"useMSAGLLayeredLayout"},decls:1,vars:1,consts:[[3,"links","nodes","layout","curve","enableZoom","nodeWidth","nodeHeight","draggingEnabled","autoZoom",4,"ngIf"],[3,"links","nodes","layout","curve","enableZoom","nodeWidth","nodeHeight","draggingEnabled","autoZoom"],["defsTemplate",""],["linkTemplate",""],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","2","markerHeight","2","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[1,"edge"],["stroke-width","1","marker-end","url(#arrow)",1,"line"]],template:function(t,n){1&t&&Dt(0,_6,5,9,"ngx-graph",0),2&t&&rt("ngIf",n.nodes&&n.links)},directives:[Ll,T6],styles:["[_nghost-%COMP%]    {display:block;height:inherit;width:inherit}"],changeDetection:0}),i})();const x6=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"home",component:u3},{path:"example",component:(()=>{class i{constructor(){this.nodes=[],this.links=[],console.log("assaf1"),this.nodes=fI.t,this.links=fI.$,console.log("assaf2")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=En({type:i,selectors:[["app-example"]],decls:3,vars:2,consts:[[3,"nodes","links"]],template:function(t,n){1&t&&(je(0,"span"),ri(1,"Example"),et(),ti(2,"ngx-graph-msagl",0)),2&t&&(ft(2),rt("nodes",n.nodes)("links",n.links))},directives:[D6],styles:["[_nghost-%COMP%]{display:block;height:inherit}"]}),i})()},{path:"help",component:c3},{path:"**",component:h3}];let zw,L6=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[uI.forRoot(x6)],uI]}),i})();try{zw="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(i){zw=!1}let Sh,yg,_a,$w,Ns=(()=>{class i{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function oG(i){return i===GT}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!zw)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(t){return new(t||i)(Re(Sy))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),uN=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({}),i})();function Kw(i){return function M6(){if(null==Sh&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Sh=!0}))}finally{Sh=Sh||!1}return Sh}()?i:!!i.capture}function Ah(){if("object"!=typeof document||!document)return 0;if(null==yg){const i=document.createElement("div"),e=i.style;i.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),n=t.style;n.width="2px",n.height="1px",i.appendChild(t),document.body.appendChild(i),yg=0,0===i.scrollLeft&&(i.scrollLeft=1,yg=0===i.scrollLeft?1:2),i.remove()}return yg}function bh(i){return i.composedPath?i.composedPath()[0]:i.target}function is(i){return null!=i&&"false"!=`${i}`}function dN(i,e=0){return function G6(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):e}function fN(i){return Array.isArray(i)?i:[i]}function vc(i){return i instanceof Sn?i.nativeElement:i}const Ch={schedule(i){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=Ch;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);const r=e(s=>{t=void 0,i(s)});return new f(()=>null==t?void 0:t(r))},requestAnimationFrame(...i){const{delegate:e}=Ch;return((null==e?void 0:e.requestAnimationFrame)||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:e}=Ch;return((null==e?void 0:e.cancelAnimationFrame)||cancelAnimationFrame)(...i)},delegate:void 0};new class Y6 extends Vw{flush(e){this._active=!0,this._scheduled=void 0;const{actions:t}=this;let n,r=-1;e=e||t.shift();const s=t.length;do{if(n=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this._active=!1,n){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw n}}}(class H6 extends kw{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=Ch.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);0===e.actions.length&&(Ch.cancelAnimationFrame(t),e._scheduled=void 0)}});let Jw,W6=1;const Eg={};function gN(i){return i in Eg&&(delete Eg[i],!0)}const j6={setImmediate(i){const e=W6++;return Eg[e]=!0,Jw||(Jw=Promise.resolve()),Jw.then(()=>gN(e)&&i()),e},clearImmediate(i){gN(i)}},{setImmediate:z6,clearImmediate:K6}=j6,wg={setImmediate(...i){const{delegate:e}=wg;return((null==e?void 0:e.setImmediate)||z6)(...i)},clearImmediate(i){const{delegate:e}=wg;return((null==e?void 0:e.clearImmediate)||K6)(i)},delegate:void 0};new class J6 extends Vw{flush(e){this._active=!0,this._scheduled=void 0;const{actions:t}=this;let n,r=-1;e=e||t.shift();const s=t.length;do{if(n=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this._active=!1,n){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw n}}}(class $6 extends kw{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=wg.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);0===e.actions.length&&(wg.clearImmediate(t),e._scheduled=void 0)}});function pN(i=0,e,t=k0){let n=-1;return null!=e&&(Hv(e)?t=e:n=e),new K(r=>{let s=function X6(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}function mN(i,e=k0){return function Q6(i){return ae((e,t)=>{let n=!1,r=null,s=null,o=!1;const a=()=>{if(null==s||s.unsubscribe(),s=null,n){n=!1;const c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(new he(t,c=>{n=!0,r=c,s||Bi(i(c)).subscribe(s=new he(t,a,l))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}(()=>pN(i,e))}function ar(i){return ae((e,t)=>{Bi(i).subscribe(new he(t,()=>t.complete(),N)),!t.closed&&e.subscribe(t)})}const Z6=new Ge("cdk-dir-doc",{providedIn:"root",factory:function ez(){return id(Nt)}});let yN=(()=>{class i{constructor(t){if(this.value="ltr",this.change=new Mt,t){const r=t.documentElement?t.documentElement.dir:null,s=(t.body?t.body.dir:null)||r;this.value="ltr"===s||"rtl"===s?s:"ltr"}}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(t){return new(t||i)(Re(Z6,8))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),EN=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({}),i})(),qw=(()=>{class i{constructor(t,n,r){this._ngZone=t,this._platform=n,this._scrolled=new Ee,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new K(n=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(mN(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ue()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const r=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(si(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let r=vc(n),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>dc(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(t){return new(t||i)(Re(St),Re(Ns),Re(Nt,8))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),vg=(()=>{class i{constructor(t,n,r,s){this.elementRef=t,this.scrollDispatcher=n,this.ngZone=r,this.dir=s,this._destroyed=new Ee,this._elementScrolled=new K(o=>this.ngZone.runOutsideAngular(()=>dc(this.elementRef.nativeElement,"scroll").pipe(ar(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=n.scrollHeight-n.clientHeight-t.bottom),r&&0!=Ah()?(null!=t.left&&(t.right=n.scrollWidth-n.clientWidth-t.left),2==Ah()?t.left=t.right:1==Ah()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=n.scrollWidth-n.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const n=this.elementRef.nativeElement;!function F6(){if(null==_a){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return _a=!1,_a;if("scrollBehavior"in document.documentElement.style)_a=!0;else{const i=Element.prototype.scrollTo;_a=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return _a}()?(null!=t.top&&(n.scrollTop=t.top),null!=t.left&&(n.scrollLeft=t.left)):n.scrollTo(t)}measureScrollOffset(t){const n="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:n:"end"==t&&(t=o?n:r),o&&2==Ah()?t==n?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==Ah()?t==n?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==n?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return i.\u0275fac=function(t){return new(t||i)(we(Sn),we(qw),we(St),we(yN,8))},i.\u0275dir=an({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),i})(),iz=(()=>{class i{constructor(t,n,r){this._platform=t,this._change=new Ee,this._changeListener=s=>{this._change.next(s)},this._document=r,n.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||n.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(mN(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(t){return new(t||i)(Re(Ns),Re(St),Re(Nt,8))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),wN=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({}),i})();const vN=new oa("13.0.2");function SN(i){return si((e,t)=>i<=t)}function AN(i,e=J){return i=null!=i?i:hz,ae((t,n)=>{let r,s=!0;t.subscribe(new he(n,o=>{const a=e(o);(s||!i(r,a))&&(s=!1,r=a,n.next(o))}))})}function hz(i,e){return i===e}let RN=(()=>{class i{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function pz(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const n=function gz(i){try{return i.frameElement}catch(e){return null}}(function bz(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(t));if(n&&(-1===ON(n)||!this.isVisible(n)))return!1;let r=t.nodeName.toLowerCase(),s=ON(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function Sz(i){let e=i.nodeName.toLowerCase(),t="input"===e&&i.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,n){return function Az(i){return!function yz(i){return function wz(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function mz(i){let e=i.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(i)||function Ez(i){return function vz(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||TN(i))}(t)&&!this.isDisabled(t)&&((null==n?void 0:n.ignoreVisibility)||this.isVisible(t))}}return i.\u0275fac=function(t){return new(t||i)(Re(Ns))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function TN(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let e=i.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function ON(i){if(!TN(i))return null;const e=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class Cz{constructor(e,t,n,r,s=!1){this._element=e,this._checker=t,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);for(let n=0;n<t.length;n++)t[n].hasAttribute(`cdk-focus-${e}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[n]):t[n].hasAttribute(`cdk-focus-region-${e}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[n]);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),!this._checker.isFocusable(t)){const n=this._getFirstTabbableElement(t);return null==n||n.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=0;n<t.length;n++){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=t.length-1;n>=0;n--){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Dr(1)).subscribe(e)}}let Rz=(()=>{class i{constructor(t,n,r){this._checker=t,this._ngZone=n,this._document=r}create(t,n=!1){return new Cz(t,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(t){return new(t||i)(Re(RN),Re(St),Re(Nt))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function IN(i){return 0===i.offsetX&&0===i.offsetY}function PN(i){const e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const Tz=new Ge("cdk-input-modality-detector-options"),Oz={ignoreKeys:[18,17,224,91,16]},Sc=Kw({passive:!0,capture:!0});let Iz=(()=>{class i{constructor(t,n,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Sr(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=bh(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(IN(o)?"keyboard":"mouse"),this._mostRecentTarget=bh(o))},this._onTouchstart=o=>{PN(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=bh(o))},this._options=Object.assign(Object.assign({},Oz),s),this.modalityDetected=this._modality.pipe(SN(1)),this.modalityChanged=this.modalityDetected.pipe(AN()),t.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Sc),r.addEventListener("mousedown",this._onMousedown,Sc),r.addEventListener("touchstart",this._onTouchstart,Sc)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Sc),document.removeEventListener("mousedown",this._onMousedown,Sc),document.removeEventListener("touchstart",this._onTouchstart,Sc))}}return i.\u0275fac=function(t){return new(t||i)(Re(Ns),Re(St),Re(Nt),Re(Tz,8))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Nz=new Ge("cdk-focus-monitor-default-options"),Sg=Kw({passive:!0,capture:!0});let _N=(()=>{class i{constructor(t,n,r,s,o){this._ngZone=t,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Ee,this._rootNodeFocusAndBlurListener=a=>{const l=bh(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,n=!1){const r=vc(t);if(!this._platform.isBrowser||1!==r.nodeType)return Ue(null);const s=function k6(i){if(function B6(){if(null==$w){const i="undefined"!=typeof document?document.head:null;$w=!(!i||!i.createShadowRoot&&!i.attachShadow)}return $w}()){const e=i.getRootNode?i.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return n&&(o.checkChildren=!0),o.subject;const a={checkChildren:n,subject:new Ee,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const n=vc(t),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(t,n,r){const s=vc(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,n,l)):(this._setOrigin(n),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused","touch"===n),t.classList.toggle("cdk-keyboard-focused","keyboard"===n),t.classList.toggle("cdk-mouse-focused","mouse"===n),t.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,n){const r=this._elementInfo.get(n),s=bh(t);!r||!r.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),r)}_onBlur(t,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(r.subject,null))}_emitOrigin(t,n){this._ngZone.run(()=>t.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const n=t.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,Sg),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,Sg)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ar(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Sg),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Sg),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,r){this._setClasses(t,n),this._emitOrigin(r.subject,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){const n=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&n.push([s,r])}),n}}return i.\u0275fac=function(t){return new(t||i)(Re(St),Re(Ns),Re(Iz),Re(Nt,8),Re(Nz,8))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const DN="cdk-high-contrast-black-on-white",xN="cdk-high-contrast-white-on-black",Qw="cdk-high-contrast-active";let _z=(()=>{class i{constructor(t,n){this._platform=t,this._document=n}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(Qw),t.remove(DN),t.remove(xN),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?(t.add(Qw),t.add(DN)):2===n&&(t.add(Qw),t.add(xN))}}}return i.\u0275fac=function(t){return new(t||i)(Re(Ns),Re(Nt))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const pt=!1;function LN(i){return new Le(3e3,pt)}function h7(){return"undefined"!=typeof window&&void 0!==window.document}function Xw(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function jo(i){switch(i.length){case 0:return new oh;case 1:return i[0];default:return new LP(i)}}function MN(i,e,t,n,r={},s={}){const o=[],a=[];let l=-1,c=null;if(n.forEach(u=>{const y=u.offset,R=y==l,D=R&&c||{};Object.keys(u).forEach(L=>{let k=L,W=u[L];if("offset"!==L)switch(k=e.normalizePropertyName(k,o),W){case"!":W=r[L];break;case so:W=s[L];break;default:W=e.normalizeStyleValue(L,k,W,o)}D[k]=W}),R||a.push(D),c=D,l=y}),o.length)throw function e7(i){return new Le(3502,pt)}();return a}function Zw(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&ev(t,"start",i)));break;case"done":i.onDone(()=>n(t&&ev(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&ev(t,"destroy",i)))}}function ev(i,e,t){const n=t.totalTime,s=tv(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,null==n?i.totalTime:n,!!t.disabled),o=i._data;return null!=o&&(s._data=o),s}function tv(i,e,t,n,r="",s=0,o){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function lr(i,e,t){let n;return i instanceof Map?(n=i.get(e),n||i.set(e,n=t)):(n=i[e],n||(n=i[e]=t)),n}function FN(i){const e=i.indexOf(":");return[i.substring(1,e),i.substr(e+1)]}let nv=(i,e)=>!1,BN=(i,e,t)=>[],kN=null;function iv(i){const e=i.parentNode||i.host;return e===kN?null:e}(Xw()||"undefined"!=typeof Element)&&(h7()?(kN=(()=>document.documentElement)(),nv=(i,e)=>{for(;e;){if(e===i)return!0;e=iv(e)}return!1}):nv=(i,e)=>i.contains(e),BN=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let Da=null,VN=!1;function GN(i){Da||(Da=function f7(){return"undefined"!=typeof document?document.body:null}()||{},VN=!!Da.style&&"WebkitAppearance"in Da.style);let e=!0;return Da.style&&!function d7(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in Da.style,!e&&VN&&(e="Webkit"+i.charAt(0).toUpperCase()+i.substr(1)in Da.style)),e}const HN=nv,YN=BN;let UN=(()=>{class i{validateStyleProperty(t){return GN(t)}matchesElement(t,n){return!1}containsElement(t,n){return HN(t,n)}getParentElement(t){return iv(t)}query(t,n,r){return YN(t,n,r)}computeStyle(t,n,r){return r||""}animate(t,n,r,s,o,a=[],l){return new oh(r,s)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})(),rv=(()=>{class i{}return i.NOOP=new UN,i})();const sv="ng-enter",bg="ng-leave",Cg="ng-trigger",Rg=".ng-trigger",jN="ng-animating",ov=".ng-animating";function xa(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:av(parseFloat(e[1]),e[2])}function av(i,e){return"s"===e?1e3*i:i}function Tg(i,e,t){return i.hasOwnProperty("duration")?i:function m7(i,e,t){let r,s=0,o="";if("string"==typeof i){const a=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(LN()),{duration:0,delay:0,easing:""};r=av(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=av(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=i;if(!t){let a=!1,l=e.length;r<0&&(e.push(function Dz(){return new Le(3100,pt)}()),a=!0),s<0&&(e.push(function xz(){return new Le(3101,pt)}()),a=!0),a&&e.splice(l,0,LN())}return{duration:r,delay:s,easing:o}}(i,e,t)}function Ac(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function zo(i,e,t={}){if(e)for(let n in i)t[n]=i[n];else Ac(i,t);return t}function KN(i,e,t){return t?e+":"+t+";":""}function $N(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=KN(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=KN(0,w7(t),i.style[t]));i.setAttribute("style",e)}function _s(i,e,t){i.style&&(Object.keys(e).forEach(n=>{const r=cv(n);t&&!t.hasOwnProperty(n)&&(t[n]=i.style[r]),i.style[r]=e[n]}),Xw()&&$N(i))}function La(i,e){i.style&&(Object.keys(e).forEach(t=>{const n=cv(t);i.style[n]=""}),Xw()&&$N(i))}function Rh(i){return Array.isArray(i)?1==i.length?i[0]:_P(i):i}const lv=new RegExp("{{\\s*(.+?)\\s*}}","g");function JN(i){let e=[];if("string"==typeof i){let t;for(;t=lv.exec(i);)e.push(t[1]);lv.lastIndex=0}return e}function Og(i,e,t){const n=i.toString(),r=n.replace(lv,(s,o)=>{let a=e[o];return e.hasOwnProperty(o)||(t.push(function Mz(i){return new Le(3003,pt)}()),a=""),a.toString()});return r==n?i:r}function Ig(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const E7=/-+([a-z0-9])/g;function cv(i){return i.replace(E7,(...e)=>e[1].toUpperCase())}function w7(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function cr(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function Fz(i){return new Le(3004,pt)}()}}function qN(i,e){return window.getComputedStyle(i)[e]}function R7(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function T7(i,e,t){if(":"==i[0]){const l=function O7(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function qz(i){return new Le(3016,pt)}()),"* => *"}}(i,t);if("function"==typeof l)return void e.push(l);i=l}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function Jz(i){return new Le(3015,pt)}()),e;const r=n[1],s=n[2],o=n[3];e.push(QN(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(QN(o,r))}(n,t,e)):t.push(i),t}const Dg=new Set(["true","1"]),xg=new Set(["false","0"]);function QN(i,e){const t=Dg.has(i)||xg.has(i),n=Dg.has(e)||xg.has(e);return(r,s)=>{let o="*"==i||i==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?Dg.has(i):xg.has(i)),!a&&n&&"boolean"==typeof s&&(a=s?Dg.has(e):xg.has(e)),o&&a}}const I7=new RegExp("s*:selfs*,?","g");function uv(i,e,t,n){return new P7(i).build(e,t,n)}class P7{constructor(e){this._driver=e}build(e,t,n){const r=new D7(t);this._resetContextStyleTimingState(r);const s=cr(this,Rh(e),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function kz(){return new Le(3006,pt)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);n+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function Vz(){return new Le(3007,pt)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=r||{};n.styles.forEach(a=>{if(Lg(a)){const l=a;Object.keys(l).forEach(c=>{JN(l[c]).forEach(u=>{o.hasOwnProperty(u)||s.add(u)})})}}),s.size&&(Ig(s.values()),t.errors.push(function Gz(i,e){return new Le(3008,pt)}()))}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=cr(this,Rh(e.animation),t);return{type:1,matchers:R7(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:Ma(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>cr(this,n,t)),options:Ma(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=n;const a=cr(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Ma(e.options)}}visitAnimate(e,t){const n=function L7(i,e){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return hv(Tg(i,e).duration,0,"");const t=i;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=hv(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=Tg(t,e);return hv(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,s=e.styles?e.styles:oc({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};n.easing&&(c.easing=n.easing),o=oc(c)}t.currentTime+=n.duration+n.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(o=>{"string"==typeof o?o==so?n.push(o):t.errors.push(function Hz(i){return new Le(3002,pt)}()):n.push(o)}):n.push(e.styles);let r=!1,s=null;return n.forEach(o=>{if(Lg(o)){const a=o,l=a.easing;if(l&&(s=l,delete a.easing),!r)for(let c in a)if(a[c].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:s,offset:e.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete o[a],void t.unsupportedCSSPropertiesFound.add(a);const l=t.collectedStyles[t.currentQuerySelector],c=l[a];let u=!0;c&&(s!=r&&s>=c.startTime&&r<=c.endTime&&(t.errors.push(function Yz(i,e,t,n,r){return new Le(3010,pt)}()),u=!1),s=c.startTime),u&&(l[a]={startTime:s,endTime:r}),t.options&&function y7(i,e,t){const n=e.params||{},r=JN(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||t.push(function Lz(i){return new Le(3001,pt)}())})}(o[a],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Uz(){return new Le(3011,pt)}()),n;let s=0;const o=[];let a=!1,l=!1,c=0;const u=e.steps.map(X=>{const ne=this._makeStyleAst(X,t);let ce=null!=ne.offset?ne.offset:function x7(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(Lg(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(Lg(i)&&i.hasOwnProperty("offset")){const t=i;e=parseFloat(t.offset),delete t.offset}return e}(ne.styles),Ae=0;return null!=ce&&(s++,Ae=ne.offset=ce),l=l||Ae<0||Ae>1,a=a||Ae<c,c=Ae,o.push(Ae),ne});l&&t.errors.push(function Wz(){return new Le(3012,pt)}()),a&&t.errors.push(function jz(){return new Le(3200,pt)}());const y=e.steps.length;let R=0;s>0&&s<y?t.errors.push(function zz(){return new Le(3202,pt)}()):0==s&&(R=1/(y-1));const D=y-1,L=t.currentTime,k=t.currentAnimateTimings,W=k.duration;return u.forEach((X,ne)=>{const ce=R>0?ne==D?1:R*ne:o[ne],Ae=ce*W;t.currentTime=L+k.delay+Ae,k.duration=Ae,this._validateStyleAst(X,t),X.offset=ce,n.styles.push(X)}),n}visitReference(e,t){return{type:8,animation:cr(this,Rh(e.animation),t),options:Ma(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Ma(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Ma(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function N7(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(I7,"")),i=i.replace(/@\*/g,Rg).replace(/@\w+/g,t=>Rg+"-"+t.substr(1)).replace(/:animating/g,ov),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,lr(t.collectedStyles,t.currentQuerySelector,{});const a=cr(this,Rh(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Ma(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function Kz(){return new Le(3013,pt)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Tg(e.timings,t.errors,!0);return{type:12,animation:cr(this,Rh(e.animation),t),timings:n,options:null}}}class D7{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Lg(i){return!Array.isArray(i)&&"object"==typeof i}function Ma(i){return i?(i=Ac(i)).params&&(i.params=function _7(i){return i?Ac(i):null}(i.params)):i={},i}function hv(i,e,t){return{duration:i,delay:e,easing:t}}function dv(i,e,t,n,r,s,o=null,a=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class Mg{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const B7=new RegExp(":enter","g"),V7=new RegExp(":leave","g");function fv(i,e,t,n,r,s={},o={},a,l,c=[]){return(new G7).buildKeyframes(i,e,t,n,r,s,o,a,l,c)}class G7{buildKeyframes(e,t,n,r,s,o,a,l,c,u=[]){c=c||new Mg;const y=new gv(e,t,c,r,s,u,[]);y.options=l,y.currentTimeline.setStyles([o],null,y.errors,l),cr(this,n,y);const R=y.timelines.filter(D=>D.containsAnimation());if(Object.keys(a).length){let D;for(let L=R.length-1;L>=0;L--){const k=R[L];if(k.element===t){D=k;break}}D&&!D.allowOnlyTimelineStyles()&&D.setStyles([a],null,y.errors,l)}return R.length?R.map(D=>D.buildKeyframes()):[dv(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?xa(n.duration):null,a=null!=n.delay?xa(n.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),cr(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Fg);const o=xa(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>cr(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?xa(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),cr(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Tg(t.params?Og(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?xa(r.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Fg);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;const y=t.createSubContext(e.options,c);s&&y.delayNextStep(s),c===t.element&&(l=y.currentTimeline),cr(this,e.animation,y),y.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,y.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=n.currentStaggerTime}const u=t.currentTimeline;l&&u.delayNextStep(l);const y=u.currentTime;cr(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-y+(r.startTime-n.currentTimeline.startTime)}}const Fg={};class gv{constructor(e,t,n,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Fg,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Bg(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=xa(n.duration)),null!=n.delay&&(r.delay=xa(n.delay));const s=n.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Og(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,s=new gv(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Fg,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},s=new H7(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(B7,"."+this._enterClassName)).replace(V7,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=n);0!==n&&(c=n<0?c.slice(c.length+n,c.length):c.slice(0,n)),a.push(...c)}return!s&&0==a.length&&o.push(function $z(i){return new Le(3014,pt)}()),a}}class Bg{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Bg(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||so,this._currentKeyframe[t]=so}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&(this._previousKeyframe.easing=t);const s=r&&r.params||{},o=function Y7(i,e){const t={};let n;return i.forEach(r=>{"*"===r?(n=n||Object.keys(e),n.forEach(s=>{t[s]=so})):zo(r,!1,t)}),t}(e,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const l=Og(o[a],s,n);this._pendingStyles[a]=l,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:so),this._updateStyle(a,l)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(n=>{this._currentKeyframe[n]=e[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],r=e._styleSummary[t];(!n||r.time>n.time)&&this._updateStyle(t,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=zo(a,!0);Object.keys(c).forEach(u=>{const y=c[u];"!"==y?e.add(u):y==so&&t.add(u)}),n||(c.offset=l/this.duration),r.push(c)});const s=e.size?Ig(e.values()):[],o=t.size?Ig(t.values()):[];if(n){const a=r[0],l=Ac(a);a.offset=0,l.offset=1,r=[a,l]}return dv(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class H7 extends Bg{constructor(e,t,n,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,l=zo(e[0],!1);l.offset=0,s.push(l);const c=zo(e[0],!1);c.offset=e_(a),s.push(c);const u=e.length-1;for(let y=1;y<=u;y++){let R=zo(e[y],!1);R.offset=e_((t+R.offset*n)/o),s.push(R)}n=o,t=0,r="",e=s}return dv(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function e_(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class pv{}class U7 extends pv{normalizePropertyName(e,t){return cv(e)}normalizeStyleValue(e,t,n,r){let s="";const o=n.toString().trim();if(W7[t]&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function Bz(i,e){return new Le(3005,pt)}())}return o+s}}const W7=(()=>function j7(i){const e={};return i.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function t_(i,e,t,n,r,s,o,a,l,c,u,y,R){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:y,errors:R}}const mv={};class n_{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function z7(i,e,t,n,r){return i.some(s=>s(e,t,n,r))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){const r=this._stateStyles["*"],s=this._stateStyles[e],o=r?r.buildStyles(t,n):{};return s?s.buildStyles(t,n):o}build(e,t,n,r,s,o,a,l,c,u){const y=[],R=this.ast.options&&this.ast.options.params||mv,L=this.buildStyles(n,a&&a.params||mv,y),k=l&&l.params||mv,W=this.buildStyles(r,k,y),X=new Set,ne=new Map,ce=new Map,Ae="void"===r,Oe={params:Object.assign(Object.assign({},R),k)},Be=u?[]:fv(e,t,this.ast.animation,s,o,L,W,Oe,c,y);let ke=0;if(Be.forEach(bt=>{ke=Math.max(bt.duration+bt.delay,ke)}),y.length)return t_(t,this._triggerName,n,r,Ae,L,W,[],[],ne,ce,ke,y);Be.forEach(bt=>{const sn=bt.element,Ci=lr(ne,sn,{});bt.preStyleProps.forEach(rs=>Ci[rs]=!0);const Dn=lr(ce,sn,{});bt.postStyleProps.forEach(rs=>Dn[rs]=!0),sn!==t&&X.add(sn)});const Yt=Ig(X.values());return t_(t,this._triggerName,n,r,Ae,L,W,Be,Yt,ne,ce,ke)}}class K7{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n={},r=Ac(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let l=o[a];l.length>1&&(l=Og(l,r,t));const c=this.normalizer.normalizePropertyName(a,t);l=this.normalizer.normalizeStyleValue(a,c,l,t),n[c]=l})}}),n}}class J7{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states={},t.states.forEach(r=>{this.states[r.name]=new K7(r.style,r.options&&r.options.params||{},n)}),i_(this.states,"true","1"),i_(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new n_(e,r,this.states))}),this.fallbackTransition=function q7(i,e,t){return new n_(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(o=>o.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function i_(i,e,t){i.hasOwnProperty(e)?i.hasOwnProperty(t)||(i[t]=i[e]):i.hasOwnProperty(t)&&(i[e]=i[t])}const Q7=new Mg;class X7{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],s=uv(this._driver,t,n,[]);if(n.length)throw function t7(i){return new Le(3503,pt)}();this._animations[e]=s}_buildPlayer(e,t,n){const r=e.element,s=MN(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],s=this._animations[e];let o;const a=new Map;if(s?(o=fv(this._driver,t,s,sv,bg,{},{},n,Q7,r),o.forEach(u=>{const y=lr(a,u.element,{});u.postStyleProps.forEach(R=>y[R]=null)})):(r.push(function n7(){return new Le(3300,pt)}()),o=[]),r.length)throw function i7(i){return new Le(3504,pt)}();a.forEach((u,y)=>{Object.keys(u).forEach(R=>{u[R]=this._driver.computeStyle(y,R,so)})});const c=jo(o.map(u=>{const y=a.get(u.element);return this._buildPlayer(u,{},y)}));return this._playersById[e]=c,c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw function r7(i){return new Le(3301,pt)}();return t}listen(e,t,n,r){const s=tv(t,"","","");return Zw(this._getPlayer(e),n,s,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const r_="ng-animate-queued",yv="ng-animate-disabled",i9=[],s_={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},r9={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Pr="__ng_removed";class Ev{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function l9(i){return null!=i?i:null}(n?e.value:e),n){const s=Ac(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(r=>{null==n[r]&&(n[r]=t[r])})}}}const Th="void",wv=new Ev(Th);class s9{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Nr(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.hasOwnProperty(t))throw function s7(i,e){return new Le(3302,pt)}();if(null==n||0==n.length)throw function o7(i){return new Le(3303,pt)}();if(!function c9(i){return"start"==i||"done"==i}(n))throw function a7(i,e){return new Le(3400,pt)}();const s=lr(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const a=lr(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(Nr(e,Cg),Nr(e,Cg+"-"+t),a[t]=wv),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw function l7(i){return new Le(3401,pt)}();return t}trigger(e,t,n,r=!0){const s=this._getTrigger(t),o=new vv(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Nr(e,Cg),Nr(e,Cg+"-"+t),this._engine.statesByElement.set(e,a={}));let l=a[t];const c=new Ev(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a[t]=c,l||(l=wv),c.value!==Th&&l.value===c.value){if(!function d9(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||i[s]!==e[s])return!1}return!0}(l.params,c.params)){const k=[],W=s.matchStyles(l.value,l.params,k),X=s.matchStyles(c.value,c.params,k);k.length?this._engine.reportError(k):this._engine.afterFlush(()=>{La(e,W),_s(e,X)})}return}const R=lr(this._engine.playersByElement,e,[]);R.forEach(k=>{k.namespaceId==this.id&&k.triggerName==t&&k.queued&&k.destroy()});let D=s.matchTransition(l.value,c.value,e,c.params),L=!1;if(!D){if(!r)return;D=s.fallbackTransition,L=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:D,fromState:l,toState:c,player:o,isFallbackTransition:L}),L||(Nr(e,r_),o.onStart(()=>{bc(e,r_)})),o.onDone(()=>{let k=this.players.indexOf(o);k>=0&&this.players.splice(k,1);const W=this._engine.playersByElement.get(e);if(W){let X=W.indexOf(o);X>=0&&W.splice(X,1)}}),this.players.push(o),R.push(o),o}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Rg,!0);n.forEach(r=>{if(r[Pr])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(l=>{if(o.set(l,s[l].value),this._triggers[l]){const c=this.trigger(e,l,Th,r);c&&a.push(c)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&jo(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers[o].fallbackTransition,c=n[o]||wv,u=new Ev(Th),y=new vv(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:u,player:y,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Pr];(!s||s===s_)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Nr(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const l=tv(s,n.triggerName,n.fromState.value,n.toState.value);l._data=e,Zw(n.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{const s=n.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class o9{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new s9(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,r=this.namespacesByHostElement,s=n.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=n.indexOf(l);n.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}}else for(let a=s;a>=0;a--)if(this.driver.containsElement(n[a].hostElement,t)){n.splice(a+1,0,e),o=!0;break}o||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const r=Object.keys(n);for(let s=0;s<r.length;s++){const o=n[r[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&t.add(a)}}}return t}trigger(e,t,n,r){if(kg(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!kg(t))return;const s=t[Pr];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Nr(e,yv)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),bc(e,yv))}removeNode(e,t,n,r){if(kg(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r,s){this.collectedLeaveElements.push(t),t[Pr]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,r,s){return kg(t)?this._fetchNamespace(e).listen(t,n,r,s):()=>{}}_buildInstruction(e,t,n,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Rg,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,ov,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return jo(this.players).onDone(()=>e());e()})}processLeaveNode(e){var t;const n=e[Pr];if(n&&n.setForRemoval){if(e[Pr]=s_,n.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}(null===(t=e.classList)||void 0===t?void 0:t.contains(yv))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Nr(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?jo(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw function c7(i){return new Le(3402,pt)}()}_flushAnimations(e,t){const n=new Mg,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(xe=>{u.add(xe);const Ve=this.driver.query(xe,".ng-animate-queued",!0);for(let Ke=0;Ke<Ve.length;Ke++)u.add(Ve[Ke])});const y=this.bodyNode,R=Array.from(this.statesByElement.keys()),D=l_(R,this.collectedEnterElements),L=new Map;let k=0;D.forEach((xe,Ve)=>{const Ke=sv+k++;L.set(Ve,Ke),xe.forEach(At=>Nr(At,Ke))});const W=[],X=new Set,ne=new Set;for(let xe=0;xe<this.collectedLeaveElements.length;xe++){const Ve=this.collectedLeaveElements[xe],Ke=Ve[Pr];Ke&&Ke.setForRemoval&&(W.push(Ve),X.add(Ve),Ke.hasAnimation?this.driver.query(Ve,".ng-star-inserted",!0).forEach(At=>X.add(At)):ne.add(Ve))}const ce=new Map,Ae=l_(R,Array.from(X));Ae.forEach((xe,Ve)=>{const Ke=bg+k++;ce.set(Ve,Ke),xe.forEach(At=>Nr(At,Ke))}),e.push(()=>{D.forEach((xe,Ve)=>{const Ke=L.get(Ve);xe.forEach(At=>bc(At,Ke))}),Ae.forEach((xe,Ve)=>{const Ke=ce.get(Ve);xe.forEach(At=>bc(At,Ke))}),W.forEach(xe=>{this.processLeaveNode(xe)})});const Oe=[],Be=[];for(let xe=this._namespaceList.length-1;xe>=0;xe--)this._namespaceList[xe].drainQueuedTransitions(t).forEach(Ke=>{const At=Ke.player,jn=Ke.element;if(Oe.push(At),this.collectedEnterElements.length){const Ri=jn[Pr];if(Ri&&Ri.setForMove){if(Ri.previousTriggersValues&&Ri.previousTriggersValues.has(Ke.triggerName)){const ka=Ri.previousTriggersValues.get(Ke.triggerName),qo=this.statesByElement.get(Ke.element);qo&&qo[Ke.triggerName]&&(qo[Ke.triggerName].value=ka)}return void At.destroy()}}const Ds=!y||!this.driver.containsElement(y,jn),ur=ce.get(jn),Jo=L.get(jn),Xt=this._buildInstruction(Ke,n,Jo,ur,Ds);if(Xt.errors&&Xt.errors.length)return void Be.push(Xt);if(Ds)return At.onStart(()=>La(jn,Xt.fromStyles)),At.onDestroy(()=>_s(jn,Xt.toStyles)),void r.push(At);if(Ke.isFallbackTransition)return At.onStart(()=>La(jn,Xt.fromStyles)),At.onDestroy(()=>_s(jn,Xt.toStyles)),void r.push(At);const $_=[];Xt.timelines.forEach(Ri=>{Ri.stretchStartingKeyframe=!0,this.disabledNodes.has(Ri.element)||$_.push(Ri)}),Xt.timelines=$_,n.append(jn,Xt.timelines),o.push({instruction:Xt,player:At,element:jn}),Xt.queriedElements.forEach(Ri=>lr(a,Ri,[]).push(At)),Xt.preStyleProps.forEach((Ri,ka)=>{const qo=Object.keys(Ri);if(qo.length){let Va=l.get(ka);Va||l.set(ka,Va=new Set),qo.forEach(Nv=>Va.add(Nv))}}),Xt.postStyleProps.forEach((Ri,ka)=>{const qo=Object.keys(Ri);let Va=c.get(ka);Va||c.set(ka,Va=new Set),qo.forEach(Nv=>Va.add(Nv))})});if(Be.length){const xe=[];Be.forEach(Ve=>{xe.push(function u7(i,e){return new Le(3505,pt)}())}),Oe.forEach(Ve=>Ve.destroy()),this.reportError(xe)}const ke=new Map,Yt=new Map;o.forEach(xe=>{const Ve=xe.element;n.has(Ve)&&(Yt.set(Ve,Ve),this._beforeAnimationBuild(xe.player.namespaceId,xe.instruction,ke))}),r.forEach(xe=>{const Ve=xe.element;this._getPreviousPlayers(Ve,!1,xe.namespaceId,xe.triggerName,null).forEach(At=>{lr(ke,Ve,[]).push(At),At.destroy()})});const bt=W.filter(xe=>u_(xe,l,c)),sn=new Map;a_(sn,this.driver,ne,c,so).forEach(xe=>{u_(xe,l,c)&&bt.push(xe)});const Dn=new Map;D.forEach((xe,Ve)=>{a_(Dn,this.driver,new Set(xe),l,"!")}),bt.forEach(xe=>{const Ve=sn.get(xe),Ke=Dn.get(xe);sn.set(xe,Object.assign(Object.assign({},Ve),Ke))});const rs=[],Rc=[],Tc={};o.forEach(xe=>{const{element:Ve,player:Ke,instruction:At}=xe;if(n.has(Ve)){if(u.has(Ve))return Ke.onDestroy(()=>_s(Ve,At.toStyles)),Ke.disabled=!0,Ke.overrideTotalTime(At.totalTime),void r.push(Ke);let jn=Tc;if(Yt.size>1){let ur=Ve;const Jo=[];for(;ur=ur.parentNode;){const Xt=Yt.get(ur);if(Xt){jn=Xt;break}Jo.push(ur)}Jo.forEach(Xt=>Yt.set(Xt,jn))}const Ds=this._buildAnimation(Ke.namespaceId,At,ke,s,Dn,sn);if(Ke.setRealPlayer(Ds),jn===Tc)rs.push(Ke);else{const ur=this.playersByElement.get(jn);ur&&ur.length&&(Ke.parentPlayer=jo(ur)),r.push(Ke)}}else La(Ve,At.fromStyles),Ke.onDestroy(()=>_s(Ve,At.toStyles)),Rc.push(Ke),u.has(Ve)&&r.push(Ke)}),Rc.forEach(xe=>{const Ve=s.get(xe.element);if(Ve&&Ve.length){const Ke=jo(Ve);xe.setRealPlayer(Ke)}}),r.forEach(xe=>{xe.parentPlayer?xe.syncPlayerEvents(xe.parentPlayer):xe.destroy()});for(let xe=0;xe<W.length;xe++){const Ve=W[xe],Ke=Ve[Pr];if(bc(Ve,bg),Ke&&Ke.hasAnimation)continue;let At=[];if(a.size){let Ds=a.get(Ve);Ds&&Ds.length&&At.push(...Ds);let ur=this.driver.query(Ve,ov,!0);for(let Jo=0;Jo<ur.length;Jo++){let Xt=a.get(ur[Jo]);Xt&&Xt.length&&At.push(...Xt)}}const jn=At.filter(Ds=>!Ds.destroyed);jn.length?u9(this,Ve,jn):this.processLeaveNode(Ve)}return W.length=0,rs.forEach(xe=>{this.players.push(xe),xe.onDone(()=>{xe.destroy();const Ve=this.players.indexOf(xe);this.players.splice(Ve,1)}),xe.play()}),rs}elementContainsData(e,t){let n=!1;const r=t[Pr];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==Th;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(n||r)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,u=c!==s,y=lr(n,c,[]);this._getPreviousPlayers(c,u,o,a,t.toState).forEach(D=>{const L=D.getRealPlayer();L.beforeDestroy&&L.beforeDestroy(),D.destroy(),y.push(D)})}La(s,t.fromStyles)}_buildAnimation(e,t,n,r,s,o){const a=t.triggerName,l=t.element,c=[],u=new Set,y=new Set,R=t.timelines.map(L=>{const k=L.element;u.add(k);const W=k[Pr];if(W&&W.removedBeforeQueried)return new oh(L.duration,L.delay);const X=k!==l,ne=function h9(i){const e=[];return c_(i,e),e}((n.get(k)||i9).map(ke=>ke.getRealPlayer())).filter(ke=>!!ke.element&&ke.element===k),ce=s.get(k),Ae=o.get(k),Oe=MN(0,this._normalizer,0,L.keyframes,ce,Ae),Be=this._buildPlayer(L,Oe,ne);if(L.subTimeline&&r&&y.add(k),X){const ke=new vv(e,a,k);ke.setRealPlayer(Be),c.push(ke)}return Be});c.forEach(L=>{lr(this.playersByQueriedElement,L.element,[]).push(L),L.onDone(()=>function a9(i,e,t){let n;if(i instanceof Map){if(n=i.get(e),n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&i.delete(e)}}else if(n=i[e],n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&delete i[e]}return n}(this.playersByQueriedElement,L.element,L))}),u.forEach(L=>Nr(L,jN));const D=jo(R);return D.onDestroy(()=>{u.forEach(L=>bc(L,jN)),_s(l,t.toStyles)}),y.forEach(L=>{lr(r,L,[]).push(D)}),D}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new oh(e.duration,e.delay)}}class vv{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new oh,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>Zw(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){lr(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function kg(i){return i&&1===i.nodeType}function o_(i,e){const t=i.style.display;return i.style.display=null!=e?e:"none",t}function a_(i,e,t,n,r){const s=[];t.forEach(l=>s.push(o_(l)));const o=[];n.forEach((l,c)=>{const u={};l.forEach(y=>{const R=u[y]=e.computeStyle(c,y,r);(!R||0==R.length)&&(c[Pr]=r9,o.push(c))}),i.set(c,u)});let a=0;return t.forEach(l=>o_(l,s[a++])),o}function l_(i,e){const t=new Map;if(i.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function Nr(i,e){var t;null===(t=i.classList)||void 0===t||t.add(e)}function bc(i,e){var t;null===(t=i.classList)||void 0===t||t.remove(e)}function u9(i,e,t){jo(t).onDone(()=>i.processLeaveNode(e))}function c_(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof LP?c_(n.players,e):e.push(n)}}function u_(i,e,t){const n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(s=>r.add(s)):e.set(i,n),t.delete(i),!0}class Vg{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new o9(e,t,n),this._timelineEngine=new X7(e,t,n),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,n,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],u=uv(this._driver,s,l,[]);if(l.length)throw function Zz(i,e){return new Le(3404,pt)}();a=function $7(i,e,t){return new J7(i,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[s,o]=FN(n);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,s){if("@"==n.charAt(0)){const[o,a]=FN(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let g9=(()=>{class i{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let s=i.initialStylesByElement.get(t);s||i.initialStylesByElement.set(t,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&_s(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(_s(this._element,this._initialStyles),this._endStyles&&(_s(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(La(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(La(this._element,this._endStyles),this._endStyles=null),_s(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function Sv(i){let e=null;const t=Object.keys(i);for(let n=0;n<t.length;n++){const r=t[n];p9(r)&&(e=e||{},e[r]=i[r])}return e}function p9(i){return"display"===i||"position"===i}class h_{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const t=this._finalKeyframe;Object.keys(t).forEach(n=>{"offset"!=n&&(e[n]=this._finished?t[n]:qN(this.element,n))})}this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class m9{validateStyleProperty(e){return GN(e)}matchesElement(e,t){return!1}containsElement(e,t){return HN(e,t)}getParentElement(e){return iv(e)}query(e,t,n){return YN(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,r,s,o=[]){const l={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c={},u=o.filter(R=>R instanceof h_);(function v7(i,e){return 0===i||0===e})(n,r)&&u.forEach(R=>{let D=R.currentSnapshot;Object.keys(D).forEach(L=>c[L]=D[L])}),t=function S7(i,e,t){const n=Object.keys(t);if(n.length&&e.length){let s=e[0],o=[];if(n.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=t[a]}),o.length)for(var r=1;r<e.length;r++){let a=e[r];o.forEach(function(l){a[l]=qN(i,l)})}}return e}(e,t=t.map(R=>zo(R,!1)),c);const y=function f9(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=Sv(e[0]),e.length>1&&(n=Sv(e[e.length-1]))):e&&(t=Sv(e)),t||n?new g9(i,t,n):null}(e,t);return new h_(e,t,l,y)}}let y9=(()=>{class i extends PP{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:Lr.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?_P(t):t;return d_(this._renderer,null,n,"register",[r]),new E9(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(Re(hu),Re(Nt))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();class E9 extends class FW{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new w9(this._id,e,t||{},this._renderer)}}class w9{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return d_(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function d_(i,e,t,n,r){return i.setProperty(e,`@@${t}:${n}`,r)}const f_="@.disabled";let v9=(()=>{class i{constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,n){const s=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let u=this._rendererCache.get(s);return u||(u=new g_("",s,this.engine),this._rendererCache.set(s,u)),u}const o=n.id,a=n.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(o,a,t,u.name,u)};return n.data.animation.forEach(l),new S9(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){t>=0&&t<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(Re(hu),Re(Vg),Re(St))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();class g_{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?r=>t.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==f_?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class S9 extends g_{constructor(e,t,n,r){super(t,n,r),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==f_?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function A9(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let s=t.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function b9(i){const e=i.indexOf(".");return[i.substring(0,e),i.substr(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let C9=(()=>{class i extends Vg{constructor(t,n,r){super(t.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(Re(Nt),Re(rv),Re(pv))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();const Oh=new Ge("AnimationModuleType"),p_=[{provide:PP,useClass:y9},{provide:pv,useFactory:function R9(){return new U7}},{provide:Vg,useClass:C9},{provide:hu,useFactory:function T9(i,e,t){return new v9(i,e,t)},deps:[tf,Vg,St]}],m_=[{provide:rv,useFactory:()=>new m9},{provide:Oh,useValue:"BrowserAnimations"},...p_],O9=[{provide:rv,useClass:UN},{provide:Oh,useValue:"NoopAnimations"},...p_];let I9=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?O9:m_}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({providers:m_,imports:[XT]}),i})();const y_=new oa("13.0.2"),N9=new Ge("mat-sanity-checks",{providedIn:"root",factory:function P9(){return!0}});let _r=(()=>{class i{constructor(t,n,r){this._hasDoneGlobalChecks=!1,this._document=r,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=n,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!(!function y2(){return hT=!0,uT}()||function V6(){return"undefined"!=typeof __karma__&&!!__karma__||"undefined"!=typeof jasmine&&!!jasmine||"undefined"!=typeof jest&&!!jest||"undefined"!=typeof Mocha&&!!Mocha}())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const n=getComputedStyle(t);n&&"none"!==n.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),t.remove()}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&y_.full!==vN.full&&console.warn("The Angular Material version ("+y_.full+") does not match the Angular CDK version ("+vN.full+").\nPlease ensure the versions of these two packages exactly match.")}}return i.\u0275fac=function(t){return new(t||i)(Re(_z),Re(N9,8),Re(Nt))},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[EN],EN]}),i})();function _9(i){return class extends i{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=is(e)}}}function Av(i,e){return class extends i{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}function D9(i){return class extends i{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=is(e)}}}class L9{constructor(e,t,n){this._renderer=e,this.element=t,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const E_={enterDuration:225,exitDuration:150},bv=Kw({passive:!0}),w_=["mousedown","touchstart"],v_=["mouseup","mouseleave","touchend","touchcancel"];class F9{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=vc(n))}fadeInRipple(e,t,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},E_),n.animation);n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=n.radius||function k9(i,e,t){const n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=n.color&&(u.style.backgroundColor=n.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u),function B9(i){window.getComputedStyle(i).getPropertyValue("opacity")}(u),u.style.transform="scale(1)";const y=new L9(this,u,n);return y.state=0,this._activeRipples.add(y),n.persistent||(this._mostRecentTransientRipple=y),this._runTimeoutOutsideZone(()=>{const R=y===this._mostRecentTransientRipple;y.state=1,!n.persistent&&(!R||!this._isPointerDown)&&y.fadeOut()},c),y}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const n=e.element,r=Object.assign(Object.assign({},E_),e.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,n.remove()},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=vc(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(w_))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(v_),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=IN(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!PN(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,bv)})})}_removeTriggerEvents(){this._triggerElement&&(w_.forEach(e=>{this._triggerElement.removeEventListener(e,this,bv)}),this._pointerUpEventsRegistered&&v_.forEach(e=>{this._triggerElement.removeEventListener(e,this,bv)}))}}const V9=new Ge("mat-ripple-global-options");let S_=(()=>{class i{constructor(t,n,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new F9(this,n,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,n,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return i.\u0275fac=function(t){return new(t||i)(we(Sn),we(St),we(Ns),we(V9,8),we(Oh,8))},i.\u0275dir=an({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,n){2&t&&Mn("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),G9=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[_r,uN],_r]}),i})();function Cv(i){return de(()=>i)}const Hg=["*"];function H9(i,e){if(1&i){const t=bo();je(0,"div",2),ni("click",function(){return mr(t),lt()._onBackdropClicked()}),et()}2&i&&Mn("mat-drawer-shown",lt()._isShowingBackdrop())}function Y9(i,e){1&i&&(je(0,"mat-drawer-content"),ii(1,2),et())}const U9=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],W9=["mat-drawer","mat-drawer-content","*"];function j9(i,e){if(1&i){const t=bo();je(0,"div",2),ni("click",function(){return mr(t),lt()._onBackdropClicked()}),et()}2&i&&Mn("mat-drawer-shown",lt()._isShowingBackdrop())}function z9(i,e){1&i&&(je(0,"mat-sidenav-content",3),ii(1,2),et())}const K9=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],$9=["mat-sidenav","mat-sidenav-content","*"],A_={transformDrawer:NP("transform",[DP("open, open-instant",oc({transform:"none",visibility:"visible"})),DP("void",oc({"box-shadow":"none",visibility:"hidden"})),pw("void => open-instant",gw("0ms")),pw("void <=> open, open-instant => void",gw("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},q9=new Ge("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Q9(){return!1}}),Rv=new Ge("MAT_DRAWER_CONTAINER");let Yg=(()=>{class i extends vg{constructor(t,n,r,s,o){super(r,s,o),this._changeDetectorRef=t,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(t){return new(t||i)(we(aa),we(_c(()=>C_)),we(Sn),we(qw),we(St))},i.\u0275cmp=En({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,n){2&t&&Co("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[Us],ngContentSelectors:Hg,decls:1,vars:0,template:function(t,n){1&t&&(Yr(),ii(0))},encapsulation:2,changeDetection:0}),i})(),b_=(()=>{class i{constructor(t,n,r,s,o,a,l,c){this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=s,this._ngZone=o,this._interactivityChecker=a,this._doc=l,this._container=c,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Ee,this._animationEnd=new Ee,this._animationState="void",this.openedChange=new Mt(!0),this._openedStream=this.openedChange.pipe(si(u=>u),de(()=>{})),this.openedStart=this._animationStarted.pipe(si(u=>u.fromState!==u.toState&&0===u.toState.indexOf("open")),Cv(void 0)),this._closedStream=this.openedChange.pipe(si(u=>!u),de(()=>{})),this.closedStart=this._animationStarted.pipe(si(u=>u.fromState!==u.toState&&"void"===u.toState),Cv(void 0)),this._destroyed=new Ee,this.onPositionChanged=new Mt,this._modeChanged=new Ee,this.openedChange.subscribe(u=>{u?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{dc(this._elementRef.nativeElement,"keydown").pipe(si(u=>27===u.keyCode&&!this.disableClose&&!function uz(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}(u)),ar(this._destroyed)).subscribe(u=>this._ngZone.run(()=>{this.close(),u.stopPropagation(),u.preventDefault()}))}),this._animationEnd.pipe(AN((u,y)=>u.fromState===y.fromState&&u.toState===y.toState)).subscribe(u=>{const{fromState:y,toState:R}=u;(0===R.indexOf("open")&&"void"===y||"void"===R&&0===y.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!=this._position&&(this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=is(t)}get autoFocus(){const t=this._autoFocus;return null==t?"side"===this.mode?"dialog":"first-tabbable":t}set autoFocus(t){("true"===t||"false"===t)&&(t=is(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(is(t))}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{t.addEventListener("blur",()=>t.removeAttribute("tabindex")),t.addEventListener("mousedown",()=>t.removeAttribute("tabindex"))})),t.focus(n)}_focusByCssSelector(t,n){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){var t;const n=null===(t=this._doc)||void 0===t?void 0:t.activeElement;return!!n&&this._elementRef.nativeElement.contains(n)}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,n){t&&n&&(this._openedVia=n);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,n,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(Dr(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}}return i.\u0275fac=function(t){return new(t||i)(we(Sn),we(Rz),we(_N),we(Ns),we(St),we(RN),we(Nt,8),we(Rv,8))},i.\u0275cmp=En({type:i,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,n){1&t&&Wm("@transform.start",function(s){return n._animationStarted.next(s)})("@transform.done",function(s){return n._animationEnd.next(s)}),2&t&&(Wt("align",null),$m("@transform",n._animationState),Mn("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Hg,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(t,n){1&t&&(Yr(),je(0,"div",0),ii(1),et())},directives:[vg],encapsulation:2,data:{animation:[A_.transformDrawer]},changeDetection:0}),i})(),C_=(()=>{class i{constructor(t,n,r,s,o,a=!1,l){this._dir=t,this._element=n,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=l,this._drawers=new Dd,this.backdropClick=new Mt,this._destroyed=new Ee,this._doCheckSubject=new Ee,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Ee,t&&t.change.pipe(ar(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(ar(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=a}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=is(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:is(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(rf(this._allDrawers),ar(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(rf(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(Hw(10),ar(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();n+=r,t-=r}t=t||null,n=n||null,(t!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:t,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(si(n=>n.fromState!==n.toState),ar(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(ar(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){!t||t.onPositionChanged.pipe(ar(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Dr(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(ar(zv(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return i.\u0275fac=function(t){return new(t||i)(we(yN,8),we(Sn),we(St),we(aa),we(iz),we(q9),we(Oh,8))},i.\u0275cmp=En({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(t,n,r){if(1&t&&(zi(r,Yg,5),zi(r,b_,5)),2&t){let s;Fn(s=Bn())&&(n._content=s.first),Fn(s=Bn())&&(n._allDrawers=s)}},viewQuery:function(t,n){if(1&t&&_l(Yg,5),2&t){let r;Fn(r=Bn())&&(n._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,n){2&t&&Mn("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[ty([{provide:Rv,useExisting:i}])],ngContentSelectors:W9,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(Yr(U9),Dt(0,H9,1,2,"div",0),ii(1),ii(2,1),Dt(3,Y9,2,0,"mat-drawer-content",1)),2&t&&(rt("ngIf",n.hasBackdrop),ft(3),rt("ngIf",!n._content))},directives:[Yg,Ll],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),i})(),Tv=(()=>{class i extends Yg{constructor(t,n,r,s,o){super(t,n,r,s,o)}}return i.\u0275fac=function(t){return new(t||i)(we(aa),we(_c(()=>R_)),we(Sn),we(qw),we(St))},i.\u0275cmp=En({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,n){2&t&&Co("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[Us],ngContentSelectors:Hg,decls:1,vars:0,template:function(t,n){1&t&&(Yr(),ii(0))},encapsulation:2,changeDetection:0}),i})(),Ov=(()=>{class i extends b_{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=is(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=dN(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=dN(t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=Pp(i)))(n||i)}}(),i.\u0275cmp=En({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,n){2&t&&(Wt("align",null),Co("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),Mn("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Us],ngContentSelectors:Hg,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(t,n){1&t&&(Yr(),je(0,"div",0),ii(1),et())},directives:[vg],encapsulation:2,data:{animation:[A_.transformDrawer]},changeDetection:0}),i})(),R_=(()=>{class i extends C_{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=Pp(i)))(n||i)}}(),i.\u0275cmp=En({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(t,n,r){if(1&t&&(zi(r,Tv,5),zi(r,Ov,5)),2&t){let s;Fn(s=Bn())&&(n._content=s.first),Fn(s=Bn())&&(n._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,n){2&t&&Mn("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[ty([{provide:Rv,useExisting:i}]),Us],ngContentSelectors:$9,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],["cdkScrollable","",4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"],["cdkScrollable",""]],template:function(t,n){1&t&&(Yr(K9),Dt(0,j9,1,2,"div",0),ii(1),ii(2,1),Dt(3,z9,2,0,"mat-sidenav-content",1)),2&t&&(rt("ngIf",n.hasBackdrop),ft(3),rt("ngIf",!n._content))},directives:[Tv,Ll,vg],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),i})(),X9=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[qd,_r,uN,wN],wN,_r]}),i})();function T_(i,e){return e?t=>bu(e.pipe(Dr(1),function Z9(){return ae((i,e)=>{i.subscribe(new he(e,N))})}()),t.pipe(T_(i))):yn((t,n)=>i(t,n).pipe(Dr(1),Cv(t)))}const tK=Lh,iK=Symbol("__destroy"),O_=Symbol("__decoratorApplied");function I_(i){return"string"==typeof i?Symbol(`__destroy__${i}`):iK}function P_(i,e){i[e]||(i[e]=new Ee)}function N_(i,e){i[e]&&(i[e].next(),i[e].complete(),i[e]=null)}function __(i){i instanceof f&&i.unsubscribe()}function D_(i,e){return function(){var t;if(i&&i.call(this),N_(this,I_()),e.arrayName&&function sK(i){Array.isArray(i)&&i.forEach(__)}(this[e.arrayName]),e.checkProperties)for(const n in this)(null===(t=e.blackList)||void 0===t?void 0:t.includes(n))||__(this[n])}}function x_(i,e){return t=>{const n=I_(e);return"string"==typeof e?function cK(i,e,t){const n=i[e];P_(i,t),i[e]=function(){n.apply(this,arguments),N_(this,t),i[e]=n}}(i,e,n):P_(i,n),t.pipe(ar(i[n]))}}const L_=new Set;let Cc,uK=(()=>{class i{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):dK}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function hK(i){if(!L_.has(i))try{Cc||(Cc=document.createElement("style"),Cc.setAttribute("type","text/css"),document.head.appendChild(Cc)),Cc.sheet&&(Cc.sheet.insertRule(`@media ${i} {body{ }}`,0),L_.add(i))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return i.\u0275fac=function(t){return new(t||i)(Re(Ns))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function dK(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let fK=(()=>{class i{constructor(t,n){this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new Ee}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return M_(fN(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=rO(M_(fN(t)).map(o=>this._registerQuery(o).observable));return s=bu(s.pipe(Dr(1)),s.pipe(SN(1),Hw(0))),s.pipe(de(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const n=this._mediaMatcher.matchMedia(t),s={observable:new K(o=>{const a=l=>this._zone.run(()=>o.next(l));return n.addListener(a),()=>{n.removeListener(a)}}).pipe(rf(n),de(({matches:o})=>({query:t,matches:o})),ar(this._destroySubject)),mql:n};return this._queries.set(t,s),s}}return i.\u0275fac=function(t){return new(t||i)(Re(uK),Re(St))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function M_(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}const gK=["*",[["mat-toolbar-row"]]],pK=["*","mat-toolbar-row"],mK=Av(class{constructor(i){this._elementRef=i}});let yK=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=an({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),i})(),EK=(()=>{class i extends mK{constructor(t,n,r){super(t),this._platform=n,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return i.\u0275fac=function(t){return new(t||i)(we(Sn),we(Ns),we(Nt))},i.\u0275cmp=En({type:i,selectors:[["mat-toolbar"]],contentQueries:function(t,n,r){if(1&t&&zi(r,yK,5),2&t){let s;Fn(s=Bn())&&(n._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,n){2&t&&Mn("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",0===n._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Us],ngContentSelectors:pK,decls:2,vars:0,template:function(t,n){1&t&&(Yr(gK),ii(0),ii(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}\n"],encapsulation:2,changeDetection:0}),i})(),wK=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[_r],_r]}),i})();const vK=["mat-button",""],SK=["*"],bK=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],CK=Av(_9(D9(class{constructor(i){this._elementRef=i}})));let RK=(()=>{class i extends CK{constructor(t,n,r){super(t),this._focusMonitor=n,this._animationMode=r,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of bK)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);t.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,n){t?this._focusMonitor.focusVia(this._getHostElement(),t,n):this._getHostElement().focus(n)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(n=>this._getHostElement().hasAttribute(n))}}return i.\u0275fac=function(t){return new(t||i)(we(Sn),we(_N),we(Oh,8))},i.\u0275cmp=En({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,n){if(1&t&&_l(S_,5),2&t){let r;Fn(r=Bn())&&(n.ripple=r.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,n){2&t&&(Wt("disabled",n.disabled||null),Mn("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-button-disabled",n.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Us],attrs:vK,ngContentSelectors:SK,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,n){1&t&&(Yr(),je(0,"span",0),ii(1),et(),ti(2,"span",1)(3,"span",2)),2&t&&(ft(2),Mn("mat-button-ripple-round",n.isRoundButton||n.isIconButton),rt("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n.isIconButton)("matRippleTrigger",n._getHostElement()))},directives:[S_],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),i})(),TK=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[G9,_r],_r]}),i})();class IK{}class Ko{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const r=t.slice(0,n),s=r.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Ko?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Ko;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Ko?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class PK{encodeKey(e){return F_(e)}encodeValue(e){return F_(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const _K=/%(\d[a-f0-9])/gi,DK={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function F_(i){return encodeURIComponent(i).replace(_K,(e,t)=>{var n;return null!==(n=DK[t])&&void 0!==n?n:e})}function B_(i){return`${i}`}class $o{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new PK,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function NK(i,e){const t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new $o({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(B_(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const r=n.indexOf(B_(e.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class xK{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function k_(i){return"undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer}function V_(i){return"undefined"!=typeof Blob&&i instanceof Blob}function G_(i){return"undefined"!=typeof FormData&&i instanceof FormData}class Ph{constructor(e,t,n,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function LK(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Ko),this.context||(this.context=new xK),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new $o,this.urlWithParams=t}serializeBody(){return null===this.body?null:k_(this.body)||V_(this.body)||G_(this.body)||function MK(i){return"undefined"!=typeof URLSearchParams&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof $o?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||G_(this.body)?null:V_(this.body)?this.body.type||null:k_(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof $o?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const n=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const y=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((R,D)=>R.set(D,e.setHeaders[D]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((R,D)=>R.set(D,e.setParams[D]),u)),new Ph(n,r,o,{params:u,headers:c,context:y,reportProgress:l,responseType:s,withCredentials:a})}}var qn=(()=>((qn=qn||{})[qn.Sent=0]="Sent",qn[qn.UploadProgress=1]="UploadProgress",qn[qn.ResponseHeader=2]="ResponseHeader",qn[qn.DownloadProgress=3]="DownloadProgress",qn[qn.Response=4]="Response",qn[qn.User=5]="User",qn))();class Iv extends class FK{constructor(e,t=200,n="OK"){this.headers=e.headers||new Ko,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}{constructor(e={}){super(e),this.type=qn.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Iv({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function Pv(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let Y_=(()=>{class i{constructor(t){this.handler=t}request(t,n,r={}){let s;if(t instanceof Ph)s=t;else{let l,c;l=r.headers instanceof Ko?r.headers:new Ko(r.headers),r.params&&(c=r.params instanceof $o?r.params:new $o({fromObject:r.params})),s=new Ph(t,n,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Ue(s).pipe(Ml(l=>this.handler.handle(l)));if(t instanceof Ph||"events"===r.observe)return o;const a=o.pipe(si(l=>l instanceof Iv));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(de(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(de(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(de(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(de(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new $o).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,Pv(r,n))}post(t,n,r={}){return this.request("POST",t,Pv(r,n))}put(t,n,r={}){return this.request("PUT",t,Pv(r,n))}}return i.\u0275fac=function(t){return new(t||i)(Re(IK))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac}),i})();const kK=["*"];let Ug;function Nh(i){var e;return(null===(e=function VK(){if(void 0===Ug&&(Ug=null,"undefined"!=typeof window)){const i=window;void 0!==i.trustedTypes&&(Ug=i.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Ug}())||void 0===e?void 0:e.createHTML(i))||i}function U_(i){return Error(`Unable to find icon with the name "${i}"`)}function W_(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function j_(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class Fa{constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}}let Wg=(()=>{class i{constructor(t,n,r,s){this._httpClient=t,this._sanitizer=n,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=r}addSvgIcon(t,n,r){return this.addSvgIconInNamespace("",t,n,r)}addSvgIconLiteral(t,n,r){return this.addSvgIconLiteralInNamespace("",t,n,r)}addSvgIconInNamespace(t,n,r,s){return this._addSvgIconConfig(t,n,new Fa(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,n,r,s){const o=this._sanitizer.sanitize(Ct.HTML,r);if(!o)throw j_(r);const a=Nh(o);return this._addSvgIconConfig(t,n,new Fa("",a,s))}addSvgIconSet(t,n){return this.addSvgIconSetInNamespace("",t,n)}addSvgIconSetLiteral(t,n){return this.addSvgIconSetLiteralInNamespace("",t,n)}addSvgIconSetInNamespace(t,n,r){return this._addSvgIconSetConfig(t,new Fa(n,null,r))}addSvgIconSetLiteralInNamespace(t,n,r){const s=this._sanitizer.sanitize(Ct.HTML,n);if(!s)throw j_(n);const o=Nh(s);return this._addSvgIconSetConfig(t,new Fa("",o,r))}registerFontClassAlias(t,n=t){return this._fontCssClassesByAlias.set(t,n),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const n=this._sanitizer.sanitize(Ct.RESOURCE_URL,t);if(!n)throw W_(t);const r=this._cachedIconsByUrl.get(n);return r?Ue(jg(r)):this._loadSvgIconFromConfig(new Fa(t,null)).pipe(oi(s=>this._cachedIconsByUrl.set(n,s)),de(s=>jg(s)))}getNamedSvgIcon(t,n=""){const r=z_(n,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(n,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(n);return o?this._getSvgFromIconSetConfigs(t,o):Au(U_(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Ue(jg(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(de(n=>jg(n)))}_getSvgFromIconSetConfigs(t,n){const r=this._extractIconWithNameFromAnySet(t,n);return r?Ue(r):function OK(...i){const e=Yv(i),{args:t,keys:n}=nO(i),r=new K(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let y=!1;Bi(t[u]).subscribe(new he(s,R=>{y||(y=!0,c--),a[u]=R},()=>l--,void 0,()=>{(!l||!y)&&(c||s.next(n?iO(n,a):a),s.complete())}))}});return e?r.pipe(nE(e)):r}(n.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(Js(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(Ct.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),Ue(null)})))).pipe(de(()=>{const o=this._extractIconWithNameFromAnySet(t,n);if(!o)throw U_(t);return o}))}_extractIconWithNameFromAnySet(t,n){for(let r=n.length-1;r>=0;r--){const s=n[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(oi(n=>t.svgText=n),de(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Ue(null):this._fetchIcon(t).pipe(oi(n=>t.svgText=n))}_extractSvgIconFromSet(t,n,r){const s=t.querySelector(`[id="${n}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(Nh("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const n=this._document.createElement("DIV");n.innerHTML=t;const r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const n=this._svgElementFromString(Nh("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&n.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&n.appendChild(t.childNodes[s].cloneNode(!0));return n}_setSvgAttributes(t,n){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),n&&n.viewBox&&t.setAttribute("viewBox",n.viewBox),t}_fetchIcon(t){var n;const{url:r,options:s}=t,o=null!==(n=null==s?void 0:s.withCredentials)&&void 0!==n&&n;if(!this._httpClient)throw function GK(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const a=this._sanitizer.sanitize(Ct.RESOURCE_URL,r);if(!a)throw W_(r);const l=this._inProgressUrlFetches.get(a);if(l)return l;const c=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(de(u=>Nh(u)),hO(()=>this._inProgressUrlFetches.delete(a)),Kv());return this._inProgressUrlFetches.set(a,c),c}_addSvgIconConfig(t,n,r){return this._svgIconConfigs.set(z_(t,n),r),this}_addSvgIconSetConfig(t,n){const r=this._iconSetConfigs.get(t);return r?r.push(n):this._iconSetConfigs.set(t,[n]),this}_svgElementFromConfig(t){if(!t.svgElement){const n=this._svgElementFromString(t.svgText);this._setSvgAttributes(n,t.options),t.svgElement=n}return t.svgElement}_getIconConfigFromResolvers(t,n){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](n,t);if(s)return YK(s)?new Fa(s.url,null,s.options):new Fa(s,null)}}}return i.\u0275fac=function(t){return new(t||i)(Re(Y_,8),Re(tE),Re(Nt,8),Re(wo))},i.\u0275prov=Fe({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function jg(i){return i.cloneNode(!0)}function z_(i,e){return i+":"+e}function YK(i){return!(!i.url||!i.options)}const UK=Av(class{constructor(i){this._elementRef=i}}),WK=new Ge("mat-icon-location",{providedIn:"root",factory:function jK(){const i=id(Nt),e=i?i.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),K_=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],zK=K_.map(i=>`[${i}]`).join(", "),KK=/^url\(['"]?#(.*?)['"]?\)$/;let $K=(()=>{class i extends UK{constructor(t,n,r,s,o){super(t),this._iconRegistry=n,this._location=s,this._errorHandler=o,this._inline=!1,this._currentIconFetch=f.EMPTY,r||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=is(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const n=this._cleanupFontValue(t);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const n=this._cleanupFontValue(t);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const n=t.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const n=t.querySelectorAll("style");for(let s=0;s<n.length;s++)n[s].textContent+=" ";const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let n=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const r=t.childNodes[n];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,n=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();n!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),n&&t.classList.add(n),this._previousFontSetClass=n),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const n=this._elementsWithExternalReferences;n&&n.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const n=t.querySelectorAll(zK),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<n.length;s++)K_.forEach(o=>{const a=n[s],l=a.getAttribute(o),c=l?l.match(KK):null;if(c){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[n,r]=this._splitIconName(t);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(Dr(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${r}! ${s.message}`))})}}}return i.\u0275fac=function(t){return new(t||i)(we(Sn),we(Wg),Qa("aria-hidden"),we(WK),we(wo))},i.\u0275cmp=En({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,n){2&t&&(Wt("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet),Mn("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Us],ngContentSelectors:kK,decls:1,vars:0,template:function(t,n){1&t&&(Yr(),ii(0))},styles:[".mat-icon{-webkit-user-select:none;-moz-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),i})(),JK=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[_r],_r]}),i})(),qK=(()=>{class i{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(t){this._vertical=is(t)}get inset(){return this._inset}set inset(t){this._inset=is(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=En({type:i,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(t,n){2&t&&(Wt("aria-orientation",n.vertical?"vertical":"horizontal"),Mn("mat-divider-vertical",n.vertical)("mat-divider-horizontal",!n.vertical)("mat-divider-inset",n.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(t,n){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}\n"],encapsulation:2,changeDetection:0}),i})(),QK=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i}),i.\u0275inj=on({imports:[[_r],_r]}),i})();function XK(i,e){1&i&&(je(0,"mat-icon"),ri(1," menu "),et())}function ZK(i,e){1&i&&(je(0,"mat-icon"),ri(1," close "),et())}function e$(i,e){if(1&i){const t=bo();je(0,"button",9),ni("click",function(){return mr(t),lt(),vd(6).toggle()}),Dt(1,XK,2,0,"mat-icon",10),Dt(2,ZK,2,0,"mat-icon",10),et()}if(2&i){lt();const t=vd(6);ft(1),rt("ngIf",!t.opened),ft(1),rt("ngIf",t.opened)}}let Ba=class{constructor(e,t){this.observer=e,this.router=t}ngAfterViewInit(){this.observer.observe(["(max-width: 800px)"]).pipe(function eK(i,e=Gw){const t=pN(i,e);return T_(()=>t)}(1),x_(this)).subscribe(e=>{e.matches?(this.sidenav.mode="over",this.sidenav.close()):(this.sidenav.mode="side",this.sidenav.open())}),this.router.events.pipe(x_(this),si(e=>e instanceof Fl)).subscribe(()=>{"over"===this.sidenav.mode&&this.sidenav.close()})}};Ba.\u0275fac=function(e){return new(e||Ba)(we(fK),we(_i))},Ba.\u0275cmp=En({type:Ba,selectors:[["app-root"]],viewQuery:function(e,t){if(1&e&&_l(Ov,5),2&e){let n;Fn(n=Bn())&&(t.sidenav=n.first)}},decls:28,vars:1,consts:[[1,"mat-elevation-z8"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"menuTitle"],["sidenav","matSidenav"],["src","https://avatars.githubusercontent.com/u/76245280?s=200&v=4",1,"avatar","mat-elevation-z8"],["mat-button","","routerLink","/home",1,"menu-button"],["mat-button","","routerLink","/example",1,"menu-button"],["mat-button","","routerLink","/help",1,"menu-button"],[1,"content","mat-elevation-z8"],["mat-icon-button","",3,"click"],[4,"ngIf"]],template:function(e,t){if(1&e&&(je(0,"mat-toolbar",0),Dt(1,e$,3,2,"button",1),je(2,"span",2),ri(3,"ngx-msagl"),et()(),je(4,"mat-sidenav-container")(5,"mat-sidenav",0,3),ti(7,"img",4)(8,"mat-divider"),je(9,"button",5)(10,"mat-icon"),ri(11,"home"),et(),je(12,"span"),ri(13,"Home"),et()(),je(14,"button",6)(15,"mat-icon"),ri(16,"graphic_eq"),et(),je(17,"span"),ri(18,"Example"),et()(),ti(19,"mat-divider"),je(20,"button",7)(21,"mat-icon"),ri(22,"help"),et(),je(23,"span"),ri(24,"Help"),et()()(),je(25,"mat-sidenav-content")(26,"div",8),ti(27,"router-outlet"),et()()()),2&e){const n=vd(6);ft(1),rt("ngIf","over"===n.mode)}},directives:[EK,Ll,RK,$K,R_,Ov,qK,vf,Tv,mE],styles:["mat-toolbar[_ngcontent-%COMP%]{background-color:#1f233e;color:#fff;height:36px}mat-toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#1f233e;color:#fff}.menuTitle[_ngcontent-%COMP%]{font-size:24px}mat-sidenav[_ngcontent-%COMP%]{width:200px;height:100%;border-right:none;background-color:#1f233e;color:#fff;padding:16px;text-align:center;border-right:1px solid white}.content[_ngcontent-%COMP%]{height:calc(100vh - 36px);background:lightgrey;overflow:hidden}mat-sidenav-container[_ngcontent-%COMP%]{height:calc(100vh - 36px)}.menu-button[_ngcontent-%COMP%]{width:100%;display:flex;background-color:#1f233e;color:#fff;align-items:center;justify-content:flex-start;font-size:1rem}.menu-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.avatar[_ngcontent-%COMP%]{margin-top:16px;width:100px;height:100px;border-radius:50%}mat-divider[_ngcontent-%COMP%]{margin-top:16px;margin-bottom:16px;background-color:#ffffff80}"]}),Ba=(0,IP.__decorate)([function lK(i={}){return e=>{!function nK(i){return!!i[tK]}(e)?function oK(i,e){i.prototype.ngOnDestroy=D_(i.prototype.ngOnDestroy,e)}(e,i):function aK(i,e){const t=i.\u0275pipe;t.onDestroy=D_(t.onDestroy,e)}(e,i),function rK(i){i.prototype[O_]=!0}(e)}}()],Ba);let t$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=wn({type:i,bootstrap:[Ba]}),i.\u0275inj=on({providers:[],imports:[[XT,L6,I9,wK,X9,TK,JK,QK,I6]]}),i})();(function E2(){if(hT)throw new Error("Cannot enable prod mode after platform setup.");uT=!1})(),xG().bootstrapModule(t$).catch(i=>console.error(i))},9695:(_,I,h)=>{_.exports={graphlib:h(6456),layout:h(4850),debug:h(1914),util:{time:h(1510).time,notime:h(1510).notime},version:h(8126)}},2234:(_,I,h)=>{"use strict";var p=h(5760),T=h(7365);_.exports={run:function C(b){var d="greedy"===b.graph().acyclicer?T(b,function f(S){return function(g){return S.edge(g).weight}}(b)):function v(b){var d=[],f={},S={};return p.forEach(b.nodes(),function g(w){p.has(S,w)||(S[w]=!0,f[w]=!0,p.forEach(b.outEdges(w),function(m){p.has(f,m.w)?d.push(m):g(m.w)}),delete f[w])}),d}(b);p.forEach(d,function(S){var g=b.edge(S);b.removeEdge(S),g.forwardName=S.name,g.reversed=!0,b.setEdge(S.w,S.v,g,p.uniqueId("rev"))})},undo:function E(b){p.forEach(b.edges(),function(d){var f=b.edge(d);if(f.reversed){b.removeEdge(d);var S=f.forwardName;delete f.reversed,delete f.forwardName,b.setEdge(d.w,d.v,f,S)}})}}},9999:(_,I,h)=>{var p=h(5760),T=h(1510);function v(E,b,d,f,S,g){var m=S[b][g-1],O=T.addDummyNode(E,"border",{width:0,height:0,rank:g,borderType:b},d);S[b][g]=O,E.setParent(O,f),m&&E.setEdge(m,O,{weight:1})}_.exports=function C(E){p.forEach(E.children(),function b(d){var f=E.children(d),S=E.node(d);if(f.length&&p.forEach(f,b),p.has(S,"minRank")){S.borderLeft=[],S.borderRight=[];for(var g=S.minRank,w=S.maxRank+1;g<w;++g)v(E,"borderLeft","_bl",d,S,g),v(E,"borderRight","_br",d,S,g)}})}},3870:(_,I,h)=>{"use strict";var p=h(5760);function v(g){p.forEach(g.nodes(),function(w){E(g.node(w))}),p.forEach(g.edges(),function(w){E(g.edge(w))})}function E(g){var w=g.width;g.width=g.height,g.height=w}function d(g){g.y=-g.y}function S(g){var w=g.x;g.x=g.y,g.y=w}_.exports={adjust:function T(g){var w=g.graph().rankdir.toLowerCase();("lr"===w||"rl"===w)&&v(g)},undo:function C(g){var w=g.graph().rankdir.toLowerCase();("bt"===w||"rl"===w)&&function b(g){p.forEach(g.nodes(),function(w){d(g.node(w))}),p.forEach(g.edges(),function(w){var m=g.edge(w);p.forEach(m.points,d),p.has(m,"y")&&d(m)})}(g),("lr"===w||"rl"===w)&&(function f(g){p.forEach(g.nodes(),function(w){S(g.node(w))}),p.forEach(g.edges(),function(w){var m=g.edge(w);p.forEach(m.points,S),p.has(m,"x")&&S(m)})}(g),v(g))}}},3226:_=>{function I(){var T={};T._next=T._prev=T,this._sentinel=T}function h(T){T._prev._next=T._next,T._next._prev=T._prev,delete T._next,delete T._prev}function p(T,C){if("_next"!==T&&"_prev"!==T)return C}_.exports=I,I.prototype.dequeue=function(){var T=this._sentinel,C=T._prev;if(C!==T)return h(C),C},I.prototype.enqueue=function(T){var C=this._sentinel;T._prev&&T._next&&h(T),T._next=C._next,C._next._prev=T,C._next=T,T._prev=C},I.prototype.toString=function(){for(var T=[],C=this._sentinel,v=C._prev;v!==C;)T.push(JSON.stringify(v,p)),v=v._prev;return"["+T.join(", ")+"]"}},1914:(_,I,h)=>{var p=h(5760),T=h(1510),C=h(6456).Graph;_.exports={debugOrdering:function v(E){var b=T.buildLayerMatrix(E),d=new C({compound:!0,multigraph:!0}).setGraph({});return p.forEach(E.nodes(),function(f){d.setNode(f,{label:f}),d.setParent(f,"layer"+E.node(f).rank)}),p.forEach(E.edges(),function(f){d.setEdge(f.v,f.w,{},f.name)}),p.forEach(b,function(f,S){d.setNode("layer"+S,{rank:"same"}),p.reduce(f,function(w,m){return d.setEdge(w,m,{style:"invis"}),m})}),d}}},6456:(_,I,h)=>{var p;try{p=h(5510)}catch(T){}p||(p=window.graphlib),_.exports=p},7365:(_,I,h)=>{var p=h(5760),T=h(6456).Graph,C=h(3226);_.exports=function E(g,w){if(g.nodeCount()<=1)return[];var m=function f(g,w){var m=new T,O=0,P=0;p.forEach(g.nodes(),function(B){m.setNode(B,{v:B,in:0,out:0})}),p.forEach(g.edges(),function(B){var Y=m.edge(B.v,B.w)||0,F=w(B);m.setEdge(B.v,B.w,Y+F),P=Math.max(P,m.node(B.v).out+=F),O=Math.max(O,m.node(B.w).in+=F)});var N=p.range(P+O+3).map(function(){return new C}),M=O+1;return p.forEach(m.nodes(),function(B){S(N,M,m.node(B))}),{graph:m,buckets:N,zeroIdx:M}}(g,w||v),O=function b(g,w,m){for(var M,O=[],P=w[w.length-1],N=w[0];g.nodeCount();){for(;M=N.dequeue();)d(g,w,m,M);for(;M=P.dequeue();)d(g,w,m,M);if(g.nodeCount())for(var B=w.length-2;B>0;--B)if(M=w[B].dequeue()){O=O.concat(d(g,w,m,M,!0));break}}return O}(m.graph,m.buckets,m.zeroIdx);return p.flatten(p.map(O,function(P){return g.outEdges(P.v,P.w)}),!0)};var v=p.constant(1);function d(g,w,m,O,P){var N=P?[]:void 0;return p.forEach(g.inEdges(O.v),function(M){var B=g.edge(M),Y=g.node(M.v);P&&N.push({v:M.v,w:M.w}),Y.out-=B,S(w,m,Y)}),p.forEach(g.outEdges(O.v),function(M){var B=g.edge(M),F=g.node(M.w);F.in-=B,S(w,m,F)}),g.removeNode(O.v),N}function S(g,w,m){m.out?m.in?g[m.out-m.in+w].enqueue(m):g[g.length-1].enqueue(m):g[0].enqueue(m)}},4850:(_,I,h)=>{"use strict";var p=h(5760),T=h(2234),C=h(1496),v=h(4124),E=h(1510).normalizeRanks,b=h(162),d=h(1510).removeEmptyRanks,f=h(1230),S=h(9999),g=h(3870),w=h(2974),m=h(8226),O=h(1510),P=h(6456).Graph;_.exports=function N(ae,he){var de=he&&he.debugTiming?O.time:O.notime;de("layout",function(){var ue=de("  buildLayoutGraph",function(){return function j(ae){var he=new P({multigraph:!0,compound:!0}),de=Me(ae.graph());return he.setGraph(p.merge({},F,be(de,Y),p.pick(de,$))),p.forEach(ae.nodes(),function(ue){var Se=Me(ae.node(ue));he.setNode(ue,p.defaults(be(Se,Q),ie)),he.setParent(ue,ae.parent(ue))}),p.forEach(ae.edges(),function(ue){var Se=Me(ae.edge(ue));he.setEdge(ue,p.merge({},re,be(Se,ee),p.pick(Se,U)))}),he}(ae)});de("  runLayout",function(){!function M(ae,he){he("    makeSpaceForEdgeLabels",function(){!function V(ae){var he=ae.graph();he.ranksep/=2,p.forEach(ae.edges(),function(de){var ue=ae.edge(de);ue.minlen*=2,"c"!==ue.labelpos.toLowerCase()&&("TB"===he.rankdir||"BT"===he.rankdir?ue.width+=ue.labeloffset:ue.height+=ue.labeloffset)})}(ae)}),he("    removeSelfEdges",function(){!function pe(ae){p.forEach(ae.edges(),function(he){if(he.v===he.w){var de=ae.node(he.v);de.selfEdges||(de.selfEdges=[]),de.selfEdges.push({e:he,label:ae.edge(he)}),ae.removeEdge(he)}})}(ae)}),he("    acyclic",function(){T.run(ae)}),he("    nestingGraph.run",function(){f.run(ae)}),he("    rank",function(){v(O.asNonCompoundGraph(ae))}),he("    injectEdgeLabelProxies",function(){!function G(ae){p.forEach(ae.edges(),function(he){var de=ae.edge(he);if(de.width&&de.height){var ue=ae.node(he.v),Se=ae.node(he.w);O.addDummyNode(ae,"edge-proxy",{rank:(Se.rank-ue.rank)/2+ue.rank,e:he},"_ep")}})}(ae)}),he("    removeEmptyRanks",function(){d(ae)}),he("    nestingGraph.cleanup",function(){f.cleanup(ae)}),he("    normalizeRanks",function(){E(ae)}),he("    assignRankMinMax",function(){!function H(ae){var he=0;p.forEach(ae.nodes(),function(de){var ue=ae.node(de);ue.borderTop&&(ue.minRank=ae.node(ue.borderTop).rank,ue.maxRank=ae.node(ue.borderBottom).rank,he=p.max(he,ue.maxRank))}),ae.graph().maxRank=he}(ae)}),he("    removeEdgeLabelProxies",function(){!function J(ae){p.forEach(ae.nodes(),function(he){var de=ae.node(he);"edge-proxy"===de.dummy&&(ae.edge(de.e).labelRank=de.rank,ae.removeNode(he))})}(ae)}),he("    normalize.run",function(){C.run(ae)}),he("    parentDummyChains",function(){b(ae)}),he("    addBorderSegments",function(){S(ae)}),he("    order",function(){w(ae)}),he("    insertSelfEdges",function(){!function ye(ae){var he=O.buildLayerMatrix(ae);p.forEach(he,function(de){var ue=0;p.forEach(de,function(Se,Pe){var qe=ae.node(Se);qe.order=Pe+ue,p.forEach(qe.selfEdges,function(dt){O.addDummyNode(ae,"selfedge",{width:dt.label.width,height:dt.label.height,rank:qe.rank,order:Pe+ ++ue,e:dt.e,label:dt.label},"_se")}),delete qe.selfEdges})})}(ae)}),he("    adjustCoordinateSystem",function(){g.adjust(ae)}),he("    position",function(){m(ae)}),he("    positionSelfEdges",function(){!function Ee(ae){p.forEach(ae.nodes(),function(he){var de=ae.node(he);if("selfedge"===de.dummy){var ue=ae.node(de.e.v),Se=ue.x+ue.width/2,Pe=ue.y,qe=de.x-Se,dt=ue.height/2;ae.setEdge(de.e,de.label),ae.removeNode(he),de.label.points=[{x:Se+2*qe/3,y:Pe-dt},{x:Se+5*qe/6,y:Pe-dt},{x:Se+qe,y:Pe},{x:Se+5*qe/6,y:Pe+dt},{x:Se+2*qe/3,y:Pe+dt}],de.label.x=de.x,de.label.y=de.y}})}(ae)}),he("    removeBorderNodes",function(){!function ge(ae){p.forEach(ae.nodes(),function(he){if(ae.children(he).length){var de=ae.node(he),ue=ae.node(de.borderTop),Se=ae.node(de.borderBottom),Pe=ae.node(p.last(de.borderLeft)),qe=ae.node(p.last(de.borderRight));de.width=Math.abs(qe.x-Pe.x),de.height=Math.abs(Se.y-ue.y),de.x=Pe.x+de.width/2,de.y=ue.y+de.height/2}}),p.forEach(ae.nodes(),function(he){"border"===ae.node(he).dummy&&ae.removeNode(he)})}(ae)}),he("    normalize.undo",function(){C.undo(ae)}),he("    fixupEdgeLabelCoords",function(){!function K(ae){p.forEach(ae.edges(),function(he){var de=ae.edge(he);if(p.has(de,"x"))switch(("l"===de.labelpos||"r"===de.labelpos)&&(de.width-=de.labeloffset),de.labelpos){case"l":de.x-=de.width/2+de.labeloffset;break;case"r":de.x+=de.width/2+de.labeloffset}})}(ae)}),he("    undoCoordinateSystem",function(){g.undo(ae)}),he("    translateGraph",function(){!function se(ae){var he=Number.POSITIVE_INFINITY,de=0,ue=Number.POSITIVE_INFINITY,Se=0,Pe=ae.graph(),qe=Pe.marginx||0,dt=Pe.marginy||0;function Ti(mn){var xn=mn.x,wt=mn.y,ss=mn.width,vt=mn.height;he=Math.min(he,xn-ss/2),de=Math.max(de,xn+ss/2),ue=Math.min(ue,wt-vt/2),Se=Math.max(Se,wt+vt/2)}p.forEach(ae.nodes(),function(mn){Ti(ae.node(mn))}),p.forEach(ae.edges(),function(mn){var xn=ae.edge(mn);p.has(xn,"x")&&Ti(xn)}),he-=qe,ue-=dt,p.forEach(ae.nodes(),function(mn){var xn=ae.node(mn);xn.x-=he,xn.y-=ue}),p.forEach(ae.edges(),function(mn){var xn=ae.edge(mn);p.forEach(xn.points,function(wt){wt.x-=he,wt.y-=ue}),p.has(xn,"x")&&(xn.x-=he),p.has(xn,"y")&&(xn.y-=ue)}),Pe.width=de-he+qe,Pe.height=Se-ue+dt}(ae)}),he("    assignNodeIntersects",function(){!function z(ae){p.forEach(ae.edges(),function(he){var Pe,qe,de=ae.edge(he),ue=ae.node(he.v),Se=ae.node(he.w);de.points?(Pe=de.points[0],qe=de.points[de.points.length-1]):(de.points=[],Pe=Se,qe=ue),de.points.unshift(O.intersectRect(ue,Pe)),de.points.push(O.intersectRect(Se,qe))})}(ae)}),he("    reversePoints",function(){!function le(ae){p.forEach(ae.edges(),function(he){var de=ae.edge(he);de.reversed&&de.points.reverse()})}(ae)}),he("    acyclic.undo",function(){T.undo(ae)})}(ue,de)}),de("  updateInputGraph",function(){!function B(ae,he){p.forEach(ae.nodes(),function(de){var ue=ae.node(de),Se=he.node(de);ue&&(ue.x=Se.x,ue.y=Se.y,he.children(de).length&&(ue.width=Se.width,ue.height=Se.height))}),p.forEach(ae.edges(),function(de){var ue=ae.edge(de),Se=he.edge(de);ue.points=Se.points,p.has(Se,"x")&&(ue.x=Se.x,ue.y=Se.y)}),ae.graph().width=he.graph().width,ae.graph().height=he.graph().height}(ae,ue)})})};var Y=["nodesep","edgesep","ranksep","marginx","marginy"],F={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},$=["acyclicer","ranker","rankdir","align"],Q=["width","height"],ie={width:0,height:0},ee=["minlen","weight","width","height","labeloffset"],re={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},U=["labelpos"];function be(ae,he){return p.mapValues(p.pick(ae,he),Number)}function Me(ae){var he={};return p.forEach(ae,function(de,ue){he[ue.toLowerCase()]=de}),he}},5760:(_,I,h)=>{var p;try{p={cloneDeep:h(733),constant:h(6684),defaults:h(8800),each:h(5474),filter:h(5281),find:h(2516),flatten:h(2274),forEach:h(9851),forIn:h(1176),has:h(4842),isUndefined:h(4235),last:h(5809),map:h(9984),mapValues:h(203),max:h(8176),merge:h(567),min:h(9439),minBy:h(9525),now:h(1710),pick:h(6372),range:h(361),reduce:h(1337),sortBy:h(2906),uniqueId:h(1541),values:h(377),zipObject:h(1617)}}catch(T){}p||(p=window._),_.exports=p},1230:(_,I,h)=>{var p=h(5760),T=h(1510);function v(f,S,g,w,m,O,P){var N=f.children(P);if(N.length){var M=T.addBorderNode(f,"_bt"),B=T.addBorderNode(f,"_bb"),Y=f.node(P);f.setParent(M,P),Y.borderTop=M,f.setParent(B,P),Y.borderBottom=B,p.forEach(N,function(F){v(f,S,g,w,m,O,F);var $=f.node(F),Q=$.borderTop?$.borderTop:F,ie=$.borderBottom?$.borderBottom:F,ee=$.borderTop?w:2*w,re=Q!==ie?1:m-O[P]+1;f.setEdge(M,Q,{weight:ee,minlen:re,nestingEdge:!0}),f.setEdge(ie,B,{weight:ee,minlen:re,nestingEdge:!0})}),f.parent(P)||f.setEdge(S,M,{weight:0,minlen:m+O[P]})}else P!==S&&f.setEdge(S,P,{weight:0,minlen:g})}_.exports={run:function C(f){var S=T.addDummyNode(f,"root",{},"_root"),g=function E(f){var S={};function g(w,m){var O=f.children(w);O&&O.length&&p.forEach(O,function(P){g(P,m+1)}),S[w]=m}return p.forEach(f.children(),function(w){g(w,1)}),S}(f),w=p.max(p.values(g))-1,m=2*w+1;f.graph().nestingRoot=S,p.forEach(f.edges(),function(P){f.edge(P).minlen*=m});var O=function b(f){return p.reduce(f.edges(),function(S,g){return S+f.edge(g).weight},0)}(f)+1;p.forEach(f.children(),function(P){v(f,S,m,O,w,g,P)}),f.graph().nodeRankFactor=m},cleanup:function d(f){var S=f.graph();f.removeNode(S.nestingRoot),delete S.nestingRoot,p.forEach(f.edges(),function(g){f.edge(g).nestingEdge&&f.removeEdge(g)})}}},1496:(_,I,h)=>{"use strict";var p=h(5760),T=h(1510);_.exports={run:function C(b){b.graph().dummyChains=[],p.forEach(b.edges(),function(d){!function v(b,d){var f=d.v,S=b.node(f).rank,g=d.w,w=b.node(g).rank,m=d.name,O=b.edge(d),P=O.labelRank;if(w!==S+1){var N,M,B;for(b.removeEdge(d),B=0,++S;S<w;++B,++S)O.points=[],N=T.addDummyNode(b,"edge",M={width:0,height:0,edgeLabel:O,edgeObj:d,rank:S},"_d"),S===P&&(M.width=O.width,M.height=O.height,M.dummy="edge-label",M.labelpos=O.labelpos),b.setEdge(f,N,{weight:O.weight},m),0===B&&b.graph().dummyChains.push(N),f=N;b.setEdge(f,g,{weight:O.weight},m)}}(b,d)})},undo:function E(b){p.forEach(b.graph().dummyChains,function(d){var g,f=b.node(d),S=f.edgeLabel;for(b.setEdge(f.edgeObj,S);f.dummy;)g=b.successors(d)[0],b.removeNode(d),S.points.push({x:f.x,y:f.y}),"edge-label"===f.dummy&&(S.x=f.x,S.y=f.y,S.width=f.width,S.height=f.height),f=b.node(d=g)})}}},3034:(_,I,h)=>{var p=h(5760);_.exports=function T(C,v,E){var d,b={};p.forEach(E,function(f){for(var g,w,S=C.parent(f);S;){if((g=C.parent(S))?(w=b[g],b[g]=S):(w=d,d=S),w&&w!==S)return void v.setEdge(w,S);S=g}})}},1323:(_,I,h)=>{var p=h(5760);_.exports=function T(C,v){return p.map(v,function(E){var b=C.inEdges(E);if(b.length){var d=p.reduce(b,function(f,S){var g=C.edge(S),w=C.node(S.v);return{sum:f.sum+g.weight*w.order,weight:f.weight+g.weight}},{sum:0,weight:0});return{v:E,barycenter:d.sum/d.weight,weight:d.weight}}return{v:E}})}},1686:(_,I,h)=>{var p=h(5760),T=h(6456).Graph;_.exports=function C(E,b,d){var f=function v(E){for(var b;E.hasNode(b=p.uniqueId("_root")););return b}(E),S=new T({compound:!0}).setGraph({root:f}).setDefaultNodeLabel(function(g){return E.node(g)});return p.forEach(E.nodes(),function(g){var w=E.node(g),m=E.parent(g);(w.rank===b||w.minRank<=b&&b<=w.maxRank)&&(S.setNode(g),S.setParent(g,m||f),p.forEach(E[d](g),function(O){var P=O.v===g?O.w:O.v,N=S.edge(P,g),M=p.isUndefined(N)?0:N.weight;S.setEdge(P,g,{weight:E.edge(O).weight+M})}),p.has(w,"minRank")&&S.setNode(g,{borderLeft:w.borderLeft[b],borderRight:w.borderRight[b]}))}),S}},8796:(_,I,h)=>{"use strict";var p=h(5760);function C(v,E,b){for(var d=p.zipObject(b,p.map(b,function(O,P){return P})),f=p.flatten(p.map(E,function(O){return p.sortBy(p.map(v.outEdges(O),function(P){return{pos:d[P.w],weight:v.edge(P).weight}}),"pos")}),!0),S=1;S<b.length;)S<<=1;var g=2*S-1;S-=1;var w=p.map(new Array(g),function(){return 0}),m=0;return p.forEach(f.forEach(function(O){var P=O.pos+S;w[P]+=O.weight;for(var N=0;P>0;)P%2&&(N+=w[P+1]),w[P=P-1>>1]+=O.weight;m+=O.weight*N})),m}_.exports=function T(v,E){for(var b=0,d=1;d<E.length;++d)b+=C(v,E[d-1],E[d]);return b}},2974:(_,I,h)=>{"use strict";var p=h(5760),T=h(9402),C=h(8796),v=h(1057),E=h(1686),b=h(3034),d=h(6456).Graph,f=h(1510);function g(O,P,N){return p.map(P,function(M){return E(O,M,N)})}function w(O,P){var N=new d;p.forEach(O,function(M){var B=M.graph().root,Y=v(M,B,N,P);p.forEach(Y.vs,function(F,$){M.node(F).order=$}),b(M,N,Y.vs)})}function m(O,P){p.forEach(P,function(N){p.forEach(N,function(M,B){O.node(M).order=B})})}_.exports=function S(O){var P=f.maxRank(O),N=g(O,p.range(1,P+1),"inEdges"),M=g(O,p.range(P-1,-1,-1),"outEdges"),B=T(O);m(O,B);for(var F,Y=Number.POSITIVE_INFINITY,$=0,Q=0;Q<4;++$,++Q){w($%2?N:M,$%4>=2),B=f.buildLayerMatrix(O);var ie=C(O,B);ie<Y&&(Q=0,F=p.cloneDeep(B),Y=ie)}m(O,F)}},9402:(_,I,h)=>{"use strict";var p=h(5760);_.exports=function T(C){var v={},E=p.filter(C.nodes(),function(g){return!C.children(g).length}),b=p.max(p.map(E,function(g){return C.node(g).rank})),d=p.map(p.range(b+1),function(){return[]}),S=p.sortBy(E,function(g){return C.node(g).rank});return p.forEach(S,function f(g){if(!p.has(v,g)){v[g]=!0;var w=C.node(g);d[w.rank].push(g),p.forEach(C.successors(g),f)}}),d}},3826:(_,I,h)=>{"use strict";var p=h(5760);_.exports=function T(E,b){var d={};return p.forEach(E,function(S,g){var w=d[S.v]={indegree:0,in:[],out:[],vs:[S.v],i:g};p.isUndefined(S.barycenter)||(w.barycenter=S.barycenter,w.weight=S.weight)}),p.forEach(b.edges(),function(S){var g=d[S.v],w=d[S.w];!p.isUndefined(g)&&!p.isUndefined(w)&&(w.indegree++,g.out.push(d[S.w]))}),function C(E){var b=[];function d(g){return function(w){w.merged||(p.isUndefined(w.barycenter)||p.isUndefined(g.barycenter)||w.barycenter>=g.barycenter)&&function v(E,b){var d=0,f=0;E.weight&&(d+=E.barycenter*E.weight,f+=E.weight),b.weight&&(d+=b.barycenter*b.weight,f+=b.weight),E.vs=b.vs.concat(E.vs),E.barycenter=d/f,E.weight=f,E.i=Math.min(b.i,E.i),b.merged=!0}(g,w)}}function f(g){return function(w){w.in.push(g),0==--w.indegree&&E.push(w)}}for(;E.length;){var S=E.pop();b.push(S),p.forEach(S.in.reverse(),d(S)),p.forEach(S.out,f(S))}return p.map(p.filter(b,function(g){return!g.merged}),function(g){return p.pick(g,["vs","i","barycenter","weight"])})}(p.filter(d,function(S){return!S.indegree}))}},1057:(_,I,h)=>{var p=h(5760),T=h(1323),C=h(3826),v=h(3803);_.exports=function E(f,S,g,w){var m=f.children(S),O=f.node(S),P=O?O.borderLeft:void 0,N=O?O.borderRight:void 0,M={};P&&(m=p.filter(m,function(ie){return ie!==P&&ie!==N}));var B=T(f,m);p.forEach(B,function(ie){if(f.children(ie.v).length){var ee=E(f,ie.v,g,w);M[ie.v]=ee,p.has(ee,"barycenter")&&function d(f,S){p.isUndefined(f.barycenter)?(f.barycenter=S.barycenter,f.weight=S.weight):(f.barycenter=(f.barycenter*f.weight+S.barycenter*S.weight)/(f.weight+S.weight),f.weight+=S.weight)}(ie,ee)}});var Y=C(B,g);!function b(f,S){p.forEach(f,function(g){g.vs=p.flatten(g.vs.map(function(w){return S[w]?S[w].vs:w}),!0)})}(Y,M);var F=v(Y,w);if(P&&(F.vs=p.flatten([P,F.vs,N],!0),f.predecessors(P).length)){var $=f.node(f.predecessors(P)[0]),Q=f.node(f.predecessors(N)[0]);p.has(F,"barycenter")||(F.barycenter=0,F.weight=0),F.barycenter=(F.barycenter*F.weight+$.order+Q.order)/(F.weight+2),F.weight+=2}return F}},3803:(_,I,h)=>{var p=h(5760),T=h(1510);function v(b,d,f){for(var S;d.length&&(S=p.last(d)).i<=f;)d.pop(),b.push(S.vs),f++;return f}_.exports=function C(b,d){var f=T.partition(b,function(M){return p.has(M,"barycenter")}),S=f.lhs,g=p.sortBy(f.rhs,function(M){return-M.i}),w=[],m=0,O=0,P=0;S.sort(function E(b){return function(d,f){return d.barycenter<f.barycenter?-1:d.barycenter>f.barycenter?1:b?f.i-d.i:d.i-f.i}}(!!d)),P=v(w,g,P),p.forEach(S,function(M){P+=M.vs.length,w.push(M.vs),m+=M.barycenter*M.weight,O+=M.weight,P=v(w,g,P)});var N={vs:p.flatten(w,!0)};return O&&(N.barycenter=m/O,N.weight=O),N}},162:(_,I,h)=>{var p=h(5760);_.exports=function T(E){var b=function v(E){var b={},d=0;return p.forEach(E.children(),function f(S){var g=d;p.forEach(E.children(S),f),b[S]={low:g,lim:d++}}),b}(E);p.forEach(E.graph().dummyChains,function(d){for(var f=E.node(d),S=f.edgeObj,g=function C(E,b,d,f){var O,P,S=[],g=[],w=Math.min(b[d].low,b[f].low),m=Math.max(b[d].lim,b[f].lim);O=d;do{O=E.parent(O),S.push(O)}while(O&&(b[O].low>w||m>b[O].lim));for(P=O,O=f;(O=E.parent(O))!==P;)g.push(O);return{path:S.concat(g.reverse()),lca:P}}(E,b,S.v,S.w),w=g.path,m=g.lca,O=0,P=w[O],N=!0;d!==S.w;){if(f=E.node(d),N){for(;(P=w[O])!==m&&E.node(P).maxRank<f.rank;)O++;P===m&&(N=!1)}if(!N){for(;O<w.length-1&&E.node(P=w[O+1]).minRank<=f.rank;)O++;P=w[O]}E.setParent(d,P),d=E.successors(d)[0]}})}},4058:(_,I,h)=>{"use strict";var p=h(5760),T=h(6456).Graph,C=h(1510);function v(Y,F){var $={};return p.reduce(F,function Q(ie,ee){var re=0,U=0,j=ie.length,V=p.last(ee);return p.forEach(ee,function(G,H){var J=function b(Y,F){if(Y.node(F).dummy)return p.find(Y.predecessors(F),function($){return Y.node($).dummy})}(Y,G),se=J?Y.node(J).order:j;(J||G===V)&&(p.forEach(ee.slice(U,H+1),function(z){p.forEach(Y.predecessors(z),function(K){var le=Y.node(K),ge=le.order;(ge<re||se<ge)&&(!le.dummy||!Y.node(z).dummy)&&d($,K,z)})}),U=H+1,re=se)}),ee}),$}function E(Y,F){var $={};function Q(ee,re,U,j,V){var G;p.forEach(p.range(re,U),function(H){Y.node(G=ee[H]).dummy&&p.forEach(Y.predecessors(G),function(J){var se=Y.node(J);se.dummy&&(se.order<j||se.order>V)&&d($,J,G)})})}return p.reduce(F,function ie(ee,re){var j,U=-1,V=0;return p.forEach(re,function(G,H){if("border"===Y.node(G).dummy){var J=Y.predecessors(G);J.length&&(j=Y.node(J[0]).order,Q(re,V,H,U,j),V=H,U=j)}Q(re,V,re.length,j,ee.length)}),re}),$}function d(Y,F,$){if(F>$){var Q=F;F=$,$=Q}var ie=Y[F];ie||(Y[F]=ie={}),ie[$]=!0}function f(Y,F,$){if(F>$){var Q=F;F=$,$=Q}return p.has(Y[F],$)}function S(Y,F,$,Q){var ie={},ee={},re={};return p.forEach(F,function(U){p.forEach(U,function(j,V){ie[j]=j,ee[j]=j,re[j]=V})}),p.forEach(F,function(U){var j=-1;p.forEach(U,function(V){var G=Q(V);if(G.length)for(var H=((G=p.sortBy(G,function(K){return re[K]})).length-1)/2,J=Math.floor(H),se=Math.ceil(H);J<=se;++J){var z=G[J];ee[V]===V&&j<re[z]&&!f($,V,z)&&(ee[z]=V,ee[V]=ie[V]=ie[z],j=re[z])}})}),{root:ie,align:ee}}function g(Y,F,$,Q,ie){var ee={},re=function w(Y,F,$,Q){var ie=new T,ee=Y.graph(),re=function M(Y,F,$){return function(Q,ie,ee){var V,re=Q.node(ie),U=Q.node(ee),j=0;if(j+=re.width/2,p.has(re,"labelpos"))switch(re.labelpos.toLowerCase()){case"l":V=-re.width/2;break;case"r":V=re.width/2}if(V&&(j+=$?V:-V),V=0,j+=(re.dummy?F:Y)/2,j+=(U.dummy?F:Y)/2,j+=U.width/2,p.has(U,"labelpos"))switch(U.labelpos.toLowerCase()){case"l":V=U.width/2;break;case"r":V=-U.width/2}return V&&(j+=$?V:-V),V=0,j}}(ee.nodesep,ee.edgesep,Q);return p.forEach(F,function(U){var j;p.forEach(U,function(V){var G=$[V];if(ie.setNode(G),j){var H=$[j],J=ie.edge(H,G);ie.setEdge(H,G,Math.max(re(Y,V,j),J||0))}j=V})}),ie}(Y,F,$,ie),U=ie?"borderLeft":"borderRight";function j(H,J){for(var se=re.nodes(),z=se.pop(),K={};z;)K[z]?H(z):(K[z]=!0,se.push(z),se=se.concat(J(z))),z=se.pop()}return j(function V(H){ee[H]=re.inEdges(H).reduce(function(J,se){return Math.max(J,ee[se.v]+re.edge(se))},0)},re.predecessors.bind(re)),j(function G(H){var J=re.outEdges(H).reduce(function(z,K){return Math.min(z,ee[K.w]-re.edge(K))},Number.POSITIVE_INFINITY),se=Y.node(H);J!==Number.POSITIVE_INFINITY&&se.borderType!==U&&(ee[H]=Math.max(ee[H],J))},re.successors.bind(re)),p.forEach(Q,function(H){ee[H]=ee[$[H]]}),ee}function m(Y,F){return p.minBy(p.values(F),function($){var Q=Number.NEGATIVE_INFINITY,ie=Number.POSITIVE_INFINITY;return p.forIn($,function(ee,re){var U=function B(Y,F){return Y.node(F).width}(Y,re)/2;Q=Math.max(ee+U,Q),ie=Math.min(ee-U,ie)}),Q-ie})}function O(Y,F){var $=p.values(F),Q=p.min($),ie=p.max($);p.forEach(["u","d"],function(ee){p.forEach(["l","r"],function(re){var V,U=ee+re,j=Y[U];if(j!==F){var G=p.values(j);(V="l"===re?Q-p.min(G):ie-p.max(G))&&(Y[U]=p.mapValues(j,function(H){return H+V}))}})})}function P(Y,F){return p.mapValues(Y.ul,function($,Q){if(F)return Y[F.toLowerCase()][Q];var ie=p.sortBy(p.map(Y,Q));return(ie[1]+ie[2])/2})}_.exports={positionX:function N(Y){var ie,F=C.buildLayerMatrix(Y),$=p.merge(v(Y,F),E(Y,F)),Q={};p.forEach(["u","d"],function(re){ie="u"===re?F:p.values(F).reverse(),p.forEach(["l","r"],function(U){"r"===U&&(ie=p.map(ie,function(H){return p.values(H).reverse()}));var j=("u"===re?Y.predecessors:Y.successors).bind(Y),V=S(0,ie,$,j),G=g(Y,ie,V.root,V.align,"r"===U);"r"===U&&(G=p.mapValues(G,function(H){return-H})),Q[re+U]=G})});var ee=m(Y,Q);return O(Q,ee),P(Q,Y.graph().align)},findType1Conflicts:v,findType2Conflicts:E,addConflict:d,hasConflict:f,verticalAlignment:S,horizontalCompaction:g,alignCoordinates:O,findSmallestWidthAlignment:m,balance:P}},8226:(_,I,h)=>{"use strict";var p=h(5760),T=h(1510),C=h(4058).positionX;_.exports=function v(b){(function E(b){var d=T.buildLayerMatrix(b),f=b.graph().ranksep,S=0;p.forEach(d,function(g){var w=p.max(p.map(g,function(m){return b.node(m).height}));p.forEach(g,function(m){b.node(m).y=S+w/2}),S+=w+f})})(b=T.asNonCompoundGraph(b)),p.forEach(C(b),function(d,f){b.node(f).x=d})}},6632:(_,I,h)=>{"use strict";var p=h(5760),T=h(6456).Graph,C=h(1916).slack;function E(f,S){return p.forEach(f.nodes(),function g(w){p.forEach(S.nodeEdges(w),function(m){var O=m.v,P=w===O?m.w:O;!f.hasNode(P)&&!C(S,m)&&(f.setNode(P,{}),f.setEdge(w,P,{}),g(P))})}),f.nodeCount()}function b(f,S){return p.minBy(S.edges(),function(g){if(f.hasNode(g.v)!==f.hasNode(g.w))return C(S,g)})}function d(f,S,g){p.forEach(f.nodes(),function(w){S.node(w).rank+=g})}_.exports=function v(f){var m,O,S=new T({directed:!1}),g=f.nodes()[0],w=f.nodeCount();for(S.setNode(g,{});E(S,f)<w;)m=b(S,f),O=S.hasNode(m.v)?C(f,m):-C(f,m),d(S,f,O);return S}},4124:(_,I,h)=>{"use strict";var T=h(1916).longestPath,C=h(6632),v=h(3804);_.exports=function E(S){switch(S.graph().ranker){case"network-simplex":default:!function f(S){v(S)}(S);break;case"tight-tree":!function d(S){T(S),C(S)}(S);break;case"longest-path":b(S)}};var b=T},3804:(_,I,h)=>{"use strict";var p=h(5760),T=h(6632),C=h(1916).slack,v=h(1916).longestPath,E=h(6456).alg.preorder,b=h(6456).alg.postorder,d=h(1510).simplify;function f($){$=d($),v($);var ie,Q=T($);for(m(Q),S(Q,$);ie=P(Q);)M(Q,$,ie,N(Q,$,ie))}function S($,Q){var ie=b($,$.nodes());ie=ie.slice(0,ie.length-1),p.forEach(ie,function(ee){!function g($,Q,ie){var ee=$.node(ie);$.edge(ie,ee.parent).cutvalue=w($,Q,ie)}($,Q,ee)})}function w($,Q,ie){var re=$.node(ie).parent,U=!0,j=Q.edge(ie,re),V=0;return j||(U=!1,j=Q.edge(re,ie)),V=j.weight,p.forEach(Q.nodeEdges(ie),function(G){var H=G.v===ie,J=H?G.w:G.v;if(J!==re){var se=H===U,z=Q.edge(G).weight;if(V+=se?z:-z,function Y($,Q,ie){return $.hasEdge(Q,ie)}($,ie,J)){var K=$.edge(ie,J).cutvalue;V+=se?-K:K}}}),V}function m($,Q){arguments.length<2&&(Q=$.nodes()[0]),O($,{},1,Q)}function O($,Q,ie,ee,re){var U=ie,j=$.node(ee);return Q[ee]=!0,p.forEach($.neighbors(ee),function(V){p.has(Q,V)||(ie=O($,Q,ie,V,ee))}),j.low=U,j.lim=ie++,re?j.parent=re:delete j.parent,ie}function P($){return p.find($.edges(),function(Q){return $.edge(Q).cutvalue<0})}function N($,Q,ie){var ee=ie.v,re=ie.w;Q.hasEdge(ee,re)||(ee=ie.w,re=ie.v);var U=$.node(ee),j=$.node(re),V=U,G=!1;U.lim>j.lim&&(V=j,G=!0);var H=p.filter(Q.edges(),function(J){return G===F(0,$.node(J.v),V)&&G!==F(0,$.node(J.w),V)});return p.minBy(H,function(J){return C(Q,J)})}function M($,Q,ie,ee){$.removeEdge(ie.v,ie.w),$.setEdge(ee.v,ee.w,{}),m($),S($,Q),function B($,Q){var ie=p.find($.nodes(),function(re){return!Q.node(re).parent}),ee=E($,ie);ee=ee.slice(1),p.forEach(ee,function(re){var U=$.node(re).parent,j=Q.edge(re,U),V=!1;j||(j=Q.edge(U,re),V=!0),Q.node(re).rank=Q.node(U).rank+(V?j.minlen:-j.minlen)})}($,Q)}function F($,Q,ie){return ie.low<=Q.lim&&Q.lim<=ie.lim}_.exports=f,f.initLowLimValues=m,f.initCutValues=S,f.calcCutValue=w,f.leaveEdge=P,f.enterEdge=N,f.exchangeEdges=M},1916:(_,I,h)=>{"use strict";var p=h(5760);_.exports={longestPath:function T(v){var E={};p.forEach(v.sources(),function b(d){var f=v.node(d);if(p.has(E,d))return f.rank;E[d]=!0;var S=p.min(p.map(v.outEdges(d),function(g){return b(g.w)-v.edge(g).minlen}));return(S===Number.POSITIVE_INFINITY||null==S)&&(S=0),f.rank=S})},slack:function C(v,E){return v.node(E.w).rank-v.node(E.v).rank-v.edge(E).minlen}}},1510:(_,I,h)=>{"use strict";var p=h(5760),T=h(6456).Graph;function C(B,Y,F,$){var Q;do{Q=p.uniqueId($)}while(B.hasNode(Q));return F.dummy=Y,B.setNode(Q,F),Q}function O(B){return p.max(p.map(B.nodes(),function(Y){var F=B.node(Y).rank;if(!p.isUndefined(F))return F}))}_.exports={addDummyNode:C,simplify:function v(B){var Y=(new T).setGraph(B.graph());return p.forEach(B.nodes(),function(F){Y.setNode(F,B.node(F))}),p.forEach(B.edges(),function(F){var $=Y.edge(F.v,F.w)||{weight:0,minlen:1},Q=B.edge(F);Y.setEdge(F.v,F.w,{weight:$.weight+Q.weight,minlen:Math.max($.minlen,Q.minlen)})}),Y},asNonCompoundGraph:function E(B){var Y=new T({multigraph:B.isMultigraph()}).setGraph(B.graph());return p.forEach(B.nodes(),function(F){B.children(F).length||Y.setNode(F,B.node(F))}),p.forEach(B.edges(),function(F){Y.setEdge(F,B.edge(F))}),Y},successorWeights:function b(B){var Y=p.map(B.nodes(),function(F){var $={};return p.forEach(B.outEdges(F),function(Q){$[Q.w]=($[Q.w]||0)+B.edge(Q).weight}),$});return p.zipObject(B.nodes(),Y)},predecessorWeights:function d(B){var Y=p.map(B.nodes(),function(F){var $={};return p.forEach(B.inEdges(F),function(Q){$[Q.v]=($[Q.v]||0)+B.edge(Q).weight}),$});return p.zipObject(B.nodes(),Y)},intersectRect:function f(B,Y){var U,j,F=B.x,$=B.y,Q=Y.x-F,ie=Y.y-$,ee=B.width/2,re=B.height/2;if(!Q&&!ie)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(ie)*ee>Math.abs(Q)*re?(ie<0&&(re=-re),U=re*Q/ie,j=re):(Q<0&&(ee=-ee),U=ee,j=ee*ie/Q),{x:F+U,y:$+j}},buildLayerMatrix:function S(B){var Y=p.map(p.range(O(B)+1),function(){return[]});return p.forEach(B.nodes(),function(F){var $=B.node(F),Q=$.rank;p.isUndefined(Q)||(Y[Q][$.order]=F)}),Y},normalizeRanks:function g(B){var Y=p.min(p.map(B.nodes(),function(F){return B.node(F).rank}));p.forEach(B.nodes(),function(F){var $=B.node(F);p.has($,"rank")&&($.rank-=Y)})},removeEmptyRanks:function w(B){var Y=p.min(p.map(B.nodes(),function(ie){return B.node(ie).rank})),F=[];p.forEach(B.nodes(),function(ie){var ee=B.node(ie).rank-Y;F[ee]||(F[ee]=[]),F[ee].push(ie)});var $=0,Q=B.graph().nodeRankFactor;p.forEach(F,function(ie,ee){p.isUndefined(ie)&&ee%Q!=0?--$:$&&p.forEach(ie,function(re){B.node(re).rank+=$})})},addBorderNode:function m(B,Y,F,$){var Q={width:0,height:0};return arguments.length>=4&&(Q.rank=F,Q.order=$),C(B,"border",Q,Y)},maxRank:O,partition:function P(B,Y){var F={lhs:[],rhs:[]};return p.forEach(B,function($){Y($)?F.lhs.push($):F.rhs.push($)}),F},time:function N(B,Y){var F=p.now();try{return Y()}finally{console.log(B+" time: "+(p.now()-F)+"ms")}},notime:function M(B,Y){return Y()}}},8126:_=>{_.exports="0.8.5"},5510:(_,I,h)=>{var p=h(1838);_.exports={Graph:p.Graph,json:h(1088),alg:h(3430),version:p.version}},6730:(_,I,h)=>{var p=h(9138);_.exports=function T(C){var b,v={},E=[];function d(f){p.has(v,f)||(v[f]=!0,b.push(f),p.each(C.successors(f),d),p.each(C.predecessors(f),d))}return p.each(C.nodes(),function(f){b=[],d(f),b.length&&E.push(b)}),E}},2163:(_,I,h)=>{var p=h(9138);function C(v,E,b,d,f,S){p.has(d,E)||(d[E]=!0,b||S.push(E),p.each(f(E),function(g){C(v,g,b,d,f,S)}),b&&S.push(E))}_.exports=function T(v,E,b){p.isArray(E)||(E=[E]);var d=(v.isDirected()?v.successors:v.neighbors).bind(v),f=[],S={};return p.each(E,function(g){if(!v.hasNode(g))throw new Error("Graph does not have node: "+g);C(v,g,"post"===b,S,d,f)}),f}},5668:(_,I,h)=>{var p=h(1718),T=h(9138);_.exports=function C(v,E,b){return T.transform(v.nodes(),function(d,f){d[f]=p(v,f,E,b)},{})}},1718:(_,I,h)=>{var p=h(9138),T=h(1919);_.exports=function v(b,d,f,S){return function E(b,d,f,S){var m,O,g={},w=new T,P=function(N){var M=N.v!==m?N.v:N.w,B=g[M],Y=f(N),F=O.distance+Y;if(Y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+N+" Weight: "+Y);F<B.distance&&(B.distance=F,B.predecessor=m,w.decrease(M,F))};for(b.nodes().forEach(function(N){var M=N===d?0:Number.POSITIVE_INFINITY;g[N]={distance:M},w.add(N,M)});w.size()>0&&(m=w.removeMin(),(O=g[m]).distance!==Number.POSITIVE_INFINITY);)S(m).forEach(P);return g}(b,String(d),f||C,S||function(g){return b.outEdges(g)})};var C=p.constant(1)},9611:(_,I,h)=>{var p=h(9138),T=h(3585);_.exports=function C(v){return p.filter(T(v),function(E){return E.length>1||1===E.length&&v.hasEdge(E[0],E[0])})}},2881:(_,I,h)=>{var p=h(9138);_.exports=function C(E,b,d){return function v(E,b,d){var f={},S=E.nodes();return S.forEach(function(g){f[g]={},f[g][g]={distance:0},S.forEach(function(w){g!==w&&(f[g][w]={distance:Number.POSITIVE_INFINITY})}),d(g).forEach(function(w){var m=w.v===g?w.w:w.v,O=b(w);f[g][m]={distance:O,predecessor:g}})}),S.forEach(function(g){var w=f[g];S.forEach(function(m){var O=f[m];S.forEach(function(P){var M=w[P],B=O[P],Y=O[g].distance+M.distance;Y<B.distance&&(B.distance=Y,B.predecessor=M.predecessor)})})}),f}(E,b||T,d||function(f){return E.outEdges(f)})};var T=p.constant(1)},3430:(_,I,h)=>{_.exports={components:h(6730),dijkstra:h(1718),dijkstraAll:h(5668),findCycles:h(9611),floydWarshall:h(2881),isAcyclic:h(6693),postorder:h(6694),preorder:h(5330),prim:h(6823),tarjan:h(3585),topsort:h(2180)}},6693:(_,I,h)=>{var p=h(2180);_.exports=function T(C){try{p(C)}catch(v){if(v instanceof p.CycleException)return!1;throw v}return!0}},6694:(_,I,h)=>{var p=h(2163);_.exports=function T(C,v){return p(C,v,"post")}},5330:(_,I,h)=>{var p=h(2163);_.exports=function T(C,v){return p(C,v,"pre")}},6823:(_,I,h)=>{var p=h(9138),T=h(6568),C=h(1919);_.exports=function v(E,b){var g,d=new T,f={},S=new C;function w(O){var P=O.v===g?O.w:O.v,N=S.priority(P);if(void 0!==N){var M=b(O);M<N&&(f[P]=g,S.decrease(P,M))}}if(0===E.nodeCount())return d;p.each(E.nodes(),function(O){S.add(O,Number.POSITIVE_INFINITY),d.setNode(O)}),S.decrease(E.nodes()[0],0);for(var m=!1;S.size()>0;){if(g=S.removeMin(),p.has(f,g))d.setEdge(g,f[g]);else{if(m)throw new Error("Input graph is not connected: "+E);m=!0}E.nodeEdges(g).forEach(w)}return d}},3585:(_,I,h)=>{var p=h(9138);_.exports=function T(C){var v=0,E=[],b={},d=[];function f(S){var g=b[S]={onStack:!0,lowlink:v,index:v++};if(E.push(S),C.successors(S).forEach(function(O){p.has(b,O)?b[O].onStack&&(g.lowlink=Math.min(g.lowlink,b[O].index)):(f(O),g.lowlink=Math.min(g.lowlink,b[O].lowlink))}),g.lowlink===g.index){var m,w=[];do{m=E.pop(),b[m].onStack=!1,w.push(m)}while(S!==m);d.push(w)}}return C.nodes().forEach(function(S){p.has(b,S)||f(S)}),d}},2180:(_,I,h)=>{var p=h(9138);function T(v){var E={},b={},d=[];if(p.each(v.sinks(),function f(S){if(p.has(b,S))throw new C;p.has(E,S)||(b[S]=!0,E[S]=!0,p.each(v.predecessors(S),f),delete b[S],d.push(S))}),p.size(E)!==v.nodeCount())throw new C;return d}function C(){}_.exports=T,T.CycleException=C,C.prototype=new Error},1919:(_,I,h)=>{var p=h(9138);function T(){this._arr=[],this._keyIndices={}}_.exports=T,T.prototype.size=function(){return this._arr.length},T.prototype.keys=function(){return this._arr.map(function(C){return C.key})},T.prototype.has=function(C){return p.has(this._keyIndices,C)},T.prototype.priority=function(C){var v=this._keyIndices[C];if(void 0!==v)return this._arr[v].priority},T.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},T.prototype.add=function(C,v){var E=this._keyIndices;if(C=String(C),!p.has(E,C)){var b=this._arr,d=b.length;return E[C]=d,b.push({key:C,priority:v}),this._decrease(d),!0}return!1},T.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var C=this._arr.pop();return delete this._keyIndices[C.key],this._heapify(0),C.key},T.prototype.decrease=function(C,v){var E=this._keyIndices[C];if(v>this._arr[E].priority)throw new Error("New priority is greater than current priority. Key: "+C+" Old: "+this._arr[E].priority+" New: "+v);this._arr[E].priority=v,this._decrease(E)},T.prototype._heapify=function(C){var v=this._arr,E=2*C,b=E+1,d=C;E<v.length&&(d=v[E].priority<v[d].priority?E:d,b<v.length&&(d=v[b].priority<v[d].priority?b:d),d!==C&&(this._swap(C,d),this._heapify(d)))},T.prototype._decrease=function(C){for(var b,v=this._arr,E=v[C].priority;0!==C&&!(v[b=C>>1].priority<E);)this._swap(C,b),C=b},T.prototype._swap=function(C,v){var E=this._arr,b=this._keyIndices,d=E[C],f=E[v];E[C]=f,E[v]=d,b[f.key]=C,b[d.key]=v}},6568:(_,I,h)=>{"use strict";var p=h(9138);_.exports=E;var C="\0";function E(w){this._isDirected=!p.has(w,"directed")||w.directed,this._isMultigraph=!!p.has(w,"multigraph")&&w.multigraph,this._isCompound=!!p.has(w,"compound")&&w.compound,this._label=void 0,this._defaultNodeLabelFn=p.constant(void 0),this._defaultEdgeLabelFn=p.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[C]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function b(w,m){w[m]?w[m]++:w[m]=1}function d(w,m){--w[m]||delete w[m]}function f(w,m,O,P){var N=""+m,M=""+O;if(!w&&N>M){var B=N;N=M,M=B}return N+"\x01"+M+"\x01"+(p.isUndefined(P)?"\0":P)}function S(w,m,O,P){var N=""+m,M=""+O;if(!w&&N>M){var B=N;N=M,M=B}var Y={v:N,w:M};return P&&(Y.name=P),Y}function g(w,m){return f(w,m.v,m.w,m.name)}E.prototype._nodeCount=0,E.prototype._edgeCount=0,E.prototype.isDirected=function(){return this._isDirected},E.prototype.isMultigraph=function(){return this._isMultigraph},E.prototype.isCompound=function(){return this._isCompound},E.prototype.setGraph=function(w){return this._label=w,this},E.prototype.graph=function(){return this._label},E.prototype.setDefaultNodeLabel=function(w){return p.isFunction(w)||(w=p.constant(w)),this._defaultNodeLabelFn=w,this},E.prototype.nodeCount=function(){return this._nodeCount},E.prototype.nodes=function(){return p.keys(this._nodes)},E.prototype.sources=function(){var w=this;return p.filter(this.nodes(),function(m){return p.isEmpty(w._in[m])})},E.prototype.sinks=function(){var w=this;return p.filter(this.nodes(),function(m){return p.isEmpty(w._out[m])})},E.prototype.setNodes=function(w,m){var O=arguments,P=this;return p.each(w,function(N){O.length>1?P.setNode(N,m):P.setNode(N)}),this},E.prototype.setNode=function(w,m){return p.has(this._nodes,w)?(arguments.length>1&&(this._nodes[w]=m),this):(this._nodes[w]=arguments.length>1?m:this._defaultNodeLabelFn(w),this._isCompound&&(this._parent[w]=C,this._children[w]={},this._children[C][w]=!0),this._in[w]={},this._preds[w]={},this._out[w]={},this._sucs[w]={},++this._nodeCount,this)},E.prototype.node=function(w){return this._nodes[w]},E.prototype.hasNode=function(w){return p.has(this._nodes,w)},E.prototype.removeNode=function(w){var m=this;if(p.has(this._nodes,w)){var O=function(P){m.removeEdge(m._edgeObjs[P])};delete this._nodes[w],this._isCompound&&(this._removeFromParentsChildList(w),delete this._parent[w],p.each(this.children(w),function(P){m.setParent(P)}),delete this._children[w]),p.each(p.keys(this._in[w]),O),delete this._in[w],delete this._preds[w],p.each(p.keys(this._out[w]),O),delete this._out[w],delete this._sucs[w],--this._nodeCount}return this},E.prototype.setParent=function(w,m){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(p.isUndefined(m))m=C;else{for(var O=m+="";!p.isUndefined(O);O=this.parent(O))if(O===w)throw new Error("Setting "+m+" as parent of "+w+" would create a cycle");this.setNode(m)}return this.setNode(w),this._removeFromParentsChildList(w),this._parent[w]=m,this._children[m][w]=!0,this},E.prototype._removeFromParentsChildList=function(w){delete this._children[this._parent[w]][w]},E.prototype.parent=function(w){if(this._isCompound){var m=this._parent[w];if(m!==C)return m}},E.prototype.children=function(w){if(p.isUndefined(w)&&(w=C),this._isCompound){var m=this._children[w];if(m)return p.keys(m)}else{if(w===C)return this.nodes();if(this.hasNode(w))return[]}},E.prototype.predecessors=function(w){var m=this._preds[w];if(m)return p.keys(m)},E.prototype.successors=function(w){var m=this._sucs[w];if(m)return p.keys(m)},E.prototype.neighbors=function(w){var m=this.predecessors(w);if(m)return p.union(m,this.successors(w))},E.prototype.isLeaf=function(w){return 0===(this.isDirected()?this.successors(w):this.neighbors(w)).length},E.prototype.filterNodes=function(w){var m=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});m.setGraph(this.graph());var O=this;p.each(this._nodes,function(M,B){w(B)&&m.setNode(B,M)}),p.each(this._edgeObjs,function(M){m.hasNode(M.v)&&m.hasNode(M.w)&&m.setEdge(M,O.edge(M))});var P={};function N(M){var B=O.parent(M);return void 0===B||m.hasNode(B)?(P[M]=B,B):B in P?P[B]:N(B)}return this._isCompound&&p.each(m.nodes(),function(M){m.setParent(M,N(M))}),m},E.prototype.setDefaultEdgeLabel=function(w){return p.isFunction(w)||(w=p.constant(w)),this._defaultEdgeLabelFn=w,this},E.prototype.edgeCount=function(){return this._edgeCount},E.prototype.edges=function(){return p.values(this._edgeObjs)},E.prototype.setPath=function(w,m){var O=this,P=arguments;return p.reduce(w,function(N,M){return P.length>1?O.setEdge(N,M,m):O.setEdge(N,M),M}),this},E.prototype.setEdge=function(){var w,m,O,P,N=!1,M=arguments[0];"object"==typeof M&&null!==M&&"v"in M?(w=M.v,m=M.w,O=M.name,2===arguments.length&&(P=arguments[1],N=!0)):(w=M,m=arguments[1],O=arguments[3],arguments.length>2&&(P=arguments[2],N=!0)),w=""+w,m=""+m,p.isUndefined(O)||(O=""+O);var B=f(this._isDirected,w,m,O);if(p.has(this._edgeLabels,B))return N&&(this._edgeLabels[B]=P),this;if(!p.isUndefined(O)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(w),this.setNode(m),this._edgeLabels[B]=N?P:this._defaultEdgeLabelFn(w,m,O);var Y=S(this._isDirected,w,m,O);return w=Y.v,m=Y.w,Object.freeze(Y),this._edgeObjs[B]=Y,b(this._preds[m],w),b(this._sucs[w],m),this._in[m][B]=Y,this._out[w][B]=Y,this._edgeCount++,this},E.prototype.edge=function(w,m,O){var P=1===arguments.length?g(this._isDirected,arguments[0]):f(this._isDirected,w,m,O);return this._edgeLabels[P]},E.prototype.hasEdge=function(w,m,O){var P=1===arguments.length?g(this._isDirected,arguments[0]):f(this._isDirected,w,m,O);return p.has(this._edgeLabels,P)},E.prototype.removeEdge=function(w,m,O){var P=1===arguments.length?g(this._isDirected,arguments[0]):f(this._isDirected,w,m,O),N=this._edgeObjs[P];return N&&(w=N.v,m=N.w,delete this._edgeLabels[P],delete this._edgeObjs[P],d(this._preds[m],w),d(this._sucs[w],m),delete this._in[m][P],delete this._out[w][P],this._edgeCount--),this},E.prototype.inEdges=function(w,m){var O=this._in[w];if(O){var P=p.values(O);return m?p.filter(P,function(N){return N.v===m}):P}},E.prototype.outEdges=function(w,m){var O=this._out[w];if(O){var P=p.values(O);return m?p.filter(P,function(N){return N.w===m}):P}},E.prototype.nodeEdges=function(w,m){var O=this.inEdges(w,m);if(O)return O.concat(this.outEdges(w,m))}},1838:(_,I,h)=>{_.exports={Graph:h(6568),version:h(5089)}},1088:(_,I,h)=>{var p=h(9138),T=h(6568);function v(d){return p.map(d.nodes(),function(f){var S=d.node(f),g=d.parent(f),w={v:f};return p.isUndefined(S)||(w.value=S),p.isUndefined(g)||(w.parent=g),w})}function E(d){return p.map(d.edges(),function(f){var S=d.edge(f),g={v:f.v,w:f.w};return p.isUndefined(f.name)||(g.name=f.name),p.isUndefined(S)||(g.value=S),g})}_.exports={write:function C(d){var f={options:{directed:d.isDirected(),multigraph:d.isMultigraph(),compound:d.isCompound()},nodes:v(d),edges:E(d)};return p.isUndefined(d.graph())||(f.value=p.clone(d.graph())),f},read:function b(d){var f=new T(d.options).setGraph(d.value);return p.each(d.nodes,function(S){f.setNode(S.v,S.value),S.parent&&f.setParent(S.v,S.parent)}),p.each(d.edges,function(S){f.setEdge({v:S.v,w:S.w,name:S.name},S.value)}),f}}},9138:(_,I,h)=>{var p;try{p={clone:h(1094),constant:h(6684),each:h(5474),filter:h(5281),has:h(4842),isArray:h(1503),isEmpty:h(1973),isFunction:h(5946),isUndefined:h(4235),keys:h(118),map:h(9984),reduce:h(1337),size:h(5637),transform:h(9416),union:h(8921),values:h(377)}}catch(T){}p||(p=window._),_.exports=p},5089:_=>{_.exports="2.1.8"},2186:(_,I)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});class h{constructor(...C){this._head=this._tail=null,this._length=0,C.length>0&&C.forEach(v=>{this.append(v)})}*iterator(){let C=this._head;for(;C;)yield C.value,C=C.next}[Symbol.iterator](){return this.iterator()}get head(){return this._head?this._head.value:null}get tail(){return this._tail?this._tail.value:null}get length(){return this._length}insert(C,v,E=!1){if(E&&this.isDuplicate(C))return!1;let b=new p(C),d=this._head;if(!d)return!1;for(;;){if(d.value===v)return b.next=d.next,b.prev=d,d.next=b,b.next?b.next.prev=b:this._tail=b,this._length++,!0;if(!d.next)return!1;d=d.next}}append(C,v=!1){if(v&&this.isDuplicate(C))return!1;let E=new p(C);return this._tail?(this._tail.next=E,E.prev=this._tail,this._tail=E):this._head=this._tail=E,this._length++,!0}prepend(C,v=!1){if(v&&this.isDuplicate(C))return!1;let E=new p(C);return this._head?(E.next=this._head,this._head.prev=E,this._head=E):this._head=this._tail=E,this._length++,!0}remove(C){let v=this._head;if(v){if(v.value===C)return this._head=v.next,this._head.prev=null,v.next=v.prev=null,this._length--,v.value;for(;;){if(v.value===C)return v.next?(v.prev.next=v.next,v.next.prev=v.prev,v.next=v.prev=null):(v.prev.next=null,this._tail=v.prev,v.next=v.prev=null),this._length--,v.value;if(!v.next)return;v=v.next}}}removeHead(){let C=this._head;if(C)return this._head.next?(this._head.next.prev=null,this._head=this._head.next,C.next=C.prev=null):(this._head=null,this._tail=null),this._length--,C.value}removeTail(){let C=this._tail;if(C)return this._tail.prev?(this._tail.prev.next=null,this._tail=this._tail.prev,C.next=C.prev=null):(this._head=null,this._tail=null),this._length--,C.value}first(C){let v=this.iterator(),E=[],b=Math.min(C,this.length);for(let d=0;d<b;d++){let f=v.next();E.push(f.value)}return E}toArray(){return[...this]}isDuplicate(C){return new Set(this.toArray()).has(C)}}I.LinkedList=h;class p{constructor(C){this.value=C,this.next=null,this.prev=null}}I.LinkedListItem=p},7244:(_,I,h)=>{var C=h(3436)(h(2119),"DataView");_.exports=C},4994:(_,I,h)=>{var p=h(4312),T=h(6421),C=h(5764),v=h(8685),E=h(6676);function b(d){var f=-1,S=null==d?0:d.length;for(this.clear();++f<S;){var g=d[f];this.set(g[0],g[1])}}b.prototype.clear=p,b.prototype.delete=T,b.prototype.get=C,b.prototype.has=v,b.prototype.set=E,_.exports=b},9215:(_,I,h)=>{var p=h(1840),T=h(4378),C=h(4981),v=h(7343),E=h(8895);function b(d){var f=-1,S=null==d?0:d.length;for(this.clear();++f<S;){var g=d[f];this.set(g[0],g[1])}}b.prototype.clear=p,b.prototype.delete=T,b.prototype.get=C,b.prototype.has=v,b.prototype.set=E,_.exports=b},1501:(_,I,h)=>{var C=h(3436)(h(2119),"Map");_.exports=C},9850:(_,I,h)=>{var p=h(638),T=h(1184),C=h(866),v=h(3771),E=h(1772);function b(d){var f=-1,S=null==d?0:d.length;for(this.clear();++f<S;){var g=d[f];this.set(g[0],g[1])}}b.prototype.clear=p,b.prototype.delete=T,b.prototype.get=C,b.prototype.has=v,b.prototype.set=E,_.exports=b},4267:(_,I,h)=>{var C=h(3436)(h(2119),"Promise");_.exports=C},6323:(_,I,h)=>{var C=h(3436)(h(2119),"Set");_.exports=C},8849:(_,I,h)=>{var p=h(9850),T=h(4600),C=h(1387);function v(E){var b=-1,d=null==E?0:E.length;for(this.__data__=new p;++b<d;)this.add(E[b])}v.prototype.add=v.prototype.push=T,v.prototype.has=C,_.exports=v},2858:(_,I,h)=>{var p=h(9215),T=h(3720),C=h(4410),v=h(5576),E=h(2247),b=h(1585);function d(f){var S=this.__data__=new p(f);this.size=S.size}d.prototype.clear=T,d.prototype.delete=C,d.prototype.get=v,d.prototype.has=E,d.prototype.set=b,_.exports=d},443:(_,I,h)=>{var p=h(2119);_.exports=p.Symbol},3457:(_,I,h)=>{var p=h(2119);_.exports=p.Uint8Array},4243:(_,I,h)=>{var C=h(3436)(h(2119),"WeakMap");_.exports=C},6999:_=>{_.exports=function I(h,p,T){switch(T.length){case 0:return h.call(p);case 1:return h.call(p,T[0]);case 2:return h.call(p,T[0],T[1]);case 3:return h.call(p,T[0],T[1],T[2])}return h.apply(p,T)}},6837:_=>{_.exports=function I(h,p){for(var T=-1,C=null==h?0:h.length;++T<C&&!1!==p(h[T],T,h););return h}},9779:_=>{_.exports=function I(h,p){for(var T=-1,C=null==h?0:h.length,v=0,E=[];++T<C;){var b=h[T];p(b,T,h)&&(E[v++]=b)}return E}},1253:(_,I,h)=>{var p=h(4164);_.exports=function T(C,v){return!(null==C||!C.length)&&p(C,v,0)>-1}},177:_=>{_.exports=function I(h,p,T){for(var C=-1,v=null==h?0:h.length;++C<v;)if(T(p,h[C]))return!0;return!1}},2271:(_,I,h)=>{var p=h(5334),T=h(7151),C=h(1503),v=h(891),E=h(8442),b=h(8159),f=Object.prototype.hasOwnProperty;_.exports=function S(g,w){var m=C(g),O=!m&&T(g),P=!m&&!O&&v(g),N=!m&&!O&&!P&&b(g),M=m||O||P||N,B=M?p(g.length,String):[],Y=B.length;for(var F in g)(w||f.call(g,F))&&(!M||!("length"==F||P&&("offset"==F||"parent"==F)||N&&("buffer"==F||"byteLength"==F||"byteOffset"==F)||E(F,Y)))&&B.push(F);return B}},4633:_=>{_.exports=function I(h,p){for(var T=-1,C=null==h?0:h.length,v=Array(C);++T<C;)v[T]=p(h[T],T,h);return v}},5059:_=>{_.exports=function I(h,p){for(var T=-1,C=p.length,v=h.length;++T<C;)h[v+T]=p[T];return h}},8745:_=>{_.exports=function I(h,p,T,C){var v=-1,E=null==h?0:h.length;for(C&&E&&(T=h[++v]);++v<E;)T=p(T,h[v],v,h);return T}},9503:_=>{_.exports=function I(h,p){for(var T=-1,C=null==h?0:h.length;++T<C;)if(p(h[T],T,h))return!0;return!1}},5481:(_,I,h)=>{var T=h(1847)("length");_.exports=T},9276:(_,I,h)=>{var p=h(5683),T=h(217);_.exports=function C(v,E,b){(void 0!==b&&!T(v[E],b)||void 0===b&&!(E in v))&&p(v,E,b)}},9719:(_,I,h)=>{var p=h(5683),T=h(217),v=Object.prototype.hasOwnProperty;_.exports=function E(b,d,f){var S=b[d];(!v.call(b,d)||!T(S,f)||void 0===f&&!(d in b))&&p(b,d,f)}},3503:(_,I,h)=>{var p=h(217);_.exports=function T(C,v){for(var E=C.length;E--;)if(p(C[E][0],v))return E;return-1}},4121:(_,I,h)=>{var p=h(1989),T=h(118);_.exports=function C(v,E){return v&&p(E,T(E),v)}},9287:(_,I,h)=>{var p=h(1989),T=h(6555);_.exports=function C(v,E){return v&&p(E,T(E),v)}},5683:(_,I,h)=>{var p=h(6713);_.exports=function T(C,v,E){"__proto__"==v&&p?p(C,v,{configurable:!0,enumerable:!0,value:E,writable:!0}):C[v]=E}},4462:(_,I,h)=>{var p=h(2858),T=h(6837),C=h(9719),v=h(4121),E=h(9287),b=h(9292),d=h(9454),f=h(4444),S=h(9905),g=h(7597),w=h(6967),m=h(8794),O=h(6782),P=h(7878),N=h(4264),M=h(1503),B=h(891),Y=h(3222),F=h(5940),$=h(799),Q=h(118),ie=h(6555),j="[object Arguments]",se="[object Function]",ge="[object Object]",wt={};wt[j]=wt["[object Array]"]=wt["[object ArrayBuffer]"]=wt["[object DataView]"]=wt["[object Boolean]"]=wt["[object Date]"]=wt["[object Float32Array]"]=wt["[object Float64Array]"]=wt["[object Int8Array]"]=wt["[object Int16Array]"]=wt["[object Int32Array]"]=wt["[object Map]"]=wt["[object Number]"]=wt[ge]=wt["[object RegExp]"]=wt["[object Set]"]=wt["[object String]"]=wt["[object Symbol]"]=wt["[object Uint8Array]"]=wt["[object Uint8ClampedArray]"]=wt["[object Uint16Array]"]=wt["[object Uint32Array]"]=!0,wt["[object Error]"]=wt[se]=wt["[object WeakMap]"]=!1,_.exports=function ss(vt,xs,co,_v,Oc,Ls){var Zt,Ga=1&xs,Ic=2&xs,zg=4&xs;if(co&&(Zt=Oc?co(vt,_v,Oc,Ls):co(vt)),void 0!==Zt)return Zt;if(!F(vt))return vt;var Kg=M(vt);if(Kg){if(Zt=O(vt),!Ga)return d(vt,Zt)}else{var uo=m(vt),$g=uo==se||"[object GeneratorFunction]"==uo;if(B(vt))return b(vt,Ga);if(uo==ge||uo==j||$g&&!Oc){if(Zt=Ic||$g?{}:N(vt),!Ga)return Ic?S(vt,E(Zt,vt)):f(vt,v(Zt,vt))}else{if(!wt[uo])return Oc?vt:{};Zt=P(vt,uo,Ga)}}Ls||(Ls=new p);var Jg=Ls.get(vt);if(Jg)return Jg;Ls.set(vt,Zt),$(vt)?vt.forEach(function(hr){Zt.add(ss(hr,xs,co,hr,vt,Ls))}):Y(vt)&&vt.forEach(function(hr,os){Zt.set(os,ss(hr,xs,co,os,vt,Ls))});var qg=Kg?void 0:(zg?Ic?w:g:Ic?ie:Q)(vt);return T(qg||vt,function(hr,os){qg&&(hr=vt[os=hr]),C(Zt,os,ss(hr,xs,co,os,vt,Ls))}),Zt}},8858:(_,I,h)=>{var p=h(5940),T=Object.create,C=function(){function v(){}return function(E){if(!p(E))return{};if(T)return T(E);v.prototype=E;var b=new v;return v.prototype=void 0,b}}();_.exports=C},3132:(_,I,h)=>{var p=h(5184),C=h(6539)(p);_.exports=C},7308:(_,I,h)=>{var p=h(4129);_.exports=function T(C,v,E){for(var b=-1,d=C.length;++b<d;){var f=C[b],S=v(f);if(null!=S&&(void 0===g?S==S&&!p(S):E(S,g)))var g=S,w=f}return w}},3609:(_,I,h)=>{var p=h(3132);_.exports=function T(C,v){var E=[];return p(C,function(b,d,f){v(b,d,f)&&E.push(b)}),E}},5317:_=>{_.exports=function I(h,p,T,C){for(var v=h.length,E=T+(C?1:-1);C?E--:++E<v;)if(p(h[E],E,h))return E;return-1}},686:(_,I,h)=>{var p=h(5059),T=h(5039);_.exports=function C(v,E,b,d,f){var S=-1,g=v.length;for(b||(b=T),f||(f=[]);++S<g;){var w=v[S];E>0&&b(w)?E>1?C(w,E-1,b,d,f):p(f,w):d||(f[f.length]=w)}return f}},755:(_,I,h)=>{var T=h(456)();_.exports=T},5184:(_,I,h)=>{var p=h(755),T=h(118);_.exports=function C(v,E){return v&&p(v,E,T)}},5456:(_,I,h)=>{var p=h(6884),T=h(8533);_.exports=function C(v,E){for(var b=0,d=(E=p(E,v)).length;null!=v&&b<d;)v=v[T(E[b++])];return b&&b==d?v:void 0}},8247:(_,I,h)=>{var p=h(5059),T=h(1503);_.exports=function C(v,E,b){var d=E(v);return T(v)?d:p(d,b(v))}},3337:(_,I,h)=>{var p=h(443),T=h(1318),C=h(2902),b=p?p.toStringTag:void 0;_.exports=function d(f){return null==f?void 0===f?"[object Undefined]":"[object Null]":b&&b in Object(f)?T(f):C(f)}},1100:_=>{_.exports=function I(h,p){return h>p}},4781:_=>{var h=Object.prototype.hasOwnProperty;_.exports=function p(T,C){return null!=T&&h.call(T,C)}},9989:_=>{_.exports=function I(h,p){return null!=h&&p in Object(h)}},4164:(_,I,h)=>{var p=h(5317),T=h(968),C=h(4977);_.exports=function v(E,b,d){return b==b?C(E,b,d):p(E,T,d)}},186:(_,I,h)=>{var p=h(3337),T=h(2671);_.exports=function v(E){return T(E)&&"[object Arguments]"==p(E)}},5740:(_,I,h)=>{var p=h(8325),T=h(2671);_.exports=function C(v,E,b,d,f){return v===E||(null==v||null==E||!T(v)&&!T(E)?v!=v&&E!=E:p(v,E,b,d,C,f))}},8325:(_,I,h)=>{var p=h(2858),T=h(3914),C=h(8583),v=h(2286),E=h(8794),b=h(1503),d=h(891),f=h(8159),g="[object Arguments]",w="[object Array]",m="[object Object]",P=Object.prototype.hasOwnProperty;_.exports=function N(M,B,Y,F,$,Q){var ie=b(M),ee=b(B),re=ie?w:E(M),U=ee?w:E(B),j=(re=re==g?m:re)==m,V=(U=U==g?m:U)==m,G=re==U;if(G&&d(M)){if(!d(B))return!1;ie=!0,j=!1}if(G&&!j)return Q||(Q=new p),ie||f(M)?T(M,B,Y,F,$,Q):C(M,B,re,Y,F,$,Q);if(!(1&Y)){var H=j&&P.call(M,"__wrapped__"),J=V&&P.call(B,"__wrapped__");if(H||J){var se=H?M.value():M,z=J?B.value():B;return Q||(Q=new p),$(se,z,Y,F,Q)}}return!!G&&(Q||(Q=new p),v(M,B,Y,F,$,Q))}},7021:(_,I,h)=>{var p=h(8794),T=h(2671);_.exports=function v(E){return T(E)&&"[object Map]"==p(E)}},431:(_,I,h)=>{var p=h(2858),T=h(5740);_.exports=function E(b,d,f,S){var g=f.length,w=g,m=!S;if(null==b)return!w;for(b=Object(b);g--;){var O=f[g];if(m&&O[2]?O[1]!==b[O[0]]:!(O[0]in b))return!1}for(;++g<w;){var P=(O=f[g])[0],N=b[P],M=O[1];if(m&&O[2]){if(void 0===N&&!(P in b))return!1}else{var B=new p;if(S)var Y=S(N,M,P,b,d,B);if(!(void 0===Y?T(M,N,3,S,B):Y))return!1}}return!0}},968:_=>{_.exports=function I(h){return h!=h}},7304:(_,I,h)=>{var p=h(5946),T=h(1943),C=h(5940),v=h(2827),b=/^\[object .+?Constructor\]$/,w=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");_.exports=function m(O){return!(!C(O)||T(O))&&(p(O)?w:b).test(v(O))}},771:(_,I,h)=>{var p=h(8794),T=h(2671);_.exports=function v(E){return T(E)&&"[object Set]"==p(E)}},1083:(_,I,h)=>{var p=h(3337),T=h(6231),C=h(2671),G={};G["[object Float32Array]"]=G["[object Float64Array]"]=G["[object Int8Array]"]=G["[object Int16Array]"]=G["[object Int32Array]"]=G["[object Uint8Array]"]=G["[object Uint8ClampedArray]"]=G["[object Uint16Array]"]=G["[object Uint32Array]"]=!0,G["[object Arguments]"]=G["[object Array]"]=G["[object ArrayBuffer]"]=G["[object Boolean]"]=G["[object DataView]"]=G["[object Date]"]=G["[object Error]"]=G["[object Function]"]=G["[object Map]"]=G["[object Number]"]=G["[object Object]"]=G["[object RegExp]"]=G["[object Set]"]=G["[object String]"]=G["[object WeakMap]"]=!1,_.exports=function H(J){return C(J)&&T(J.length)&&!!G[p(J)]}},6517:(_,I,h)=>{var p=h(8133),T=h(9458),C=h(2608),v=h(1503),E=h(7495);_.exports=function b(d){return"function"==typeof d?d:null==d?C:"object"==typeof d?v(d)?T(d[0],d[1]):p(d):E(d)}},1172:(_,I,h)=>{var p=h(5488),T=h(5491),v=Object.prototype.hasOwnProperty;_.exports=function E(b){if(!p(b))return T(b);var d=[];for(var f in Object(b))v.call(b,f)&&"constructor"!=f&&d.push(f);return d}},2809:(_,I,h)=>{var p=h(5940),T=h(5488),C=h(2158),E=Object.prototype.hasOwnProperty;_.exports=function b(d){if(!p(d))return C(d);var f=T(d),S=[];for(var g in d)"constructor"==g&&(f||!E.call(d,g))||S.push(g);return S}},9069:_=>{_.exports=function I(h,p){return h<p}},2046:(_,I,h)=>{var p=h(3132),T=h(6507);_.exports=function C(v,E){var b=-1,d=T(v)?Array(v.length):[];return p(v,function(f,S,g){d[++b]=E(f,S,g)}),d}},8133:(_,I,h)=>{var p=h(431),T=h(2379),C=h(642);_.exports=function v(E){var b=T(E);return 1==b.length&&b[0][2]?C(b[0][0],b[0][1]):function(d){return d===E||p(d,E,b)}}},9458:(_,I,h)=>{var p=h(5740),T=h(8817),C=h(8492),v=h(5352),E=h(2442),b=h(642),d=h(8533);_.exports=function g(w,m){return v(w)&&E(m)?b(d(w),m):function(O){var P=T(O,w);return void 0===P&&P===m?C(O,w):p(m,P,3)}}},3842:(_,I,h)=>{var p=h(2858),T=h(9276),C=h(755),v=h(3675),E=h(5940),b=h(6555),d=h(9351);_.exports=function f(S,g,w,m,O){S!==g&&C(g,function(P,N){if(O||(O=new p),E(P))v(S,g,N,w,f,m,O);else{var M=m?m(d(S,N),P,N+"",S,g,O):void 0;void 0===M&&(M=P),T(S,N,M)}},b)}},3675:(_,I,h)=>{var p=h(9276),T=h(9292),C=h(5208),v=h(9454),E=h(4264),b=h(7151),d=h(1503),f=h(1330),S=h(891),g=h(5946),w=h(5940),m=h(7614),O=h(8159),P=h(9351),N=h(8067);_.exports=function M(B,Y,F,$,Q,ie,ee){var re=P(B,F),U=P(Y,F),j=ee.get(U);if(j)p(B,F,j);else{var V=ie?ie(re,U,F+"",B,Y,ee):void 0,G=void 0===V;if(G){var H=d(U),J=!H&&S(U),se=!H&&!J&&O(U);V=U,H||J||se?d(re)?V=re:f(re)?V=v(re):J?(G=!1,V=T(U,!0)):se?(G=!1,V=C(U,!0)):V=[]:m(U)||b(U)?(V=re,b(re)?V=N(re):(!w(re)||g(re))&&(V=E(U))):G=!1}G&&(ee.set(U,V),Q(V,U,$,ie,ee),ee.delete(U)),p(B,F,V)}}},6119:(_,I,h)=>{var p=h(4633),T=h(5456),C=h(6517),v=h(2046),E=h(8750),b=h(5647),d=h(1215),f=h(2608),S=h(1503);_.exports=function g(w,m,O){m=m.length?p(m,function(M){return S(M)?function(B){return T(B,1===M.length?M[0]:M)}:M}):[f];var P=-1;m=p(m,b(C));var N=v(w,function(M,B,Y){return{criteria:p(m,function($){return $(M)}),index:++P,value:M}});return E(N,function(M,B){return d(M,B,O)})}},3021:(_,I,h)=>{var p=h(5495),T=h(8492);_.exports=function C(v,E){return p(v,E,function(b,d){return T(v,d)})}},5495:(_,I,h)=>{var p=h(5456),T=h(5963),C=h(6884);_.exports=function v(E,b,d){for(var f=-1,S=b.length,g={};++f<S;){var w=b[f],m=p(E,w);d(m,w)&&T(g,C(w,E),m)}return g}},1847:_=>{_.exports=function I(h){return function(p){return null==p?void 0:p[h]}}},9222:(_,I,h)=>{var p=h(5456);_.exports=function T(C){return function(v){return p(v,C)}}},6307:_=>{var I=Math.ceil,h=Math.max;_.exports=function p(T,C,v,E){for(var b=-1,d=h(I((C-T)/(v||1)),0),f=Array(d);d--;)f[E?d:++b]=T,T+=v;return f}},3570:_=>{_.exports=function I(h,p,T,C,v){return v(h,function(E,b,d){T=C?(C=!1,E):p(T,E,b,d)}),T}},3269:(_,I,h)=>{var p=h(2608),T=h(3983),C=h(2185);_.exports=function v(E,b){return C(T(E,b,p),E+"")}},5963:(_,I,h)=>{var p=h(9719),T=h(6884),C=h(8442),v=h(5940),E=h(8533);_.exports=function b(d,f,S,g){if(!v(d))return d;for(var w=-1,m=(f=T(f,d)).length,O=m-1,P=d;null!=P&&++w<m;){var N=E(f[w]),M=S;if("__proto__"===N||"constructor"===N||"prototype"===N)return d;if(w!=O){var B=P[N];void 0===(M=g?g(B,N,P):void 0)&&(M=v(B)?B:C(f[w+1])?[]:{})}p(P,N,M),P=P[N]}return d}},9510:(_,I,h)=>{var p=h(6684),T=h(6713),C=h(2608);_.exports=T?function(E,b){return T(E,"toString",{configurable:!0,enumerable:!1,value:p(b),writable:!0})}:C},8750:_=>{_.exports=function I(h,p){var T=h.length;for(h.sort(p);T--;)h[T]=h[T].value;return h}},5334:_=>{_.exports=function I(h,p){for(var T=-1,C=Array(h);++T<h;)C[T]=p(T);return C}},3935:(_,I,h)=>{var p=h(443),T=h(4633),C=h(1503),v=h(4129),b=p?p.prototype:void 0,d=b?b.toString:void 0;_.exports=function f(S){if("string"==typeof S)return S;if(C(S))return T(S,f)+"";if(v(S))return d?d.call(S):"";var g=S+"";return"0"==g&&1/S==-1/0?"-0":g}},3348:(_,I,h)=>{var p=h(2760),T=/^\s+/;_.exports=function C(v){return v&&v.slice(0,p(v)+1).replace(T,"")}},5647:_=>{_.exports=function I(h){return function(p){return h(p)}}},707:(_,I,h)=>{var p=h(8849),T=h(1253),C=h(177),v=h(5972),E=h(4575),b=h(4174);_.exports=function f(S,g,w){var m=-1,O=T,P=S.length,N=!0,M=[],B=M;if(w)N=!1,O=C;else if(P>=200){var Y=g?null:E(S);if(Y)return b(Y);N=!1,O=v,B=new p}else B=g?[]:M;e:for(;++m<P;){var F=S[m],$=g?g(F):F;if(F=w||0!==F?F:0,N&&$==$){for(var Q=B.length;Q--;)if(B[Q]===$)continue e;g&&B.push($),M.push(F)}else O(B,$,w)||(B!==M&&B.push($),M.push(F))}return M}},9179:(_,I,h)=>{var p=h(4633);_.exports=function T(C,v){return p(v,function(E){return C[E]})}},8645:_=>{_.exports=function I(h,p,T){for(var C=-1,v=h.length,E=p.length,b={};++C<v;)T(b,h[C],C<E?p[C]:void 0);return b}},5972:_=>{_.exports=function I(h,p){return h.has(p)}},1481:(_,I,h)=>{var p=h(2608);_.exports=function T(C){return"function"==typeof C?C:p}},6884:(_,I,h)=>{var p=h(1503),T=h(5352),C=h(2855),v=h(3943);_.exports=function E(b,d){return p(b)?b:T(b,d)?[b]:C(v(b))}},3362:(_,I,h)=>{var p=h(3457);_.exports=function T(C){var v=new C.constructor(C.byteLength);return new p(v).set(new p(C)),v}},9292:(_,I,h)=>{_=h.nmd(_);var p=h(2119),T=I&&!I.nodeType&&I,C=T&&_&&!_.nodeType&&_,E=C&&C.exports===T?p.Buffer:void 0,b=E?E.allocUnsafe:void 0;_.exports=function d(f,S){if(S)return f.slice();var g=f.length,w=b?b(g):new f.constructor(g);return f.copy(w),w}},7e3:(_,I,h)=>{var p=h(3362);_.exports=function T(C,v){var E=v?p(C.buffer):C.buffer;return new C.constructor(E,C.byteOffset,C.byteLength)}},4098:_=>{var I=/\w*$/;_.exports=function h(p){var T=new p.constructor(p.source,I.exec(p));return T.lastIndex=p.lastIndex,T}},2533:(_,I,h)=>{var p=h(443),T=p?p.prototype:void 0,C=T?T.valueOf:void 0;_.exports=function v(E){return C?Object(C.call(E)):{}}},5208:(_,I,h)=>{var p=h(3362);_.exports=function T(C,v){var E=v?p(C.buffer):C.buffer;return new C.constructor(E,C.byteOffset,C.length)}},3443:(_,I,h)=>{var p=h(4129);_.exports=function T(C,v){if(C!==v){var E=void 0!==C,b=null===C,d=C==C,f=p(C),S=void 0!==v,g=null===v,w=v==v,m=p(v);if(!g&&!m&&!f&&C>v||f&&S&&w&&!g&&!m||b&&S&&w||!E&&w||!d)return 1;if(!b&&!f&&!m&&C<v||m&&E&&d&&!b&&!f||g&&E&&d||!S&&d||!w)return-1}return 0}},1215:(_,I,h)=>{var p=h(3443);_.exports=function T(C,v,E){for(var b=-1,d=C.criteria,f=v.criteria,S=d.length,g=E.length;++b<S;){var w=p(d[b],f[b]);if(w)return b>=g?w:w*("desc"==E[b]?-1:1)}return C.index-v.index}},9454:_=>{_.exports=function I(h,p){var T=-1,C=h.length;for(p||(p=Array(C));++T<C;)p[T]=h[T];return p}},1989:(_,I,h)=>{var p=h(9719),T=h(5683);_.exports=function C(v,E,b,d){var f=!b;b||(b={});for(var S=-1,g=E.length;++S<g;){var w=E[S],m=d?d(b[w],v[w],w,b,v):void 0;void 0===m&&(m=v[w]),f?T(b,w,m):p(b,w,m)}return b}},4444:(_,I,h)=>{var p=h(1989),T=h(9383);_.exports=function C(v,E){return p(v,T(v),E)}},9905:(_,I,h)=>{var p=h(1989),T=h(3051);_.exports=function C(v,E){return p(v,T(v),E)}},4610:(_,I,h)=>{var p=h(2119);_.exports=p["__core-js_shared__"]},4944:(_,I,h)=>{var p=h(3269),T=h(3342);_.exports=function C(v){return p(function(E,b){var d=-1,f=b.length,S=f>1?b[f-1]:void 0,g=f>2?b[2]:void 0;for(S=v.length>3&&"function"==typeof S?(f--,S):void 0,g&&T(b[0],b[1],g)&&(S=f<3?void 0:S,f=1),E=Object(E);++d<f;){var w=b[d];w&&v(E,w,d,S)}return E})}},6539:(_,I,h)=>{var p=h(6507);_.exports=function T(C,v){return function(E,b){if(null==E)return E;if(!p(E))return C(E,b);for(var d=E.length,f=v?d:-1,S=Object(E);(v?f--:++f<d)&&!1!==b(S[f],f,S););return E}}},456:_=>{_.exports=function I(h){return function(p,T,C){for(var v=-1,E=Object(p),b=C(p),d=b.length;d--;){var f=b[h?d:++v];if(!1===T(E[f],f,E))break}return p}}},4653:(_,I,h)=>{var p=h(6517),T=h(6507),C=h(118);_.exports=function v(E){return function(b,d,f){var S=Object(b);if(!T(b)){var g=p(d,3);b=C(b),d=function(m){return g(S[m],m,S)}}var w=E(b,d,f);return w>-1?S[g?b[w]:w]:void 0}}},7509:(_,I,h)=>{var p=h(6307),T=h(3342),C=h(2232);_.exports=function v(E){return function(b,d,f){return f&&"number"!=typeof f&&T(b,d,f)&&(d=f=void 0),b=C(b),void 0===d?(d=b,b=0):d=C(d),f=void 0===f?b<d?1:-1:C(f),p(b,d,f,E)}}},4575:(_,I,h)=>{var p=h(6323),T=h(2552),C=h(4174),E=p&&1/C(new p([,-0]))[1]==1/0?function(b){return new p(b)}:T;_.exports=E},6713:(_,I,h)=>{var p=h(3436),T=function(){try{var C=p(Object,"defineProperty");return C({},"",{}),C}catch(v){}}();_.exports=T},3914:(_,I,h)=>{var p=h(8849),T=h(9503),C=h(5972);_.exports=function b(d,f,S,g,w,m){var O=1&S,P=d.length,N=f.length;if(P!=N&&!(O&&N>P))return!1;var M=m.get(d),B=m.get(f);if(M&&B)return M==f&&B==d;var Y=-1,F=!0,$=2&S?new p:void 0;for(m.set(d,f),m.set(f,d);++Y<P;){var Q=d[Y],ie=f[Y];if(g)var ee=O?g(ie,Q,Y,f,d,m):g(Q,ie,Y,d,f,m);if(void 0!==ee){if(ee)continue;F=!1;break}if($){if(!T(f,function(re,U){if(!C($,U)&&(Q===re||w(Q,re,S,g,m)))return $.push(U)})){F=!1;break}}else if(Q!==ie&&!w(Q,ie,S,g,m)){F=!1;break}}return m.delete(d),m.delete(f),F}},8583:(_,I,h)=>{var p=h(443),T=h(3457),C=h(217),v=h(3914),E=h(3205),b=h(4174),$=p?p.prototype:void 0,Q=$?$.valueOf:void 0;_.exports=function ie(ee,re,U,j,V,G,H){switch(U){case"[object DataView]":if(ee.byteLength!=re.byteLength||ee.byteOffset!=re.byteOffset)return!1;ee=ee.buffer,re=re.buffer;case"[object ArrayBuffer]":return!(ee.byteLength!=re.byteLength||!G(new T(ee),new T(re)));case"[object Boolean]":case"[object Date]":case"[object Number]":return C(+ee,+re);case"[object Error]":return ee.name==re.name&&ee.message==re.message;case"[object RegExp]":case"[object String]":return ee==re+"";case"[object Map]":var J=E;case"[object Set]":if(J||(J=b),ee.size!=re.size&&!(1&j))return!1;var z=H.get(ee);if(z)return z==re;j|=2,H.set(ee,re);var K=v(J(ee),J(re),j,V,G,H);return H.delete(ee),K;case"[object Symbol]":if(Q)return Q.call(ee)==Q.call(re)}return!1}},2286:(_,I,h)=>{var p=h(7597),v=Object.prototype.hasOwnProperty;_.exports=function E(b,d,f,S,g,w){var m=1&f,O=p(b),P=O.length;if(P!=p(d).length&&!m)return!1;for(var B=P;B--;){var Y=O[B];if(!(m?Y in d:v.call(d,Y)))return!1}var F=w.get(b),$=w.get(d);if(F&&$)return F==d&&$==b;var Q=!0;w.set(b,d),w.set(d,b);for(var ie=m;++B<P;){var ee=b[Y=O[B]],re=d[Y];if(S)var U=m?S(re,ee,Y,d,b,w):S(ee,re,Y,b,d,w);if(!(void 0===U?ee===re||g(ee,re,f,S,w):U)){Q=!1;break}ie||(ie="constructor"==Y)}if(Q&&!ie){var j=b.constructor,V=d.constructor;j!=V&&"constructor"in b&&"constructor"in d&&!("function"==typeof j&&j instanceof j&&"function"==typeof V&&V instanceof V)&&(Q=!1)}return w.delete(b),w.delete(d),Q}},3975:(_,I,h)=>{var p=h(2274),T=h(3983),C=h(2185);_.exports=function v(E){return C(T(E,void 0,p),E+"")}},9122:_=>{var I="object"==typeof global&&global&&global.Object===Object&&global;_.exports=I},7597:(_,I,h)=>{var p=h(8247),T=h(9383),C=h(118);_.exports=function v(E){return p(E,C,T)}},6967:(_,I,h)=>{var p=h(8247),T=h(3051),C=h(6555);_.exports=function v(E){return p(E,C,T)}},4537:(_,I,h)=>{var p=h(3819);_.exports=function T(C,v){var E=C.__data__;return p(v)?E["string"==typeof v?"string":"hash"]:E.map}},2379:(_,I,h)=>{var p=h(2442),T=h(118);_.exports=function C(v){for(var E=T(v),b=E.length;b--;){var d=E[b],f=v[d];E[b]=[d,f,p(f)]}return E}},3436:(_,I,h)=>{var p=h(7304),T=h(1990);_.exports=function C(v,E){var b=T(v,E);return p(b)?b:void 0}},9519:(_,I,h)=>{var T=h(9385)(Object.getPrototypeOf,Object);_.exports=T},1318:(_,I,h)=>{var p=h(443),T=Object.prototype,C=T.hasOwnProperty,v=T.toString,E=p?p.toStringTag:void 0;_.exports=function b(d){var f=C.call(d,E),S=d[E];try{d[E]=void 0;var g=!0}catch(m){}var w=v.call(d);return g&&(f?d[E]=S:delete d[E]),w}},9383:(_,I,h)=>{var p=h(9779),T=h(9975),v=Object.prototype.propertyIsEnumerable,E=Object.getOwnPropertySymbols;_.exports=E?function(d){return null==d?[]:(d=Object(d),p(E(d),function(f){return v.call(d,f)}))}:T},3051:(_,I,h)=>{var p=h(5059),T=h(9519),C=h(9383),v=h(9975);_.exports=Object.getOwnPropertySymbols?function(d){for(var f=[];d;)p(f,C(d)),d=T(d);return f}:v},8794:(_,I,h)=>{var p=h(7244),T=h(1501),C=h(4267),v=h(6323),E=h(4243),b=h(3337),d=h(2827),f="[object Map]",g="[object Promise]",w="[object Set]",m="[object WeakMap]",O="[object DataView]",P=d(p),N=d(T),M=d(C),B=d(v),Y=d(E),F=b;(p&&F(new p(new ArrayBuffer(1)))!=O||T&&F(new T)!=f||C&&F(C.resolve())!=g||v&&F(new v)!=w||E&&F(new E)!=m)&&(F=function($){var Q=b($),ie="[object Object]"==Q?$.constructor:void 0,ee=ie?d(ie):"";if(ee)switch(ee){case P:return O;case N:return f;case M:return g;case B:return w;case Y:return m}return Q}),_.exports=F},1990:_=>{_.exports=function I(h,p){return null==h?void 0:h[p]}},7283:(_,I,h)=>{var p=h(6884),T=h(7151),C=h(1503),v=h(8442),E=h(6231),b=h(8533);_.exports=function d(f,S,g){for(var w=-1,m=(S=p(S,f)).length,O=!1;++w<m;){var P=b(S[w]);if(!(O=null!=f&&g(f,P)))break;f=f[P]}return O||++w!=m?O:!!(m=null==f?0:f.length)&&E(m)&&v(P,m)&&(C(f)||T(f))}},7609:_=>{var b=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");_.exports=function d(f){return b.test(f)}},4312:(_,I,h)=>{var p=h(862);_.exports=function T(){this.__data__=p?p(null):{},this.size=0}},6421:_=>{_.exports=function I(h){var p=this.has(h)&&delete this.__data__[h];return this.size-=p?1:0,p}},5764:(_,I,h)=>{var p=h(862),v=Object.prototype.hasOwnProperty;_.exports=function E(b){var d=this.__data__;if(p){var f=d[b];return"__lodash_hash_undefined__"===f?void 0:f}return v.call(d,b)?d[b]:void 0}},8685:(_,I,h)=>{var p=h(862),C=Object.prototype.hasOwnProperty;_.exports=function v(E){var b=this.__data__;return p?void 0!==b[E]:C.call(b,E)}},6676:(_,I,h)=>{var p=h(862);_.exports=function C(v,E){var b=this.__data__;return this.size+=this.has(v)?0:1,b[v]=p&&void 0===E?"__lodash_hash_undefined__":E,this}},6782:_=>{var h=Object.prototype.hasOwnProperty;_.exports=function p(T){var C=T.length,v=new T.constructor(C);return C&&"string"==typeof T[0]&&h.call(T,"index")&&(v.index=T.index,v.input=T.input),v}},7878:(_,I,h)=>{var p=h(3362),T=h(7e3),C=h(4098),v=h(2533),E=h(5208);_.exports=function U(j,V,G){var H=j.constructor;switch(V){case"[object ArrayBuffer]":return p(j);case"[object Boolean]":case"[object Date]":return new H(+j);case"[object DataView]":return T(j,G);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return E(j,G);case"[object Map]":case"[object Set]":return new H;case"[object Number]":case"[object String]":return new H(j);case"[object RegExp]":return C(j);case"[object Symbol]":return v(j)}}},4264:(_,I,h)=>{var p=h(8858),T=h(9519),C=h(5488);_.exports=function v(E){return"function"!=typeof E.constructor||C(E)?{}:p(T(E))}},5039:(_,I,h)=>{var p=h(443),T=h(7151),C=h(1503),v=p?p.isConcatSpreadable:void 0;_.exports=function E(b){return C(b)||T(b)||!!(v&&b&&b[v])}},8442:_=>{var h=/^(?:0|[1-9]\d*)$/;_.exports=function p(T,C){var v=typeof T;return!!(C=null==C?9007199254740991:C)&&("number"==v||"symbol"!=v&&h.test(T))&&T>-1&&T%1==0&&T<C}},3342:(_,I,h)=>{var p=h(217),T=h(6507),C=h(8442),v=h(5940);_.exports=function E(b,d,f){if(!v(f))return!1;var S=typeof d;return!!("number"==S?T(f)&&C(d,f.length):"string"==S&&d in f)&&p(f[d],b)}},5352:(_,I,h)=>{var p=h(1503),T=h(4129),C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,v=/^\w*$/;_.exports=function E(b,d){if(p(b))return!1;var f=typeof b;return!("number"!=f&&"symbol"!=f&&"boolean"!=f&&null!=b&&!T(b))||v.test(b)||!C.test(b)||null!=d&&b in Object(d)}},3819:_=>{_.exports=function I(h){var p=typeof h;return"string"==p||"number"==p||"symbol"==p||"boolean"==p?"__proto__"!==h:null===h}},1943:(_,I,h)=>{var v,p=h(4610),T=(v=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"";_.exports=function C(v){return!!T&&T in v}},5488:_=>{var I=Object.prototype;_.exports=function h(p){var T=p&&p.constructor;return p===("function"==typeof T&&T.prototype||I)}},2442:(_,I,h)=>{var p=h(5940);_.exports=function T(C){return C==C&&!p(C)}},1840:_=>{_.exports=function I(){this.__data__=[],this.size=0}},4378:(_,I,h)=>{var p=h(3503),C=Array.prototype.splice;_.exports=function v(E){var b=this.__data__,d=p(b,E);return!(d<0||(d==b.length-1?b.pop():C.call(b,d,1),--this.size,0))}},4981:(_,I,h)=>{var p=h(3503);_.exports=function T(C){var v=this.__data__,E=p(v,C);return E<0?void 0:v[E][1]}},7343:(_,I,h)=>{var p=h(3503);_.exports=function T(C){return p(this.__data__,C)>-1}},8895:(_,I,h)=>{var p=h(3503);_.exports=function T(C,v){var E=this.__data__,b=p(E,C);return b<0?(++this.size,E.push([C,v])):E[b][1]=v,this}},638:(_,I,h)=>{var p=h(4994),T=h(9215),C=h(1501);_.exports=function v(){this.size=0,this.__data__={hash:new p,map:new(C||T),string:new p}}},1184:(_,I,h)=>{var p=h(4537);_.exports=function T(C){var v=p(this,C).delete(C);return this.size-=v?1:0,v}},866:(_,I,h)=>{var p=h(4537);_.exports=function T(C){return p(this,C).get(C)}},3771:(_,I,h)=>{var p=h(4537);_.exports=function T(C){return p(this,C).has(C)}},1772:(_,I,h)=>{var p=h(4537);_.exports=function T(C,v){var E=p(this,C),b=E.size;return E.set(C,v),this.size+=E.size==b?0:1,this}},3205:_=>{_.exports=function I(h){var p=-1,T=Array(h.size);return h.forEach(function(C,v){T[++p]=[v,C]}),T}},642:_=>{_.exports=function I(h,p){return function(T){return null!=T&&T[h]===p&&(void 0!==p||h in Object(T))}}},719:(_,I,h)=>{var p=h(535);_.exports=function C(v){var E=p(v,function(d){return 500===b.size&&b.clear(),d}),b=E.cache;return E}},862:(_,I,h)=>{var T=h(3436)(Object,"create");_.exports=T},5491:(_,I,h)=>{var T=h(9385)(Object.keys,Object);_.exports=T},2158:_=>{_.exports=function I(h){var p=[];if(null!=h)for(var T in Object(h))p.push(T);return p}},3597:(_,I,h)=>{_=h.nmd(_);var p=h(9122),T=I&&!I.nodeType&&I,C=T&&_&&!_.nodeType&&_,E=C&&C.exports===T&&p.process,b=function(){try{return C&&C.require&&C.require("util").types||E&&E.binding&&E.binding("util")}catch(f){}}();_.exports=b},2902:_=>{var h=Object.prototype.toString;_.exports=function p(T){return h.call(T)}},9385:_=>{_.exports=function I(h,p){return function(T){return h(p(T))}}},3983:(_,I,h)=>{var p=h(6999),T=Math.max;_.exports=function C(v,E,b){return E=T(void 0===E?v.length-1:E,0),function(){for(var d=arguments,f=-1,S=T(d.length-E,0),g=Array(S);++f<S;)g[f]=d[E+f];f=-1;for(var w=Array(E+1);++f<E;)w[f]=d[f];return w[E]=b(g),p(v,this,w)}}},2119:(_,I,h)=>{var p=h(9122),T="object"==typeof self&&self&&self.Object===Object&&self,C=p||T||Function("return this")();_.exports=C},9351:_=>{_.exports=function I(h,p){if(("constructor"!==p||"function"!=typeof h[p])&&"__proto__"!=p)return h[p]}},4600:_=>{_.exports=function h(p){return this.__data__.set(p,"__lodash_hash_undefined__"),this}},1387:_=>{_.exports=function I(h){return this.__data__.has(h)}},4174:_=>{_.exports=function I(h){var p=-1,T=Array(h.size);return h.forEach(function(C){T[++p]=C}),T}},2185:(_,I,h)=>{var p=h(9510),C=h(29)(p);_.exports=C},29:_=>{var p=Date.now;_.exports=function T(C){var v=0,E=0;return function(){var b=p(),d=16-(b-E);if(E=b,d>0){if(++v>=800)return arguments[0]}else v=0;return C.apply(void 0,arguments)}}},3720:(_,I,h)=>{var p=h(9215);_.exports=function T(){this.__data__=new p,this.size=0}},4410:_=>{_.exports=function I(h){var p=this.__data__,T=p.delete(h);return this.size=p.size,T}},5576:_=>{_.exports=function I(h){return this.__data__.get(h)}},2247:_=>{_.exports=function I(h){return this.__data__.has(h)}},1585:(_,I,h)=>{var p=h(9215),T=h(1501),C=h(9850);_.exports=function E(b,d){var f=this.__data__;if(f instanceof p){var S=f.__data__;if(!T||S.length<199)return S.push([b,d]),this.size=++f.size,this;f=this.__data__=new C(S)}return f.set(b,d),this.size=f.size,this}},4977:_=>{_.exports=function I(h,p,T){for(var C=T-1,v=h.length;++C<v;)if(h[C]===p)return C;return-1}},2315:(_,I,h)=>{var p=h(5481),T=h(7609),C=h(1149);_.exports=function v(E){return T(E)?C(E):p(E)}},2855:(_,I,h)=>{var p=h(719),T=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,v=p(function(E){var b=[];return 46===E.charCodeAt(0)&&b.push(""),E.replace(T,function(d,f,S,g){b.push(S?g.replace(C,"$1"):f||d)}),b});_.exports=v},8533:(_,I,h)=>{var p=h(4129);_.exports=function C(v){if("string"==typeof v||p(v))return v;var E=v+"";return"0"==E&&1/v==-1/0?"-0":E}},2827:_=>{var h=Function.prototype.toString;_.exports=function p(T){if(null!=T){try{return h.call(T)}catch(C){}try{return T+""}catch(C){}}return""}},2760:_=>{var I=/\s/;_.exports=function h(p){for(var T=p.length;T--&&I.test(p.charAt(T)););return T}},1149:_=>{var I="\\ud800-\\udfff",E="["+I+"]",b="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",d="\\ud83c[\\udffb-\\udfff]",S="[^"+I+"]",g="(?:\\ud83c[\\udde6-\\uddff]){2}",w="[\\ud800-\\udbff][\\udc00-\\udfff]",O="(?:"+b+"|"+d+")?",P="[\\ufe0e\\ufe0f]?",M=P+O+"(?:\\u200d(?:"+[S,g,w].join("|")+")"+P+O+")*",B="(?:"+[S+b+"?",b,g,w,E].join("|")+")",Y=RegExp(d+"(?="+d+")|"+B+M,"g");_.exports=function F($){for(var Q=Y.lastIndex=0;Y.test($);)++Q;return Q}},1094:(_,I,h)=>{var p=h(4462);_.exports=function C(v){return p(v,4)}},733:(_,I,h)=>{var p=h(4462);_.exports=function v(E){return p(E,5)}},6684:_=>{_.exports=function I(h){return function(){return h}}},8800:(_,I,h)=>{var p=h(3269),T=h(217),C=h(3342),v=h(6555),E=Object.prototype,b=E.hasOwnProperty,d=p(function(f,S){f=Object(f);var g=-1,w=S.length,m=w>2?S[2]:void 0;for(m&&C(S[0],S[1],m)&&(w=1);++g<w;)for(var O=S[g],P=v(O),N=-1,M=P.length;++N<M;){var B=P[N],Y=f[B];(void 0===Y||T(Y,E[B])&&!b.call(f,B))&&(f[B]=O[B])}return f});_.exports=d},5474:(_,I,h)=>{_.exports=h(9851)},217:_=>{_.exports=function I(h,p){return h===p||h!=h&&p!=p}},5281:(_,I,h)=>{var p=h(9779),T=h(3609),C=h(6517),v=h(1503);_.exports=function E(b,d){return(v(b)?p:T)(b,C(d,3))}},2516:(_,I,h)=>{var C=h(4653)(h(6397));_.exports=C},6397:(_,I,h)=>{var p=h(5317),T=h(6517),C=h(4401),v=Math.max;_.exports=function E(b,d,f){var S=null==b?0:b.length;if(!S)return-1;var g=null==f?0:C(f);return g<0&&(g=v(S+g,0)),p(b,T(d,3),g)}},2274:(_,I,h)=>{var p=h(686);_.exports=function T(C){return null!=C&&C.length?p(C,1):[]}},9851:(_,I,h)=>{var p=h(6837),T=h(3132),C=h(1481),v=h(1503);_.exports=function E(b,d){return(v(b)?p:T)(b,C(d))}},1176:(_,I,h)=>{var p=h(755),T=h(1481),C=h(6555);_.exports=function v(E,b){return null==E?E:p(E,T(b),C)}},8817:(_,I,h)=>{var p=h(5456);_.exports=function T(C,v,E){var b=null==C?void 0:p(C,v);return void 0===b?E:b}},4842:(_,I,h)=>{var p=h(4781),T=h(7283);_.exports=function C(v,E){return null!=v&&T(v,E,p)}},8492:(_,I,h)=>{var p=h(9989),T=h(7283);_.exports=function C(v,E){return null!=v&&T(v,E,p)}},2608:_=>{_.exports=function I(h){return h}},7151:(_,I,h)=>{var p=h(186),T=h(2671),C=Object.prototype,v=C.hasOwnProperty,E=C.propertyIsEnumerable,b=p(function(){return arguments}())?p:function(d){return T(d)&&v.call(d,"callee")&&!E.call(d,"callee")};_.exports=b},1503:_=>{_.exports=Array.isArray},6507:(_,I,h)=>{var p=h(5946),T=h(6231);_.exports=function C(v){return null!=v&&T(v.length)&&!p(v)}},1330:(_,I,h)=>{var p=h(6507),T=h(2671);_.exports=function C(v){return T(v)&&p(v)}},891:(_,I,h)=>{_=h.nmd(_);var p=h(2119),T=h(3580),C=I&&!I.nodeType&&I,v=C&&_&&!_.nodeType&&_,b=v&&v.exports===C?p.Buffer:void 0;_.exports=(b?b.isBuffer:void 0)||T},1973:(_,I,h)=>{var p=h(1172),T=h(8794),C=h(7151),v=h(1503),E=h(6507),b=h(891),d=h(5488),f=h(8159),m=Object.prototype.hasOwnProperty;_.exports=function O(P){if(null==P)return!0;if(E(P)&&(v(P)||"string"==typeof P||"function"==typeof P.splice||b(P)||f(P)||C(P)))return!P.length;var N=T(P);if("[object Map]"==N||"[object Set]"==N)return!P.size;if(d(P))return!p(P).length;for(var M in P)if(m.call(P,M))return!1;return!0}},5946:(_,I,h)=>{var p=h(3337),T=h(5940);_.exports=function d(f){if(!T(f))return!1;var S=p(f);return"[object Function]"==S||"[object GeneratorFunction]"==S||"[object AsyncFunction]"==S||"[object Proxy]"==S}},6231:_=>{_.exports=function h(p){return"number"==typeof p&&p>-1&&p%1==0&&p<=9007199254740991}},3222:(_,I,h)=>{var p=h(7021),T=h(5647),C=h(3597),v=C&&C.isMap,E=v?T(v):p;_.exports=E},5940:_=>{_.exports=function I(h){var p=typeof h;return null!=h&&("object"==p||"function"==p)}},2671:_=>{_.exports=function I(h){return null!=h&&"object"==typeof h}},7614:(_,I,h)=>{var p=h(3337),T=h(9519),C=h(2671),d=Function.prototype.toString,f=Object.prototype.hasOwnProperty,S=d.call(Object);_.exports=function g(w){if(!C(w)||"[object Object]"!=p(w))return!1;var m=T(w);if(null===m)return!0;var O=f.call(m,"constructor")&&m.constructor;return"function"==typeof O&&O instanceof O&&d.call(O)==S}},799:(_,I,h)=>{var p=h(771),T=h(5647),C=h(3597),v=C&&C.isSet,E=v?T(v):p;_.exports=E},248:(_,I,h)=>{var p=h(3337),T=h(1503),C=h(2671);_.exports=function E(b){return"string"==typeof b||!T(b)&&C(b)&&"[object String]"==p(b)}},4129:(_,I,h)=>{var p=h(3337),T=h(2671);_.exports=function v(E){return"symbol"==typeof E||T(E)&&"[object Symbol]"==p(E)}},8159:(_,I,h)=>{var p=h(1083),T=h(5647),C=h(3597),v=C&&C.isTypedArray,E=v?T(v):p;_.exports=E},4235:_=>{_.exports=function I(h){return void 0===h}},118:(_,I,h)=>{var p=h(2271),T=h(1172),C=h(6507);_.exports=function v(E){return C(E)?p(E):T(E)}},6555:(_,I,h)=>{var p=h(2271),T=h(2809),C=h(6507);_.exports=function v(E){return C(E)?p(E,!0):T(E)}},5809:_=>{_.exports=function I(h){var p=null==h?0:h.length;return p?h[p-1]:void 0}},9984:(_,I,h)=>{var p=h(4633),T=h(6517),C=h(2046),v=h(1503);_.exports=function E(b,d){return(v(b)?p:C)(b,T(d,3))}},203:(_,I,h)=>{var p=h(5683),T=h(5184),C=h(6517);_.exports=function v(E,b){var d={};return b=C(b,3),T(E,function(f,S,g){p(d,S,b(f,S,g))}),d}},8176:(_,I,h)=>{var p=h(7308),T=h(1100),C=h(2608);_.exports=function v(E){return E&&E.length?p(E,C,T):void 0}},535:(_,I,h)=>{var p=h(9850);function C(v,E){if("function"!=typeof v||null!=E&&"function"!=typeof E)throw new TypeError("Expected a function");var b=function(){var d=arguments,f=E?E.apply(this,d):d[0],S=b.cache;if(S.has(f))return S.get(f);var g=v.apply(this,d);return b.cache=S.set(f,g)||S,g};return b.cache=new(C.Cache||p),b}C.Cache=p,_.exports=C},567:(_,I,h)=>{var p=h(3842),C=h(4944)(function(v,E,b){p(v,E,b)});_.exports=C},9439:(_,I,h)=>{var p=h(7308),T=h(9069),C=h(2608);_.exports=function v(E){return E&&E.length?p(E,C,T):void 0}},9525:(_,I,h)=>{var p=h(7308),T=h(6517),C=h(9069);_.exports=function v(E,b){return E&&E.length?p(E,T(b,2),C):void 0}},2552:_=>{_.exports=function I(){}},1710:(_,I,h)=>{var p=h(2119);_.exports=function(){return p.Date.now()}},6372:(_,I,h)=>{var p=h(3021),C=h(3975)(function(v,E){return null==v?{}:p(v,E)});_.exports=C},7495:(_,I,h)=>{var p=h(1847),T=h(9222),C=h(5352),v=h(8533);_.exports=function E(b){return C(b)?p(v(b)):T(b)}},361:(_,I,h)=>{var T=h(7509)();_.exports=T},1337:(_,I,h)=>{var p=h(8745),T=h(3132),C=h(6517),v=h(3570),E=h(1503);_.exports=function b(d,f,S){var g=E(d)?p:v,w=arguments.length<3;return g(d,C(f,4),S,w,T)}},5637:(_,I,h)=>{var p=h(1172),T=h(8794),C=h(6507),v=h(248),E=h(2315);_.exports=function f(S){if(null==S)return 0;if(C(S))return v(S)?E(S):S.length;var g=T(S);return"[object Map]"==g||"[object Set]"==g?S.size:p(S).length}},2906:(_,I,h)=>{var p=h(686),T=h(6119),C=h(3269),v=h(3342),E=C(function(b,d){if(null==b)return[];var f=d.length;return f>1&&v(b,d[0],d[1])?d=[]:f>2&&v(d[0],d[1],d[2])&&(d=[d[0]]),T(b,p(d,1),[])});_.exports=E},9975:_=>{_.exports=function I(){return[]}},3580:_=>{_.exports=function I(){return!1}},2232:(_,I,h)=>{var p=h(1467),T=1/0;_.exports=function v(E){return E?(E=p(E))===T||E===-T?17976931348623157e292*(E<0?-1:1):E==E?E:0:0===E?E:0}},4401:(_,I,h)=>{var p=h(2232);_.exports=function T(C){var v=p(C),E=v%1;return v==v?E?v-E:v:0}},1467:(_,I,h)=>{var p=h(3348),T=h(5940),C=h(4129),E=/^[-+]0x[0-9a-f]+$/i,b=/^0b[01]+$/i,d=/^0o[0-7]+$/i,f=parseInt;_.exports=function S(g){if("number"==typeof g)return g;if(C(g))return NaN;if(T(g)){var w="function"==typeof g.valueOf?g.valueOf():g;g=T(w)?w+"":w}if("string"!=typeof g)return 0===g?g:+g;g=p(g);var m=b.test(g);return m||d.test(g)?f(g.slice(2),m?2:8):E.test(g)?NaN:+g}},8067:(_,I,h)=>{var p=h(1989),T=h(6555);_.exports=function C(v){return p(v,T(v))}},3943:(_,I,h)=>{var p=h(3935);_.exports=function T(C){return null==C?"":p(C)}},9416:(_,I,h)=>{var p=h(6837),T=h(8858),C=h(5184),v=h(6517),E=h(9519),b=h(1503),d=h(891),f=h(5946),S=h(5940),g=h(8159);_.exports=function w(m,O,P){var N=b(m),M=N||d(m)||g(m);if(O=v(O,4),null==P){var B=m&&m.constructor;P=M?N?new B:[]:S(m)&&f(B)?T(E(m)):{}}return(M?p:C)(m,function(Y,F,$){return O(P,Y,F,$)}),P}},8921:(_,I,h)=>{var p=h(686),T=h(3269),C=h(707),v=h(1330),E=T(function(b){return C(p(b,1,v,!0))});_.exports=E},1541:(_,I,h)=>{var p=h(3943),T=0;_.exports=function C(v){var E=++T;return p(v)+E}},377:(_,I,h)=>{var p=h(9179),T=h(118);_.exports=function C(v){return null==v?[]:p(v,T(v))}},1617:(_,I,h)=>{var p=h(9719),T=h(8645);_.exports=function C(v,E){return T(v||[],E||[],p)}},5114:(_,I,h)=>{"use strict";const T=h(2186);I.c=class C extends T.LinkedList{constructor(...E){super(...E)}get front(){return this.head}enqueue(E){this.append(E)}dequeue(){return this.removeHead()}}},5341:(_,I,h)=>{"use strict";const T=h(2186);I.K=class C extends T.LinkedList{constructor(...E){super(...E)}get top(){return this.head}get size(){return this.length}push(E){this.prepend(E)}pop(){return this.removeHead()}}},9737:function(_,I){"use strict";var h=this&&this.__spreadArrays||function(){for(var C=0,v=0,E=arguments.length;v<E;v++)C+=arguments[v].length;var b=Array(C),d=0;for(v=0;v<E;v++)for(var f=arguments[v],S=0,g=f.length;S<g;S++,d++)b[d]=f[S];return b};Object.defineProperty(I,"__esModule",{value:!0}),I.StringBuilder=I.String=void 0;var p=function(){function C(){}return C.IsNullOrWhiteSpace=function(v){try{return null==v||"undefined"==v||v.toString().replace(/\s/g,"").length<1}catch(E){return console.log(E),!1}},C.Join=function(v){for(var E=[],b=1;b<arguments.length;b++)E[b-1]=arguments[b];try{var d=E[0];if(Array.isArray(d)||d instanceof Array){for(var f=C.Empty,g=0;g<d.length;g++){var w=d[g];f+=g<d.length-1?w+v:w}return f}if("object"==typeof d){var m=C.Empty,O=d,P=Object.keys(d);return P.forEach(function(M){m+=O[M]+v}),m=m.slice(0,m.length-v.length)}var N=E;return C.join.apply(C,h([v],N))}catch(M){return console.log(M),C.Empty}},C.Format=function(v){for(var E=[],b=1;b<arguments.length;b++)E[b-1]=arguments[b];try{return v.match(C.regexNumber)?C.format(C.regexNumber,v,E):v.match(C.regexObject)?C.format(C.regexObject,v,E,!0):v}catch(d){return console.log(d),C.Empty}},C.format=function(v,E,b,d){return void 0===d&&(d=!1),E.replace(v,function(f,S){var w,g=f.split(":");return g.length>1&&(S=g[0].replace("{",""),f=g[1].replace("}","")),null==(w=d?b[0][S]:b[S])||null==w||f.match(/{\d+}/)||void 0!==(w=C.parsePattern(f,w))&&null!=w?w:C.Empty})},C.parsePattern=function(v,E){switch(v){case"L":return E.toLocaleLowerCase();case"U":return E.toLocaleUpperCase();case"d":if("string"==typeof E)return C.getDisplayDateFromString(E);if(E instanceof Date)return C.Format("{0:00}.{1:00}.{2:0000}",E.getDate(),E.getMonth(),E.getFullYear());break;case"s":if("string"==typeof E)return C.getSortableDateFromString(E);if(E instanceof Date)return C.Format("{0:0000}-{1:00}-{2:00}",E.getFullYear(),E.getMonth(),E.getDate());break;case"n":"string"!=typeof E&&(E=E.toString());var b=E.replace(/,/g,".");if(isNaN(parseFloat(b))||b.length<=3)break;var d=b.split(/[^0-9]+/g),f=d;d.length>1&&(f=[C.join.apply(C,h([""],d.splice(0,d.length-1))),d[d.length-1]]);var S=f[0],g=S.length%3,w=g>0?S.substring(0,g):C.Empty,O=S.substring(g).match(/.{3}/g);return(w=w+"."+C.Join(".",O))+(f.length>1?","+f[1]:"");case"x":return this.decimalToHexString(E);case"X":return this.decimalToHexString(E,!0)}return"number"!=typeof E&&isNaN(E)||isNaN(+v)||C.IsNullOrWhiteSpace(E)?E:C.formatNumber(E,v)},C.decimalToHexString=function(v,E){void 0===E&&(E=!1);var d=parseFloat(v).toString(16);return E?d.toLocaleUpperCase():d},C.getDisplayDateFromString=function(v){var E;if((E=v.split("-")).length<=1)return v;var b=E[E.length-1],d=E[E.length-2],f=E[E.length-3];return(b=(b=b.split("T")[0]).split(" ")[0])+"."+d+"."+f},C.getSortableDateFromString=function(v){var E=v.replace(",","").split(".");if(E.length<=1)return v;var b=E[E.length-1].split(" "),d=C.Empty;b.length>1&&(d=b[b.length-1]);var w=E[E.length-1].split(" ")[0]+"-"+E[E.length-2]+"-"+E[E.length-3];return!C.IsNullOrWhiteSpace(d)&&d.length>1?w+="T"+d:w+="T00:00:00",w},C.formatNumber=function(v,E){var b=E.length,d=v.toString();if(b<=d.length)return d;var f=b-d.length;return new Array(f+=1).join("0")+d},C.join=function(v){for(var E=[],b=1;b<arguments.length;b++)E[b-1]=arguments[b];for(var d=C.Empty,f=0;f<E.length;f++)if(!("string"==typeof E[f]&&C.IsNullOrWhiteSpace(E[f])||"number"!=typeof E[f]&&"string"!=typeof E[f])){var S=""+E[f];d+=S;for(var g=f+1;g<E.length;g++)if(!C.IsNullOrWhiteSpace(E[g])){d+=v,f=g-1;break}}return d},C.regexNumber=/{(\d+(:\w*)?)}/g,C.regexObject=/{(\w+(:\w*)?)}/g,C.Empty="",C}();I.String=p;var T=function(){function C(v){this.Values=[],p.IsNullOrWhiteSpace(v)||(this.Values=new Array(v))}return C.prototype.ToString=function(){return this.Values.join("")},C.prototype.Append=function(v){this.Values.push(v)},C.prototype.AppendLine=function(v){this.Values.push("\r\n"+v)},C.prototype.AppendFormat=function(v){for(var E=[],b=1;b<arguments.length;b++)E[b-1]=arguments[b];this.Values.push(p.Format.apply(p,h([v],E)))},C.prototype.AppendLineFormat=function(v){for(var E=[],b=1;b<arguments.length;b++)E[b-1]=arguments[b];this.Values.push("\r\n"+p.Format.apply(p,h([v],E)))},C.prototype.Clear=function(){this.Values=[]},C}();I.StringBuilder=T},7824:(_,I,h)=>{"use strict";function p(T){for(var C in T)I.hasOwnProperty(C)||(I[C]=T[C])}Object.defineProperty(I,"__esModule",{value:!0}),p(h(5085)),p(h(6243)),p(h(1786)),p(h(225)),p(h(6767)),p(h(345)),p(h(5675)),p(h(6461)),p(h(8802)),p(h(3900)),p(h(8866)),p(h(4655)),p(h(4068)),p(h(3858)),p(h(8237)),p(h(3292))},5085:function(_,I,h){"use strict";var E,p=this&&this.__extends||(E=function(b,d){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,S){f.__proto__=S}||function(f,S){for(var g in S)S.hasOwnProperty(g)&&(f[g]=S[g])})(b,d)},function(b,d){function f(){this.constructor=b}E(b,d),b.prototype=null===d?Object.create(d):(f.prototype=d.prototype,new f)});Object.defineProperty(I,"__esModule",{value:!0});var T=h(5675),C=function(E){function b(d){var f=E.call(this)||this,g=d;return g.trigger&&(f.trigger=g.trigger),g.kick&&(f.kick=g.kick),g.drag&&(f.drag=g.drag),g.on&&(f.on=g.on),f.dragstart=f.dragStart=T.Layout.dragStart,f.dragend=f.dragEnd=T.Layout.dragEnd,f}return p(b,E),b.prototype.trigger=function(d){},b.prototype.kick=function(){},b.prototype.drag=function(){},b.prototype.on=function(d,f){return this},b}(T.Layout);I.LayoutAdaptor=C,I.adaptor=function v(E){return new C(E)}},3292:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var p=h(5675),T=h(6767);I.gridify=function C(b,d,f,S){b.cola.start(0,0,0,10,!1);var g=function v(b,d,f,S){b.forEach(function(w){w.routerNode={name:w.name,bounds:w.bounds.inflate(-f)}}),d.forEach(function(w){w.routerNode={bounds:w.bounds.inflate(-S),children:(void 0!==w.groups?w.groups.map(function(m){return b.length+m.id}):[]).concat(void 0!==w.leaves?w.leaves.map(function(m){return m.index}):[])}});var g=b.concat(d).map(function(w,m){return w.routerNode.id=m,w.routerNode});return new T.GridRouter(g,{getChildren:function(w){return w.children},getBounds:function(w){return w.bounds}},f-S)}(b.cola.nodes(),b.cola.groups(),f,S);return g.routeEdges(b.powerGraph.powerEdges,d,function(w){return w.source.routerNode.id},function(w){return w.target.routerNode.id})},I.powerGraphGridLayout=function E(b,d,f){var S;b.nodes.forEach(function(O,P){return O.index=P}),(new p.Layout).avoidOverlaps(!1).nodes(b.nodes).links(b.links).powerGraphGroups(function(O){(S=O).groups.forEach(function(P){return P.padding=f})});var g=b.nodes.length,w=[],m=b.nodes.slice(0);return m.forEach(function(O,P){return O.index=P}),S.groups.forEach(function(O){var P=O.index=O.id+g;m.push(O),void 0!==O.leaves&&O.leaves.forEach(function(N){return w.push({source:P,target:N.index})}),void 0!==O.groups&&O.groups.forEach(function(N){return w.push({source:P,target:N.id+g})})}),S.powerEdges.forEach(function(O){w.push({source:O.source.index,target:O.target.index})}),(new p.Layout).size(d).nodes(m).links(w).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:(new p.Layout).convergenceThreshold(.001).size(d).avoidOverlaps(!0).nodes(b.nodes).links(b.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups(function(O){(S=O).groups.forEach(function(P){P.padding=f})}).start(50,0,100,0,!1),powerGraph:S}}},6243:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var p=h(9346),T=h(2487);I.d3adaptor=function C(E){return!E||function v(E){return E.version&&null!==E.version.match(/^3\./)}(E)?new p.D3StyleLayoutAdaptor:new T.D3StyleLayoutAdaptor(E)}},9346:function(_,I,h){"use strict";var E,p=this&&this.__extends||(E=function(b,d){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,S){f.__proto__=S}||function(f,S){for(var g in S)S.hasOwnProperty(g)&&(f[g]=S[g])})(b,d)},function(b,d){function f(){this.constructor=b}E(b,d),b.prototype=null===d?Object.create(d):(f.prototype=d.prototype,new f)});Object.defineProperty(I,"__esModule",{value:!0});var T=h(5675),C=function(E){function b(){var d=E.call(this)||this;d.event=d3.dispatch(T.EventType[T.EventType.start],T.EventType[T.EventType.tick],T.EventType[T.EventType.end]);var f=d;return d.drag=function(){if(!g)var g=d3.behavior.drag().origin(T.Layout.dragOrigin).on("dragstart.d3adaptor",T.Layout.dragStart).on("drag.d3adaptor",function(w){T.Layout.drag(w,d3.event),f.resume()}).on("dragend.d3adaptor",T.Layout.dragEnd);if(!arguments.length)return g;this.call(g)},d}return p(b,E),b.prototype.trigger=function(d){var f={type:T.EventType[d.type],alpha:d.alpha,stress:d.stress};this.event[f.type](f)},b.prototype.kick=function(){var d=this;d3.timer(function(){return E.prototype.tick.call(d)})},b.prototype.on=function(d,f){return this.event.on("string"==typeof d?d:T.EventType[d],f),this},b}(T.Layout);I.D3StyleLayoutAdaptor=C,I.d3adaptor=function v(){return new C}},2487:function(_,I,h){"use strict";var v,p=this&&this.__extends||(v=function(E,b){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,f){d.__proto__=f}||function(d,f){for(var S in f)f.hasOwnProperty(S)&&(d[S]=f[S])})(E,b)},function(E,b){function d(){this.constructor=E}v(E,b),E.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)});Object.defineProperty(I,"__esModule",{value:!0});var T=h(5675),C=function(v){function E(b){var d=v.call(this)||this;d.d3Context=b,d.event=b.dispatch(T.EventType[T.EventType.start],T.EventType[T.EventType.tick],T.EventType[T.EventType.end]);var f=d;return d.drag=function(){if(!g)var g=b.drag().subject(T.Layout.dragOrigin).on("start.d3adaptor",T.Layout.dragStart).on("drag.d3adaptor",function(w){T.Layout.drag(w,b.event),f.resume()}).on("end.d3adaptor",T.Layout.dragEnd);if(!arguments.length)return g;arguments[0].call(g)},d}return p(E,v),E.prototype.trigger=function(b){var d={type:T.EventType[b.type],alpha:b.alpha,stress:b.stress};this.event.call(d.type,d)},E.prototype.kick=function(){var b=this,d=this.d3Context.timer(function(){return v.prototype.tick.call(b)&&d.stop()})},E.prototype.on=function(b,d){return this.event.on("string"==typeof b?b:T.EventType[b],d),this},E}(T.Layout);I.D3StyleLayoutAdaptor=C},1786:(_,I)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var h=function(){function C(){this.locks={}}return C.prototype.add=function(v,E){this.locks[v]=E},C.prototype.clear=function(){this.locks={}},C.prototype.isEmpty=function(){for(var v in this.locks)return!1;return!0},C.prototype.apply=function(v){for(var E in this.locks)v(Number(E),this.locks[E])},C}();I.Locks=h;var p=function(){function C(v,E,b){void 0===b&&(b=null),this.D=E,this.G=b,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new T,this.project=null,this.x=v,this.k=v.length;var d=this.n=v[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new h,this.minD=Number.MAX_VALUE;for(var S,f=d;f--;)for(S=d;--S>f;){var g=E[f][S];g>0&&g<this.minD&&(this.minD=g)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),f=this.k;f--;){for(this.g[f]=new Array(d),this.H[f]=new Array(d),S=d;S--;)this.H[f][S]=new Array(d);this.Hd[f]=new Array(d),this.a[f]=new Array(d),this.b[f]=new Array(d),this.c[f]=new Array(d),this.d[f]=new Array(d),this.e[f]=new Array(d),this.ia[f]=new Array(d),this.ib[f]=new Array(d),this.xtmp[f]=new Array(d)}}return C.createSquareMatrix=function(v,E){for(var b=new Array(v),d=0;d<v;++d){b[d]=new Array(v);for(var f=0;f<v;++f)b[d][f]=E(d,f)}return b},C.prototype.offsetDir=function(){for(var v=this,E=new Array(this.k),b=0,d=0;d<this.k;++d){var f=E[d]=this.random.getNextBetween(.01,1)-.5;b+=f*f}return b=Math.sqrt(b),E.map(function(S){return S*(v.minD/b)})},C.prototype.computeDerivatives=function(v){var E=this,b=this.n;if(!(b<1)){for(var d,f=new Array(this.k),S=new Array(this.k),g=new Array(this.k),w=0,m=0;m<b;++m){for(d=0;d<this.k;++d)g[d]=this.g[d][m]=0;for(var O=0;O<b;++O)if(m!==O){for(var P=b;P--;){var N=0;for(d=0;d<this.k;++d){var M=f[d]=v[d][m]-v[d][O];N+=S[d]=M*M}if(N>1e-9)break;var B=this.offsetDir();for(d=0;d<this.k;++d)v[d][O]+=B[d]}var Y=Math.sqrt(N),F=this.D[m][O],$=null!=this.G?this.G[m][O]:1;if($>1&&Y>F||!isFinite(F)){for(d=0;d<this.k;++d)this.H[d][m][O]=0;continue}$>1&&($=1);var Q=F*F,ie=2*$*(Y-F)/(Q*Y),ee=Y*Y*Y,re=2*-$/(Q*ee);for(isFinite(ie)||console.log(ie),d=0;d<this.k;++d)this.g[d][m]+=f[d]*ie,g[d]-=this.H[d][m][O]=re*(ee+F*(S[d]-N)+Y*N)}for(d=0;d<this.k;++d)w=Math.max(w,this.H[d][m][m]=g[d])}var U=this.snapGridSize/2,j=this.snapGridSize,G=this.snapStrength/(U*U),H=this.numGridSnapNodes;for(m=0;m<H;++m)for(d=0;d<this.k;++d){var J=this.x[d][m],se=J/j,z=se%1,K=se-z;-U<(M=Math.abs(z)<=.5?J-K*j:J>0?J-(K+1)*j:J-(K-1)*j)&&M<=U&&(this.scaleSnapByMaxH?(this.g[d][m]+=w*G*M,this.H[d][m][m]+=w*G):(this.g[d][m]+=G*M,this.H[d][m][m]+=G))}this.locks.isEmpty()||this.locks.apply(function(ge,pe){for(d=0;d<E.k;++d)E.H[d][ge][ge]+=w,E.g[d][ge]-=w*(pe[d]-v[d][ge])})}},C.dotProd=function(v,E){for(var b=0,d=v.length;d--;)b+=v[d]*E[d];return b},C.rightMultiply=function(v,E,b){for(var d=v.length;d--;)b[d]=C.dotProd(v[d],E)},C.prototype.computeStepSize=function(v){for(var E=0,b=0,d=0;d<this.k;++d)E+=C.dotProd(this.g[d],v[d]),C.rightMultiply(this.H[d],v[d],this.Hd[d]),b+=C.dotProd(v[d],this.Hd[d]);return 0!==b&&isFinite(b)?1*E/b:0},C.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var v=this.computeStepSize(this.g),E=0;E<this.k;++E)this.takeDescentStep(this.x[E],this.g[E],v);return this.computeStress()},C.copy=function(v,E){for(var b=v.length,d=E[0].length,f=0;f<b;++f)for(var S=0;S<d;++S)E[f][S]=v[f][S]},C.prototype.stepAndProject=function(v,E,b,d){C.copy(v,E),this.takeDescentStep(E[0],b[0],d),this.project&&this.project[0](v[0],v[1],E[0]),this.takeDescentStep(E[1],b[1],d),this.project&&this.project[1](E[0],v[1],E[1]);for(var f=2;f<this.k;f++)this.takeDescentStep(E[f],b[f],d)},C.mApply=function(v,E,b){for(var d=v;d-- >0;)for(var f=E;f-- >0;)b(d,f)},C.prototype.matrixApply=function(v){C.mApply(this.k,this.n,v)},C.prototype.computeNextPosition=function(v,E){var b=this;this.computeDerivatives(v);var d=this.computeStepSize(this.g);if(this.stepAndProject(v,E,this.g,d),this.project){this.matrixApply(function(S,g){return b.e[S][g]=v[S][g]-E[S][g]});var f=this.computeStepSize(this.e);f=Math.max(.2,Math.min(f,1)),this.stepAndProject(v,E,this.e,f)}},C.prototype.run=function(v){for(var E=Number.MAX_VALUE,b=!1;!b&&v-- >0;){var d=this.rungeKutta();b=Math.abs(E/d-1)<this.threshold,E=d}return E},C.prototype.rungeKutta=function(){var v=this;this.computeNextPosition(this.x,this.a),C.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),C.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var E=0;return this.matrixApply(function(b,d){var f=(v.a[b][d]+2*v.b[b][d]+2*v.c[b][d]+v.d[b][d])/6,S=v.x[b][d]-f;E+=S*S,v.x[b][d]=f}),E},C.mid=function(v,E,b){C.mApply(v.length,v[0].length,function(d,f){return b[d][f]=v[d][f]+(E[d][f]-v[d][f])/2})},C.prototype.takeDescentStep=function(v,E,b){for(var d=0;d<this.n;++d)v[d]=v[d]-b*E[d]},C.prototype.computeStress=function(){for(var v=0,E=0,b=this.n-1;E<b;++E)for(var d=E+1,f=this.n;d<f;++d){for(var S=0,g=0;g<this.k;++g){var w=this.x[g][E]-this.x[g][d];S+=w*w}S=Math.sqrt(S);var m=this.D[E][d];if(isFinite(m)){var O=m-S;v+=O*O/(m*m)}}return v},C.zeroDistance=1e-10,C}();I.Descent=p;var T=function(){function C(v){void 0===v&&(v=1),this.seed=v,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return C.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},C.prototype.getNextBetween=function(v,E){return v+this.getNext()*(E-v)},C}();I.PseudoRandom=T},225:function(_,I,h){"use strict";var z,p=this&&this.__extends||(z=function(K,le){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ge,pe){ge.__proto__=pe}||function(ge,pe){for(var ye in pe)pe.hasOwnProperty(ye)&&(ge[ye]=pe[ye])})(K,le)},function(K,le){function ge(){this.constructor=K}z(K,le),K.prototype=null===le?Object.create(le):(ge.prototype=le.prototype,new ge)});Object.defineProperty(I,"__esModule",{value:!0});var T=h(4068),C=function z(){};I.Point=C;var v=function z(K,le,ge,pe){this.x1=K,this.y1=le,this.x2=ge,this.y2=pe};I.LineSegment=v;var E=function(z){function K(){return null!==z&&z.apply(this,arguments)||this}return p(K,z),K}(C);function b(z,K,le){return(K.x-z.x)*(le.y-z.y)-(le.x-z.x)*(K.y-z.y)}function d(z,K,le){return b(z,K,le)>0}function f(z,K,le){return b(z,K,le)<0}function O(z,K){var le=K.slice(0);return le.push(K[0]),{rtan:P(z,le),ltan:N(z,le)}}function P(z,K){var ge,pe,ye,be,le=K.length-1;if(f(z,K[1],K[0])&&!d(z,K[le-1],K[0]))return 0;for(ge=0,pe=le;;){if(pe-ge==1)return d(z,K[ge],K[pe])?ge:pe;if((be=f(z,K[(ye=Math.floor((ge+pe)/2))+1],K[ye]))&&!d(z,K[ye-1],K[ye]))return ye;d(z,K[ge+1],K[ge])?be||d(z,K[ge],K[ye])?pe=ye:ge=ye:be&&f(z,K[ge],K[ye])?pe=ye:ge=ye}}function N(z,K){var ge,pe,ye,be,le=K.length-1;if(d(z,K[le-1],K[0])&&!f(z,K[1],K[0]))return 0;for(ge=0,pe=le;;){if(pe-ge==1)return f(z,K[ge],K[pe])?ge:pe;if(be=f(z,K[(ye=Math.floor((ge+pe)/2))+1],K[ye]),d(z,K[ye-1],K[ye])&&!be)return ye;f(z,K[ge+1],K[ge])?be?f(z,K[ge],K[ye])?pe=ye:ge=ye:pe=ye:be?ge=ye:d(z,K[ge],K[ye])?pe=ye:ge=ye}}function M(z,K,le,ge,pe,ye){var Ee,be;be=ge(z[Ee=le(K[0],z)],K);for(var Me=!1;!Me;){for(Me=!0;Ee===z.length-1&&(Ee=0),!pe(K[be],z[Ee],z[Ee+1]);)++Ee;for(;0===be&&(be=K.length-1),!ye(z[Ee],K[be],K[be-1]);)--be,Me=!1}return{t1:Ee,t2:be}}function Y(z,K){return M(z,K,P,N,d,f)}I.PolyPoint=E,I.isLeft=b,I.ConvexHull=function S(z){var ge,K=z.slice(0).sort(function(ue,Se){return ue.x!==Se.x?Se.x-ue.x:Se.y-ue.y}),le=z.length,ye=K[0].x;for(ge=1;ge<le&&K[ge].x===ye;++ge);var Ee=ge-1,be=[];if(be.push(K[0]),Ee===le-1)K[Ee].y!==K[0].y&&be.push(K[Ee]);else{var Me,ae=le-1,he=K[le-1].x;for(ge=le-2;ge>=0&&K[ge].x===he;ge--);for(Me=ge+1,ge=Ee;++ge<=Me;)if(!(b(K[0],K[Me],K[ge])>=0&&ge<Me)){for(;be.length>1&&!(b(be[be.length-2],be[be.length-1],K[ge])>0);)be.length-=1;0!=ge&&be.push(K[ge])}ae!=Me&&be.push(K[ae]);var de=be.length;for(ge=Me;--ge>=Ee;)if(!(b(K[ae],K[Ee],K[ge])>=0&&ge>Ee)){for(;be.length>de&&!(b(be[be.length-2],be[be.length-1],K[ge])>0);)be.length-=1;0!=ge&&be.push(K[ge])}}return be},I.clockwiseRadialSweep=function g(z,K,le){K.slice(0).sort(function(ge,pe){return Math.atan2(ge.y-z.y,ge.x-z.x)-Math.atan2(pe.y-z.y,pe.x-z.x)}).forEach(le)},I.tangent_PolyPolyC=M,I.LRtangent_PolyPolyC=function B(z,K){var le=Y(K,z);return{t1:le.t2,t2:le.t1}},I.RLtangent_PolyPolyC=Y,I.LLtangent_PolyPolyC=function F(z,K){return M(z,K,N,N,f,f)},I.RRtangent_PolyPolyC=function $(z,K){return M(z,K,P,P,d,d)};var Q=function z(K,le){this.t1=K,this.t2=le};I.BiTangent=Q;var ie=function z(){};I.BiTangents=ie;var ee=function(z){function K(){return null!==z&&z.apply(this,arguments)||this}return p(K,z),K}(C);I.TVGPoint=ee;var re=function z(K,le,ge,pe){this.id=K,this.polyid=le,this.polyvertid=ge,this.p=pe,pe.vv=this};I.VisibilityVertex=re;var U=function(){function z(K,le){this.source=K,this.target=le}return z.prototype.length=function(){var K=this.source.p.x-this.target.p.x,le=this.source.p.y-this.target.p.y;return Math.sqrt(K*K+le*le)},z}();I.VisibilityEdge=U;var j=function(){function z(K,le){if(this.P=K,this.V=[],this.E=[],le)this.V=le.V.slice(0),this.E=le.E.slice(0);else{for(var ge=K.length,pe=0;pe<ge;pe++){for(var ye=K[pe],Ee=0;Ee<ye.length;++Ee){var Me=new re(this.V.length,pe,Ee,ye[Ee]);this.V.push(Me),Ee>0&&this.E.push(new U(ye[Ee-1].vv,Me))}ye.length>1&&this.E.push(new U(ye[0].vv,ye[ye.length-1].vv))}for(pe=0;pe<ge-1;pe++){var ae=K[pe];for(Ee=pe+1;Ee<ge;Ee++){var he=K[Ee],de=G(ae,he);for(var ue in de){var Se=de[ue];this.addEdgeIfVisible(ae[Se.t1],he[Se.t2],pe,Ee)}}}}}return z.prototype.addEdgeIfVisible=function(K,le,ge,pe){this.intersectsPolys(new v(K.x,K.y,le.x,le.y),ge,pe)||this.E.push(new U(K.vv,le.vv))},z.prototype.addPoint=function(K,le){var ge=this.P.length;this.V.push(new re(this.V.length,ge,0,K));for(var pe=0;pe<ge;++pe)if(pe!==le){var ye=this.P[pe],Ee=O(K,ye);this.addEdgeIfVisible(K,ye[Ee.ltan],le,pe),this.addEdgeIfVisible(K,ye[Ee.rtan],le,pe)}return K.vv},z.prototype.intersectsPolys=function(K,le,ge){for(var pe=0,ye=this.P.length;pe<ye;++pe)if(pe!=le&&pe!=ge&&V(K,this.P[pe]).length>0)return!0;return!1},z}();function V(z,K){for(var le=[],ge=1,pe=K.length;ge<pe;++ge){var ye=T.Rectangle.lineIntersection(z.x1,z.y1,z.x2,z.y2,K[ge-1].x,K[ge-1].y,K[ge].x,K[ge].y);ye&&le.push(ye)}return le}function G(z,K){for(var le=z.length-1,ge=K.length-1,pe=new ie,ye=0;ye<le;++ye)for(var Ee=0;Ee<ge;++Ee){var be=z[0==ye?le-1:ye-1],Me=z[ye],ae=z[ye+1],he=K[0==Ee?ge-1:Ee-1],de=K[Ee],ue=K[Ee+1],Se=b(be,Me,de),Pe=b(Me,he,de),qe=b(Me,de,ue),dt=b(he,de,Me),Ti=b(de,be,Me),mn=b(de,Me,ae);Se>=0&&Pe>=0&&qe<0&&dt>=0&&Ti>=0&&mn<0?pe.ll=new Q(ye,Ee):Se<=0&&Pe<=0&&qe>0&&dt<=0&&Ti<=0&&mn>0?pe.rr=new Q(ye,Ee):Se<=0&&Pe>0&&qe<=0&&dt>=0&&Ti<0&&mn>=0?pe.rl=new Q(ye,Ee):Se>=0&&Pe<0&&qe>=0&&dt<=0&&Ti>0&&mn<=0&&(pe.lr=new Q(ye,Ee))}return pe}function J(z,K){return!z.every(function(le){return!function H(z,K){for(var le=1,ge=K.length;le<ge;++le)if(f(K[le-1],K[le],z))return!1;return!0}(le,K)})}I.TangentVisibilityGraph=j,I.tangents=G,I.polysOverlap=function se(z,K){if(J(z,K)||J(K,z))return!0;for(var le=1,ge=z.length;le<ge;++le){var pe=z[le],ye=z[le-1];if(V(new v(ye.x,ye.y,pe.x,pe.y),K).length>0)return!0}return!1}},6767:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var p=h(4068),T=h(8237),C=h(3858),v=function f(S,g,w){this.id=S,this.rect=g,this.children=w,this.leaf=void 0===w||0===w.length};I.NodeWrapper=v;var E=function f(S,g,w,m,O){void 0===m&&(m=null),void 0===O&&(O=null),this.id=S,this.x=g,this.y=w,this.node=m,this.line=O};I.Vert=E;var b=function(){function f(S,g){this.s=S,this.t=g;var w=f.findMatch(S,g),m=g.slice(0).reverse(),O=f.findMatch(S,m);w.length>=O.length?(this.length=w.length,this.si=w.si,this.ti=w.ti,this.reversed=!1):(this.length=O.length,this.si=O.si,this.ti=g.length-O.ti-O.length,this.reversed=!0)}return f.findMatch=function(S,g){for(var w=S.length,m=g.length,O={length:0,si:-1,ti:-1},P=new Array(w),N=0;N<w;N++){P[N]=new Array(m);for(var M=0;M<m;M++)if(S[N]===g[M]){var B=P[N][M]=0===N||0===M?1:P[N-1][M-1]+1;B>O.length&&(O.length=B,O.si=N-B+1,O.ti=M-B+1)}else P[N][M]=0}return O},f.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},f}();I.LongestCommonSubsequence=b;var d=function(){function f(S,g,w){var m=this;void 0===w&&(w=12),this.originalnodes=S,this.groupPadding=w,this.leaves=null,this.nodes=S.map(function(ee,re){return new v(re,g.getBounds(ee),g.getChildren(ee))}),this.leaves=this.nodes.filter(function(ee){return ee.leaf}),this.groups=this.nodes.filter(function(ee){return!ee.leaf}),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach(function(ee){return ee.children.forEach(function(re){return m.nodes[re].parent=ee})}),this.root={children:[]},this.nodes.forEach(function(ee){void 0===ee.parent&&(ee.parent=m.root,m.root.children.push(ee.id)),ee.ports=[]}),this.backToFront=this.nodes.slice(0),this.backToFront.sort(function(ee,re){return m.getDepth(ee)-m.getDepth(re)}),this.backToFront.slice(0).reverse().filter(function(ee){return!ee.leaf}).forEach(function(ee){var re=p.Rectangle.empty();ee.children.forEach(function(U){return re=re.union(m.nodes[U].rect)}),ee.rect=re.inflate(m.groupPadding)});var P=this.midPoints(this.cols.map(function(ee){return ee.pos})),N=this.midPoints(this.rows.map(function(ee){return ee.pos})),M=P[0],B=P[P.length-1],Y=N[0],F=N[N.length-1],$=this.rows.map(function(ee){return{x1:M,x2:B,y1:ee.pos,y2:ee.pos}}).concat(N.map(function(ee){return{x1:M,x2:B,y1:ee,y2:ee}})),Q=this.cols.map(function(ee){return{x1:ee.pos,x2:ee.pos,y1:Y,y2:F}}).concat(P.map(function(ee){return{x1:ee,x2:ee,y1:Y,y2:F}})),ie=$.concat(Q);ie.forEach(function(ee){return ee.verts=[]}),this.verts=[],this.edges=[],$.forEach(function(ee){return Q.forEach(function(re){var U=new E(m.verts.length,re.x1,ee.y1);ee.verts.push(U),re.verts.push(U),m.verts.push(U);for(var j=m.backToFront.length;j-- >0;){var V=m.backToFront[j],G=V.rect,H=Math.abs(U.x-G.cx()),J=Math.abs(U.y-G.cy());if(H<G.width()/2&&J<G.height()/2){U.node=V;break}}})}),ie.forEach(function(ee,re){m.nodes.forEach(function(J,se){J.rect.lineIntersections(ee.x1,ee.y1,ee.x2,ee.y2).forEach(function(z,K){var le=new E(m.verts.length,z.x,z.y,J,ee);m.verts.push(le),ee.verts.push(le),J.ports.push(le)})});var U=Math.abs(ee.y1-ee.y2)<.1,j=function(J,se){return U?se.x-J.x:se.y-J.y};ee.verts.sort(j);for(var V=1;V<ee.verts.length;V++){var G=ee.verts[V-1],H=ee.verts[V];G.node&&G.node===H.node&&G.node.leaf||m.edges.push({source:G.id,target:H.id,length:Math.abs(j(G,H))})}})}return f.prototype.avg=function(S){return S.reduce(function(g,w){return g+w})/S.length},f.prototype.getGridLines=function(S){for(var g=[],w=this.leaves.slice(0,this.leaves.length);w.length>0;){var m=w.filter(function(P){return P.rect["overlap"+S.toUpperCase()](w[0].rect)}),O={nodes:m,pos:this.avg(m.map(function(P){return P.rect["c"+S]()}))};g.push(O),O.nodes.forEach(function(P){return w.splice(w.indexOf(P),1)})}return g.sort(function(P,N){return P.pos-N.pos}),g},f.prototype.getDepth=function(S){for(var g=0;S.parent!==this.root;)g++,S=S.parent;return g},f.prototype.midPoints=function(S){for(var g=S[1]-S[0],w=[S[0]-g/2],m=1;m<S.length;m++)w.push((S[m]+S[m-1])/2);return w.push(S[S.length-1]+g/2),w},f.prototype.findLineage=function(S){var g=[S];do{g.push(S=S.parent)}while(S!==this.root);return g.reverse()},f.prototype.findAncestorPathBetween=function(S,g){for(var w=this.findLineage(S),m=this.findLineage(g),O=0;w[O]===m[O];)O++;return{commonAncestor:w[O-1],lineages:w.slice(O).concat(m.slice(O))}},f.prototype.siblingObstacles=function(S,g){var w=this,m=this.findAncestorPathBetween(S,g),O={};m.lineages.forEach(function(N){return O[N.id]={}});var P=m.commonAncestor.children.filter(function(N){return!(N in O)});return m.lineages.filter(function(N){return N.parent!==m.commonAncestor}).forEach(function(N){return P=P.concat(N.parent.children.filter(function(M){return M!==N.id}))}),P.map(function(N){return w.nodes[N]})},f.getSegmentSets=function(S,g,w){for(var m=[],O=0;O<S.length;O++)for(var P=S[O],N=0;N<P.length;N++)(M=P[N]).edgeid=O,M.i=N,Math.abs(M[1][g]-M[0][g])<.1&&m.push(M);m.sort(function(Q,ie){return Q[0][g]-ie[0][g]});for(var Y=[],F=null,$=0;$<m.length;$++){var M=m[$];(!F||Math.abs(M[0][g]-F.pos)>.1)&&Y.push(F={pos:M[0][g],segments:[]}),F.segments.push(M)}return Y},f.nudgeSegs=function(S,g,w,m,O,P){var N=m.length;if(!(N<=1)){for(var M=m.map(function(V){return new T.Variable(V[0][S])}),B=[],Y=0;Y<N;Y++)for(var F=0;F<N;F++)if(Y!==F){var $=m[Y],ie=$.edgeid,ee=m[F].edgeid,re=-1,U=-1;"x"==S?O(ie,ee)&&($[0][g]<$[1][g]?(re=F,U=Y):(re=Y,U=F)):O(ie,ee)&&($[0][g]<$[1][g]?(re=Y,U=F):(re=F,U=Y)),re>=0&&B.push(new T.Constraint(M[re],M[U],P))}new T.Solver(M,B).solve(),M.forEach(function(V,G){var H=m[G],J=V.position();H[0][S]=H[1][S]=J;var se=w[H.edgeid];H.i>0&&(se[H.i-1][1][S]=J),H.i<se.length-1&&(se[H.i+1][0][S]=J)})}},f.nudgeSegments=function(S,g,w,m,O){for(var P=f.getSegmentSets(S,g,w),N=0;N<P.length;N++){for(var M=P[N],B=[],Y=0;Y<M.segments.length;Y++){var F=M.segments[Y];B.push({type:0,s:F,pos:Math.min(F[0][w],F[1][w])}),B.push({type:1,s:F,pos:Math.max(F[0][w],F[1][w])})}B.sort(function(ie,ee){return ie.pos-ee.pos+ie.type-ee.type});var $=[],Q=0;B.forEach(function(ie){0===ie.type?($.push(ie.s),Q++):Q--,0==Q&&(f.nudgeSegs(g,w,S,$,m,O),$=[])})}},f.prototype.routeEdges=function(S,g,w,m){var O=this,P=S.map(function(B){return O.route(w(B),m(B))}),N=f.orderEdges(P),M=P.map(function(B){return f.makeSegments(B)});return f.nudgeSegments(M,"x","y",N,g),f.nudgeSegments(M,"y","x",N,g),f.unreverseEdges(M,P),M},f.unreverseEdges=function(S,g){S.forEach(function(w,m){g[m].reversed&&(w.reverse(),w.forEach(function(P){P.reverse()}))})},f.angleBetween2Lines=function(S,g){var w=Math.atan2(S[0].y-S[1].y,S[0].x-S[1].x),m=Math.atan2(g[0].y-g[1].y,g[0].x-g[1].x),O=w-m;return(O>Math.PI||O<-Math.PI)&&(O=m-w),O},f.isLeft=function(S,g,w){return(g.x-S.x)*(w.y-S.y)-(g.y-S.y)*(w.x-S.x)<=0},f.getOrder=function(S){for(var g={},w=0;w<S.length;w++){var m=S[w];void 0===g[m.l]&&(g[m.l]={}),g[m.l][m.r]=!0}return function(O,P){return void 0!==g[O]&&g[O][P]}},f.orderEdges=function(S){for(var g=[],w=0;w<S.length-1;w++)for(var m=w+1;m<S.length;m++){var M,B,Y,O=S[w],P=S[m],N=new b(O,P);if(0!==N.length){if(N.reversed&&(P.reverse(),P.reversed=!0,N=new b(O,P)),(N.si<=0||N.ti<=0)&&(N.si+N.length>=O.length||N.ti+N.length>=P.length)){g.push({l:w,r:m});continue}N.si+N.length>=O.length||N.ti+N.length>=P.length?(M=O[N.si+1],Y=O[N.si-1],B=P[N.ti-1]):(M=O[N.si+N.length-2],B=O[N.si+N.length],Y=P[N.ti+N.length]),f.isLeft(M,B,Y)?g.push({l:m,r:w}):g.push({l:w,r:m})}}return f.getOrder(g)},f.makeSegments=function(S){function g(B){return{x:B.x,y:B.y}}for(var m=[],O=g(S[0]),P=1;P<S.length;P++){var N=g(S[P]),M=P<S.length-1?S[P+1]:null;(!M||(B=O,Y=N,F=M,!(Math.abs((Y.x-B.x)*(F.y-B.y)-(Y.y-B.y)*(F.x-B.x))<.001)))&&(m.push([O,N]),O=N)}var B,Y,F;return m},f.prototype.route=function(S,g){var w=this,m=this.nodes[S],O=this.nodes[g];this.obstacles=this.siblingObstacles(m,O);var P={};this.obstacles.forEach(function(U){return P[U.id]=U}),this.passableEdges=this.edges.filter(function(U){var j=w.verts[U.source],V=w.verts[U.target];return!(j.node&&j.node.id in P||V.node&&V.node.id in P)});for(var N=1;N<m.ports.length;N++)this.passableEdges.push({source:m.ports[0].id,target:m.ports[N].id,length:0});for(N=1;N<O.ports.length;N++)this.passableEdges.push({source:O.ports[0].id,target:O.ports[N].id,length:0});var re=new C.Calculator(this.verts.length,this.passableEdges,function(U){return U.source},function(U){return U.target},function(U){return U.length}).PathFromNodeToNodeWithPrevCost(m.ports[0].id,O.ports[0].id,function(U,j,V){var G=w.verts[U],H=w.verts[j],J=w.verts[V],se=Math.abs(J.x-G.x),z=Math.abs(J.y-G.y);return G.node===m&&G.node===H.node||H.node===O&&H.node===J.node?0:se>1&&z>1?1e3:0}).reverse().map(function(U){return w.verts[U]});return re.push(this.nodes[O.id].ports[0]),re.filter(function(U,j){return!(j<re.length-1&&re[j+1].node===m&&U.node===m||j>0&&U.node===O&&re[j-1].node===O)})},f.getRoutePath=function(S,g,w,m){var N,M,B,se,z,O={routepath:"M "+S[0][0].x+" "+S[0][0].y+" ",arrowpath:""};if(S.length>1)for(var P=0;P<S.length;P++){var Y=(M=(N=S[P])[1].x)-N[0].x,F=(B=N[1].y)-N[0].y;if(P<S.length-1){Math.abs(Y)>0?M-=Y/Math.abs(Y)*g:B-=F/Math.abs(F)*g,O.routepath+="L "+M+" "+B+" ";var $=S[P+1],Q=$[0].x,ie=$[0].y;Y=$[1].x-Q,F=$[1].y-ie;var j,V,U=f.angleBetween2Lines(N,$)<0?1:0;Math.abs(Y)>0?(j=Q+Y/Math.abs(Y)*g,V=ie):(j=Q,V=ie+F/Math.abs(F)*g);var G=Math.abs(j-M),H=Math.abs(V-B);O.routepath+="A "+G+" "+H+" 0 0 "+U+" "+j+" "+V+" "}else{var J=[M,B];Math.abs(Y)>0?(se=[M-=Y/Math.abs(Y)*m,B+w],z=[M,B-w]):(se=[M+w,B-=F/Math.abs(F)*m],z=[M-w,B]),O.routepath+="L "+M+" "+B+" ",m>0&&(O.arrowpath="M "+J[0]+" "+J[1]+" L "+se[0]+" "+se[1]+" L "+z[0]+" "+z[1])}}else Y=(M=(N=S[0])[1].x)-N[0].x,F=(B=N[1].y)-N[0].y,J=[M,B],Math.abs(Y)>0?(se=[M-=Y/Math.abs(Y)*m,B+w],z=[M,B-w]):(se=[M+w,B-=F/Math.abs(F)*m],z=[M-w,B]),O.routepath+="L "+M+" "+B+" ",m>0&&(O.arrowpath="M "+J[0]+" "+J[1]+" L "+se[0]+" "+se[1]+" L "+z[0]+" "+z[1]);return O},f}();I.GridRouter=d},345:(_,I)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var h_GOLDEN_SECTION=(1+Math.sqrt(5))/2;I.applyPacking=function p(C,v,E,P,O,f){void 0===O&&(O=1),void 0===f&&(f=!0);var w=v,m=E,N=(O=void 0!==O?O:1,P=void 0!==P?P:0,0),M=0,B=0,Y=0,F=[];function ee(V,G){F=[],N=0,M=0,Y=0;for(var H=0;H<V.length;H++)re(V[H],G);return Math.abs(function j(){return N/M}()-O)}function re(V,G){for(var H=void 0,J=0;J<F.length;J++)if(F[J].space_left>=V.height&&F[J].x+F[J].width+V.width+10-G<=1e-4){H=F[J];break}F.push(V),void 0!==H?(V.x=H.x+H.width+10,V.y=H.bottom,V.space_left=V.height,V.bottom=V.y,H.space_left-=V.height+10,H.bottom+=V.height+10):(V.y=Y,Y+=V.height+10,V.x=0,V.bottom=V.y,V.space_left=V.height),V.y+V.height-M>-1e-4&&(M=V.y+V.height-0),V.x+V.width-N>-1e-4&&(N=V.x+V.width-0)}0!=C.length&&(function $(V){V.forEach(function(H){!function G(H){var J=Number.MAX_VALUE,se=Number.MAX_VALUE,z=0,K=0;H.array.forEach(function(le){var ge=void 0!==le.width?le.width:P,pe=void 0!==le.height?le.height:P;ge/=2,pe/=2,z=Math.max(le.x+ge,z),J=Math.min(le.x-ge,J),K=Math.max(le.y+pe,K),se=Math.min(le.y-pe,se)}),H.width=z-J,H.height=K-se}(H)})}(C),function ie(V,G){var H=Number.POSITIVE_INFINITY,J=0;V.sort(function(ae,he){return he.height-ae.height});for(var se=be=B=V.reduce(function(ae,he){return ae.width<he.width?ae.width:he.width}),z=Me=function U(V){var G=0;return V.forEach(function(H){return G+=H.width+10}),G}(V),K=0,le=Number.MAX_VALUE,ge=Number.MAX_VALUE,pe=-1,ye=Number.MAX_VALUE,Ee=Number.MAX_VALUE;ye>B||Ee>1e-4;){if(1!=pe){var be=z-(z-se)/h_GOLDEN_SECTION;le=ee(V,be)}if(0!=pe){var Me=se+(z-se)/h_GOLDEN_SECTION;ge=ee(V,Me)}if(ye=Math.abs(be-Me),Ee=Math.abs(le-ge),le<H&&(H=le,J=be),ge<H&&(H=ge,J=Me),le>ge?(se=be,be=Me,le=ge,pe=1):(z=Me,Me=be,ge=le,pe=0),K++>100)break}ee(V,J)}(C),f&&function Q(V){V.forEach(function(G){var H={x:0,y:0};G.array.forEach(function(z){H.x+=z.x,H.y+=z.y}),H.x/=G.array.length,H.y/=G.array.length;var se_x=G.x-(H.x-G.width/2)+w/2-N/2,se_y=G.y-(H.y-G.height/2)+m/2-M/2;G.array.forEach(function(z){z.x+=se_x,z.y+=se_y})})}(C))},I.separateGraphs=function T(C,v){for(var E={},b={},d=[],f=0,S=0;S<v.length;S++){var g=v[S],w=g.source,m=g.target;b[w.index]?b[w.index].push(m):b[w.index]=[m],b[m.index]?b[m.index].push(w):b[m.index]=[w]}for(S=0;S<C.length;S++){var O=C[S];E[O.index]||P(O,!0)}function P(N,M){if(void 0===E[N.index]){M&&(f++,d.push({array:[]})),E[N.index]=f,d[f-1].array.push(N);var B=b[N.index];if(B)for(var Y=0;Y<B.length;Y++)P(B[Y],!1)}}return d}},5675:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var f,w,p=h(3900),T=h(8802),C=h(1786),v=h(4068),E=h(3858),b=h(225),d=h(345);function S(w){return void 0!==w.leaves||void 0!==w.groups}(w=f=I.EventType||(I.EventType={}))[w.start=0]="start",w[w.tick=1]="tick",w[w.end=2]="end";var g=function(){function w(){var m=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:w.getSourceIndex,getTargetIndex:w.getTargetIndex,setLength:w.setLinkLength,getType:function(O){return"function"==typeof m._linkType?m._linkType(O):0}}}return w.prototype.on=function(m,O){return this.event||(this.event={}),"string"==typeof m?this.event[f[m]]=O:this.event[m]=O,this},w.prototype.trigger=function(m){this.event&&void 0!==this.event[m.type]&&this.event[m.type](m)},w.prototype.kick=function(){for(;!this.tick(););},w.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:f.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var P,N,m=this._nodes.length;for(this._descent.locks.clear(),N=0;N<m;++N)(P=this._nodes[N]).fixed&&((void 0===P.px||void 0===P.py)&&(P.px=P.x,P.py=P.y),this._descent.locks.add(N,[P.px,P.py]));var B=this._descent.rungeKutta();return 0===B?this._alpha=0:void 0!==this._lastStress&&(this._alpha=B),this._lastStress=B,this.updateNodePositions(),this.trigger({type:f.tick,alpha:this._alpha,stress:this._lastStress}),!1},w.prototype.updateNodePositions=function(){for(var P,m=this._descent.x[0],O=this._descent.x[1],N=this._nodes.length;N--;)(P=this._nodes[N]).x=m[N],P.y=O[N]},w.prototype.nodes=function(m){if(!m){if(0===this._nodes.length&&this._links.length>0){var O=0;this._links.forEach(function(N){O=Math.max(O,N.source,N.target)}),this._nodes=new Array(++O);for(var P=0;P<O;++P)this._nodes[P]={}}return this._nodes}return this._nodes=m,this},w.prototype.groups=function(m){var O=this;return m?(this._groups=m,this._rootGroup={},this._groups.forEach(function(P){void 0===P.padding&&(P.padding=1),void 0!==P.leaves&&P.leaves.forEach(function(N,M){"number"==typeof N&&((P.leaves[M]=O._nodes[N]).parent=P)}),void 0!==P.groups&&P.groups.forEach(function(N,M){"number"==typeof N&&((P.groups[M]=O._groups[N]).parent=P)})}),this._rootGroup.leaves=this._nodes.filter(function(P){return void 0===P.parent}),this._rootGroup.groups=this._groups.filter(function(P){return void 0===P.parent}),this):this._groups},w.prototype.powerGraphGroups=function(m){var O=p.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(O.groups),m(O),this},w.prototype.avoidOverlaps=function(m){return arguments.length?(this._avoidOverlaps=m,this):this._avoidOverlaps},w.prototype.handleDisconnected=function(m){return arguments.length?(this._handleDisconnected=m,this):this._handleDisconnected},w.prototype.flowLayout=function(m,O){return arguments.length||(m="y"),this._directedLinkConstraints={axis:m,getMinSeparation:"number"==typeof O?function(){return O}:O},this},w.prototype.links=function(m){return arguments.length?(this._links=m,this):this._links},w.prototype.constraints=function(m){return arguments.length?(this._constraints=m,this):this._constraints},w.prototype.distanceMatrix=function(m){return arguments.length?(this._distanceMatrix=m,this):this._distanceMatrix},w.prototype.size=function(m){return m?(this._canvasSize=m,this):this._canvasSize},w.prototype.defaultNodeSize=function(m){return m?(this._defaultNodeSize=m,this):this._defaultNodeSize},w.prototype.groupCompactness=function(m){return m?(this._groupCompactness=m,this):this._groupCompactness},w.prototype.linkDistance=function(m){return m?(this._linkDistance="function"==typeof m?m:+m,this._linkLengthCalculator=null,this):this._linkDistance},w.prototype.linkType=function(m){return this._linkType=m,this},w.prototype.convergenceThreshold=function(m){return m?(this._threshold="function"==typeof m?m:+m,this):this._threshold},w.prototype.alpha=function(m){return arguments.length?(m=+m,this._alpha?this._alpha=m>0?m:0:m>0&&(this._running||(this._running=!0,this.trigger({type:f.start,alpha:this._alpha=m}),this.kick())),this):this._alpha},w.prototype.getLinkLength=function(m){return"function"==typeof this._linkDistance?+this._linkDistance(m):this._linkDistance},w.setLinkLength=function(m,O){m.length=O},w.prototype.getLinkType=function(m){return"function"==typeof this._linkType?this._linkType(m):0},w.prototype.symmetricDiffLinkLengths=function(m,O){var P=this;return void 0===O&&(O=1),this.linkDistance(function(N){return m*N.length}),this._linkLengthCalculator=function(){return T.symmetricDiffLinkLengths(P._links,P.linkAccessor,O)},this},w.prototype.jaccardLinkLengths=function(m,O){var P=this;return void 0===O&&(O=1),this.linkDistance(function(N){return m*N.length}),this._linkLengthCalculator=function(){return T.jaccardLinkLengths(P._links,P.linkAccessor,O)},this},w.prototype.start=function(m,O,P,N,M,B){var Y=this;void 0===m&&(m=0),void 0===O&&(O=0),void 0===P&&(P=0),void 0===N&&(N=0),void 0===M&&(M=!0),void 0===B&&(B=!0);var J,Q=this.nodes().length,ie=Q+2*this._groups.length,re=this._canvasSize[0],U=this._canvasSize[1],j=new Array(ie),V=new Array(ie),G=null,H=this._avoidOverlaps;this._nodes.forEach(function(ye,Ee){ye.index=Ee,void 0===ye.x&&(ye.x=re/2,ye.y=U/2),j[Ee]=ye.x,V[Ee]=ye.y}),this._linkLengthCalculator&&this._linkLengthCalculator(),this._distanceMatrix?J=this._distanceMatrix:(J=new E.Calculator(ie,this._links,w.getSourceIndex,w.getTargetIndex,function(ye){return Y.getLinkLength(ye)}).DistanceMatrix(),G=C.Descent.createSquareMatrix(ie,function(){return 2}),this._links.forEach(function(ye){"number"==typeof ye.source&&(ye.source=Y._nodes[ye.source]),"number"==typeof ye.target&&(ye.target=Y._nodes[ye.target])}),this._links.forEach(function(ye){var Ee=w.getSourceIndex(ye),be=w.getTargetIndex(ye);G[Ee][be]=G[be][Ee]=ye.weight||1}));var se=C.Descent.createSquareMatrix(ie,function(ye,Ee){return J[ye][Ee]});if(this._rootGroup&&void 0!==this._rootGroup.groups){var F=Q;this._groups.forEach(function(Ee){(function(Ee,be,Me,ae){G[Ee][be]=G[be][Ee]=Me,se[Ee][be]=se[be][Ee]=.1})(F,F+1,Y._groupCompactness),j[F]=0,V[F++]=0,j[F]=0,V[F++]=0})}else this._rootGroup={leaves:this._nodes,groups:[]};var K=this._constraints||[];for(this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,K=K.concat(T.generateDirectedEdgeConstraints(Q,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new C.Descent([j,V],se),this._descent.locks.clear(),F=0;F<Q;++F){var le=this._nodes[F];le.fixed&&(le.px=le.x,le.py=le.y,this._descent.locks.add(F,[le.x,le.y]))}if(this._descent.threshold=this._threshold,this.initialLayout(m,j,V),K.length>0&&(this._descent.project=new v.Projection(this._nodes,this._groups,this._rootGroup,K).projectFunctions()),this._descent.run(O),this.separateOverlappingComponents(re,U,B),this.avoidOverlaps(H),H&&(this._nodes.forEach(function(ye,Ee){ye.x=j[Ee],ye.y=V[Ee]}),this._descent.project=new v.Projection(this._nodes,this._groups,this._rootGroup,K,!0).projectFunctions(),this._nodes.forEach(function(ye,Ee){j[Ee]=ye.x,V[Ee]=ye.y})),this._descent.G=G,this._descent.run(P),N){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=Q,this._descent.scaleSnapByMaxH=Q!=ie;var pe=C.Descent.createSquareMatrix(ie,function(ye,Ee){return ye>=Q||Ee>=Q?G[ye][Ee]:0});this._descent.G=pe,this._descent.run(N)}return this.updateNodePositions(),this.separateOverlappingComponents(re,U,B),M?this.resume():this},w.prototype.initialLayout=function(m,O,P){if(this._groups.length>0&&m>0){var N=this._nodes.length,M=this._links.map(function(Y){return{source:Y.source.index,target:Y.target.index}}),B=this._nodes.map(function(Y){return{index:Y.index}});this._groups.forEach(function(Y,F){B.push({index:Y.index=N+F})}),this._groups.forEach(function(Y,F){void 0!==Y.leaves&&Y.leaves.forEach(function($){return M.push({source:Y.index,target:$.index})}),void 0!==Y.groups&&Y.groups.forEach(function($){return M.push({source:Y.index,target:$.index})})}),(new w).size(this.size()).nodes(B).links(M).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(m,0,0,0,!1),this._nodes.forEach(function(Y){O[Y.index]=B[Y.index].x,P[Y.index]=B[Y.index].y})}else this._descent.run(m)},w.prototype.separateOverlappingComponents=function(m,O,P){var N=this;if(void 0===P&&(P=!0),!this._distanceMatrix&&this._handleDisconnected){var M=this._descent.x[0],B=this._descent.x[1];this._nodes.forEach(function(F,$){F.x=M[$],F.y=B[$]});var Y=d.separateGraphs(this._nodes,this._links);d.applyPacking(Y,m,O,this._defaultNodeSize,1,P),this._nodes.forEach(function(F,$){N._descent.x[0][$]=F.x,N._descent.x[1][$]=F.y,F.bounds&&(F.bounds.setXCentre(F.x),F.bounds.setYCentre(F.y))})}},w.prototype.resume=function(){return this.alpha(.1)},w.prototype.stop=function(){return this.alpha(0)},w.prototype.prepareEdgeRouting=function(m){void 0===m&&(m=0),this._visibilityGraph=new b.TangentVisibilityGraph(this._nodes.map(function(O){return O.bounds.inflate(-m).vertices()}))},w.prototype.routeEdge=function(m,O,P){void 0===O&&(O=5);var N=[],M=new b.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),B={x:m.source.x,y:m.source.y},Y={x:m.target.x,y:m.target.y},F=M.addPoint(B,m.source.index),$=M.addPoint(Y,m.target.index);M.addEdgeIfVisible(B,Y,m.source.index,m.target.index),void 0!==P&&P(M);var U=new E.Calculator(M.V.length,M.E,function(se){return se.source.id},function(se){return se.target.id},function(se){return se.length()}).PathFromNodeToNode(F.id,$.id);if(1===U.length||U.length===M.V.length){var j=v.makeEdgeBetween(m.source.innerBounds,m.target.innerBounds,O);N=[j.sourceIntersection,j.arrowStart]}else{for(var V=U.length-2,G=M.V[U[V]].p,H=M.V[U[0]].p,J=(N=[m.source.innerBounds.rayIntersection(G.x,G.y)],V);J>=0;--J)N.push(M.V[U[J]].p);N.push(v.makeEdgeTo(H,m.target.innerBounds,O))}return N},w.getSourceIndex=function(m){return"number"==typeof m.source?m.source:m.source.index},w.getTargetIndex=function(m){return"number"==typeof m.target?m.target:m.target.index},w.linkId=function(m){return w.getSourceIndex(m)+"-"+w.getTargetIndex(m)},w.dragStart=function(m){S(m)?w.storeOffset(m,w.dragOrigin(m)):(w.stopNode(m),m.fixed|=2)},w.stopNode=function(m){m.px=m.x,m.py=m.y},w.storeOffset=function(m,O){void 0!==m.leaves&&m.leaves.forEach(function(P){P.fixed|=2,w.stopNode(P),P._dragGroupOffsetX=P.x-O.x,P._dragGroupOffsetY=P.y-O.y}),void 0!==m.groups&&m.groups.forEach(function(P){return w.storeOffset(P,O)})},w.dragOrigin=function(m){return S(m)?{x:m.bounds.cx(),y:m.bounds.cy()}:m},w.drag=function(m,O){S(m)?(void 0!==m.leaves&&m.leaves.forEach(function(P){m.bounds.setXCentre(O.x),m.bounds.setYCentre(O.y),P.px=P._dragGroupOffsetX+O.x,P.py=P._dragGroupOffsetY+O.y}),void 0!==m.groups&&m.groups.forEach(function(P){return w.drag(P,O)})):(m.px=O.x,m.py=O.y)},w.dragEnd=function(m){S(m)?(void 0!==m.leaves&&m.leaves.forEach(function(O){w.dragEnd(O),delete O._dragGroupOffsetX,delete O._dragGroupOffsetY}),void 0!==m.groups&&m.groups.forEach(w.dragEnd)):m.fixed&=-7},w.mouseOver=function(m){m.fixed|=4,m.px=m.x,m.py=m.y},w.mouseOut=function(m){m.fixed&=-5},w}();I.Layout=g},6461:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var p=h(3858),T=h(1786),C=h(4068),v=h(8802),E=function(){function S(g,w){this.source=g,this.target=w}return S.prototype.actualLength=function(g){var w=this;return Math.sqrt(g.reduce(function(m,O){var P=O[w.target]-O[w.source];return m+P*P},0))},S}();I.Link3D=E,I.Node3D=function S(g,w,m){void 0===g&&(g=0),void 0===w&&(w=0),void 0===m&&(m=0),this.x=g,this.y=w,this.z=m};var d=function(){function S(g,w,m){var O=this;void 0===m&&(m=1),this.nodes=g,this.links=w,this.idealLinkLength=m,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(S.k);for(var P=0;P<S.k;++P)this.result[P]=new Array(g.length);g.forEach(function(N,M){for(var B=0,Y=S.dims;B<Y.length;B++){var F=Y[B];void 0===N[F]&&(N[F]=Math.random())}O.result[0][M]=N.x,O.result[1][M]=N.y,O.result[2][M]=N.z})}return S.prototype.linkLength=function(g){return g.actualLength(this.result)},S.prototype.start=function(g){var w=this;void 0===g&&(g=100);var m=this.nodes.length,O=new f;this.useJaccardLinkLengths&&v.jaccardLinkLengths(this.links,O,1.5),this.links.forEach(function(F){return F.length*=w.idealLinkLength});var P=new p.Calculator(m,this.links,function(F){return F.source},function(F){return F.target},function(F){return F.length}).DistanceMatrix(),N=T.Descent.createSquareMatrix(m,function(F,$){return P[F][$]}),M=T.Descent.createSquareMatrix(m,function(){return 2});this.links.forEach(function(F){var $=F.source,Q=F.target;return M[$][Q]=M[Q][$]=1}),this.descent=new T.Descent(this.result,N),this.descent.threshold=.001,this.descent.G=M,this.constraints&&(this.descent.project=new C.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var B=0;B<this.nodes.length;B++){var Y=this.nodes[B];Y.fixed&&this.descent.locks.add(B,[Y.x,Y.y,Y.z])}return this.descent.run(g),this},S.prototype.tick=function(){this.descent.locks.clear();for(var g=0;g<this.nodes.length;g++){var w=this.nodes[g];w.fixed&&this.descent.locks.add(g,[w.x,w.y,w.z])}return this.descent.rungeKutta()},S.k=(S.dims=["x","y","z"]).length,S}();I.Layout3D=d;var f=function(){function S(){}return S.prototype.getSourceIndex=function(g){return g.source},S.prototype.getTargetIndex=function(g){return g.target},S.prototype.getLength=function(g){return g.length},S.prototype.setLength=function(g,w){g.length=w},S}()},8802:(_,I)=>{"use strict";function h(f,S){var g={};for(var w in f)g[w]={};for(var w in S)g[w]={};return Object.keys(g).length}function p(f,S){var g=0;for(var w in f)void 0!==S[w]&&++g;return g}function C(f,S,g,w){var m=function T(f,S){var g={},w=function(m,O){void 0===g[m]&&(g[m]={}),g[m][O]={}};return f.forEach(function(m){var O=S.getSourceIndex(m),P=S.getTargetIndex(m);w(O,P),w(P,O)}),g}(f,w);f.forEach(function(O){var P=m[w.getSourceIndex(O)],N=m[w.getTargetIndex(O)];w.setLength(O,1+S*g(P,N))})}function d(f,S,g){var w=[],m=0,O=[],P=[];function N(U){U.index=U.lowlink=m++,O.push(U),U.onStack=!0;for(var j=0,V=U.out;j<V.length;j++){var G=V[j];void 0===G.index?(N(G),U.lowlink=Math.min(U.lowlink,G.lowlink)):G.onStack&&(U.lowlink=Math.min(U.lowlink,G.index))}if(U.lowlink===U.index){for(var H=[];O.length&&((G=O.pop()).onStack=!1,H.push(G),G!==U););P.push(H.map(function(J){return J.id}))}}for(var M=0;M<f;M++)w.push({id:M,out:[]});for(var B=0,Y=S;B<Y.length;B++){var F=Y[B],$=w[g.getSourceIndex(F)],Q=w[g.getTargetIndex(F)];$.out.push(Q)}for(var ie=0,ee=w;ie<ee.length;ie++){var re=ee[ie];void 0===re.index&&N(re)}return P}Object.defineProperty(I,"__esModule",{value:!0}),I.symmetricDiffLinkLengths=function v(f,S,g){void 0===g&&(g=1),C(f,g,function(w,m){return Math.sqrt(h(w,m)-p(w,m))},S)},I.jaccardLinkLengths=function E(f,S,g){void 0===g&&(g=1),C(f,g,function(w,m){return Math.min(Object.keys(w).length,Object.keys(m).length)<1.1?0:p(w,m)/h(w,m)},S)},I.generateDirectedEdgeConstraints=function b(f,S,g,w){var m=d(f,S,w),O={};m.forEach(function(N,M){return N.forEach(function(B){return O[B]=M})});var P=[];return S.forEach(function(N){var M=w.getSourceIndex(N),B=w.getTargetIndex(N);O[M]!==O[B]&&P.push({axis:g,left:M,right:B,gap:w.getMinSeparation(N)})}),P},I.stronglyConnectedComponents=d},3900:(_,I)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var h=function S(g,w,m){this.source=g,this.target=w,this.type=m};I.PowerEdge=h;var p=function(){function S(g,w,m,O){var P=this;if(this.linkAccessor=m,this.modules=new Array(g),this.roots=[],O)this.initModulesFromGroup(O);else{this.roots.push(new E);for(var N=0;N<g;++N)this.roots[0].add(this.modules[N]=new C(N))}this.R=w.length,w.forEach(function(M){var B=P.modules[m.getSourceIndex(M)],Y=P.modules[m.getTargetIndex(M)],F=m.getType(M);B.outgoing.add(F,Y),Y.incoming.add(F,B)})}return S.prototype.initModulesFromGroup=function(g){var w=new E;this.roots.push(w);for(var m=0;m<g.leaves.length;++m){var O=g.leaves[m],P=new C(O.id);this.modules[O.id]=P,w.add(P)}if(g.groups)for(var N=0;N<g.groups.length;++N){var M=g.groups[N],B={};for(var Y in M)"leaves"!==Y&&"groups"!==Y&&M.hasOwnProperty(Y)&&(B[Y]=M[Y]);w.add(new C(-1-N,new b,new b,this.initModulesFromGroup(M),B))}return w},S.prototype.merge=function(g,w,m){void 0===m&&(m=0);var O=g.incoming.intersection(w.incoming),P=g.outgoing.intersection(w.outgoing),N=new E;N.add(g),N.add(w);var M=new C(this.modules.length,P,O,N);this.modules.push(M);var B=function(Y,F,$){Y.forAll(function(Q,ie){Q.forAll(function(ee){var re=ee[F];re.add(ie,M),re.remove(ie,g),re.remove(ie,w),g[$].remove(ie,ee),w[$].remove(ie,ee)})})};return B(P,"incoming","outgoing"),B(O,"outgoing","incoming"),this.R-=O.count()+P.count(),this.roots[m].remove(g),this.roots[m].remove(w),this.roots[m].add(M),M},S.prototype.rootMerges=function(g){void 0===g&&(g=0);for(var w=this.roots[g].modules(),m=w.length,O=new Array(m*(m-1)),P=0,N=0,M=m-1;N<M;++N)for(var B=N+1;B<m;++B){var Y=w[N],F=w[B];O[P]={id:P,nEdges:this.nEdges(Y,F),a:Y,b:F},P++}return O},S.prototype.greedyMerge=function(){for(var g=0;g<this.roots.length;++g)if(!(this.roots[g].modules().length<2)){var m=this.rootMerges(g).sort(function(O,P){return O.nEdges==P.nEdges?O.id-P.id:O.nEdges-P.nEdges})[0];if(!(m.nEdges>=this.R))return this.merge(m.a,m.b,g),!0}},S.prototype.nEdges=function(g,w){var m=g.incoming.intersection(w.incoming),O=g.outgoing.intersection(w.outgoing);return this.R-m.count()-O.count()},S.prototype.getGroupHierarchy=function(g){var w=this,m=[];return T(this.roots[0],{},m),this.allEdges().forEach(function(N){var M=w.modules[N.source],B=w.modules[N.target];g.push(new h(void 0===M.gid?N.source:m[M.gid],void 0===B.gid?N.target:m[B.gid],N.type))}),m},S.prototype.allEdges=function(){var g=[];return S.getEdges(this.roots[0],g),g},S.getEdges=function(g,w){g.forAll(function(m){m.getEdges(w),S.getEdges(m.children,w)})},S}();function T(S,g,w){S.forAll(function(m){if(m.isLeaf())g.leaves||(g.leaves=[]),g.leaves.push(m.id);else{var O=g;if(m.gid=w.length,!m.isIsland()||m.isPredefined()){if(O={id:m.gid},m.isPredefined())for(var P in m.definition)O[P]=m.definition[P];g.groups||(g.groups=[]),g.groups.push(m.gid),w.push(O)}T(m.children,O,w)}})}I.Configuration=p;var C=function(){function S(g,w,m,O,P){void 0===w&&(w=new b),void 0===m&&(m=new b),void 0===O&&(O=new E),this.id=g,this.outgoing=w,this.incoming=m,this.children=O,this.definition=P}return S.prototype.getEdges=function(g){var w=this;this.outgoing.forAll(function(m,O){m.forAll(function(P){g.push(new h(w.id,P.id,O))})})},S.prototype.isLeaf=function(){return 0===this.children.count()},S.prototype.isIsland=function(){return 0===this.outgoing.count()&&0===this.incoming.count()},S.prototype.isPredefined=function(){return void 0!==this.definition},S}();I.Module=C;var E=function(){function S(){this.table={}}return S.prototype.count=function(){return Object.keys(this.table).length},S.prototype.intersection=function(g){var w=new S;return w.table=function v(S,g){var w={};for(var m in S)m in g&&(w[m]=S[m]);return w}(this.table,g.table),w},S.prototype.intersectionCount=function(g){return this.intersection(g).count()},S.prototype.contains=function(g){return g in this.table},S.prototype.add=function(g){this.table[g.id]=g},S.prototype.remove=function(g){delete this.table[g.id]},S.prototype.forAll=function(g){for(var w in this.table)g(this.table[w])},S.prototype.modules=function(){var g=[];return this.forAll(function(w){w.isPredefined()||g.push(w)}),g},S}();I.ModuleSet=E;var b=function(){function S(){this.sets={},this.n=0}return S.prototype.count=function(){return this.n},S.prototype.contains=function(g){var w=!1;return this.forAllModules(function(m){!w&&m.id==g&&(w=!0)}),w},S.prototype.add=function(g,w){(g in this.sets?this.sets[g]:this.sets[g]=new E).add(w),++this.n},S.prototype.remove=function(g,w){var m=this.sets[g];m.remove(w),0===m.count()&&delete this.sets[g],--this.n},S.prototype.forAll=function(g){for(var w in this.sets)g(this.sets[w],Number(w))},S.prototype.forAllModules=function(g){this.forAll(function(w,m){return w.forAll(g)})},S.prototype.intersection=function(g){var w=new S;return this.forAll(function(m,O){if(O in g.sets){var P=m.intersection(g.sets[O]),N=P.count();N>0&&(w.sets[O]=P,w.n+=N)}}),w},S}();I.LinkSets=b,I.getGroups=function f(S,g,w,m){for(var P=new p(S.length,g,w,m);P.greedyMerge(););var N=[],M=P.getGroupHierarchy(N);return N.forEach(function(B){var Y=function(F){var $=B[F];"number"==typeof $&&(B[F]=S[$])};Y("source"),Y("target")}),{groups:M,powerEdges:N}}},8866:(_,I)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var h=function(){function T(C){this.elem=C,this.subheaps=[]}return T.prototype.toString=function(C){for(var v="",E=!1,b=0;b<this.subheaps.length;++b){var d=this.subheaps[b];d.elem?(E&&(v+=","),v+=d.toString(C),E=!0):E=!1}return""!==v&&(v="("+v+")"),(this.elem?C(this.elem):"")+v},T.prototype.forEach=function(C){this.empty()||(C(this.elem,this),this.subheaps.forEach(function(v){return v.forEach(C)}))},T.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce(function(C,v){return C+v.count()},0)},T.prototype.min=function(){return this.elem},T.prototype.empty=function(){return null==this.elem},T.prototype.contains=function(C){if(this===C)return!0;for(var v=0;v<this.subheaps.length;v++)if(this.subheaps[v].contains(C))return!0;return!1},T.prototype.isHeap=function(C){var v=this;return this.subheaps.every(function(E){return C(v.elem,E.elem)&&E.isHeap(C)})},T.prototype.insert=function(C,v){return this.merge(new T(C),v)},T.prototype.merge=function(C,v){return this.empty()?C:C.empty()?this:v(this.elem,C.elem)?(this.subheaps.push(C),this):(C.subheaps.push(this),C)},T.prototype.removeMin=function(C){return this.empty()?null:this.mergePairs(C)},T.prototype.mergePairs=function(C){if(0==this.subheaps.length)return new T(null);if(1==this.subheaps.length)return this.subheaps[0];var v=this.subheaps.pop().merge(this.subheaps.pop(),C),E=this.mergePairs(C);return v.merge(E,C)},T.prototype.decreaseKey=function(C,v,E,b){var d=C.removeMin(b);C.elem=d.elem,C.subheaps=d.subheaps,null!==E&&null!==d.elem&&E(C.elem,C);var f=new T(v);return null!==E&&E(v,f),this.merge(f,b)},T}();I.PairingHeap=h;var p=function(){function T(C){this.lessThan=C}return T.prototype.top=function(){return this.empty()?null:this.root.elem},T.prototype.push=function(){for(var C=[],v=0;v<arguments.length;v++)C[v]=arguments[v];for(var E,d,b=0;d=C[b];++b)E=new h(d),this.root=this.empty()?E:this.root.merge(E,this.lessThan);return E},T.prototype.empty=function(){return!this.root||!this.root.elem},T.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},T.prototype.forEach=function(C){this.root.forEach(C)},T.prototype.pop=function(){if(this.empty())return null;var C=this.root.min();return this.root=this.root.removeMin(this.lessThan),C},T.prototype.reduceKey=function(C,v,E){void 0===E&&(E=null),this.root=this.root.decreaseKey(C,v,E,this.lessThan)},T.prototype.toString=function(C){return this.root.toString(C)},T.prototype.count=function(){return this.root.count()},T}();I.PriorityQueue=p},4655:function(_,I){"use strict";var E,h=this&&this.__extends||(E=function(b,d){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,S){f.__proto__=S}||function(f,S){for(var g in S)S.hasOwnProperty(g)&&(f[g]=S[g])})(b,d)},function(b,d){function f(){this.constructor=b}E(b,d),b.prototype=null===d?Object.create(d):(f.prototype=d.prototype,new f)});Object.defineProperty(I,"__esModule",{value:!0});var p=function(){function E(){this.findIter=function(b){for(var d=this._root,f=this.iterator();null!==d;){var S=this._comparator(b,d.data);if(0===S)return f._cursor=d,f;f._ancestors.push(d),d=d.get_child(S>0)}return null}}return E.prototype.clear=function(){this._root=null,this.size=0},E.prototype.find=function(b){for(var d=this._root;null!==d;){var f=this._comparator(b,d.data);if(0===f)return d.data;d=d.get_child(f>0)}return null},E.prototype.lowerBound=function(b){return this._bound(b,this._comparator)},E.prototype.upperBound=function(b){var d=this._comparator;return this._bound(b,function f(S,g){return d(g,S)})},E.prototype.min=function(){var b=this._root;if(null===b)return null;for(;null!==b.left;)b=b.left;return b.data},E.prototype.max=function(){var b=this._root;if(null===b)return null;for(;null!==b.right;)b=b.right;return b.data},E.prototype.iterator=function(){return new T(this)},E.prototype.each=function(b){for(var f,d=this.iterator();null!==(f=d.next());)b(f)},E.prototype.reach=function(b){for(var f,d=this.iterator();null!==(f=d.prev());)b(f)},E.prototype._bound=function(b,d){for(var f=this._root,S=this.iterator();null!==f;){var g=this._comparator(b,f.data);if(0===g)return S._cursor=f,S;S._ancestors.push(f),f=f.get_child(g>0)}for(var w=S._ancestors.length-1;w>=0;--w)if(d(b,(f=S._ancestors[w]).data)>0)return S._cursor=f,S._ancestors.length=w,S;return S._ancestors.length=0,S},E}();I.TreeBase=p;var T=function(){function E(b){this._tree=b,this._ancestors=[],this._cursor=null}return E.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},E.prototype.next=function(){if(null===this._cursor){var b=this._tree._root;null!==b&&this._minNode(b)}else if(null===this._cursor.right){var d;do{if(d=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===d)}else this._ancestors.push(this._cursor),this._minNode(this._cursor.right);return null!==this._cursor?this._cursor.data:null},E.prototype.prev=function(){if(null===this._cursor){var b=this._tree._root;null!==b&&this._maxNode(b)}else if(null===this._cursor.left){var d;do{if(d=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===d)}else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left);return null!==this._cursor?this._cursor.data:null},E.prototype._minNode=function(b){for(;null!==b.left;)this._ancestors.push(b),b=b.left;this._cursor=b},E.prototype._maxNode=function(b){for(;null!==b.right;)this._ancestors.push(b),b=b.right;this._cursor=b},E}();I.Iterator=T;var C=function(){function E(b){this.data=b,this.left=null,this.right=null,this.red=!0}return E.prototype.get_child=function(b){return b?this.right:this.left},E.prototype.set_child=function(b,d){b?this.right=d:this.left=d},E}(),v=function(E){function b(d){var f=E.call(this)||this;return f._root=null,f._comparator=d,f.size=0,f}return h(b,E),b.prototype.insert=function(d){var f=!1;if(null===this._root)this._root=new C(d),f=!0,this.size++;else{var S=new C(void 0),g=!1,w=!1,m=null,O=S,P=null,N=this._root;for(O.right=this._root;;){if(null===N?(N=new C(d),P.set_child(g,N),f=!0,this.size++):b.is_red(N.left)&&b.is_red(N.right)&&(N.red=!0,N.left.red=!1,N.right.red=!1),b.is_red(N)&&b.is_red(P)){var M=O.right===m;N===P.get_child(w)?O.set_child(M,b.single_rotate(m,!w)):O.set_child(M,b.double_rotate(m,!w))}var B=this._comparator(N.data,d);if(0===B)break;w=g,null!==m&&(O=m),m=P,P=N,N=N.get_child(g=B<0)}this._root=S.right}return this._root.red=!1,f},b.prototype.remove=function(d){if(null===this._root)return!1;var f=new C(void 0),S=f;S.right=this._root;for(var g=null,w=null,m=null,O=!0;null!==S.get_child(O);){var P=O;w=g,g=S,S=S.get_child(O);var N=this._comparator(d,S.data);if(O=N>0,0===N&&(m=S),!b.is_red(S)&&!b.is_red(S.get_child(O)))if(b.is_red(S.get_child(!O))){var M=b.single_rotate(S,O);g.set_child(P,M),g=M}else if(!b.is_red(S.get_child(!O))){var B=g.get_child(!P);if(null!==B)if(b.is_red(B.get_child(!P))||b.is_red(B.get_child(P))){var Y=w.right===g;b.is_red(B.get_child(P))?w.set_child(Y,b.double_rotate(g,P)):b.is_red(B.get_child(!P))&&w.set_child(Y,b.single_rotate(g,P));var F=w.get_child(Y);F.red=!0,S.red=!0,F.left.red=!1,F.right.red=!1}else g.red=!1,B.red=!0,S.red=!0}}return null!==m&&(m.data=S.data,g.set_child(g.right===S,S.get_child(null===S.left)),this.size--),this._root=f.right,null!==this._root&&(this._root.red=!1),null!==m},b.is_red=function(d){return null!==d&&d.red},b.single_rotate=function(d,f){var S=d.get_child(!f);return d.set_child(!f,S.get_child(f)),S.set_child(f,d),d.red=!0,S.red=!1,S},b.double_rotate=function(d,f){return d.set_child(!f,b.single_rotate(d.get_child(!f),!f)),b.single_rotate(d,f)},b}(p);I.RBTree=v},4068:function(_,I,h){"use strict";var U,p=this&&this.__extends||(U=function(j,V){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,H){G.__proto__=H}||function(G,H){for(var J in H)H.hasOwnProperty(J)&&(G[J]=H[J])})(j,V)},function(j,V){function G(){this.constructor=j}U(j,V),j.prototype=null===V?Object.create(V):(G.prototype=V.prototype,new G)});Object.defineProperty(I,"__esModule",{value:!0});var T=h(8237),C=h(4655);function v(U){return U.bounds=void 0!==U.leaves?U.leaves.reduce(function(j,V){return V.bounds.union(j)},E.empty()):E.empty(),void 0!==U.groups&&(U.bounds=U.groups.reduce(function(j,V){return v(V).union(j)},U.bounds)),U.bounds=U.bounds.inflate(U.padding),U.bounds}I.computeGroupBounds=v;var E=function(){function U(j,V,G,H){this.x=j,this.X=V,this.y=G,this.Y=H}return U.empty=function(){return new U(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},U.prototype.cx=function(){return(this.x+this.X)/2},U.prototype.cy=function(){return(this.y+this.Y)/2},U.prototype.overlapX=function(j){var V=this.cx(),G=j.cx();return V<=G&&j.x<this.X?this.X-j.x:G<=V&&this.x<j.X?j.X-this.x:0},U.prototype.overlapY=function(j){var V=this.cy(),G=j.cy();return V<=G&&j.y<this.Y?this.Y-j.y:G<=V&&this.y<j.Y?j.Y-this.y:0},U.prototype.setXCentre=function(j){var V=j-this.cx();this.x+=V,this.X+=V},U.prototype.setYCentre=function(j){var V=j-this.cy();this.y+=V,this.Y+=V},U.prototype.width=function(){return this.X-this.x},U.prototype.height=function(){return this.Y-this.y},U.prototype.union=function(j){return new U(Math.min(this.x,j.x),Math.max(this.X,j.X),Math.min(this.y,j.y),Math.max(this.Y,j.Y))},U.prototype.lineIntersections=function(j,V,G,H){for(var J=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],se=[],z=0;z<4;++z){var K=U.lineIntersection(j,V,G,H,J[z][0],J[z][1],J[z][2],J[z][3]);null!==K&&se.push({x:K.x,y:K.y})}return se},U.prototype.rayIntersection=function(j,V){var G=this.lineIntersections(this.cx(),this.cy(),j,V);return G.length>0?G[0]:null},U.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},U.lineIntersection=function(j,V,G,H,J,se,z,K){var le=G-j,ge=z-J,pe=H-V,ye=K-se,Ee=ye*le-ge*pe;if(0==Ee)return null;var be=j-J,Me=V-se,he=(ge*Me-ye*be)/Ee,ue=(le*Me-pe*be)/Ee;return he>=0&&he<=1&&ue>=0&&ue<=1?{x:j+he*le,y:V+he*pe}:null},U.prototype.inflate=function(j){return new U(this.x-j,this.X+j,this.y-j,this.Y+j)},U}();I.Rectangle=E,I.makeEdgeBetween=function b(U,j,V){var G=U.rayIntersection(j.cx(),j.cy())||{x:U.cx(),y:U.cy()},H=j.rayIntersection(U.cx(),U.cy())||{x:j.cx(),y:j.cy()},J=H.x-G.x,se=H.y-G.y,z=Math.sqrt(J*J+se*se),K=z-V;return{sourceIntersection:G,targetIntersection:H,arrowStart:{x:G.x+K*J/z,y:G.y+K*se/z}}},I.makeEdgeTo=function d(U,j,V){var G=j.rayIntersection(U.x,U.y);G||(G={x:j.cx(),y:j.cy()});var H=G.x-U.x,J=G.y-U.y,se=Math.sqrt(H*H+J*J);return{x:G.x-V*H/se,y:G.y-V*J/se}};var f=function U(j,V,G){this.v=j,this.r=V,this.pos=G,this.prev=w(),this.next=w()},S=function U(j,V,G){this.isOpen=j,this.v=V,this.pos=G};function g(U,j){return U.pos>j.pos?1:U.pos<j.pos||U.isOpen?-1:j.isOpen?1:0}function w(){return new C.RBTree(function(U,j){return U.pos-j.pos})}var m={getCentre:function(U){return U.cx()},getOpen:function(U){return U.y},getClose:function(U){return U.Y},getSize:function(U){return U.width()},makeRect:function(U,j,V,G){return new E(V-G/2,V+G/2,U,j)},findNeighbours:function M(U,j){var V=function(G,H){for(var se,J=j.findIter(U);null!==(se=J[G]());){var z=se.r.overlapX(U.r);if((z<=0||z<=se.r.overlapY(U.r))&&(U[G].insert(se),se[H].insert(U)),z<=0)break}};V("next","prev"),V("prev","next")}},O={getCentre:function(U){return U.cy()},getOpen:function(U){return U.x},getClose:function(U){return U.X},getSize:function(U){return U.height()},makeRect:function(U,j,V,G){return new E(U,j,V-G/2,V+G/2)},findNeighbours:function B(U,j){var V=function(G,H){var J=j.findIter(U)[G]();null!==J&&J.r.overlapX(U.r)>0&&(U[G].insert(J),J[H].insert(U))};V("next","prev"),V("prev","next")}};function P(U,j,V,G){void 0===G&&(G=!1);var H=U.padding,J=void 0!==U.groups?U.groups.length:0,se=void 0!==U.leaves?U.leaves.length:0,z=J?U.groups.reduce(function(Pe,qe){return Pe.concat(P(qe,j,V,!0))},[]):[],K=(G?2:0)+se+J,le=new Array(K),ge=new Array(K),pe=0,ye=function(Pe,qe){ge[pe]=Pe,le[pe++]=qe};if(G){var Ee=U.bounds,be=j.getCentre(Ee),Me=j.getSize(Ee)/2,ae=j.getOpen(Ee),he=j.getClose(Ee),de=be-Me+H/2,ue=be+Me-H/2;U.minVar.desiredPosition=de,ye(j.makeRect(ae,he,de,H),U.minVar),U.maxVar.desiredPosition=ue,ye(j.makeRect(ae,he,ue,H),U.maxVar)}se&&U.leaves.forEach(function(Pe){return ye(Pe.bounds,Pe.variable)}),J&&U.groups.forEach(function(Pe){var qe=Pe.bounds;ye(j.makeRect(j.getOpen(qe),j.getClose(qe),j.getCentre(qe),j.getSize(qe)),Pe.minVar)});var Se=N(ge,le,j,V);return J&&(le.forEach(function(Pe){Pe.cOut=[],Pe.cIn=[]}),Se.forEach(function(Pe){Pe.left.cOut.push(Pe),Pe.right.cIn.push(Pe)}),U.groups.forEach(function(Pe){var qe=(Pe.padding-j.getSize(Pe.bounds))/2;Pe.minVar.cIn.forEach(function(dt){return dt.gap+=qe}),Pe.minVar.cOut.forEach(function(dt){dt.left=Pe.maxVar,dt.gap+=qe})})),z.concat(Se)}function N(U,j,V,G){var H,J=U.length,se=2*J;console.assert(j.length>=J);var z=new Array(se);for(H=0;H<J;++H){var K=U[H],le=new f(j[H],K,V.getCentre(K));z[H]=new S(!0,le,V.getOpen(K)),z[H+J]=new S(!1,le,V.getClose(K))}z.sort(g);var ge=new Array,pe=w();for(H=0;H<se;++H){var ye=z[H];if(le=ye.v,ye.isOpen)pe.insert(le),V.findNeighbours(le,pe);else{pe.remove(le);var Ee=function(ae,he){var de=(V.getSize(ae.r)+V.getSize(he.r))/2+G;ge.push(new T.Constraint(ae.v,he.v,de))},be=function(ae,he,de){for(var ue,Se=le[ae].iterator();null!==(ue=Se[ae]());)de(ue,le),ue[he].remove(le)};be("prev","next",function(ae,he){return Ee(ae,he)}),be("next","prev",function(ae,he){return Ee(he,ae)})}}return console.assert(0===pe.size),ge}function Y(U,j){return N(U,j,m,1e-6)}function F(U,j){return N(U,j,O,1e-6)}function $(U){return P(U,m,1e-6)}function Q(U){return P(U,O,1e-6)}I.generateXConstraints=Y,I.generateYConstraints=F,I.generateXGroupConstraints=$,I.generateYGroupConstraints=Q,I.removeOverlaps=function ie(U){var j=U.map(function(H){return new T.Variable(H.cx())}),V=Y(U,j),G=new T.Solver(j,V);G.solve(),j.forEach(function(H,J){return U[J].setXCentre(H.position())}),j=U.map(function(H){return new T.Variable(H.cy())}),V=F(U,j),(G=new T.Solver(j,V)).solve(),j.forEach(function(H,J){return U[J].setYCentre(H.position())})};var ee=function(U){function j(V,G){var H=U.call(this,0,G)||this;return H.index=V,H}return p(j,U),j}(T.Variable);I.IndexedVariable=ee;var re=function(){function U(j,V,G,H,J){var se=this;if(void 0===G&&(G=null),void 0===H&&(H=null),void 0===J&&(J=!1),this.nodes=j,this.groups=V,this.rootGroup=G,this.avoidOverlaps=J,this.variables=j.map(function(K,le){return K.variable=new ee(le,1)}),H&&this.createConstraints(H),J&&G&&void 0!==G.groups){j.forEach(function(K){if(K.width&&K.height){var le=K.width/2,ge=K.height/2;K.bounds=new E(K.x-le,K.x+le,K.y-ge,K.y+ge)}else K.bounds=new E(K.x,K.x,K.y,K.y)}),v(G);var z=j.length;V.forEach(function(K){se.variables[z]=K.minVar=new ee(z++,void 0!==K.stiffness?K.stiffness:.01),se.variables[z]=K.maxVar=new ee(z++,void 0!==K.stiffness?K.stiffness:.01)})}}return U.prototype.createSeparation=function(j){return new T.Constraint(this.nodes[j.left].variable,this.nodes[j.right].variable,j.gap,void 0!==j.equality&&j.equality)},U.prototype.makeFeasible=function(j){var V=this;if(this.avoidOverlaps){var G="x",H="width";"x"===j.axis&&(G="y",H="height");var J=j.offsets.map(function(z){return V.nodes[z.node]}).sort(function(z,K){return z[G]-K[G]}),se=null;J.forEach(function(z){if(se){var K=se[G]+se[H];K>z[G]&&(z[G]=K)}se=z})}},U.prototype.createAlignment=function(j){var V=this,G=this.nodes[j.offsets[0].node].variable;this.makeFeasible(j);var H="x"===j.axis?this.xConstraints:this.yConstraints;j.offsets.slice(1).forEach(function(J){H.push(new T.Constraint(G,V.nodes[J.node].variable,J.offset,!0))})},U.prototype.createConstraints=function(j){var V=this,G=function(H){return void 0===H.type||"separation"===H.type};this.xConstraints=j.filter(function(H){return"x"===H.axis&&G(H)}).map(function(H){return V.createSeparation(H)}),this.yConstraints=j.filter(function(H){return"y"===H.axis&&G(H)}).map(function(H){return V.createSeparation(H)}),j.filter(function(H){return"alignment"===H.type}).forEach(function(H){return V.createAlignment(H)})},U.prototype.setupVariablesAndBounds=function(j,V,G,H){this.nodes.forEach(function(J,se){J.fixed?(J.variable.weight=J.fixedWeight?J.fixedWeight:1e3,G[se]=H(J)):J.variable.weight=1;var z=(J.width||0)/2,K=(J.height||0)/2,le=j[se],ge=V[se];J.bounds=new E(le-z,le+z,ge-K,ge+K)})},U.prototype.xProject=function(j,V,G){!this.rootGroup&&!this.avoidOverlaps&&!this.xConstraints||this.project(j,V,j,G,function(H){return H.px},this.xConstraints,$,function(H){return H.bounds.setXCentre(G[H.variable.index]=H.variable.position())},function(H){var J=G[H.minVar.index]=H.minVar.position(),se=G[H.maxVar.index]=H.maxVar.position(),z=H.padding/2;H.bounds.x=J-z,H.bounds.X=se+z})},U.prototype.yProject=function(j,V,G){!this.rootGroup&&!this.yConstraints||this.project(j,V,V,G,function(H){return H.py},this.yConstraints,Q,function(H){return H.bounds.setYCentre(G[H.variable.index]=H.variable.position())},function(H){var J=G[H.minVar.index]=H.minVar.position(),se=G[H.maxVar.index]=H.maxVar.position(),z=H.padding/2;H.bounds.y=J-z,H.bounds.Y=se+z})},U.prototype.projectFunctions=function(){var j=this;return[function(V,G,H){return j.xProject(V,G,H)},function(V,G,H){return j.yProject(V,G,H)}]},U.prototype.project=function(j,V,G,H,J,se,z,K,le){this.setupVariablesAndBounds(j,V,H,J),this.rootGroup&&this.avoidOverlaps&&(v(this.rootGroup),se=se.concat(z(this.rootGroup))),this.solve(this.variables,se,G,H),this.nodes.forEach(K),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(le),v(this.rootGroup))},U.prototype.solve=function(j,V,G,H){var J=new T.Solver(j,V);J.setStartingPositions(G),J.setDesiredPositions(H),J.solve()},U}();I.Projection=re},3858:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var p=h(8866),T=function b(d,f){this.id=d,this.distance=f},C=function b(d){this.id=d,this.neighbours=[]},v=function b(d,f,S){this.node=d,this.prev=f,this.d=S},E=function(){function b(d,f,S,g,w){this.n=d,this.es=f,this.neighbours=new Array(this.n);for(var m=this.n;m--;)this.neighbours[m]=new C(m);for(m=this.es.length;m--;){var O=this.es[m],P=S(O),N=g(O),M=w(O);this.neighbours[P].neighbours.push(new T(N,M)),this.neighbours[N].neighbours.push(new T(P,M))}}return b.prototype.DistanceMatrix=function(){for(var d=new Array(this.n),f=0;f<this.n;++f)d[f]=this.dijkstraNeighbours(f);return d},b.prototype.DistancesFromNode=function(d){return this.dijkstraNeighbours(d)},b.prototype.PathFromNodeToNode=function(d,f){return this.dijkstraNeighbours(d,f)},b.prototype.PathFromNodeToNodeWithPrevCost=function(d,f,S){var g=new p.PriorityQueue(function(Q,ie){return Q.d<=ie.d}),w=this.neighbours[d],m=new v(w,null,0),O={};for(g.push(m);!g.empty()&&(w=(m=g.pop()).node).id!==f;)for(var P=w.neighbours.length;P--;){var N=w.neighbours[P],M=this.neighbours[N.id];if(!m.prev||M.id!==m.prev.node.id){var B=M.id+","+w.id;if(!(B in O&&O[B]<=m.d)){var Y=m.prev?S(m.prev.node.id,w.id,M.id):0,F=m.d+N.distance+Y;O[B]=F,g.push(new v(M,m,F))}}}for(var $=[];m.prev;)$.push((m=m.prev).node.id);return $},b.prototype.dijkstraNeighbours=function(d,f){void 0===f&&(f=-1);for(var S=new p.PriorityQueue(function(Y,F){return Y.d<=F.d}),g=this.neighbours.length,w=new Array(g);g--;){var m=this.neighbours[g];m.d=g===d?0:Number.POSITIVE_INFINITY,m.q=S.push(m)}for(;!S.empty();){var O=S.pop();if(w[O.id]=O.d,O.id===f){for(var P=[],N=O;void 0!==N.prev;)P.push(N.prev.id),N=N.prev;return P}for(g=O.neighbours.length;g--;){var M=O.neighbours[g],B=(N=this.neighbours[M.id],O.d+M.distance);O.d!==Number.MAX_VALUE&&N.d>B&&(N.d=B,N.prev=O,S.reduceKey(N.q,N,function(F,$){return F.q=$}))}}return w},b}();I.Calculator=E},8237:(_,I)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var h=function(){function d(f){this.scale=f,this.AB=0,this.AD=0,this.A2=0}return d.prototype.addVariable=function(f){var S=this.scale/f.scale,w=f.weight;this.AB+=w*S*(f.offset/f.scale),this.AD+=w*S*f.desiredPosition,this.A2+=w*S*S},d.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},d}();I.PositionStats=h;var p=function(){function d(f,S,g,w){void 0===w&&(w=!1),this.left=f,this.right=S,this.gap=g,this.equality=w,this.active=!1,this.unsatisfiable=!1,this.left=f,this.right=S,this.gap=g,this.equality=w}return d.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},d}();I.Constraint=p;var T=function(){function d(f,S,g){void 0===S&&(S=1),void 0===g&&(g=1),this.desiredPosition=f,this.weight=S,this.scale=g,this.offset=0}return d.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},d.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},d.prototype.visitNeighbours=function(f,S){var g=function(w,m){return w.active&&f!==m&&S(w,m)};this.cOut.forEach(function(w){return g(w,w.right)}),this.cIn.forEach(function(w){return g(w,w.left)})},d}();I.Variable=T;var C=function(){function d(f){this.vars=[],f.offset=0,this.ps=new h(f.scale),this.addVariable(f)}return d.prototype.addVariable=function(f){f.block=this,this.vars.push(f),this.ps.addVariable(f),this.posn=this.ps.getPosn()},d.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var f=0,S=this.vars.length;f<S;++f)this.ps.addVariable(this.vars[f]);this.posn=this.ps.getPosn()},d.prototype.compute_lm=function(f,S,g){var w=this,m=f.dfdv();return f.visitNeighbours(S,function(O,P){var N=w.compute_lm(P,f,g);P===O.right?(m+=N*O.left.scale,O.lm=N):(m+=N*O.right.scale,O.lm=-N),g(O)}),m/f.scale},d.prototype.populateSplitBlock=function(f,S){var g=this;f.visitNeighbours(S,function(w,m){m.offset=f.offset+(m===w.right?w.gap:-w.gap),g.addVariable(m),g.populateSplitBlock(m,f)})},d.prototype.traverse=function(f,S,g,w){var m=this;void 0===g&&(g=this.vars[0]),void 0===w&&(w=null),g.visitNeighbours(w,function(O,P){S.push(f(O)),m.traverse(f,S,P,g)})},d.prototype.findMinLM=function(){var f=null;return this.compute_lm(this.vars[0],null,function(S){!S.equality&&(null===f||S.lm<f.lm)&&(f=S)}),f},d.prototype.findMinLMBetween=function(f,S){this.compute_lm(f,null,function(){});var g=null;return this.findPath(f,null,S,function(w,m){!w.equality&&w.right===m&&(null===g||w.lm<g.lm)&&(g=w)}),g},d.prototype.findPath=function(f,S,g,w){var m=this,O=!1;return f.visitNeighbours(S,function(P,N){!O&&(N===g||m.findPath(N,f,g,w))&&(O=!0,w(P,N))}),O},d.prototype.isActiveDirectedPathBetween=function(f,S){if(f===S)return!0;for(var g=f.cOut.length;g--;){var w=f.cOut[g];if(w.active&&this.isActiveDirectedPathBetween(w.right,S))return!0}return!1},d.split=function(f){return f.active=!1,[d.createSplitBlock(f.left),d.createSplitBlock(f.right)]},d.createSplitBlock=function(f){var S=new d(f);return S.populateSplitBlock(f,null),S},d.prototype.splitBetween=function(f,S){var g=this.findMinLMBetween(f,S);if(null!==g){var w=d.split(g);return{constraint:g,lb:w[0],rb:w[1]}}return null},d.prototype.mergeAcross=function(f,S,g){S.active=!0;for(var w=0,m=f.vars.length;w<m;++w){var O=f.vars[w];O.offset+=g,this.addVariable(O)}this.posn=this.ps.getPosn()},d.prototype.cost=function(){for(var f=0,S=this.vars.length;S--;){var g=this.vars[S],w=g.position()-g.desiredPosition;f+=w*w*g.weight}return f},d}();I.Block=C;var v=function(){function d(f){this.vs=f;var S=f.length;for(this.list=new Array(S);S--;){var g=new C(f[S]);this.list[S]=g,g.blockInd=S}}return d.prototype.cost=function(){for(var f=0,S=this.list.length;S--;)f+=this.list[S].cost();return f},d.prototype.insert=function(f){f.blockInd=this.list.length,this.list.push(f)},d.prototype.remove=function(f){var S=this.list.length-1,g=this.list[S];this.list.length=S,f!==g&&(this.list[f.blockInd]=g,g.blockInd=f.blockInd)},d.prototype.merge=function(f){var S=f.left.block,g=f.right.block,w=f.right.offset-f.left.offset-f.gap;S.vars.length<g.vars.length?(g.mergeAcross(S,f,w),this.remove(S)):(S.mergeAcross(g,f,-w),this.remove(g))},d.prototype.forEach=function(f){this.list.forEach(f)},d.prototype.updateBlockPositions=function(){this.list.forEach(function(f){return f.updateWeightedPosition()})},d.prototype.split=function(f){var S=this;this.updateBlockPositions(),this.list.forEach(function(g){var w=g.findMinLM();null!==w&&w.lm<E.LAGRANGIAN_TOLERANCE&&(g=w.left.block,C.split(w).forEach(function(m){return S.insert(m)}),S.remove(g),f.push(w))})},d}();I.Blocks=v;var E=function(){function d(f,S){this.vs=f,this.cs=S,this.vs=f,f.forEach(function(g){g.cIn=[],g.cOut=[]}),this.cs=S,S.forEach(function(g){g.left.cOut.push(g),g.right.cIn.push(g)}),this.inactive=S.map(function(g){return g.active=!1,g}),this.bs=null}return d.prototype.cost=function(){return this.bs.cost()},d.prototype.setStartingPositions=function(f){this.inactive=this.cs.map(function(S){return S.active=!1,S}),this.bs=new v(this.vs),this.bs.forEach(function(S,g){return S.posn=f[g]})},d.prototype.setDesiredPositions=function(f){this.vs.forEach(function(S,g){return S.desiredPosition=f[g]})},d.prototype.mostViolated=function(){for(var f=Number.MAX_VALUE,S=null,g=this.inactive,w=g.length,m=w,O=0;O<w;++O){var P=g[O];if(!P.unsatisfiable){var N=P.slack();if((P.equality||N<f)&&(f=N,S=P,m=O,P.equality))break}}return m!==w&&(f<d.ZERO_UPPERBOUND&&!S.active||S.equality)&&(g[m]=g[w-1],g.length=w-1),S},d.prototype.satisfy=function(){null==this.bs&&(this.bs=new v(this.vs)),this.bs.split(this.inactive);for(var f=null;(f=this.mostViolated())&&(f.equality||f.slack()<d.ZERO_UPPERBOUND&&!f.active);){var S=f.left.block;if(S!==f.right.block)this.bs.merge(f);else{if(S.isActiveDirectedPathBetween(f.right,f.left)){f.unsatisfiable=!0;continue}var w=S.splitBetween(f.left,f.right);if(null===w){f.unsatisfiable=!0;continue}this.bs.insert(w.lb),this.bs.insert(w.rb),this.bs.remove(S),this.inactive.push(w.constraint),f.slack()>=0?this.inactive.push(f):this.bs.merge(f)}}},d.prototype.solve=function(){this.satisfy();for(var f=Number.MAX_VALUE,S=this.bs.cost();Math.abs(f-S)>1e-4;)this.satisfy(),f=S,S=this.bs.cost();return S},d.LAGRANGIAN_TOLERANCE=-1e-4,d.ZERO_UPPERBOUND=-1e-10,d}();I.Solver=E,I.removeOverlapInOneDimension=function b(d,f,S){for(var g=d.map(function(ee){return new T(ee.desiredCenter)}),w=[],m=d.length,O=0;O<m-1;O++)w.push(new p(g[O],g[O+1],(d[O].size+d[O+1].size)/2));var M=g[0],B=g[m-1],Y=d[0].size/2,F=d[m-1].size/2,$=null,Q=null;return f&&($=new T(f,1e3*M.weight),g.push($),w.push(new p($,M,Y))),S&&(Q=new T(S,1e3*B.weight),g.push(Q),w.push(new p(B,Q,F))),new E(g,w).solve(),{newCenters:g.slice(0,d.length).map(function(ee){return ee.position()}),lowerBound:$?$.position():M.position()-Y,upperBound:Q?Q.position():B.position()+F}}},655:(_,I,h)=>{"use strict";h.r(I),h.d(I,{__assign:()=>C,__asyncDelegator:()=>F,__asyncGenerator:()=>Y,__asyncValues:()=>$,__await:()=>B,__awaiter:()=>f,__classPrivateFieldGet:()=>U,__classPrivateFieldSet:()=>j,__createBinding:()=>g,__decorate:()=>E,__exportStar:()=>w,__extends:()=>T,__generator:()=>S,__importDefault:()=>re,__importStar:()=>ee,__makeTemplateObject:()=>Q,__metadata:()=>d,__param:()=>b,__read:()=>O,__rest:()=>v,__spread:()=>P,__spreadArray:()=>M,__spreadArrays:()=>N,__values:()=>m});var p=function(V,G){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,J){H.__proto__=J}||function(H,J){for(var se in J)Object.prototype.hasOwnProperty.call(J,se)&&(H[se]=J[se])})(V,G)};function T(V,G){if("function"!=typeof G&&null!==G)throw new TypeError("Class extends value "+String(G)+" is not a constructor or null");function H(){this.constructor=V}p(V,G),V.prototype=null===G?Object.create(G):(H.prototype=G.prototype,new H)}var C=function(){return C=Object.assign||function(G){for(var H,J=1,se=arguments.length;J<se;J++)for(var z in H=arguments[J])Object.prototype.hasOwnProperty.call(H,z)&&(G[z]=H[z]);return G},C.apply(this,arguments)};function v(V,G){var H={};for(var J in V)Object.prototype.hasOwnProperty.call(V,J)&&G.indexOf(J)<0&&(H[J]=V[J]);if(null!=V&&"function"==typeof Object.getOwnPropertySymbols){var se=0;for(J=Object.getOwnPropertySymbols(V);se<J.length;se++)G.indexOf(J[se])<0&&Object.prototype.propertyIsEnumerable.call(V,J[se])&&(H[J[se]]=V[J[se]])}return H}function E(V,G,H,J){var K,se=arguments.length,z=se<3?G:null===J?J=Object.getOwnPropertyDescriptor(G,H):J;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)z=Reflect.decorate(V,G,H,J);else for(var le=V.length-1;le>=0;le--)(K=V[le])&&(z=(se<3?K(z):se>3?K(G,H,z):K(G,H))||z);return se>3&&z&&Object.defineProperty(G,H,z),z}function b(V,G){return function(H,J){G(H,J,V)}}function d(V,G){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(V,G)}function f(V,G,H,J){return new(H||(H=Promise))(function(z,K){function le(ye){try{pe(J.next(ye))}catch(Ee){K(Ee)}}function ge(ye){try{pe(J.throw(ye))}catch(Ee){K(Ee)}}function pe(ye){ye.done?z(ye.value):function se(z){return z instanceof H?z:new H(function(K){K(z)})}(ye.value).then(le,ge)}pe((J=J.apply(V,G||[])).next())})}function S(V,G){var J,se,z,K,H={label:0,sent:function(){if(1&z[0])throw z[1];return z[1]},trys:[],ops:[]};return K={next:le(0),throw:le(1),return:le(2)},"function"==typeof Symbol&&(K[Symbol.iterator]=function(){return this}),K;function le(pe){return function(ye){return function ge(pe){if(J)throw new TypeError("Generator is already executing.");for(;H;)try{if(J=1,se&&(z=2&pe[0]?se.return:pe[0]?se.throw||((z=se.return)&&z.call(se),0):se.next)&&!(z=z.call(se,pe[1])).done)return z;switch(se=0,z&&(pe=[2&pe[0],z.value]),pe[0]){case 0:case 1:z=pe;break;case 4:return H.label++,{value:pe[1],done:!1};case 5:H.label++,se=pe[1],pe=[0];continue;case 7:pe=H.ops.pop(),H.trys.pop();continue;default:if(!(z=(z=H.trys).length>0&&z[z.length-1])&&(6===pe[0]||2===pe[0])){H=0;continue}if(3===pe[0]&&(!z||pe[1]>z[0]&&pe[1]<z[3])){H.label=pe[1];break}if(6===pe[0]&&H.label<z[1]){H.label=z[1],z=pe;break}if(z&&H.label<z[2]){H.label=z[2],H.ops.push(pe);break}z[2]&&H.ops.pop(),H.trys.pop();continue}pe=G.call(V,H)}catch(ye){pe=[6,ye],se=0}finally{J=z=0}if(5&pe[0])throw pe[1];return{value:pe[0]?pe[1]:void 0,done:!0}}([pe,ye])}}}var g=Object.create?function(V,G,H,J){void 0===J&&(J=H),Object.defineProperty(V,J,{enumerable:!0,get:function(){return G[H]}})}:function(V,G,H,J){void 0===J&&(J=H),V[J]=G[H]};function w(V,G){for(var H in V)"default"!==H&&!Object.prototype.hasOwnProperty.call(G,H)&&g(G,V,H)}function m(V){var G="function"==typeof Symbol&&Symbol.iterator,H=G&&V[G],J=0;if(H)return H.call(V);if(V&&"number"==typeof V.length)return{next:function(){return V&&J>=V.length&&(V=void 0),{value:V&&V[J++],done:!V}}};throw new TypeError(G?"Object is not iterable.":"Symbol.iterator is not defined.")}function O(V,G){var H="function"==typeof Symbol&&V[Symbol.iterator];if(!H)return V;var se,K,J=H.call(V),z=[];try{for(;(void 0===G||G-- >0)&&!(se=J.next()).done;)z.push(se.value)}catch(le){K={error:le}}finally{try{se&&!se.done&&(H=J.return)&&H.call(J)}finally{if(K)throw K.error}}return z}function P(){for(var V=[],G=0;G<arguments.length;G++)V=V.concat(O(arguments[G]));return V}function N(){for(var V=0,G=0,H=arguments.length;G<H;G++)V+=arguments[G].length;var J=Array(V),se=0;for(G=0;G<H;G++)for(var z=arguments[G],K=0,le=z.length;K<le;K++,se++)J[se]=z[K];return J}function M(V,G,H){if(H||2===arguments.length)for(var z,J=0,se=G.length;J<se;J++)(z||!(J in G))&&(z||(z=Array.prototype.slice.call(G,0,J)),z[J]=G[J]);return V.concat(z||G)}function B(V){return this instanceof B?(this.v=V,this):new B(V)}function Y(V,G,H){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var se,J=H.apply(V,G||[]),z=[];return se={},K("next"),K("throw"),K("return"),se[Symbol.asyncIterator]=function(){return this},se;function K(be){J[be]&&(se[be]=function(Me){return new Promise(function(ae,he){z.push([be,Me,ae,he])>1||le(be,Me)})})}function le(be,Me){try{!function ge(be){be.value instanceof B?Promise.resolve(be.value.v).then(pe,ye):Ee(z[0][2],be)}(J[be](Me))}catch(ae){Ee(z[0][3],ae)}}function pe(be){le("next",be)}function ye(be){le("throw",be)}function Ee(be,Me){be(Me),z.shift(),z.length&&le(z[0][0],z[0][1])}}function F(V){var G,H;return G={},J("next"),J("throw",function(se){throw se}),J("return"),G[Symbol.iterator]=function(){return this},G;function J(se,z){G[se]=V[se]?function(K){return(H=!H)?{value:B(V[se](K)),done:"return"===se}:z?z(K):K}:z}}function $(V){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var H,G=V[Symbol.asyncIterator];return G?G.call(V):(V=m(V),H={},J("next"),J("throw"),J("return"),H[Symbol.asyncIterator]=function(){return this},H);function J(z){H[z]=V[z]&&function(K){return new Promise(function(le,ge){!function se(z,K,le,ge){Promise.resolve(ge).then(function(pe){z({value:pe,done:le})},K)}(le,ge,(K=V[z](K)).done,K.value)})}}}function Q(V,G){return Object.defineProperty?Object.defineProperty(V,"raw",{value:G}):V.raw=G,V}var ie=Object.create?function(V,G){Object.defineProperty(V,"default",{enumerable:!0,value:G})}:function(V,G){V.default=G};function ee(V){if(V&&V.__esModule)return V;var G={};if(null!=V)for(var H in V)"default"!==H&&Object.prototype.hasOwnProperty.call(V,H)&&g(G,V,H);return ie(G,V),G}function re(V){return V&&V.__esModule?V:{default:V}}function U(V,G,H,J){if("a"===H&&!J)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof G?V!==G||!J:!G.has(V))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===H?J:"a"===H?J.call(V):J?J.value:G.get(V)}function j(V,G,H,J,se){if("m"===J)throw new TypeError("Private method is not writable");if("a"===J&&!se)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof G?V!==G||!se:!G.has(V))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===J?se.call(V,H):se?se.value=H:G.set(V,H),H}},8270:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.KeyedMultiCollection=I.ReadonlyKeyedMultiCollection=I.KeyedCollection=I.ReadonlyKeyedCollection=I.IndexedCollection=I.FixedSizeIndexedCollection=I.ReadonlyIndexedCollection=I.Collection=I.ReadonlyCollection=void 0;const p=h(1344),T=h(9440);var C,m,v,E,b,d,f,S,g,w;(m=C=I.ReadonlyCollection||(I.ReadonlyCollection={})).size=Symbol.for("@esfx/collection-core!ReadonlyCollection.size"),m.has=Symbol.for("@esfx/collection-core!ReadonlyCollection.has"),m.isReadonlyCollection=function O(N){return p.isIterable(N)&&m.size in N&&m.has in N},m.name="ReadonlyCollection",m.hasInstance=function P(N){return p.isIterable(N)&&m.size in N&&m.has in N},function(m){m.size=C.size,m.has=C.has,m.isReadonlyCollection=C.isReadonlyCollection,m.add=Symbol.for("@esfx/collection-core!Collection.add"),m.delete=Symbol.for("@esfx/collection-core!Collection.delete"),m.clear=Symbol.for("@esfx/collection-core!Collection.clear"),m.isCollection=function O(N){return m.hasInstance(N)},m.name="Collection",m.hasInstance=function P(N){return C.hasInstance(N)&&m.add in N&&m.delete in N&&m.clear in N}}(v=I.Collection||(I.Collection={})),function(m){m.size=C.size,m.has=C.has,m.isReadonlyCollection=C.isReadonlyCollection,m.indexOf=Symbol.for("@esfx/collection-core!ReadonlyIndexedCollection.indexOf"),m.getAt=Symbol.for("@esfx/collection-core!ReadonlyIndexedCollection.getAt"),m.isReadonlyIndexedCollection=function O(N){return m.hasInstance(N)},m.name="ReadonlyIndexedCollection",m.hasInstance=function P(N){return C.hasInstance(N)&&m.indexOf in N&&m.getAt in N}}(E=I.ReadonlyIndexedCollection||(I.ReadonlyIndexedCollection={})),function(m){m.size=C.size,m.has=C.has,m.isReadonlyCollection=C.isReadonlyCollection,m.indexOf=E.indexOf,m.getAt=E.getAt,m.isReadonlyIndexedCollection=E.isReadonlyIndexedCollection,m.setAt=Symbol.for("@esfx/collection-core!FixedSizeIndexedCollection.setAt"),m.isFixedSizeIndexedCollection=function O(N){return m.hasInstance(N)},m.name="FixedSizeIndexedCollection",m.hasInstance=function P(N){return E.hasInstance(N)&&m.setAt in N}}(b=I.FixedSizeIndexedCollection||(I.FixedSizeIndexedCollection={})),function(m){m.size=C.size,m.has=C.has,m.isReadonlyCollection=C.isReadonlyCollection,m.indexOf=E.indexOf,m.getAt=E.getAt,m.isReadonlyIndexedCollection=E.isReadonlyIndexedCollection,m.setAt=b.setAt,m.isFixedSizeIndexedCollection=b.isFixedSizeIndexedCollection,m.add=v.add,m.delete=v.delete,m.clear=v.clear,m.isCollection=v.isCollection,m.insertAt=Symbol.for("@esfx/collection-core!IndexedCollection.insertAt"),m.removeAt=Symbol.for("@esfx/collection-core!IndexedCollection.removeAt"),m.isIndexedCollection=function O(N){return m.hasInstance(N)},m.name="IndexedCollection",m.hasInstance=function P(N){return b.hasInstance(N)&&m.insertAt in N&&m.removeAt in N}}(d=I.IndexedCollection||(I.IndexedCollection={})),function(m){m.size=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.size"),m.has=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.has"),m.get=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.get"),m.keys=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.keys"),m.values=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.values"),m.isReadonlyKeyedCollection=function O(N){return m.hasInstance(N)},m.name="ReadonlyKeyedCollection",m.hasInstance=function P(N){return p.isIterable(N)&&m.size in N&&m.has in N&&m.get in N&&m.keys in N&&m.values in N}}(f=I.ReadonlyKeyedCollection||(I.ReadonlyKeyedCollection={})),function(m){m.size=f.size,m.has=f.has,m.get=f.get,m.keys=f.keys,m.values=f.values,m.isReadonlyKeyedCollection=f.isReadonlyKeyedCollection,m.set=Symbol.for("@esfx/collection-core!KeyedCollection.set"),m.delete=Symbol.for("@esfx/collection-core!KeyedCollection.delete"),m.clear=Symbol.for("@esfx/collection-core!KeyedCollection.clear"),m.isKeyedCollection=function O(N){return m.hasInstance(N)},m.name="KeyedCollection",m.hasInstance=function P(N){return f.hasInstance(N)&&m.set in N&&m.delete in N&&m.clear in N}}(S=I.KeyedCollection||(I.KeyedCollection={})),function(m){m.size=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.size"),m.has=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.has"),m.hasValue=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.hasValue"),m.get=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.get"),m.keys=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.keys"),m.values=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.values"),m.isReadonlyKeyedMultiCollection=function O(N){return m.hasInstance(N)},m.name="ReadonlyKeyedMultiCollection",m.hasInstance=function P(N){return p.isIterable(N)&&m.size in N&&m.has in N&&m.hasValue in N&&m.get in N&&m.keys in N&&m.values in N}}(g=I.ReadonlyKeyedMultiCollection||(I.ReadonlyKeyedMultiCollection={})),function(m){m.size=g.size,m.has=g.has,m.hasValue=g.hasValue,m.get=g.get,m.keys=g.keys,m.values=g.values,m.isReadonlyKeyedMultiCollection=g.isReadonlyKeyedMultiCollection,m.add=Symbol.for("@esfx/collection-core!KeyedMultiCollection.add"),m.delete=Symbol.for("@esfx/collection-core!KeyedMultiCollection.delete"),m.deleteValue=Symbol.for("@esfx/collection-core!KeyedMultiCollection.deleteValue"),m.clear=Symbol.for("@esfx/collection-core!KeyedMultiCollection.clear"),m.isKeyedMultiCollection=function O(N){return m.hasInstance(N)},m.name="KeyedMultiCollection",m.hasInstance=function P(N){return g.hasInstance(N)&&m.add in N&&m.delete in N&&m.deleteValue in N&&m.clear in N}}(w=I.KeyedMultiCollection||(I.KeyedMultiCollection={})),T.deprecateProperty(C,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),T.deprecateProperty(v,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),T.deprecateProperty(v,"isCollection","Use 'Collection.hasInstance' instead."),T.deprecateProperty(E,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),T.deprecateProperty(E,"isReadonlyIndexedCollection","Use 'ReadonlyIndexedCollection.hasInstance' instead."),T.deprecateProperty(b,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),T.deprecateProperty(b,"isReadonlyIndexedCollection","Use 'ReadonlyIndexedCollection.hasInstance' instead."),T.deprecateProperty(b,"isFixedSizeIndexedCollection","Use 'FixedSizeIndexedCollection.hasInstance' instead."),T.deprecateProperty(d,"isReadonlyCollection","Use 'ReadonlyCollection.hasInstance' instead."),T.deprecateProperty(d,"isReadonlyIndexedCollection","Use 'ReadonlyIndexedCollection.hasInstance' instead."),T.deprecateProperty(d,"isFixedSizeIndexedCollection","Use 'FixedSizeIndexedCollection.hasInstance' instead."),T.deprecateProperty(d,"isCollection","Use 'Collection.hasInstance' instead."),T.deprecateProperty(d,"isIndexedCollection","Use 'IndexedCollection.hasInstance' instead."),T.deprecateProperty(f,"isReadonlyKeyedCollection","Use 'ReadonlyKeyedCollection.hasInstance' instead."),T.deprecateProperty(S,"isReadonlyKeyedCollection","Use 'ReadonlyKeyedCollection.hasInstance' instead."),T.deprecateProperty(S,"isKeyedCollection","Use 'KeyedCollection.hasInstance' instead."),T.deprecateProperty(g,"isReadonlyKeyedMultiCollection","Use 'ReadonlyKeyedMultiCollection.hasInstance' instead."),T.deprecateProperty(w,"isReadonlyKeyedMultiCollection","Use 'ReadonlyKeyedMultiCollection.hasInstance' instead."),T.deprecateProperty(w,"isKeyedMultiCollection","Use 'KeyedMultiCollection.hasInstance' instead.")},8090:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.HashMap=void 0;const p=h(8270),T=h(839),C=h(1344),v=h(1301);class E{constructor(...d){let f,S,g;if(d.length>0){const w=d[0];"number"==typeof w?(f=w,d.length>1&&(g=d[1])):C.isIterable(w)||void 0===w?(S=w,d.length>1&&(g=d[1])):g=w}if(void 0===f&&(f=0),void 0===g&&(g=T.Equaler.defaultEqualer),f<0)throw new RangeError;if(this._hashData=v.createHashData(g,f),S)for(const[w,m]of S)this.set(w,m)}get equaler(){return this._hashData.equaler}get size(){return this._hashData.size-this._hashData.freeSize}has(d){return v.findEntryIndex(this._hashData,d)>=0}get(d){return v.findEntryValue(this._hashData,d)}set(d,f){return v.insertEntry(this._hashData,d,f),this}delete(d){return v.deleteEntry(this._hashData,d)}clear(){v.clearEntries(this._hashData)}ensureCapacity(d){return v.ensureCapacity(this._hashData,d)}trimExcess(d){v.trimExcessEntries(this._hashData,d)}keys(){return v.iterateEntries(this._hashData.head,v.selectEntryKey)}values(){return v.iterateEntries(this._hashData.head,v.selectEntryValue)}entries(){return v.iterateEntries(this._hashData.head,v.selectEntryEntry)}[Symbol.iterator](){return this.entries()}forEach(d,f){v.forEachEntry(this,this._hashData.head,d,f)}get[p.ReadonlyKeyedCollection.size](){return this.size}[p.ReadonlyKeyedCollection.has](d){return this.has(d)}[p.ReadonlyKeyedCollection.get](d){return this.get(d)}[p.ReadonlyKeyedCollection.keys](){return this.keys()}[p.ReadonlyKeyedCollection.values](){return this.values()}[p.KeyedCollection.set](d,f){this.set(d,f)}[p.KeyedCollection.delete](d){return this.delete(d)}[p.KeyedCollection.clear](){this.clear()}}I.HashMap=E,Object.defineProperty(E,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"HashMap"})},6471:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.HashSet=void 0;const p=h(8270),T=h(839),C=h(1344),v=h(1301);class E{constructor(...d){let f,S,g;if(d.length>0){const w=d[0];"number"==typeof w?(f=w,d.length>1&&(g=d[1])):C.isIterable(w)?(S=w,d.length>1&&(g=d[1])):g=w}if(void 0===f&&(f=0),void 0===g&&(g=T.Equaler.defaultEqualer),f<0)throw new RangeError;if(this._hashData=v.createHashData(g,f),S)for(const w of S)this.add(w)}get equaler(){return this._hashData.equaler}get size(){return this._hashData.size-this._hashData.freeSize}has(d){return v.findEntryIndex(this._hashData,d)>=0}add(d){return v.insertEntry(this._hashData,d,d),this}tryAdd(d){const f=this.size;return v.insertEntry(this._hashData,d,d),this.size>f}delete(d){return v.deleteEntry(this._hashData,d)}clear(){v.clearEntries(this._hashData)}ensureCapacity(d){return v.ensureCapacity(this._hashData,d)}trimExcess(d){v.trimExcessEntries(this._hashData,d)}keys(){return v.iterateEntries(this._hashData.head,v.selectEntryKey)}values(){return v.iterateEntries(this._hashData.head,v.selectEntryValue)}entries(){return v.iterateEntries(this._hashData.head,v.selectEntryEntry)}[Symbol.iterator](){return this.values()}forEach(d,f){v.forEachEntry(this,this._hashData.head,d,f)}get[p.Collection.size](){return this.size}[p.Collection.has](d){return this.has(d)}[p.Collection.add](d){this.add(d)}[p.Collection.delete](d){return this.delete(d)}[p.Collection.clear](){this.clear()}}I.HashSet=E,Object.defineProperty(E,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"HashSet"})},6289:(_,I,h)=>{"use strict";var p,T,C;Object.defineProperty(I,"__esModule",{value:!0}),I.LinkedList=I.LinkedListNode=void 0;const v=h(1344),E=h(8270),b=h(839),d=Symbol("LinkedListNode.list"),f=Symbol("LinkedListNode.previous"),S=Symbol("LinkedListNode.next");class g{constructor(O){this[p]=void 0,this[T]=void 0,this[C]=void 0,this.value=O}get list(){return this[d]}get previous(){if(this[f]&&this.list&&this!==this.list.first)return this[f]}get next(){if(this[S]&&this.list&&this[S]!==this.list.first)return this[S]}detachSelf(){return!!this.list&&this.list.deleteNode(this)}}I.LinkedListNode=g,p=d,T=f,C=S,Object.defineProperty(g.prototype,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"LinkedListNode"});class w{constructor(...O){let P,N;if(this._size=0,this._head=void 0,O.length>0&&(v.isIterable(O[0])||v.isMissing(O[0])?(P=O[0],O.length>1&&(N=O[1])):N=O[0]),v.isMissing(N)&&(N=b.Equaler.defaultEqualer),this._equaler="function"==typeof N?b.Equaler.create(N):N,P)for(const M of P)this.push(M)}get equaler(){return this._equaler}get first(){return this._head}get last(){if(this._head)return this._head[f]}get size(){return this._size}[Symbol.iterator](){return this.values()}*values(){for(const O of this.nodes())yield O.value}*nodes(){let O,P=this.first;for(;void 0!==P;)O=P,P=O.next,yield O}*drain(){for(const O of this.nodes())this.deleteNode(O),yield O.value}nodeOf(O,P){if(!v.isMissing(P)&&!v.isInstance(P,g))throw new TypeError("LinkedListNode expected: fromNode");if(!v.isMissing(P)&&P.list!==this)throw new TypeError("Wrong list.");for(let N=P||this.first;N;N=N.next)if(this._equaler.equals(N.value,O))return N}lastNodeOf(O,P){if(!v.isMissing(P)&&!v.isInstance(P,g))throw new TypeError("LinkedListNode expected: fromNode");if(!v.isMissing(P)&&P.list!==this)throw new TypeError("Wrong list.");for(let N=P||this.last;N;N=N.previous)if(this._equaler.equals(N.value,O))return N}find(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");let N,M=this.first;for(;void 0!==M;){N=M,M=N.next;const B=N.value;if(O.call(P,B,N,this))return B}}findLast(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");let N,M=this.last;for(;void 0!==M;){N=M,M=N.previous;const B=N.value;if(O.call(P,B,N,this))return B}}findNode(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");let N,M=this.first;for(;void 0!==M;)if(N=M,M=N.next,O.call(P,N.value,N,this))return N}findLastNode(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");let N,M=this.last;for(;void 0!==M;)if(N=M,M=N.previous,O.call(P,N.value,N,this))return N}has(O){return void 0!==this.nodeOf(O)}insertBefore(O,P){if(!v.isMissing(O)&&!v.isInstance(O,g))throw new TypeError("LinkedListNode expected: node");if(!v.isMissing(O)&&O.list!==this)throw new Error("Wrong list.");return this._insertNode(O||void 0,new g(P),0)}insertNodeBefore(O,P){if(!v.isMissing(O)&&!v.isInstance(O,g))throw new TypeError("LinkedListNode expected: node");if(!v.isInstance(P,g))throw new TypeError("LinkedListNode expected: newNode");if(!v.isMissing(O)&&O.list!==this)throw new Error("Wrong list.");if(!v.isMissing(P.list))throw new Error("Node is already attached to a list.");this._insertNode(O||void 0,P,0)}insertAfter(O,P){if(!v.isMissing(O)&&!v.isInstance(O,g))throw new TypeError("LinkedListNode expected: node");if(!v.isMissing(O)&&O.list!==this)throw new Error("Wrong list.");return this._insertNode(O||void 0,new g(P),1)}insertNodeAfter(O,P){if(!v.isMissing(O)&&!v.isInstance(O,g))throw new TypeError("LinkedListNode expected: node");if(!v.isInstance(P,g))throw new TypeError("LinkedListNode expected: newNode");if(!v.isMissing(O)&&O.list!==this)throw new Error("Wrong list.");if(!v.isMissing(P.list))throw new Error("Node is already attached to a list.");this._insertNode(O||void 0,P,1)}push(O){return this._insertNode(void 0,new g(O),1)}pushNode(O){if(!v.isInstance(O,g))throw new TypeError("LinkedListNode expected: newNode");if(!v.isMissing(O.list))throw new Error("Node is already attached to a list.");this._insertNode(void 0,O,1)}pop(){const O=this.popNode();return O?O.value:void 0}popNode(){const O=this.last;if(this.deleteNode(O))return O}shift(){const O=this.shiftNode();return O?O.value:void 0}shiftNode(){const O=this.first;if(this.deleteNode(O))return O}unshift(O){return this._insertNode(void 0,new g(O),0)}unshiftNode(O){if(!v.isInstance(O,g))throw new TypeError("LinkedListNode expected: newNode");if(!v.isMissing(O.list))throw new Error("Node is already attached to a list.");this._insertNode(void 0,O,0)}delete(O){const P=this.nodeOf(O);if(P&&this.deleteNode(P))return P}deleteNode(O){if(!v.isMissing(O)&&!v.isInstance(O,g))throw new TypeError("LinkedListNode expected: node");if(!v.isMissing(O)&&!v.isMissing(O.list)&&O.list!==this)throw new TypeError("Wrong list.");return!v.isMissing(O)&&!v.isMissing(O.list)&&this._deleteNode(O)}deleteAll(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: predicate");let N=0,M=this.first;for(;M;){const B=M.next;O.call(P,M.value,M,this)&&M.list===this&&(this._deleteNode(M),++N),M=B}return N}clear(){for(;this.size>0;)this.deleteNode(this.last)}forEach(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");let N,M=this.first;for(;void 0!==M;)N=M,M=N.next,O.call(P,N.value,N,this)}map(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");const N=new w;let M,B=this.first;for(;void 0!==B;){M=B,B=M.next;const Y=O.call(P,M.value,M,this);N.push(Y)}return N}filter(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");const N=new w(this.equaler);let M,B=this.first;for(;void 0!==B;){M=B,B=M.next;const Y=M.value;O.call(P,Y,M,this)&&N.push(Y)}return N}reduce(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");let B,N=arguments.length>1,M=P,Y=this.first;for(;void 0!==Y;){B=Y,Y=B.next;const F=B.value;N?M=O(M,F,B,this):(M=F,N=!0)}return M}reduceRight(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");let B,N=arguments.length>1,M=P,Y=this.last;for(;void 0!==Y;){B=Y;const F=B.value;N?M=O(M,F,B,this):(M=F,N=!0),Y=B.previous}return M}some(O,P){if(!v.isMissing(O)&&!v.isFunction(O))throw new TypeError("Function expected: callback");let N,M=this.first;for(;void 0!==M;)if(N=M,M=N.next,!O||O.call(P,N.value,N,this))return!0;return!1}every(O,P){if(!v.isFunction(O))throw new TypeError("Function expected: callback");let M,N=!1,B=this.first;for(;void 0!==B;){if(M=B,B=M.next,!O.call(P,M.value,M,this))return!1;N=!0}return N}_deleteNode(O){return O[S]===O?this._head=void 0:(O[S][f]=O[f],O[f][S]=O[S],this._head===O&&(this._head=O[S])),O[d]=void 0,O[S]=void 0,O[f]=void 0,this._size--,!0}_insertNode(O,P,N){if(P[d]=this,void 0===this._head)P[S]=P,P[f]=P,this._head=P;else switch(N){case 0:void 0===O?(O=this._head,this._head=P):O===this._head&&(this._head=P),P[S]=O,P[f]=O[f],O[f][S]=P,O[f]=P;break;case 1:void 0===O&&(O=this._head[f]),P[f]=O,P[S]=O[S],O[S][f]=P,O[S]=P}return this._size++,P}get[E.ReadonlyCollection.size](){return this.size}[E.ReadonlyCollection.has](O){return this.has(O)}[E.Collection.add](O){this.push(O)}[E.Collection.delete](O){return!!this.delete(O)}[E.Collection.clear](){this.clear()}}I.LinkedList=w,Object.defineProperty(w.prototype,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"LinkedList"})},6207:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.MultiMap=void 0;const p=h(1344),T=h(839),C=h(8270),v=h(8090),E=h(6471);class b{constructor(...g){let w,m,O;this._size=0,function f(S){return(S.length<1||p.isNumber(S[0]))&&(S.length<2||!p.isDefined(S[1])||p.isObject(S[1]))}(g)?[w,O={}]=g:(w=0,function d(S){return(S.length<1||!p.isDefined(S[0])||p.isIterable(S[0]))&&(S.length<2||!p.isDefined(S[1])||p.isObject(S[1]))}(g)?[m,O={}]=g:O={});const{keyEqualer:P=T.Equaler.defaultEqualer,valueEqualer:N=T.Equaler.defaultEqualer}=O;if(this._map=new v.HashMap(w,P),this._keyEqualer=P,this._valueEqualer=N,m)for(const[M,B]of m)this.add(M,B)}get keyEqualer(){return this._keyEqualer}get valueEqualer(){return this._valueEqualer}get size(){return this._size}has(g){return this._map.has(g)}hasValue(g,w){const m=this._map.get(g);return!!m&&m.has(w)}get(g){return this._map.get(g)}add(g,w){let m=this._map.get(g);m||(m=new E.HashSet(this._valueEqualer),this._map.set(g,m));const O=m.size;return m.add(w),this._size+=m.size-O,this}delete(g){const w=this._map.get(g);return w?(this._size-=w.size,this._map.delete(g),w.size):0}deleteValue(g,w){const m=this._map.get(g);if(m){const O=m.size;if(m.delete(w))return this._size+=m.size-O,m.size<=0&&this._map.delete(g),!0}return!1}clear(){this._map.clear(),this._size=0}ensureCapacity(g){return this._map.ensureCapacity(g)}trimExcess(g){this._map.trimExcess(g)}keys(){return this._map.keys()}*values(){for(const g of this._map.values())yield*g}*entries(){for(const[g,w]of this._map)for(const m of w)yield[g,m]}[Symbol.iterator](){return this.entries()}forEach(g,w){for(const[m,O]of this._map)for(const P of O)g.call(w,P,m,this)}get[C.ReadonlyKeyedMultiCollection.size](){return this.size}[C.ReadonlyKeyedMultiCollection.has](g){return this.has(g)}[C.ReadonlyKeyedMultiCollection.hasValue](g,w){return this.hasValue(g,w)}[C.ReadonlyKeyedMultiCollection.get](g){return this.get(g)}[C.ReadonlyKeyedMultiCollection.keys](){return this.keys()}[C.ReadonlyKeyedMultiCollection.values](){return this.values()}[C.KeyedMultiCollection.add](g,w){this.add(g,w)}[C.KeyedMultiCollection.delete](g){return this.delete(g)}[C.KeyedMultiCollection.deleteValue](g,w){return this.deleteValue(g,w)}[C.KeyedMultiCollection.clear](){this.clear()}}I.MultiMap=b,Object.defineProperty(b,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"MultiMap"})},5027:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.SortedMap=void 0;const p=h(1344),T=h(4045),C=h(8270),v=h(839);class E{constructor(...d){let f,S;if(this._keys=[],this._values=[],d.length>0){const g=d[0];p.isIterable(g)||void 0===g?(f=g,d.length>1&&(S=d[1])):S=g}if(void 0===S&&(S=v.Comparer.defaultComparer),this._comparer="function"==typeof S?v.Comparer.create(S):S,f)for(const[g,w]of f)this.set(g,w)}get comparer(){return this._comparer}get size(){return this._keys.length}has(d){return T.binarySearch(this._keys,d,this._comparer)>=0}get(d){const f=T.binarySearch(this._keys,d,this._comparer);return f>=0?this._values[f]:void 0}set(d,f){const S=T.binarySearch(this._keys,d,this._comparer);return S>=0?this._values[S]=f:(this._keys.splice(~S,0,d),this._values.splice(~S,0,f)),this}delete(d){const f=T.binarySearch(this._keys,d,this._comparer);return f>=0&&(this._keys.splice(f,1),this._values.splice(f,1),!0)}clear(){this._keys.length=0,this._values.length=0}keys(){return this._keys.values()}values(){return this._values.values()}*entries(){for(let d=0;d<this._keys.length;d++)yield[this._keys[d],this._values[d]]}[Symbol.iterator](){return this.entries()}forEach(d,f){for(const[S,g]of this)d.call(f,g,S,this)}get[C.KeyedCollection.size](){return this.size}[C.KeyedCollection.has](d){return this.has(d)}[C.KeyedCollection.get](d){return this.get(d)}[C.KeyedCollection.set](d,f){this.set(d,f)}[C.KeyedCollection.delete](d){return this.delete(d)}[C.KeyedCollection.clear](){this.clear()}[C.KeyedCollection.keys](){return this.keys()}[C.KeyedCollection.values](){return this.values()}}I.SortedMap=E,Object.defineProperty(E,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"SortedMap"})},4027:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.SortedSet=void 0;const p=h(4045),T=h(1344),C=h(8270),v=h(839);class E{constructor(...d){let f,S;if(this._values=[],d.length>0){const g=d[0];T.isIterable(g)||void 0===g?(f=g,d.length>1&&(S=d[1])):S=g}if(void 0===S&&(S=v.Comparer.defaultComparer),this._comparer="function"==typeof S?v.Comparer.create(S):S,f)for(const g of f)this.add(g)}get comparer(){return this._comparer}get size(){return this._values.length}has(d){return p.binarySearch(this._values,d,this._comparer)>=0}add(d){const f=p.binarySearch(this._values,d,this._comparer);return f>=0?this._values[f]=d:this._values.splice(~f,0,d),this}delete(d){const f=p.binarySearch(this._values,d,this._comparer);return f>=0&&(this._values.splice(f,1),!0)}clear(){this._values.length=0}keys(){return this._values.values()}values(){return this._values.values()}*entries(){for(let d=0;d<this._values.length;d++)yield[this._values[d],this._values[d]]}[Symbol.iterator](){return this.values()}forEach(d,f){for(const S of this)d.call(f,S,S,this)}get[C.Collection.size](){return this.size}[C.Collection.has](d){return this.has(d)}[C.Collection.add](d){this.add(d)}[C.Collection.delete](d){return this.delete(d)}[C.Collection.clear](){this.clear()}}I.SortedSet=E,Object.defineProperty(E,Symbol.toStringTag,{enumerable:!1,configurable:!0,writable:!0,value:"SortedSet"})},2243:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});const p=h(655);p.__exportStar(h(5027),I),p.__exportStar(h(4027),I),p.__exportStar(h(8090),I),p.__exportStar(h(6471),I),p.__exportStar(h(6207),I),p.__exportStar(h(6289),I)},839:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.rawHash=I.tupleStructuralComparer=I.tupleComparer=I.structuralComparer=I.defaultComparer=I.Comparer=I.combineHashes=I.tupleStructuralEqualer=I.tupleEqualer=I.structuralEqualer=I.defaultEqualer=I.Equaler=I.StructuralComparable=I.StructuralEquatable=I.Comparable=I.Equatable=void 0;const p=h(7354);var T,C,v,E,b,d;function S(g){let w=!1;return()=>{w||(w=!0,"object"==typeof process&&process.emitWarning?process.emitWarning(g,"Deprecation"):"object"==typeof console&&console.warn(`Deprecation: ${g}`))}}(function(g){function w(m){let O;return null!=m&&g.equals in(O=Object(m))&&g.hash in O}g.equals=Symbol.for("@esfx/equatable:Equatable.equals"),g.hash=Symbol.for("@esfx/equatable:Equatable.hash"),g.name="Equatable",g.hasInstance=w,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:w})})(T=I.Equatable||(I.Equatable={})),function(g){const w=S("Use 'Equatable.hasInstance' instead.");g.isEquatable=function m(O){return w(),g.hasInstance(O)}}(T=I.Equatable||(I.Equatable={})),function(g){function w(m){return null!=m&&g.compareTo in Object(m)}g.compareTo=Symbol.for("@esfx/equatable:Comparable.compareTo"),g.name="Comparable",g.hasInstance=w,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:w})}(C=I.Comparable||(I.Comparable={})),function(g){const w=S("Use 'Comparable.hasInstance' instead.");g.isComparable=function m(O){return w(),g.hasInstance(O)}}(C=I.Comparable||(I.Comparable={})),function(g){function w(m){let O;return null!=m&&g.structuralEquals in(O=Object(m))&&g.structuralHash in O}g.structuralEquals=Symbol.for("@esfx/equatable:StructualEquatable.structuralEquals"),g.structuralHash=Symbol.for("@esfx/equatable:StructuralEquatable.structuralHash"),g.name="StructuralEquatable",g.hasInstance=w,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:w})}(v=I.StructuralEquatable||(I.StructuralEquatable={})),function(g){const w=S("Use 'StructuralEquatable.hasInstance' instead.");g.isStructuralEquatable=function m(O){return w(),g.hasInstance(O)}}(v=I.StructuralEquatable||(I.StructuralEquatable={})),function(g){function w(m){return null!=m&&g.structuralCompareTo in Object(m)}g.structuralCompareTo=Symbol.for("@esfx/equatable:StructuralComparable.structuralCompareTo"),g.name="StructuralComparable",g.hasInstance=w,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:w})}(E=I.StructuralComparable||(I.StructuralComparable={})),function(g){const w=S("Use 'StructuralComparable.hasInstance' instead.");g.isStructuralComparable=function m(O){return w(),g.hasInstance(O)}}(E=I.StructuralComparable||(I.StructuralComparable={})),function(g){const w=Object.defineProperty({},Symbol.toStringTag,{configurable:!0,value:"Equaler"});function m(N,M=g.defaultEqualer.hash){return Object.setPrototypeOf({equals:N,hash:M},w)}function O(N,M,B=7){if("number"!=typeof N)throw new TypeError("Integer expected: x");if("number"!=typeof M)throw new TypeError("Integer expected: y");if("number"!=typeof B)throw new TypeError("Integer expected: rotate");if(isNaN(N)||!isFinite(N))throw new RangeError("Argument must be a finite number value: x");if(isNaN(M)||!isFinite(M))throw new RangeError("Argument must be a finite number value: y");if(isNaN(B)||!isFinite(B))throw new RangeError("Argument must be a finite number value: rotate");for(;B<0;)B+=32;for(;B>=32;)B-=32;return(N<<B|N>>>32-B)^M}function P(N){return"object"==typeof N&&null!==N&&"function"==typeof N.equals&&"function"==typeof N.hash}g.defaultEqualer=m((N,M)=>T.hasInstance(N)?N[T.equals](M):T.hasInstance(M)?M[T.equals](N):Object.is(N,M),N=>T.hasInstance(N)?N[T.hash]():p.hashUnknown(N)),g.structuralEqualer=m((N,M)=>v.hasInstance(N)?N[v.structuralEquals](M,g.structuralEqualer):v.hasInstance(M)?M[v.structuralEquals](N,g.structuralEqualer):g.defaultEqualer.equals(N,M),N=>v.hasInstance(N)?N[v.structuralHash](g.structuralEqualer):g.defaultEqualer.hash(N)),g.tupleEqualer=m((N,M)=>{if(!Array.isArray(N)&&null!=N||!Array.isArray(M)&&null!=M)throw new TypeError("Array expected");if(N===M)return!0;if(!N||!M||N.length!==M.length)return!1;for(let B=0;B<N.length;B++)if(!g.defaultEqualer.equals(N[B],M[B]))return!1;return!0},N=>{if(null==N)return 0;if(!Array.isArray(N))throw new TypeError("Array expected");let M=0;for(const B of N)M=O(M,g.defaultEqualer.hash(B));return M}),g.tupleStructuralEqualer=m((N,M)=>{if(!Array.isArray(N)&&null!=N||!Array.isArray(M)&&null!=M)throw new TypeError("Array expected");if(N===M)return!0;if(!N||!M||N.length!==M.length)return!1;for(let B=0;B<N.length;B++)if(!g.structuralEqualer.equals(N[B],M[B]))return!1;return!0},N=>{if(null==N)return 0;if(!Array.isArray(N))throw new TypeError("Array expected");let M=0;for(const B of N)M=O(M,g.structuralEqualer.hash(B));return M}),g.create=m,g.combineHashes=O,g.hasInstance=P,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:P})}(b=I.Equaler||(I.Equaler={})),I.defaultEqualer=b.defaultEqualer,I.structuralEqualer=b.structuralEqualer,I.tupleEqualer=b.tupleEqualer,I.tupleStructuralEqualer=b.tupleEqualer,I.combineHashes=b.combineHashes,function(g){const w=Object.defineProperty({},Symbol.toStringTag,{configurable:!0,value:"Comparer"});function m(P){return Object.setPrototypeOf({compare:P},w)}function O(P){return"object"==typeof P&&null!==P&&"function"==typeof P.compare}g.defaultComparer=m((P,N)=>C.hasInstance(P)?P[C.compareTo](N):C.hasInstance(N)?-N[C.compareTo](P):P<N?-1:P>N?1:0),g.structuralComparer=m((P,N)=>E.hasInstance(P)?P[E.structuralCompareTo](N,g.structuralComparer):E.hasInstance(N)?-N[E.structuralCompareTo](P,g.structuralComparer):g.defaultComparer.compare(P,N)),g.tupleComparer=m((P,N)=>{if(!Array.isArray(P)&&null!=P||!Array.isArray(N)&&null!=N)throw new TypeError("Array expected");let M;if(M=g.defaultComparer.compare(P.length,N.length))return M;for(let B=0;B<P.length;B++)if(M=g.defaultComparer.compare(P[B],N[B]))return M;return 0}),g.tupleStructuralComparer=m((P,N)=>{if(!Array.isArray(P)&&null!=P||!Array.isArray(N)&&null!=N)throw new TypeError("Array expected");let M;if(M=g.defaultComparer.compare(P.length,N.length))return M;for(let B=0;B<P.length;B++)if(M=g.structuralComparer.compare(P[B],N[B]))return M;return 0}),g.create=m,g.hasInstance=O,Object.defineProperty(g,Symbol.hasInstance,{configurable:!0,writable:!0,value:O})}(d=I.Comparer||(I.Comparer={})),I.defaultComparer=d.defaultComparer,I.structuralComparer=d.structuralComparer,I.tupleComparer=d.tupleComparer,I.tupleStructuralComparer=d.tupleStructuralComparer,I.rawHash=function f(g){return p.hashUnknown(g)}},7354:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.hashUnknown=void 0;const p=h(7155);let T,C,v,E,b,d;const m=new DataView(new ArrayBuffer(8)),O=p.createSeed(),P=p.createSeed(),N=p.createSeed(),M=p.createSeed(),B=p.createSeed();let Y=O,F=P,$=B,Q=N,ie=M;function se(ue,Se,Pe){if(!Buffer.isEncoding(Se))throw new RangeError(`Invalid encoding: ${Se}`);return function J(ue,Se){const Pe=ue.buffer.slice(ue.byteOffset,ue.byteOffset+ue.byteLength);return p.hash(Pe,Se)}(Buffer.from(ue,Se),Pe)}function z(ue,Se){return(ue<<7|ue>>>25)^Se}const ge="function"==typeof BigInt?function K(){const ue=BigInt(0),Se=BigInt(4294967295),Pe=BigInt(32);return function qe(dt){if(dt===ue)return 0;let Ti=dt<ue?-1:dt>ue?1:0;for(dt<ue&&(dt=-dt);dt!==ue;)Ti=z(Ti,Number(dt&Se)),dt>>=Pe;return Ti}}():function le(){return function ue(Se){return se(Se.toString(),"ascii",$)}}(),Ee="description"in Symbol.prototype?ue=>ue.description:ue=>{const Se=ue.toString();return Se.startsWith("Symbol(")&&Se.endsWith(")")?Se.slice(7,-1):Se};function he(ue){let Se=E&&E.get(ue);return void 0===Se&&(E||(E=new WeakMap),Se=function ae(ue){let Se;return null===ue?Se=C||(C={next:1}):(Se=T&&T.get(ue),Se||(T||(T=new WeakMap),T.set(ue,Se={next:1}))),Se}(Object.getPrototypeOf(ue)).next++,Se=z(Y,Se),E.set(ue,Se)),Se}function de(ue){switch(typeof ue){case"boolean":return function ee(ue){return ue?1:0}(ue);case"number":return function H(ue){return function re(ue){return Number.isInteger(ue)&&ue>=-2147483648&&ue<=2147483647}(ue)?ue:function j(ue){return Number.isInteger(ue)&&ue>=0&&ue<=4294967295}(ue)?function V(ue){return ue>>0}(ue):function G(ue){return m.setFloat64(0,ue),m.getInt32(0,!0)^m.getInt32(4,!0)}(ue)}(ue);case"bigint":return ge(ue);case"string":return function pe(ue){return se(ue,"utf8",F)}(ue);case"symbol":return function Me(ue){const Se=Symbol.keyFor(ue);return void 0!==Se?function ye(ue,Se){let Pe=b&&b.get(ue);return void 0===Pe&&(Pe=se(Se,"utf8",ie),b||(b=new Map),b.set(ue,Pe)),Pe}(ue,Se):function be(ue){let Se=d&&d.get(ue);if(void 0===Se){v||(v={next:1}),Se=z(Q,v.next++);const Pe=Ee(ue);Pe&&(Se=se(Pe,"utf8",Se)),d||(d=new Map),d.set(ue,Se)}return Se}(ue)}(ue);case"function":return he(ue);case"object":if(null!==ue)return he(ue);default:return 0}}var ue;I.hashUnknown=de,(ue=de=I.hashUnknown||(I.hashUnknown={})).getState=function Se(){return{weakPrototypeCounters:T,nullPrototypeCounter:C,localSymbolCounter:v,weakObjectHashes:E,globalSymbolHashes:b,localSymbolHashes:d,objectSeed:Y,stringSeed:F,bigIntSeed:$,localSymbolSeed:Q,globalSymbolSeed:ie}},ue.setState=function Pe(qe){({weakPrototypeCounters:T,nullPrototypeCounter:C,localSymbolCounter:v,weakObjectHashes:E,globalSymbolHashes:b,localSymbolHashes:d,objectSeed:Y=O,stringSeed:F=P,bigIntSeed:$=B,localSymbolSeed:Q=N,globalSymbolSeed:ie=M}=qe)}},7155:(_,I)=>{"use strict";function h(){return 4294967295*Math.random()>>>0}Object.defineProperty(I,"__esModule",{value:!0}),I.hash=I.defaultSeed=I.createSeed=void 0,I.createSeed=h,I.defaultSeed=h();const p=3432918353,T=461845907;I.hash=function v(E,b){const d=new DataView(E);let g,f=b>>>0,S=0;for(;S<d.byteLength-4;)g=d.getUint32(S,!0),g*=p,g=g<<15|g>>>17,g*=T,f^=g,f=f<<13|f>>>19,f=5*f+3864292196,S+=4;if(S<d.byteLength){switch(g=0,d.byteLength-S){case 3:g|=d.getUint8(S+2)<<16;case 2:g|=d.getUint8(S+1)<<8;case 1:g|=d.getUint8(S+0)<<0}g*=p,g=g<<15|g>>>17,g*=T,f^=g}return f^=d.byteLength,f^=f>>>16,f*=2246822507,f^=f>>>13,f*=3266489909,f^=f>>>16,f}},4045:(_,I)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.binarySearch=void 0,I.binarySearch=function h(p,T,C){if(0===p.length)return-1;let v=0,E=p.length-1;for(;v<=E;){const b=v+(E-v>>1);switch(Math.sign(C.compare(p[b],T))){case-1:v=b+1;break;case 0:return b;case 1:E=b-1}}return~v}},1301:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.forEachEntry=I.iterateEntries=I.selectEntryEntry=I.selectEntryValue=I.selectEntryKey=I.trimExcessEntries=I.ensureCapacity=I.clearEntries=I.deleteEntry=I.insertEntry=I.findEntryValue=I.findEntryIndex=I.resizeHashData=I.initializeHashData=I.createHashData=I.createHashEntry=void 0;const p=h(502),T=2**31-1;function E(F,$){const Q=p.getPrime($);return F.freeList=-1,F.buckets=new Int32Array(Q),F.entries=new Array(Q),Q}function b(F,$){const Q=F.size,ie=new Int32Array($),ee=F.entries?F.entries.slice():[];ee.length=$;for(let re=0;re<Q;re++){const U=ee[re];if(U&&U.hashCode>=0){const j=U.hashCode%$;U.next=ie[j]-1,ie[j]=re+1}}F.buckets=ie,F.entries=ee}function d(F,$){let Q=-1;const{buckets:ie,entries:ee,equaler:re}=F;if(ie&&ee){let U=re.hash($)&T;for(Q=ie[U%ie.length]-1;Q>>>0<ee.length&&(ee[Q].hashCode!==U||!re.equals(ee[Q].key,$));)Q=ee[Q].next}return Q}I.createHashEntry=function C(){return{prevEntry:void 0,nextEntry:void 0,skipNextEntry:!1,next:0,hashCode:0,key:void 0,value:void 0}},I.createHashData=function v(F,$){const Q={prevEntry:void 0,nextEntry:void 0,skipNextEntry:!1,next:0,hashCode:0,key:void 0,value:void 0},ie={buckets:void 0,entries:void 0,freeSize:0,freeList:0,size:0,equaler:F,head:Q,tail:Q};return E(ie,$),ie},I.initializeHashData=E,I.resizeHashData=b,I.findEntryIndex=d,I.findEntryValue=function f(F,$){const Q=d(F,$);return Q>=0?F.entries[Q].value:void 0},I.insertEntry=function S(F,$,Q){if(F.buckets||E(F,0),!F.buckets||!F.entries)throw new Error;const ie=F.equaler.hash($)&T;let ee=ie%F.buckets.length,re=F.buckets[ee]-1;for(;re>>>0<F.entries.length;){const H=F.entries[re];if(H.hashCode===ie&&F.equaler.equals(H.key,$))return void(H.value=Q);re=H.next}let j,U=!1;if(F.freeSize>0)j=F.freeList,U=!0,F.freeSize--;else{const H=F.size;if(H===F.entries.length){if(b(F,p.expandPrime(F.size)),!F.buckets||!F.entries)throw new Error;ee=ie%F.buckets.length}j=H,F.size=H+1}const V=F.entries[j]||(F.entries[j]={prevEntry:void 0,nextEntry:void 0,skipNextEntry:!1,next:0,hashCode:0,key:void 0,value:void 0});U&&(F.freeList=V.next),V.hashCode=ie,V.next=F.buckets[ee]-1,V.key=$,V.value=Q,V.skipNextEntry=!1;const G=F.tail;G.nextEntry=V,V.prevEntry=G,F.tail=V,F.buckets[ee]=j+1},I.deleteEntry=function g(F,$){if(F.buckets&&F.entries){const Q=F.equaler.hash($)&T,ie=Q%F.buckets.length;let re,ee=-1;for(let U=F.buckets[ie]-1;U>=0;U=re.next){if(re=F.entries[U],re.hashCode===Q&&F.equaler.equals(re.key,$)){ee<0?F.buckets[ie]=re.next+1:F.entries[ee].next=re.next;const j=re.prevEntry;return j.nextEntry=re.nextEntry,j.nextEntry&&(j.nextEntry.prevEntry=j),F.tail===re&&(F.tail=j),re.hashCode=-1,re.next=F.freeList,re.key=void 0,re.value=void 0,re.prevEntry=void 0,re.nextEntry=j,re.skipNextEntry=!0,F.freeList=U,F.freeSize++,!0}ee=U}}return!1},I.clearEntries=function w(F){if(F.size>0){F.buckets&&F.buckets.fill(0),F.entries&&F.entries.fill(void 0);let Q=F.head.nextEntry;for(;Q;){const ie=Q.nextEntry;Q.prevEntry=void 0,Q.nextEntry=F.head,Q.skipNextEntry=!0,Q=ie}F.head.nextEntry=void 0,F.tail=F.head,F.size=0,F.freeList=-1,F.freeSize=0}},I.ensureCapacity=function m(F,$){if($<0)throw new RangeError;const Q=F.entries?F.entries.length:0;if(Q>=$)return Q;if(!F.buckets)return E(F,$);const ie=p.getPrime($);return b(F,p.getPrime($)),ie},I.trimExcessEntries=function O(F,$=F.size-F.freeSize){if($<F.size)throw new RangeError;if(!F.buckets||!F.entries)return;const Q=p.getPrime($),ie=F.entries;if(Q>=(ie?ie.length:0))return;const ee=F.size;if(E(F,Q),!F.buckets||!F.entries)throw new Error;let re=0;for(let U=0;U<ee;U++){const j=ie[U].hashCode;if(j>=0){const V=j%Q;F.entries[re]=ie[U],F.entries[re].next=F.buckets[V]-1,F.buckets[V]=re+1,re++}}F.size=re,F.freeSize=0},I.selectEntryKey=function P(F){return F.key},I.selectEntryValue=function N(F){return F.value},I.selectEntryEntry=function M(F){return[F.key,F.value]},I.iterateEntries=function*B(F,$){let Q=F;for(;Q;){const ie=Q.skipNextEntry;Q=Q.nextEntry,!ie&&Q&&(yield $(Q))}},I.forEachEntry=function Y(F,$,Q,ie){let ee=$;for(;ee;){const re=ee.skipNextEntry;ee=ee.nextEntry,!re&&ee&&Q.call(ie,ee.value,ee.key,F)}}},502:(_,I)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.expandPrime=I.getPrime=I.isPrime=void 0;const p=2146435069,C=[3,7,11,17,23,29,37,47,59,71,89,107,131,163,197,239,293,353,431,521,631,761,919,1103,1327,1597,1931,2333,2801,3371,4049,4861,5839,7013,8419,10103,12143,14591,17519,21023,25229,30293,36353,43627,52361,62851,75431,90523,108631,130363,156437,187751,225307,270371,324449,389357,467237,560689,672827,807403,968897,1162687,1395263,1674319,2009191,2411033,2893249,3471899,4166287,4999559,5999471,7199369];function v(d){if(1&d){const f=0|Math.sqrt(d);for(let S=3;S<=f;S+=2)if(!(d%S))return!1;return!0}return 2===d}function E(d){if(d<0)throw new RangeError;for(let f=0;f<C.length;f++){const S=C[f];if(S>=d)return S}for(let f=1|d;f<2147483647;f+=2)if(v(f)&&(f-1)%101)return f;return d}I.isPrime=v,I.getPrime=E,I.expandPrime=function b(d){const f=2*d;return f>p&&p>d?p:E(f)}},9440:(_,I,h)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.deprecateProperty=I.deprecate=void 0;const C=function p(){try{return h(Object(function(){var f=new Error("Cannot find module 'util'");throw f.code="MODULE_NOT_FOUND",f}())).deprecate}catch(b){}}()||function T(){const b="object"==typeof process&&"function"==typeof process.emitWarning?function d(f,S="Warning",g=d){process.emitWarning(f,S,g)}:"function"==typeof Error.captureStackTrace?function d(f,S="Warning",g=d){"string"==typeof f&&((f=new Error(f)).name=S),Error.captureStackTrace(f,g),console.warn(f)}:function(f,S="Warning"){"string"==typeof f?console.warn(`${S}:`,f):console.warn(f)};return(d,f)=>{let S=!1;function g(...w){return S||(S=!0,b(f,"DeprecationWarning",d)),new.target?Reflect.construct(d,w,new.target):d.apply(this,w)}return Object.setPrototypeOf(g,d),d.prototype&&(g.prototype=d.prototype),g}}();function v(b,d){return C(b,d)}I.deprecate=v,I.deprecateProperty=function E(b,d,f){let S=Object.getOwnPropertyDescriptor(b,d);if(S&&S.configurable){let g=!1;S.get&&(S.get=v(S.get,f),g=!0),S.set&&(S.set=v(S.set,f),g=!0),"function"==typeof S.value&&(S.value=v(S.value,f),g=!0),g&&Object.defineProperty(b,d,S)}return b}},1344:(_,I)=>{"use strict";function h(P){return"function"==typeof P}function p(P){return"function"==typeof P||void 0===P}function T(P){return"object"==typeof P&&null!==P||"function"==typeof P}function v(P){return null==P}Object.defineProperty(I,"__esModule",{value:!0}),I.isPrimitive=I.isPropertyKey=I.isString=I.isBoolean=I.isNumber=I.isIterator=I.isAsyncIterable=I.isIterable=I.isDefined=I.isMissing=I.isInstance=I.isObject=I.isFunctionOrUndefined=I.isFunction=void 0,I.isFunction=h,I.isFunctionOrUndefined=p,I.isObject=T,I.isInstance=function C(P,N){return!v(P)&&P instanceof N},I.isMissing=v,I.isDefined=function E(P){return null!=P},I.isIterable=function b(P){return null!=P&&Symbol.iterator in Object(P)},I.isAsyncIterable=function d(P){return null!=P&&Symbol.asyncIterator in Object(P)},I.isIterator=function f(P){return T(P)&&h(P.next)&&p(P.throw)&&p(P.return)&&p(P[Symbol.iterator])},I.isNumber=function S(P){return"number"==typeof P},I.isBoolean=function g(P){return"boolean"==typeof P},I.isString=function w(P){return"string"==typeof P},I.isPropertyKey=function m(P){return"string"==typeof P||"symbol"==typeof P||"number"==typeof P},I.isPrimitive=function O(P){return"function"!=typeof P&&("object"!=typeof P||null===P)}}},_=>{_(_.s=6070)}]);